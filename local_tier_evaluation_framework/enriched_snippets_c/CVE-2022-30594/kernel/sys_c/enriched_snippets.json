[
  {
    "function_name": "accumulate_thread_rusage",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1730-1738",
    "snippet": "static void accumulate_thread_rusage(struct task_struct *t, struct rusage *r)\n{\n\tr->ru_nvcsw += t->nvcsw;\n\tr->ru_nivcsw += t->nivcsw;\n\tr->ru_minflt += t->min_flt;\n\tr->ru_majflt += t->maj_flt;\n\tr->ru_inblock += task_io_get_inblock(t);\n\tr->ru_oublock += task_io_get_oublock(t);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "task_io_get_oublock",
          "args": [
            "t"
          ],
          "line": 1737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_io_get_inblock",
          "args": [
            "t"
          ],
          "line": 1736
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic void accumulate_thread_rusage(struct task_struct *t, struct rusage *r)\n{\n\tr->ru_nvcsw += t->nvcsw;\n\tr->ru_nivcsw += t->nivcsw;\n\tr->ru_minflt += t->min_flt;\n\tr->ru_majflt += t->maj_flt;\n\tr->ru_inblock += task_io_get_inblock(t);\n\tr->ru_oublock += task_io_get_oublock(t);\n}"
  },
  {
    "function_name": "check_prlimit_permission",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1619-1639",
    "snippet": "static int check_prlimit_permission(struct task_struct *task,\n\t\t\t\t    unsigned int flags)\n{\n\tconst struct cred *cred = current_cred(), *tcred;\n\tbool id_match;\n\n\tif (current == task)\n\t\treturn 0;\n\n\ttcred = __task_cred(task);\n\tid_match = (uid_eq(cred->uid, tcred->euid) &&\n\t\t    uid_eq(cred->uid, tcred->suid) &&\n\t\t    uid_eq(cred->uid, tcred->uid)  &&\n\t\t    gid_eq(cred->gid, tcred->egid) &&\n\t\t    gid_eq(cred->gid, tcred->sgid) &&\n\t\t    gid_eq(cred->gid, tcred->gid));\n\tif (!id_match && !ns_capable(tcred->user_ns, CAP_SYS_RESOURCE))\n\t\treturn -EPERM;\n\n\treturn security_task_prlimit(cred, tcred, flags);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "security_task_prlimit",
          "args": [
            "cred",
            "tcred",
            "flags"
          ],
          "line": 1638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ns_capable",
          "args": [
            "tcred->user_ns",
            "CAP_SYS_RESOURCE"
          ],
          "line": 1635
        },
        "resolved": true,
        "details": {
          "function_name": "ns_capable_setid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/capability.c",
          "lines": "431-434",
          "snippet": "bool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/user_namespace.h>\n#include <linux/pid_namespace.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n\nbool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "cred->gid",
            "tcred->gid"
          ],
          "line": 1634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "cred->gid",
            "tcred->sgid"
          ],
          "line": 1633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "cred->gid",
            "tcred->egid"
          ],
          "line": 1632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "cred->uid",
            "tcred->uid"
          ],
          "line": 1631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "cred->uid",
            "tcred->suid"
          ],
          "line": 1630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "cred->uid",
            "tcred->euid"
          ],
          "line": 1629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__task_cred",
          "args": [
            "task"
          ],
          "line": 1628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_cred",
          "args": [],
          "line": 1622
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic int check_prlimit_permission(struct task_struct *task,\n\t\t\t\t    unsigned int flags)\n{\n\tconst struct cred *cred = current_cred(), *tcred;\n\tbool id_match;\n\n\tif (current == task)\n\t\treturn 0;\n\n\ttcred = __task_cred(task);\n\tid_match = (uid_eq(cred->uid, tcred->euid) &&\n\t\t    uid_eq(cred->uid, tcred->suid) &&\n\t\t    uid_eq(cred->uid, tcred->uid)  &&\n\t\t    gid_eq(cred->gid, tcred->egid) &&\n\t\t    gid_eq(cred->gid, tcred->sgid) &&\n\t\t    gid_eq(cred->gid, tcred->gid));\n\tif (!id_match && !ns_capable(tcred->user_ns, CAP_SYS_RESOURCE))\n\t\treturn -EPERM;\n\n\treturn security_task_prlimit(cred, tcred, flags);\n}"
  },
  {
    "function_name": "do_prlimit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1562-1616",
    "snippet": "int do_prlimit(struct task_struct *tsk, unsigned int resource,\n\t\tstruct rlimit *new_rlim, struct rlimit *old_rlim)\n{\n\tstruct rlimit *rlim;\n\tint retval = 0;\n\n\tif (resource >= RLIM_NLIMITS)\n\t\treturn -EINVAL;\n\tif (new_rlim) {\n\t\tif (new_rlim->rlim_cur > new_rlim->rlim_max)\n\t\t\treturn -EINVAL;\n\t\tif (resource == RLIMIT_NOFILE &&\n\t\t\t\tnew_rlim->rlim_max > sysctl_nr_open)\n\t\t\treturn -EPERM;\n\t}\n\n\t/* protect tsk->signal and tsk->sighand from disappearing */\n\tread_lock(&tasklist_lock);\n\tif (!tsk->sighand) {\n\t\tretval = -ESRCH;\n\t\tgoto out;\n\t}\n\n\trlim = tsk->signal->rlim + resource;\n\ttask_lock(tsk->group_leader);\n\tif (new_rlim) {\n\t\t/* Keep the capable check against init_user_ns until\n\t\t   cgroups can contain all limits */\n\t\tif (new_rlim->rlim_max > rlim->rlim_max &&\n\t\t\t\t!capable(CAP_SYS_RESOURCE))\n\t\t\tretval = -EPERM;\n\t\tif (!retval)\n\t\t\tretval = security_task_setrlimit(tsk, resource, new_rlim);\n\t}\n\tif (!retval) {\n\t\tif (old_rlim)\n\t\t\t*old_rlim = *rlim;\n\t\tif (new_rlim)\n\t\t\t*rlim = *new_rlim;\n\t}\n\ttask_unlock(tsk->group_leader);\n\n\t/*\n\t * RLIMIT_CPU handling. Arm the posix CPU timer if the limit is not\n\t * infinite. In case of RLIM_INFINITY the posix CPU timer code\n\t * ignores the rlimit.\n\t */\n\t if (!retval && new_rlim && resource == RLIMIT_CPU &&\n\t     new_rlim->rlim_cur != RLIM_INFINITY &&\n\t     IS_ENABLED(CONFIG_POSIX_TIMERS))\n\t\tupdate_rlimit_cpu(tsk, new_rlim->rlim_cur);\nout:\n\tread_unlock(&tasklist_lock);\n\treturn retval;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "read_unlock",
          "args": [
            "&tasklist_lock"
          ],
          "line": 1614
        },
        "resolved": true,
        "details": {
          "function_name": "do_mmap_read_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/task_iter.c",
          "lines": "634-643",
          "snippet": "static void do_mmap_read_unlock(struct irq_work *entry)\n{\n\tstruct mmap_unlock_irq_work *work;\n\n\tif (WARN_ON_ONCE(IS_ENABLED(CONFIG_PREEMPT_RT)))\n\t\treturn;\n\n\twork = container_of(entry, struct mmap_unlock_irq_work, irq_work);\n\tmmap_read_unlock_non_owner(work->mm);\n}",
          "includes": [
            "#include \"mmap_unlock_work.h\"",
            "#include <linux/btf_ids.h>",
            "#include <linux/filter.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/fs.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/namei.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mmap_unlock_work.h\"\n#include <linux/btf_ids.h>\n#include <linux/filter.h>\n#include <linux/fdtable.h>\n#include <linux/fs.h>\n#include <linux/pid_namespace.h>\n#include <linux/namei.h>\n#include <linux/init.h>\n\nstatic void do_mmap_read_unlock(struct irq_work *entry)\n{\n\tstruct mmap_unlock_irq_work *work;\n\n\tif (WARN_ON_ONCE(IS_ENABLED(CONFIG_PREEMPT_RT)))\n\t\treturn;\n\n\twork = container_of(entry, struct mmap_unlock_irq_work, irq_work);\n\tmmap_read_unlock_non_owner(work->mm);\n}"
        }
      },
      {
        "call_info": {
          "callee": "update_rlimit_cpu",
          "args": [
            "tsk",
            "new_rlim->rlim_cur"
          ],
          "line": 1612
        },
        "resolved": true,
        "details": {
          "function_name": "update_rlimit_cpu",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/posix-cpu-timers.c",
          "lines": "39-46",
          "snippet": "void update_rlimit_cpu(struct task_struct *task, unsigned long rlim_new)\n{\n\tu64 nsecs = rlim_new * NSEC_PER_SEC;\n\n\tspin_lock_irq(&task->sighand->siglock);\n\tset_process_cpu_timer(task, CPUCLOCK_PROF, &nsecs, NULL);\n\tspin_unlock_irq(&task->sighand->siglock);\n}",
          "includes": [
            "#include \"posix-timers.h\"",
            "#include <linux/task_work.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/compat.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/tick.h>",
            "#include <trace/events/timer.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/math64.h>",
            "#include <linux/errno.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/signal.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"posix-timers.h\"\n#include <linux/task_work.h>\n#include <linux/sched/deadline.h>\n#include <linux/compat.h>\n#include <linux/workqueue.h>\n#include <linux/tick.h>\n#include <trace/events/timer.h>\n#include <linux/kernel_stat.h>\n#include <linux/uaccess.h>\n#include <linux/math64.h>\n#include <linux/errno.h>\n#include <linux/posix-timers.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/signal.h>\n\nvoid update_rlimit_cpu(struct task_struct *task, unsigned long rlim_new)\n{\n\tu64 nsecs = rlim_new * NSEC_PER_SEC;\n\n\tspin_lock_irq(&task->sighand->siglock);\n\tset_process_cpu_timer(task, CPUCLOCK_PROF, &nsecs, NULL);\n\tspin_unlock_irq(&task->sighand->siglock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_POSIX_TIMERS"
          ],
          "line": 1611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_unlock",
          "args": [
            "tsk->group_leader"
          ],
          "line": 1602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "security_task_setrlimit",
          "args": [
            "tsk",
            "resource",
            "new_rlim"
          ],
          "line": 1594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capable",
          "args": [
            "CAP_SYS_RESOURCE"
          ],
          "line": 1591
        },
        "resolved": true,
        "details": {
          "function_name": "capable",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/capability.c",
          "lines": "447-450",
          "snippet": "bool capable(int cap)\n{\n\treturn ns_capable(&init_user_ns, cap);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/user_namespace.h>\n#include <linux/pid_namespace.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n\nbool capable(int cap)\n{\n\treturn ns_capable(&init_user_ns, cap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "task_lock",
          "args": [
            "tsk->group_leader"
          ],
          "line": 1586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read_lock",
          "args": [
            "&tasklist_lock"
          ],
          "line": 1579
        },
        "resolved": true,
        "details": {
          "function_name": "usermodehelper_read_lock_wait",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/umh.c",
          "lines": "242-266",
          "snippet": "long usermodehelper_read_lock_wait(long timeout)\n{\n\tDEFINE_WAIT(wait);\n\n\tif (timeout < 0)\n\t\treturn -EINVAL;\n\n\tdown_read(&umhelper_sem);\n\tfor (;;) {\n\t\tprepare_to_wait(&usermodehelper_disabled_waitq, &wait,\n\t\t\t\tTASK_UNINTERRUPTIBLE);\n\t\tif (!usermodehelper_disabled)\n\t\t\tbreak;\n\n\t\tup_read(&umhelper_sem);\n\n\t\ttimeout = schedule_timeout(timeout);\n\t\tif (!timeout)\n\t\t\tbreak;\n\n\t\tdown_read(&umhelper_sem);\n\t}\n\tfinish_wait(&usermodehelper_disabled_waitq, &wait);\n\treturn timeout;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include <linux/initrd.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/async.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/suspend.h>",
            "#include <linux/notifier.h>",
            "#include <linux/resource.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/mount.h>",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/cred.h>",
            "#include <linux/completion.h>",
            "#include <linux/slab.h>",
            "#include <linux/kmod.h>",
            "#include <linux/unistd.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DECLARE_RWSEM(umhelper_sem);",
            "static enum umh_disable_depth usermodehelper_disabled = UMH_DISABLED;",
            "static DECLARE_WAIT_QUEUE_HEAD(usermodehelper_disabled_waitq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include <linux/initrd.h>\n#include <linux/uaccess.h>\n#include <linux/async.h>\n#include <linux/ptrace.h>\n#include <linux/rwsem.h>\n#include <linux/suspend.h>\n#include <linux/notifier.h>\n#include <linux/resource.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/mount.h>\n#include <linux/security.h>\n#include <linux/workqueue.h>\n#include <linux/fs_struct.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/cred.h>\n#include <linux/completion.h>\n#include <linux/slab.h>\n#include <linux/kmod.h>\n#include <linux/unistd.h>\n#include <linux/syscalls.h>\n#include <linux/binfmts.h>\n#include <linux/sched/task.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n\nstatic DECLARE_RWSEM(umhelper_sem);\nstatic enum umh_disable_depth usermodehelper_disabled = UMH_DISABLED;\nstatic DECLARE_WAIT_QUEUE_HEAD(usermodehelper_disabled_waitq);\n\nlong usermodehelper_read_lock_wait(long timeout)\n{\n\tDEFINE_WAIT(wait);\n\n\tif (timeout < 0)\n\t\treturn -EINVAL;\n\n\tdown_read(&umhelper_sem);\n\tfor (;;) {\n\t\tprepare_to_wait(&usermodehelper_disabled_waitq, &wait,\n\t\t\t\tTASK_UNINTERRUPTIBLE);\n\t\tif (!usermodehelper_disabled)\n\t\t\tbreak;\n\n\t\tup_read(&umhelper_sem);\n\n\t\ttimeout = schedule_timeout(timeout);\n\t\tif (!timeout)\n\t\t\tbreak;\n\n\t\tdown_read(&umhelper_sem);\n\t}\n\tfinish_wait(&usermodehelper_disabled_waitq, &wait);\n\treturn timeout;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nint do_prlimit(struct task_struct *tsk, unsigned int resource,\n\t\tstruct rlimit *new_rlim, struct rlimit *old_rlim)\n{\n\tstruct rlimit *rlim;\n\tint retval = 0;\n\n\tif (resource >= RLIM_NLIMITS)\n\t\treturn -EINVAL;\n\tif (new_rlim) {\n\t\tif (new_rlim->rlim_cur > new_rlim->rlim_max)\n\t\t\treturn -EINVAL;\n\t\tif (resource == RLIMIT_NOFILE &&\n\t\t\t\tnew_rlim->rlim_max > sysctl_nr_open)\n\t\t\treturn -EPERM;\n\t}\n\n\t/* protect tsk->signal and tsk->sighand from disappearing */\n\tread_lock(&tasklist_lock);\n\tif (!tsk->sighand) {\n\t\tretval = -ESRCH;\n\t\tgoto out;\n\t}\n\n\trlim = tsk->signal->rlim + resource;\n\ttask_lock(tsk->group_leader);\n\tif (new_rlim) {\n\t\t/* Keep the capable check against init_user_ns until\n\t\t   cgroups can contain all limits */\n\t\tif (new_rlim->rlim_max > rlim->rlim_max &&\n\t\t\t\t!capable(CAP_SYS_RESOURCE))\n\t\t\tretval = -EPERM;\n\t\tif (!retval)\n\t\t\tretval = security_task_setrlimit(tsk, resource, new_rlim);\n\t}\n\tif (!retval) {\n\t\tif (old_rlim)\n\t\t\t*old_rlim = *rlim;\n\t\tif (new_rlim)\n\t\t\t*rlim = *new_rlim;\n\t}\n\ttask_unlock(tsk->group_leader);\n\n\t/*\n\t * RLIMIT_CPU handling. Arm the posix CPU timer if the limit is not\n\t * infinite. In case of RLIM_INFINITY the posix CPU timer code\n\t * ignores the rlimit.\n\t */\n\t if (!retval && new_rlim && resource == RLIMIT_CPU &&\n\t     new_rlim->rlim_cur != RLIM_INFINITY &&\n\t     IS_ENABLED(CONFIG_POSIX_TIMERS))\n\t\tupdate_rlimit_cpu(tsk, new_rlim->rlim_cur);\nout:\n\tread_unlock(&tasklist_lock);\n\treturn retval;\n}"
  },
  {
    "function_name": "rlim64_to_rlim",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1549-1559",
    "snippet": "static void rlim64_to_rlim(const struct rlimit64 *rlim64, struct rlimit *rlim)\n{\n\tif (rlim64_is_infinity(rlim64->rlim_cur))\n\t\trlim->rlim_cur = RLIM_INFINITY;\n\telse\n\t\trlim->rlim_cur = (unsigned long)rlim64->rlim_cur;\n\tif (rlim64_is_infinity(rlim64->rlim_max))\n\t\trlim->rlim_max = RLIM_INFINITY;\n\telse\n\t\trlim->rlim_max = (unsigned long)rlim64->rlim_max;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rlim64_is_infinity",
          "args": [
            "rlim64->rlim_max"
          ],
          "line": 1555
        },
        "resolved": true,
        "details": {
          "function_name": "rlim64_is_infinity",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
          "lines": "1528-1535",
          "snippet": "static inline bool rlim64_is_infinity(__u64 rlim64)\n{\n#if BITS_PER_LONG < 64\n\treturn rlim64 >= ULONG_MAX;\n#else\n\treturn rlim64 == RLIM64_INFINITY;\n#endif\n}",
          "includes": [
            "#include \"uid16.h\"",
            "#include <asm/unistd.h>",
            "#include <asm/io.h>",
            "#include <linux/uaccess.h>",
            "#include <generated/utsrelease.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/nospec.h>",
            "#include <linux/cred.h>",
            "#include <linux/uidgid.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/sched.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/time_namespace.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscall_user_dispatch.h>",
            "#include <linux/ctype.h>",
            "#include <linux/version.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mount.h>",
            "#include <linux/file.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/personality.h>",
            "#include <linux/cpu.h>",
            "#include <linux/seccomp.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/getcpu.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/signal.h>",
            "#include <linux/tty.h>",
            "#include <linux/suspend.h>",
            "#include <linux/security.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/times.h>",
            "#include <linux/key.h>",
            "#include <linux/device.h>",
            "#include <linux/capability.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kernel.h>",
            "#include <linux/resource.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/kmod.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/prctl.h>",
            "#include <linux/reboot.h>",
            "#include <linux/mman.h>",
            "#include <linux/utsname.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic inline bool rlim64_is_infinity(__u64 rlim64)\n{\n#if BITS_PER_LONG < 64\n\treturn rlim64 >= ULONG_MAX;\n#else\n\treturn rlim64 == RLIM64_INFINITY;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic void rlim64_to_rlim(const struct rlimit64 *rlim64, struct rlimit *rlim)\n{\n\tif (rlim64_is_infinity(rlim64->rlim_cur))\n\t\trlim->rlim_cur = RLIM_INFINITY;\n\telse\n\t\trlim->rlim_cur = (unsigned long)rlim64->rlim_cur;\n\tif (rlim64_is_infinity(rlim64->rlim_max))\n\t\trlim->rlim_max = RLIM_INFINITY;\n\telse\n\t\trlim->rlim_max = (unsigned long)rlim64->rlim_max;\n}"
  },
  {
    "function_name": "rlim_to_rlim64",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1537-1547",
    "snippet": "static void rlim_to_rlim64(const struct rlimit *rlim, struct rlimit64 *rlim64)\n{\n\tif (rlim->rlim_cur == RLIM_INFINITY)\n\t\trlim64->rlim_cur = RLIM64_INFINITY;\n\telse\n\t\trlim64->rlim_cur = rlim->rlim_cur;\n\tif (rlim->rlim_max == RLIM_INFINITY)\n\t\trlim64->rlim_max = RLIM64_INFINITY;\n\telse\n\t\trlim64->rlim_max = rlim->rlim_max;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic void rlim_to_rlim64(const struct rlimit *rlim, struct rlimit64 *rlim64)\n{\n\tif (rlim->rlim_cur == RLIM_INFINITY)\n\t\trlim64->rlim_cur = RLIM64_INFINITY;\n\telse\n\t\trlim64->rlim_cur = rlim->rlim_cur;\n\tif (rlim->rlim_max == RLIM_INFINITY)\n\t\trlim64->rlim_max = RLIM64_INFINITY;\n\telse\n\t\trlim64->rlim_max = rlim->rlim_max;\n}"
  },
  {
    "function_name": "rlim64_is_infinity",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1528-1535",
    "snippet": "static inline bool rlim64_is_infinity(__u64 rlim64)\n{\n#if BITS_PER_LONG < 64\n\treturn rlim64 >= ULONG_MAX;\n#else\n\treturn rlim64 == RLIM64_INFINITY;\n#endif\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic inline bool rlim64_is_infinity(__u64 rlim64)\n{\n#if BITS_PER_LONG < 64\n\treturn rlim64 >= ULONG_MAX;\n#else\n\treturn rlim64 == RLIM64_INFINITY;\n#endif\n}"
  },
  {
    "function_name": "override_release",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1246-1270",
    "snippet": "static int override_release(char __user *release, size_t len)\n{\n\tint ret = 0;\n\n\tif (current->personality & UNAME26) {\n\t\tconst char *rest = UTS_RELEASE;\n\t\tchar buf[65] = { 0 };\n\t\tint ndots = 0;\n\t\tunsigned v;\n\t\tsize_t copy;\n\n\t\twhile (*rest) {\n\t\t\tif (*rest == '.' && ++ndots >= 3)\n\t\t\t\tbreak;\n\t\t\tif (!isdigit(*rest) && *rest != '.')\n\t\t\t\tbreak;\n\t\t\trest++;\n\t\t}\n\t\tv = LINUX_VERSION_PATCHLEVEL + 60;\n\t\tcopy = clamp_t(size_t, len, 1, sizeof(buf));\n\t\tcopy = scnprintf(buf, copy, \"2.6.%u%s\", v, rest);\n\t\tret = copy_to_user(release, buf, copy + 1);\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "release",
            "buf",
            "copy + 1"
          ],
          "line": 1267
        },
        "resolved": true,
        "details": {
          "function_name": "sched_attr_copy_to_user",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "7847-7876",
          "snippet": "static int\nsched_attr_copy_to_user(struct sched_attr __user *uattr,\n\t\t\tstruct sched_attr *kattr,\n\t\t\tunsigned int usize)\n{\n\tunsigned int ksize = sizeof(*kattr);\n\n\tif (!access_ok(uattr, usize))\n\t\treturn -EFAULT;\n\n\t/*\n\t * sched_getattr() ABI forwards and backwards compatibility:\n\t *\n\t * If usize == ksize then we just copy everything to user-space and all is good.\n\t *\n\t * If usize < ksize then we only copy as much as user-space has space for,\n\t * this keeps ABI compatibility as well. We skip the rest.\n\t *\n\t * If usize > ksize then user-space is using a newer version of the ABI,\n\t * which part the kernel doesn't know about. Just ignore it - tooling can\n\t * detect the kernel's knowledge of attributes from the attr->size value\n\t * which is set to ksize in this case.\n\t */\n\tkattr->size = min(usize, ksize);\n\n\tif (copy_to_user(uattr, kattr, kattr->size))\n\t\treturn -EFAULT;\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic __always_inline struct;\n\nstatic int\nsched_attr_copy_to_user(struct sched_attr __user *uattr,\n\t\t\tstruct sched_attr *kattr,\n\t\t\tunsigned int usize)\n{\n\tunsigned int ksize = sizeof(*kattr);\n\n\tif (!access_ok(uattr, usize))\n\t\treturn -EFAULT;\n\n\t/*\n\t * sched_getattr() ABI forwards and backwards compatibility:\n\t *\n\t * If usize == ksize then we just copy everything to user-space and all is good.\n\t *\n\t * If usize < ksize then we only copy as much as user-space has space for,\n\t * this keeps ABI compatibility as well. We skip the rest.\n\t *\n\t * If usize > ksize then user-space is using a newer version of the ABI,\n\t * which part the kernel doesn't know about. Just ignore it - tooling can\n\t * detect the kernel's knowledge of attributes from the attr->size value\n\t * which is set to ksize in this case.\n\t */\n\tkattr->size = min(usize, ksize);\n\n\tif (copy_to_user(uattr, kattr, kattr->size))\n\t\treturn -EFAULT;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "scnprintf",
          "args": [
            "buf",
            "copy",
            "\"2.6.%u%s\"",
            "v",
            "rest"
          ],
          "line": 1266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clamp_t",
          "args": [
            "size_t",
            "len",
            "1",
            "sizeof(buf)"
          ],
          "line": 1265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*rest"
          ],
          "line": 1260
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic int override_release(char __user *release, size_t len)\n{\n\tint ret = 0;\n\n\tif (current->personality & UNAME26) {\n\t\tconst char *rest = UTS_RELEASE;\n\t\tchar buf[65] = { 0 };\n\t\tint ndots = 0;\n\t\tunsigned v;\n\t\tsize_t copy;\n\n\t\twhile (*rest) {\n\t\t\tif (*rest == '.' && ++ndots >= 3)\n\t\t\t\tbreak;\n\t\t\tif (!isdigit(*rest) && *rest != '.')\n\t\t\t\tbreak;\n\t\t\trest++;\n\t\t}\n\t\tv = LINUX_VERSION_PATCHLEVEL + 60;\n\t\tcopy = clamp_t(size_t, len, 1, sizeof(buf));\n\t\tcopy = scnprintf(buf, copy, \"2.6.%u%s\", v, rest);\n\t\tret = copy_to_user(release, buf, copy + 1);\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "ksys_setsid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1191-1222",
    "snippet": "int ksys_setsid(void)\n{\n\tstruct task_struct *group_leader = current->group_leader;\n\tstruct pid *sid = task_pid(group_leader);\n\tpid_t session = pid_vnr(sid);\n\tint err = -EPERM;\n\n\twrite_lock_irq(&tasklist_lock);\n\t/* Fail if I am already a session leader */\n\tif (group_leader->signal->leader)\n\t\tgoto out;\n\n\t/* Fail if a process group id already exists that equals the\n\t * proposed session id.\n\t */\n\tif (pid_task(sid, PIDTYPE_PGID))\n\t\tgoto out;\n\n\tgroup_leader->signal->leader = 1;\n\tset_special_pids(sid);\n\n\tproc_clear_tty(group_leader);\n\n\terr = session;\nout:\n\twrite_unlock_irq(&tasklist_lock);\n\tif (err > 0) {\n\t\tproc_sid_connector(group_leader);\n\t\tsched_autogroup_create_attach(group_leader);\n\t}\n\treturn err;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sched_autogroup_create_attach",
          "args": [
            "group_leader"
          ],
          "line": 1219
        },
        "resolved": true,
        "details": {
          "function_name": "sched_autogroup_create_attach",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/autogroup.c",
          "lines": "170-178",
          "snippet": "void sched_autogroup_create_attach(struct task_struct *p)\n{\n\tstruct autogroup *ag = autogroup_create();\n\n\tautogroup_move_group(p, ag);\n\n\t/* Drop extra reference added by autogroup_create(): */\n\tautogroup_kref_put(ag);\n}",
          "includes": [
            "#include \"sched.h\"",
            "#include <linux/nospec.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n#include <linux/nospec.h>\n\nvoid sched_autogroup_create_attach(struct task_struct *p)\n{\n\tstruct autogroup *ag = autogroup_create();\n\n\tautogroup_move_group(p, ag);\n\n\t/* Drop extra reference added by autogroup_create(): */\n\tautogroup_kref_put(ag);\n}"
        }
      },
      {
        "call_info": {
          "callee": "proc_sid_connector",
          "args": [
            "group_leader"
          ],
          "line": 1218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "write_unlock_irq",
          "args": [
            "&tasklist_lock"
          ],
          "line": 1216
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_write_unlock_irq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "356-359",
          "snippet": "void __lockfunc _raw_write_unlock_irq(rwlock_t *lock)\n{\n\t__raw_write_unlock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_write_unlock_irq(rwlock_t *lock)\n{\n\t__raw_write_unlock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "proc_clear_tty",
          "args": [
            "group_leader"
          ],
          "line": 1212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_special_pids",
          "args": [
            "sid"
          ],
          "line": 1210
        },
        "resolved": true,
        "details": {
          "function_name": "set_special_pids",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
          "lines": "1180-1189",
          "snippet": "static void set_special_pids(struct pid *pid)\n{\n\tstruct task_struct *curr = current->group_leader;\n\n\tif (task_session(curr) != pid)\n\t\tchange_pid(curr, PIDTYPE_SID, pid);\n\n\tif (task_pgrp(curr) != pid)\n\t\tchange_pid(curr, PIDTYPE_PGID, pid);\n}",
          "includes": [
            "#include \"uid16.h\"",
            "#include <asm/unistd.h>",
            "#include <asm/io.h>",
            "#include <linux/uaccess.h>",
            "#include <generated/utsrelease.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/nospec.h>",
            "#include <linux/cred.h>",
            "#include <linux/uidgid.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/sched.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/time_namespace.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscall_user_dispatch.h>",
            "#include <linux/ctype.h>",
            "#include <linux/version.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mount.h>",
            "#include <linux/file.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/personality.h>",
            "#include <linux/cpu.h>",
            "#include <linux/seccomp.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/getcpu.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/signal.h>",
            "#include <linux/tty.h>",
            "#include <linux/suspend.h>",
            "#include <linux/security.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/times.h>",
            "#include <linux/key.h>",
            "#include <linux/device.h>",
            "#include <linux/capability.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kernel.h>",
            "#include <linux/resource.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/kmod.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/prctl.h>",
            "#include <linux/reboot.h>",
            "#include <linux/mman.h>",
            "#include <linux/utsname.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic void set_special_pids(struct pid *pid)\n{\n\tstruct task_struct *curr = current->group_leader;\n\n\tif (task_session(curr) != pid)\n\t\tchange_pid(curr, PIDTYPE_SID, pid);\n\n\tif (task_pgrp(curr) != pid)\n\t\tchange_pid(curr, PIDTYPE_PGID, pid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pid_task",
          "args": [
            "sid",
            "PIDTYPE_PGID"
          ],
          "line": 1206
        },
        "resolved": true,
        "details": {
          "function_name": "get_pid_task",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/pid.c",
          "lines": "448-457",
          "snippet": "struct task_struct *get_pid_task(struct pid *pid, enum pid_type type)\n{\n\tstruct task_struct *result;\n\trcu_read_lock();\n\tresult = pid_task(pid, type);\n\tif (result)\n\t\tget_task_struct(result);\n\trcu_read_unlock();\n\treturn result;\n}",
          "includes": [
            "#include <uapi/linux/pidfd.h>",
            "#include <net/sock.h>",
            "#include <linux/idr.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/refcount.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/init_task.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/memblock.h>",
            "#include <linux/rculist.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/pidfd.h>\n#include <net/sock.h>\n#include <linux/idr.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/anon_inodes.h>\n#include <linux/refcount.h>\n#include <linux/proc_ns.h>\n#include <linux/syscalls.h>\n#include <linux/init_task.h>\n#include <linux/pid_namespace.h>\n#include <linux/memblock.h>\n#include <linux/rculist.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n\nstruct task_struct *get_pid_task(struct pid *pid, enum pid_type type)\n{\n\tstruct task_struct *result;\n\trcu_read_lock();\n\tresult = pid_task(pid, type);\n\tif (result)\n\t\tget_task_struct(result);\n\trcu_read_unlock();\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "write_lock_irq",
          "args": [
            "&tasklist_lock"
          ],
          "line": 1198
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_write_lock_irq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "324-327",
          "snippet": "void __lockfunc _raw_write_lock_irq(rwlock_t *lock)\n{\n\t__raw_write_lock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_write_lock_irq(rwlock_t *lock)\n{\n\t__raw_write_lock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pid_vnr",
          "args": [
            "sid"
          ],
          "line": 1195
        },
        "resolved": true,
        "details": {
          "function_name": "pid_vnr",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/pid.c",
          "lines": "486-489",
          "snippet": "pid_t pid_vnr(struct pid *pid)\n{\n\treturn pid_nr_ns(pid, task_active_pid_ns(current));\n}",
          "includes": [
            "#include <uapi/linux/pidfd.h>",
            "#include <net/sock.h>",
            "#include <linux/idr.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/refcount.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/init_task.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/memblock.h>",
            "#include <linux/rculist.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/pidfd.h>\n#include <net/sock.h>\n#include <linux/idr.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/anon_inodes.h>\n#include <linux/refcount.h>\n#include <linux/proc_ns.h>\n#include <linux/syscalls.h>\n#include <linux/init_task.h>\n#include <linux/pid_namespace.h>\n#include <linux/memblock.h>\n#include <linux/rculist.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n\npid_t pid_vnr(struct pid *pid)\n{\n\treturn pid_nr_ns(pid, task_active_pid_ns(current));\n}"
        }
      },
      {
        "call_info": {
          "callee": "task_pid",
          "args": [
            "group_leader"
          ],
          "line": 1194
        },
        "resolved": true,
        "details": {
          "function_name": "init_task_pid_links",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/fork.c",
          "lines": "1710-1716",
          "snippet": "static inline void init_task_pid_links(struct task_struct *task)\n{\n\tenum pid_type type;\n\n\tfor (type = PIDTYPE_PID; type < PIDTYPE_MAX; ++type)\n\t\tINIT_HLIST_NODE(&task->pid_links[type]);\n}",
          "includes": [
            "#include <linux/init_task.h>",
            "#include <trace/events/task.h>",
            "#include <trace/events/sched.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/cacheflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/pgalloc.h>",
            "#include <linux/bpf.h>",
            "#include <linux/io_uring.h>",
            "#include <linux/scs.h>",
            "#include <linux/kasan.h>",
            "#include <linux/stackleak.h>",
            "#include <linux/thread_info.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/kcov.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/compiler.h>",
            "#include <linux/aio.h>",
            "#include <linux/uprobes.h>",
            "#include <linux/signalfd.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/oom.h>",
            "#include <linux/user-return-notifier.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/magic.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/tty.h>",
            "#include <linux/random.h>",
            "#include <linux/taskstats_kern.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/acct.h>",
            "#include <linux/ksm.h>",
            "#include <linux/rmap.h>",
            "#include <linux/profile.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/kthread.h>",
            "#include <linux/compat.h>",
            "#include <linux/futex.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swap.h>",
            "#include <linux/seccomp.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/security.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mman.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/key.h>",
            "#include <linux/iocontext.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/sem.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/personality.h>",
            "#include <linux/completion.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/module.h>",
            "#include <linux/unistd.h>",
            "#include <linux/init.h>",
            "#include <linux/rtmutex.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/slab.h>",
            "#include <linux/anon_inodes.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __latent_entropy struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/init_task.h>\n#include <trace/events/task.h>\n#include <trace/events/sched.h>\n#include <asm/tlbflush.h>\n#include <asm/cacheflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <asm/pgalloc.h>\n#include <linux/bpf.h>\n#include <linux/io_uring.h>\n#include <linux/scs.h>\n#include <linux/kasan.h>\n#include <linux/stackleak.h>\n#include <linux/thread_info.h>\n#include <linux/livepatch.h>\n#include <linux/kcov.h>\n#include <linux/sysctl.h>\n#include <linux/compiler.h>\n#include <linux/aio.h>\n#include <linux/uprobes.h>\n#include <linux/signalfd.h>\n#include <linux/khugepaged.h>\n#include <linux/oom.h>\n#include <linux/user-return-notifier.h>\n#include <linux/posix-timers.h>\n#include <linux/perf_event.h>\n#include <linux/magic.h>\n#include <linux/fs_struct.h>\n#include <linux/tty.h>\n#include <linux/random.h>\n#include <linux/taskstats_kern.h>\n#include <linux/delayacct.h>\n#include <linux/freezer.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/acct.h>\n#include <linux/ksm.h>\n#include <linux/rmap.h>\n#include <linux/profile.h>\n#include <linux/proc_fs.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/ptrace.h>\n#include <linux/rcupdate.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/kthread.h>\n#include <linux/compat.h>\n#include <linux/futex.h>\n#include <linux/jiffies.h>\n#include <linux/syscalls.h>\n#include <linux/swap.h>\n#include <linux/seccomp.h>\n#include <linux/hugetlb.h>\n#include <linux/security.h>\n#include <linux/cgroup.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/nsproxy.h>\n#include <linux/vmacache.h>\n#include <linux/mm_inline.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mman.h>\n#include <linux/binfmts.h>\n#include <linux/key.h>\n#include <linux/iocontext.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/sem.h>\n#include <linux/mempolicy.h>\n#include <linux/personality.h>\n#include <linux/completion.h>\n#include <linux/vmalloc.h>\n#include <linux/module.h>\n#include <linux/unistd.h>\n#include <linux/init.h>\n#include <linux/rtmutex.h>\n#include <linux/seq_file.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/user.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/autogroup.h>\n#include <linux/slab.h>\n#include <linux/anon_inodes.h>\n\nstatic __latent_entropy struct;\n\nstatic inline void init_task_pid_links(struct task_struct *task)\n{\n\tenum pid_type type;\n\n\tfor (type = PIDTYPE_PID; type < PIDTYPE_MAX; ++type)\n\t\tINIT_HLIST_NODE(&task->pid_links[type]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nint ksys_setsid(void)\n{\n\tstruct task_struct *group_leader = current->group_leader;\n\tstruct pid *sid = task_pid(group_leader);\n\tpid_t session = pid_vnr(sid);\n\tint err = -EPERM;\n\n\twrite_lock_irq(&tasklist_lock);\n\t/* Fail if I am already a session leader */\n\tif (group_leader->signal->leader)\n\t\tgoto out;\n\n\t/* Fail if a process group id already exists that equals the\n\t * proposed session id.\n\t */\n\tif (pid_task(sid, PIDTYPE_PGID))\n\t\tgoto out;\n\n\tgroup_leader->signal->leader = 1;\n\tset_special_pids(sid);\n\n\tproc_clear_tty(group_leader);\n\n\terr = session;\nout:\n\twrite_unlock_irq(&tasklist_lock);\n\tif (err > 0) {\n\t\tproc_sid_connector(group_leader);\n\t\tsched_autogroup_create_attach(group_leader);\n\t}\n\treturn err;\n}"
  },
  {
    "function_name": "set_special_pids",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1180-1189",
    "snippet": "static void set_special_pids(struct pid *pid)\n{\n\tstruct task_struct *curr = current->group_leader;\n\n\tif (task_session(curr) != pid)\n\t\tchange_pid(curr, PIDTYPE_SID, pid);\n\n\tif (task_pgrp(curr) != pid)\n\t\tchange_pid(curr, PIDTYPE_PGID, pid);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "change_pid",
          "args": [
            "curr",
            "PIDTYPE_PGID",
            "pid"
          ],
          "line": 1188
        },
        "resolved": true,
        "details": {
          "function_name": "change_pid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/pid.c",
          "lines": "361-366",
          "snippet": "void change_pid(struct task_struct *task, enum pid_type type,\n\t\tstruct pid *pid)\n{\n\t__change_pid(task, type, pid);\n\tattach_pid(task, type);\n}",
          "includes": [
            "#include <uapi/linux/pidfd.h>",
            "#include <net/sock.h>",
            "#include <linux/idr.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/refcount.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/init_task.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/memblock.h>",
            "#include <linux/rculist.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/pidfd.h>\n#include <net/sock.h>\n#include <linux/idr.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/anon_inodes.h>\n#include <linux/refcount.h>\n#include <linux/proc_ns.h>\n#include <linux/syscalls.h>\n#include <linux/init_task.h>\n#include <linux/pid_namespace.h>\n#include <linux/memblock.h>\n#include <linux/rculist.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n\nvoid change_pid(struct task_struct *task, enum pid_type type,\n\t\tstruct pid *pid)\n{\n\t__change_pid(task, type, pid);\n\tattach_pid(task, type);\n}"
        }
      },
      {
        "call_info": {
          "callee": "task_pgrp",
          "args": [
            "curr"
          ],
          "line": 1187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_session",
          "args": [
            "curr"
          ],
          "line": 1184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic void set_special_pids(struct pid *pid)\n{\n\tstruct task_struct *curr = current->group_leader;\n\n\tif (task_session(curr) != pid)\n\t\tchange_pid(curr, PIDTYPE_SID, pid);\n\n\tif (task_pgrp(curr) != pid)\n\t\tchange_pid(curr, PIDTYPE_PGID, pid);\n}"
  },
  {
    "function_name": "do_getpgid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1110-1136",
    "snippet": "static int do_getpgid(pid_t pid)\n{\n\tstruct task_struct *p;\n\tstruct pid *grp;\n\tint retval;\n\n\trcu_read_lock();\n\tif (!pid)\n\t\tgrp = task_pgrp(current);\n\telse {\n\t\tretval = -ESRCH;\n\t\tp = find_task_by_vpid(pid);\n\t\tif (!p)\n\t\t\tgoto out;\n\t\tgrp = task_pgrp(p);\n\t\tif (!grp)\n\t\t\tgoto out;\n\n\t\tretval = security_task_getpgid(p);\n\t\tif (retval)\n\t\t\tgoto out;\n\t}\n\tretval = pid_vnr(grp);\nout:\n\trcu_read_unlock();\n\treturn retval;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 1134
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_read_unlock_strict",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tree_plugin.h",
          "lines": "815-824",
          "snippet": "void rcu_read_unlock_strict(void)\n{\n\tstruct rcu_data *rdp;\n\n\tif (irqs_disabled() || preempt_count() || !rcu_state.gp_kthread)\n\t\treturn;\n\trdp = this_cpu_ptr(&rcu_data);\n\trcu_report_qs_rdp(rdp);\n\tudelay(rcu_unlock_delay);\n}",
          "includes": [
            "#include \"../locking/rtmutex_common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../locking/rtmutex_common.h\"\n\nvoid rcu_read_unlock_strict(void)\n{\n\tstruct rcu_data *rdp;\n\n\tif (irqs_disabled() || preempt_count() || !rcu_state.gp_kthread)\n\t\treturn;\n\trdp = this_cpu_ptr(&rcu_data);\n\trcu_report_qs_rdp(rdp);\n\tudelay(rcu_unlock_delay);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pid_vnr",
          "args": [
            "grp"
          ],
          "line": 1132
        },
        "resolved": true,
        "details": {
          "function_name": "pid_vnr",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/pid.c",
          "lines": "486-489",
          "snippet": "pid_t pid_vnr(struct pid *pid)\n{\n\treturn pid_nr_ns(pid, task_active_pid_ns(current));\n}",
          "includes": [
            "#include <uapi/linux/pidfd.h>",
            "#include <net/sock.h>",
            "#include <linux/idr.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/refcount.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/init_task.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/memblock.h>",
            "#include <linux/rculist.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/pidfd.h>\n#include <net/sock.h>\n#include <linux/idr.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/anon_inodes.h>\n#include <linux/refcount.h>\n#include <linux/proc_ns.h>\n#include <linux/syscalls.h>\n#include <linux/init_task.h>\n#include <linux/pid_namespace.h>\n#include <linux/memblock.h>\n#include <linux/rculist.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n\npid_t pid_vnr(struct pid *pid)\n{\n\treturn pid_nr_ns(pid, task_active_pid_ns(current));\n}"
        }
      },
      {
        "call_info": {
          "callee": "security_task_getpgid",
          "args": [
            "p"
          ],
          "line": 1128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_pgrp",
          "args": [
            "p"
          ],
          "line": 1124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_task_by_vpid",
          "args": [
            "pid"
          ],
          "line": 1121
        },
        "resolved": true,
        "details": {
          "function_name": "find_task_by_vpid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/pid.c",
          "lines": "420-423",
          "snippet": "struct task_struct *find_task_by_vpid(pid_t vnr)\n{\n\treturn find_task_by_pid_ns(vnr, task_active_pid_ns(current));\n}",
          "includes": [
            "#include <uapi/linux/pidfd.h>",
            "#include <net/sock.h>",
            "#include <linux/idr.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/refcount.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/init_task.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/memblock.h>",
            "#include <linux/rculist.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/pidfd.h>\n#include <net/sock.h>\n#include <linux/idr.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/anon_inodes.h>\n#include <linux/refcount.h>\n#include <linux/proc_ns.h>\n#include <linux/syscalls.h>\n#include <linux/init_task.h>\n#include <linux/pid_namespace.h>\n#include <linux/memblock.h>\n#include <linux/rculist.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n\nstruct task_struct *find_task_by_vpid(pid_t vnr)\n{\n\treturn find_task_by_pid_ns(vnr, task_active_pid_ns(current));\n}"
        }
      },
      {
        "call_info": {
          "callee": "task_pgrp",
          "args": [
            "current"
          ],
          "line": 1118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 1116
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_read_lock_any_held",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/update.c",
          "lines": "340-351",
          "snippet": "int rcu_read_lock_any_held(void)\n{\n\tbool ret;\n\n\tif (rcu_read_lock_held_common(&ret))\n\t\treturn ret;\n\tif (lock_is_held(&rcu_lock_map) ||\n\t    lock_is_held(&rcu_bh_lock_map) ||\n\t    lock_is_held(&rcu_sched_lock_map))\n\t\treturn 1;\n\treturn !preemptible();\n}",
          "includes": [
            "#include \"tasks.h\"",
            "#include \"rcu.h\"",
            "#include <linux/rcupdate_trace.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/slab.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/tick.h>",
            "#include <linux/kthread.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/delay.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/export.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tasks.h\"\n#include \"rcu.h\"\n#include <linux/rcupdate_trace.h>\n#include <linux/irq_work.h>\n#include <linux/slab.h>\n#include <linux/kprobes.h>\n#include <linux/sched/isolation.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/tick.h>\n#include <linux/kthread.h>\n#include <linux/moduleparam.h>\n#include <linux/delay.h>\n#include <linux/hardirq.h>\n#include <linux/export.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/signal.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nint rcu_read_lock_any_held(void)\n{\n\tbool ret;\n\n\tif (rcu_read_lock_held_common(&ret))\n\t\treturn ret;\n\tif (lock_is_held(&rcu_lock_map) ||\n\t    lock_is_held(&rcu_bh_lock_map) ||\n\t    lock_is_held(&rcu_sched_lock_map))\n\t\treturn 1;\n\treturn !preemptible();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic int do_getpgid(pid_t pid)\n{\n\tstruct task_struct *p;\n\tstruct pid *grp;\n\tint retval;\n\n\trcu_read_lock();\n\tif (!pid)\n\t\tgrp = task_pgrp(current);\n\telse {\n\t\tretval = -ESRCH;\n\t\tp = find_task_by_vpid(pid);\n\t\tif (!p)\n\t\t\tgoto out;\n\t\tgrp = task_pgrp(p);\n\t\tif (!grp)\n\t\t\tgoto out;\n\n\t\tretval = security_task_getpgid(p);\n\t\tif (retval)\n\t\t\tgoto out;\n\t}\n\tretval = pid_vnr(grp);\nout:\n\trcu_read_unlock();\n\treturn retval;\n}"
  },
  {
    "function_name": "clock_t_to_compat_clock_t",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1003-1006",
    "snippet": "static compat_clock_t clock_t_to_compat_clock_t(clock_t x)\n{\n\treturn compat_jiffies_to_clock_t(clock_t_to_jiffies(x));\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "compat_jiffies_to_clock_t",
          "args": [
            "clock_t_to_jiffies(x)"
          ],
          "line": 1005
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clock_t_to_jiffies",
          "args": [
            "x"
          ],
          "line": 1005
        },
        "resolved": true,
        "details": {
          "function_name": "clock_t_to_jiffies",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/time.c",
          "lines": "635-649",
          "snippet": "unsigned long clock_t_to_jiffies(unsigned long x)\n{\n#if (HZ % USER_HZ)==0\n\tif (x >= ~0UL / (HZ / USER_HZ))\n\t\treturn ~0UL;\n\treturn x * (HZ / USER_HZ);\n#else\n\t/* Don't worry about loss of precision here .. */\n\tif (x >= ~0UL / HZ * USER_HZ)\n\t\treturn ~0UL;\n\n\t/* .. but do try to contain it here */\n\treturn div_u64((u64)x * HZ, USER_HZ);\n#endif\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nunsigned long clock_t_to_jiffies(unsigned long x)\n{\n#if (HZ % USER_HZ)==0\n\tif (x >= ~0UL / (HZ / USER_HZ))\n\t\treturn ~0UL;\n\treturn x * (HZ / USER_HZ);\n#else\n\t/* Don't worry about loss of precision here .. */\n\tif (x >= ~0UL / HZ * USER_HZ)\n\t\treturn ~0UL;\n\n\t/* .. but do try to contain it here */\n\treturn div_u64((u64)x * HZ, USER_HZ);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic compat_clock_t clock_t_to_compat_clock_t(clock_t x)\n{\n\treturn compat_jiffies_to_clock_t(clock_t_to_jiffies(x));\n}"
  },
  {
    "function_name": "do_sys_times",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "976-987",
    "snippet": "static void do_sys_times(struct tms *tms)\n{\n\tu64 tgutime, tgstime, cutime, cstime;\n\n\tthread_group_cputime_adjusted(current, &tgutime, &tgstime);\n\tcutime = current->signal->cutime;\n\tcstime = current->signal->cstime;\n\ttms->tms_utime = nsec_to_clock_t(tgutime);\n\ttms->tms_stime = nsec_to_clock_t(tgstime);\n\ttms->tms_cutime = nsec_to_clock_t(cutime);\n\ttms->tms_cstime = nsec_to_clock_t(cstime);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nsec_to_clock_t",
          "args": [
            "cstime"
          ],
          "line": 986
        },
        "resolved": true,
        "details": {
          "function_name": "nsec_to_clock_t",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/time.c",
          "lines": "674-688",
          "snippet": "u64 nsec_to_clock_t(u64 x)\n{\n#if (NSEC_PER_SEC % USER_HZ) == 0\n\treturn div_u64(x, NSEC_PER_SEC / USER_HZ);\n#elif (USER_HZ % 512) == 0\n\treturn div_u64(x * USER_HZ / 512, NSEC_PER_SEC / 512);\n#else\n\t/*\n         * max relative error 5.7e-8 (1.8s per year) for USER_HZ <= 1024,\n         * overflow after 64.99 years.\n         * exact for HZ=60, 72, 90, 120, 144, 180, 300, 600, 900, ...\n         */\n\treturn div_u64(x * 9, (9ull * NSEC_PER_SEC + (USER_HZ / 2)) / USER_HZ);\n#endif\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nu64 nsec_to_clock_t(u64 x)\n{\n#if (NSEC_PER_SEC % USER_HZ) == 0\n\treturn div_u64(x, NSEC_PER_SEC / USER_HZ);\n#elif (USER_HZ % 512) == 0\n\treturn div_u64(x * USER_HZ / 512, NSEC_PER_SEC / 512);\n#else\n\t/*\n         * max relative error 5.7e-8 (1.8s per year) for USER_HZ <= 1024,\n         * overflow after 64.99 years.\n         * exact for HZ=60, 72, 90, 120, 144, 180, 300, 600, 900, ...\n         */\n\treturn div_u64(x * 9, (9ull * NSEC_PER_SEC + (USER_HZ / 2)) / USER_HZ);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "thread_group_cputime_adjusted",
          "args": [
            "current",
            "&tgutime",
            "&tgstime"
          ],
          "line": 980
        },
        "resolved": true,
        "details": {
          "function_name": "thread_group_cputime_adjusted",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cputime.c",
          "lines": "624-630",
          "snippet": "void thread_group_cputime_adjusted(struct task_struct *p, u64 *ut, u64 *st)\n{\n\tstruct task_cputime cputime;\n\n\tthread_group_cputime(p, &cputime);\n\tcputime_adjust(&cputime, &p->signal->prev_cputime, ut, st);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nvoid thread_group_cputime_adjusted(struct task_struct *p, u64 *ut, u64 *st)\n{\n\tstruct task_cputime cputime;\n\n\tthread_group_cputime(p, &cputime);\n\tcputime_adjust(&cputime, &p->signal->prev_cputime, ut, st);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic void do_sys_times(struct tms *tms)\n{\n\tu64 tgutime, tgstime, cutime, cstime;\n\n\tthread_group_cputime_adjusted(current, &tgutime, &tgstime);\n\tcutime = current->signal->cutime;\n\tcstime = current->signal->cstime;\n\ttms->tms_utime = nsec_to_clock_t(tgutime);\n\ttms->tms_stime = nsec_to_clock_t(tgstime);\n\ttms->tms_cutime = nsec_to_clock_t(cutime);\n\ttms->tms_cstime = nsec_to_clock_t(cstime);\n}"
  },
  {
    "function_name": "__sys_setfsgid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "873-907",
    "snippet": "long __sys_setfsgid(gid_t gid)\n{\n\tconst struct cred *old;\n\tstruct cred *new;\n\tgid_t old_fsgid;\n\tkgid_t kgid;\n\n\told = current_cred();\n\told_fsgid = from_kgid_munged(old->user_ns, old->fsgid);\n\n\tkgid = make_kgid(old->user_ns, gid);\n\tif (!gid_valid(kgid))\n\t\treturn old_fsgid;\n\n\tnew = prepare_creds();\n\tif (!new)\n\t\treturn old_fsgid;\n\n\tif (gid_eq(kgid, old->gid)  || gid_eq(kgid, old->egid)  ||\n\t    gid_eq(kgid, old->sgid) || gid_eq(kgid, old->fsgid) ||\n\t    ns_capable_setid(old->user_ns, CAP_SETGID)) {\n\t\tif (!gid_eq(kgid, old->fsgid)) {\n\t\t\tnew->fsgid = kgid;\n\t\t\tif (security_task_fix_setgid(new,old,LSM_SETID_FS) == 0)\n\t\t\t\tgoto change_okay;\n\t\t}\n\t}\n\n\tabort_creds(new);\n\treturn old_fsgid;\n\nchange_okay:\n\tcommit_creds(new);\n\treturn old_fsgid;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "commit_creds",
          "args": [
            "new"
          ],
          "line": 905
        },
        "resolved": true,
        "details": {
          "function_name": "commit_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "447-523",
          "snippet": "int commit_creds(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\n\tkdebug(\"commit_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n\tBUG_ON(task->cred != old);\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(old) < 2);\n\tvalidate_creds(old);\n\tvalidate_creds(new);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\n\tget_cred(new); /* we will require a ref for the subj creds too */\n\n\t/* dumpability changes */\n\tif (!uid_eq(old->euid, new->euid) ||\n\t    !gid_eq(old->egid, new->egid) ||\n\t    !uid_eq(old->fsuid, new->fsuid) ||\n\t    !gid_eq(old->fsgid, new->fsgid) ||\n\t    !cred_cap_issubset(old, new)) {\n\t\tif (task->mm)\n\t\t\tset_dumpable(task->mm, suid_dumpable);\n\t\ttask->pdeath_signal = 0;\n\t\t/*\n\t\t * If a task drops privileges and becomes nondumpable,\n\t\t * the dumpability change must become visible before\n\t\t * the credential change; otherwise, a __ptrace_may_access()\n\t\t * racing with this change may be able to attach to a task it\n\t\t * shouldn't be able to attach to (as if the task had dropped\n\t\t * privileges without becoming nondumpable).\n\t\t * Pairs with a read barrier in __ptrace_may_access().\n\t\t */\n\t\tsmp_wmb();\n\t}\n\n\t/* alter the thread keyring */\n\tif (!uid_eq(new->fsuid, old->fsuid))\n\t\tkey_fsuid_changed(new);\n\tif (!gid_eq(new->fsgid, old->fsgid))\n\t\tkey_fsgid_changed(new);\n\n\t/* do it\n\t * RLIMIT_NPROC limits on user->processes have already been checked\n\t * in set_user().\n\t */\n\talter_cred_subscribers(new, 2);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tinc_rlimit_ucounts(new->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\trcu_assign_pointer(task->real_cred, new);\n\trcu_assign_pointer(task->cred, new);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tdec_rlimit_ucounts(old->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\talter_cred_subscribers(old, -2);\n\n\t/* send notifications */\n\tif (!uid_eq(new->uid,   old->uid)  ||\n\t    !uid_eq(new->euid,  old->euid) ||\n\t    !uid_eq(new->suid,  old->suid) ||\n\t    !uid_eq(new->fsuid, old->fsuid))\n\t\tproc_id_connector(task, PROC_EVENT_UID);\n\n\tif (!gid_eq(new->gid,   old->gid)  ||\n\t    !gid_eq(new->egid,  old->egid) ||\n\t    !gid_eq(new->sgid,  old->sgid) ||\n\t    !gid_eq(new->fsgid, old->fsgid))\n\t\tproc_id_connector(task, PROC_EVENT_GID);\n\n\t/* release the old obj and subj refs both */\n\tput_cred(old);\n\tput_cred(old);\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nint commit_creds(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\n\tkdebug(\"commit_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n\tBUG_ON(task->cred != old);\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(old) < 2);\n\tvalidate_creds(old);\n\tvalidate_creds(new);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\n\tget_cred(new); /* we will require a ref for the subj creds too */\n\n\t/* dumpability changes */\n\tif (!uid_eq(old->euid, new->euid) ||\n\t    !gid_eq(old->egid, new->egid) ||\n\t    !uid_eq(old->fsuid, new->fsuid) ||\n\t    !gid_eq(old->fsgid, new->fsgid) ||\n\t    !cred_cap_issubset(old, new)) {\n\t\tif (task->mm)\n\t\t\tset_dumpable(task->mm, suid_dumpable);\n\t\ttask->pdeath_signal = 0;\n\t\t/*\n\t\t * If a task drops privileges and becomes nondumpable,\n\t\t * the dumpability change must become visible before\n\t\t * the credential change; otherwise, a __ptrace_may_access()\n\t\t * racing with this change may be able to attach to a task it\n\t\t * shouldn't be able to attach to (as if the task had dropped\n\t\t * privileges without becoming nondumpable).\n\t\t * Pairs with a read barrier in __ptrace_may_access().\n\t\t */\n\t\tsmp_wmb();\n\t}\n\n\t/* alter the thread keyring */\n\tif (!uid_eq(new->fsuid, old->fsuid))\n\t\tkey_fsuid_changed(new);\n\tif (!gid_eq(new->fsgid, old->fsgid))\n\t\tkey_fsgid_changed(new);\n\n\t/* do it\n\t * RLIMIT_NPROC limits on user->processes have already been checked\n\t * in set_user().\n\t */\n\talter_cred_subscribers(new, 2);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tinc_rlimit_ucounts(new->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\trcu_assign_pointer(task->real_cred, new);\n\trcu_assign_pointer(task->cred, new);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tdec_rlimit_ucounts(old->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\talter_cred_subscribers(old, -2);\n\n\t/* send notifications */\n\tif (!uid_eq(new->uid,   old->uid)  ||\n\t    !uid_eq(new->euid,  old->euid) ||\n\t    !uid_eq(new->suid,  old->suid) ||\n\t    !uid_eq(new->fsuid, old->fsuid))\n\t\tproc_id_connector(task, PROC_EVENT_UID);\n\n\tif (!gid_eq(new->gid,   old->gid)  ||\n\t    !gid_eq(new->egid,  old->egid) ||\n\t    !gid_eq(new->sgid,  old->sgid) ||\n\t    !gid_eq(new->fsgid, old->fsgid))\n\t\tproc_id_connector(task, PROC_EVENT_GID);\n\n\t/* release the old obj and subj refs both */\n\tput_cred(old);\n\tput_cred(old);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "abort_creds",
          "args": [
            "new"
          ],
          "line": 901
        },
        "resolved": true,
        "details": {
          "function_name": "abort_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "533-544",
          "snippet": "void abort_creds(struct cred *new)\n{\n\tkdebug(\"abort_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(new) != 0);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\tput_cred(new);\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nvoid abort_creds(struct cred *new)\n{\n\tkdebug(\"abort_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(new) != 0);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\tput_cred(new);\n}"
        }
      },
      {
        "call_info": {
          "callee": "security_task_fix_setgid",
          "args": [
            "new",
            "old",
            "LSM_SETID_FS"
          ],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "kgid",
            "old->fsgid"
          ],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ns_capable_setid",
          "args": [
            "old->user_ns",
            "CAP_SETGID"
          ],
          "line": 893
        },
        "resolved": true,
        "details": {
          "function_name": "ns_capable_setid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/capability.c",
          "lines": "431-434",
          "snippet": "bool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/user_namespace.h>\n#include <linux/pid_namespace.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n\nbool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "kgid",
            "old->fsgid"
          ],
          "line": 892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "kgid",
            "old->sgid"
          ],
          "line": 892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "kgid",
            "old->egid"
          ],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "kgid",
            "old->gid"
          ],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_creds",
          "args": [],
          "line": 887
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "252-300",
          "snippet": "struct cred *prepare_creds(void)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old;\n\tstruct cred *new;\n\n\tvalidate_process_creds();\n\n\tnew = kmem_cache_alloc(cred_jar, GFP_KERNEL);\n\tif (!new)\n\t\treturn NULL;\n\n\tkdebug(\"prepare_creds() alloc %p\", new);\n\n\told = task->cred;\n\tmemcpy(new, old, sizeof(struct cred));\n\n\tnew->non_rcu = 0;\n\tatomic_set(&new->usage, 1);\n\tset_cred_subscribers(new, 0);\n\tget_group_info(new->group_info);\n\tget_uid(new->user);\n\tget_user_ns(new->user_ns);\n\n#ifdef CONFIG_KEYS\n\tkey_get(new->session_keyring);\n\tkey_get(new->process_keyring);\n\tkey_get(new->thread_keyring);\n\tkey_get(new->request_key_auth);\n#endif\n\n#ifdef CONFIG_SECURITY\n\tnew->security = NULL;\n#endif\n\n\tnew->ucounts = get_ucounts(new->ucounts);\n\tif (!new->ucounts)\n\t\tgoto error;\n\n\tif (security_prepare_creds(new, old, GFP_KERNEL_ACCOUNT) < 0)\n\t\tgoto error;\n\n\tvalidate_creds(new);\n\treturn new;\n\nerror:\n\tabort_creds(new);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *cred_jar;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nstatic struct kmem_cache *cred_jar;\n\nstruct cred *prepare_creds(void)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old;\n\tstruct cred *new;\n\n\tvalidate_process_creds();\n\n\tnew = kmem_cache_alloc(cred_jar, GFP_KERNEL);\n\tif (!new)\n\t\treturn NULL;\n\n\tkdebug(\"prepare_creds() alloc %p\", new);\n\n\told = task->cred;\n\tmemcpy(new, old, sizeof(struct cred));\n\n\tnew->non_rcu = 0;\n\tatomic_set(&new->usage, 1);\n\tset_cred_subscribers(new, 0);\n\tget_group_info(new->group_info);\n\tget_uid(new->user);\n\tget_user_ns(new->user_ns);\n\n#ifdef CONFIG_KEYS\n\tkey_get(new->session_keyring);\n\tkey_get(new->process_keyring);\n\tkey_get(new->thread_keyring);\n\tkey_get(new->request_key_auth);\n#endif\n\n#ifdef CONFIG_SECURITY\n\tnew->security = NULL;\n#endif\n\n\tnew->ucounts = get_ucounts(new->ucounts);\n\tif (!new->ucounts)\n\t\tgoto error;\n\n\tif (security_prepare_creds(new, old, GFP_KERNEL_ACCOUNT) < 0)\n\t\tgoto error;\n\n\tvalidate_creds(new);\n\treturn new;\n\nerror:\n\tabort_creds(new);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gid_valid",
          "args": [
            "kgid"
          ],
          "line": 884
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kgid",
          "args": [
            "old->user_ns",
            "gid"
          ],
          "line": 883
        },
        "resolved": true,
        "details": {
          "function_name": "make_kgid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/user_namespace.c",
          "lines": "459-463",
          "snippet": "kgid_t make_kgid(struct user_namespace *ns, gid_t gid)\n{\n\t/* Map the gid to a global kernel gid */\n\treturn KGIDT_INIT(map_id_down(&ns->gid_map, gid));\n}",
          "includes": [
            "#include <linux/sort.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/projid.h>",
            "#include <linux/ctype.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fs.h>",
            "#include <linux/seq_file.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/securebits.h>",
            "#include <linux/cred.h>",
            "#include <linux/highuid.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sort.h>\n#include <linux/bsearch.h>\n#include <linux/fs_struct.h>\n#include <linux/projid.h>\n#include <linux/ctype.h>\n#include <linux/uaccess.h>\n#include <linux/fs.h>\n#include <linux/seq_file.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/securebits.h>\n#include <linux/cred.h>\n#include <linux/highuid.h>\n#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n\nkgid_t make_kgid(struct user_namespace *ns, gid_t gid)\n{\n\t/* Map the gid to a global kernel gid */\n\treturn KGIDT_INIT(map_id_down(&ns->gid_map, gid));\n}"
        }
      },
      {
        "call_info": {
          "callee": "from_kgid_munged",
          "args": [
            "old->user_ns",
            "old->fsgid"
          ],
          "line": 881
        },
        "resolved": true,
        "details": {
          "function_name": "from_kgid_munged",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/user_namespace.c",
          "lines": "502-510",
          "snippet": "gid_t from_kgid_munged(struct user_namespace *targ, kgid_t kgid)\n{\n\tgid_t gid;\n\tgid = from_kgid(targ, kgid);\n\n\tif (gid == (gid_t) -1)\n\t\tgid = overflowgid;\n\treturn gid;\n}",
          "includes": [
            "#include <linux/sort.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/projid.h>",
            "#include <linux/ctype.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fs.h>",
            "#include <linux/seq_file.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/securebits.h>",
            "#include <linux/cred.h>",
            "#include <linux/highuid.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sort.h>\n#include <linux/bsearch.h>\n#include <linux/fs_struct.h>\n#include <linux/projid.h>\n#include <linux/ctype.h>\n#include <linux/uaccess.h>\n#include <linux/fs.h>\n#include <linux/seq_file.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/securebits.h>\n#include <linux/cred.h>\n#include <linux/highuid.h>\n#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n\ngid_t from_kgid_munged(struct user_namespace *targ, kgid_t kgid)\n{\n\tgid_t gid;\n\tgid = from_kgid(targ, kgid);\n\n\tif (gid == (gid_t) -1)\n\t\tgid = overflowgid;\n\treturn gid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_cred",
          "args": [],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nlong __sys_setfsgid(gid_t gid)\n{\n\tconst struct cred *old;\n\tstruct cred *new;\n\tgid_t old_fsgid;\n\tkgid_t kgid;\n\n\told = current_cred();\n\told_fsgid = from_kgid_munged(old->user_ns, old->fsgid);\n\n\tkgid = make_kgid(old->user_ns, gid);\n\tif (!gid_valid(kgid))\n\t\treturn old_fsgid;\n\n\tnew = prepare_creds();\n\tif (!new)\n\t\treturn old_fsgid;\n\n\tif (gid_eq(kgid, old->gid)  || gid_eq(kgid, old->egid)  ||\n\t    gid_eq(kgid, old->sgid) || gid_eq(kgid, old->fsgid) ||\n\t    ns_capable_setid(old->user_ns, CAP_SETGID)) {\n\t\tif (!gid_eq(kgid, old->fsgid)) {\n\t\t\tnew->fsgid = kgid;\n\t\t\tif (security_task_fix_setgid(new,old,LSM_SETID_FS) == 0)\n\t\t\t\tgoto change_okay;\n\t\t}\n\t}\n\n\tabort_creds(new);\n\treturn old_fsgid;\n\nchange_okay:\n\tcommit_creds(new);\n\treturn old_fsgid;\n}"
  },
  {
    "function_name": "__sys_setfsuid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "829-863",
    "snippet": "long __sys_setfsuid(uid_t uid)\n{\n\tconst struct cred *old;\n\tstruct cred *new;\n\tuid_t old_fsuid;\n\tkuid_t kuid;\n\n\told = current_cred();\n\told_fsuid = from_kuid_munged(old->user_ns, old->fsuid);\n\n\tkuid = make_kuid(old->user_ns, uid);\n\tif (!uid_valid(kuid))\n\t\treturn old_fsuid;\n\n\tnew = prepare_creds();\n\tif (!new)\n\t\treturn old_fsuid;\n\n\tif (uid_eq(kuid, old->uid)  || uid_eq(kuid, old->euid)  ||\n\t    uid_eq(kuid, old->suid) || uid_eq(kuid, old->fsuid) ||\n\t    ns_capable_setid(old->user_ns, CAP_SETUID)) {\n\t\tif (!uid_eq(kuid, old->fsuid)) {\n\t\t\tnew->fsuid = kuid;\n\t\t\tif (security_task_fix_setuid(new, old, LSM_SETID_FS) == 0)\n\t\t\t\tgoto change_okay;\n\t\t}\n\t}\n\n\tabort_creds(new);\n\treturn old_fsuid;\n\nchange_okay:\n\tcommit_creds(new);\n\treturn old_fsuid;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "commit_creds",
          "args": [
            "new"
          ],
          "line": 861
        },
        "resolved": true,
        "details": {
          "function_name": "commit_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "447-523",
          "snippet": "int commit_creds(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\n\tkdebug(\"commit_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n\tBUG_ON(task->cred != old);\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(old) < 2);\n\tvalidate_creds(old);\n\tvalidate_creds(new);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\n\tget_cred(new); /* we will require a ref for the subj creds too */\n\n\t/* dumpability changes */\n\tif (!uid_eq(old->euid, new->euid) ||\n\t    !gid_eq(old->egid, new->egid) ||\n\t    !uid_eq(old->fsuid, new->fsuid) ||\n\t    !gid_eq(old->fsgid, new->fsgid) ||\n\t    !cred_cap_issubset(old, new)) {\n\t\tif (task->mm)\n\t\t\tset_dumpable(task->mm, suid_dumpable);\n\t\ttask->pdeath_signal = 0;\n\t\t/*\n\t\t * If a task drops privileges and becomes nondumpable,\n\t\t * the dumpability change must become visible before\n\t\t * the credential change; otherwise, a __ptrace_may_access()\n\t\t * racing with this change may be able to attach to a task it\n\t\t * shouldn't be able to attach to (as if the task had dropped\n\t\t * privileges without becoming nondumpable).\n\t\t * Pairs with a read barrier in __ptrace_may_access().\n\t\t */\n\t\tsmp_wmb();\n\t}\n\n\t/* alter the thread keyring */\n\tif (!uid_eq(new->fsuid, old->fsuid))\n\t\tkey_fsuid_changed(new);\n\tif (!gid_eq(new->fsgid, old->fsgid))\n\t\tkey_fsgid_changed(new);\n\n\t/* do it\n\t * RLIMIT_NPROC limits on user->processes have already been checked\n\t * in set_user().\n\t */\n\talter_cred_subscribers(new, 2);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tinc_rlimit_ucounts(new->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\trcu_assign_pointer(task->real_cred, new);\n\trcu_assign_pointer(task->cred, new);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tdec_rlimit_ucounts(old->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\talter_cred_subscribers(old, -2);\n\n\t/* send notifications */\n\tif (!uid_eq(new->uid,   old->uid)  ||\n\t    !uid_eq(new->euid,  old->euid) ||\n\t    !uid_eq(new->suid,  old->suid) ||\n\t    !uid_eq(new->fsuid, old->fsuid))\n\t\tproc_id_connector(task, PROC_EVENT_UID);\n\n\tif (!gid_eq(new->gid,   old->gid)  ||\n\t    !gid_eq(new->egid,  old->egid) ||\n\t    !gid_eq(new->sgid,  old->sgid) ||\n\t    !gid_eq(new->fsgid, old->fsgid))\n\t\tproc_id_connector(task, PROC_EVENT_GID);\n\n\t/* release the old obj and subj refs both */\n\tput_cred(old);\n\tput_cred(old);\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nint commit_creds(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\n\tkdebug(\"commit_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n\tBUG_ON(task->cred != old);\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(old) < 2);\n\tvalidate_creds(old);\n\tvalidate_creds(new);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\n\tget_cred(new); /* we will require a ref for the subj creds too */\n\n\t/* dumpability changes */\n\tif (!uid_eq(old->euid, new->euid) ||\n\t    !gid_eq(old->egid, new->egid) ||\n\t    !uid_eq(old->fsuid, new->fsuid) ||\n\t    !gid_eq(old->fsgid, new->fsgid) ||\n\t    !cred_cap_issubset(old, new)) {\n\t\tif (task->mm)\n\t\t\tset_dumpable(task->mm, suid_dumpable);\n\t\ttask->pdeath_signal = 0;\n\t\t/*\n\t\t * If a task drops privileges and becomes nondumpable,\n\t\t * the dumpability change must become visible before\n\t\t * the credential change; otherwise, a __ptrace_may_access()\n\t\t * racing with this change may be able to attach to a task it\n\t\t * shouldn't be able to attach to (as if the task had dropped\n\t\t * privileges without becoming nondumpable).\n\t\t * Pairs with a read barrier in __ptrace_may_access().\n\t\t */\n\t\tsmp_wmb();\n\t}\n\n\t/* alter the thread keyring */\n\tif (!uid_eq(new->fsuid, old->fsuid))\n\t\tkey_fsuid_changed(new);\n\tif (!gid_eq(new->fsgid, old->fsgid))\n\t\tkey_fsgid_changed(new);\n\n\t/* do it\n\t * RLIMIT_NPROC limits on user->processes have already been checked\n\t * in set_user().\n\t */\n\talter_cred_subscribers(new, 2);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tinc_rlimit_ucounts(new->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\trcu_assign_pointer(task->real_cred, new);\n\trcu_assign_pointer(task->cred, new);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tdec_rlimit_ucounts(old->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\talter_cred_subscribers(old, -2);\n\n\t/* send notifications */\n\tif (!uid_eq(new->uid,   old->uid)  ||\n\t    !uid_eq(new->euid,  old->euid) ||\n\t    !uid_eq(new->suid,  old->suid) ||\n\t    !uid_eq(new->fsuid, old->fsuid))\n\t\tproc_id_connector(task, PROC_EVENT_UID);\n\n\tif (!gid_eq(new->gid,   old->gid)  ||\n\t    !gid_eq(new->egid,  old->egid) ||\n\t    !gid_eq(new->sgid,  old->sgid) ||\n\t    !gid_eq(new->fsgid, old->fsgid))\n\t\tproc_id_connector(task, PROC_EVENT_GID);\n\n\t/* release the old obj and subj refs both */\n\tput_cred(old);\n\tput_cred(old);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "abort_creds",
          "args": [
            "new"
          ],
          "line": 857
        },
        "resolved": true,
        "details": {
          "function_name": "abort_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "533-544",
          "snippet": "void abort_creds(struct cred *new)\n{\n\tkdebug(\"abort_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(new) != 0);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\tput_cred(new);\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nvoid abort_creds(struct cred *new)\n{\n\tkdebug(\"abort_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(new) != 0);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\tput_cred(new);\n}"
        }
      },
      {
        "call_info": {
          "callee": "security_task_fix_setuid",
          "args": [
            "new",
            "old",
            "LSM_SETID_FS"
          ],
          "line": 852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "kuid",
            "old->fsuid"
          ],
          "line": 850
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ns_capable_setid",
          "args": [
            "old->user_ns",
            "CAP_SETUID"
          ],
          "line": 849
        },
        "resolved": true,
        "details": {
          "function_name": "ns_capable_setid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/capability.c",
          "lines": "431-434",
          "snippet": "bool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/user_namespace.h>\n#include <linux/pid_namespace.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n\nbool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}"
        }
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "kuid",
            "old->fsuid"
          ],
          "line": 848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "kuid",
            "old->suid"
          ],
          "line": 848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "kuid",
            "old->euid"
          ],
          "line": 847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "kuid",
            "old->uid"
          ],
          "line": 847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_creds",
          "args": [],
          "line": 843
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "252-300",
          "snippet": "struct cred *prepare_creds(void)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old;\n\tstruct cred *new;\n\n\tvalidate_process_creds();\n\n\tnew = kmem_cache_alloc(cred_jar, GFP_KERNEL);\n\tif (!new)\n\t\treturn NULL;\n\n\tkdebug(\"prepare_creds() alloc %p\", new);\n\n\told = task->cred;\n\tmemcpy(new, old, sizeof(struct cred));\n\n\tnew->non_rcu = 0;\n\tatomic_set(&new->usage, 1);\n\tset_cred_subscribers(new, 0);\n\tget_group_info(new->group_info);\n\tget_uid(new->user);\n\tget_user_ns(new->user_ns);\n\n#ifdef CONFIG_KEYS\n\tkey_get(new->session_keyring);\n\tkey_get(new->process_keyring);\n\tkey_get(new->thread_keyring);\n\tkey_get(new->request_key_auth);\n#endif\n\n#ifdef CONFIG_SECURITY\n\tnew->security = NULL;\n#endif\n\n\tnew->ucounts = get_ucounts(new->ucounts);\n\tif (!new->ucounts)\n\t\tgoto error;\n\n\tif (security_prepare_creds(new, old, GFP_KERNEL_ACCOUNT) < 0)\n\t\tgoto error;\n\n\tvalidate_creds(new);\n\treturn new;\n\nerror:\n\tabort_creds(new);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *cred_jar;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nstatic struct kmem_cache *cred_jar;\n\nstruct cred *prepare_creds(void)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old;\n\tstruct cred *new;\n\n\tvalidate_process_creds();\n\n\tnew = kmem_cache_alloc(cred_jar, GFP_KERNEL);\n\tif (!new)\n\t\treturn NULL;\n\n\tkdebug(\"prepare_creds() alloc %p\", new);\n\n\told = task->cred;\n\tmemcpy(new, old, sizeof(struct cred));\n\n\tnew->non_rcu = 0;\n\tatomic_set(&new->usage, 1);\n\tset_cred_subscribers(new, 0);\n\tget_group_info(new->group_info);\n\tget_uid(new->user);\n\tget_user_ns(new->user_ns);\n\n#ifdef CONFIG_KEYS\n\tkey_get(new->session_keyring);\n\tkey_get(new->process_keyring);\n\tkey_get(new->thread_keyring);\n\tkey_get(new->request_key_auth);\n#endif\n\n#ifdef CONFIG_SECURITY\n\tnew->security = NULL;\n#endif\n\n\tnew->ucounts = get_ucounts(new->ucounts);\n\tif (!new->ucounts)\n\t\tgoto error;\n\n\tif (security_prepare_creds(new, old, GFP_KERNEL_ACCOUNT) < 0)\n\t\tgoto error;\n\n\tvalidate_creds(new);\n\treturn new;\n\nerror:\n\tabort_creds(new);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "uid_valid",
          "args": [
            "kuid"
          ],
          "line": 840
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kuid",
          "args": [
            "old->user_ns",
            "uid"
          ],
          "line": 839
        },
        "resolved": true,
        "details": {
          "function_name": "make_kuid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/user_namespace.c",
          "lines": "391-395",
          "snippet": "kuid_t make_kuid(struct user_namespace *ns, uid_t uid)\n{\n\t/* Map the uid to a global kernel uid */\n\treturn KUIDT_INIT(map_id_down(&ns->uid_map, uid));\n}",
          "includes": [
            "#include <linux/sort.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/projid.h>",
            "#include <linux/ctype.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fs.h>",
            "#include <linux/seq_file.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/securebits.h>",
            "#include <linux/cred.h>",
            "#include <linux/highuid.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sort.h>\n#include <linux/bsearch.h>\n#include <linux/fs_struct.h>\n#include <linux/projid.h>\n#include <linux/ctype.h>\n#include <linux/uaccess.h>\n#include <linux/fs.h>\n#include <linux/seq_file.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/securebits.h>\n#include <linux/cred.h>\n#include <linux/highuid.h>\n#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n\nkuid_t make_kuid(struct user_namespace *ns, uid_t uid)\n{\n\t/* Map the uid to a global kernel uid */\n\treturn KUIDT_INIT(map_id_down(&ns->uid_map, uid));\n}"
        }
      },
      {
        "call_info": {
          "callee": "from_kuid_munged",
          "args": [
            "old->user_ns",
            "old->fsuid"
          ],
          "line": 837
        },
        "resolved": true,
        "details": {
          "function_name": "from_kuid_munged",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/user_namespace.c",
          "lines": "435-443",
          "snippet": "uid_t from_kuid_munged(struct user_namespace *targ, kuid_t kuid)\n{\n\tuid_t uid;\n\tuid = from_kuid(targ, kuid);\n\n\tif (uid == (uid_t) -1)\n\t\tuid = overflowuid;\n\treturn uid;\n}",
          "includes": [
            "#include <linux/sort.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/projid.h>",
            "#include <linux/ctype.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fs.h>",
            "#include <linux/seq_file.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/securebits.h>",
            "#include <linux/cred.h>",
            "#include <linux/highuid.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sort.h>\n#include <linux/bsearch.h>\n#include <linux/fs_struct.h>\n#include <linux/projid.h>\n#include <linux/ctype.h>\n#include <linux/uaccess.h>\n#include <linux/fs.h>\n#include <linux/seq_file.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/securebits.h>\n#include <linux/cred.h>\n#include <linux/highuid.h>\n#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n\nuid_t from_kuid_munged(struct user_namespace *targ, kuid_t kuid)\n{\n\tuid_t uid;\n\tuid = from_kuid(targ, kuid);\n\n\tif (uid == (uid_t) -1)\n\t\tuid = overflowuid;\n\treturn uid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_cred",
          "args": [],
          "line": 836
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nlong __sys_setfsuid(uid_t uid)\n{\n\tconst struct cred *old;\n\tstruct cred *new;\n\tuid_t old_fsuid;\n\tkuid_t kuid;\n\n\told = current_cred();\n\told_fsuid = from_kuid_munged(old->user_ns, old->fsuid);\n\n\tkuid = make_kuid(old->user_ns, uid);\n\tif (!uid_valid(kuid))\n\t\treturn old_fsuid;\n\n\tnew = prepare_creds();\n\tif (!new)\n\t\treturn old_fsuid;\n\n\tif (uid_eq(kuid, old->uid)  || uid_eq(kuid, old->euid)  ||\n\t    uid_eq(kuid, old->suid) || uid_eq(kuid, old->fsuid) ||\n\t    ns_capable_setid(old->user_ns, CAP_SETUID)) {\n\t\tif (!uid_eq(kuid, old->fsuid)) {\n\t\t\tnew->fsuid = kuid;\n\t\t\tif (security_task_fix_setuid(new, old, LSM_SETID_FS) == 0)\n\t\t\t\tgoto change_okay;\n\t\t}\n\t}\n\n\tabort_creds(new);\n\treturn old_fsuid;\n\nchange_okay:\n\tcommit_creds(new);\n\treturn old_fsuid;\n}"
  },
  {
    "function_name": "__sys_setresgid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "741-795",
    "snippet": "long __sys_setresgid(gid_t rgid, gid_t egid, gid_t sgid)\n{\n\tstruct user_namespace *ns = current_user_ns();\n\tconst struct cred *old;\n\tstruct cred *new;\n\tint retval;\n\tkgid_t krgid, kegid, ksgid;\n\n\tkrgid = make_kgid(ns, rgid);\n\tkegid = make_kgid(ns, egid);\n\tksgid = make_kgid(ns, sgid);\n\n\tif ((rgid != (gid_t) -1) && !gid_valid(krgid))\n\t\treturn -EINVAL;\n\tif ((egid != (gid_t) -1) && !gid_valid(kegid))\n\t\treturn -EINVAL;\n\tif ((sgid != (gid_t) -1) && !gid_valid(ksgid))\n\t\treturn -EINVAL;\n\n\tnew = prepare_creds();\n\tif (!new)\n\t\treturn -ENOMEM;\n\told = current_cred();\n\n\tretval = -EPERM;\n\tif (!ns_capable_setid(old->user_ns, CAP_SETGID)) {\n\t\tif (rgid != (gid_t) -1        && !gid_eq(krgid, old->gid) &&\n\t\t    !gid_eq(krgid, old->egid) && !gid_eq(krgid, old->sgid))\n\t\t\tgoto error;\n\t\tif (egid != (gid_t) -1        && !gid_eq(kegid, old->gid) &&\n\t\t    !gid_eq(kegid, old->egid) && !gid_eq(kegid, old->sgid))\n\t\t\tgoto error;\n\t\tif (sgid != (gid_t) -1        && !gid_eq(ksgid, old->gid) &&\n\t\t    !gid_eq(ksgid, old->egid) && !gid_eq(ksgid, old->sgid))\n\t\t\tgoto error;\n\t}\n\n\tif (rgid != (gid_t) -1)\n\t\tnew->gid = krgid;\n\tif (egid != (gid_t) -1)\n\t\tnew->egid = kegid;\n\tif (sgid != (gid_t) -1)\n\t\tnew->sgid = ksgid;\n\tnew->fsgid = new->egid;\n\n\tretval = security_task_fix_setgid(new, old, LSM_SETID_RES);\n\tif (retval < 0)\n\t\tgoto error;\n\n\treturn commit_creds(new);\n\nerror:\n\tabort_creds(new);\n\treturn retval;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "abort_creds",
          "args": [
            "new"
          ],
          "line": 793
        },
        "resolved": true,
        "details": {
          "function_name": "abort_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "533-544",
          "snippet": "void abort_creds(struct cred *new)\n{\n\tkdebug(\"abort_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(new) != 0);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\tput_cred(new);\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nvoid abort_creds(struct cred *new)\n{\n\tkdebug(\"abort_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(new) != 0);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\tput_cred(new);\n}"
        }
      },
      {
        "call_info": {
          "callee": "commit_creds",
          "args": [
            "new"
          ],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "commit_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "447-523",
          "snippet": "int commit_creds(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\n\tkdebug(\"commit_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n\tBUG_ON(task->cred != old);\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(old) < 2);\n\tvalidate_creds(old);\n\tvalidate_creds(new);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\n\tget_cred(new); /* we will require a ref for the subj creds too */\n\n\t/* dumpability changes */\n\tif (!uid_eq(old->euid, new->euid) ||\n\t    !gid_eq(old->egid, new->egid) ||\n\t    !uid_eq(old->fsuid, new->fsuid) ||\n\t    !gid_eq(old->fsgid, new->fsgid) ||\n\t    !cred_cap_issubset(old, new)) {\n\t\tif (task->mm)\n\t\t\tset_dumpable(task->mm, suid_dumpable);\n\t\ttask->pdeath_signal = 0;\n\t\t/*\n\t\t * If a task drops privileges and becomes nondumpable,\n\t\t * the dumpability change must become visible before\n\t\t * the credential change; otherwise, a __ptrace_may_access()\n\t\t * racing with this change may be able to attach to a task it\n\t\t * shouldn't be able to attach to (as if the task had dropped\n\t\t * privileges without becoming nondumpable).\n\t\t * Pairs with a read barrier in __ptrace_may_access().\n\t\t */\n\t\tsmp_wmb();\n\t}\n\n\t/* alter the thread keyring */\n\tif (!uid_eq(new->fsuid, old->fsuid))\n\t\tkey_fsuid_changed(new);\n\tif (!gid_eq(new->fsgid, old->fsgid))\n\t\tkey_fsgid_changed(new);\n\n\t/* do it\n\t * RLIMIT_NPROC limits on user->processes have already been checked\n\t * in set_user().\n\t */\n\talter_cred_subscribers(new, 2);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tinc_rlimit_ucounts(new->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\trcu_assign_pointer(task->real_cred, new);\n\trcu_assign_pointer(task->cred, new);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tdec_rlimit_ucounts(old->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\talter_cred_subscribers(old, -2);\n\n\t/* send notifications */\n\tif (!uid_eq(new->uid,   old->uid)  ||\n\t    !uid_eq(new->euid,  old->euid) ||\n\t    !uid_eq(new->suid,  old->suid) ||\n\t    !uid_eq(new->fsuid, old->fsuid))\n\t\tproc_id_connector(task, PROC_EVENT_UID);\n\n\tif (!gid_eq(new->gid,   old->gid)  ||\n\t    !gid_eq(new->egid,  old->egid) ||\n\t    !gid_eq(new->sgid,  old->sgid) ||\n\t    !gid_eq(new->fsgid, old->fsgid))\n\t\tproc_id_connector(task, PROC_EVENT_GID);\n\n\t/* release the old obj and subj refs both */\n\tput_cred(old);\n\tput_cred(old);\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nint commit_creds(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\n\tkdebug(\"commit_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n\tBUG_ON(task->cred != old);\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(old) < 2);\n\tvalidate_creds(old);\n\tvalidate_creds(new);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\n\tget_cred(new); /* we will require a ref for the subj creds too */\n\n\t/* dumpability changes */\n\tif (!uid_eq(old->euid, new->euid) ||\n\t    !gid_eq(old->egid, new->egid) ||\n\t    !uid_eq(old->fsuid, new->fsuid) ||\n\t    !gid_eq(old->fsgid, new->fsgid) ||\n\t    !cred_cap_issubset(old, new)) {\n\t\tif (task->mm)\n\t\t\tset_dumpable(task->mm, suid_dumpable);\n\t\ttask->pdeath_signal = 0;\n\t\t/*\n\t\t * If a task drops privileges and becomes nondumpable,\n\t\t * the dumpability change must become visible before\n\t\t * the credential change; otherwise, a __ptrace_may_access()\n\t\t * racing with this change may be able to attach to a task it\n\t\t * shouldn't be able to attach to (as if the task had dropped\n\t\t * privileges without becoming nondumpable).\n\t\t * Pairs with a read barrier in __ptrace_may_access().\n\t\t */\n\t\tsmp_wmb();\n\t}\n\n\t/* alter the thread keyring */\n\tif (!uid_eq(new->fsuid, old->fsuid))\n\t\tkey_fsuid_changed(new);\n\tif (!gid_eq(new->fsgid, old->fsgid))\n\t\tkey_fsgid_changed(new);\n\n\t/* do it\n\t * RLIMIT_NPROC limits on user->processes have already been checked\n\t * in set_user().\n\t */\n\talter_cred_subscribers(new, 2);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tinc_rlimit_ucounts(new->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\trcu_assign_pointer(task->real_cred, new);\n\trcu_assign_pointer(task->cred, new);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tdec_rlimit_ucounts(old->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\talter_cred_subscribers(old, -2);\n\n\t/* send notifications */\n\tif (!uid_eq(new->uid,   old->uid)  ||\n\t    !uid_eq(new->euid,  old->euid) ||\n\t    !uid_eq(new->suid,  old->suid) ||\n\t    !uid_eq(new->fsuid, old->fsuid))\n\t\tproc_id_connector(task, PROC_EVENT_UID);\n\n\tif (!gid_eq(new->gid,   old->gid)  ||\n\t    !gid_eq(new->egid,  old->egid) ||\n\t    !gid_eq(new->sgid,  old->sgid) ||\n\t    !gid_eq(new->fsgid, old->fsgid))\n\t\tproc_id_connector(task, PROC_EVENT_GID);\n\n\t/* release the old obj and subj refs both */\n\tput_cred(old);\n\tput_cred(old);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "security_task_fix_setgid",
          "args": [
            "new",
            "old",
            "LSM_SETID_RES"
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "ksgid",
            "old->sgid"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "ksgid",
            "old->egid"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "ksgid",
            "old->gid"
          ],
          "line": 773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "kegid",
            "old->sgid"
          ],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "kegid",
            "old->egid"
          ],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "kegid",
            "old->gid"
          ],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "krgid",
            "old->sgid"
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "krgid",
            "old->egid"
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "krgid",
            "old->gid"
          ],
          "line": 767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ns_capable_setid",
          "args": [
            "old->user_ns",
            "CAP_SETGID"
          ],
          "line": 766
        },
        "resolved": true,
        "details": {
          "function_name": "ns_capable_setid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/capability.c",
          "lines": "431-434",
          "snippet": "bool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/user_namespace.h>\n#include <linux/pid_namespace.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n\nbool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_cred",
          "args": [],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_creds",
          "args": [],
          "line": 760
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "252-300",
          "snippet": "struct cred *prepare_creds(void)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old;\n\tstruct cred *new;\n\n\tvalidate_process_creds();\n\n\tnew = kmem_cache_alloc(cred_jar, GFP_KERNEL);\n\tif (!new)\n\t\treturn NULL;\n\n\tkdebug(\"prepare_creds() alloc %p\", new);\n\n\told = task->cred;\n\tmemcpy(new, old, sizeof(struct cred));\n\n\tnew->non_rcu = 0;\n\tatomic_set(&new->usage, 1);\n\tset_cred_subscribers(new, 0);\n\tget_group_info(new->group_info);\n\tget_uid(new->user);\n\tget_user_ns(new->user_ns);\n\n#ifdef CONFIG_KEYS\n\tkey_get(new->session_keyring);\n\tkey_get(new->process_keyring);\n\tkey_get(new->thread_keyring);\n\tkey_get(new->request_key_auth);\n#endif\n\n#ifdef CONFIG_SECURITY\n\tnew->security = NULL;\n#endif\n\n\tnew->ucounts = get_ucounts(new->ucounts);\n\tif (!new->ucounts)\n\t\tgoto error;\n\n\tif (security_prepare_creds(new, old, GFP_KERNEL_ACCOUNT) < 0)\n\t\tgoto error;\n\n\tvalidate_creds(new);\n\treturn new;\n\nerror:\n\tabort_creds(new);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *cred_jar;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nstatic struct kmem_cache *cred_jar;\n\nstruct cred *prepare_creds(void)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old;\n\tstruct cred *new;\n\n\tvalidate_process_creds();\n\n\tnew = kmem_cache_alloc(cred_jar, GFP_KERNEL);\n\tif (!new)\n\t\treturn NULL;\n\n\tkdebug(\"prepare_creds() alloc %p\", new);\n\n\told = task->cred;\n\tmemcpy(new, old, sizeof(struct cred));\n\n\tnew->non_rcu = 0;\n\tatomic_set(&new->usage, 1);\n\tset_cred_subscribers(new, 0);\n\tget_group_info(new->group_info);\n\tget_uid(new->user);\n\tget_user_ns(new->user_ns);\n\n#ifdef CONFIG_KEYS\n\tkey_get(new->session_keyring);\n\tkey_get(new->process_keyring);\n\tkey_get(new->thread_keyring);\n\tkey_get(new->request_key_auth);\n#endif\n\n#ifdef CONFIG_SECURITY\n\tnew->security = NULL;\n#endif\n\n\tnew->ucounts = get_ucounts(new->ucounts);\n\tif (!new->ucounts)\n\t\tgoto error;\n\n\tif (security_prepare_creds(new, old, GFP_KERNEL_ACCOUNT) < 0)\n\t\tgoto error;\n\n\tvalidate_creds(new);\n\treturn new;\n\nerror:\n\tabort_creds(new);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gid_valid",
          "args": [
            "ksgid"
          ],
          "line": 757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_valid",
          "args": [
            "kegid"
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_valid",
          "args": [
            "krgid"
          ],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kgid",
          "args": [
            "ns",
            "sgid"
          ],
          "line": 751
        },
        "resolved": true,
        "details": {
          "function_name": "make_kgid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/user_namespace.c",
          "lines": "459-463",
          "snippet": "kgid_t make_kgid(struct user_namespace *ns, gid_t gid)\n{\n\t/* Map the gid to a global kernel gid */\n\treturn KGIDT_INIT(map_id_down(&ns->gid_map, gid));\n}",
          "includes": [
            "#include <linux/sort.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/projid.h>",
            "#include <linux/ctype.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fs.h>",
            "#include <linux/seq_file.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/securebits.h>",
            "#include <linux/cred.h>",
            "#include <linux/highuid.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sort.h>\n#include <linux/bsearch.h>\n#include <linux/fs_struct.h>\n#include <linux/projid.h>\n#include <linux/ctype.h>\n#include <linux/uaccess.h>\n#include <linux/fs.h>\n#include <linux/seq_file.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/securebits.h>\n#include <linux/cred.h>\n#include <linux/highuid.h>\n#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n\nkgid_t make_kgid(struct user_namespace *ns, gid_t gid)\n{\n\t/* Map the gid to a global kernel gid */\n\treturn KGIDT_INIT(map_id_down(&ns->gid_map, gid));\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nlong __sys_setresgid(gid_t rgid, gid_t egid, gid_t sgid)\n{\n\tstruct user_namespace *ns = current_user_ns();\n\tconst struct cred *old;\n\tstruct cred *new;\n\tint retval;\n\tkgid_t krgid, kegid, ksgid;\n\n\tkrgid = make_kgid(ns, rgid);\n\tkegid = make_kgid(ns, egid);\n\tksgid = make_kgid(ns, sgid);\n\n\tif ((rgid != (gid_t) -1) && !gid_valid(krgid))\n\t\treturn -EINVAL;\n\tif ((egid != (gid_t) -1) && !gid_valid(kegid))\n\t\treturn -EINVAL;\n\tif ((sgid != (gid_t) -1) && !gid_valid(ksgid))\n\t\treturn -EINVAL;\n\n\tnew = prepare_creds();\n\tif (!new)\n\t\treturn -ENOMEM;\n\told = current_cred();\n\n\tretval = -EPERM;\n\tif (!ns_capable_setid(old->user_ns, CAP_SETGID)) {\n\t\tif (rgid != (gid_t) -1        && !gid_eq(krgid, old->gid) &&\n\t\t    !gid_eq(krgid, old->egid) && !gid_eq(krgid, old->sgid))\n\t\t\tgoto error;\n\t\tif (egid != (gid_t) -1        && !gid_eq(kegid, old->gid) &&\n\t\t    !gid_eq(kegid, old->egid) && !gid_eq(kegid, old->sgid))\n\t\t\tgoto error;\n\t\tif (sgid != (gid_t) -1        && !gid_eq(ksgid, old->gid) &&\n\t\t    !gid_eq(ksgid, old->egid) && !gid_eq(ksgid, old->sgid))\n\t\t\tgoto error;\n\t}\n\n\tif (rgid != (gid_t) -1)\n\t\tnew->gid = krgid;\n\tif (egid != (gid_t) -1)\n\t\tnew->egid = kegid;\n\tif (sgid != (gid_t) -1)\n\t\tnew->sgid = ksgid;\n\tnew->fsgid = new->egid;\n\n\tretval = security_task_fix_setgid(new, old, LSM_SETID_RES);\n\tif (retval < 0)\n\t\tgoto error;\n\n\treturn commit_creds(new);\n\nerror:\n\tabort_creds(new);\n\treturn retval;\n}"
  },
  {
    "function_name": "__sys_setresuid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "645-712",
    "snippet": "long __sys_setresuid(uid_t ruid, uid_t euid, uid_t suid)\n{\n\tstruct user_namespace *ns = current_user_ns();\n\tconst struct cred *old;\n\tstruct cred *new;\n\tint retval;\n\tkuid_t kruid, keuid, ksuid;\n\n\tkruid = make_kuid(ns, ruid);\n\tkeuid = make_kuid(ns, euid);\n\tksuid = make_kuid(ns, suid);\n\n\tif ((ruid != (uid_t) -1) && !uid_valid(kruid))\n\t\treturn -EINVAL;\n\n\tif ((euid != (uid_t) -1) && !uid_valid(keuid))\n\t\treturn -EINVAL;\n\n\tif ((suid != (uid_t) -1) && !uid_valid(ksuid))\n\t\treturn -EINVAL;\n\n\tnew = prepare_creds();\n\tif (!new)\n\t\treturn -ENOMEM;\n\n\told = current_cred();\n\n\tretval = -EPERM;\n\tif (!ns_capable_setid(old->user_ns, CAP_SETUID)) {\n\t\tif (ruid != (uid_t) -1        && !uid_eq(kruid, old->uid) &&\n\t\t    !uid_eq(kruid, old->euid) && !uid_eq(kruid, old->suid))\n\t\t\tgoto error;\n\t\tif (euid != (uid_t) -1        && !uid_eq(keuid, old->uid) &&\n\t\t    !uid_eq(keuid, old->euid) && !uid_eq(keuid, old->suid))\n\t\t\tgoto error;\n\t\tif (suid != (uid_t) -1        && !uid_eq(ksuid, old->uid) &&\n\t\t    !uid_eq(ksuid, old->euid) && !uid_eq(ksuid, old->suid))\n\t\t\tgoto error;\n\t}\n\n\tif (ruid != (uid_t) -1) {\n\t\tnew->uid = kruid;\n\t\tif (!uid_eq(kruid, old->uid)) {\n\t\t\tretval = set_user(new);\n\t\t\tif (retval < 0)\n\t\t\t\tgoto error;\n\t\t}\n\t}\n\tif (euid != (uid_t) -1)\n\t\tnew->euid = keuid;\n\tif (suid != (uid_t) -1)\n\t\tnew->suid = ksuid;\n\tnew->fsuid = new->euid;\n\n\tretval = security_task_fix_setuid(new, old, LSM_SETID_RES);\n\tif (retval < 0)\n\t\tgoto error;\n\n\tretval = set_cred_ucounts(new);\n\tif (retval < 0)\n\t\tgoto error;\n\n\treturn commit_creds(new);\n\nerror:\n\tabort_creds(new);\n\treturn retval;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "abort_creds",
          "args": [
            "new"
          ],
          "line": 710
        },
        "resolved": true,
        "details": {
          "function_name": "abort_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "533-544",
          "snippet": "void abort_creds(struct cred *new)\n{\n\tkdebug(\"abort_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(new) != 0);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\tput_cred(new);\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nvoid abort_creds(struct cred *new)\n{\n\tkdebug(\"abort_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(new) != 0);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\tput_cred(new);\n}"
        }
      },
      {
        "call_info": {
          "callee": "commit_creds",
          "args": [
            "new"
          ],
          "line": 707
        },
        "resolved": true,
        "details": {
          "function_name": "commit_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "447-523",
          "snippet": "int commit_creds(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\n\tkdebug(\"commit_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n\tBUG_ON(task->cred != old);\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(old) < 2);\n\tvalidate_creds(old);\n\tvalidate_creds(new);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\n\tget_cred(new); /* we will require a ref for the subj creds too */\n\n\t/* dumpability changes */\n\tif (!uid_eq(old->euid, new->euid) ||\n\t    !gid_eq(old->egid, new->egid) ||\n\t    !uid_eq(old->fsuid, new->fsuid) ||\n\t    !gid_eq(old->fsgid, new->fsgid) ||\n\t    !cred_cap_issubset(old, new)) {\n\t\tif (task->mm)\n\t\t\tset_dumpable(task->mm, suid_dumpable);\n\t\ttask->pdeath_signal = 0;\n\t\t/*\n\t\t * If a task drops privileges and becomes nondumpable,\n\t\t * the dumpability change must become visible before\n\t\t * the credential change; otherwise, a __ptrace_may_access()\n\t\t * racing with this change may be able to attach to a task it\n\t\t * shouldn't be able to attach to (as if the task had dropped\n\t\t * privileges without becoming nondumpable).\n\t\t * Pairs with a read barrier in __ptrace_may_access().\n\t\t */\n\t\tsmp_wmb();\n\t}\n\n\t/* alter the thread keyring */\n\tif (!uid_eq(new->fsuid, old->fsuid))\n\t\tkey_fsuid_changed(new);\n\tif (!gid_eq(new->fsgid, old->fsgid))\n\t\tkey_fsgid_changed(new);\n\n\t/* do it\n\t * RLIMIT_NPROC limits on user->processes have already been checked\n\t * in set_user().\n\t */\n\talter_cred_subscribers(new, 2);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tinc_rlimit_ucounts(new->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\trcu_assign_pointer(task->real_cred, new);\n\trcu_assign_pointer(task->cred, new);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tdec_rlimit_ucounts(old->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\talter_cred_subscribers(old, -2);\n\n\t/* send notifications */\n\tif (!uid_eq(new->uid,   old->uid)  ||\n\t    !uid_eq(new->euid,  old->euid) ||\n\t    !uid_eq(new->suid,  old->suid) ||\n\t    !uid_eq(new->fsuid, old->fsuid))\n\t\tproc_id_connector(task, PROC_EVENT_UID);\n\n\tif (!gid_eq(new->gid,   old->gid)  ||\n\t    !gid_eq(new->egid,  old->egid) ||\n\t    !gid_eq(new->sgid,  old->sgid) ||\n\t    !gid_eq(new->fsgid, old->fsgid))\n\t\tproc_id_connector(task, PROC_EVENT_GID);\n\n\t/* release the old obj and subj refs both */\n\tput_cred(old);\n\tput_cred(old);\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nint commit_creds(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\n\tkdebug(\"commit_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n\tBUG_ON(task->cred != old);\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(old) < 2);\n\tvalidate_creds(old);\n\tvalidate_creds(new);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\n\tget_cred(new); /* we will require a ref for the subj creds too */\n\n\t/* dumpability changes */\n\tif (!uid_eq(old->euid, new->euid) ||\n\t    !gid_eq(old->egid, new->egid) ||\n\t    !uid_eq(old->fsuid, new->fsuid) ||\n\t    !gid_eq(old->fsgid, new->fsgid) ||\n\t    !cred_cap_issubset(old, new)) {\n\t\tif (task->mm)\n\t\t\tset_dumpable(task->mm, suid_dumpable);\n\t\ttask->pdeath_signal = 0;\n\t\t/*\n\t\t * If a task drops privileges and becomes nondumpable,\n\t\t * the dumpability change must become visible before\n\t\t * the credential change; otherwise, a __ptrace_may_access()\n\t\t * racing with this change may be able to attach to a task it\n\t\t * shouldn't be able to attach to (as if the task had dropped\n\t\t * privileges without becoming nondumpable).\n\t\t * Pairs with a read barrier in __ptrace_may_access().\n\t\t */\n\t\tsmp_wmb();\n\t}\n\n\t/* alter the thread keyring */\n\tif (!uid_eq(new->fsuid, old->fsuid))\n\t\tkey_fsuid_changed(new);\n\tif (!gid_eq(new->fsgid, old->fsgid))\n\t\tkey_fsgid_changed(new);\n\n\t/* do it\n\t * RLIMIT_NPROC limits on user->processes have already been checked\n\t * in set_user().\n\t */\n\talter_cred_subscribers(new, 2);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tinc_rlimit_ucounts(new->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\trcu_assign_pointer(task->real_cred, new);\n\trcu_assign_pointer(task->cred, new);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tdec_rlimit_ucounts(old->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\talter_cred_subscribers(old, -2);\n\n\t/* send notifications */\n\tif (!uid_eq(new->uid,   old->uid)  ||\n\t    !uid_eq(new->euid,  old->euid) ||\n\t    !uid_eq(new->suid,  old->suid) ||\n\t    !uid_eq(new->fsuid, old->fsuid))\n\t\tproc_id_connector(task, PROC_EVENT_UID);\n\n\tif (!gid_eq(new->gid,   old->gid)  ||\n\t    !gid_eq(new->egid,  old->egid) ||\n\t    !gid_eq(new->sgid,  old->sgid) ||\n\t    !gid_eq(new->fsgid, old->fsgid))\n\t\tproc_id_connector(task, PROC_EVENT_GID);\n\n\t/* release the old obj and subj refs both */\n\tput_cred(old);\n\tput_cred(old);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_cred_ucounts",
          "args": [
            "new"
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "set_cred_ucounts",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "666-689",
          "snippet": "int set_cred_ucounts(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\tstruct ucounts *new_ucounts, *old_ucounts = new->ucounts;\n\n\tif (new->user == old->user && new->user_ns == old->user_ns)\n\t\treturn 0;\n\n\t/*\n\t * This optimization is needed because alloc_ucounts() uses locks\n\t * for table lookups.\n\t */\n\tif (old_ucounts->ns == new->user_ns && uid_eq(old_ucounts->uid, new->euid))\n\t\treturn 0;\n\n\tif (!(new_ucounts = alloc_ucounts(new->user_ns, new->euid)))\n\t\treturn -EAGAIN;\n\n\tnew->ucounts = new_ucounts;\n\tput_ucounts(old_ucounts);\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nint set_cred_ucounts(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\tstruct ucounts *new_ucounts, *old_ucounts = new->ucounts;\n\n\tif (new->user == old->user && new->user_ns == old->user_ns)\n\t\treturn 0;\n\n\t/*\n\t * This optimization is needed because alloc_ucounts() uses locks\n\t * for table lookups.\n\t */\n\tif (old_ucounts->ns == new->user_ns && uid_eq(old_ucounts->uid, new->euid))\n\t\treturn 0;\n\n\tif (!(new_ucounts = alloc_ucounts(new->user_ns, new->euid)))\n\t\treturn -EAGAIN;\n\n\tnew->ucounts = new_ucounts;\n\tput_ucounts(old_ucounts);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "security_task_fix_setuid",
          "args": [
            "new",
            "old",
            "LSM_SETID_RES"
          ],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_user",
          "args": [
            "new"
          ],
          "line": 688
        },
        "resolved": true,
        "details": {
          "function_name": "set_user",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
          "lines": "467-492",
          "snippet": "static int set_user(struct cred *new)\n{\n\tstruct user_struct *new_user;\n\n\tnew_user = alloc_uid(new->uid);\n\tif (!new_user)\n\t\treturn -EAGAIN;\n\n\t/*\n\t * We don't fail in case of NPROC limit excess here because too many\n\t * poorly written programs don't check set*uid() return code, assuming\n\t * it never fails if called by root.  We may still enforce NPROC limit\n\t * for programs doing set*uid()+execve() by harmlessly deferring the\n\t * failure to the execve() stage.\n\t */\n\tif (is_ucounts_overlimit(new->ucounts, UCOUNT_RLIMIT_NPROC, rlimit(RLIMIT_NPROC)) &&\n\t\t\tnew_user != INIT_USER &&\n\t\t\t!capable(CAP_SYS_RESOURCE) && !capable(CAP_SYS_ADMIN))\n\t\tcurrent->flags |= PF_NPROC_EXCEEDED;\n\telse\n\t\tcurrent->flags &= ~PF_NPROC_EXCEEDED;\n\n\tfree_uid(new->user);\n\tnew->user = new_user;\n\treturn 0;\n}",
          "includes": [
            "#include \"uid16.h\"",
            "#include <asm/unistd.h>",
            "#include <asm/io.h>",
            "#include <linux/uaccess.h>",
            "#include <generated/utsrelease.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/nospec.h>",
            "#include <linux/cred.h>",
            "#include <linux/uidgid.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/sched.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/time_namespace.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscall_user_dispatch.h>",
            "#include <linux/ctype.h>",
            "#include <linux/version.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mount.h>",
            "#include <linux/file.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/personality.h>",
            "#include <linux/cpu.h>",
            "#include <linux/seccomp.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/getcpu.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/signal.h>",
            "#include <linux/tty.h>",
            "#include <linux/suspend.h>",
            "#include <linux/security.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/times.h>",
            "#include <linux/key.h>",
            "#include <linux/device.h>",
            "#include <linux/capability.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kernel.h>",
            "#include <linux/resource.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/kmod.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/prctl.h>",
            "#include <linux/reboot.h>",
            "#include <linux/mman.h>",
            "#include <linux/utsname.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic int set_user(struct cred *new)\n{\n\tstruct user_struct *new_user;\n\n\tnew_user = alloc_uid(new->uid);\n\tif (!new_user)\n\t\treturn -EAGAIN;\n\n\t/*\n\t * We don't fail in case of NPROC limit excess here because too many\n\t * poorly written programs don't check set*uid() return code, assuming\n\t * it never fails if called by root.  We may still enforce NPROC limit\n\t * for programs doing set*uid()+execve() by harmlessly deferring the\n\t * failure to the execve() stage.\n\t */\n\tif (is_ucounts_overlimit(new->ucounts, UCOUNT_RLIMIT_NPROC, rlimit(RLIMIT_NPROC)) &&\n\t\t\tnew_user != INIT_USER &&\n\t\t\t!capable(CAP_SYS_RESOURCE) && !capable(CAP_SYS_ADMIN))\n\t\tcurrent->flags |= PF_NPROC_EXCEEDED;\n\telse\n\t\tcurrent->flags &= ~PF_NPROC_EXCEEDED;\n\n\tfree_uid(new->user);\n\tnew->user = new_user;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "kruid",
            "old->uid"
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "ksuid",
            "old->suid"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "ksuid",
            "old->euid"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "ksuid",
            "old->uid"
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "keuid",
            "old->suid"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "keuid",
            "old->euid"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "keuid",
            "old->uid"
          ],
          "line": 677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "kruid",
            "old->suid"
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "kruid",
            "old->euid"
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "kruid",
            "old->uid"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ns_capable_setid",
          "args": [
            "old->user_ns",
            "CAP_SETUID"
          ],
          "line": 673
        },
        "resolved": true,
        "details": {
          "function_name": "ns_capable_setid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/capability.c",
          "lines": "431-434",
          "snippet": "bool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/user_namespace.h>\n#include <linux/pid_namespace.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n\nbool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_cred",
          "args": [],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_creds",
          "args": [],
          "line": 666
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "252-300",
          "snippet": "struct cred *prepare_creds(void)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old;\n\tstruct cred *new;\n\n\tvalidate_process_creds();\n\n\tnew = kmem_cache_alloc(cred_jar, GFP_KERNEL);\n\tif (!new)\n\t\treturn NULL;\n\n\tkdebug(\"prepare_creds() alloc %p\", new);\n\n\told = task->cred;\n\tmemcpy(new, old, sizeof(struct cred));\n\n\tnew->non_rcu = 0;\n\tatomic_set(&new->usage, 1);\n\tset_cred_subscribers(new, 0);\n\tget_group_info(new->group_info);\n\tget_uid(new->user);\n\tget_user_ns(new->user_ns);\n\n#ifdef CONFIG_KEYS\n\tkey_get(new->session_keyring);\n\tkey_get(new->process_keyring);\n\tkey_get(new->thread_keyring);\n\tkey_get(new->request_key_auth);\n#endif\n\n#ifdef CONFIG_SECURITY\n\tnew->security = NULL;\n#endif\n\n\tnew->ucounts = get_ucounts(new->ucounts);\n\tif (!new->ucounts)\n\t\tgoto error;\n\n\tif (security_prepare_creds(new, old, GFP_KERNEL_ACCOUNT) < 0)\n\t\tgoto error;\n\n\tvalidate_creds(new);\n\treturn new;\n\nerror:\n\tabort_creds(new);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *cred_jar;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nstatic struct kmem_cache *cred_jar;\n\nstruct cred *prepare_creds(void)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old;\n\tstruct cred *new;\n\n\tvalidate_process_creds();\n\n\tnew = kmem_cache_alloc(cred_jar, GFP_KERNEL);\n\tif (!new)\n\t\treturn NULL;\n\n\tkdebug(\"prepare_creds() alloc %p\", new);\n\n\told = task->cred;\n\tmemcpy(new, old, sizeof(struct cred));\n\n\tnew->non_rcu = 0;\n\tatomic_set(&new->usage, 1);\n\tset_cred_subscribers(new, 0);\n\tget_group_info(new->group_info);\n\tget_uid(new->user);\n\tget_user_ns(new->user_ns);\n\n#ifdef CONFIG_KEYS\n\tkey_get(new->session_keyring);\n\tkey_get(new->process_keyring);\n\tkey_get(new->thread_keyring);\n\tkey_get(new->request_key_auth);\n#endif\n\n#ifdef CONFIG_SECURITY\n\tnew->security = NULL;\n#endif\n\n\tnew->ucounts = get_ucounts(new->ucounts);\n\tif (!new->ucounts)\n\t\tgoto error;\n\n\tif (security_prepare_creds(new, old, GFP_KERNEL_ACCOUNT) < 0)\n\t\tgoto error;\n\n\tvalidate_creds(new);\n\treturn new;\n\nerror:\n\tabort_creds(new);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "uid_valid",
          "args": [
            "ksuid"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_valid",
          "args": [
            "keuid"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_valid",
          "args": [
            "kruid"
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kuid",
          "args": [
            "ns",
            "suid"
          ],
          "line": 655
        },
        "resolved": true,
        "details": {
          "function_name": "make_kuid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/user_namespace.c",
          "lines": "391-395",
          "snippet": "kuid_t make_kuid(struct user_namespace *ns, uid_t uid)\n{\n\t/* Map the uid to a global kernel uid */\n\treturn KUIDT_INIT(map_id_down(&ns->uid_map, uid));\n}",
          "includes": [
            "#include <linux/sort.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/projid.h>",
            "#include <linux/ctype.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fs.h>",
            "#include <linux/seq_file.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/securebits.h>",
            "#include <linux/cred.h>",
            "#include <linux/highuid.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sort.h>\n#include <linux/bsearch.h>\n#include <linux/fs_struct.h>\n#include <linux/projid.h>\n#include <linux/ctype.h>\n#include <linux/uaccess.h>\n#include <linux/fs.h>\n#include <linux/seq_file.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/securebits.h>\n#include <linux/cred.h>\n#include <linux/highuid.h>\n#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n\nkuid_t make_kuid(struct user_namespace *ns, uid_t uid)\n{\n\t/* Map the uid to a global kernel uid */\n\treturn KUIDT_INIT(map_id_down(&ns->uid_map, uid));\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nlong __sys_setresuid(uid_t ruid, uid_t euid, uid_t suid)\n{\n\tstruct user_namespace *ns = current_user_ns();\n\tconst struct cred *old;\n\tstruct cred *new;\n\tint retval;\n\tkuid_t kruid, keuid, ksuid;\n\n\tkruid = make_kuid(ns, ruid);\n\tkeuid = make_kuid(ns, euid);\n\tksuid = make_kuid(ns, suid);\n\n\tif ((ruid != (uid_t) -1) && !uid_valid(kruid))\n\t\treturn -EINVAL;\n\n\tif ((euid != (uid_t) -1) && !uid_valid(keuid))\n\t\treturn -EINVAL;\n\n\tif ((suid != (uid_t) -1) && !uid_valid(ksuid))\n\t\treturn -EINVAL;\n\n\tnew = prepare_creds();\n\tif (!new)\n\t\treturn -ENOMEM;\n\n\told = current_cred();\n\n\tretval = -EPERM;\n\tif (!ns_capable_setid(old->user_ns, CAP_SETUID)) {\n\t\tif (ruid != (uid_t) -1        && !uid_eq(kruid, old->uid) &&\n\t\t    !uid_eq(kruid, old->euid) && !uid_eq(kruid, old->suid))\n\t\t\tgoto error;\n\t\tif (euid != (uid_t) -1        && !uid_eq(keuid, old->uid) &&\n\t\t    !uid_eq(keuid, old->euid) && !uid_eq(keuid, old->suid))\n\t\t\tgoto error;\n\t\tif (suid != (uid_t) -1        && !uid_eq(ksuid, old->uid) &&\n\t\t    !uid_eq(ksuid, old->euid) && !uid_eq(ksuid, old->suid))\n\t\t\tgoto error;\n\t}\n\n\tif (ruid != (uid_t) -1) {\n\t\tnew->uid = kruid;\n\t\tif (!uid_eq(kruid, old->uid)) {\n\t\t\tretval = set_user(new);\n\t\t\tif (retval < 0)\n\t\t\t\tgoto error;\n\t\t}\n\t}\n\tif (euid != (uid_t) -1)\n\t\tnew->euid = keuid;\n\tif (suid != (uid_t) -1)\n\t\tnew->suid = ksuid;\n\tnew->fsuid = new->euid;\n\n\tretval = security_task_fix_setuid(new, old, LSM_SETID_RES);\n\tif (retval < 0)\n\t\tgoto error;\n\n\tretval = set_cred_ucounts(new);\n\tif (retval < 0)\n\t\tgoto error;\n\n\treturn commit_creds(new);\n\nerror:\n\tabort_creds(new);\n\treturn retval;\n}"
  },
  {
    "function_name": "__sys_setuid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "589-633",
    "snippet": "long __sys_setuid(uid_t uid)\n{\n\tstruct user_namespace *ns = current_user_ns();\n\tconst struct cred *old;\n\tstruct cred *new;\n\tint retval;\n\tkuid_t kuid;\n\n\tkuid = make_kuid(ns, uid);\n\tif (!uid_valid(kuid))\n\t\treturn -EINVAL;\n\n\tnew = prepare_creds();\n\tif (!new)\n\t\treturn -ENOMEM;\n\told = current_cred();\n\n\tretval = -EPERM;\n\tif (ns_capable_setid(old->user_ns, CAP_SETUID)) {\n\t\tnew->suid = new->uid = kuid;\n\t\tif (!uid_eq(kuid, old->uid)) {\n\t\t\tretval = set_user(new);\n\t\t\tif (retval < 0)\n\t\t\t\tgoto error;\n\t\t}\n\t} else if (!uid_eq(kuid, old->uid) && !uid_eq(kuid, new->suid)) {\n\t\tgoto error;\n\t}\n\n\tnew->fsuid = new->euid = kuid;\n\n\tretval = security_task_fix_setuid(new, old, LSM_SETID_ID);\n\tif (retval < 0)\n\t\tgoto error;\n\n\tretval = set_cred_ucounts(new);\n\tif (retval < 0)\n\t\tgoto error;\n\n\treturn commit_creds(new);\n\nerror:\n\tabort_creds(new);\n\treturn retval;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "abort_creds",
          "args": [
            "new"
          ],
          "line": 631
        },
        "resolved": true,
        "details": {
          "function_name": "abort_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "533-544",
          "snippet": "void abort_creds(struct cred *new)\n{\n\tkdebug(\"abort_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(new) != 0);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\tput_cred(new);\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nvoid abort_creds(struct cred *new)\n{\n\tkdebug(\"abort_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(new) != 0);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\tput_cred(new);\n}"
        }
      },
      {
        "call_info": {
          "callee": "commit_creds",
          "args": [
            "new"
          ],
          "line": 628
        },
        "resolved": true,
        "details": {
          "function_name": "commit_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "447-523",
          "snippet": "int commit_creds(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\n\tkdebug(\"commit_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n\tBUG_ON(task->cred != old);\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(old) < 2);\n\tvalidate_creds(old);\n\tvalidate_creds(new);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\n\tget_cred(new); /* we will require a ref for the subj creds too */\n\n\t/* dumpability changes */\n\tif (!uid_eq(old->euid, new->euid) ||\n\t    !gid_eq(old->egid, new->egid) ||\n\t    !uid_eq(old->fsuid, new->fsuid) ||\n\t    !gid_eq(old->fsgid, new->fsgid) ||\n\t    !cred_cap_issubset(old, new)) {\n\t\tif (task->mm)\n\t\t\tset_dumpable(task->mm, suid_dumpable);\n\t\ttask->pdeath_signal = 0;\n\t\t/*\n\t\t * If a task drops privileges and becomes nondumpable,\n\t\t * the dumpability change must become visible before\n\t\t * the credential change; otherwise, a __ptrace_may_access()\n\t\t * racing with this change may be able to attach to a task it\n\t\t * shouldn't be able to attach to (as if the task had dropped\n\t\t * privileges without becoming nondumpable).\n\t\t * Pairs with a read barrier in __ptrace_may_access().\n\t\t */\n\t\tsmp_wmb();\n\t}\n\n\t/* alter the thread keyring */\n\tif (!uid_eq(new->fsuid, old->fsuid))\n\t\tkey_fsuid_changed(new);\n\tif (!gid_eq(new->fsgid, old->fsgid))\n\t\tkey_fsgid_changed(new);\n\n\t/* do it\n\t * RLIMIT_NPROC limits on user->processes have already been checked\n\t * in set_user().\n\t */\n\talter_cred_subscribers(new, 2);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tinc_rlimit_ucounts(new->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\trcu_assign_pointer(task->real_cred, new);\n\trcu_assign_pointer(task->cred, new);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tdec_rlimit_ucounts(old->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\talter_cred_subscribers(old, -2);\n\n\t/* send notifications */\n\tif (!uid_eq(new->uid,   old->uid)  ||\n\t    !uid_eq(new->euid,  old->euid) ||\n\t    !uid_eq(new->suid,  old->suid) ||\n\t    !uid_eq(new->fsuid, old->fsuid))\n\t\tproc_id_connector(task, PROC_EVENT_UID);\n\n\tif (!gid_eq(new->gid,   old->gid)  ||\n\t    !gid_eq(new->egid,  old->egid) ||\n\t    !gid_eq(new->sgid,  old->sgid) ||\n\t    !gid_eq(new->fsgid, old->fsgid))\n\t\tproc_id_connector(task, PROC_EVENT_GID);\n\n\t/* release the old obj and subj refs both */\n\tput_cred(old);\n\tput_cred(old);\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nint commit_creds(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\n\tkdebug(\"commit_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n\tBUG_ON(task->cred != old);\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(old) < 2);\n\tvalidate_creds(old);\n\tvalidate_creds(new);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\n\tget_cred(new); /* we will require a ref for the subj creds too */\n\n\t/* dumpability changes */\n\tif (!uid_eq(old->euid, new->euid) ||\n\t    !gid_eq(old->egid, new->egid) ||\n\t    !uid_eq(old->fsuid, new->fsuid) ||\n\t    !gid_eq(old->fsgid, new->fsgid) ||\n\t    !cred_cap_issubset(old, new)) {\n\t\tif (task->mm)\n\t\t\tset_dumpable(task->mm, suid_dumpable);\n\t\ttask->pdeath_signal = 0;\n\t\t/*\n\t\t * If a task drops privileges and becomes nondumpable,\n\t\t * the dumpability change must become visible before\n\t\t * the credential change; otherwise, a __ptrace_may_access()\n\t\t * racing with this change may be able to attach to a task it\n\t\t * shouldn't be able to attach to (as if the task had dropped\n\t\t * privileges without becoming nondumpable).\n\t\t * Pairs with a read barrier in __ptrace_may_access().\n\t\t */\n\t\tsmp_wmb();\n\t}\n\n\t/* alter the thread keyring */\n\tif (!uid_eq(new->fsuid, old->fsuid))\n\t\tkey_fsuid_changed(new);\n\tif (!gid_eq(new->fsgid, old->fsgid))\n\t\tkey_fsgid_changed(new);\n\n\t/* do it\n\t * RLIMIT_NPROC limits on user->processes have already been checked\n\t * in set_user().\n\t */\n\talter_cred_subscribers(new, 2);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tinc_rlimit_ucounts(new->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\trcu_assign_pointer(task->real_cred, new);\n\trcu_assign_pointer(task->cred, new);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tdec_rlimit_ucounts(old->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\talter_cred_subscribers(old, -2);\n\n\t/* send notifications */\n\tif (!uid_eq(new->uid,   old->uid)  ||\n\t    !uid_eq(new->euid,  old->euid) ||\n\t    !uid_eq(new->suid,  old->suid) ||\n\t    !uid_eq(new->fsuid, old->fsuid))\n\t\tproc_id_connector(task, PROC_EVENT_UID);\n\n\tif (!gid_eq(new->gid,   old->gid)  ||\n\t    !gid_eq(new->egid,  old->egid) ||\n\t    !gid_eq(new->sgid,  old->sgid) ||\n\t    !gid_eq(new->fsgid, old->fsgid))\n\t\tproc_id_connector(task, PROC_EVENT_GID);\n\n\t/* release the old obj and subj refs both */\n\tput_cred(old);\n\tput_cred(old);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_cred_ucounts",
          "args": [
            "new"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "set_cred_ucounts",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "666-689",
          "snippet": "int set_cred_ucounts(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\tstruct ucounts *new_ucounts, *old_ucounts = new->ucounts;\n\n\tif (new->user == old->user && new->user_ns == old->user_ns)\n\t\treturn 0;\n\n\t/*\n\t * This optimization is needed because alloc_ucounts() uses locks\n\t * for table lookups.\n\t */\n\tif (old_ucounts->ns == new->user_ns && uid_eq(old_ucounts->uid, new->euid))\n\t\treturn 0;\n\n\tif (!(new_ucounts = alloc_ucounts(new->user_ns, new->euid)))\n\t\treturn -EAGAIN;\n\n\tnew->ucounts = new_ucounts;\n\tput_ucounts(old_ucounts);\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nint set_cred_ucounts(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\tstruct ucounts *new_ucounts, *old_ucounts = new->ucounts;\n\n\tif (new->user == old->user && new->user_ns == old->user_ns)\n\t\treturn 0;\n\n\t/*\n\t * This optimization is needed because alloc_ucounts() uses locks\n\t * for table lookups.\n\t */\n\tif (old_ucounts->ns == new->user_ns && uid_eq(old_ucounts->uid, new->euid))\n\t\treturn 0;\n\n\tif (!(new_ucounts = alloc_ucounts(new->user_ns, new->euid)))\n\t\treturn -EAGAIN;\n\n\tnew->ucounts = new_ucounts;\n\tput_ucounts(old_ucounts);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "security_task_fix_setuid",
          "args": [
            "new",
            "old",
            "LSM_SETID_ID"
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "kuid",
            "new->suid"
          ],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "kuid",
            "old->uid"
          ],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_user",
          "args": [
            "new"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "set_user",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
          "lines": "467-492",
          "snippet": "static int set_user(struct cred *new)\n{\n\tstruct user_struct *new_user;\n\n\tnew_user = alloc_uid(new->uid);\n\tif (!new_user)\n\t\treturn -EAGAIN;\n\n\t/*\n\t * We don't fail in case of NPROC limit excess here because too many\n\t * poorly written programs don't check set*uid() return code, assuming\n\t * it never fails if called by root.  We may still enforce NPROC limit\n\t * for programs doing set*uid()+execve() by harmlessly deferring the\n\t * failure to the execve() stage.\n\t */\n\tif (is_ucounts_overlimit(new->ucounts, UCOUNT_RLIMIT_NPROC, rlimit(RLIMIT_NPROC)) &&\n\t\t\tnew_user != INIT_USER &&\n\t\t\t!capable(CAP_SYS_RESOURCE) && !capable(CAP_SYS_ADMIN))\n\t\tcurrent->flags |= PF_NPROC_EXCEEDED;\n\telse\n\t\tcurrent->flags &= ~PF_NPROC_EXCEEDED;\n\n\tfree_uid(new->user);\n\tnew->user = new_user;\n\treturn 0;\n}",
          "includes": [
            "#include \"uid16.h\"",
            "#include <asm/unistd.h>",
            "#include <asm/io.h>",
            "#include <linux/uaccess.h>",
            "#include <generated/utsrelease.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/nospec.h>",
            "#include <linux/cred.h>",
            "#include <linux/uidgid.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/sched.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/time_namespace.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscall_user_dispatch.h>",
            "#include <linux/ctype.h>",
            "#include <linux/version.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mount.h>",
            "#include <linux/file.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/personality.h>",
            "#include <linux/cpu.h>",
            "#include <linux/seccomp.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/getcpu.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/signal.h>",
            "#include <linux/tty.h>",
            "#include <linux/suspend.h>",
            "#include <linux/security.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/times.h>",
            "#include <linux/key.h>",
            "#include <linux/device.h>",
            "#include <linux/capability.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kernel.h>",
            "#include <linux/resource.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/kmod.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/prctl.h>",
            "#include <linux/reboot.h>",
            "#include <linux/mman.h>",
            "#include <linux/utsname.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic int set_user(struct cred *new)\n{\n\tstruct user_struct *new_user;\n\n\tnew_user = alloc_uid(new->uid);\n\tif (!new_user)\n\t\treturn -EAGAIN;\n\n\t/*\n\t * We don't fail in case of NPROC limit excess here because too many\n\t * poorly written programs don't check set*uid() return code, assuming\n\t * it never fails if called by root.  We may still enforce NPROC limit\n\t * for programs doing set*uid()+execve() by harmlessly deferring the\n\t * failure to the execve() stage.\n\t */\n\tif (is_ucounts_overlimit(new->ucounts, UCOUNT_RLIMIT_NPROC, rlimit(RLIMIT_NPROC)) &&\n\t\t\tnew_user != INIT_USER &&\n\t\t\t!capable(CAP_SYS_RESOURCE) && !capable(CAP_SYS_ADMIN))\n\t\tcurrent->flags |= PF_NPROC_EXCEEDED;\n\telse\n\t\tcurrent->flags &= ~PF_NPROC_EXCEEDED;\n\n\tfree_uid(new->user);\n\tnew->user = new_user;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "kuid",
            "old->uid"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ns_capable_setid",
          "args": [
            "old->user_ns",
            "CAP_SETUID"
          ],
          "line": 607
        },
        "resolved": true,
        "details": {
          "function_name": "ns_capable_setid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/capability.c",
          "lines": "431-434",
          "snippet": "bool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/user_namespace.h>\n#include <linux/pid_namespace.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n\nbool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_cred",
          "args": [],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_creds",
          "args": [],
          "line": 601
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "252-300",
          "snippet": "struct cred *prepare_creds(void)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old;\n\tstruct cred *new;\n\n\tvalidate_process_creds();\n\n\tnew = kmem_cache_alloc(cred_jar, GFP_KERNEL);\n\tif (!new)\n\t\treturn NULL;\n\n\tkdebug(\"prepare_creds() alloc %p\", new);\n\n\told = task->cred;\n\tmemcpy(new, old, sizeof(struct cred));\n\n\tnew->non_rcu = 0;\n\tatomic_set(&new->usage, 1);\n\tset_cred_subscribers(new, 0);\n\tget_group_info(new->group_info);\n\tget_uid(new->user);\n\tget_user_ns(new->user_ns);\n\n#ifdef CONFIG_KEYS\n\tkey_get(new->session_keyring);\n\tkey_get(new->process_keyring);\n\tkey_get(new->thread_keyring);\n\tkey_get(new->request_key_auth);\n#endif\n\n#ifdef CONFIG_SECURITY\n\tnew->security = NULL;\n#endif\n\n\tnew->ucounts = get_ucounts(new->ucounts);\n\tif (!new->ucounts)\n\t\tgoto error;\n\n\tif (security_prepare_creds(new, old, GFP_KERNEL_ACCOUNT) < 0)\n\t\tgoto error;\n\n\tvalidate_creds(new);\n\treturn new;\n\nerror:\n\tabort_creds(new);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *cred_jar;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nstatic struct kmem_cache *cred_jar;\n\nstruct cred *prepare_creds(void)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old;\n\tstruct cred *new;\n\n\tvalidate_process_creds();\n\n\tnew = kmem_cache_alloc(cred_jar, GFP_KERNEL);\n\tif (!new)\n\t\treturn NULL;\n\n\tkdebug(\"prepare_creds() alloc %p\", new);\n\n\told = task->cred;\n\tmemcpy(new, old, sizeof(struct cred));\n\n\tnew->non_rcu = 0;\n\tatomic_set(&new->usage, 1);\n\tset_cred_subscribers(new, 0);\n\tget_group_info(new->group_info);\n\tget_uid(new->user);\n\tget_user_ns(new->user_ns);\n\n#ifdef CONFIG_KEYS\n\tkey_get(new->session_keyring);\n\tkey_get(new->process_keyring);\n\tkey_get(new->thread_keyring);\n\tkey_get(new->request_key_auth);\n#endif\n\n#ifdef CONFIG_SECURITY\n\tnew->security = NULL;\n#endif\n\n\tnew->ucounts = get_ucounts(new->ucounts);\n\tif (!new->ucounts)\n\t\tgoto error;\n\n\tif (security_prepare_creds(new, old, GFP_KERNEL_ACCOUNT) < 0)\n\t\tgoto error;\n\n\tvalidate_creds(new);\n\treturn new;\n\nerror:\n\tabort_creds(new);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "uid_valid",
          "args": [
            "kuid"
          ],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kuid",
          "args": [
            "ns",
            "uid"
          ],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "make_kuid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/user_namespace.c",
          "lines": "391-395",
          "snippet": "kuid_t make_kuid(struct user_namespace *ns, uid_t uid)\n{\n\t/* Map the uid to a global kernel uid */\n\treturn KUIDT_INIT(map_id_down(&ns->uid_map, uid));\n}",
          "includes": [
            "#include <linux/sort.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/projid.h>",
            "#include <linux/ctype.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fs.h>",
            "#include <linux/seq_file.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/securebits.h>",
            "#include <linux/cred.h>",
            "#include <linux/highuid.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sort.h>\n#include <linux/bsearch.h>\n#include <linux/fs_struct.h>\n#include <linux/projid.h>\n#include <linux/ctype.h>\n#include <linux/uaccess.h>\n#include <linux/fs.h>\n#include <linux/seq_file.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/securebits.h>\n#include <linux/cred.h>\n#include <linux/highuid.h>\n#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n\nkuid_t make_kuid(struct user_namespace *ns, uid_t uid)\n{\n\t/* Map the uid to a global kernel uid */\n\treturn KUIDT_INIT(map_id_down(&ns->uid_map, uid));\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nlong __sys_setuid(uid_t uid)\n{\n\tstruct user_namespace *ns = current_user_ns();\n\tconst struct cred *old;\n\tstruct cred *new;\n\tint retval;\n\tkuid_t kuid;\n\n\tkuid = make_kuid(ns, uid);\n\tif (!uid_valid(kuid))\n\t\treturn -EINVAL;\n\n\tnew = prepare_creds();\n\tif (!new)\n\t\treturn -ENOMEM;\n\told = current_cred();\n\n\tretval = -EPERM;\n\tif (ns_capable_setid(old->user_ns, CAP_SETUID)) {\n\t\tnew->suid = new->uid = kuid;\n\t\tif (!uid_eq(kuid, old->uid)) {\n\t\t\tretval = set_user(new);\n\t\t\tif (retval < 0)\n\t\t\t\tgoto error;\n\t\t}\n\t} else if (!uid_eq(kuid, old->uid) && !uid_eq(kuid, new->suid)) {\n\t\tgoto error;\n\t}\n\n\tnew->fsuid = new->euid = kuid;\n\n\tretval = security_task_fix_setuid(new, old, LSM_SETID_ID);\n\tif (retval < 0)\n\t\tgoto error;\n\n\tretval = set_cred_ucounts(new);\n\tif (retval < 0)\n\t\tgoto error;\n\n\treturn commit_creds(new);\n\nerror:\n\tabort_creds(new);\n\treturn retval;\n}"
  },
  {
    "function_name": "__sys_setreuid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "509-571",
    "snippet": "long __sys_setreuid(uid_t ruid, uid_t euid)\n{\n\tstruct user_namespace *ns = current_user_ns();\n\tconst struct cred *old;\n\tstruct cred *new;\n\tint retval;\n\tkuid_t kruid, keuid;\n\n\tkruid = make_kuid(ns, ruid);\n\tkeuid = make_kuid(ns, euid);\n\n\tif ((ruid != (uid_t) -1) && !uid_valid(kruid))\n\t\treturn -EINVAL;\n\tif ((euid != (uid_t) -1) && !uid_valid(keuid))\n\t\treturn -EINVAL;\n\n\tnew = prepare_creds();\n\tif (!new)\n\t\treturn -ENOMEM;\n\told = current_cred();\n\n\tretval = -EPERM;\n\tif (ruid != (uid_t) -1) {\n\t\tnew->uid = kruid;\n\t\tif (!uid_eq(old->uid, kruid) &&\n\t\t    !uid_eq(old->euid, kruid) &&\n\t\t    !ns_capable_setid(old->user_ns, CAP_SETUID))\n\t\t\tgoto error;\n\t}\n\n\tif (euid != (uid_t) -1) {\n\t\tnew->euid = keuid;\n\t\tif (!uid_eq(old->uid, keuid) &&\n\t\t    !uid_eq(old->euid, keuid) &&\n\t\t    !uid_eq(old->suid, keuid) &&\n\t\t    !ns_capable_setid(old->user_ns, CAP_SETUID))\n\t\t\tgoto error;\n\t}\n\n\tif (!uid_eq(new->uid, old->uid)) {\n\t\tretval = set_user(new);\n\t\tif (retval < 0)\n\t\t\tgoto error;\n\t}\n\tif (ruid != (uid_t) -1 ||\n\t    (euid != (uid_t) -1 && !uid_eq(keuid, old->uid)))\n\t\tnew->suid = new->euid;\n\tnew->fsuid = new->euid;\n\n\tretval = security_task_fix_setuid(new, old, LSM_SETID_RE);\n\tif (retval < 0)\n\t\tgoto error;\n\n\tretval = set_cred_ucounts(new);\n\tif (retval < 0)\n\t\tgoto error;\n\n\treturn commit_creds(new);\n\nerror:\n\tabort_creds(new);\n\treturn retval;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "abort_creds",
          "args": [
            "new"
          ],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "abort_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "533-544",
          "snippet": "void abort_creds(struct cred *new)\n{\n\tkdebug(\"abort_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(new) != 0);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\tput_cred(new);\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nvoid abort_creds(struct cred *new)\n{\n\tkdebug(\"abort_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(new) != 0);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\tput_cred(new);\n}"
        }
      },
      {
        "call_info": {
          "callee": "commit_creds",
          "args": [
            "new"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "commit_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "447-523",
          "snippet": "int commit_creds(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\n\tkdebug(\"commit_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n\tBUG_ON(task->cred != old);\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(old) < 2);\n\tvalidate_creds(old);\n\tvalidate_creds(new);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\n\tget_cred(new); /* we will require a ref for the subj creds too */\n\n\t/* dumpability changes */\n\tif (!uid_eq(old->euid, new->euid) ||\n\t    !gid_eq(old->egid, new->egid) ||\n\t    !uid_eq(old->fsuid, new->fsuid) ||\n\t    !gid_eq(old->fsgid, new->fsgid) ||\n\t    !cred_cap_issubset(old, new)) {\n\t\tif (task->mm)\n\t\t\tset_dumpable(task->mm, suid_dumpable);\n\t\ttask->pdeath_signal = 0;\n\t\t/*\n\t\t * If a task drops privileges and becomes nondumpable,\n\t\t * the dumpability change must become visible before\n\t\t * the credential change; otherwise, a __ptrace_may_access()\n\t\t * racing with this change may be able to attach to a task it\n\t\t * shouldn't be able to attach to (as if the task had dropped\n\t\t * privileges without becoming nondumpable).\n\t\t * Pairs with a read barrier in __ptrace_may_access().\n\t\t */\n\t\tsmp_wmb();\n\t}\n\n\t/* alter the thread keyring */\n\tif (!uid_eq(new->fsuid, old->fsuid))\n\t\tkey_fsuid_changed(new);\n\tif (!gid_eq(new->fsgid, old->fsgid))\n\t\tkey_fsgid_changed(new);\n\n\t/* do it\n\t * RLIMIT_NPROC limits on user->processes have already been checked\n\t * in set_user().\n\t */\n\talter_cred_subscribers(new, 2);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tinc_rlimit_ucounts(new->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\trcu_assign_pointer(task->real_cred, new);\n\trcu_assign_pointer(task->cred, new);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tdec_rlimit_ucounts(old->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\talter_cred_subscribers(old, -2);\n\n\t/* send notifications */\n\tif (!uid_eq(new->uid,   old->uid)  ||\n\t    !uid_eq(new->euid,  old->euid) ||\n\t    !uid_eq(new->suid,  old->suid) ||\n\t    !uid_eq(new->fsuid, old->fsuid))\n\t\tproc_id_connector(task, PROC_EVENT_UID);\n\n\tif (!gid_eq(new->gid,   old->gid)  ||\n\t    !gid_eq(new->egid,  old->egid) ||\n\t    !gid_eq(new->sgid,  old->sgid) ||\n\t    !gid_eq(new->fsgid, old->fsgid))\n\t\tproc_id_connector(task, PROC_EVENT_GID);\n\n\t/* release the old obj and subj refs both */\n\tput_cred(old);\n\tput_cred(old);\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nint commit_creds(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\n\tkdebug(\"commit_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n\tBUG_ON(task->cred != old);\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(old) < 2);\n\tvalidate_creds(old);\n\tvalidate_creds(new);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\n\tget_cred(new); /* we will require a ref for the subj creds too */\n\n\t/* dumpability changes */\n\tif (!uid_eq(old->euid, new->euid) ||\n\t    !gid_eq(old->egid, new->egid) ||\n\t    !uid_eq(old->fsuid, new->fsuid) ||\n\t    !gid_eq(old->fsgid, new->fsgid) ||\n\t    !cred_cap_issubset(old, new)) {\n\t\tif (task->mm)\n\t\t\tset_dumpable(task->mm, suid_dumpable);\n\t\ttask->pdeath_signal = 0;\n\t\t/*\n\t\t * If a task drops privileges and becomes nondumpable,\n\t\t * the dumpability change must become visible before\n\t\t * the credential change; otherwise, a __ptrace_may_access()\n\t\t * racing with this change may be able to attach to a task it\n\t\t * shouldn't be able to attach to (as if the task had dropped\n\t\t * privileges without becoming nondumpable).\n\t\t * Pairs with a read barrier in __ptrace_may_access().\n\t\t */\n\t\tsmp_wmb();\n\t}\n\n\t/* alter the thread keyring */\n\tif (!uid_eq(new->fsuid, old->fsuid))\n\t\tkey_fsuid_changed(new);\n\tif (!gid_eq(new->fsgid, old->fsgid))\n\t\tkey_fsgid_changed(new);\n\n\t/* do it\n\t * RLIMIT_NPROC limits on user->processes have already been checked\n\t * in set_user().\n\t */\n\talter_cred_subscribers(new, 2);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tinc_rlimit_ucounts(new->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\trcu_assign_pointer(task->real_cred, new);\n\trcu_assign_pointer(task->cred, new);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tdec_rlimit_ucounts(old->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\talter_cred_subscribers(old, -2);\n\n\t/* send notifications */\n\tif (!uid_eq(new->uid,   old->uid)  ||\n\t    !uid_eq(new->euid,  old->euid) ||\n\t    !uid_eq(new->suid,  old->suid) ||\n\t    !uid_eq(new->fsuid, old->fsuid))\n\t\tproc_id_connector(task, PROC_EVENT_UID);\n\n\tif (!gid_eq(new->gid,   old->gid)  ||\n\t    !gid_eq(new->egid,  old->egid) ||\n\t    !gid_eq(new->sgid,  old->sgid) ||\n\t    !gid_eq(new->fsgid, old->fsgid))\n\t\tproc_id_connector(task, PROC_EVENT_GID);\n\n\t/* release the old obj and subj refs both */\n\tput_cred(old);\n\tput_cred(old);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_cred_ucounts",
          "args": [
            "new"
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "set_cred_ucounts",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "666-689",
          "snippet": "int set_cred_ucounts(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\tstruct ucounts *new_ucounts, *old_ucounts = new->ucounts;\n\n\tif (new->user == old->user && new->user_ns == old->user_ns)\n\t\treturn 0;\n\n\t/*\n\t * This optimization is needed because alloc_ucounts() uses locks\n\t * for table lookups.\n\t */\n\tif (old_ucounts->ns == new->user_ns && uid_eq(old_ucounts->uid, new->euid))\n\t\treturn 0;\n\n\tif (!(new_ucounts = alloc_ucounts(new->user_ns, new->euid)))\n\t\treturn -EAGAIN;\n\n\tnew->ucounts = new_ucounts;\n\tput_ucounts(old_ucounts);\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nint set_cred_ucounts(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\tstruct ucounts *new_ucounts, *old_ucounts = new->ucounts;\n\n\tif (new->user == old->user && new->user_ns == old->user_ns)\n\t\treturn 0;\n\n\t/*\n\t * This optimization is needed because alloc_ucounts() uses locks\n\t * for table lookups.\n\t */\n\tif (old_ucounts->ns == new->user_ns && uid_eq(old_ucounts->uid, new->euid))\n\t\treturn 0;\n\n\tif (!(new_ucounts = alloc_ucounts(new->user_ns, new->euid)))\n\t\treturn -EAGAIN;\n\n\tnew->ucounts = new_ucounts;\n\tput_ucounts(old_ucounts);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "security_task_fix_setuid",
          "args": [
            "new",
            "old",
            "LSM_SETID_RE"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "keuid",
            "old->uid"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_user",
          "args": [
            "new"
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "set_user",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
          "lines": "467-492",
          "snippet": "static int set_user(struct cred *new)\n{\n\tstruct user_struct *new_user;\n\n\tnew_user = alloc_uid(new->uid);\n\tif (!new_user)\n\t\treturn -EAGAIN;\n\n\t/*\n\t * We don't fail in case of NPROC limit excess here because too many\n\t * poorly written programs don't check set*uid() return code, assuming\n\t * it never fails if called by root.  We may still enforce NPROC limit\n\t * for programs doing set*uid()+execve() by harmlessly deferring the\n\t * failure to the execve() stage.\n\t */\n\tif (is_ucounts_overlimit(new->ucounts, UCOUNT_RLIMIT_NPROC, rlimit(RLIMIT_NPROC)) &&\n\t\t\tnew_user != INIT_USER &&\n\t\t\t!capable(CAP_SYS_RESOURCE) && !capable(CAP_SYS_ADMIN))\n\t\tcurrent->flags |= PF_NPROC_EXCEEDED;\n\telse\n\t\tcurrent->flags &= ~PF_NPROC_EXCEEDED;\n\n\tfree_uid(new->user);\n\tnew->user = new_user;\n\treturn 0;\n}",
          "includes": [
            "#include \"uid16.h\"",
            "#include <asm/unistd.h>",
            "#include <asm/io.h>",
            "#include <linux/uaccess.h>",
            "#include <generated/utsrelease.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/nospec.h>",
            "#include <linux/cred.h>",
            "#include <linux/uidgid.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/sched.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/time_namespace.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscall_user_dispatch.h>",
            "#include <linux/ctype.h>",
            "#include <linux/version.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mount.h>",
            "#include <linux/file.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/personality.h>",
            "#include <linux/cpu.h>",
            "#include <linux/seccomp.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/getcpu.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/signal.h>",
            "#include <linux/tty.h>",
            "#include <linux/suspend.h>",
            "#include <linux/security.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/times.h>",
            "#include <linux/key.h>",
            "#include <linux/device.h>",
            "#include <linux/capability.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kernel.h>",
            "#include <linux/resource.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/kmod.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/prctl.h>",
            "#include <linux/reboot.h>",
            "#include <linux/mman.h>",
            "#include <linux/utsname.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic int set_user(struct cred *new)\n{\n\tstruct user_struct *new_user;\n\n\tnew_user = alloc_uid(new->uid);\n\tif (!new_user)\n\t\treturn -EAGAIN;\n\n\t/*\n\t * We don't fail in case of NPROC limit excess here because too many\n\t * poorly written programs don't check set*uid() return code, assuming\n\t * it never fails if called by root.  We may still enforce NPROC limit\n\t * for programs doing set*uid()+execve() by harmlessly deferring the\n\t * failure to the execve() stage.\n\t */\n\tif (is_ucounts_overlimit(new->ucounts, UCOUNT_RLIMIT_NPROC, rlimit(RLIMIT_NPROC)) &&\n\t\t\tnew_user != INIT_USER &&\n\t\t\t!capable(CAP_SYS_RESOURCE) && !capable(CAP_SYS_ADMIN))\n\t\tcurrent->flags |= PF_NPROC_EXCEEDED;\n\telse\n\t\tcurrent->flags &= ~PF_NPROC_EXCEEDED;\n\n\tfree_uid(new->user);\n\tnew->user = new_user;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "new->uid",
            "old->uid"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ns_capable_setid",
          "args": [
            "old->user_ns",
            "CAP_SETUID"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "ns_capable_setid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/capability.c",
          "lines": "431-434",
          "snippet": "bool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/user_namespace.h>\n#include <linux/pid_namespace.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n\nbool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}"
        }
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "old->suid",
            "keuid"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "old->euid",
            "keuid"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "old->uid",
            "keuid"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "old->euid",
            "kruid"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "old->uid",
            "kruid"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_cred",
          "args": [],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_creds",
          "args": [],
          "line": 525
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "252-300",
          "snippet": "struct cred *prepare_creds(void)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old;\n\tstruct cred *new;\n\n\tvalidate_process_creds();\n\n\tnew = kmem_cache_alloc(cred_jar, GFP_KERNEL);\n\tif (!new)\n\t\treturn NULL;\n\n\tkdebug(\"prepare_creds() alloc %p\", new);\n\n\told = task->cred;\n\tmemcpy(new, old, sizeof(struct cred));\n\n\tnew->non_rcu = 0;\n\tatomic_set(&new->usage, 1);\n\tset_cred_subscribers(new, 0);\n\tget_group_info(new->group_info);\n\tget_uid(new->user);\n\tget_user_ns(new->user_ns);\n\n#ifdef CONFIG_KEYS\n\tkey_get(new->session_keyring);\n\tkey_get(new->process_keyring);\n\tkey_get(new->thread_keyring);\n\tkey_get(new->request_key_auth);\n#endif\n\n#ifdef CONFIG_SECURITY\n\tnew->security = NULL;\n#endif\n\n\tnew->ucounts = get_ucounts(new->ucounts);\n\tif (!new->ucounts)\n\t\tgoto error;\n\n\tif (security_prepare_creds(new, old, GFP_KERNEL_ACCOUNT) < 0)\n\t\tgoto error;\n\n\tvalidate_creds(new);\n\treturn new;\n\nerror:\n\tabort_creds(new);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *cred_jar;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nstatic struct kmem_cache *cred_jar;\n\nstruct cred *prepare_creds(void)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old;\n\tstruct cred *new;\n\n\tvalidate_process_creds();\n\n\tnew = kmem_cache_alloc(cred_jar, GFP_KERNEL);\n\tif (!new)\n\t\treturn NULL;\n\n\tkdebug(\"prepare_creds() alloc %p\", new);\n\n\told = task->cred;\n\tmemcpy(new, old, sizeof(struct cred));\n\n\tnew->non_rcu = 0;\n\tatomic_set(&new->usage, 1);\n\tset_cred_subscribers(new, 0);\n\tget_group_info(new->group_info);\n\tget_uid(new->user);\n\tget_user_ns(new->user_ns);\n\n#ifdef CONFIG_KEYS\n\tkey_get(new->session_keyring);\n\tkey_get(new->process_keyring);\n\tkey_get(new->thread_keyring);\n\tkey_get(new->request_key_auth);\n#endif\n\n#ifdef CONFIG_SECURITY\n\tnew->security = NULL;\n#endif\n\n\tnew->ucounts = get_ucounts(new->ucounts);\n\tif (!new->ucounts)\n\t\tgoto error;\n\n\tif (security_prepare_creds(new, old, GFP_KERNEL_ACCOUNT) < 0)\n\t\tgoto error;\n\n\tvalidate_creds(new);\n\treturn new;\n\nerror:\n\tabort_creds(new);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "uid_valid",
          "args": [
            "keuid"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_valid",
          "args": [
            "kruid"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kuid",
          "args": [
            "ns",
            "euid"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "make_kuid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/user_namespace.c",
          "lines": "391-395",
          "snippet": "kuid_t make_kuid(struct user_namespace *ns, uid_t uid)\n{\n\t/* Map the uid to a global kernel uid */\n\treturn KUIDT_INIT(map_id_down(&ns->uid_map, uid));\n}",
          "includes": [
            "#include <linux/sort.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/projid.h>",
            "#include <linux/ctype.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fs.h>",
            "#include <linux/seq_file.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/securebits.h>",
            "#include <linux/cred.h>",
            "#include <linux/highuid.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sort.h>\n#include <linux/bsearch.h>\n#include <linux/fs_struct.h>\n#include <linux/projid.h>\n#include <linux/ctype.h>\n#include <linux/uaccess.h>\n#include <linux/fs.h>\n#include <linux/seq_file.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/securebits.h>\n#include <linux/cred.h>\n#include <linux/highuid.h>\n#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n\nkuid_t make_kuid(struct user_namespace *ns, uid_t uid)\n{\n\t/* Map the uid to a global kernel uid */\n\treturn KUIDT_INIT(map_id_down(&ns->uid_map, uid));\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nlong __sys_setreuid(uid_t ruid, uid_t euid)\n{\n\tstruct user_namespace *ns = current_user_ns();\n\tconst struct cred *old;\n\tstruct cred *new;\n\tint retval;\n\tkuid_t kruid, keuid;\n\n\tkruid = make_kuid(ns, ruid);\n\tkeuid = make_kuid(ns, euid);\n\n\tif ((ruid != (uid_t) -1) && !uid_valid(kruid))\n\t\treturn -EINVAL;\n\tif ((euid != (uid_t) -1) && !uid_valid(keuid))\n\t\treturn -EINVAL;\n\n\tnew = prepare_creds();\n\tif (!new)\n\t\treturn -ENOMEM;\n\told = current_cred();\n\n\tretval = -EPERM;\n\tif (ruid != (uid_t) -1) {\n\t\tnew->uid = kruid;\n\t\tif (!uid_eq(old->uid, kruid) &&\n\t\t    !uid_eq(old->euid, kruid) &&\n\t\t    !ns_capable_setid(old->user_ns, CAP_SETUID))\n\t\t\tgoto error;\n\t}\n\n\tif (euid != (uid_t) -1) {\n\t\tnew->euid = keuid;\n\t\tif (!uid_eq(old->uid, keuid) &&\n\t\t    !uid_eq(old->euid, keuid) &&\n\t\t    !uid_eq(old->suid, keuid) &&\n\t\t    !ns_capable_setid(old->user_ns, CAP_SETUID))\n\t\t\tgoto error;\n\t}\n\n\tif (!uid_eq(new->uid, old->uid)) {\n\t\tretval = set_user(new);\n\t\tif (retval < 0)\n\t\t\tgoto error;\n\t}\n\tif (ruid != (uid_t) -1 ||\n\t    (euid != (uid_t) -1 && !uid_eq(keuid, old->uid)))\n\t\tnew->suid = new->euid;\n\tnew->fsuid = new->euid;\n\n\tretval = security_task_fix_setuid(new, old, LSM_SETID_RE);\n\tif (retval < 0)\n\t\tgoto error;\n\n\tretval = set_cred_ucounts(new);\n\tif (retval < 0)\n\t\tgoto error;\n\n\treturn commit_creds(new);\n\nerror:\n\tabort_creds(new);\n\treturn retval;\n}"
  },
  {
    "function_name": "set_user",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "467-492",
    "snippet": "static int set_user(struct cred *new)\n{\n\tstruct user_struct *new_user;\n\n\tnew_user = alloc_uid(new->uid);\n\tif (!new_user)\n\t\treturn -EAGAIN;\n\n\t/*\n\t * We don't fail in case of NPROC limit excess here because too many\n\t * poorly written programs don't check set*uid() return code, assuming\n\t * it never fails if called by root.  We may still enforce NPROC limit\n\t * for programs doing set*uid()+execve() by harmlessly deferring the\n\t * failure to the execve() stage.\n\t */\n\tif (is_ucounts_overlimit(new->ucounts, UCOUNT_RLIMIT_NPROC, rlimit(RLIMIT_NPROC)) &&\n\t\t\tnew_user != INIT_USER &&\n\t\t\t!capable(CAP_SYS_RESOURCE) && !capable(CAP_SYS_ADMIN))\n\t\tcurrent->flags |= PF_NPROC_EXCEEDED;\n\telse\n\t\tcurrent->flags &= ~PF_NPROC_EXCEEDED;\n\n\tfree_uid(new->user);\n\tnew->user = new_user;\n\treturn 0;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_uid",
          "args": [
            "new->user"
          ],
          "line": 489
        },
        "resolved": true,
        "details": {
          "function_name": "free_uid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/user.c",
          "lines": "178-187",
          "snippet": "void free_uid(struct user_struct *up)\n{\n\tunsigned long flags;\n\n\tif (!up)\n\t\treturn;\n\n\tif (refcount_dec_and_lock_irqsave(&up->__count, &uidhash_lock, &flags))\n\t\tfree_user(up, flags);\n}",
          "includes": [
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/export.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/key.h>",
            "#include <linux/bitops.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(uidhash_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/interrupt.h>\n#include <linux/sched/user.h>\n#include <linux/key.h>\n#include <linux/bitops.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(uidhash_lock);\n\nvoid free_uid(struct user_struct *up)\n{\n\tunsigned long flags;\n\n\tif (!up)\n\t\treturn;\n\n\tif (refcount_dec_and_lock_irqsave(&up->__count, &uidhash_lock, &flags))\n\t\tfree_user(up, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "capable",
          "args": [
            "CAP_SYS_ADMIN"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "capable",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/capability.c",
          "lines": "447-450",
          "snippet": "bool capable(int cap)\n{\n\treturn ns_capable(&init_user_ns, cap);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/user_namespace.h>\n#include <linux/pid_namespace.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n\nbool capable(int cap)\n{\n\treturn ns_capable(&init_user_ns, cap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_ucounts_overlimit",
          "args": [
            "new->ucounts",
            "UCOUNT_RLIMIT_NPROC",
            "rlimit(RLIMIT_NPROC)"
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "is_ucounts_overlimit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/ucount.c",
          "lines": "344-356",
          "snippet": "bool is_ucounts_overlimit(struct ucounts *ucounts, enum ucount_type type, unsigned long rlimit)\n{\n\tstruct ucounts *iter;\n\tlong max = rlimit;\n\tif (rlimit > LONG_MAX)\n\t\tmax = LONG_MAX;\n\tfor (iter = ucounts; iter; iter = iter->ns->ucounts) {\n\t\tif (get_ucounts_value(iter, type) > max)\n\t\t\treturn true;\n\t\tmax = READ_ONCE(iter->ns->ucount_max[type]);\n\t}\n\treturn false;\n}",
          "includes": [
            "#include <linux/user_namespace.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/hash.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/user_namespace.h>\n#include <linux/kmemleak.h>\n#include <linux/hash.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/sysctl.h>\n#include <linux/stat.h>\n\nbool is_ucounts_overlimit(struct ucounts *ucounts, enum ucount_type type, unsigned long rlimit)\n{\n\tstruct ucounts *iter;\n\tlong max = rlimit;\n\tif (rlimit > LONG_MAX)\n\t\tmax = LONG_MAX;\n\tfor (iter = ucounts; iter; iter = iter->ns->ucounts) {\n\t\tif (get_ucounts_value(iter, type) > max)\n\t\t\treturn true;\n\t\tmax = READ_ONCE(iter->ns->ucount_max[type]);\n\t}\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rlimit",
          "args": [
            "RLIMIT_NPROC"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_uid",
          "args": [
            "new->uid"
          ],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_uid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/user.c",
          "lines": "189-229",
          "snippet": "struct user_struct *alloc_uid(kuid_t uid)\n{\n\tstruct hlist_head *hashent = uidhashentry(uid);\n\tstruct user_struct *up, *new;\n\n\tspin_lock_irq(&uidhash_lock);\n\tup = uid_hash_find(uid, hashent);\n\tspin_unlock_irq(&uidhash_lock);\n\n\tif (!up) {\n\t\tnew = kmem_cache_zalloc(uid_cachep, GFP_KERNEL);\n\t\tif (!new)\n\t\t\treturn NULL;\n\n\t\tnew->uid = uid;\n\t\trefcount_set(&new->__count, 1);\n\t\tif (user_epoll_alloc(new)) {\n\t\t\tkmem_cache_free(uid_cachep, new);\n\t\t\treturn NULL;\n\t\t}\n\t\tratelimit_state_init(&new->ratelimit, HZ, 100);\n\t\tratelimit_set_flags(&new->ratelimit, RATELIMIT_MSG_ON_RELEASE);\n\n\t\t/*\n\t\t * Before adding this, check whether we raced\n\t\t * on adding the same user already..\n\t\t */\n\t\tspin_lock_irq(&uidhash_lock);\n\t\tup = uid_hash_find(uid, hashent);\n\t\tif (up) {\n\t\t\tuser_epoll_free(new);\n\t\t\tkmem_cache_free(uid_cachep, new);\n\t\t} else {\n\t\t\tuid_hash_insert(new, hashent);\n\t\t\tup = new;\n\t\t}\n\t\tspin_unlock_irq(&uidhash_lock);\n\t}\n\n\treturn up;\n}",
          "includes": [
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/export.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/key.h>",
            "#include <linux/bitops.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *uid_cachep;",
            "static DEFINE_SPINLOCK(uidhash_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/export.h>\n#include <linux/interrupt.h>\n#include <linux/sched/user.h>\n#include <linux/key.h>\n#include <linux/bitops.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/init.h>\n\nstatic struct kmem_cache *uid_cachep;\nstatic DEFINE_SPINLOCK(uidhash_lock);\n\nstruct user_struct *alloc_uid(kuid_t uid)\n{\n\tstruct hlist_head *hashent = uidhashentry(uid);\n\tstruct user_struct *up, *new;\n\n\tspin_lock_irq(&uidhash_lock);\n\tup = uid_hash_find(uid, hashent);\n\tspin_unlock_irq(&uidhash_lock);\n\n\tif (!up) {\n\t\tnew = kmem_cache_zalloc(uid_cachep, GFP_KERNEL);\n\t\tif (!new)\n\t\t\treturn NULL;\n\n\t\tnew->uid = uid;\n\t\trefcount_set(&new->__count, 1);\n\t\tif (user_epoll_alloc(new)) {\n\t\t\tkmem_cache_free(uid_cachep, new);\n\t\t\treturn NULL;\n\t\t}\n\t\tratelimit_state_init(&new->ratelimit, HZ, 100);\n\t\tratelimit_set_flags(&new->ratelimit, RATELIMIT_MSG_ON_RELEASE);\n\n\t\t/*\n\t\t * Before adding this, check whether we raced\n\t\t * on adding the same user already..\n\t\t */\n\t\tspin_lock_irq(&uidhash_lock);\n\t\tup = uid_hash_find(uid, hashent);\n\t\tif (up) {\n\t\t\tuser_epoll_free(new);\n\t\t\tkmem_cache_free(uid_cachep, new);\n\t\t} else {\n\t\t\tuid_hash_insert(new, hashent);\n\t\t\tup = new;\n\t\t}\n\t\tspin_unlock_irq(&uidhash_lock);\n\t}\n\n\treturn up;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic int set_user(struct cred *new)\n{\n\tstruct user_struct *new_user;\n\n\tnew_user = alloc_uid(new->uid);\n\tif (!new_user)\n\t\treturn -EAGAIN;\n\n\t/*\n\t * We don't fail in case of NPROC limit excess here because too many\n\t * poorly written programs don't check set*uid() return code, assuming\n\t * it never fails if called by root.  We may still enforce NPROC limit\n\t * for programs doing set*uid()+execve() by harmlessly deferring the\n\t * failure to the execve() stage.\n\t */\n\tif (is_ucounts_overlimit(new->ucounts, UCOUNT_RLIMIT_NPROC, rlimit(RLIMIT_NPROC)) &&\n\t\t\tnew_user != INIT_USER &&\n\t\t\t!capable(CAP_SYS_RESOURCE) && !capable(CAP_SYS_ADMIN))\n\t\tcurrent->flags |= PF_NPROC_EXCEEDED;\n\telse\n\t\tcurrent->flags &= ~PF_NPROC_EXCEEDED;\n\n\tfree_uid(new->user);\n\tnew->user = new_user;\n\treturn 0;\n}"
  },
  {
    "function_name": "__sys_setgid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "423-457",
    "snippet": "long __sys_setgid(gid_t gid)\n{\n\tstruct user_namespace *ns = current_user_ns();\n\tconst struct cred *old;\n\tstruct cred *new;\n\tint retval;\n\tkgid_t kgid;\n\n\tkgid = make_kgid(ns, gid);\n\tif (!gid_valid(kgid))\n\t\treturn -EINVAL;\n\n\tnew = prepare_creds();\n\tif (!new)\n\t\treturn -ENOMEM;\n\told = current_cred();\n\n\tretval = -EPERM;\n\tif (ns_capable_setid(old->user_ns, CAP_SETGID))\n\t\tnew->gid = new->egid = new->sgid = new->fsgid = kgid;\n\telse if (gid_eq(kgid, old->gid) || gid_eq(kgid, old->sgid))\n\t\tnew->egid = new->fsgid = kgid;\n\telse\n\t\tgoto error;\n\n\tretval = security_task_fix_setgid(new, old, LSM_SETID_ID);\n\tif (retval < 0)\n\t\tgoto error;\n\n\treturn commit_creds(new);\n\nerror:\n\tabort_creds(new);\n\treturn retval;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "abort_creds",
          "args": [
            "new"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "abort_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "533-544",
          "snippet": "void abort_creds(struct cred *new)\n{\n\tkdebug(\"abort_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(new) != 0);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\tput_cred(new);\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nvoid abort_creds(struct cred *new)\n{\n\tkdebug(\"abort_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(new) != 0);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\tput_cred(new);\n}"
        }
      },
      {
        "call_info": {
          "callee": "commit_creds",
          "args": [
            "new"
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "commit_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "447-523",
          "snippet": "int commit_creds(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\n\tkdebug(\"commit_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n\tBUG_ON(task->cred != old);\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(old) < 2);\n\tvalidate_creds(old);\n\tvalidate_creds(new);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\n\tget_cred(new); /* we will require a ref for the subj creds too */\n\n\t/* dumpability changes */\n\tif (!uid_eq(old->euid, new->euid) ||\n\t    !gid_eq(old->egid, new->egid) ||\n\t    !uid_eq(old->fsuid, new->fsuid) ||\n\t    !gid_eq(old->fsgid, new->fsgid) ||\n\t    !cred_cap_issubset(old, new)) {\n\t\tif (task->mm)\n\t\t\tset_dumpable(task->mm, suid_dumpable);\n\t\ttask->pdeath_signal = 0;\n\t\t/*\n\t\t * If a task drops privileges and becomes nondumpable,\n\t\t * the dumpability change must become visible before\n\t\t * the credential change; otherwise, a __ptrace_may_access()\n\t\t * racing with this change may be able to attach to a task it\n\t\t * shouldn't be able to attach to (as if the task had dropped\n\t\t * privileges without becoming nondumpable).\n\t\t * Pairs with a read barrier in __ptrace_may_access().\n\t\t */\n\t\tsmp_wmb();\n\t}\n\n\t/* alter the thread keyring */\n\tif (!uid_eq(new->fsuid, old->fsuid))\n\t\tkey_fsuid_changed(new);\n\tif (!gid_eq(new->fsgid, old->fsgid))\n\t\tkey_fsgid_changed(new);\n\n\t/* do it\n\t * RLIMIT_NPROC limits on user->processes have already been checked\n\t * in set_user().\n\t */\n\talter_cred_subscribers(new, 2);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tinc_rlimit_ucounts(new->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\trcu_assign_pointer(task->real_cred, new);\n\trcu_assign_pointer(task->cred, new);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tdec_rlimit_ucounts(old->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\talter_cred_subscribers(old, -2);\n\n\t/* send notifications */\n\tif (!uid_eq(new->uid,   old->uid)  ||\n\t    !uid_eq(new->euid,  old->euid) ||\n\t    !uid_eq(new->suid,  old->suid) ||\n\t    !uid_eq(new->fsuid, old->fsuid))\n\t\tproc_id_connector(task, PROC_EVENT_UID);\n\n\tif (!gid_eq(new->gid,   old->gid)  ||\n\t    !gid_eq(new->egid,  old->egid) ||\n\t    !gid_eq(new->sgid,  old->sgid) ||\n\t    !gid_eq(new->fsgid, old->fsgid))\n\t\tproc_id_connector(task, PROC_EVENT_GID);\n\n\t/* release the old obj and subj refs both */\n\tput_cred(old);\n\tput_cred(old);\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nint commit_creds(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\n\tkdebug(\"commit_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n\tBUG_ON(task->cred != old);\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(old) < 2);\n\tvalidate_creds(old);\n\tvalidate_creds(new);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\n\tget_cred(new); /* we will require a ref for the subj creds too */\n\n\t/* dumpability changes */\n\tif (!uid_eq(old->euid, new->euid) ||\n\t    !gid_eq(old->egid, new->egid) ||\n\t    !uid_eq(old->fsuid, new->fsuid) ||\n\t    !gid_eq(old->fsgid, new->fsgid) ||\n\t    !cred_cap_issubset(old, new)) {\n\t\tif (task->mm)\n\t\t\tset_dumpable(task->mm, suid_dumpable);\n\t\ttask->pdeath_signal = 0;\n\t\t/*\n\t\t * If a task drops privileges and becomes nondumpable,\n\t\t * the dumpability change must become visible before\n\t\t * the credential change; otherwise, a __ptrace_may_access()\n\t\t * racing with this change may be able to attach to a task it\n\t\t * shouldn't be able to attach to (as if the task had dropped\n\t\t * privileges without becoming nondumpable).\n\t\t * Pairs with a read barrier in __ptrace_may_access().\n\t\t */\n\t\tsmp_wmb();\n\t}\n\n\t/* alter the thread keyring */\n\tif (!uid_eq(new->fsuid, old->fsuid))\n\t\tkey_fsuid_changed(new);\n\tif (!gid_eq(new->fsgid, old->fsgid))\n\t\tkey_fsgid_changed(new);\n\n\t/* do it\n\t * RLIMIT_NPROC limits on user->processes have already been checked\n\t * in set_user().\n\t */\n\talter_cred_subscribers(new, 2);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tinc_rlimit_ucounts(new->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\trcu_assign_pointer(task->real_cred, new);\n\trcu_assign_pointer(task->cred, new);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tdec_rlimit_ucounts(old->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\talter_cred_subscribers(old, -2);\n\n\t/* send notifications */\n\tif (!uid_eq(new->uid,   old->uid)  ||\n\t    !uid_eq(new->euid,  old->euid) ||\n\t    !uid_eq(new->suid,  old->suid) ||\n\t    !uid_eq(new->fsuid, old->fsuid))\n\t\tproc_id_connector(task, PROC_EVENT_UID);\n\n\tif (!gid_eq(new->gid,   old->gid)  ||\n\t    !gid_eq(new->egid,  old->egid) ||\n\t    !gid_eq(new->sgid,  old->sgid) ||\n\t    !gid_eq(new->fsgid, old->fsgid))\n\t\tproc_id_connector(task, PROC_EVENT_GID);\n\n\t/* release the old obj and subj refs both */\n\tput_cred(old);\n\tput_cred(old);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "security_task_fix_setgid",
          "args": [
            "new",
            "old",
            "LSM_SETID_ID"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "kgid",
            "old->sgid"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "kgid",
            "old->gid"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ns_capable_setid",
          "args": [
            "old->user_ns",
            "CAP_SETGID"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "ns_capable_setid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/capability.c",
          "lines": "431-434",
          "snippet": "bool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/user_namespace.h>\n#include <linux/pid_namespace.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n\nbool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_cred",
          "args": [],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_creds",
          "args": [],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "252-300",
          "snippet": "struct cred *prepare_creds(void)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old;\n\tstruct cred *new;\n\n\tvalidate_process_creds();\n\n\tnew = kmem_cache_alloc(cred_jar, GFP_KERNEL);\n\tif (!new)\n\t\treturn NULL;\n\n\tkdebug(\"prepare_creds() alloc %p\", new);\n\n\told = task->cred;\n\tmemcpy(new, old, sizeof(struct cred));\n\n\tnew->non_rcu = 0;\n\tatomic_set(&new->usage, 1);\n\tset_cred_subscribers(new, 0);\n\tget_group_info(new->group_info);\n\tget_uid(new->user);\n\tget_user_ns(new->user_ns);\n\n#ifdef CONFIG_KEYS\n\tkey_get(new->session_keyring);\n\tkey_get(new->process_keyring);\n\tkey_get(new->thread_keyring);\n\tkey_get(new->request_key_auth);\n#endif\n\n#ifdef CONFIG_SECURITY\n\tnew->security = NULL;\n#endif\n\n\tnew->ucounts = get_ucounts(new->ucounts);\n\tif (!new->ucounts)\n\t\tgoto error;\n\n\tif (security_prepare_creds(new, old, GFP_KERNEL_ACCOUNT) < 0)\n\t\tgoto error;\n\n\tvalidate_creds(new);\n\treturn new;\n\nerror:\n\tabort_creds(new);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *cred_jar;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nstatic struct kmem_cache *cred_jar;\n\nstruct cred *prepare_creds(void)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old;\n\tstruct cred *new;\n\n\tvalidate_process_creds();\n\n\tnew = kmem_cache_alloc(cred_jar, GFP_KERNEL);\n\tif (!new)\n\t\treturn NULL;\n\n\tkdebug(\"prepare_creds() alloc %p\", new);\n\n\told = task->cred;\n\tmemcpy(new, old, sizeof(struct cred));\n\n\tnew->non_rcu = 0;\n\tatomic_set(&new->usage, 1);\n\tset_cred_subscribers(new, 0);\n\tget_group_info(new->group_info);\n\tget_uid(new->user);\n\tget_user_ns(new->user_ns);\n\n#ifdef CONFIG_KEYS\n\tkey_get(new->session_keyring);\n\tkey_get(new->process_keyring);\n\tkey_get(new->thread_keyring);\n\tkey_get(new->request_key_auth);\n#endif\n\n#ifdef CONFIG_SECURITY\n\tnew->security = NULL;\n#endif\n\n\tnew->ucounts = get_ucounts(new->ucounts);\n\tif (!new->ucounts)\n\t\tgoto error;\n\n\tif (security_prepare_creds(new, old, GFP_KERNEL_ACCOUNT) < 0)\n\t\tgoto error;\n\n\tvalidate_creds(new);\n\treturn new;\n\nerror:\n\tabort_creds(new);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gid_valid",
          "args": [
            "kgid"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kgid",
          "args": [
            "ns",
            "gid"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "make_kgid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/user_namespace.c",
          "lines": "459-463",
          "snippet": "kgid_t make_kgid(struct user_namespace *ns, gid_t gid)\n{\n\t/* Map the gid to a global kernel gid */\n\treturn KGIDT_INIT(map_id_down(&ns->gid_map, gid));\n}",
          "includes": [
            "#include <linux/sort.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/projid.h>",
            "#include <linux/ctype.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fs.h>",
            "#include <linux/seq_file.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/securebits.h>",
            "#include <linux/cred.h>",
            "#include <linux/highuid.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sort.h>\n#include <linux/bsearch.h>\n#include <linux/fs_struct.h>\n#include <linux/projid.h>\n#include <linux/ctype.h>\n#include <linux/uaccess.h>\n#include <linux/fs.h>\n#include <linux/seq_file.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/securebits.h>\n#include <linux/cred.h>\n#include <linux/highuid.h>\n#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n\nkgid_t make_kgid(struct user_namespace *ns, gid_t gid)\n{\n\t/* Map the gid to a global kernel gid */\n\treturn KGIDT_INIT(map_id_down(&ns->gid_map, gid));\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nlong __sys_setgid(gid_t gid)\n{\n\tstruct user_namespace *ns = current_user_ns();\n\tconst struct cred *old;\n\tstruct cred *new;\n\tint retval;\n\tkgid_t kgid;\n\n\tkgid = make_kgid(ns, gid);\n\tif (!gid_valid(kgid))\n\t\treturn -EINVAL;\n\n\tnew = prepare_creds();\n\tif (!new)\n\t\treturn -ENOMEM;\n\told = current_cred();\n\n\tretval = -EPERM;\n\tif (ns_capable_setid(old->user_ns, CAP_SETGID))\n\t\tnew->gid = new->egid = new->sgid = new->fsgid = kgid;\n\telse if (gid_eq(kgid, old->gid) || gid_eq(kgid, old->sgid))\n\t\tnew->egid = new->fsgid = kgid;\n\telse\n\t\tgoto error;\n\n\tretval = security_task_fix_setgid(new, old, LSM_SETID_ID);\n\tif (retval < 0)\n\t\tgoto error;\n\n\treturn commit_creds(new);\n\nerror:\n\tabort_creds(new);\n\treturn retval;\n}"
  },
  {
    "function_name": "__sys_setregid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "357-411",
    "snippet": "long __sys_setregid(gid_t rgid, gid_t egid)\n{\n\tstruct user_namespace *ns = current_user_ns();\n\tconst struct cred *old;\n\tstruct cred *new;\n\tint retval;\n\tkgid_t krgid, kegid;\n\n\tkrgid = make_kgid(ns, rgid);\n\tkegid = make_kgid(ns, egid);\n\n\tif ((rgid != (gid_t) -1) && !gid_valid(krgid))\n\t\treturn -EINVAL;\n\tif ((egid != (gid_t) -1) && !gid_valid(kegid))\n\t\treturn -EINVAL;\n\n\tnew = prepare_creds();\n\tif (!new)\n\t\treturn -ENOMEM;\n\told = current_cred();\n\n\tretval = -EPERM;\n\tif (rgid != (gid_t) -1) {\n\t\tif (gid_eq(old->gid, krgid) ||\n\t\t    gid_eq(old->egid, krgid) ||\n\t\t    ns_capable_setid(old->user_ns, CAP_SETGID))\n\t\t\tnew->gid = krgid;\n\t\telse\n\t\t\tgoto error;\n\t}\n\tif (egid != (gid_t) -1) {\n\t\tif (gid_eq(old->gid, kegid) ||\n\t\t    gid_eq(old->egid, kegid) ||\n\t\t    gid_eq(old->sgid, kegid) ||\n\t\t    ns_capable_setid(old->user_ns, CAP_SETGID))\n\t\t\tnew->egid = kegid;\n\t\telse\n\t\t\tgoto error;\n\t}\n\n\tif (rgid != (gid_t) -1 ||\n\t    (egid != (gid_t) -1 && !gid_eq(kegid, old->gid)))\n\t\tnew->sgid = new->egid;\n\tnew->fsgid = new->egid;\n\n\tretval = security_task_fix_setgid(new, old, LSM_SETID_RE);\n\tif (retval < 0)\n\t\tgoto error;\n\n\treturn commit_creds(new);\n\nerror:\n\tabort_creds(new);\n\treturn retval;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "abort_creds",
          "args": [
            "new"
          ],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "abort_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "533-544",
          "snippet": "void abort_creds(struct cred *new)\n{\n\tkdebug(\"abort_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(new) != 0);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\tput_cred(new);\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nvoid abort_creds(struct cred *new)\n{\n\tkdebug(\"abort_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(new) != 0);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\tput_cred(new);\n}"
        }
      },
      {
        "call_info": {
          "callee": "commit_creds",
          "args": [
            "new"
          ],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "commit_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "447-523",
          "snippet": "int commit_creds(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\n\tkdebug(\"commit_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n\tBUG_ON(task->cred != old);\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(old) < 2);\n\tvalidate_creds(old);\n\tvalidate_creds(new);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\n\tget_cred(new); /* we will require a ref for the subj creds too */\n\n\t/* dumpability changes */\n\tif (!uid_eq(old->euid, new->euid) ||\n\t    !gid_eq(old->egid, new->egid) ||\n\t    !uid_eq(old->fsuid, new->fsuid) ||\n\t    !gid_eq(old->fsgid, new->fsgid) ||\n\t    !cred_cap_issubset(old, new)) {\n\t\tif (task->mm)\n\t\t\tset_dumpable(task->mm, suid_dumpable);\n\t\ttask->pdeath_signal = 0;\n\t\t/*\n\t\t * If a task drops privileges and becomes nondumpable,\n\t\t * the dumpability change must become visible before\n\t\t * the credential change; otherwise, a __ptrace_may_access()\n\t\t * racing with this change may be able to attach to a task it\n\t\t * shouldn't be able to attach to (as if the task had dropped\n\t\t * privileges without becoming nondumpable).\n\t\t * Pairs with a read barrier in __ptrace_may_access().\n\t\t */\n\t\tsmp_wmb();\n\t}\n\n\t/* alter the thread keyring */\n\tif (!uid_eq(new->fsuid, old->fsuid))\n\t\tkey_fsuid_changed(new);\n\tif (!gid_eq(new->fsgid, old->fsgid))\n\t\tkey_fsgid_changed(new);\n\n\t/* do it\n\t * RLIMIT_NPROC limits on user->processes have already been checked\n\t * in set_user().\n\t */\n\talter_cred_subscribers(new, 2);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tinc_rlimit_ucounts(new->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\trcu_assign_pointer(task->real_cred, new);\n\trcu_assign_pointer(task->cred, new);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tdec_rlimit_ucounts(old->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\talter_cred_subscribers(old, -2);\n\n\t/* send notifications */\n\tif (!uid_eq(new->uid,   old->uid)  ||\n\t    !uid_eq(new->euid,  old->euid) ||\n\t    !uid_eq(new->suid,  old->suid) ||\n\t    !uid_eq(new->fsuid, old->fsuid))\n\t\tproc_id_connector(task, PROC_EVENT_UID);\n\n\tif (!gid_eq(new->gid,   old->gid)  ||\n\t    !gid_eq(new->egid,  old->egid) ||\n\t    !gid_eq(new->sgid,  old->sgid) ||\n\t    !gid_eq(new->fsgid, old->fsgid))\n\t\tproc_id_connector(task, PROC_EVENT_GID);\n\n\t/* release the old obj and subj refs both */\n\tput_cred(old);\n\tput_cred(old);\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nint commit_creds(struct cred *new)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old = task->real_cred;\n\n\tkdebug(\"commit_creds(%p{%d,%d})\", new,\n\t       atomic_read(&new->usage),\n\t       read_cred_subscribers(new));\n\n\tBUG_ON(task->cred != old);\n#ifdef CONFIG_DEBUG_CREDENTIALS\n\tBUG_ON(read_cred_subscribers(old) < 2);\n\tvalidate_creds(old);\n\tvalidate_creds(new);\n#endif\n\tBUG_ON(atomic_read(&new->usage) < 1);\n\n\tget_cred(new); /* we will require a ref for the subj creds too */\n\n\t/* dumpability changes */\n\tif (!uid_eq(old->euid, new->euid) ||\n\t    !gid_eq(old->egid, new->egid) ||\n\t    !uid_eq(old->fsuid, new->fsuid) ||\n\t    !gid_eq(old->fsgid, new->fsgid) ||\n\t    !cred_cap_issubset(old, new)) {\n\t\tif (task->mm)\n\t\t\tset_dumpable(task->mm, suid_dumpable);\n\t\ttask->pdeath_signal = 0;\n\t\t/*\n\t\t * If a task drops privileges and becomes nondumpable,\n\t\t * the dumpability change must become visible before\n\t\t * the credential change; otherwise, a __ptrace_may_access()\n\t\t * racing with this change may be able to attach to a task it\n\t\t * shouldn't be able to attach to (as if the task had dropped\n\t\t * privileges without becoming nondumpable).\n\t\t * Pairs with a read barrier in __ptrace_may_access().\n\t\t */\n\t\tsmp_wmb();\n\t}\n\n\t/* alter the thread keyring */\n\tif (!uid_eq(new->fsuid, old->fsuid))\n\t\tkey_fsuid_changed(new);\n\tif (!gid_eq(new->fsgid, old->fsgid))\n\t\tkey_fsgid_changed(new);\n\n\t/* do it\n\t * RLIMIT_NPROC limits on user->processes have already been checked\n\t * in set_user().\n\t */\n\talter_cred_subscribers(new, 2);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tinc_rlimit_ucounts(new->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\trcu_assign_pointer(task->real_cred, new);\n\trcu_assign_pointer(task->cred, new);\n\tif (new->user != old->user || new->user_ns != old->user_ns)\n\t\tdec_rlimit_ucounts(old->ucounts, UCOUNT_RLIMIT_NPROC, 1);\n\talter_cred_subscribers(old, -2);\n\n\t/* send notifications */\n\tif (!uid_eq(new->uid,   old->uid)  ||\n\t    !uid_eq(new->euid,  old->euid) ||\n\t    !uid_eq(new->suid,  old->suid) ||\n\t    !uid_eq(new->fsuid, old->fsuid))\n\t\tproc_id_connector(task, PROC_EVENT_UID);\n\n\tif (!gid_eq(new->gid,   old->gid)  ||\n\t    !gid_eq(new->egid,  old->egid) ||\n\t    !gid_eq(new->sgid,  old->sgid) ||\n\t    !gid_eq(new->fsgid, old->fsgid))\n\t\tproc_id_connector(task, PROC_EVENT_GID);\n\n\t/* release the old obj and subj refs both */\n\tput_cred(old);\n\tput_cred(old);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "security_task_fix_setgid",
          "args": [
            "new",
            "old",
            "LSM_SETID_RE"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "kegid",
            "old->gid"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ns_capable_setid",
          "args": [
            "old->user_ns",
            "CAP_SETGID"
          ],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "ns_capable_setid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/capability.c",
          "lines": "431-434",
          "snippet": "bool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/user_namespace.h>\n#include <linux/pid_namespace.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n\nbool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "old->sgid",
            "kegid"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "old->egid",
            "kegid"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "old->gid",
            "kegid"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "old->egid",
            "krgid"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "old->gid",
            "krgid"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_cred",
          "args": [],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_creds",
          "args": [],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_creds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cred.c",
          "lines": "252-300",
          "snippet": "struct cred *prepare_creds(void)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old;\n\tstruct cred *new;\n\n\tvalidate_process_creds();\n\n\tnew = kmem_cache_alloc(cred_jar, GFP_KERNEL);\n\tif (!new)\n\t\treturn NULL;\n\n\tkdebug(\"prepare_creds() alloc %p\", new);\n\n\told = task->cred;\n\tmemcpy(new, old, sizeof(struct cred));\n\n\tnew->non_rcu = 0;\n\tatomic_set(&new->usage, 1);\n\tset_cred_subscribers(new, 0);\n\tget_group_info(new->group_info);\n\tget_uid(new->user);\n\tget_user_ns(new->user_ns);\n\n#ifdef CONFIG_KEYS\n\tkey_get(new->session_keyring);\n\tkey_get(new->process_keyring);\n\tkey_get(new->thread_keyring);\n\tkey_get(new->request_key_auth);\n#endif\n\n#ifdef CONFIG_SECURITY\n\tnew->security = NULL;\n#endif\n\n\tnew->ucounts = get_ucounts(new->ucounts);\n\tif (!new->ucounts)\n\t\tgoto error;\n\n\tif (security_prepare_creds(new, old, GFP_KERNEL_ACCOUNT) < 0)\n\t\tgoto error;\n\n\tvalidate_creds(new);\n\treturn new;\n\nerror:\n\tabort_creds(new);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/uidgid.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/security.h>",
            "#include <linux/init_task.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/key.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/cred.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *cred_jar;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uidgid.h>\n#include <linux/cn_proc.h>\n#include <linux/binfmts.h>\n#include <linux/security.h>\n#include <linux/init_task.h>\n#include <linux/keyctl.h>\n#include <linux/key.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/cred.h>\n#include <linux/export.h>\n\nstatic struct kmem_cache *cred_jar;\n\nstruct cred *prepare_creds(void)\n{\n\tstruct task_struct *task = current;\n\tconst struct cred *old;\n\tstruct cred *new;\n\n\tvalidate_process_creds();\n\n\tnew = kmem_cache_alloc(cred_jar, GFP_KERNEL);\n\tif (!new)\n\t\treturn NULL;\n\n\tkdebug(\"prepare_creds() alloc %p\", new);\n\n\told = task->cred;\n\tmemcpy(new, old, sizeof(struct cred));\n\n\tnew->non_rcu = 0;\n\tatomic_set(&new->usage, 1);\n\tset_cred_subscribers(new, 0);\n\tget_group_info(new->group_info);\n\tget_uid(new->user);\n\tget_user_ns(new->user_ns);\n\n#ifdef CONFIG_KEYS\n\tkey_get(new->session_keyring);\n\tkey_get(new->process_keyring);\n\tkey_get(new->thread_keyring);\n\tkey_get(new->request_key_auth);\n#endif\n\n#ifdef CONFIG_SECURITY\n\tnew->security = NULL;\n#endif\n\n\tnew->ucounts = get_ucounts(new->ucounts);\n\tif (!new->ucounts)\n\t\tgoto error;\n\n\tif (security_prepare_creds(new, old, GFP_KERNEL_ACCOUNT) < 0)\n\t\tgoto error;\n\n\tvalidate_creds(new);\n\treturn new;\n\nerror:\n\tabort_creds(new);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gid_valid",
          "args": [
            "kegid"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_valid",
          "args": [
            "krgid"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kgid",
          "args": [
            "ns",
            "egid"
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "make_kgid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/user_namespace.c",
          "lines": "459-463",
          "snippet": "kgid_t make_kgid(struct user_namespace *ns, gid_t gid)\n{\n\t/* Map the gid to a global kernel gid */\n\treturn KGIDT_INIT(map_id_down(&ns->gid_map, gid));\n}",
          "includes": [
            "#include <linux/sort.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/projid.h>",
            "#include <linux/ctype.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fs.h>",
            "#include <linux/seq_file.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/securebits.h>",
            "#include <linux/cred.h>",
            "#include <linux/highuid.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sort.h>\n#include <linux/bsearch.h>\n#include <linux/fs_struct.h>\n#include <linux/projid.h>\n#include <linux/ctype.h>\n#include <linux/uaccess.h>\n#include <linux/fs.h>\n#include <linux/seq_file.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/securebits.h>\n#include <linux/cred.h>\n#include <linux/highuid.h>\n#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n\nkgid_t make_kgid(struct user_namespace *ns, gid_t gid)\n{\n\t/* Map the gid to a global kernel gid */\n\treturn KGIDT_INIT(map_id_down(&ns->gid_map, gid));\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nlong __sys_setregid(gid_t rgid, gid_t egid)\n{\n\tstruct user_namespace *ns = current_user_ns();\n\tconst struct cred *old;\n\tstruct cred *new;\n\tint retval;\n\tkgid_t krgid, kegid;\n\n\tkrgid = make_kgid(ns, rgid);\n\tkegid = make_kgid(ns, egid);\n\n\tif ((rgid != (gid_t) -1) && !gid_valid(krgid))\n\t\treturn -EINVAL;\n\tif ((egid != (gid_t) -1) && !gid_valid(kegid))\n\t\treturn -EINVAL;\n\n\tnew = prepare_creds();\n\tif (!new)\n\t\treturn -ENOMEM;\n\told = current_cred();\n\n\tretval = -EPERM;\n\tif (rgid != (gid_t) -1) {\n\t\tif (gid_eq(old->gid, krgid) ||\n\t\t    gid_eq(old->egid, krgid) ||\n\t\t    ns_capable_setid(old->user_ns, CAP_SETGID))\n\t\t\tnew->gid = krgid;\n\t\telse\n\t\t\tgoto error;\n\t}\n\tif (egid != (gid_t) -1) {\n\t\tif (gid_eq(old->gid, kegid) ||\n\t\t    gid_eq(old->egid, kegid) ||\n\t\t    gid_eq(old->sgid, kegid) ||\n\t\t    ns_capable_setid(old->user_ns, CAP_SETGID))\n\t\t\tnew->egid = kegid;\n\t\telse\n\t\t\tgoto error;\n\t}\n\n\tif (rgid != (gid_t) -1 ||\n\t    (egid != (gid_t) -1 && !gid_eq(kegid, old->gid)))\n\t\tnew->sgid = new->egid;\n\tnew->fsgid = new->egid;\n\n\tretval = security_task_fix_setgid(new, old, LSM_SETID_RE);\n\tif (retval < 0)\n\t\tgoto error;\n\n\treturn commit_creds(new);\n\nerror:\n\tabort_creds(new);\n\treturn retval;\n}"
  },
  {
    "function_name": "set_one_prio",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "179-201",
    "snippet": "static int set_one_prio(struct task_struct *p, int niceval, int error)\n{\n\tint no_nice;\n\n\tif (!set_one_prio_perm(p)) {\n\t\terror = -EPERM;\n\t\tgoto out;\n\t}\n\tif (niceval < task_nice(p) && !can_nice(p, niceval)) {\n\t\terror = -EACCES;\n\t\tgoto out;\n\t}\n\tno_nice = security_task_setnice(p, niceval);\n\tif (no_nice) {\n\t\terror = no_nice;\n\t\tgoto out;\n\t}\n\tif (error == -ESRCH)\n\t\terror = 0;\n\tset_user_nice(p, niceval);\nout:\n\treturn error;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_user_nice",
          "args": [
            "p",
            "niceval"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "set_user_nice",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "6891-6942",
          "snippet": "void set_user_nice(struct task_struct *p, long nice)\n{\n\tbool queued, running;\n\tint old_prio;\n\tstruct rq_flags rf;\n\tstruct rq *rq;\n\n\tif (task_nice(p) == nice || nice < MIN_NICE || nice > MAX_NICE)\n\t\treturn;\n\t/*\n\t * We have to be careful, if called from sys_setpriority(),\n\t * the task might be in the middle of scheduling on another CPU.\n\t */\n\trq = task_rq_lock(p, &rf);\n\tupdate_rq_clock(rq);\n\n\t/*\n\t * The RT priorities are set via sched_setscheduler(), but we still\n\t * allow the 'normal' nice value to be set - but as expected\n\t * it won't have any effect on scheduling until the task is\n\t * SCHED_DEADLINE, SCHED_FIFO or SCHED_RR:\n\t */\n\tif (task_has_dl_policy(p) || task_has_rt_policy(p)) {\n\t\tp->static_prio = NICE_TO_PRIO(nice);\n\t\tgoto out_unlock;\n\t}\n\tqueued = task_on_rq_queued(p);\n\trunning = task_current(rq, p);\n\tif (queued)\n\t\tdequeue_task(rq, p, DEQUEUE_SAVE | DEQUEUE_NOCLOCK);\n\tif (running)\n\t\tput_prev_task(rq, p);\n\n\tp->static_prio = NICE_TO_PRIO(nice);\n\tset_load_weight(p, true);\n\told_prio = p->prio;\n\tp->prio = effective_prio(p);\n\n\tif (queued)\n\t\tenqueue_task(rq, p, ENQUEUE_RESTORE | ENQUEUE_NOCLOCK);\n\tif (running)\n\t\tset_next_task(rq, p);\n\n\t/*\n\t * If the task increased its priority or is running and\n\t * lowered its priority, then reschedule its CPU:\n\t */\n\tp->sched_class->prio_changed(rq, p, old_prio);\n\nout_unlock:\n\ttask_rq_unlock(rq, p, &rf);\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic __always_inline struct;\n\nvoid set_user_nice(struct task_struct *p, long nice)\n{\n\tbool queued, running;\n\tint old_prio;\n\tstruct rq_flags rf;\n\tstruct rq *rq;\n\n\tif (task_nice(p) == nice || nice < MIN_NICE || nice > MAX_NICE)\n\t\treturn;\n\t/*\n\t * We have to be careful, if called from sys_setpriority(),\n\t * the task might be in the middle of scheduling on another CPU.\n\t */\n\trq = task_rq_lock(p, &rf);\n\tupdate_rq_clock(rq);\n\n\t/*\n\t * The RT priorities are set via sched_setscheduler(), but we still\n\t * allow the 'normal' nice value to be set - but as expected\n\t * it won't have any effect on scheduling until the task is\n\t * SCHED_DEADLINE, SCHED_FIFO or SCHED_RR:\n\t */\n\tif (task_has_dl_policy(p) || task_has_rt_policy(p)) {\n\t\tp->static_prio = NICE_TO_PRIO(nice);\n\t\tgoto out_unlock;\n\t}\n\tqueued = task_on_rq_queued(p);\n\trunning = task_current(rq, p);\n\tif (queued)\n\t\tdequeue_task(rq, p, DEQUEUE_SAVE | DEQUEUE_NOCLOCK);\n\tif (running)\n\t\tput_prev_task(rq, p);\n\n\tp->static_prio = NICE_TO_PRIO(nice);\n\tset_load_weight(p, true);\n\told_prio = p->prio;\n\tp->prio = effective_prio(p);\n\n\tif (queued)\n\t\tenqueue_task(rq, p, ENQUEUE_RESTORE | ENQUEUE_NOCLOCK);\n\tif (running)\n\t\tset_next_task(rq, p);\n\n\t/*\n\t * If the task increased its priority or is running and\n\t * lowered its priority, then reschedule its CPU:\n\t */\n\tp->sched_class->prio_changed(rq, p, old_prio);\n\nout_unlock:\n\ttask_rq_unlock(rq, p, &rf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "security_task_setnice",
          "args": [
            "p",
            "niceval"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "can_nice",
          "args": [
            "p",
            "niceval"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "can_nice",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "6950-6957",
          "snippet": "int can_nice(const struct task_struct *p, const int nice)\n{\n\t/* Convert nice value [19,-20] to rlimit style value [1,40]: */\n\tint nice_rlim = nice_to_rlimit(nice);\n\n\treturn (nice_rlim <= task_rlimit(p, RLIMIT_NICE) ||\n\t\tcapable(CAP_SYS_NICE));\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic __always_inline struct;\n\nint can_nice(const struct task_struct *p, const int nice)\n{\n\t/* Convert nice value [19,-20] to rlimit style value [1,40]: */\n\tint nice_rlim = nice_to_rlimit(nice);\n\n\treturn (nice_rlim <= task_rlimit(p, RLIMIT_NICE) ||\n\t\tcapable(CAP_SYS_NICE));\n}"
        }
      },
      {
        "call_info": {
          "callee": "task_nice",
          "args": [
            "p"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_one_prio_perm",
          "args": [
            "p"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "set_one_prio_perm",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
          "lines": "163-173",
          "snippet": "static bool set_one_prio_perm(struct task_struct *p)\n{\n\tconst struct cred *cred = current_cred(), *pcred = __task_cred(p);\n\n\tif (uid_eq(pcred->uid,  cred->euid) ||\n\t    uid_eq(pcred->euid, cred->euid))\n\t\treturn true;\n\tif (ns_capable(pcred->user_ns, CAP_SYS_NICE))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"uid16.h\"",
            "#include <asm/unistd.h>",
            "#include <asm/io.h>",
            "#include <linux/uaccess.h>",
            "#include <generated/utsrelease.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/nospec.h>",
            "#include <linux/cred.h>",
            "#include <linux/uidgid.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/sched.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/time_namespace.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscall_user_dispatch.h>",
            "#include <linux/ctype.h>",
            "#include <linux/version.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mount.h>",
            "#include <linux/file.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/personality.h>",
            "#include <linux/cpu.h>",
            "#include <linux/seccomp.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/getcpu.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/signal.h>",
            "#include <linux/tty.h>",
            "#include <linux/suspend.h>",
            "#include <linux/security.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/times.h>",
            "#include <linux/key.h>",
            "#include <linux/device.h>",
            "#include <linux/capability.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/kernel.h>",
            "#include <linux/resource.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/kmod.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/prctl.h>",
            "#include <linux/reboot.h>",
            "#include <linux/mman.h>",
            "#include <linux/utsname.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic bool set_one_prio_perm(struct task_struct *p)\n{\n\tconst struct cred *cred = current_cred(), *pcred = __task_cred(p);\n\n\tif (uid_eq(pcred->uid,  cred->euid) ||\n\t    uid_eq(pcred->euid, cred->euid))\n\t\treturn true;\n\tif (ns_capable(pcred->user_ns, CAP_SYS_NICE))\n\t\treturn true;\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic int set_one_prio(struct task_struct *p, int niceval, int error)\n{\n\tint no_nice;\n\n\tif (!set_one_prio_perm(p)) {\n\t\terror = -EPERM;\n\t\tgoto out;\n\t}\n\tif (niceval < task_nice(p) && !can_nice(p, niceval)) {\n\t\terror = -EACCES;\n\t\tgoto out;\n\t}\n\tno_nice = security_task_setnice(p, niceval);\n\tif (no_nice) {\n\t\terror = no_nice;\n\t\tgoto out;\n\t}\n\tif (error == -ESRCH)\n\t\terror = 0;\n\tset_user_nice(p, niceval);\nout:\n\treturn error;\n}"
  },
  {
    "function_name": "set_one_prio_perm",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "163-173",
    "snippet": "static bool set_one_prio_perm(struct task_struct *p)\n{\n\tconst struct cred *cred = current_cred(), *pcred = __task_cred(p);\n\n\tif (uid_eq(pcred->uid,  cred->euid) ||\n\t    uid_eq(pcred->euid, cred->euid))\n\t\treturn true;\n\tif (ns_capable(pcred->user_ns, CAP_SYS_NICE))\n\t\treturn true;\n\treturn false;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ns_capable",
          "args": [
            "pcred->user_ns",
            "CAP_SYS_NICE"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "ns_capable_setid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/capability.c",
          "lines": "431-434",
          "snippet": "bool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/user_namespace.h>\n#include <linux/pid_namespace.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n\nbool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}"
        }
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "pcred->euid",
            "cred->euid"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "pcred->uid",
            "cred->euid"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__task_cred",
          "args": [
            "p"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_cred",
          "args": [],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic bool set_one_prio_perm(struct task_struct *p)\n{\n\tconst struct cred *cred = current_cred(), *pcred = __task_cred(p);\n\n\tif (uid_eq(pcred->uid,  cred->euid) ||\n\t    uid_eq(pcred->euid, cred->euid))\n\t\treturn true;\n\tif (ns_capable(pcred->user_ns, CAP_SYS_NICE))\n\t\treturn true;\n\treturn false;\n}"
  },
  {
    "function_name": "setpriority",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "203-265",
    "snippet": "SYSCALL_DEFINE3(setpriority, int, which, int, who, int, niceval)\n{\n\tstruct task_struct *g, *p;\n\tstruct user_struct *user;\n\tconst struct cred *cred = current_cred();\n\tint error = -EINVAL;\n\tstruct pid *pgrp;\n\tkuid_t uid;\n\n\tif (which > PRIO_USER || which < PRIO_PROCESS)\n\t\tgoto out;\n\n\t/* normalize: avoid signed division (rounding problems) */\n\terror = -ESRCH;\n\tif (niceval < MIN_NICE)\n\t\tniceval = MIN_NICE;\n\tif (niceval > MAX_NICE)\n\t\tniceval = MAX_NICE;\n\n\trcu_read_lock();\n\tswitch (which) {\n\tcase PRIO_PROCESS:\n\t\tif (who)\n\t\t\tp = find_task_by_vpid(who);\n\t\telse\n\t\t\tp = current;\n\t\tif (p)\n\t\t\terror = set_one_prio(p, niceval, error);\n\t\tbreak;\n\tcase PRIO_PGRP:\n\t\tif (who)\n\t\t\tpgrp = find_vpid(who);\n\t\telse\n\t\t\tpgrp = task_pgrp(current);\n\t\tread_lock(&tasklist_lock);\n\t\tdo_each_pid_thread(pgrp, PIDTYPE_PGID, p) {\n\t\t\terror = set_one_prio(p, niceval, error);\n\t\t} while_each_pid_thread(pgrp, PIDTYPE_PGID, p);\n\t\tread_unlock(&tasklist_lock);\n\t\tbreak;\n\tcase PRIO_USER:\n\t\tuid = make_kuid(cred->user_ns, who);\n\t\tuser = cred->user;\n\t\tif (!who)\n\t\t\tuid = cred->uid;\n\t\telse if (!uid_eq(uid, cred->uid)) {\n\t\t\tuser = find_user(uid);\n\t\t\tif (!user)\n\t\t\t\tgoto out_unlock;\t/* No processes for this user */\n\t\t}\n\t\tfor_each_process_thread(g, p) {\n\t\t\tif (uid_eq(task_uid(p), uid) && task_pid_vnr(p))\n\t\t\t\terror = set_one_prio(p, niceval, error);\n\t\t}\n\t\tif (!uid_eq(uid, cred->uid))\n\t\t\tfree_uid(user);\t\t/* For find_user() */\n\t\tbreak;\n\t}\nout_unlock:\n\trcu_read_unlock();\nout:\n\treturn error;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE3(setpriority, int, which, int, who, int, niceval)\n{\n\tstruct task_struct *g, *p;\n\tstruct user_struct *user;\n\tconst struct cred *cred = current_cred();\n\tint error = -EINVAL;\n\tstruct pid *pgrp;\n\tkuid_t uid;\n\n\tif (which > PRIO_USER || which < PRIO_PROCESS)\n\t\tgoto out;\n\n\t/* normalize: avoid signed division (rounding problems) */\n\terror = -ESRCH;\n\tif (niceval < MIN_NICE)\n\t\tniceval = MIN_NICE;\n\tif (niceval > MAX_NICE)\n\t\tniceval = MAX_NICE;\n\n\trcu_read_lock();\n\tswitch (which) {\n\tcase PRIO_PROCESS:\n\t\tif (who)\n\t\t\tp = find_task_by_vpid(who);\n\t\telse\n\t\t\tp = current;\n\t\tif (p)\n\t\t\terror = set_one_prio(p, niceval, error);\n\t\tbreak;\n\tcase PRIO_PGRP:\n\t\tif (who)\n\t\t\tpgrp = find_vpid(who);\n\t\telse\n\t\t\tpgrp = task_pgrp(current);\n\t\tread_lock(&tasklist_lock);\n\t\tdo_each_pid_thread(pgrp, PIDTYPE_PGID, p) {\n\t\t\terror = set_one_prio(p, niceval, error);\n\t\t} while_each_pid_thread(pgrp, PIDTYPE_PGID, p);\n\t\tread_unlock(&tasklist_lock);\n\t\tbreak;\n\tcase PRIO_USER:\n\t\tuid = make_kuid(cred->user_ns, who);\n\t\tuser = cred->user;\n\t\tif (!who)\n\t\t\tuid = cred->uid;\n\t\telse if (!uid_eq(uid, cred->uid)) {\n\t\t\tuser = find_user(uid);\n\t\t\tif (!user)\n\t\t\t\tgoto out_unlock;\t/* No processes for this user */\n\t\t}\n\t\tfor_each_process_thread(g, p) {\n\t\t\tif (uid_eq(task_uid(p), uid) && task_pid_vnr(p))\n\t\t\t\terror = set_one_prio(p, niceval, error);\n\t\t}\n\t\tif (!uid_eq(uid, cred->uid))\n\t\t\tfree_uid(user);\t\t/* For find_user() */\n\t\tbreak;\n\t}\nout_unlock:\n\trcu_read_unlock();\nout:\n\treturn error;\n}"
  },
  {
    "function_name": "getpriority",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "273-336",
    "snippet": "SYSCALL_DEFINE2(getpriority, int, which, int, who)\n{\n\tstruct task_struct *g, *p;\n\tstruct user_struct *user;\n\tconst struct cred *cred = current_cred();\n\tlong niceval, retval = -ESRCH;\n\tstruct pid *pgrp;\n\tkuid_t uid;\n\n\tif (which > PRIO_USER || which < PRIO_PROCESS)\n\t\treturn -EINVAL;\n\n\trcu_read_lock();\n\tswitch (which) {\n\tcase PRIO_PROCESS:\n\t\tif (who)\n\t\t\tp = find_task_by_vpid(who);\n\t\telse\n\t\t\tp = current;\n\t\tif (p) {\n\t\t\tniceval = nice_to_rlimit(task_nice(p));\n\t\t\tif (niceval > retval)\n\t\t\t\tretval = niceval;\n\t\t}\n\t\tbreak;\n\tcase PRIO_PGRP:\n\t\tif (who)\n\t\t\tpgrp = find_vpid(who);\n\t\telse\n\t\t\tpgrp = task_pgrp(current);\n\t\tread_lock(&tasklist_lock);\n\t\tdo_each_pid_thread(pgrp, PIDTYPE_PGID, p) {\n\t\t\tniceval = nice_to_rlimit(task_nice(p));\n\t\t\tif (niceval > retval)\n\t\t\t\tretval = niceval;\n\t\t} while_each_pid_thread(pgrp, PIDTYPE_PGID, p);\n\t\tread_unlock(&tasklist_lock);\n\t\tbreak;\n\tcase PRIO_USER:\n\t\tuid = make_kuid(cred->user_ns, who);\n\t\tuser = cred->user;\n\t\tif (!who)\n\t\t\tuid = cred->uid;\n\t\telse if (!uid_eq(uid, cred->uid)) {\n\t\t\tuser = find_user(uid);\n\t\t\tif (!user)\n\t\t\t\tgoto out_unlock;\t/* No processes for this user */\n\t\t}\n\t\tfor_each_process_thread(g, p) {\n\t\t\tif (uid_eq(task_uid(p), uid) && task_pid_vnr(p)) {\n\t\t\t\tniceval = nice_to_rlimit(task_nice(p));\n\t\t\t\tif (niceval > retval)\n\t\t\t\t\tretval = niceval;\n\t\t\t}\n\t\t}\n\t\tif (!uid_eq(uid, cred->uid))\n\t\t\tfree_uid(user);\t\t/* for find_user() */\n\t\tbreak;\n\t}\nout_unlock:\n\trcu_read_unlock();\n\n\treturn retval;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(getpriority, int, which, int, who)\n{\n\tstruct task_struct *g, *p;\n\tstruct user_struct *user;\n\tconst struct cred *cred = current_cred();\n\tlong niceval, retval = -ESRCH;\n\tstruct pid *pgrp;\n\tkuid_t uid;\n\n\tif (which > PRIO_USER || which < PRIO_PROCESS)\n\t\treturn -EINVAL;\n\n\trcu_read_lock();\n\tswitch (which) {\n\tcase PRIO_PROCESS:\n\t\tif (who)\n\t\t\tp = find_task_by_vpid(who);\n\t\telse\n\t\t\tp = current;\n\t\tif (p) {\n\t\t\tniceval = nice_to_rlimit(task_nice(p));\n\t\t\tif (niceval > retval)\n\t\t\t\tretval = niceval;\n\t\t}\n\t\tbreak;\n\tcase PRIO_PGRP:\n\t\tif (who)\n\t\t\tpgrp = find_vpid(who);\n\t\telse\n\t\t\tpgrp = task_pgrp(current);\n\t\tread_lock(&tasklist_lock);\n\t\tdo_each_pid_thread(pgrp, PIDTYPE_PGID, p) {\n\t\t\tniceval = nice_to_rlimit(task_nice(p));\n\t\t\tif (niceval > retval)\n\t\t\t\tretval = niceval;\n\t\t} while_each_pid_thread(pgrp, PIDTYPE_PGID, p);\n\t\tread_unlock(&tasklist_lock);\n\t\tbreak;\n\tcase PRIO_USER:\n\t\tuid = make_kuid(cred->user_ns, who);\n\t\tuser = cred->user;\n\t\tif (!who)\n\t\t\tuid = cred->uid;\n\t\telse if (!uid_eq(uid, cred->uid)) {\n\t\t\tuser = find_user(uid);\n\t\t\tif (!user)\n\t\t\t\tgoto out_unlock;\t/* No processes for this user */\n\t\t}\n\t\tfor_each_process_thread(g, p) {\n\t\t\tif (uid_eq(task_uid(p), uid) && task_pid_vnr(p)) {\n\t\t\t\tniceval = nice_to_rlimit(task_nice(p));\n\t\t\t\tif (niceval > retval)\n\t\t\t\t\tretval = niceval;\n\t\t\t}\n\t\t}\n\t\tif (!uid_eq(uid, cred->uid))\n\t\t\tfree_uid(user);\t\t/* for find_user() */\n\t\tbreak;\n\t}\nout_unlock:\n\trcu_read_unlock();\n\n\treturn retval;\n}"
  },
  {
    "function_name": "setregid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "413-416",
    "snippet": "SYSCALL_DEFINE2(setregid, gid_t, rgid, gid_t, egid)\n{\n\treturn __sys_setregid(rgid, egid);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(setregid, gid_t, rgid, gid_t, egid)\n{\n\treturn __sys_setregid(rgid, egid);\n}"
  },
  {
    "function_name": "setgid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "459-462",
    "snippet": "SYSCALL_DEFINE1(setgid, gid_t, gid)\n{\n\treturn __sys_setgid(gid);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(setgid, gid_t, gid)\n{\n\treturn __sys_setgid(gid);\n}"
  },
  {
    "function_name": "setreuid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "573-576",
    "snippet": "SYSCALL_DEFINE2(setreuid, uid_t, ruid, uid_t, euid)\n{\n\treturn __sys_setreuid(ruid, euid);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(setreuid, uid_t, ruid, uid_t, euid)\n{\n\treturn __sys_setreuid(ruid, euid);\n}"
  },
  {
    "function_name": "setuid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "635-638",
    "snippet": "SYSCALL_DEFINE1(setuid, uid_t, uid)\n{\n\treturn __sys_setuid(uid);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(setuid, uid_t, uid)\n{\n\treturn __sys_setuid(uid);\n}"
  },
  {
    "function_name": "setresuid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "714-717",
    "snippet": "SYSCALL_DEFINE3(setresuid, uid_t, ruid, uid_t, euid, uid_t, suid)\n{\n\treturn __sys_setresuid(ruid, euid, suid);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE3(setresuid, uid_t, ruid, uid_t, euid, uid_t, suid)\n{\n\treturn __sys_setresuid(ruid, euid, suid);\n}"
  },
  {
    "function_name": "getresuid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "719-736",
    "snippet": "SYSCALL_DEFINE3(getresuid, uid_t __user *, ruidp, uid_t __user *, euidp, uid_t __user *, suidp)\n{\n\tconst struct cred *cred = current_cred();\n\tint retval;\n\tuid_t ruid, euid, suid;\n\n\truid = from_kuid_munged(cred->user_ns, cred->uid);\n\teuid = from_kuid_munged(cred->user_ns, cred->euid);\n\tsuid = from_kuid_munged(cred->user_ns, cred->suid);\n\n\tretval = put_user(ruid, ruidp);\n\tif (!retval) {\n\t\tretval = put_user(euid, euidp);\n\t\tif (!retval)\n\t\t\treturn put_user(suid, suidp);\n\t}\n\treturn retval;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE3(getresuid, uid_t __user *, ruidp, uid_t __user *, euidp, uid_t __user *, suidp)\n{\n\tconst struct cred *cred = current_cred();\n\tint retval;\n\tuid_t ruid, euid, suid;\n\n\truid = from_kuid_munged(cred->user_ns, cred->uid);\n\teuid = from_kuid_munged(cred->user_ns, cred->euid);\n\tsuid = from_kuid_munged(cred->user_ns, cred->suid);\n\n\tretval = put_user(ruid, ruidp);\n\tif (!retval) {\n\t\tretval = put_user(euid, euidp);\n\t\tif (!retval)\n\t\t\treturn put_user(suid, suidp);\n\t}\n\treturn retval;\n}"
  },
  {
    "function_name": "setresgid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "797-800",
    "snippet": "SYSCALL_DEFINE3(setresgid, gid_t, rgid, gid_t, egid, gid_t, sgid)\n{\n\treturn __sys_setresgid(rgid, egid, sgid);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE3(setresgid, gid_t, rgid, gid_t, egid, gid_t, sgid)\n{\n\treturn __sys_setresgid(rgid, egid, sgid);\n}"
  },
  {
    "function_name": "getresgid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "802-820",
    "snippet": "SYSCALL_DEFINE3(getresgid, gid_t __user *, rgidp, gid_t __user *, egidp, gid_t __user *, sgidp)\n{\n\tconst struct cred *cred = current_cred();\n\tint retval;\n\tgid_t rgid, egid, sgid;\n\n\trgid = from_kgid_munged(cred->user_ns, cred->gid);\n\tegid = from_kgid_munged(cred->user_ns, cred->egid);\n\tsgid = from_kgid_munged(cred->user_ns, cred->sgid);\n\n\tretval = put_user(rgid, rgidp);\n\tif (!retval) {\n\t\tretval = put_user(egid, egidp);\n\t\tif (!retval)\n\t\t\tretval = put_user(sgid, sgidp);\n\t}\n\n\treturn retval;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE3(getresgid, gid_t __user *, rgidp, gid_t __user *, egidp, gid_t __user *, sgidp)\n{\n\tconst struct cred *cred = current_cred();\n\tint retval;\n\tgid_t rgid, egid, sgid;\n\n\trgid = from_kgid_munged(cred->user_ns, cred->gid);\n\tegid = from_kgid_munged(cred->user_ns, cred->egid);\n\tsgid = from_kgid_munged(cred->user_ns, cred->sgid);\n\n\tretval = put_user(rgid, rgidp);\n\tif (!retval) {\n\t\tretval = put_user(egid, egidp);\n\t\tif (!retval)\n\t\t\tretval = put_user(sgid, sgidp);\n\t}\n\n\treturn retval;\n}"
  },
  {
    "function_name": "setfsuid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "865-868",
    "snippet": "SYSCALL_DEFINE1(setfsuid, uid_t, uid)\n{\n\treturn __sys_setfsuid(uid);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(setfsuid, uid_t, uid)\n{\n\treturn __sys_setfsuid(uid);\n}"
  },
  {
    "function_name": "setfsgid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "909-912",
    "snippet": "SYSCALL_DEFINE1(setfsgid, gid_t, gid)\n{\n\treturn __sys_setfsgid(gid);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(setfsgid, gid_t, gid)\n{\n\treturn __sys_setfsgid(gid);\n}"
  },
  {
    "function_name": "getpid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "924-927",
    "snippet": "SYSCALL_DEFINE0(getpid)\n{\n\treturn task_tgid_vnr(current);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE0(getpid)\n{\n\treturn task_tgid_vnr(current);\n}"
  },
  {
    "function_name": "gettid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "930-933",
    "snippet": "SYSCALL_DEFINE0(gettid)\n{\n\treturn task_pid_vnr(current);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE0(gettid)\n{\n\treturn task_pid_vnr(current);\n}"
  },
  {
    "function_name": "getppid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "941-950",
    "snippet": "SYSCALL_DEFINE0(getppid)\n{\n\tint pid;\n\n\trcu_read_lock();\n\tpid = task_tgid_vnr(rcu_dereference(current->real_parent));\n\trcu_read_unlock();\n\n\treturn pid;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE0(getppid)\n{\n\tint pid;\n\n\trcu_read_lock();\n\tpid = task_tgid_vnr(rcu_dereference(current->real_parent));\n\trcu_read_unlock();\n\n\treturn pid;\n}"
  },
  {
    "function_name": "getuid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "952-956",
    "snippet": "SYSCALL_DEFINE0(getuid)\n{\n\t/* Only we change this so SMP safe */\n\treturn from_kuid_munged(current_user_ns(), current_uid());\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE0(getuid)\n{\n\t/* Only we change this so SMP safe */\n\treturn from_kuid_munged(current_user_ns(), current_uid());\n}"
  },
  {
    "function_name": "geteuid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "958-962",
    "snippet": "SYSCALL_DEFINE0(geteuid)\n{\n\t/* Only we change this so SMP safe */\n\treturn from_kuid_munged(current_user_ns(), current_euid());\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE0(geteuid)\n{\n\t/* Only we change this so SMP safe */\n\treturn from_kuid_munged(current_user_ns(), current_euid());\n}"
  },
  {
    "function_name": "getgid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "964-968",
    "snippet": "SYSCALL_DEFINE0(getgid)\n{\n\t/* Only we change this so SMP safe */\n\treturn from_kgid_munged(current_user_ns(), current_gid());\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE0(getgid)\n{\n\t/* Only we change this so SMP safe */\n\treturn from_kgid_munged(current_user_ns(), current_gid());\n}"
  },
  {
    "function_name": "getegid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "970-974",
    "snippet": "SYSCALL_DEFINE0(getegid)\n{\n\t/* Only we change this so SMP safe */\n\treturn from_kgid_munged(current_user_ns(), current_egid());\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE0(getegid)\n{\n\t/* Only we change this so SMP safe */\n\treturn from_kgid_munged(current_user_ns(), current_egid());\n}"
  },
  {
    "function_name": "times",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "989-1000",
    "snippet": "SYSCALL_DEFINE1(times, struct tms __user *, tbuf)\n{\n\tif (tbuf) {\n\t\tstruct tms tmp;\n\n\t\tdo_sys_times(&tmp);\n\t\tif (copy_to_user(tbuf, &tmp, sizeof(struct tms)))\n\t\t\treturn -EFAULT;\n\t}\n\tforce_successful_syscall_return();\n\treturn (long) jiffies_64_to_clock_t(get_jiffies_64());\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(times, struct tms __user *, tbuf)\n{\n\tif (tbuf) {\n\t\tstruct tms tmp;\n\n\t\tdo_sys_times(&tmp);\n\t\tif (copy_to_user(tbuf, &tmp, sizeof(struct tms)))\n\t\t\treturn -EFAULT;\n\t}\n\tforce_successful_syscall_return();\n\treturn (long) jiffies_64_to_clock_t(get_jiffies_64());\n}"
  },
  {
    "function_name": "times",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1008-1025",
    "snippet": "SYSCALL_DEFINE1(times, struct compat_tms __user *, tbuf)\n{\n\tif (tbuf) {\n\t\tstruct tms tms;\n\t\tstruct compat_tms tmp;\n\n\t\tdo_sys_times(&tms);\n\t\t/* Convert our struct tms to the compat version. */\n\t\ttmp.tms_utime = clock_t_to_compat_clock_t(tms.tms_utime);\n\t\ttmp.tms_stime = clock_t_to_compat_clock_t(tms.tms_stime);\n\t\ttmp.tms_cutime = clock_t_to_compat_clock_t(tms.tms_cutime);\n\t\ttmp.tms_cstime = clock_t_to_compat_clock_t(tms.tms_cstime);\n\t\tif (copy_to_user(tbuf, &tmp, sizeof(tmp)))\n\t\t\treturn -EFAULT;\n\t}\n\tforce_successful_syscall_return();\n\treturn compat_jiffies_to_clock_t(jiffies);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(times, struct compat_tms __user *, tbuf)\n{\n\tif (tbuf) {\n\t\tstruct tms tms;\n\t\tstruct compat_tms tmp;\n\n\t\tdo_sys_times(&tms);\n\t\t/* Convert our struct tms to the compat version. */\n\t\ttmp.tms_utime = clock_t_to_compat_clock_t(tms.tms_utime);\n\t\ttmp.tms_stime = clock_t_to_compat_clock_t(tms.tms_stime);\n\t\ttmp.tms_cutime = clock_t_to_compat_clock_t(tms.tms_cutime);\n\t\ttmp.tms_cstime = clock_t_to_compat_clock_t(tms.tms_cstime);\n\t\tif (copy_to_user(tbuf, &tmp, sizeof(tmp)))\n\t\t\treturn -EFAULT;\n\t}\n\tforce_successful_syscall_return();\n\treturn compat_jiffies_to_clock_t(jiffies);\n}"
  },
  {
    "function_name": "setpgid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1039-1108",
    "snippet": "SYSCALL_DEFINE2(setpgid, pid_t, pid, pid_t, pgid)\n{\n\tstruct task_struct *p;\n\tstruct task_struct *group_leader = current->group_leader;\n\tstruct pid *pgrp;\n\tint err;\n\n\tif (!pid)\n\t\tpid = task_pid_vnr(group_leader);\n\tif (!pgid)\n\t\tpgid = pid;\n\tif (pgid < 0)\n\t\treturn -EINVAL;\n\trcu_read_lock();\n\n\t/* From this point forward we keep holding onto the tasklist lock\n\t * so that our parent does not change from under us. -DaveM\n\t */\n\twrite_lock_irq(&tasklist_lock);\n\n\terr = -ESRCH;\n\tp = find_task_by_vpid(pid);\n\tif (!p)\n\t\tgoto out;\n\n\terr = -EINVAL;\n\tif (!thread_group_leader(p))\n\t\tgoto out;\n\n\tif (same_thread_group(p->real_parent, group_leader)) {\n\t\terr = -EPERM;\n\t\tif (task_session(p) != task_session(group_leader))\n\t\t\tgoto out;\n\t\terr = -EACCES;\n\t\tif (!(p->flags & PF_FORKNOEXEC))\n\t\t\tgoto out;\n\t} else {\n\t\terr = -ESRCH;\n\t\tif (p != group_leader)\n\t\t\tgoto out;\n\t}\n\n\terr = -EPERM;\n\tif (p->signal->leader)\n\t\tgoto out;\n\n\tpgrp = task_pid(p);\n\tif (pgid != pid) {\n\t\tstruct task_struct *g;\n\n\t\tpgrp = find_vpid(pgid);\n\t\tg = pid_task(pgrp, PIDTYPE_PGID);\n\t\tif (!g || task_session(g) != task_session(group_leader))\n\t\t\tgoto out;\n\t}\n\n\terr = security_task_setpgid(p, pgid);\n\tif (err)\n\t\tgoto out;\n\n\tif (task_pgrp(p) != pgrp)\n\t\tchange_pid(p, PIDTYPE_PGID, pgrp);\n\n\terr = 0;\nout:\n\t/* All paths lead to here, thus we are safe. -DaveM */\n\twrite_unlock_irq(&tasklist_lock);\n\trcu_read_unlock();\n\treturn err;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(setpgid, pid_t, pid, pid_t, pgid)\n{\n\tstruct task_struct *p;\n\tstruct task_struct *group_leader = current->group_leader;\n\tstruct pid *pgrp;\n\tint err;\n\n\tif (!pid)\n\t\tpid = task_pid_vnr(group_leader);\n\tif (!pgid)\n\t\tpgid = pid;\n\tif (pgid < 0)\n\t\treturn -EINVAL;\n\trcu_read_lock();\n\n\t/* From this point forward we keep holding onto the tasklist lock\n\t * so that our parent does not change from under us. -DaveM\n\t */\n\twrite_lock_irq(&tasklist_lock);\n\n\terr = -ESRCH;\n\tp = find_task_by_vpid(pid);\n\tif (!p)\n\t\tgoto out;\n\n\terr = -EINVAL;\n\tif (!thread_group_leader(p))\n\t\tgoto out;\n\n\tif (same_thread_group(p->real_parent, group_leader)) {\n\t\terr = -EPERM;\n\t\tif (task_session(p) != task_session(group_leader))\n\t\t\tgoto out;\n\t\terr = -EACCES;\n\t\tif (!(p->flags & PF_FORKNOEXEC))\n\t\t\tgoto out;\n\t} else {\n\t\terr = -ESRCH;\n\t\tif (p != group_leader)\n\t\t\tgoto out;\n\t}\n\n\terr = -EPERM;\n\tif (p->signal->leader)\n\t\tgoto out;\n\n\tpgrp = task_pid(p);\n\tif (pgid != pid) {\n\t\tstruct task_struct *g;\n\n\t\tpgrp = find_vpid(pgid);\n\t\tg = pid_task(pgrp, PIDTYPE_PGID);\n\t\tif (!g || task_session(g) != task_session(group_leader))\n\t\t\tgoto out;\n\t}\n\n\terr = security_task_setpgid(p, pgid);\n\tif (err)\n\t\tgoto out;\n\n\tif (task_pgrp(p) != pgrp)\n\t\tchange_pid(p, PIDTYPE_PGID, pgrp);\n\n\terr = 0;\nout:\n\t/* All paths lead to here, thus we are safe. -DaveM */\n\twrite_unlock_irq(&tasklist_lock);\n\trcu_read_unlock();\n\treturn err;\n}"
  },
  {
    "function_name": "getpgid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1138-1141",
    "snippet": "SYSCALL_DEFINE1(getpgid, pid_t, pid)\n{\n\treturn do_getpgid(pid);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(getpgid, pid_t, pid)\n{\n\treturn do_getpgid(pid);\n}"
  },
  {
    "function_name": "getpgrp",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1145-1148",
    "snippet": "SYSCALL_DEFINE0(getpgrp)\n{\n\treturn do_getpgid(0);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE0(getpgrp)\n{\n\treturn do_getpgid(0);\n}"
  },
  {
    "function_name": "getsid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1152-1178",
    "snippet": "SYSCALL_DEFINE1(getsid, pid_t, pid)\n{\n\tstruct task_struct *p;\n\tstruct pid *sid;\n\tint retval;\n\n\trcu_read_lock();\n\tif (!pid)\n\t\tsid = task_session(current);\n\telse {\n\t\tretval = -ESRCH;\n\t\tp = find_task_by_vpid(pid);\n\t\tif (!p)\n\t\t\tgoto out;\n\t\tsid = task_session(p);\n\t\tif (!sid)\n\t\t\tgoto out;\n\n\t\tretval = security_task_getsid(p);\n\t\tif (retval)\n\t\t\tgoto out;\n\t}\n\tretval = pid_vnr(sid);\nout:\n\trcu_read_unlock();\n\treturn retval;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(getsid, pid_t, pid)\n{\n\tstruct task_struct *p;\n\tstruct pid *sid;\n\tint retval;\n\n\trcu_read_lock();\n\tif (!pid)\n\t\tsid = task_session(current);\n\telse {\n\t\tretval = -ESRCH;\n\t\tp = find_task_by_vpid(pid);\n\t\tif (!p)\n\t\t\tgoto out;\n\t\tsid = task_session(p);\n\t\tif (!sid)\n\t\t\tgoto out;\n\n\t\tretval = security_task_getsid(p);\n\t\tif (retval)\n\t\t\tgoto out;\n\t}\n\tretval = pid_vnr(sid);\nout:\n\trcu_read_unlock();\n\treturn retval;\n}"
  },
  {
    "function_name": "setsid",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1224-1227",
    "snippet": "SYSCALL_DEFINE0(setsid)\n{\n\treturn ksys_setsid();\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE0(setsid)\n{\n\treturn ksys_setsid();\n}"
  },
  {
    "function_name": "newuname",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1272-1287",
    "snippet": "SYSCALL_DEFINE1(newuname, struct new_utsname __user *, name)\n{\n\tstruct new_utsname tmp;\n\n\tdown_read(&uts_sem);\n\tmemcpy(&tmp, utsname(), sizeof(tmp));\n\tup_read(&uts_sem);\n\tif (copy_to_user(name, &tmp, sizeof(tmp)))\n\t\treturn -EFAULT;\n\n\tif (override_release(name->release, sizeof(name->release)))\n\t\treturn -EFAULT;\n\tif (override_architecture(name))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(newuname, struct new_utsname __user *, name)\n{\n\tstruct new_utsname tmp;\n\n\tdown_read(&uts_sem);\n\tmemcpy(&tmp, utsname(), sizeof(tmp));\n\tup_read(&uts_sem);\n\tif (copy_to_user(name, &tmp, sizeof(tmp)))\n\t\treturn -EFAULT;\n\n\tif (override_release(name->release, sizeof(name->release)))\n\t\treturn -EFAULT;\n\tif (override_architecture(name))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "uname",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1293-1311",
    "snippet": "SYSCALL_DEFINE1(uname, struct old_utsname __user *, name)\n{\n\tstruct old_utsname tmp;\n\n\tif (!name)\n\t\treturn -EFAULT;\n\n\tdown_read(&uts_sem);\n\tmemcpy(&tmp, utsname(), sizeof(tmp));\n\tup_read(&uts_sem);\n\tif (copy_to_user(name, &tmp, sizeof(tmp)))\n\t\treturn -EFAULT;\n\n\tif (override_release(name->release, sizeof(name->release)))\n\t\treturn -EFAULT;\n\tif (override_architecture(name))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(uname, struct old_utsname __user *, name)\n{\n\tstruct old_utsname tmp;\n\n\tif (!name)\n\t\treturn -EFAULT;\n\n\tdown_read(&uts_sem);\n\tmemcpy(&tmp, utsname(), sizeof(tmp));\n\tup_read(&uts_sem);\n\tif (copy_to_user(name, &tmp, sizeof(tmp)))\n\t\treturn -EFAULT;\n\n\tif (override_release(name->release, sizeof(name->release)))\n\t\treturn -EFAULT;\n\tif (override_architecture(name))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "olduname",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1313-1337",
    "snippet": "SYSCALL_DEFINE1(olduname, struct oldold_utsname __user *, name)\n{\n\tstruct oldold_utsname tmp;\n\n\tif (!name)\n\t\treturn -EFAULT;\n\n\tmemset(&tmp, 0, sizeof(tmp));\n\n\tdown_read(&uts_sem);\n\tmemcpy(&tmp.sysname, &utsname()->sysname, __OLD_UTS_LEN);\n\tmemcpy(&tmp.nodename, &utsname()->nodename, __OLD_UTS_LEN);\n\tmemcpy(&tmp.release, &utsname()->release, __OLD_UTS_LEN);\n\tmemcpy(&tmp.version, &utsname()->version, __OLD_UTS_LEN);\n\tmemcpy(&tmp.machine, &utsname()->machine, __OLD_UTS_LEN);\n\tup_read(&uts_sem);\n\tif (copy_to_user(name, &tmp, sizeof(tmp)))\n\t\treturn -EFAULT;\n\n\tif (override_architecture(name))\n\t\treturn -EFAULT;\n\tif (override_release(name->release, sizeof(name->release)))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(olduname, struct oldold_utsname __user *, name)\n{\n\tstruct oldold_utsname tmp;\n\n\tif (!name)\n\t\treturn -EFAULT;\n\n\tmemset(&tmp, 0, sizeof(tmp));\n\n\tdown_read(&uts_sem);\n\tmemcpy(&tmp.sysname, &utsname()->sysname, __OLD_UTS_LEN);\n\tmemcpy(&tmp.nodename, &utsname()->nodename, __OLD_UTS_LEN);\n\tmemcpy(&tmp.release, &utsname()->release, __OLD_UTS_LEN);\n\tmemcpy(&tmp.version, &utsname()->version, __OLD_UTS_LEN);\n\tmemcpy(&tmp.machine, &utsname()->machine, __OLD_UTS_LEN);\n\tup_read(&uts_sem);\n\tif (copy_to_user(name, &tmp, sizeof(tmp)))\n\t\treturn -EFAULT;\n\n\tif (override_architecture(name))\n\t\treturn -EFAULT;\n\tif (override_release(name->release, sizeof(name->release)))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "sethostname",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1340-1363",
    "snippet": "SYSCALL_DEFINE2(sethostname, char __user *, name, int, len)\n{\n\tint errno;\n\tchar tmp[__NEW_UTS_LEN];\n\n\tif (!ns_capable(current->nsproxy->uts_ns->user_ns, CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tif (len < 0 || len > __NEW_UTS_LEN)\n\t\treturn -EINVAL;\n\terrno = -EFAULT;\n\tif (!copy_from_user(tmp, name, len)) {\n\t\tstruct new_utsname *u;\n\n\t\tdown_write(&uts_sem);\n\t\tu = utsname();\n\t\tmemcpy(u->nodename, tmp, len);\n\t\tmemset(u->nodename + len, 0, sizeof(u->nodename) - len);\n\t\terrno = 0;\n\t\tuts_proc_notify(UTS_PROC_HOSTNAME);\n\t\tup_write(&uts_sem);\n\t}\n\treturn errno;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(sethostname, char __user *, name, int, len)\n{\n\tint errno;\n\tchar tmp[__NEW_UTS_LEN];\n\n\tif (!ns_capable(current->nsproxy->uts_ns->user_ns, CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tif (len < 0 || len > __NEW_UTS_LEN)\n\t\treturn -EINVAL;\n\terrno = -EFAULT;\n\tif (!copy_from_user(tmp, name, len)) {\n\t\tstruct new_utsname *u;\n\n\t\tdown_write(&uts_sem);\n\t\tu = utsname();\n\t\tmemcpy(u->nodename, tmp, len);\n\t\tmemset(u->nodename + len, 0, sizeof(u->nodename) - len);\n\t\terrno = 0;\n\t\tuts_proc_notify(UTS_PROC_HOSTNAME);\n\t\tup_write(&uts_sem);\n\t}\n\treturn errno;\n}"
  },
  {
    "function_name": "gethostname",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1367-1385",
    "snippet": "SYSCALL_DEFINE2(gethostname, char __user *, name, int, len)\n{\n\tint i;\n\tstruct new_utsname *u;\n\tchar tmp[__NEW_UTS_LEN + 1];\n\n\tif (len < 0)\n\t\treturn -EINVAL;\n\tdown_read(&uts_sem);\n\tu = utsname();\n\ti = 1 + strlen(u->nodename);\n\tif (i > len)\n\t\ti = len;\n\tmemcpy(tmp, u->nodename, i);\n\tup_read(&uts_sem);\n\tif (copy_to_user(name, tmp, i))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(gethostname, char __user *, name, int, len)\n{\n\tint i;\n\tstruct new_utsname *u;\n\tchar tmp[__NEW_UTS_LEN + 1];\n\n\tif (len < 0)\n\t\treturn -EINVAL;\n\tdown_read(&uts_sem);\n\tu = utsname();\n\ti = 1 + strlen(u->nodename);\n\tif (i > len)\n\t\ti = len;\n\tmemcpy(tmp, u->nodename, i);\n\tup_read(&uts_sem);\n\tif (copy_to_user(name, tmp, i))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "setdomainname",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1393-1416",
    "snippet": "SYSCALL_DEFINE2(setdomainname, char __user *, name, int, len)\n{\n\tint errno;\n\tchar tmp[__NEW_UTS_LEN];\n\n\tif (!ns_capable(current->nsproxy->uts_ns->user_ns, CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\tif (len < 0 || len > __NEW_UTS_LEN)\n\t\treturn -EINVAL;\n\n\terrno = -EFAULT;\n\tif (!copy_from_user(tmp, name, len)) {\n\t\tstruct new_utsname *u;\n\n\t\tdown_write(&uts_sem);\n\t\tu = utsname();\n\t\tmemcpy(u->domainname, tmp, len);\n\t\tmemset(u->domainname + len, 0, sizeof(u->domainname) - len);\n\t\terrno = 0;\n\t\tuts_proc_notify(UTS_PROC_DOMAINNAME);\n\t\tup_write(&uts_sem);\n\t}\n\treturn errno;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(setdomainname, char __user *, name, int, len)\n{\n\tint errno;\n\tchar tmp[__NEW_UTS_LEN];\n\n\tif (!ns_capable(current->nsproxy->uts_ns->user_ns, CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\tif (len < 0 || len > __NEW_UTS_LEN)\n\t\treturn -EINVAL;\n\n\terrno = -EFAULT;\n\tif (!copy_from_user(tmp, name, len)) {\n\t\tstruct new_utsname *u;\n\n\t\tdown_write(&uts_sem);\n\t\tu = utsname();\n\t\tmemcpy(u->domainname, tmp, len);\n\t\tmemset(u->domainname + len, 0, sizeof(u->domainname) - len);\n\t\terrno = 0;\n\t\tuts_proc_notify(UTS_PROC_DOMAINNAME);\n\t\tup_write(&uts_sem);\n\t}\n\treturn errno;\n}"
  },
  {
    "function_name": "getrlimit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1418-1428",
    "snippet": "SYSCALL_DEFINE2(getrlimit, unsigned int, resource, struct rlimit __user *, rlim)\n{\n\tstruct rlimit value;\n\tint ret;\n\n\tret = do_prlimit(current, resource, NULL, &value);\n\tif (!ret)\n\t\tret = copy_to_user(rlim, &value, sizeof(*rlim)) ? -EFAULT : 0;\n\n\treturn ret;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(getrlimit, unsigned int, resource, struct rlimit __user *, rlim)\n{\n\tstruct rlimit value;\n\tint ret;\n\n\tret = do_prlimit(current, resource, NULL, &value);\n\tif (!ret)\n\t\tret = copy_to_user(rlim, &value, sizeof(*rlim)) ? -EFAULT : 0;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "setrlimit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1432-1450",
    "snippet": "SYSCALL_DEFINE2(setrlimit, unsigned int, resource,\n\t\t       struct compat_rlimit __user *, rlim)\n{\n\tstruct rlimit r;\n\tstruct compat_rlimit r32;\n\n\tif (copy_from_user(&r32, rlim, sizeof(struct compat_rlimit)))\n\t\treturn -EFAULT;\n\n\tif (r32.rlim_cur == COMPAT_RLIM_INFINITY)\n\t\tr.rlim_cur = RLIM_INFINITY;\n\telse\n\t\tr.rlim_cur = r32.rlim_cur;\n\tif (r32.rlim_max == COMPAT_RLIM_INFINITY)\n\t\tr.rlim_max = RLIM_INFINITY;\n\telse\n\t\tr.rlim_max = r32.rlim_max;\n\treturn do_prlimit(current, resource, &r, NULL);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(setrlimit, unsigned int, resource,\n\t\t       struct compat_rlimit __user *, rlim)\n{\n\tstruct rlimit r;\n\tstruct compat_rlimit r32;\n\n\tif (copy_from_user(&r32, rlim, sizeof(struct compat_rlimit)))\n\t\treturn -EFAULT;\n\n\tif (r32.rlim_cur == COMPAT_RLIM_INFINITY)\n\t\tr.rlim_cur = RLIM_INFINITY;\n\telse\n\t\tr.rlim_cur = r32.rlim_cur;\n\tif (r32.rlim_max == COMPAT_RLIM_INFINITY)\n\t\tr.rlim_max = RLIM_INFINITY;\n\telse\n\t\tr.rlim_max = r32.rlim_max;\n\treturn do_prlimit(current, resource, &r, NULL);\n}"
  },
  {
    "function_name": "getrlimit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1452-1474",
    "snippet": "SYSCALL_DEFINE2(getrlimit, unsigned int, resource,\n\t\t       struct compat_rlimit __user *, rlim)\n{\n\tstruct rlimit r;\n\tint ret;\n\n\tret = do_prlimit(current, resource, NULL, &r);\n\tif (!ret) {\n\t\tstruct compat_rlimit r32;\n\t\tif (r.rlim_cur > COMPAT_RLIM_INFINITY)\n\t\t\tr32.rlim_cur = COMPAT_RLIM_INFINITY;\n\t\telse\n\t\t\tr32.rlim_cur = r.rlim_cur;\n\t\tif (r.rlim_max > COMPAT_RLIM_INFINITY)\n\t\t\tr32.rlim_max = COMPAT_RLIM_INFINITY;\n\t\telse\n\t\t\tr32.rlim_max = r.rlim_max;\n\n\t\tif (copy_to_user(rlim, &r32, sizeof(struct compat_rlimit)))\n\t\t\treturn -EFAULT;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(getrlimit, unsigned int, resource,\n\t\t       struct compat_rlimit __user *, rlim)\n{\n\tstruct rlimit r;\n\tint ret;\n\n\tret = do_prlimit(current, resource, NULL, &r);\n\tif (!ret) {\n\t\tstruct compat_rlimit r32;\n\t\tif (r.rlim_cur > COMPAT_RLIM_INFINITY)\n\t\t\tr32.rlim_cur = COMPAT_RLIM_INFINITY;\n\t\telse\n\t\t\tr32.rlim_cur = r.rlim_cur;\n\t\tif (r.rlim_max > COMPAT_RLIM_INFINITY)\n\t\t\tr32.rlim_max = COMPAT_RLIM_INFINITY;\n\t\telse\n\t\t\tr32.rlim_max = r.rlim_max;\n\n\t\tif (copy_to_user(rlim, &r32, sizeof(struct compat_rlimit)))\n\t\t\treturn -EFAULT;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "old_getrlimit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1483-1499",
    "snippet": "SYSCALL_DEFINE2(old_getrlimit, unsigned int, resource,\n\t\tstruct rlimit __user *, rlim)\n{\n\tstruct rlimit x;\n\tif (resource >= RLIM_NLIMITS)\n\t\treturn -EINVAL;\n\n\tresource = array_index_nospec(resource, RLIM_NLIMITS);\n\ttask_lock(current->group_leader);\n\tx = current->signal->rlim[resource];\n\ttask_unlock(current->group_leader);\n\tif (x.rlim_cur > 0x7FFFFFFF)\n\t\tx.rlim_cur = 0x7FFFFFFF;\n\tif (x.rlim_max > 0x7FFFFFFF)\n\t\tx.rlim_max = 0x7FFFFFFF;\n\treturn copy_to_user(rlim, &x, sizeof(x)) ? -EFAULT : 0;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(old_getrlimit, unsigned int, resource,\n\t\tstruct rlimit __user *, rlim)\n{\n\tstruct rlimit x;\n\tif (resource >= RLIM_NLIMITS)\n\t\treturn -EINVAL;\n\n\tresource = array_index_nospec(resource, RLIM_NLIMITS);\n\ttask_lock(current->group_leader);\n\tx = current->signal->rlim[resource];\n\ttask_unlock(current->group_leader);\n\tif (x.rlim_cur > 0x7FFFFFFF)\n\t\tx.rlim_cur = 0x7FFFFFFF;\n\tif (x.rlim_max > 0x7FFFFFFF)\n\t\tx.rlim_max = 0x7FFFFFFF;\n\treturn copy_to_user(rlim, &x, sizeof(x)) ? -EFAULT : 0;\n}"
  },
  {
    "function_name": "old_getrlimit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1502-1523",
    "snippet": "SYSCALL_DEFINE2(old_getrlimit, unsigned int, resource,\n\t\t       struct compat_rlimit __user *, rlim)\n{\n\tstruct rlimit r;\n\n\tif (resource >= RLIM_NLIMITS)\n\t\treturn -EINVAL;\n\n\tresource = array_index_nospec(resource, RLIM_NLIMITS);\n\ttask_lock(current->group_leader);\n\tr = current->signal->rlim[resource];\n\ttask_unlock(current->group_leader);\n\tif (r.rlim_cur > 0x7FFFFFFF)\n\t\tr.rlim_cur = 0x7FFFFFFF;\n\tif (r.rlim_max > 0x7FFFFFFF)\n\t\tr.rlim_max = 0x7FFFFFFF;\n\n\tif (put_user(r.rlim_cur, &rlim->rlim_cur) ||\n\t    put_user(r.rlim_max, &rlim->rlim_max))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(old_getrlimit, unsigned int, resource,\n\t\t       struct compat_rlimit __user *, rlim)\n{\n\tstruct rlimit r;\n\n\tif (resource >= RLIM_NLIMITS)\n\t\treturn -EINVAL;\n\n\tresource = array_index_nospec(resource, RLIM_NLIMITS);\n\ttask_lock(current->group_leader);\n\tr = current->signal->rlim[resource];\n\ttask_unlock(current->group_leader);\n\tif (r.rlim_cur > 0x7FFFFFFF)\n\t\tr.rlim_cur = 0x7FFFFFFF;\n\tif (r.rlim_max > 0x7FFFFFFF)\n\t\tr.rlim_max = 0x7FFFFFFF;\n\n\tif (put_user(r.rlim_cur, &rlim->rlim_cur) ||\n\t    put_user(r.rlim_max, &rlim->rlim_max))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "prlimit64",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1641-1686",
    "snippet": "SYSCALL_DEFINE4(prlimit64, pid_t, pid, unsigned int, resource,\n\t\tconst struct rlimit64 __user *, new_rlim,\n\t\tstruct rlimit64 __user *, old_rlim)\n{\n\tstruct rlimit64 old64, new64;\n\tstruct rlimit old, new;\n\tstruct task_struct *tsk;\n\tunsigned int checkflags = 0;\n\tint ret;\n\n\tif (old_rlim)\n\t\tcheckflags |= LSM_PRLIMIT_READ;\n\n\tif (new_rlim) {\n\t\tif (copy_from_user(&new64, new_rlim, sizeof(new64)))\n\t\t\treturn -EFAULT;\n\t\trlim64_to_rlim(&new64, &new);\n\t\tcheckflags |= LSM_PRLIMIT_WRITE;\n\t}\n\n\trcu_read_lock();\n\ttsk = pid ? find_task_by_vpid(pid) : current;\n\tif (!tsk) {\n\t\trcu_read_unlock();\n\t\treturn -ESRCH;\n\t}\n\tret = check_prlimit_permission(tsk, checkflags);\n\tif (ret) {\n\t\trcu_read_unlock();\n\t\treturn ret;\n\t}\n\tget_task_struct(tsk);\n\trcu_read_unlock();\n\n\tret = do_prlimit(tsk, resource, new_rlim ? &new : NULL,\n\t\t\told_rlim ? &old : NULL);\n\n\tif (!ret && old_rlim) {\n\t\trlim_to_rlim64(&old, &old64);\n\t\tif (copy_to_user(old_rlim, &old64, sizeof(old64)))\n\t\t\tret = -EFAULT;\n\t}\n\n\tput_task_struct(tsk);\n\treturn ret;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE4(prlimit64, pid_t, pid, unsigned int, resource,\n\t\tconst struct rlimit64 __user *, new_rlim,\n\t\tstruct rlimit64 __user *, old_rlim)\n{\n\tstruct rlimit64 old64, new64;\n\tstruct rlimit old, new;\n\tstruct task_struct *tsk;\n\tunsigned int checkflags = 0;\n\tint ret;\n\n\tif (old_rlim)\n\t\tcheckflags |= LSM_PRLIMIT_READ;\n\n\tif (new_rlim) {\n\t\tif (copy_from_user(&new64, new_rlim, sizeof(new64)))\n\t\t\treturn -EFAULT;\n\t\trlim64_to_rlim(&new64, &new);\n\t\tcheckflags |= LSM_PRLIMIT_WRITE;\n\t}\n\n\trcu_read_lock();\n\ttsk = pid ? find_task_by_vpid(pid) : current;\n\tif (!tsk) {\n\t\trcu_read_unlock();\n\t\treturn -ESRCH;\n\t}\n\tret = check_prlimit_permission(tsk, checkflags);\n\tif (ret) {\n\t\trcu_read_unlock();\n\t\treturn ret;\n\t}\n\tget_task_struct(tsk);\n\trcu_read_unlock();\n\n\tret = do_prlimit(tsk, resource, new_rlim ? &new : NULL,\n\t\t\told_rlim ? &old : NULL);\n\n\tif (!ret && old_rlim) {\n\t\trlim_to_rlim64(&old, &old64);\n\t\tif (copy_to_user(old_rlim, &old64, sizeof(old64)))\n\t\t\tret = -EFAULT;\n\t}\n\n\tput_task_struct(tsk);\n\treturn ret;\n}"
  },
  {
    "function_name": "setrlimit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1688-1695",
    "snippet": "SYSCALL_DEFINE2(setrlimit, unsigned int, resource, struct rlimit __user *, rlim)\n{\n\tstruct rlimit new_rlim;\n\n\tif (copy_from_user(&new_rlim, rlim, sizeof(*rlim)))\n\t\treturn -EFAULT;\n\treturn do_prlimit(current, resource, &new_rlim, NULL);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(setrlimit, unsigned int, resource, struct rlimit __user *, rlim)\n{\n\tstruct rlimit new_rlim;\n\n\tif (copy_from_user(&new_rlim, rlim, sizeof(*rlim)))\n\t\treturn -EFAULT;\n\treturn do_prlimit(current, resource, &new_rlim, NULL);\n}"
  },
  {
    "function_name": "getrusage",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1815-1825",
    "snippet": "SYSCALL_DEFINE2(getrusage, int, who, struct rusage __user *, ru)\n{\n\tstruct rusage r;\n\n\tif (who != RUSAGE_SELF && who != RUSAGE_CHILDREN &&\n\t    who != RUSAGE_THREAD)\n\t\treturn -EINVAL;\n\n\tgetrusage(current, who, &r);\n\treturn copy_to_user(ru, &r, sizeof(r)) ? -EFAULT : 0;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(getrusage, int, who, struct rusage __user *, ru)\n{\n\tstruct rusage r;\n\n\tif (who != RUSAGE_SELF && who != RUSAGE_CHILDREN &&\n\t    who != RUSAGE_THREAD)\n\t\treturn -EINVAL;\n\n\tgetrusage(current, who, &r);\n\treturn copy_to_user(ru, &r, sizeof(r)) ? -EFAULT : 0;\n}"
  },
  {
    "function_name": "getrusage",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1828-1838",
    "snippet": "SYSCALL_DEFINE2(getrusage, int, who, struct compat_rusage __user *, ru)\n{\n\tstruct rusage r;\n\n\tif (who != RUSAGE_SELF && who != RUSAGE_CHILDREN &&\n\t    who != RUSAGE_THREAD)\n\t\treturn -EINVAL;\n\n\tgetrusage(current, who, &r);\n\treturn put_compat_rusage(&r, ru);\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(getrusage, int, who, struct compat_rusage __user *, ru)\n{\n\tstruct rusage r;\n\n\tif (who != RUSAGE_SELF && who != RUSAGE_CHILDREN &&\n\t    who != RUSAGE_THREAD)\n\t\treturn -EINVAL;\n\n\tgetrusage(current, who, &r);\n\treturn put_compat_rusage(&r, ru);\n}"
  },
  {
    "function_name": "umask",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "1841-1845",
    "snippet": "SYSCALL_DEFINE1(umask, int, mask)\n{\n\tmask = xchg(&current->fs->umask, mask & S_IRWXUGO);\n\treturn mask;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(umask, int, mask)\n{\n\tmask = xchg(&current->fs->umask, mask & S_IRWXUGO);\n\treturn mask;\n}"
  },
  {
    "function_name": "prctl",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "2324-2601",
    "snippet": "SYSCALL_DEFINE5(prctl, int, option, unsigned long, arg2, unsigned long, arg3,\n\t\tunsigned long, arg4, unsigned long, arg5)\n{\n\tstruct task_struct *me = current;\n\tunsigned char comm[sizeof(me->comm)];\n\tlong error;\n\n\terror = security_task_prctl(option, arg2, arg3, arg4, arg5);\n\tif (error != -ENOSYS)\n\t\treturn error;\n\n\terror = 0;\n\tswitch (option) {\n\tcase PR_SET_PDEATHSIG:\n\t\tif (!valid_signal(arg2)) {\n\t\t\terror = -EINVAL;\n\t\t\tbreak;\n\t\t}\n\t\tme->pdeath_signal = arg2;\n\t\tbreak;\n\tcase PR_GET_PDEATHSIG:\n\t\terror = put_user(me->pdeath_signal, (int __user *)arg2);\n\t\tbreak;\n\tcase PR_GET_DUMPABLE:\n\t\terror = get_dumpable(me->mm);\n\t\tbreak;\n\tcase PR_SET_DUMPABLE:\n\t\tif (arg2 != SUID_DUMP_DISABLE && arg2 != SUID_DUMP_USER) {\n\t\t\terror = -EINVAL;\n\t\t\tbreak;\n\t\t}\n\t\tset_dumpable(me->mm, arg2);\n\t\tbreak;\n\n\tcase PR_SET_UNALIGN:\n\t\terror = SET_UNALIGN_CTL(me, arg2);\n\t\tbreak;\n\tcase PR_GET_UNALIGN:\n\t\terror = GET_UNALIGN_CTL(me, arg2);\n\t\tbreak;\n\tcase PR_SET_FPEMU:\n\t\terror = SET_FPEMU_CTL(me, arg2);\n\t\tbreak;\n\tcase PR_GET_FPEMU:\n\t\terror = GET_FPEMU_CTL(me, arg2);\n\t\tbreak;\n\tcase PR_SET_FPEXC:\n\t\terror = SET_FPEXC_CTL(me, arg2);\n\t\tbreak;\n\tcase PR_GET_FPEXC:\n\t\terror = GET_FPEXC_CTL(me, arg2);\n\t\tbreak;\n\tcase PR_GET_TIMING:\n\t\terror = PR_TIMING_STATISTICAL;\n\t\tbreak;\n\tcase PR_SET_TIMING:\n\t\tif (arg2 != PR_TIMING_STATISTICAL)\n\t\t\terror = -EINVAL;\n\t\tbreak;\n\tcase PR_SET_NAME:\n\t\tcomm[sizeof(me->comm) - 1] = 0;\n\t\tif (strncpy_from_user(comm, (char __user *)arg2,\n\t\t\t\t      sizeof(me->comm) - 1) < 0)\n\t\t\treturn -EFAULT;\n\t\tset_task_comm(me, comm);\n\t\tproc_comm_connector(me);\n\t\tbreak;\n\tcase PR_GET_NAME:\n\t\tget_task_comm(comm, me);\n\t\tif (copy_to_user((char __user *)arg2, comm, sizeof(comm)))\n\t\t\treturn -EFAULT;\n\t\tbreak;\n\tcase PR_GET_ENDIAN:\n\t\terror = GET_ENDIAN(me, arg2);\n\t\tbreak;\n\tcase PR_SET_ENDIAN:\n\t\terror = SET_ENDIAN(me, arg2);\n\t\tbreak;\n\tcase PR_GET_SECCOMP:\n\t\terror = prctl_get_seccomp();\n\t\tbreak;\n\tcase PR_SET_SECCOMP:\n\t\terror = prctl_set_seccomp(arg2, (char __user *)arg3);\n\t\tbreak;\n\tcase PR_GET_TSC:\n\t\terror = GET_TSC_CTL(arg2);\n\t\tbreak;\n\tcase PR_SET_TSC:\n\t\terror = SET_TSC_CTL(arg2);\n\t\tbreak;\n\tcase PR_TASK_PERF_EVENTS_DISABLE:\n\t\terror = perf_event_task_disable();\n\t\tbreak;\n\tcase PR_TASK_PERF_EVENTS_ENABLE:\n\t\terror = perf_event_task_enable();\n\t\tbreak;\n\tcase PR_GET_TIMERSLACK:\n\t\tif (current->timer_slack_ns > ULONG_MAX)\n\t\t\terror = ULONG_MAX;\n\t\telse\n\t\t\terror = current->timer_slack_ns;\n\t\tbreak;\n\tcase PR_SET_TIMERSLACK:\n\t\tif (arg2 <= 0)\n\t\t\tcurrent->timer_slack_ns =\n\t\t\t\t\tcurrent->default_timer_slack_ns;\n\t\telse\n\t\t\tcurrent->timer_slack_ns = arg2;\n\t\tbreak;\n\tcase PR_MCE_KILL:\n\t\tif (arg4 | arg5)\n\t\t\treturn -EINVAL;\n\t\tswitch (arg2) {\n\t\tcase PR_MCE_KILL_CLEAR:\n\t\t\tif (arg3 != 0)\n\t\t\t\treturn -EINVAL;\n\t\t\tcurrent->flags &= ~PF_MCE_PROCESS;\n\t\t\tbreak;\n\t\tcase PR_MCE_KILL_SET:\n\t\t\tcurrent->flags |= PF_MCE_PROCESS;\n\t\t\tif (arg3 == PR_MCE_KILL_EARLY)\n\t\t\t\tcurrent->flags |= PF_MCE_EARLY;\n\t\t\telse if (arg3 == PR_MCE_KILL_LATE)\n\t\t\t\tcurrent->flags &= ~PF_MCE_EARLY;\n\t\t\telse if (arg3 == PR_MCE_KILL_DEFAULT)\n\t\t\t\tcurrent->flags &=\n\t\t\t\t\t\t~(PF_MCE_EARLY|PF_MCE_PROCESS);\n\t\t\telse\n\t\t\t\treturn -EINVAL;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn -EINVAL;\n\t\t}\n\t\tbreak;\n\tcase PR_MCE_KILL_GET:\n\t\tif (arg2 | arg3 | arg4 | arg5)\n\t\t\treturn -EINVAL;\n\t\tif (current->flags & PF_MCE_PROCESS)\n\t\t\terror = (current->flags & PF_MCE_EARLY) ?\n\t\t\t\tPR_MCE_KILL_EARLY : PR_MCE_KILL_LATE;\n\t\telse\n\t\t\terror = PR_MCE_KILL_DEFAULT;\n\t\tbreak;\n\tcase PR_SET_MM:\n\t\terror = prctl_set_mm(arg2, arg3, arg4, arg5);\n\t\tbreak;\n\tcase PR_GET_TID_ADDRESS:\n\t\terror = prctl_get_tid_address(me, (int __user * __user *)arg2);\n\t\tbreak;\n\tcase PR_SET_CHILD_SUBREAPER:\n\t\tme->signal->is_child_subreaper = !!arg2;\n\t\tif (!arg2)\n\t\t\tbreak;\n\n\t\twalk_process_tree(me, propagate_has_child_subreaper, NULL);\n\t\tbreak;\n\tcase PR_GET_CHILD_SUBREAPER:\n\t\terror = put_user(me->signal->is_child_subreaper,\n\t\t\t\t (int __user *)arg2);\n\t\tbreak;\n\tcase PR_SET_NO_NEW_PRIVS:\n\t\tif (arg2 != 1 || arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\n\t\ttask_set_no_new_privs(current);\n\t\tbreak;\n\tcase PR_GET_NO_NEW_PRIVS:\n\t\tif (arg2 || arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\treturn task_no_new_privs(current) ? 1 : 0;\n\tcase PR_GET_THP_DISABLE:\n\t\tif (arg2 || arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\terror = !!test_bit(MMF_DISABLE_THP, &me->mm->flags);\n\t\tbreak;\n\tcase PR_SET_THP_DISABLE:\n\t\tif (arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\tif (mmap_write_lock_killable(me->mm))\n\t\t\treturn -EINTR;\n\t\tif (arg2)\n\t\t\tset_bit(MMF_DISABLE_THP, &me->mm->flags);\n\t\telse\n\t\t\tclear_bit(MMF_DISABLE_THP, &me->mm->flags);\n\t\tmmap_write_unlock(me->mm);\n\t\tbreak;\n\tcase PR_MPX_ENABLE_MANAGEMENT:\n\tcase PR_MPX_DISABLE_MANAGEMENT:\n\t\t/* No longer implemented: */\n\t\treturn -EINVAL;\n\tcase PR_SET_FP_MODE:\n\t\terror = SET_FP_MODE(me, arg2);\n\t\tbreak;\n\tcase PR_GET_FP_MODE:\n\t\terror = GET_FP_MODE(me);\n\t\tbreak;\n\tcase PR_SVE_SET_VL:\n\t\terror = SVE_SET_VL(arg2);\n\t\tbreak;\n\tcase PR_SVE_GET_VL:\n\t\terror = SVE_GET_VL();\n\t\tbreak;\n\tcase PR_GET_SPECULATION_CTRL:\n\t\tif (arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\terror = arch_prctl_spec_ctrl_get(me, arg2);\n\t\tbreak;\n\tcase PR_SET_SPECULATION_CTRL:\n\t\tif (arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\terror = arch_prctl_spec_ctrl_set(me, arg2, arg3);\n\t\tbreak;\n\tcase PR_PAC_RESET_KEYS:\n\t\tif (arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\terror = PAC_RESET_KEYS(me, arg2);\n\t\tbreak;\n\tcase PR_PAC_SET_ENABLED_KEYS:\n\t\tif (arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\terror = PAC_SET_ENABLED_KEYS(me, arg2, arg3);\n\t\tbreak;\n\tcase PR_PAC_GET_ENABLED_KEYS:\n\t\tif (arg2 || arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\terror = PAC_GET_ENABLED_KEYS(me);\n\t\tbreak;\n\tcase PR_SET_TAGGED_ADDR_CTRL:\n\t\tif (arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\terror = SET_TAGGED_ADDR_CTRL(arg2);\n\t\tbreak;\n\tcase PR_GET_TAGGED_ADDR_CTRL:\n\t\tif (arg2 || arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\terror = GET_TAGGED_ADDR_CTRL();\n\t\tbreak;\n\tcase PR_SET_IO_FLUSHER:\n\t\tif (!capable(CAP_SYS_RESOURCE))\n\t\t\treturn -EPERM;\n\n\t\tif (arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\n\t\tif (arg2 == 1)\n\t\t\tcurrent->flags |= PR_IO_FLUSHER;\n\t\telse if (!arg2)\n\t\t\tcurrent->flags &= ~PR_IO_FLUSHER;\n\t\telse\n\t\t\treturn -EINVAL;\n\t\tbreak;\n\tcase PR_GET_IO_FLUSHER:\n\t\tif (!capable(CAP_SYS_RESOURCE))\n\t\t\treturn -EPERM;\n\n\t\tif (arg2 || arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\n\t\terror = (current->flags & PR_IO_FLUSHER) == PR_IO_FLUSHER;\n\t\tbreak;\n\tcase PR_SET_SYSCALL_USER_DISPATCH:\n\t\terror = set_syscall_user_dispatch(arg2, arg3, arg4,\n\t\t\t\t\t\t  (char __user *) arg5);\n\t\tbreak;\n#ifdef CONFIG_SCHED_CORE\n\tcase PR_SCHED_CORE:\n\t\terror = sched_core_share_pid(arg2, arg3, arg4, arg5);\n\t\tbreak;\n#endif\n\tcase PR_SET_VMA:\n\t\terror = prctl_set_vma(arg2, arg3, arg4, arg5);\n\t\tbreak;\n\tdefault:\n\t\terror = -EINVAL;\n\t\tbreak;\n\t}\n\treturn error;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE5(prctl, int, option, unsigned long, arg2, unsigned long, arg3,\n\t\tunsigned long, arg4, unsigned long, arg5)\n{\n\tstruct task_struct *me = current;\n\tunsigned char comm[sizeof(me->comm)];\n\tlong error;\n\n\terror = security_task_prctl(option, arg2, arg3, arg4, arg5);\n\tif (error != -ENOSYS)\n\t\treturn error;\n\n\terror = 0;\n\tswitch (option) {\n\tcase PR_SET_PDEATHSIG:\n\t\tif (!valid_signal(arg2)) {\n\t\t\terror = -EINVAL;\n\t\t\tbreak;\n\t\t}\n\t\tme->pdeath_signal = arg2;\n\t\tbreak;\n\tcase PR_GET_PDEATHSIG:\n\t\terror = put_user(me->pdeath_signal, (int __user *)arg2);\n\t\tbreak;\n\tcase PR_GET_DUMPABLE:\n\t\terror = get_dumpable(me->mm);\n\t\tbreak;\n\tcase PR_SET_DUMPABLE:\n\t\tif (arg2 != SUID_DUMP_DISABLE && arg2 != SUID_DUMP_USER) {\n\t\t\terror = -EINVAL;\n\t\t\tbreak;\n\t\t}\n\t\tset_dumpable(me->mm, arg2);\n\t\tbreak;\n\n\tcase PR_SET_UNALIGN:\n\t\terror = SET_UNALIGN_CTL(me, arg2);\n\t\tbreak;\n\tcase PR_GET_UNALIGN:\n\t\terror = GET_UNALIGN_CTL(me, arg2);\n\t\tbreak;\n\tcase PR_SET_FPEMU:\n\t\terror = SET_FPEMU_CTL(me, arg2);\n\t\tbreak;\n\tcase PR_GET_FPEMU:\n\t\terror = GET_FPEMU_CTL(me, arg2);\n\t\tbreak;\n\tcase PR_SET_FPEXC:\n\t\terror = SET_FPEXC_CTL(me, arg2);\n\t\tbreak;\n\tcase PR_GET_FPEXC:\n\t\terror = GET_FPEXC_CTL(me, arg2);\n\t\tbreak;\n\tcase PR_GET_TIMING:\n\t\terror = PR_TIMING_STATISTICAL;\n\t\tbreak;\n\tcase PR_SET_TIMING:\n\t\tif (arg2 != PR_TIMING_STATISTICAL)\n\t\t\terror = -EINVAL;\n\t\tbreak;\n\tcase PR_SET_NAME:\n\t\tcomm[sizeof(me->comm) - 1] = 0;\n\t\tif (strncpy_from_user(comm, (char __user *)arg2,\n\t\t\t\t      sizeof(me->comm) - 1) < 0)\n\t\t\treturn -EFAULT;\n\t\tset_task_comm(me, comm);\n\t\tproc_comm_connector(me);\n\t\tbreak;\n\tcase PR_GET_NAME:\n\t\tget_task_comm(comm, me);\n\t\tif (copy_to_user((char __user *)arg2, comm, sizeof(comm)))\n\t\t\treturn -EFAULT;\n\t\tbreak;\n\tcase PR_GET_ENDIAN:\n\t\terror = GET_ENDIAN(me, arg2);\n\t\tbreak;\n\tcase PR_SET_ENDIAN:\n\t\terror = SET_ENDIAN(me, arg2);\n\t\tbreak;\n\tcase PR_GET_SECCOMP:\n\t\terror = prctl_get_seccomp();\n\t\tbreak;\n\tcase PR_SET_SECCOMP:\n\t\terror = prctl_set_seccomp(arg2, (char __user *)arg3);\n\t\tbreak;\n\tcase PR_GET_TSC:\n\t\terror = GET_TSC_CTL(arg2);\n\t\tbreak;\n\tcase PR_SET_TSC:\n\t\terror = SET_TSC_CTL(arg2);\n\t\tbreak;\n\tcase PR_TASK_PERF_EVENTS_DISABLE:\n\t\terror = perf_event_task_disable();\n\t\tbreak;\n\tcase PR_TASK_PERF_EVENTS_ENABLE:\n\t\terror = perf_event_task_enable();\n\t\tbreak;\n\tcase PR_GET_TIMERSLACK:\n\t\tif (current->timer_slack_ns > ULONG_MAX)\n\t\t\terror = ULONG_MAX;\n\t\telse\n\t\t\terror = current->timer_slack_ns;\n\t\tbreak;\n\tcase PR_SET_TIMERSLACK:\n\t\tif (arg2 <= 0)\n\t\t\tcurrent->timer_slack_ns =\n\t\t\t\t\tcurrent->default_timer_slack_ns;\n\t\telse\n\t\t\tcurrent->timer_slack_ns = arg2;\n\t\tbreak;\n\tcase PR_MCE_KILL:\n\t\tif (arg4 | arg5)\n\t\t\treturn -EINVAL;\n\t\tswitch (arg2) {\n\t\tcase PR_MCE_KILL_CLEAR:\n\t\t\tif (arg3 != 0)\n\t\t\t\treturn -EINVAL;\n\t\t\tcurrent->flags &= ~PF_MCE_PROCESS;\n\t\t\tbreak;\n\t\tcase PR_MCE_KILL_SET:\n\t\t\tcurrent->flags |= PF_MCE_PROCESS;\n\t\t\tif (arg3 == PR_MCE_KILL_EARLY)\n\t\t\t\tcurrent->flags |= PF_MCE_EARLY;\n\t\t\telse if (arg3 == PR_MCE_KILL_LATE)\n\t\t\t\tcurrent->flags &= ~PF_MCE_EARLY;\n\t\t\telse if (arg3 == PR_MCE_KILL_DEFAULT)\n\t\t\t\tcurrent->flags &=\n\t\t\t\t\t\t~(PF_MCE_EARLY|PF_MCE_PROCESS);\n\t\t\telse\n\t\t\t\treturn -EINVAL;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn -EINVAL;\n\t\t}\n\t\tbreak;\n\tcase PR_MCE_KILL_GET:\n\t\tif (arg2 | arg3 | arg4 | arg5)\n\t\t\treturn -EINVAL;\n\t\tif (current->flags & PF_MCE_PROCESS)\n\t\t\terror = (current->flags & PF_MCE_EARLY) ?\n\t\t\t\tPR_MCE_KILL_EARLY : PR_MCE_KILL_LATE;\n\t\telse\n\t\t\terror = PR_MCE_KILL_DEFAULT;\n\t\tbreak;\n\tcase PR_SET_MM:\n\t\terror = prctl_set_mm(arg2, arg3, arg4, arg5);\n\t\tbreak;\n\tcase PR_GET_TID_ADDRESS:\n\t\terror = prctl_get_tid_address(me, (int __user * __user *)arg2);\n\t\tbreak;\n\tcase PR_SET_CHILD_SUBREAPER:\n\t\tme->signal->is_child_subreaper = !!arg2;\n\t\tif (!arg2)\n\t\t\tbreak;\n\n\t\twalk_process_tree(me, propagate_has_child_subreaper, NULL);\n\t\tbreak;\n\tcase PR_GET_CHILD_SUBREAPER:\n\t\terror = put_user(me->signal->is_child_subreaper,\n\t\t\t\t (int __user *)arg2);\n\t\tbreak;\n\tcase PR_SET_NO_NEW_PRIVS:\n\t\tif (arg2 != 1 || arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\n\t\ttask_set_no_new_privs(current);\n\t\tbreak;\n\tcase PR_GET_NO_NEW_PRIVS:\n\t\tif (arg2 || arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\treturn task_no_new_privs(current) ? 1 : 0;\n\tcase PR_GET_THP_DISABLE:\n\t\tif (arg2 || arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\terror = !!test_bit(MMF_DISABLE_THP, &me->mm->flags);\n\t\tbreak;\n\tcase PR_SET_THP_DISABLE:\n\t\tif (arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\tif (mmap_write_lock_killable(me->mm))\n\t\t\treturn -EINTR;\n\t\tif (arg2)\n\t\t\tset_bit(MMF_DISABLE_THP, &me->mm->flags);\n\t\telse\n\t\t\tclear_bit(MMF_DISABLE_THP, &me->mm->flags);\n\t\tmmap_write_unlock(me->mm);\n\t\tbreak;\n\tcase PR_MPX_ENABLE_MANAGEMENT:\n\tcase PR_MPX_DISABLE_MANAGEMENT:\n\t\t/* No longer implemented: */\n\t\treturn -EINVAL;\n\tcase PR_SET_FP_MODE:\n\t\terror = SET_FP_MODE(me, arg2);\n\t\tbreak;\n\tcase PR_GET_FP_MODE:\n\t\terror = GET_FP_MODE(me);\n\t\tbreak;\n\tcase PR_SVE_SET_VL:\n\t\terror = SVE_SET_VL(arg2);\n\t\tbreak;\n\tcase PR_SVE_GET_VL:\n\t\terror = SVE_GET_VL();\n\t\tbreak;\n\tcase PR_GET_SPECULATION_CTRL:\n\t\tif (arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\terror = arch_prctl_spec_ctrl_get(me, arg2);\n\t\tbreak;\n\tcase PR_SET_SPECULATION_CTRL:\n\t\tif (arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\terror = arch_prctl_spec_ctrl_set(me, arg2, arg3);\n\t\tbreak;\n\tcase PR_PAC_RESET_KEYS:\n\t\tif (arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\terror = PAC_RESET_KEYS(me, arg2);\n\t\tbreak;\n\tcase PR_PAC_SET_ENABLED_KEYS:\n\t\tif (arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\terror = PAC_SET_ENABLED_KEYS(me, arg2, arg3);\n\t\tbreak;\n\tcase PR_PAC_GET_ENABLED_KEYS:\n\t\tif (arg2 || arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\terror = PAC_GET_ENABLED_KEYS(me);\n\t\tbreak;\n\tcase PR_SET_TAGGED_ADDR_CTRL:\n\t\tif (arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\terror = SET_TAGGED_ADDR_CTRL(arg2);\n\t\tbreak;\n\tcase PR_GET_TAGGED_ADDR_CTRL:\n\t\tif (arg2 || arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\t\terror = GET_TAGGED_ADDR_CTRL();\n\t\tbreak;\n\tcase PR_SET_IO_FLUSHER:\n\t\tif (!capable(CAP_SYS_RESOURCE))\n\t\t\treturn -EPERM;\n\n\t\tif (arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\n\t\tif (arg2 == 1)\n\t\t\tcurrent->flags |= PR_IO_FLUSHER;\n\t\telse if (!arg2)\n\t\t\tcurrent->flags &= ~PR_IO_FLUSHER;\n\t\telse\n\t\t\treturn -EINVAL;\n\t\tbreak;\n\tcase PR_GET_IO_FLUSHER:\n\t\tif (!capable(CAP_SYS_RESOURCE))\n\t\t\treturn -EPERM;\n\n\t\tif (arg2 || arg3 || arg4 || arg5)\n\t\t\treturn -EINVAL;\n\n\t\terror = (current->flags & PR_IO_FLUSHER) == PR_IO_FLUSHER;\n\t\tbreak;\n\tcase PR_SET_SYSCALL_USER_DISPATCH:\n\t\terror = set_syscall_user_dispatch(arg2, arg3, arg4,\n\t\t\t\t\t\t  (char __user *) arg5);\n\t\tbreak;\n#ifdef CONFIG_SCHED_CORE\n\tcase PR_SCHED_CORE:\n\t\terror = sched_core_share_pid(arg2, arg3, arg4, arg5);\n\t\tbreak;\n#endif\n\tcase PR_SET_VMA:\n\t\terror = prctl_set_vma(arg2, arg3, arg4, arg5);\n\t\tbreak;\n\tdefault:\n\t\terror = -EINVAL;\n\t\tbreak;\n\t}\n\treturn error;\n}"
  },
  {
    "function_name": "getcpu",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "2603-2614",
    "snippet": "SYSCALL_DEFINE3(getcpu, unsigned __user *, cpup, unsigned __user *, nodep,\n\t\tstruct getcpu_cache __user *, unused)\n{\n\tint err = 0;\n\tint cpu = raw_smp_processor_id();\n\n\tif (cpup)\n\t\terr |= put_user(cpu, cpup);\n\tif (nodep)\n\t\terr |= put_user(cpu_to_node(cpu), nodep);\n\treturn err ? -EFAULT : 0;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE3(getcpu, unsigned __user *, cpup, unsigned __user *, nodep,\n\t\tstruct getcpu_cache __user *, unused)\n{\n\tint err = 0;\n\tint cpu = raw_smp_processor_id();\n\n\tif (cpup)\n\t\terr |= put_user(cpu, cpup);\n\tif (nodep)\n\t\terr |= put_user(cpu_to_node(cpu), nodep);\n\treturn err ? -EFAULT : 0;\n}"
  },
  {
    "function_name": "sysinfo",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "2683-2693",
    "snippet": "SYSCALL_DEFINE1(sysinfo, struct sysinfo __user *, info)\n{\n\tstruct sysinfo val;\n\n\tdo_sysinfo(&val);\n\n\tif (copy_to_user(info, &val, sizeof(struct sysinfo)))\n\t\treturn -EFAULT;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(sysinfo, struct sysinfo __user *, info)\n{\n\tstruct sysinfo val;\n\n\tdo_sysinfo(&val);\n\n\tif (copy_to_user(info, &val, sizeof(struct sysinfo)))\n\t\treturn -EFAULT;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "sysinfo",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sys.c",
    "lines": "2713-2759",
    "snippet": "SYSCALL_DEFINE1(sysinfo, struct compat_sysinfo __user *, info)\n{\n\tstruct sysinfo s;\n\tstruct compat_sysinfo s_32;\n\n\tdo_sysinfo(&s);\n\n\t/* Check to see if any memory value is too large for 32-bit and scale\n\t *  down if needed\n\t */\n\tif (upper_32_bits(s.totalram) || upper_32_bits(s.totalswap)) {\n\t\tint bitcount = 0;\n\n\t\twhile (s.mem_unit < PAGE_SIZE) {\n\t\t\ts.mem_unit <<= 1;\n\t\t\tbitcount++;\n\t\t}\n\n\t\ts.totalram >>= bitcount;\n\t\ts.freeram >>= bitcount;\n\t\ts.sharedram >>= bitcount;\n\t\ts.bufferram >>= bitcount;\n\t\ts.totalswap >>= bitcount;\n\t\ts.freeswap >>= bitcount;\n\t\ts.totalhigh >>= bitcount;\n\t\ts.freehigh >>= bitcount;\n\t}\n\n\tmemset(&s_32, 0, sizeof(s_32));\n\ts_32.uptime = s.uptime;\n\ts_32.loads[0] = s.loads[0];\n\ts_32.loads[1] = s.loads[1];\n\ts_32.loads[2] = s.loads[2];\n\ts_32.totalram = s.totalram;\n\ts_32.freeram = s.freeram;\n\ts_32.sharedram = s.sharedram;\n\ts_32.bufferram = s.bufferram;\n\ts_32.totalswap = s.totalswap;\n\ts_32.freeswap = s.freeswap;\n\ts_32.procs = s.procs;\n\ts_32.totalhigh = s.totalhigh;\n\ts_32.freehigh = s.freehigh;\n\ts_32.mem_unit = s.mem_unit;\n\tif (copy_to_user(info, &s_32, sizeof(s_32)))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include \"uid16.h\"",
      "#include <asm/unistd.h>",
      "#include <asm/io.h>",
      "#include <linux/uaccess.h>",
      "#include <generated/utsrelease.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/nospec.h>",
      "#include <linux/cred.h>",
      "#include <linux/uidgid.h>",
      "#include <linux/rcupdate.h>",
      "#include <linux/sched/cputime.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/coredump.h>",
      "#include <linux/sched/mm.h>",
      "#include <linux/sched/stat.h>",
      "#include <linux/sched/loadavg.h>",
      "#include <linux/sched/autogroup.h>",
      "#include <linux/sched.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/time_namespace.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscall_user_dispatch.h>",
      "#include <linux/ctype.h>",
      "#include <linux/version.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/gfp.h>",
      "#include <linux/mount.h>",
      "#include <linux/file.h>",
      "#include <linux/fs_struct.h>",
      "#include <linux/ptrace.h>",
      "#include <linux/personality.h>",
      "#include <linux/cpu.h>",
      "#include <linux/seccomp.h>",
      "#include <linux/task_io_accounting_ops.h>",
      "#include <linux/getcpu.h>",
      "#include <linux/cn_proc.h>",
      "#include <linux/signal.h>",
      "#include <linux/tty.h>",
      "#include <linux/suspend.h>",
      "#include <linux/security.h>",
      "#include <linux/posix-timers.h>",
      "#include <linux/times.h>",
      "#include <linux/key.h>",
      "#include <linux/device.h>",
      "#include <linux/capability.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernel.h>",
      "#include <linux/resource.h>",
      "#include <linux/perf_event.h>",
      "#include <linux/kmod.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/prctl.h>",
      "#include <linux/reboot.h>",
      "#include <linux/mman.h>",
      "#include <linux/utsname.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"uid16.h\"\n#include <asm/unistd.h>\n#include <asm/io.h>\n#include <linux/uaccess.h>\n#include <generated/utsrelease.h>\n#include <linux/kmsg_dump.h>\n#include <linux/nospec.h>\n#include <linux/cred.h>\n#include <linux/uidgid.h>\n#include <linux/rcupdate.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n#include <linux/binfmts.h>\n#include <linux/time_namespace.h>\n#include <linux/user_namespace.h>\n#include <linux/kprobes.h>\n#include <linux/syscalls.h>\n#include <linux/compat.h>\n#include <linux/syscall_user_dispatch.h>\n#include <linux/ctype.h>\n#include <linux/version.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/mount.h>\n#include <linux/file.h>\n#include <linux/fs_struct.h>\n#include <linux/ptrace.h>\n#include <linux/personality.h>\n#include <linux/cpu.h>\n#include <linux/seccomp.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/getcpu.h>\n#include <linux/cn_proc.h>\n#include <linux/signal.h>\n#include <linux/tty.h>\n#include <linux/suspend.h>\n#include <linux/security.h>\n#include <linux/posix-timers.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/device.h>\n#include <linux/capability.h>\n#include <linux/workqueue.h>\n#include <linux/kernel.h>\n#include <linux/resource.h>\n#include <linux/perf_event.h>\n#include <linux/kmod.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/prctl.h>\n#include <linux/reboot.h>\n#include <linux/mman.h>\n#include <linux/utsname.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE1(sysinfo, struct compat_sysinfo __user *, info)\n{\n\tstruct sysinfo s;\n\tstruct compat_sysinfo s_32;\n\n\tdo_sysinfo(&s);\n\n\t/* Check to see if any memory value is too large for 32-bit and scale\n\t *  down if needed\n\t */\n\tif (upper_32_bits(s.totalram) || upper_32_bits(s.totalswap)) {\n\t\tint bitcount = 0;\n\n\t\twhile (s.mem_unit < PAGE_SIZE) {\n\t\t\ts.mem_unit <<= 1;\n\t\t\tbitcount++;\n\t\t}\n\n\t\ts.totalram >>= bitcount;\n\t\ts.freeram >>= bitcount;\n\t\ts.sharedram >>= bitcount;\n\t\ts.bufferram >>= bitcount;\n\t\ts.totalswap >>= bitcount;\n\t\ts.freeswap >>= bitcount;\n\t\ts.totalhigh >>= bitcount;\n\t\ts.freehigh >>= bitcount;\n\t}\n\n\tmemset(&s_32, 0, sizeof(s_32));\n\ts_32.uptime = s.uptime;\n\ts_32.loads[0] = s.loads[0];\n\ts_32.loads[1] = s.loads[1];\n\ts_32.loads[2] = s.loads[2];\n\ts_32.totalram = s.totalram;\n\ts_32.freeram = s.freeram;\n\ts_32.sharedram = s.sharedram;\n\ts_32.bufferram = s.bufferram;\n\ts_32.totalswap = s.totalswap;\n\ts_32.freeswap = s.freeswap;\n\ts_32.procs = s.procs;\n\ts_32.totalhigh = s.totalhigh;\n\ts_32.freehigh = s.freehigh;\n\ts_32.mem_unit = s.mem_unit;\n\tif (copy_to_user(info, &s_32, sizeof(s_32)))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  }
]