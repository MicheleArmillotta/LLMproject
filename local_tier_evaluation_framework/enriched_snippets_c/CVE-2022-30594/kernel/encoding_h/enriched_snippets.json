[
  {
    "function_name": "matching_access",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/kcsan/encoding.h",
    "lines": "93-100",
    "snippet": "static __always_inline bool matching_access(unsigned long addr1, size_t size1,\n\t\t\t\t\t    unsigned long addr2, size_t size2)\n{\n\tunsigned long end_range1 = addr1 + size1 - 1;\n\tunsigned long end_range2 = addr2 + size2 - 1;\n\n\treturn addr1 <= end_range2 && addr2 <= end_range1;\n}",
    "includes": [
      "#include \"kcsan.h\"",
      "#include <linux/mm.h>",
      "#include <linux/log2.h>",
      "#include <linux/bits.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"kcsan.h\"\n#include <linux/mm.h>\n#include <linux/log2.h>\n#include <linux/bits.h>\n\nstatic __always_inline bool matching_access(unsigned long addr1, size_t size1,\n\t\t\t\t\t    unsigned long addr2, size_t size2)\n{\n\tunsigned long end_range1 = addr1 + size1 - 1;\n\tunsigned long end_range2 = addr2 + size2 - 1;\n\n\treturn addr1 <= end_range2 && addr2 <= end_range1;\n}"
  },
  {
    "function_name": "watchpoint_slot",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/kcsan/encoding.h",
    "lines": "88-91",
    "snippet": "static __always_inline int watchpoint_slot(unsigned long addr)\n{\n\treturn (addr / PAGE_SIZE) % CONFIG_KCSAN_NUM_WATCHPOINTS;\n}",
    "includes": [
      "#include \"kcsan.h\"",
      "#include <linux/mm.h>",
      "#include <linux/log2.h>",
      "#include <linux/bits.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"kcsan.h\"\n#include <linux/mm.h>\n#include <linux/log2.h>\n#include <linux/bits.h>\n\nstatic __always_inline int watchpoint_slot(unsigned long addr)\n{\n\treturn (addr / PAGE_SIZE) % CONFIG_KCSAN_NUM_WATCHPOINTS;\n}"
  },
  {
    "function_name": "decode_watchpoint",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/kcsan/encoding.h",
    "lines": "69-83",
    "snippet": "static __always_inline bool decode_watchpoint(long watchpoint,\n\t\t\t\t\t      unsigned long *addr_masked,\n\t\t\t\t\t      size_t *size,\n\t\t\t\t\t      bool *is_write)\n{\n\tif (watchpoint == INVALID_WATCHPOINT ||\n\t    watchpoint == CONSUMED_WATCHPOINT)\n\t\treturn false;\n\n\t*addr_masked =    (unsigned long)watchpoint & WATCHPOINT_ADDR_MASK;\n\t*size\t     =   ((unsigned long)watchpoint & WATCHPOINT_SIZE_MASK) >> WATCHPOINT_ADDR_BITS;\n\t*is_write    = !!((unsigned long)watchpoint & WATCHPOINT_WRITE_MASK);\n\n\treturn true;\n}",
    "includes": [
      "#include \"kcsan.h\"",
      "#include <linux/mm.h>",
      "#include <linux/log2.h>",
      "#include <linux/bits.h>"
    ],
    "macros_used": [
      "#define WATCHPOINT_ADDR_MASK\tGENMASK(WATCHPOINT_ADDR_BITS-1, 0)",
      "#define WATCHPOINT_SIZE_MASK\tGENMASK(BITS_PER_LONG-2, WATCHPOINT_ADDR_BITS)",
      "#define WATCHPOINT_WRITE_MASK\tBIT(BITS_PER_LONG-1)",
      "#define WATCHPOINT_ADDR_BITS (BITS_PER_LONG-1 - WATCHPOINT_SIZE_BITS)",
      "#define CONSUMED_WATCHPOINT 1",
      "#define INVALID_WATCHPOINT  0"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"kcsan.h\"\n#include <linux/mm.h>\n#include <linux/log2.h>\n#include <linux/bits.h>\n\n#define WATCHPOINT_ADDR_MASK\tGENMASK(WATCHPOINT_ADDR_BITS-1, 0)\n#define WATCHPOINT_SIZE_MASK\tGENMASK(BITS_PER_LONG-2, WATCHPOINT_ADDR_BITS)\n#define WATCHPOINT_WRITE_MASK\tBIT(BITS_PER_LONG-1)\n#define WATCHPOINT_ADDR_BITS (BITS_PER_LONG-1 - WATCHPOINT_SIZE_BITS)\n#define CONSUMED_WATCHPOINT 1\n#define INVALID_WATCHPOINT  0\n\nstatic __always_inline bool decode_watchpoint(long watchpoint,\n\t\t\t\t\t      unsigned long *addr_masked,\n\t\t\t\t\t      size_t *size,\n\t\t\t\t\t      bool *is_write)\n{\n\tif (watchpoint == INVALID_WATCHPOINT ||\n\t    watchpoint == CONSUMED_WATCHPOINT)\n\t\treturn false;\n\n\t*addr_masked =    (unsigned long)watchpoint & WATCHPOINT_ADDR_MASK;\n\t*size\t     =   ((unsigned long)watchpoint & WATCHPOINT_SIZE_MASK) >> WATCHPOINT_ADDR_BITS;\n\t*is_write    = !!((unsigned long)watchpoint & WATCHPOINT_WRITE_MASK);\n\n\treturn true;\n}"
  },
  {
    "function_name": "encode_watchpoint",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/kcsan/encoding.h",
    "lines": "61-67",
    "snippet": "static inline long\nencode_watchpoint(unsigned long addr, size_t size, bool is_write)\n{\n\treturn (long)((is_write ? WATCHPOINT_WRITE_MASK : 0) |\n\t\t      (size << WATCHPOINT_ADDR_BITS) |\n\t\t      (addr & WATCHPOINT_ADDR_MASK));\n}",
    "includes": [
      "#include \"kcsan.h\"",
      "#include <linux/mm.h>",
      "#include <linux/log2.h>",
      "#include <linux/bits.h>"
    ],
    "macros_used": [
      "#define WATCHPOINT_ADDR_MASK\tGENMASK(WATCHPOINT_ADDR_BITS-1, 0)",
      "#define WATCHPOINT_WRITE_MASK\tBIT(BITS_PER_LONG-1)",
      "#define WATCHPOINT_ADDR_BITS (BITS_PER_LONG-1 - WATCHPOINT_SIZE_BITS)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"kcsan.h\"\n#include <linux/mm.h>\n#include <linux/log2.h>\n#include <linux/bits.h>\n\n#define WATCHPOINT_ADDR_MASK\tGENMASK(WATCHPOINT_ADDR_BITS-1, 0)\n#define WATCHPOINT_WRITE_MASK\tBIT(BITS_PER_LONG-1)\n#define WATCHPOINT_ADDR_BITS (BITS_PER_LONG-1 - WATCHPOINT_SIZE_BITS)\n\nstatic inline long\nencode_watchpoint(unsigned long addr, size_t size, bool is_write)\n{\n\treturn (long)((is_write ? WATCHPOINT_WRITE_MASK : 0) |\n\t\t      (size << WATCHPOINT_ADDR_BITS) |\n\t\t      (addr & WATCHPOINT_ADDR_MASK));\n}"
  },
  {
    "function_name": "check_encodable",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/kcsan/encoding.h",
    "lines": "52-59",
    "snippet": "static inline bool check_encodable(unsigned long addr, size_t size)\n{\n\t/*\n\t * While we can encode addrs<PAGE_SIZE, avoid crashing with a NULL\n\t * pointer deref inside KCSAN.\n\t */\n\treturn addr >= PAGE_SIZE && size <= MAX_ENCODABLE_SIZE;\n}",
    "includes": [
      "#include \"kcsan.h\"",
      "#include <linux/mm.h>",
      "#include <linux/log2.h>",
      "#include <linux/bits.h>"
    ],
    "macros_used": [
      "#define MAX_ENCODABLE_SIZE (SLOT_RANGE * (1 + KCSAN_CHECK_ADJACENT))"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"kcsan.h\"\n#include <linux/mm.h>\n#include <linux/log2.h>\n#include <linux/bits.h>\n\n#define MAX_ENCODABLE_SIZE (SLOT_RANGE * (1 + KCSAN_CHECK_ADJACENT))\n\nstatic inline bool check_encodable(unsigned long addr, size_t size)\n{\n\t/*\n\t * While we can encode addrs<PAGE_SIZE, avoid crashing with a NULL\n\t * pointer deref inside KCSAN.\n\t */\n\treturn addr >= PAGE_SIZE && size <= MAX_ENCODABLE_SIZE;\n}"
  }
]