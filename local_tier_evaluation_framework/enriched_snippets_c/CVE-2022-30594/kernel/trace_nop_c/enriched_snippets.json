[
  {
    "function_name": "nop_set_flag",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/trace_nop.c",
    "lines": "64-85",
    "snippet": "static int nop_set_flag(struct trace_array *tr, u32 old_flags, u32 bit, int set)\n{\n\t/*\n\t * Note that you don't need to update nop_flags.val yourself.\n\t * The tracing Api will do it automatically if you return 0\n\t */\n\tif (bit == TRACE_NOP_OPT_ACCEPT) {\n\t\tprintk(KERN_DEBUG \"nop_test_accept flag set to %d: we accept.\"\n\t\t\t\" Now cat trace_options to see the result\\n\",\n\t\t\tset);\n\t\treturn 0;\n\t}\n\n\tif (bit == TRACE_NOP_OPT_REFUSE) {\n\t\tprintk(KERN_DEBUG \"nop_test_refuse flag set to %d: we refuse.\"\n\t\t\t\" Now cat trace_options to see the result\\n\",\n\t\t\tset);\n\t\treturn -EINVAL;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"trace.h\"",
      "#include <linux/ftrace.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct tracer_flags nop_flags = {\n\t/* You can check your flags value here when you want. */\n\t.val = 0, /* By default: all flags disabled */\n\t.opts = nop_opts\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_DEBUG \"nop_test_refuse flag set to %d: we refuse.\"\n\t\t\t\" Now cat trace_options to see the result\\n\"",
            "set"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "mmio_trace_printk",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/trace_mmiotrace.c",
          "lines": "359-362",
          "snippet": "int mmio_trace_printk(const char *fmt, va_list args)\n{\n\treturn trace_vprintk(0, fmt, args);\n}",
          "includes": [
            "#include \"trace_output.h\"",
            "#include \"trace.h\"",
            "#include <linux/atomic.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/pci.h>",
            "#include <linux/mmiotrace.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_output.h\"\n#include \"trace.h\"\n#include <linux/atomic.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/pci.h>\n#include <linux/mmiotrace.h>\n#include <linux/kernel.h>\n\nint mmio_trace_printk(const char *fmt, va_list args)\n{\n\treturn trace_vprintk(0, fmt, args);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace.h\"\n#include <linux/ftrace.h>\n#include <linux/module.h>\n\nstatic struct tracer_flags nop_flags = {\n\t/* You can check your flags value here when you want. */\n\t.val = 0, /* By default: all flags disabled */\n\t.opts = nop_opts\n};\n\nstatic int nop_set_flag(struct trace_array *tr, u32 old_flags, u32 bit, int set)\n{\n\t/*\n\t * Note that you don't need to update nop_flags.val yourself.\n\t * The tracing Api will do it automatically if you return 0\n\t */\n\tif (bit == TRACE_NOP_OPT_ACCEPT) {\n\t\tprintk(KERN_DEBUG \"nop_test_accept flag set to %d: we accept.\"\n\t\t\t\" Now cat trace_options to see the result\\n\",\n\t\t\tset);\n\t\treturn 0;\n\t}\n\n\tif (bit == TRACE_NOP_OPT_REFUSE) {\n\t\tprintk(KERN_DEBUG \"nop_test_refuse flag set to %d: we refuse.\"\n\t\t\t\" Now cat trace_options to see the result\\n\",\n\t\t\tset);\n\t\treturn -EINVAL;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "nop_trace_reset",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/trace_nop.c",
    "lines": "54-57",
    "snippet": "static void nop_trace_reset(struct trace_array *tr)\n{\n\tstop_nop_trace(tr);\n}",
    "includes": [
      "#include \"trace.h\"",
      "#include <linux/ftrace.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stop_nop_trace",
          "args": [
            "tr"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "stop_nop_trace",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/trace_nop.c",
          "lines": "42-45",
          "snippet": "static void stop_nop_trace(struct trace_array *tr)\n{\n\t/* Nothing to do! */\n}",
          "includes": [
            "#include \"trace.h\"",
            "#include <linux/ftrace.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace.h\"\n#include <linux/ftrace.h>\n#include <linux/module.h>\n\nstatic void stop_nop_trace(struct trace_array *tr)\n{\n\t/* Nothing to do! */\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace.h\"\n#include <linux/ftrace.h>\n#include <linux/module.h>\n\nstatic void nop_trace_reset(struct trace_array *tr)\n{\n\tstop_nop_trace(tr);\n}"
  },
  {
    "function_name": "nop_trace_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/trace_nop.c",
    "lines": "47-52",
    "snippet": "static int nop_trace_init(struct trace_array *tr)\n{\n\tctx_trace = tr;\n\tstart_nop_trace(tr);\n\treturn 0;\n}",
    "includes": [
      "#include \"trace.h\"",
      "#include <linux/ftrace.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct trace_array\t*ctx_trace;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "start_nop_trace",
          "args": [
            "tr"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "start_nop_trace",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/trace_nop.c",
          "lines": "37-40",
          "snippet": "static void start_nop_trace(struct trace_array *tr)\n{\n\t/* Nothing to do! */\n}",
          "includes": [
            "#include \"trace.h\"",
            "#include <linux/ftrace.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace.h\"\n#include <linux/ftrace.h>\n#include <linux/module.h>\n\nstatic void start_nop_trace(struct trace_array *tr)\n{\n\t/* Nothing to do! */\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"trace.h\"\n#include <linux/ftrace.h>\n#include <linux/module.h>\n\nstatic struct trace_array\t*ctx_trace;\n\nstatic int nop_trace_init(struct trace_array *tr)\n{\n\tctx_trace = tr;\n\tstart_nop_trace(tr);\n\treturn 0;\n}"
  },
  {
    "function_name": "stop_nop_trace",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/trace_nop.c",
    "lines": "42-45",
    "snippet": "static void stop_nop_trace(struct trace_array *tr)\n{\n\t/* Nothing to do! */\n}",
    "includes": [
      "#include \"trace.h\"",
      "#include <linux/ftrace.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"trace.h\"\n#include <linux/ftrace.h>\n#include <linux/module.h>\n\nstatic void stop_nop_trace(struct trace_array *tr)\n{\n\t/* Nothing to do! */\n}"
  },
  {
    "function_name": "start_nop_trace",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/trace_nop.c",
    "lines": "37-40",
    "snippet": "static void start_nop_trace(struct trace_array *tr)\n{\n\t/* Nothing to do! */\n}",
    "includes": [
      "#include \"trace.h\"",
      "#include <linux/ftrace.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"trace.h\"\n#include <linux/ftrace.h>\n#include <linux/module.h>\n\nstatic void start_nop_trace(struct trace_array *tr)\n{\n\t/* Nothing to do! */\n}"
  }
]