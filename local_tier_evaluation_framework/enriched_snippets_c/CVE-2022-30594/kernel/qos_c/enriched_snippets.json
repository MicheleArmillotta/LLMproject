[
  {
    "function_name": "freq_qos_remove_notifier",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "648-672",
    "snippet": "int freq_qos_remove_notifier(struct freq_constraints *qos,\n\t\t\t     enum freq_qos_req_type type,\n\t\t\t     struct notifier_block *notifier)\n{\n\tint ret;\n\n\tif (IS_ERR_OR_NULL(qos) || !notifier)\n\t\treturn -EINVAL;\n\n\tswitch (type) {\n\tcase FREQ_QOS_MIN:\n\t\tret = blocking_notifier_chain_unregister(qos->min_freq.notifiers,\n\t\t\t\t\t\t\t notifier);\n\t\tbreak;\n\tcase FREQ_QOS_MAX:\n\t\tret = blocking_notifier_chain_unregister(qos->max_freq.notifiers,\n\t\t\t\t\t\t\t notifier);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON(1);\n\t\tret = -EINVAL;\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "1"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "blocking_notifier_chain_unregister",
          "args": [
            "qos->max_freq.notifiers",
            "notifier"
          ],
          "line": 663
        },
        "resolved": true,
        "details": {
          "function_name": "blocking_notifier_chain_unregister",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/notifier.c",
          "lines": "252-269",
          "snippet": "int blocking_notifier_chain_unregister(struct blocking_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\tint ret;\n\n\t/*\n\t * This code gets used during boot-up, when task switching is\n\t * not yet working and interrupts must remain disabled.  At\n\t * such times we must not call down_write().\n\t */\n\tif (unlikely(system_state == SYSTEM_BOOTING))\n\t\treturn notifier_chain_unregister(&nh->head, n);\n\n\tdown_write(&nh->rwsem);\n\tret = notifier_chain_unregister(&nh->head, n);\n\tup_write(&nh->rwsem);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/reboot.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/notifier.h>",
            "#include <linux/export.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kdebug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/reboot.h>\n#include <linux/vmalloc.h>\n#include <linux/rcupdate.h>\n#include <linux/notifier.h>\n#include <linux/export.h>\n#include <linux/kprobes.h>\n#include <linux/kdebug.h>\n\nint blocking_notifier_chain_unregister(struct blocking_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\tint ret;\n\n\t/*\n\t * This code gets used during boot-up, when task switching is\n\t * not yet working and interrupts must remain disabled.  At\n\t * such times we must not call down_write().\n\t */\n\tif (unlikely(system_state == SYSTEM_BOOTING))\n\t\treturn notifier_chain_unregister(&nh->head, n);\n\n\tdown_write(&nh->rwsem);\n\tret = notifier_chain_unregister(&nh->head, n);\n\tup_write(&nh->rwsem);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR_OR_NULL",
          "args": [
            "qos"
          ],
          "line": 654
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nint freq_qos_remove_notifier(struct freq_constraints *qos,\n\t\t\t     enum freq_qos_req_type type,\n\t\t\t     struct notifier_block *notifier)\n{\n\tint ret;\n\n\tif (IS_ERR_OR_NULL(qos) || !notifier)\n\t\treturn -EINVAL;\n\n\tswitch (type) {\n\tcase FREQ_QOS_MIN:\n\t\tret = blocking_notifier_chain_unregister(qos->min_freq.notifiers,\n\t\t\t\t\t\t\t notifier);\n\t\tbreak;\n\tcase FREQ_QOS_MAX:\n\t\tret = blocking_notifier_chain_unregister(qos->max_freq.notifiers,\n\t\t\t\t\t\t\t notifier);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON(1);\n\t\tret = -EINVAL;\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "freq_qos_add_notifier",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "615-639",
    "snippet": "int freq_qos_add_notifier(struct freq_constraints *qos,\n\t\t\t  enum freq_qos_req_type type,\n\t\t\t  struct notifier_block *notifier)\n{\n\tint ret;\n\n\tif (IS_ERR_OR_NULL(qos) || !notifier)\n\t\treturn -EINVAL;\n\n\tswitch (type) {\n\tcase FREQ_QOS_MIN:\n\t\tret = blocking_notifier_chain_register(qos->min_freq.notifiers,\n\t\t\t\t\t\t       notifier);\n\t\tbreak;\n\tcase FREQ_QOS_MAX:\n\t\tret = blocking_notifier_chain_register(qos->max_freq.notifiers,\n\t\t\t\t\t\t       notifier);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON(1);\n\t\tret = -EINVAL;\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "1"
          ],
          "line": 634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "blocking_notifier_chain_register",
          "args": [
            "qos->max_freq.notifiers",
            "notifier"
          ],
          "line": 630
        },
        "resolved": true,
        "details": {
          "function_name": "blocking_notifier_chain_register",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/notifier.c",
          "lines": "222-239",
          "snippet": "int blocking_notifier_chain_register(struct blocking_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\tint ret;\n\n\t/*\n\t * This code gets used during boot-up, when task switching is\n\t * not yet working and interrupts must remain disabled.  At\n\t * such times we must not call down_write().\n\t */\n\tif (unlikely(system_state == SYSTEM_BOOTING))\n\t\treturn notifier_chain_register(&nh->head, n);\n\n\tdown_write(&nh->rwsem);\n\tret = notifier_chain_register(&nh->head, n);\n\tup_write(&nh->rwsem);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/reboot.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/notifier.h>",
            "#include <linux/export.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kdebug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/reboot.h>\n#include <linux/vmalloc.h>\n#include <linux/rcupdate.h>\n#include <linux/notifier.h>\n#include <linux/export.h>\n#include <linux/kprobes.h>\n#include <linux/kdebug.h>\n\nint blocking_notifier_chain_register(struct blocking_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\tint ret;\n\n\t/*\n\t * This code gets used during boot-up, when task switching is\n\t * not yet working and interrupts must remain disabled.  At\n\t * such times we must not call down_write().\n\t */\n\tif (unlikely(system_state == SYSTEM_BOOTING))\n\t\treturn notifier_chain_register(&nh->head, n);\n\n\tdown_write(&nh->rwsem);\n\tret = notifier_chain_register(&nh->head, n);\n\tup_write(&nh->rwsem);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR_OR_NULL",
          "args": [
            "qos"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nint freq_qos_add_notifier(struct freq_constraints *qos,\n\t\t\t  enum freq_qos_req_type type,\n\t\t\t  struct notifier_block *notifier)\n{\n\tint ret;\n\n\tif (IS_ERR_OR_NULL(qos) || !notifier)\n\t\treturn -EINVAL;\n\n\tswitch (type) {\n\tcase FREQ_QOS_MIN:\n\t\tret = blocking_notifier_chain_register(qos->min_freq.notifiers,\n\t\t\t\t\t\t       notifier);\n\t\tbreak;\n\tcase FREQ_QOS_MAX:\n\t\tret = blocking_notifier_chain_register(qos->max_freq.notifiers,\n\t\t\t\t\t\t       notifier);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON(1);\n\t\tret = -EINVAL;\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "freq_qos_remove_request",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "590-606",
    "snippet": "int freq_qos_remove_request(struct freq_qos_request *req)\n{\n\tint ret;\n\n\tif (!req)\n\t\treturn -EINVAL;\n\n\tif (WARN(!freq_qos_request_active(req),\n\t\t \"%s() called for unknown object\\n\", __func__))\n\t\treturn -EINVAL;\n\n\tret = freq_qos_apply(req, PM_QOS_REMOVE_REQ, PM_QOS_DEFAULT_VALUE);\n\treq->qos = NULL;\n\treq->type = 0;\n\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "freq_qos_apply",
          "args": [
            "req",
            "PM_QOS_REMOVE_REQ",
            "PM_QOS_DEFAULT_VALUE"
          ],
          "line": 601
        },
        "resolved": true,
        "details": {
          "function_name": "freq_qos_apply",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "493-512",
          "snippet": "int freq_qos_apply(struct freq_qos_request *req,\n\t\t\t  enum pm_qos_req_action action, s32 value)\n{\n\tint ret;\n\n\tswitch(req->type) {\n\tcase FREQ_QOS_MIN:\n\t\tret = pm_qos_update_target(&req->qos->min_freq, &req->pnode,\n\t\t\t\t\t   action, value);\n\t\tbreak;\n\tcase FREQ_QOS_MAX:\n\t\tret = pm_qos_update_target(&req->qos->max_freq, &req->pnode,\n\t\t\t\t\t   action, value);\n\t\tbreak;\n\tdefault:\n\t\tret = -EINVAL;\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nint freq_qos_apply(struct freq_qos_request *req,\n\t\t\t  enum pm_qos_req_action action, s32 value)\n{\n\tint ret;\n\n\tswitch(req->type) {\n\tcase FREQ_QOS_MIN:\n\t\tret = pm_qos_update_target(&req->qos->min_freq, &req->pnode,\n\t\t\t\t\t   action, value);\n\t\tbreak;\n\tcase FREQ_QOS_MAX:\n\t\tret = pm_qos_update_target(&req->qos->max_freq, &req->pnode,\n\t\t\t\t\t   action, value);\n\t\tbreak;\n\tdefault:\n\t\tret = -EINVAL;\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "!freq_qos_request_active(req)",
            "\"%s() called for unknown object\\n\"",
            "__func__"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "freq_qos_request_active",
          "args": [
            "req"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nint freq_qos_remove_request(struct freq_qos_request *req)\n{\n\tint ret;\n\n\tif (!req)\n\t\treturn -EINVAL;\n\n\tif (WARN(!freq_qos_request_active(req),\n\t\t \"%s() called for unknown object\\n\", __func__))\n\t\treturn -EINVAL;\n\n\tret = freq_qos_apply(req, PM_QOS_REMOVE_REQ, PM_QOS_DEFAULT_VALUE);\n\treq->qos = NULL;\n\treq->type = 0;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "freq_qos_update_request",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "564-577",
    "snippet": "int freq_qos_update_request(struct freq_qos_request *req, s32 new_value)\n{\n\tif (!req)\n\t\treturn -EINVAL;\n\n\tif (WARN(!freq_qos_request_active(req),\n\t\t \"%s() called for unknown object\\n\", __func__))\n\t\treturn -EINVAL;\n\n\tif (req->pnode.prio == new_value)\n\t\treturn 0;\n\n\treturn freq_qos_apply(req, PM_QOS_UPDATE_REQ, new_value);\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "freq_qos_apply",
          "args": [
            "req",
            "PM_QOS_UPDATE_REQ",
            "new_value"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "freq_qos_apply",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "493-512",
          "snippet": "int freq_qos_apply(struct freq_qos_request *req,\n\t\t\t  enum pm_qos_req_action action, s32 value)\n{\n\tint ret;\n\n\tswitch(req->type) {\n\tcase FREQ_QOS_MIN:\n\t\tret = pm_qos_update_target(&req->qos->min_freq, &req->pnode,\n\t\t\t\t\t   action, value);\n\t\tbreak;\n\tcase FREQ_QOS_MAX:\n\t\tret = pm_qos_update_target(&req->qos->max_freq, &req->pnode,\n\t\t\t\t\t   action, value);\n\t\tbreak;\n\tdefault:\n\t\tret = -EINVAL;\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nint freq_qos_apply(struct freq_qos_request *req,\n\t\t\t  enum pm_qos_req_action action, s32 value)\n{\n\tint ret;\n\n\tswitch(req->type) {\n\tcase FREQ_QOS_MIN:\n\t\tret = pm_qos_update_target(&req->qos->min_freq, &req->pnode,\n\t\t\t\t\t   action, value);\n\t\tbreak;\n\tcase FREQ_QOS_MAX:\n\t\tret = pm_qos_update_target(&req->qos->max_freq, &req->pnode,\n\t\t\t\t\t   action, value);\n\t\tbreak;\n\tdefault:\n\t\tret = -EINVAL;\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "!freq_qos_request_active(req)",
            "\"%s() called for unknown object\\n\"",
            "__func__"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "freq_qos_request_active",
          "args": [
            "req"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nint freq_qos_update_request(struct freq_qos_request *req, s32 new_value)\n{\n\tif (!req)\n\t\treturn -EINVAL;\n\n\tif (WARN(!freq_qos_request_active(req),\n\t\t \"%s() called for unknown object\\n\", __func__))\n\t\treturn -EINVAL;\n\n\tif (req->pnode.prio == new_value)\n\t\treturn 0;\n\n\treturn freq_qos_apply(req, PM_QOS_UPDATE_REQ, new_value);\n}"
  },
  {
    "function_name": "freq_qos_add_request",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "528-550",
    "snippet": "int freq_qos_add_request(struct freq_constraints *qos,\n\t\t\t struct freq_qos_request *req,\n\t\t\t enum freq_qos_req_type type, s32 value)\n{\n\tint ret;\n\n\tif (IS_ERR_OR_NULL(qos) || !req)\n\t\treturn -EINVAL;\n\n\tif (WARN(freq_qos_request_active(req),\n\t\t \"%s() called for active request\\n\", __func__))\n\t\treturn -EINVAL;\n\n\treq->qos = qos;\n\treq->type = type;\n\tret = freq_qos_apply(req, PM_QOS_ADD_REQ, value);\n\tif (ret < 0) {\n\t\treq->qos = NULL;\n\t\treq->type = 0;\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "freq_qos_apply",
          "args": [
            "req",
            "PM_QOS_ADD_REQ",
            "value"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "freq_qos_apply",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "493-512",
          "snippet": "int freq_qos_apply(struct freq_qos_request *req,\n\t\t\t  enum pm_qos_req_action action, s32 value)\n{\n\tint ret;\n\n\tswitch(req->type) {\n\tcase FREQ_QOS_MIN:\n\t\tret = pm_qos_update_target(&req->qos->min_freq, &req->pnode,\n\t\t\t\t\t   action, value);\n\t\tbreak;\n\tcase FREQ_QOS_MAX:\n\t\tret = pm_qos_update_target(&req->qos->max_freq, &req->pnode,\n\t\t\t\t\t   action, value);\n\t\tbreak;\n\tdefault:\n\t\tret = -EINVAL;\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nint freq_qos_apply(struct freq_qos_request *req,\n\t\t\t  enum pm_qos_req_action action, s32 value)\n{\n\tint ret;\n\n\tswitch(req->type) {\n\tcase FREQ_QOS_MIN:\n\t\tret = pm_qos_update_target(&req->qos->min_freq, &req->pnode,\n\t\t\t\t\t   action, value);\n\t\tbreak;\n\tcase FREQ_QOS_MAX:\n\t\tret = pm_qos_update_target(&req->qos->max_freq, &req->pnode,\n\t\t\t\t\t   action, value);\n\t\tbreak;\n\tdefault:\n\t\tret = -EINVAL;\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "freq_qos_request_active(req)",
            "\"%s() called for active request\\n\"",
            "__func__"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "freq_qos_request_active",
          "args": [
            "req"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR_OR_NULL",
          "args": [
            "qos"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nint freq_qos_add_request(struct freq_constraints *qos,\n\t\t\t struct freq_qos_request *req,\n\t\t\t enum freq_qos_req_type type, s32 value)\n{\n\tint ret;\n\n\tif (IS_ERR_OR_NULL(qos) || !req)\n\t\treturn -EINVAL;\n\n\tif (WARN(freq_qos_request_active(req),\n\t\t \"%s() called for active request\\n\", __func__))\n\t\treturn -EINVAL;\n\n\treq->qos = qos;\n\treq->type = type;\n\tret = freq_qos_apply(req, PM_QOS_ADD_REQ, value);\n\tif (ret < 0) {\n\t\treq->qos = NULL;\n\t\treq->type = 0;\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "freq_qos_apply",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "493-512",
    "snippet": "int freq_qos_apply(struct freq_qos_request *req,\n\t\t\t  enum pm_qos_req_action action, s32 value)\n{\n\tint ret;\n\n\tswitch(req->type) {\n\tcase FREQ_QOS_MIN:\n\t\tret = pm_qos_update_target(&req->qos->min_freq, &req->pnode,\n\t\t\t\t\t   action, value);\n\t\tbreak;\n\tcase FREQ_QOS_MAX:\n\t\tret = pm_qos_update_target(&req->qos->max_freq, &req->pnode,\n\t\t\t\t\t   action, value);\n\t\tbreak;\n\tdefault:\n\t\tret = -EINVAL;\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pm_qos_update_target",
          "args": [
            "&req->qos->max_freq",
            "&req->pnode",
            "action",
            "value"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_update_target",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "98-146",
          "snippet": "int pm_qos_update_target(struct pm_qos_constraints *c, struct plist_node *node,\n\t\t\t enum pm_qos_req_action action, int value)\n{\n\tint prev_value, curr_value, new_value;\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\n\tprev_value = pm_qos_get_value(c);\n\tif (value == PM_QOS_DEFAULT_VALUE)\n\t\tnew_value = c->default_value;\n\telse\n\t\tnew_value = value;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tplist_del(node, &c->list);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\t/*\n\t\t * To change the list, atomically remove, reinit with new value\n\t\t * and add, then see if the aggregate has changed.\n\t\t */\n\t\tplist_del(node, &c->list);\n\t\tfallthrough;\n\tcase PM_QOS_ADD_REQ:\n\t\tplist_node_init(node, new_value);\n\t\tplist_add(node, &c->list);\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = pm_qos_get_value(c);\n\tpm_qos_set_value(c, curr_value);\n\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\ttrace_pm_qos_update_target(action, prev_value, curr_value);\n\n\tif (prev_value == curr_value)\n\t\treturn 0;\n\n\tif (c->notifiers)\n\t\tblocking_notifier_call_chain(c->notifiers, curr_value, NULL);\n\n\treturn 1;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(pm_qos_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic DEFINE_SPINLOCK(pm_qos_lock);\n\nint pm_qos_update_target(struct pm_qos_constraints *c, struct plist_node *node,\n\t\t\t enum pm_qos_req_action action, int value)\n{\n\tint prev_value, curr_value, new_value;\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\n\tprev_value = pm_qos_get_value(c);\n\tif (value == PM_QOS_DEFAULT_VALUE)\n\t\tnew_value = c->default_value;\n\telse\n\t\tnew_value = value;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tplist_del(node, &c->list);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\t/*\n\t\t * To change the list, atomically remove, reinit with new value\n\t\t * and add, then see if the aggregate has changed.\n\t\t */\n\t\tplist_del(node, &c->list);\n\t\tfallthrough;\n\tcase PM_QOS_ADD_REQ:\n\t\tplist_node_init(node, new_value);\n\t\tplist_add(node, &c->list);\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = pm_qos_get_value(c);\n\tpm_qos_set_value(c, curr_value);\n\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\ttrace_pm_qos_update_target(action, prev_value, curr_value);\n\n\tif (prev_value == curr_value)\n\t\treturn 0;\n\n\tif (c->notifiers)\n\t\tblocking_notifier_call_chain(c->notifiers, curr_value, NULL);\n\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nint freq_qos_apply(struct freq_qos_request *req,\n\t\t\t  enum pm_qos_req_action action, s32 value)\n{\n\tint ret;\n\n\tswitch(req->type) {\n\tcase FREQ_QOS_MIN:\n\t\tret = pm_qos_update_target(&req->qos->min_freq, &req->pnode,\n\t\t\t\t\t   action, value);\n\t\tbreak;\n\tcase FREQ_QOS_MAX:\n\t\tret = pm_qos_update_target(&req->qos->max_freq, &req->pnode,\n\t\t\t\t\t   action, value);\n\t\tbreak;\n\tdefault:\n\t\tret = -EINVAL;\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "freq_qos_read_value",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "461-483",
    "snippet": "s32 freq_qos_read_value(struct freq_constraints *qos,\n\t\t\tenum freq_qos_req_type type)\n{\n\ts32 ret;\n\n\tswitch (type) {\n\tcase FREQ_QOS_MIN:\n\t\tret = IS_ERR_OR_NULL(qos) ?\n\t\t\tFREQ_QOS_MIN_DEFAULT_VALUE :\n\t\t\tpm_qos_read_value(&qos->min_freq);\n\t\tbreak;\n\tcase FREQ_QOS_MAX:\n\t\tret = IS_ERR_OR_NULL(qos) ?\n\t\t\tFREQ_QOS_MAX_DEFAULT_VALUE :\n\t\t\tpm_qos_read_value(&qos->max_freq);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON(1);\n\t\tret = 0;\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "1"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pm_qos_read_value",
          "args": [
            "&qos->max_freq"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_read_value",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "53-56",
          "snippet": "s32 pm_qos_read_value(struct pm_qos_constraints *c)\n{\n\treturn READ_ONCE(c->target_value);\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\ns32 pm_qos_read_value(struct pm_qos_constraints *c)\n{\n\treturn READ_ONCE(c->target_value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR_OR_NULL",
          "args": [
            "qos"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR_OR_NULL",
          "args": [
            "qos"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\ns32 freq_qos_read_value(struct freq_constraints *qos,\n\t\t\tenum freq_qos_req_type type)\n{\n\ts32 ret;\n\n\tswitch (type) {\n\tcase FREQ_QOS_MIN:\n\t\tret = IS_ERR_OR_NULL(qos) ?\n\t\t\tFREQ_QOS_MIN_DEFAULT_VALUE :\n\t\t\tpm_qos_read_value(&qos->min_freq);\n\t\tbreak;\n\tcase FREQ_QOS_MAX:\n\t\tret = IS_ERR_OR_NULL(qos) ?\n\t\t\tFREQ_QOS_MAX_DEFAULT_VALUE :\n\t\t\tpm_qos_read_value(&qos->max_freq);\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON(1);\n\t\tret = 0;\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "freq_constraints_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "433-454",
    "snippet": "void freq_constraints_init(struct freq_constraints *qos)\n{\n\tstruct pm_qos_constraints *c;\n\n\tc = &qos->min_freq;\n\tplist_head_init(&c->list);\n\tc->target_value = FREQ_QOS_MIN_DEFAULT_VALUE;\n\tc->default_value = FREQ_QOS_MIN_DEFAULT_VALUE;\n\tc->no_constraint_value = FREQ_QOS_MIN_DEFAULT_VALUE;\n\tc->type = PM_QOS_MAX;\n\tc->notifiers = &qos->min_freq_notifiers;\n\tBLOCKING_INIT_NOTIFIER_HEAD(c->notifiers);\n\n\tc = &qos->max_freq;\n\tplist_head_init(&c->list);\n\tc->target_value = FREQ_QOS_MAX_DEFAULT_VALUE;\n\tc->default_value = FREQ_QOS_MAX_DEFAULT_VALUE;\n\tc->no_constraint_value = FREQ_QOS_MAX_DEFAULT_VALUE;\n\tc->type = PM_QOS_MIN;\n\tc->notifiers = &qos->max_freq_notifiers;\n\tBLOCKING_INIT_NOTIFIER_HEAD(c->notifiers);\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BLOCKING_INIT_NOTIFIER_HEAD",
          "args": [
            "c->notifiers"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_head_init",
          "args": [
            "&c->list"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BLOCKING_INIT_NOTIFIER_HEAD",
          "args": [
            "c->notifiers"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_head_init",
          "args": [
            "&c->list"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nvoid freq_constraints_init(struct freq_constraints *qos)\n{\n\tstruct pm_qos_constraints *c;\n\n\tc = &qos->min_freq;\n\tplist_head_init(&c->list);\n\tc->target_value = FREQ_QOS_MIN_DEFAULT_VALUE;\n\tc->default_value = FREQ_QOS_MIN_DEFAULT_VALUE;\n\tc->no_constraint_value = FREQ_QOS_MIN_DEFAULT_VALUE;\n\tc->type = PM_QOS_MAX;\n\tc->notifiers = &qos->min_freq_notifiers;\n\tBLOCKING_INIT_NOTIFIER_HEAD(c->notifiers);\n\n\tc = &qos->max_freq;\n\tplist_head_init(&c->list);\n\tc->target_value = FREQ_QOS_MAX_DEFAULT_VALUE;\n\tc->default_value = FREQ_QOS_MAX_DEFAULT_VALUE;\n\tc->no_constraint_value = FREQ_QOS_MAX_DEFAULT_VALUE;\n\tc->type = PM_QOS_MIN;\n\tc->notifiers = &qos->max_freq_notifiers;\n\tBLOCKING_INIT_NOTIFIER_HEAD(c->notifiers);\n}"
  },
  {
    "function_name": "cpu_latency_qos_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "413-423",
    "snippet": "static int __init cpu_latency_qos_init(void)\n{\n\tint ret;\n\n\tret = misc_register(&cpu_latency_qos_miscdev);\n\tif (ret < 0)\n\t\tpr_err(\"%s: %s setup failed\\n\", __func__,\n\t\t       cpu_latency_qos_miscdev.name);\n\n\treturn ret;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"%s: %s setup failed\\n\"",
            "__func__",
            "cpu_latency_qos_miscdev.name"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "misc_register",
          "args": [
            "&cpu_latency_qos_miscdev"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic int __init cpu_latency_qos_init(void)\n{\n\tint ret;\n\n\tret = misc_register(&cpu_latency_qos_miscdev);\n\tif (ret < 0)\n\t\tpr_err(\"%s: %s setup failed\\n\", __func__,\n\t\t       cpu_latency_qos_miscdev.name);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "cpu_latency_qos_write",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "378-397",
    "snippet": "static ssize_t cpu_latency_qos_write(struct file *filp, const char __user *buf,\n\t\t\t\t     size_t count, loff_t *f_pos)\n{\n\ts32 value;\n\n\tif (count == sizeof(s32)) {\n\t\tif (copy_from_user(&value, buf, sizeof(s32)))\n\t\t\treturn -EFAULT;\n\t} else {\n\t\tint ret;\n\n\t\tret = kstrtos32_from_user(buf, count, 16, &value);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\n\tcpu_latency_qos_update_request(filp->private_data, value);\n\n\treturn count;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_latency_qos_update_request",
          "args": [
            "filp->private_data",
            "value"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_latency_qos_update_request",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "290-306",
          "snippet": "void cpu_latency_qos_update_request(struct pm_qos_request *req, s32 new_value)\n{\n\tif (!req)\n\t\treturn;\n\n\tif (!cpu_latency_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"%s called for unknown object\\n\", __func__);\n\t\treturn;\n\t}\n\n\ttrace_pm_qos_update_request(new_value);\n\n\tif (new_value == req->node.prio)\n\t\treturn;\n\n\tcpu_latency_qos_apply(req, PM_QOS_UPDATE_REQ, new_value);\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nvoid cpu_latency_qos_update_request(struct pm_qos_request *req, s32 new_value)\n{\n\tif (!req)\n\t\treturn;\n\n\tif (!cpu_latency_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"%s called for unknown object\\n\", __func__);\n\t\treturn;\n\t}\n\n\ttrace_pm_qos_update_request(new_value);\n\n\tif (new_value == req->node.prio)\n\t\treturn;\n\n\tcpu_latency_qos_apply(req, PM_QOS_UPDATE_REQ, new_value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstrtos32_from_user",
          "args": [
            "buf",
            "count",
            "16",
            "&value"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "&value",
            "buf",
            "sizeof(s32)"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic ssize_t cpu_latency_qos_write(struct file *filp, const char __user *buf,\n\t\t\t\t     size_t count, loff_t *f_pos)\n{\n\ts32 value;\n\n\tif (count == sizeof(s32)) {\n\t\tif (copy_from_user(&value, buf, sizeof(s32)))\n\t\t\treturn -EFAULT;\n\t} else {\n\t\tint ret;\n\n\t\tret = kstrtos32_from_user(buf, count, 16, &value);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\n\tcpu_latency_qos_update_request(filp->private_data, value);\n\n\treturn count;\n}"
  },
  {
    "function_name": "cpu_latency_qos_read",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "361-376",
    "snippet": "static ssize_t cpu_latency_qos_read(struct file *filp, char __user *buf,\n\t\t\t\t    size_t count, loff_t *f_pos)\n{\n\tstruct pm_qos_request *req = filp->private_data;\n\tunsigned long flags;\n\ts32 value;\n\n\tif (!req || !cpu_latency_qos_request_active(req))\n\t\treturn -EINVAL;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\tvalue = pm_qos_get_value(&cpu_latency_constraints);\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\treturn simple_read_from_buffer(buf, count, f_pos, &value, sizeof(s32));\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(pm_qos_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_read_from_buffer",
          "args": [
            "buf",
            "count",
            "f_pos",
            "&value",
            "sizeof(s32)"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&pm_qos_lock",
            "flags"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_qos_get_value",
          "args": [
            "&cpu_latency_constraints"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_get_value",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "58-74",
          "snippet": "static int pm_qos_get_value(struct pm_qos_constraints *c)\n{\n\tif (plist_head_empty(&c->list))\n\t\treturn c->no_constraint_value;\n\n\tswitch (c->type) {\n\tcase PM_QOS_MIN:\n\t\treturn plist_first(&c->list)->prio;\n\n\tcase PM_QOS_MAX:\n\t\treturn plist_last(&c->list)->prio;\n\n\tdefault:\n\t\tWARN(1, \"Unknown PM QoS type in %s\\n\", __func__);\n\t\treturn PM_QOS_DEFAULT_VALUE;\n\t}\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic int pm_qos_get_value(struct pm_qos_constraints *c)\n{\n\tif (plist_head_empty(&c->list))\n\t\treturn c->no_constraint_value;\n\n\tswitch (c->type) {\n\tcase PM_QOS_MIN:\n\t\treturn plist_first(&c->list)->prio;\n\n\tcase PM_QOS_MAX:\n\t\treturn plist_last(&c->list)->prio;\n\n\tdefault:\n\t\tWARN(1, \"Unknown PM QoS type in %s\\n\", __func__);\n\t\treturn PM_QOS_DEFAULT_VALUE;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&pm_qos_lock",
            "flags"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_latency_qos_request_active",
          "args": [
            "req"
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_latency_qos_request_active",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "238-241",
          "snippet": "bool cpu_latency_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->qos == &cpu_latency_constraints;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nbool cpu_latency_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->qos == &cpu_latency_constraints;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic DEFINE_SPINLOCK(pm_qos_lock);\n\nstatic ssize_t cpu_latency_qos_read(struct file *filp, char __user *buf,\n\t\t\t\t    size_t count, loff_t *f_pos)\n{\n\tstruct pm_qos_request *req = filp->private_data;\n\tunsigned long flags;\n\ts32 value;\n\n\tif (!req || !cpu_latency_qos_request_active(req))\n\t\treturn -EINVAL;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\tvalue = pm_qos_get_value(&cpu_latency_constraints);\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\treturn simple_read_from_buffer(buf, count, f_pos, &value, sizeof(s32));\n}"
  },
  {
    "function_name": "cpu_latency_qos_release",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "349-359",
    "snippet": "static int cpu_latency_qos_release(struct inode *inode, struct file *filp)\n{\n\tstruct pm_qos_request *req = filp->private_data;\n\n\tfilp->private_data = NULL;\n\n\tcpu_latency_qos_remove_request(req);\n\tkfree(req);\n\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "req"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/params.c",
          "lines": "62-75",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/security.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/security.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_latency_qos_remove_request",
          "args": [
            "req"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_latency_qos_remove_request",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "316-330",
          "snippet": "void cpu_latency_qos_remove_request(struct pm_qos_request *req)\n{\n\tif (!req)\n\t\treturn;\n\n\tif (!cpu_latency_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"%s called for unknown object\\n\", __func__);\n\t\treturn;\n\t}\n\n\ttrace_pm_qos_remove_request(PM_QOS_DEFAULT_VALUE);\n\n\tcpu_latency_qos_apply(req, PM_QOS_REMOVE_REQ, PM_QOS_DEFAULT_VALUE);\n\tmemset(req, 0, sizeof(*req));\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nvoid cpu_latency_qos_remove_request(struct pm_qos_request *req)\n{\n\tif (!req)\n\t\treturn;\n\n\tif (!cpu_latency_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"%s called for unknown object\\n\", __func__);\n\t\treturn;\n\t}\n\n\ttrace_pm_qos_remove_request(PM_QOS_DEFAULT_VALUE);\n\n\tcpu_latency_qos_apply(req, PM_QOS_REMOVE_REQ, PM_QOS_DEFAULT_VALUE);\n\tmemset(req, 0, sizeof(*req));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic int cpu_latency_qos_release(struct inode *inode, struct file *filp)\n{\n\tstruct pm_qos_request *req = filp->private_data;\n\n\tfilp->private_data = NULL;\n\n\tcpu_latency_qos_remove_request(req);\n\tkfree(req);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "cpu_latency_qos_open",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "335-347",
    "snippet": "static int cpu_latency_qos_open(struct inode *inode, struct file *filp)\n{\n\tstruct pm_qos_request *req;\n\n\treq = kzalloc(sizeof(*req), GFP_KERNEL);\n\tif (!req)\n\t\treturn -ENOMEM;\n\n\tcpu_latency_qos_add_request(req, PM_QOS_DEFAULT_VALUE);\n\tfilp->private_data = req;\n\n\treturn 0;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_latency_qos_add_request",
          "args": [
            "req",
            "PM_QOS_DEFAULT_VALUE"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_latency_qos_add_request",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "264-278",
          "snippet": "void cpu_latency_qos_add_request(struct pm_qos_request *req, s32 value)\n{\n\tif (!req)\n\t\treturn;\n\n\tif (cpu_latency_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"%s called for already added request\\n\", __func__);\n\t\treturn;\n\t}\n\n\ttrace_pm_qos_add_request(value);\n\n\treq->qos = &cpu_latency_constraints;\n\tcpu_latency_qos_apply(req, PM_QOS_ADD_REQ, value);\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nvoid cpu_latency_qos_add_request(struct pm_qos_request *req, s32 value)\n{\n\tif (!req)\n\t\treturn;\n\n\tif (cpu_latency_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"%s called for already added request\\n\", __func__);\n\t\treturn;\n\t}\n\n\ttrace_pm_qos_add_request(value);\n\n\treq->qos = &cpu_latency_constraints;\n\tcpu_latency_qos_apply(req, PM_QOS_ADD_REQ, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*req)",
            "GFP_KERNEL"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic int cpu_latency_qos_open(struct inode *inode, struct file *filp)\n{\n\tstruct pm_qos_request *req;\n\n\treq = kzalloc(sizeof(*req), GFP_KERNEL);\n\tif (!req)\n\t\treturn -ENOMEM;\n\n\tcpu_latency_qos_add_request(req, PM_QOS_DEFAULT_VALUE);\n\tfilp->private_data = req;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "cpu_latency_qos_remove_request",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "316-330",
    "snippet": "void cpu_latency_qos_remove_request(struct pm_qos_request *req)\n{\n\tif (!req)\n\t\treturn;\n\n\tif (!cpu_latency_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"%s called for unknown object\\n\", __func__);\n\t\treturn;\n\t}\n\n\ttrace_pm_qos_remove_request(PM_QOS_DEFAULT_VALUE);\n\n\tcpu_latency_qos_apply(req, PM_QOS_REMOVE_REQ, PM_QOS_DEFAULT_VALUE);\n\tmemset(req, 0, sizeof(*req));\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "req",
            "0",
            "sizeof(*req)"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_latency_qos_apply",
          "args": [
            "req",
            "PM_QOS_REMOVE_REQ",
            "PM_QOS_DEFAULT_VALUE"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_latency_qos_apply",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "244-250",
          "snippet": "static void cpu_latency_qos_apply(struct pm_qos_request *req,\n\t\t\t\t  enum pm_qos_req_action action, s32 value)\n{\n\tint ret = pm_qos_update_target(req->qos, &req->node, action, value);\n\tif (ret > 0)\n\t\twake_up_all_idle_cpus();\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic void cpu_latency_qos_apply(struct pm_qos_request *req,\n\t\t\t\t  enum pm_qos_req_action action, s32 value)\n{\n\tint ret = pm_qos_update_target(req->qos, &req->node, action, value);\n\tif (ret > 0)\n\t\twake_up_all_idle_cpus();\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_pm_qos_remove_request",
          "args": [
            "PM_QOS_DEFAULT_VALUE"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "1",
            "KERN_ERR \"%s called for unknown object\\n\"",
            "__func__"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_latency_qos_request_active",
          "args": [
            "req"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_latency_qos_request_active",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "238-241",
          "snippet": "bool cpu_latency_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->qos == &cpu_latency_constraints;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nbool cpu_latency_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->qos == &cpu_latency_constraints;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nvoid cpu_latency_qos_remove_request(struct pm_qos_request *req)\n{\n\tif (!req)\n\t\treturn;\n\n\tif (!cpu_latency_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"%s called for unknown object\\n\", __func__);\n\t\treturn;\n\t}\n\n\ttrace_pm_qos_remove_request(PM_QOS_DEFAULT_VALUE);\n\n\tcpu_latency_qos_apply(req, PM_QOS_REMOVE_REQ, PM_QOS_DEFAULT_VALUE);\n\tmemset(req, 0, sizeof(*req));\n}"
  },
  {
    "function_name": "cpu_latency_qos_update_request",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "290-306",
    "snippet": "void cpu_latency_qos_update_request(struct pm_qos_request *req, s32 new_value)\n{\n\tif (!req)\n\t\treturn;\n\n\tif (!cpu_latency_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"%s called for unknown object\\n\", __func__);\n\t\treturn;\n\t}\n\n\ttrace_pm_qos_update_request(new_value);\n\n\tif (new_value == req->node.prio)\n\t\treturn;\n\n\tcpu_latency_qos_apply(req, PM_QOS_UPDATE_REQ, new_value);\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_latency_qos_apply",
          "args": [
            "req",
            "PM_QOS_UPDATE_REQ",
            "new_value"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_latency_qos_apply",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "244-250",
          "snippet": "static void cpu_latency_qos_apply(struct pm_qos_request *req,\n\t\t\t\t  enum pm_qos_req_action action, s32 value)\n{\n\tint ret = pm_qos_update_target(req->qos, &req->node, action, value);\n\tif (ret > 0)\n\t\twake_up_all_idle_cpus();\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic void cpu_latency_qos_apply(struct pm_qos_request *req,\n\t\t\t\t  enum pm_qos_req_action action, s32 value)\n{\n\tint ret = pm_qos_update_target(req->qos, &req->node, action, value);\n\tif (ret > 0)\n\t\twake_up_all_idle_cpus();\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_pm_qos_update_request",
          "args": [
            "new_value"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "1",
            "KERN_ERR \"%s called for unknown object\\n\"",
            "__func__"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_latency_qos_request_active",
          "args": [
            "req"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_latency_qos_request_active",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "238-241",
          "snippet": "bool cpu_latency_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->qos == &cpu_latency_constraints;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nbool cpu_latency_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->qos == &cpu_latency_constraints;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nvoid cpu_latency_qos_update_request(struct pm_qos_request *req, s32 new_value)\n{\n\tif (!req)\n\t\treturn;\n\n\tif (!cpu_latency_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"%s called for unknown object\\n\", __func__);\n\t\treturn;\n\t}\n\n\ttrace_pm_qos_update_request(new_value);\n\n\tif (new_value == req->node.prio)\n\t\treturn;\n\n\tcpu_latency_qos_apply(req, PM_QOS_UPDATE_REQ, new_value);\n}"
  },
  {
    "function_name": "cpu_latency_qos_add_request",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "264-278",
    "snippet": "void cpu_latency_qos_add_request(struct pm_qos_request *req, s32 value)\n{\n\tif (!req)\n\t\treturn;\n\n\tif (cpu_latency_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"%s called for already added request\\n\", __func__);\n\t\treturn;\n\t}\n\n\ttrace_pm_qos_add_request(value);\n\n\treq->qos = &cpu_latency_constraints;\n\tcpu_latency_qos_apply(req, PM_QOS_ADD_REQ, value);\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_latency_qos_apply",
          "args": [
            "req",
            "PM_QOS_ADD_REQ",
            "value"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_latency_qos_apply",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "244-250",
          "snippet": "static void cpu_latency_qos_apply(struct pm_qos_request *req,\n\t\t\t\t  enum pm_qos_req_action action, s32 value)\n{\n\tint ret = pm_qos_update_target(req->qos, &req->node, action, value);\n\tif (ret > 0)\n\t\twake_up_all_idle_cpus();\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic void cpu_latency_qos_apply(struct pm_qos_request *req,\n\t\t\t\t  enum pm_qos_req_action action, s32 value)\n{\n\tint ret = pm_qos_update_target(req->qos, &req->node, action, value);\n\tif (ret > 0)\n\t\twake_up_all_idle_cpus();\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_pm_qos_add_request",
          "args": [
            "value"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "1",
            "KERN_ERR \"%s called for already added request\\n\"",
            "__func__"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_latency_qos_request_active",
          "args": [
            "req"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_latency_qos_request_active",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "238-241",
          "snippet": "bool cpu_latency_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->qos == &cpu_latency_constraints;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nbool cpu_latency_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->qos == &cpu_latency_constraints;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nvoid cpu_latency_qos_add_request(struct pm_qos_request *req, s32 value)\n{\n\tif (!req)\n\t\treturn;\n\n\tif (cpu_latency_qos_request_active(req)) {\n\t\tWARN(1, KERN_ERR \"%s called for already added request\\n\", __func__);\n\t\treturn;\n\t}\n\n\ttrace_pm_qos_add_request(value);\n\n\treq->qos = &cpu_latency_constraints;\n\tcpu_latency_qos_apply(req, PM_QOS_ADD_REQ, value);\n}"
  },
  {
    "function_name": "cpu_latency_qos_apply",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "244-250",
    "snippet": "static void cpu_latency_qos_apply(struct pm_qos_request *req,\n\t\t\t\t  enum pm_qos_req_action action, s32 value)\n{\n\tint ret = pm_qos_update_target(req->qos, &req->node, action, value);\n\tif (ret > 0)\n\t\twake_up_all_idle_cpus();\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up_all_idle_cpus",
          "args": [],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "wake_up_all_idle_cpus",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/smp.c",
          "lines": "1169-1179",
          "snippet": "void wake_up_all_idle_cpus(void)\n{\n\tint cpu;\n\n\tfor_each_possible_cpu(cpu) {\n\t\tpreempt_disable();\n\t\tif (cpu != smp_processor_id() && cpu_online(cpu))\n\t\t\twake_up_if_idle(cpu);\n\t\tpreempt_enable();\n\t}\n}",
          "includes": [
            "#include \"sched/smp.h\"",
            "#include \"smpboot.h\"",
            "#include <linux/jump_label.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/nmi.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/hypervisor.h>",
            "#include <linux/sched/idle.h>",
            "#include <linux/sched.h>",
            "#include <linux/cpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/gfp.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/rculist.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/irq_work.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched/smp.h\"\n#include \"smpboot.h\"\n#include <linux/jump_label.h>\n#include <linux/sched/debug.h>\n#include <linux/nmi.h>\n#include <linux/sched/clock.h>\n#include <linux/hypervisor.h>\n#include <linux/sched/idle.h>\n#include <linux/sched.h>\n#include <linux/cpu.h>\n#include <linux/smp.h>\n#include <linux/gfp.h>\n#include <linux/interrupt.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rculist.h>\n#include <linux/rcupdate.h>\n#include <linux/irq_work.h>\n\nvoid wake_up_all_idle_cpus(void)\n{\n\tint cpu;\n\n\tfor_each_possible_cpu(cpu) {\n\t\tpreempt_disable();\n\t\tif (cpu != smp_processor_id() && cpu_online(cpu))\n\t\t\twake_up_if_idle(cpu);\n\t\tpreempt_enable();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_qos_update_target",
          "args": [
            "req->qos",
            "&req->node",
            "action",
            "value"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_update_target",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "98-146",
          "snippet": "int pm_qos_update_target(struct pm_qos_constraints *c, struct plist_node *node,\n\t\t\t enum pm_qos_req_action action, int value)\n{\n\tint prev_value, curr_value, new_value;\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\n\tprev_value = pm_qos_get_value(c);\n\tif (value == PM_QOS_DEFAULT_VALUE)\n\t\tnew_value = c->default_value;\n\telse\n\t\tnew_value = value;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tplist_del(node, &c->list);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\t/*\n\t\t * To change the list, atomically remove, reinit with new value\n\t\t * and add, then see if the aggregate has changed.\n\t\t */\n\t\tplist_del(node, &c->list);\n\t\tfallthrough;\n\tcase PM_QOS_ADD_REQ:\n\t\tplist_node_init(node, new_value);\n\t\tplist_add(node, &c->list);\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = pm_qos_get_value(c);\n\tpm_qos_set_value(c, curr_value);\n\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\ttrace_pm_qos_update_target(action, prev_value, curr_value);\n\n\tif (prev_value == curr_value)\n\t\treturn 0;\n\n\tif (c->notifiers)\n\t\tblocking_notifier_call_chain(c->notifiers, curr_value, NULL);\n\n\treturn 1;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(pm_qos_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic DEFINE_SPINLOCK(pm_qos_lock);\n\nint pm_qos_update_target(struct pm_qos_constraints *c, struct plist_node *node,\n\t\t\t enum pm_qos_req_action action, int value)\n{\n\tint prev_value, curr_value, new_value;\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\n\tprev_value = pm_qos_get_value(c);\n\tif (value == PM_QOS_DEFAULT_VALUE)\n\t\tnew_value = c->default_value;\n\telse\n\t\tnew_value = value;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tplist_del(node, &c->list);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\t/*\n\t\t * To change the list, atomically remove, reinit with new value\n\t\t * and add, then see if the aggregate has changed.\n\t\t */\n\t\tplist_del(node, &c->list);\n\t\tfallthrough;\n\tcase PM_QOS_ADD_REQ:\n\t\tplist_node_init(node, new_value);\n\t\tplist_add(node, &c->list);\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = pm_qos_get_value(c);\n\tpm_qos_set_value(c, curr_value);\n\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\ttrace_pm_qos_update_target(action, prev_value, curr_value);\n\n\tif (prev_value == curr_value)\n\t\treturn 0;\n\n\tif (c->notifiers)\n\t\tblocking_notifier_call_chain(c->notifiers, curr_value, NULL);\n\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic void cpu_latency_qos_apply(struct pm_qos_request *req,\n\t\t\t\t  enum pm_qos_req_action action, s32 value)\n{\n\tint ret = pm_qos_update_target(req->qos, &req->node, action, value);\n\tif (ret > 0)\n\t\twake_up_all_idle_cpus();\n}"
  },
  {
    "function_name": "cpu_latency_qos_request_active",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "238-241",
    "snippet": "bool cpu_latency_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->qos == &cpu_latency_constraints;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nbool cpu_latency_qos_request_active(struct pm_qos_request *req)\n{\n\treturn req->qos == &cpu_latency_constraints;\n}"
  },
  {
    "function_name": "cpu_latency_qos_limit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "226-229",
    "snippet": "s32 cpu_latency_qos_limit(void)\n{\n\treturn pm_qos_read_value(&cpu_latency_constraints);\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pm_qos_read_value",
          "args": [
            "&cpu_latency_constraints"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_read_value",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "53-56",
          "snippet": "s32 pm_qos_read_value(struct pm_qos_constraints *c)\n{\n\treturn READ_ONCE(c->target_value);\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\ns32 pm_qos_read_value(struct pm_qos_constraints *c)\n{\n\treturn READ_ONCE(c->target_value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\ns32 cpu_latency_qos_limit(void)\n{\n\treturn pm_qos_read_value(&cpu_latency_constraints);\n}"
  },
  {
    "function_name": "pm_qos_update_flags",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "174-210",
    "snippet": "bool pm_qos_update_flags(struct pm_qos_flags *pqf,\n\t\t\t struct pm_qos_flags_request *req,\n\t\t\t enum pm_qos_req_action action, s32 val)\n{\n\tunsigned long irqflags;\n\ts32 prev_value, curr_value;\n\n\tspin_lock_irqsave(&pm_qos_lock, irqflags);\n\n\tprev_value = list_empty(&pqf->list) ? 0 : pqf->effective_flags;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tpm_qos_flags_remove_req(pqf, req);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\tpm_qos_flags_remove_req(pqf, req);\n\t\tfallthrough;\n\tcase PM_QOS_ADD_REQ:\n\t\treq->flags = val;\n\t\tINIT_LIST_HEAD(&req->node);\n\t\tlist_add_tail(&req->node, &pqf->list);\n\t\tpqf->effective_flags |= val;\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = list_empty(&pqf->list) ? 0 : pqf->effective_flags;\n\n\tspin_unlock_irqrestore(&pm_qos_lock, irqflags);\n\n\ttrace_pm_qos_update_flags(action, prev_value, curr_value);\n\n\treturn prev_value != curr_value;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(pm_qos_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_pm_qos_update_flags",
          "args": [
            "action",
            "prev_value",
            "curr_value"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&pm_qos_lock",
            "irqflags"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&pqf->list"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_empty",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "41-44",
          "snippet": "static inline bool rcu_segcblist_empty(struct rcu_segcblist *rsclp)\n{\n\treturn !READ_ONCE(rsclp->head);\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_empty(struct rcu_segcblist *rsclp)\n{\n\treturn !READ_ONCE(rsclp->head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&req->node",
            "&pqf->list"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&req->node"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pm_qos_flags_remove_req",
          "args": [
            "pqf",
            "req"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_flags_remove_req",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "153-163",
          "snippet": "static void pm_qos_flags_remove_req(struct pm_qos_flags *pqf,\n\t\t\t\t    struct pm_qos_flags_request *req)\n{\n\ts32 val = 0;\n\n\tlist_del(&req->node);\n\tlist_for_each_entry(req, &pqf->list, node)\n\t\tval |= req->flags;\n\n\tpqf->effective_flags = val;\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic void pm_qos_flags_remove_req(struct pm_qos_flags *pqf,\n\t\t\t\t    struct pm_qos_flags_request *req)\n{\n\ts32 val = 0;\n\n\tlist_del(&req->node);\n\tlist_for_each_entry(req, &pqf->list, node)\n\t\tval |= req->flags;\n\n\tpqf->effective_flags = val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&pm_qos_lock",
            "irqflags"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic DEFINE_SPINLOCK(pm_qos_lock);\n\nbool pm_qos_update_flags(struct pm_qos_flags *pqf,\n\t\t\t struct pm_qos_flags_request *req,\n\t\t\t enum pm_qos_req_action action, s32 val)\n{\n\tunsigned long irqflags;\n\ts32 prev_value, curr_value;\n\n\tspin_lock_irqsave(&pm_qos_lock, irqflags);\n\n\tprev_value = list_empty(&pqf->list) ? 0 : pqf->effective_flags;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tpm_qos_flags_remove_req(pqf, req);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\tpm_qos_flags_remove_req(pqf, req);\n\t\tfallthrough;\n\tcase PM_QOS_ADD_REQ:\n\t\treq->flags = val;\n\t\tINIT_LIST_HEAD(&req->node);\n\t\tlist_add_tail(&req->node, &pqf->list);\n\t\tpqf->effective_flags |= val;\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = list_empty(&pqf->list) ? 0 : pqf->effective_flags;\n\n\tspin_unlock_irqrestore(&pm_qos_lock, irqflags);\n\n\ttrace_pm_qos_update_flags(action, prev_value, curr_value);\n\n\treturn prev_value != curr_value;\n}"
  },
  {
    "function_name": "pm_qos_flags_remove_req",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "153-163",
    "snippet": "static void pm_qos_flags_remove_req(struct pm_qos_flags *pqf,\n\t\t\t\t    struct pm_qos_flags_request *req)\n{\n\ts32 val = 0;\n\n\tlist_del(&req->node);\n\tlist_for_each_entry(req, &pqf->list, node)\n\t\tval |= req->flags;\n\n\tpqf->effective_flags = val;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "req",
            "&pqf->list",
            "node"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&req->node"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "list_del_leaf_cfs_rq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/fair.c",
          "lines": "475-477",
          "snippet": "static inline void list_del_leaf_cfs_rq(struct cfs_rq *cfs_rq)\n{\n}",
          "includes": [
            "#include \"pelt.h\"",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool sched_idle_cfs_rq(struct cfs_rq *cfs_rq);",
            "static void check_enqueue_throttle(struct cfs_rq *cfs_rq);",
            "static __always_inline void return_cfs_rq_runtime(struct cfs_rq *cfs_rq);",
            "static bool check_cfs_rq_runtime(struct cfs_rq *cfs_rq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pelt.h\"\n#include \"sched.h\"\n\nstatic bool sched_idle_cfs_rq(struct cfs_rq *cfs_rq);\nstatic void check_enqueue_throttle(struct cfs_rq *cfs_rq);\nstatic __always_inline void return_cfs_rq_runtime(struct cfs_rq *cfs_rq);\nstatic bool check_cfs_rq_runtime(struct cfs_rq *cfs_rq);\n\nstatic inline void list_del_leaf_cfs_rq(struct cfs_rq *cfs_rq)\n{\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic void pm_qos_flags_remove_req(struct pm_qos_flags *pqf,\n\t\t\t\t    struct pm_qos_flags_request *req)\n{\n\ts32 val = 0;\n\n\tlist_del(&req->node);\n\tlist_for_each_entry(req, &pqf->list, node)\n\t\tval |= req->flags;\n\n\tpqf->effective_flags = val;\n}"
  },
  {
    "function_name": "pm_qos_update_target",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "98-146",
    "snippet": "int pm_qos_update_target(struct pm_qos_constraints *c, struct plist_node *node,\n\t\t\t enum pm_qos_req_action action, int value)\n{\n\tint prev_value, curr_value, new_value;\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\n\tprev_value = pm_qos_get_value(c);\n\tif (value == PM_QOS_DEFAULT_VALUE)\n\t\tnew_value = c->default_value;\n\telse\n\t\tnew_value = value;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tplist_del(node, &c->list);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\t/*\n\t\t * To change the list, atomically remove, reinit with new value\n\t\t * and add, then see if the aggregate has changed.\n\t\t */\n\t\tplist_del(node, &c->list);\n\t\tfallthrough;\n\tcase PM_QOS_ADD_REQ:\n\t\tplist_node_init(node, new_value);\n\t\tplist_add(node, &c->list);\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = pm_qos_get_value(c);\n\tpm_qos_set_value(c, curr_value);\n\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\ttrace_pm_qos_update_target(action, prev_value, curr_value);\n\n\tif (prev_value == curr_value)\n\t\treturn 0;\n\n\tif (c->notifiers)\n\t\tblocking_notifier_call_chain(c->notifiers, curr_value, NULL);\n\n\treturn 1;\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(pm_qos_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "blocking_notifier_call_chain",
          "args": [
            "c->notifiers",
            "curr_value",
            "NULL"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "blocking_notifier_call_chain",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/notifier.c",
          "lines": "307-323",
          "snippet": "int blocking_notifier_call_chain(struct blocking_notifier_head *nh,\n\t\tunsigned long val, void *v)\n{\n\tint ret = NOTIFY_DONE;\n\n\t/*\n\t * We check the head outside the lock, but if this access is\n\t * racy then it does not matter what the result of the test\n\t * is, we re-check the list after having taken the lock anyway:\n\t */\n\tif (rcu_access_pointer(nh->head)) {\n\t\tdown_read(&nh->rwsem);\n\t\tret = notifier_call_chain(&nh->head, val, v, -1, NULL);\n\t\tup_read(&nh->rwsem);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include <linux/reboot.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/notifier.h>",
            "#include <linux/export.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kdebug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/reboot.h>\n#include <linux/vmalloc.h>\n#include <linux/rcupdate.h>\n#include <linux/notifier.h>\n#include <linux/export.h>\n#include <linux/kprobes.h>\n#include <linux/kdebug.h>\n\nint blocking_notifier_call_chain(struct blocking_notifier_head *nh,\n\t\tunsigned long val, void *v)\n{\n\tint ret = NOTIFY_DONE;\n\n\t/*\n\t * We check the head outside the lock, but if this access is\n\t * racy then it does not matter what the result of the test\n\t * is, we re-check the list after having taken the lock anyway:\n\t */\n\tif (rcu_access_pointer(nh->head)) {\n\t\tdown_read(&nh->rwsem);\n\t\tret = notifier_call_chain(&nh->head, val, v, -1, NULL);\n\t\tup_read(&nh->rwsem);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_pm_qos_update_target",
          "args": [
            "action",
            "prev_value",
            "curr_value"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&pm_qos_lock",
            "flags"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_qos_set_value",
          "args": [
            "c",
            "curr_value"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_set_value",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "76-79",
          "snippet": "static void pm_qos_set_value(struct pm_qos_constraints *c, s32 value)\n{\n\tWRITE_ONCE(c->target_value, value);\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic void pm_qos_set_value(struct pm_qos_constraints *c, s32 value)\n{\n\tWRITE_ONCE(c->target_value, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_qos_get_value",
          "args": [
            "c"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "pm_qos_get_value",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
          "lines": "58-74",
          "snippet": "static int pm_qos_get_value(struct pm_qos_constraints *c)\n{\n\tif (plist_head_empty(&c->list))\n\t\treturn c->no_constraint_value;\n\n\tswitch (c->type) {\n\tcase PM_QOS_MIN:\n\t\treturn plist_first(&c->list)->prio;\n\n\tcase PM_QOS_MAX:\n\t\treturn plist_last(&c->list)->prio;\n\n\tdefault:\n\t\tWARN(1, \"Unknown PM QoS type in %s\\n\", __func__);\n\t\treturn PM_QOS_DEFAULT_VALUE;\n\t}\n}",
          "includes": [
            "#include <trace/events/power.h>",
            "#include <linux/export.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/platform_device.h>",
            "#include <linux/string.h>",
            "#include <linux/miscdevice.h>",
            "#include <linux/device.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/pm_qos.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic int pm_qos_get_value(struct pm_qos_constraints *c)\n{\n\tif (plist_head_empty(&c->list))\n\t\treturn c->no_constraint_value;\n\n\tswitch (c->type) {\n\tcase PM_QOS_MIN:\n\t\treturn plist_first(&c->list)->prio;\n\n\tcase PM_QOS_MAX:\n\t\treturn plist_last(&c->list)->prio;\n\n\tdefault:\n\t\tWARN(1, \"Unknown PM QoS type in %s\\n\", __func__);\n\t\treturn PM_QOS_DEFAULT_VALUE;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "plist_add",
          "args": [
            "node",
            "&c->list"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_node_init",
          "args": [
            "node",
            "new_value"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_del",
          "args": [
            "node",
            "&c->list"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_del",
          "args": [
            "node",
            "&c->list"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&pm_qos_lock",
            "flags"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic DEFINE_SPINLOCK(pm_qos_lock);\n\nint pm_qos_update_target(struct pm_qos_constraints *c, struct plist_node *node,\n\t\t\t enum pm_qos_req_action action, int value)\n{\n\tint prev_value, curr_value, new_value;\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&pm_qos_lock, flags);\n\n\tprev_value = pm_qos_get_value(c);\n\tif (value == PM_QOS_DEFAULT_VALUE)\n\t\tnew_value = c->default_value;\n\telse\n\t\tnew_value = value;\n\n\tswitch (action) {\n\tcase PM_QOS_REMOVE_REQ:\n\t\tplist_del(node, &c->list);\n\t\tbreak;\n\tcase PM_QOS_UPDATE_REQ:\n\t\t/*\n\t\t * To change the list, atomically remove, reinit with new value\n\t\t * and add, then see if the aggregate has changed.\n\t\t */\n\t\tplist_del(node, &c->list);\n\t\tfallthrough;\n\tcase PM_QOS_ADD_REQ:\n\t\tplist_node_init(node, new_value);\n\t\tplist_add(node, &c->list);\n\t\tbreak;\n\tdefault:\n\t\t/* no action */\n\t\t;\n\t}\n\n\tcurr_value = pm_qos_get_value(c);\n\tpm_qos_set_value(c, curr_value);\n\n\tspin_unlock_irqrestore(&pm_qos_lock, flags);\n\n\ttrace_pm_qos_update_target(action, prev_value, curr_value);\n\n\tif (prev_value == curr_value)\n\t\treturn 0;\n\n\tif (c->notifiers)\n\t\tblocking_notifier_call_chain(c->notifiers, curr_value, NULL);\n\n\treturn 1;\n}"
  },
  {
    "function_name": "pm_qos_set_value",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "76-79",
    "snippet": "static void pm_qos_set_value(struct pm_qos_constraints *c, s32 value)\n{\n\tWRITE_ONCE(c->target_value, value);\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "c->target_value",
            "value"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic void pm_qos_set_value(struct pm_qos_constraints *c, s32 value)\n{\n\tWRITE_ONCE(c->target_value, value);\n}"
  },
  {
    "function_name": "pm_qos_get_value",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "58-74",
    "snippet": "static int pm_qos_get_value(struct pm_qos_constraints *c)\n{\n\tif (plist_head_empty(&c->list))\n\t\treturn c->no_constraint_value;\n\n\tswitch (c->type) {\n\tcase PM_QOS_MIN:\n\t\treturn plist_first(&c->list)->prio;\n\n\tcase PM_QOS_MAX:\n\t\treturn plist_last(&c->list)->prio;\n\n\tdefault:\n\t\tWARN(1, \"Unknown PM QoS type in %s\\n\", __func__);\n\t\treturn PM_QOS_DEFAULT_VALUE;\n\t}\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "1",
            "\"Unknown PM QoS type in %s\\n\"",
            "__func__"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_last",
          "args": [
            "&c->list"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_first",
          "args": [
            "&c->list"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plist_head_empty",
          "args": [
            "&c->list"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\nstatic int pm_qos_get_value(struct pm_qos_constraints *c)\n{\n\tif (plist_head_empty(&c->list))\n\t\treturn c->no_constraint_value;\n\n\tswitch (c->type) {\n\tcase PM_QOS_MIN:\n\t\treturn plist_first(&c->list)->prio;\n\n\tcase PM_QOS_MAX:\n\t\treturn plist_last(&c->list)->prio;\n\n\tdefault:\n\t\tWARN(1, \"Unknown PM QoS type in %s\\n\", __func__);\n\t\treturn PM_QOS_DEFAULT_VALUE;\n\t}\n}"
  },
  {
    "function_name": "pm_qos_read_value",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/qos.c",
    "lines": "53-56",
    "snippet": "s32 pm_qos_read_value(struct pm_qos_constraints *c)\n{\n\treturn READ_ONCE(c->target_value);\n}",
    "includes": [
      "#include <trace/events/power.h>",
      "#include <linux/export.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/platform_device.h>",
      "#include <linux/string.h>",
      "#include <linux/miscdevice.h>",
      "#include <linux/device.h>",
      "#include <linux/fs.h>",
      "#include <linux/time.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/sched.h>",
      "#include <linux/pm_qos.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "c->target_value"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <trace/events/power.h>\n#include <linux/export.h>\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/platform_device.h>\n#include <linux/string.h>\n#include <linux/miscdevice.h>\n#include <linux/device.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/pm_qos.h>\n\ns32 pm_qos_read_value(struct pm_qos_constraints *c)\n{\n\treturn READ_ONCE(c->target_value);\n}"
  }
]