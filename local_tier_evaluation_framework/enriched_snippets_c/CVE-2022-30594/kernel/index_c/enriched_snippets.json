[
  {
    "function_name": "pi_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
    "lines": "182-191",
    "snippet": "static int __init pi_init(void)\n{\n\tstruct dentry *dfs_root = debugfs_create_dir(\"printk\", NULL);\n\n\tdfs_index = debugfs_create_dir(\"index\", dfs_root);\n\tpi_setup_module_notifier();\n\tpi_create_file(NULL);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/string_helpers.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/debugfs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct dentry *dfs_index;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pi_create_file",
          "args": [
            "NULL"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "pi_create_file",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
          "lines": "139-143",
          "snippet": "static void pi_create_file(struct module *mod)\n{\n\tdebugfs_create_file(pi_get_module_name(mod), 0444, dfs_index,\n\t\t\t\t       mod, &dfs_index_fops);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/string_helpers.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/debugfs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct dentry *dfs_index;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic struct dentry *dfs_index;\n\nstatic void pi_create_file(struct module *mod)\n{\n\tdebugfs_create_file(pi_get_module_name(mod), 0444, dfs_index,\n\t\t\t\t       mod, &dfs_index_fops);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pi_setup_module_notifier",
          "args": [],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "pi_setup_module_notifier",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
          "lines": "179-179",
          "snippet": "static inline void __init pi_setup_module_notifier(void) { }",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/string_helpers.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/debugfs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic inline void __init pi_setup_module_notifier(void) { }"
        }
      },
      {
        "call_info": {
          "callee": "debugfs_create_dir",
          "args": [
            "\"index\"",
            "dfs_root"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_dir",
          "args": [
            "\"printk\"",
            "NULL"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic struct dentry *dfs_index;\n\nstatic int __init pi_init(void)\n{\n\tstruct dentry *dfs_root = debugfs_create_dir(\"printk\", NULL);\n\n\tdfs_index = debugfs_create_dir(\"index\", dfs_root);\n\tpi_setup_module_notifier();\n\tpi_create_file(NULL);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "pi_setup_module_notifier",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
    "lines": "179-179",
    "snippet": "static inline void __init pi_setup_module_notifier(void) { }",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/string_helpers.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/debugfs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic inline void __init pi_setup_module_notifier(void) { }"
  },
  {
    "function_name": "pi_setup_module_notifier",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
    "lines": "174-177",
    "snippet": "static void __init pi_setup_module_notifier(void)\n{\n\tregister_module_notifier(&module_printk_fmts_nb);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/string_helpers.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/debugfs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_module_notifier",
          "args": [
            "&module_printk_fmts_nb"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_module_notifier",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/module.c",
          "lines": "307-310",
          "snippet": "int unregister_module_notifier(struct notifier_block *nb)\n{\n\treturn blocking_notifier_chain_unregister(&module_notify_list, nb);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel_read_file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/buildid.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/module_signature.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static BLOCKING_NOTIFIER_HEAD(module_notify_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel_read_file.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/buildid.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/module_signature.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic BLOCKING_NOTIFIER_HEAD(module_notify_list);\n\nint unregister_module_notifier(struct notifier_block *nb)\n{\n\treturn blocking_notifier_chain_unregister(&module_notify_list, nb);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic void __init pi_setup_module_notifier(void)\n{\n\tregister_module_notifier(&module_printk_fmts_nb);\n}"
  },
  {
    "function_name": "pi_module_notify",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
    "lines": "151-168",
    "snippet": "static int pi_module_notify(struct notifier_block *nb, unsigned long op,\n\t\t\t    void *data)\n{\n\tstruct module *mod = data;\n\n\tswitch (op) {\n\tcase MODULE_STATE_COMING:\n\t\tpi_create_file(mod);\n\t\tbreak;\n\tcase MODULE_STATE_GOING:\n\t\tpi_remove_file(mod);\n\t\tbreak;\n\tdefault: /* we don't care about other module states */\n\t\tbreak;\n\t}\n\n\treturn NOTIFY_OK;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/string_helpers.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/debugfs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pi_remove_file",
          "args": [
            "mod"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "pi_remove_file",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
          "lines": "146-149",
          "snippet": "static void pi_remove_file(struct module *mod)\n{\n\tdebugfs_remove(debugfs_lookup(pi_get_module_name(mod), dfs_index));\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/string_helpers.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/debugfs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct dentry *dfs_index;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic struct dentry *dfs_index;\n\nstatic void pi_remove_file(struct module *mod)\n{\n\tdebugfs_remove(debugfs_lookup(pi_get_module_name(mod), dfs_index));\n}"
        }
      },
      {
        "call_info": {
          "callee": "pi_create_file",
          "args": [
            "mod"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "pi_create_file",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
          "lines": "139-143",
          "snippet": "static void pi_create_file(struct module *mod)\n{\n\tdebugfs_create_file(pi_get_module_name(mod), 0444, dfs_index,\n\t\t\t\t       mod, &dfs_index_fops);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/string_helpers.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/debugfs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct dentry *dfs_index;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic struct dentry *dfs_index;\n\nstatic void pi_create_file(struct module *mod)\n{\n\tdebugfs_create_file(pi_get_module_name(mod), 0444, dfs_index,\n\t\t\t\t       mod, &dfs_index_fops);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic int pi_module_notify(struct notifier_block *nb, unsigned long op,\n\t\t\t    void *data)\n{\n\tstruct module *mod = data;\n\n\tswitch (op) {\n\tcase MODULE_STATE_COMING:\n\t\tpi_create_file(mod);\n\t\tbreak;\n\tcase MODULE_STATE_GOING:\n\t\tpi_remove_file(mod);\n\t\tbreak;\n\tdefault: /* we don't care about other module states */\n\t\tbreak;\n\t}\n\n\treturn NOTIFY_OK;\n}"
  },
  {
    "function_name": "pi_remove_file",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
    "lines": "146-149",
    "snippet": "static void pi_remove_file(struct module *mod)\n{\n\tdebugfs_remove(debugfs_lookup(pi_get_module_name(mod), dfs_index));\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/string_helpers.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/debugfs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct dentry *dfs_index;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_remove",
          "args": [
            "debugfs_lookup(pi_get_module_name(mod), dfs_index)"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "fei_debugfs_remove_attr",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/fail_function.c",
          "lines": "164-170",
          "snippet": "static void fei_debugfs_remove_attr(struct fei_attr *attr)\n{\n\tstruct dentry *dir;\n\n\tdir = debugfs_lookup(attr->kp.symbol_name, fei_debugfs_dir);\n\tdebugfs_remove_recursive(dir);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/slab.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/error-injection.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct dentry *fei_debugfs_dir;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/slab.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/kprobes.h>\n#include <linux/kallsyms.h>\n#include <linux/fault-inject.h>\n#include <linux/debugfs.h>\n#include <linux/error-injection.h>\n\nstatic struct dentry *fei_debugfs_dir;\n\nstatic void fei_debugfs_remove_attr(struct fei_attr *attr)\n{\n\tstruct dentry *dir;\n\n\tdir = debugfs_lookup(attr->kp.symbol_name, fei_debugfs_dir);\n\tdebugfs_remove_recursive(dir);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debugfs_lookup",
          "args": [
            "pi_get_module_name(mod)",
            "dfs_index"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pi_get_module_name",
          "args": [
            "mod"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "pi_get_module_name",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
          "lines": "133-136",
          "snippet": "static const char *pi_get_module_name(struct module *mod)\n{\n\treturn \"vmlinux\";\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/string_helpers.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/debugfs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic const char *pi_get_module_name(struct module *mod)\n{\n\treturn \"vmlinux\";\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic struct dentry *dfs_index;\n\nstatic void pi_remove_file(struct module *mod)\n{\n\tdebugfs_remove(debugfs_lookup(pi_get_module_name(mod), dfs_index));\n}"
  },
  {
    "function_name": "pi_create_file",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
    "lines": "139-143",
    "snippet": "static void pi_create_file(struct module *mod)\n{\n\tdebugfs_create_file(pi_get_module_name(mod), 0444, dfs_index,\n\t\t\t\t       mod, &dfs_index_fops);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/string_helpers.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/debugfs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct dentry *dfs_index;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "pi_get_module_name(mod)",
            "0444",
            "dfs_index",
            "mod",
            "&dfs_index_fops"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pi_get_module_name",
          "args": [
            "mod"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "pi_get_module_name",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
          "lines": "133-136",
          "snippet": "static const char *pi_get_module_name(struct module *mod)\n{\n\treturn \"vmlinux\";\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/string_helpers.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/debugfs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic const char *pi_get_module_name(struct module *mod)\n{\n\treturn \"vmlinux\";\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic struct dentry *dfs_index;\n\nstatic void pi_create_file(struct module *mod)\n{\n\tdebugfs_create_file(pi_get_module_name(mod), 0444, dfs_index,\n\t\t\t\t       mod, &dfs_index_fops);\n}"
  },
  {
    "function_name": "pi_get_module_name",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
    "lines": "133-136",
    "snippet": "static const char *pi_get_module_name(struct module *mod)\n{\n\treturn \"vmlinux\";\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/string_helpers.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/debugfs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic const char *pi_get_module_name(struct module *mod)\n{\n\treturn \"vmlinux\";\n}"
  },
  {
    "function_name": "pi_get_module_name",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
    "lines": "128-131",
    "snippet": "static const char *pi_get_module_name(struct module *mod)\n{\n\treturn mod ? mod->name : \"vmlinux\";\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/string_helpers.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/debugfs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic const char *pi_get_module_name(struct module *mod)\n{\n\treturn mod ? mod->name : \"vmlinux\";\n}"
  },
  {
    "function_name": "pi_stop",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
    "lines": "116-116",
    "snippet": "static void pi_stop(struct seq_file *p, void *v) { }",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/string_helpers.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/debugfs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic void pi_stop(struct seq_file *p, void *v) { }"
  },
  {
    "function_name": "pi_show",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
    "lines": "73-114",
    "snippet": "static int pi_show(struct seq_file *s, void *v)\n{\n\tconst struct pi_entry *entry = v;\n\tint level = LOGLEVEL_DEFAULT;\n\tenum printk_info_flags flags = 0;\n\tu16 prefix_len = 0;\n\n\tif (v == SEQ_START_TOKEN) {\n\t\tseq_puts(s, \"# <level/flags> filename:line function \\\"format\\\"\\n\");\n\t\treturn 0;\n\t}\n\n\tif (!entry->fmt)\n\t\treturn 0;\n\n\tif (entry->level)\n\t\tprintk_parse_prefix(entry->level, &level, &flags);\n\telse\n\t\tprefix_len = printk_parse_prefix(entry->fmt, &level, &flags);\n\n\n\tif (flags & LOG_CONT) {\n\t\t/*\n\t\t * LOGLEVEL_DEFAULT here means \"use the same level as the\n\t\t * message we're continuing from\", not the default message\n\t\t * loglevel, so don't display it as such.\n\t\t */\n\t\tif (level == LOGLEVEL_DEFAULT)\n\t\t\tseq_puts(s, \"<c>\");\n\t\telse\n\t\t\tseq_printf(s, \"<%d,c>\", level);\n\t} else\n\t\tseq_printf(s, \"<%d>\", level);\n\n\tseq_printf(s, \" %s:%d %s \\\"\", entry->file, entry->line, entry->func);\n\tif (entry->subsys_fmt_prefix)\n\t\tseq_escape_printf_format(s, entry->subsys_fmt_prefix);\n\tseq_escape_printf_format(s, entry->fmt + prefix_len);\n\tseq_puts(s, \"\\\"\\n\");\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/string_helpers.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/debugfs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "s",
            "\"\\\"\\n\""
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "trace_seq_puts",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/trace_seq.c",
          "lines": "205-220",
          "snippet": "void trace_seq_puts(struct trace_seq *s, const char *str)\n{\n\tunsigned int len = strlen(str);\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tif (len > TRACE_SEQ_BUF_LEFT(s)) {\n\t\ts->full = 1;\n\t\treturn;\n\t}\n\n\tseq_buf_putmem(&s->seq, str, len);\n}",
          "includes": [
            "#include <linux/trace_seq.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/trace_seq.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n\nvoid trace_seq_puts(struct trace_seq *s, const char *str)\n{\n\tunsigned int len = strlen(str);\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tif (len > TRACE_SEQ_BUF_LEFT(s)) {\n\t\ts->full = 1;\n\t\treturn;\n\t}\n\n\tseq_buf_putmem(&s->seq, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_escape_printf_format",
          "args": [
            "s",
            "entry->fmt + prefix_len"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_escape_printf_format",
          "args": [
            "s",
            "entry->subsys_fmt_prefix"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "s",
            "\" %s:%d %s \\\"\"",
            "entry->file",
            "entry->line",
            "entry->func"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "trace_seq_printf",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/trace_seq.c",
          "lines": "81-100",
          "snippet": "void trace_seq_printf(struct trace_seq *s, const char *fmt, ...)\n{\n\tunsigned int save_len = s->seq.len;\n\tva_list ap;\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tva_start(ap, fmt);\n\tseq_buf_vprintf(&s->seq, fmt, ap);\n\tva_end(ap);\n\n\t/* If we can't write it all, don't bother writing anything */\n\tif (unlikely(seq_buf_has_overflowed(&s->seq))) {\n\t\ts->seq.len = save_len;\n\t\ts->full = 1;\n\t}\n}",
          "includes": [
            "#include <linux/trace_seq.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/trace_seq.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n\nvoid trace_seq_printf(struct trace_seq *s, const char *fmt, ...)\n{\n\tunsigned int save_len = s->seq.len;\n\tva_list ap;\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tva_start(ap, fmt);\n\tseq_buf_vprintf(&s->seq, fmt, ap);\n\tva_end(ap);\n\n\t/* If we can't write it all, don't bother writing anything */\n\tif (unlikely(seq_buf_has_overflowed(&s->seq))) {\n\t\ts->seq.len = save_len;\n\t\ts->full = 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk_parse_prefix",
          "args": [
            "entry->fmt",
            "&level",
            "&flags"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "printk_parse_prefix",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2041-2067",
          "snippet": "u16 printk_parse_prefix(const char *text, int *level,\n\t\t\tenum printk_info_flags *flags)\n{\n\tu16 prefix_len = 0;\n\tint kern_level;\n\n\twhile (*text) {\n\t\tkern_level = printk_get_level(text);\n\t\tif (!kern_level)\n\t\t\tbreak;\n\n\t\tswitch (kern_level) {\n\t\tcase '0' ... '7':\n\t\t\tif (level && *level == LOGLEVEL_DEFAULT)\n\t\t\t\t*level = kern_level - '0';\n\t\t\tbreak;\n\t\tcase 'c':\t/* KERN_CONT */\n\t\t\tif (flags)\n\t\t\t\t*flags |= LOG_CONT;\n\t\t}\n\n\t\tprefix_len += 2;\n\t\ttext += 2;\n\t}\n\n\treturn prefix_len;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nu16 printk_parse_prefix(const char *text, int *level,\n\t\t\tenum printk_info_flags *flags)\n{\n\tu16 prefix_len = 0;\n\tint kern_level;\n\n\twhile (*text) {\n\t\tkern_level = printk_get_level(text);\n\t\tif (!kern_level)\n\t\t\tbreak;\n\n\t\tswitch (kern_level) {\n\t\tcase '0' ... '7':\n\t\t\tif (level && *level == LOGLEVEL_DEFAULT)\n\t\t\t\t*level = kern_level - '0';\n\t\t\tbreak;\n\t\tcase 'c':\t/* KERN_CONT */\n\t\t\tif (flags)\n\t\t\t\t*flags |= LOG_CONT;\n\t\t}\n\n\t\tprefix_len += 2;\n\t\ttext += 2;\n\t}\n\n\treturn prefix_len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic int pi_show(struct seq_file *s, void *v)\n{\n\tconst struct pi_entry *entry = v;\n\tint level = LOGLEVEL_DEFAULT;\n\tenum printk_info_flags flags = 0;\n\tu16 prefix_len = 0;\n\n\tif (v == SEQ_START_TOKEN) {\n\t\tseq_puts(s, \"# <level/flags> filename:line function \\\"format\\\"\\n\");\n\t\treturn 0;\n\t}\n\n\tif (!entry->fmt)\n\t\treturn 0;\n\n\tif (entry->level)\n\t\tprintk_parse_prefix(entry->level, &level, &flags);\n\telse\n\t\tprefix_len = printk_parse_prefix(entry->fmt, &level, &flags);\n\n\n\tif (flags & LOG_CONT) {\n\t\t/*\n\t\t * LOGLEVEL_DEFAULT here means \"use the same level as the\n\t\t * message we're continuing from\", not the default message\n\t\t * loglevel, so don't display it as such.\n\t\t */\n\t\tif (level == LOGLEVEL_DEFAULT)\n\t\t\tseq_puts(s, \"<c>\");\n\t\telse\n\t\t\tseq_printf(s, \"<%d,c>\", level);\n\t} else\n\t\tseq_printf(s, \"<%d>\", level);\n\n\tseq_printf(s, \" %s:%d %s \\\"\", entry->file, entry->line, entry->func);\n\tif (entry->subsys_fmt_prefix)\n\t\tseq_escape_printf_format(s, entry->subsys_fmt_prefix);\n\tseq_escape_printf_format(s, entry->fmt + prefix_len);\n\tseq_puts(s, \"\\\"\\n\");\n\n\treturn 0;\n}"
  },
  {
    "function_name": "pi_start",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
    "lines": "53-63",
    "snippet": "static void *pi_start(struct seq_file *s, loff_t *pos)\n{\n\t/*\n\t * Make show() print the header line. Do not update *pos because\n\t * pi_next() still has to return the entry at index 0 later.\n\t */\n\tif (*pos == 0)\n\t\treturn SEQ_START_TOKEN;\n\n\treturn pi_next(s, NULL, pos);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/string_helpers.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/debugfs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pi_next",
          "args": [
            "s",
            "NULL",
            "pos"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "pi_next",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
          "lines": "43-51",
          "snippet": "static void *pi_next(struct seq_file *s, void *v, loff_t *pos)\n{\n\tconst struct module *mod = s->file->f_inode->i_private;\n\tstruct pi_entry *entry = pi_get_entry(mod, *pos);\n\n\t(*pos)++;\n\n\treturn entry;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/string_helpers.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/debugfs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic void *pi_next(struct seq_file *s, void *v, loff_t *pos)\n{\n\tconst struct module *mod = s->file->f_inode->i_private;\n\tstruct pi_entry *entry = pi_get_entry(mod, *pos);\n\n\t(*pos)++;\n\n\treturn entry;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic void *pi_start(struct seq_file *s, loff_t *pos)\n{\n\t/*\n\t * Make show() print the header line. Do not update *pos because\n\t * pi_next() still has to return the entry at index 0 later.\n\t */\n\tif (*pos == 0)\n\t\treturn SEQ_START_TOKEN;\n\n\treturn pi_next(s, NULL, pos);\n}"
  },
  {
    "function_name": "pi_next",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
    "lines": "43-51",
    "snippet": "static void *pi_next(struct seq_file *s, void *v, loff_t *pos)\n{\n\tconst struct module *mod = s->file->f_inode->i_private;\n\tstruct pi_entry *entry = pi_get_entry(mod, *pos);\n\n\t(*pos)++;\n\n\treturn entry;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/string_helpers.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/debugfs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pi_get_entry",
          "args": [
            "mod",
            "*pos"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "pi_get_entry",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
          "lines": "20-41",
          "snippet": "static struct pi_entry *pi_get_entry(const struct module *mod, loff_t pos)\n{\n\tstruct pi_entry **entries;\n\tunsigned int nr_entries;\n\n#ifdef CONFIG_MODULES\n\tif (mod) {\n\t\tentries = mod->printk_index_start;\n\t\tnr_entries = mod->printk_index_size;\n\t} else\n#endif\n\t{\n\t\t/* vmlinux, comes from linker symbols */\n\t\tentries = __start_printk_index;\n\t\tnr_entries = __stop_printk_index - __start_printk_index;\n\t}\n\n\tif (pos >= nr_entries)\n\t\treturn NULL;\n\n\treturn entries[pos];\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/string_helpers.h>",
            "#include <linux/slab.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/debugfs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern struct pi_entry *__start_printk_index[];",
            "extern struct pi_entry *__stop_printk_index[];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nextern struct pi_entry *__start_printk_index[];\nextern struct pi_entry *__stop_printk_index[];\n\nstatic struct pi_entry *pi_get_entry(const struct module *mod, loff_t pos)\n{\n\tstruct pi_entry **entries;\n\tunsigned int nr_entries;\n\n#ifdef CONFIG_MODULES\n\tif (mod) {\n\t\tentries = mod->printk_index_start;\n\t\tnr_entries = mod->printk_index_size;\n\t} else\n#endif\n\t{\n\t\t/* vmlinux, comes from linker symbols */\n\t\tentries = __start_printk_index;\n\t\tnr_entries = __stop_printk_index - __start_printk_index;\n\t}\n\n\tif (pos >= nr_entries)\n\t\treturn NULL;\n\n\treturn entries[pos];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nstatic void *pi_next(struct seq_file *s, void *v, loff_t *pos)\n{\n\tconst struct module *mod = s->file->f_inode->i_private;\n\tstruct pi_entry *entry = pi_get_entry(mod, *pos);\n\n\t(*pos)++;\n\n\treturn entry;\n}"
  },
  {
    "function_name": "pi_get_entry",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/index.c",
    "lines": "20-41",
    "snippet": "static struct pi_entry *pi_get_entry(const struct module *mod, loff_t pos)\n{\n\tstruct pi_entry **entries;\n\tunsigned int nr_entries;\n\n#ifdef CONFIG_MODULES\n\tif (mod) {\n\t\tentries = mod->printk_index_start;\n\t\tnr_entries = mod->printk_index_size;\n\t} else\n#endif\n\t{\n\t\t/* vmlinux, comes from linker symbols */\n\t\tentries = __start_printk_index;\n\t\tnr_entries = __stop_printk_index - __start_printk_index;\n\t}\n\n\tif (pos >= nr_entries)\n\t\treturn NULL;\n\n\treturn entries[pos];\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/string_helpers.h>",
      "#include <linux/slab.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/debugfs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern struct pi_entry *__start_printk_index[];",
      "extern struct pi_entry *__stop_printk_index[];"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/string_helpers.h>\n#include <linux/slab.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/debugfs.h>\n\nextern struct pi_entry *__start_printk_index[];\nextern struct pi_entry *__stop_printk_index[];\n\nstatic struct pi_entry *pi_get_entry(const struct module *mod, loff_t pos)\n{\n\tstruct pi_entry **entries;\n\tunsigned int nr_entries;\n\n#ifdef CONFIG_MODULES\n\tif (mod) {\n\t\tentries = mod->printk_index_start;\n\t\tnr_entries = mod->printk_index_size;\n\t} else\n#endif\n\t{\n\t\t/* vmlinux, comes from linker symbols */\n\t\tentries = __start_printk_index;\n\t\tnr_entries = __stop_printk_index - __start_printk_index;\n\t}\n\n\tif (pos >= nr_entries)\n\t\treturn NULL;\n\n\treturn entries[pos];\n}"
  }
]