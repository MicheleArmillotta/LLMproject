[
  {
    "function_name": "BTF_ID",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/bpf_lsm.c",
    "lines": "132-220",
    "snippet": "BTF_SET_START(sleepable_lsm_hooks)\nBTF_ID(func, bpf_lsm_bpf)\nBTF_ID(func, bpf_lsm_bpf_map)\nBTF_ID(func, bpf_lsm_bpf_map_alloc_security)\nBTF_ID(func, bpf_lsm_bpf_map_free_security)\nBTF_ID(func, bpf_lsm_bpf_prog)\nBTF_ID(func, bpf_lsm_bprm_check_security)\nBTF_ID(func, bpf_lsm_bprm_committed_creds)\nBTF_ID(func, bpf_lsm_bprm_committing_creds)\nBTF_ID(func, bpf_lsm_bprm_creds_for_exec)\nBTF_ID(func, bpf_lsm_bprm_creds_from_file)\nBTF_ID(func, bpf_lsm_capget)\nBTF_ID(func, bpf_lsm_capset)\nBTF_ID(func, bpf_lsm_cred_prepare)\nBTF_ID(func, bpf_lsm_file_ioctl)\nBTF_ID(func, bpf_lsm_file_lock)\nBTF_ID(func, bpf_lsm_file_open)\nBTF_ID(func, bpf_lsm_file_receive)\n\n#ifdef CONFIG_SECURITY_NETWORK\nBTF_ID(func, bpf_lsm_inet_conn_established)\n#endif /* CONFIG_SECURITY_NETWORK */\n\nBTF_ID(func, bpf_lsm_inode_create)\nBTF_ID(func, bpf_lsm_inode_free_security)\nBTF_ID(func, bpf_lsm_inode_getattr)\nBTF_ID(func, bpf_lsm_inode_getxattr)\nBTF_ID(func, bpf_lsm_inode_mknod)\nBTF_ID(func, bpf_lsm_inode_need_killpriv)\nBTF_ID(func, bpf_lsm_inode_post_setxattr)\nBTF_ID(func, bpf_lsm_inode_readlink)\nBTF_ID(func, bpf_lsm_inode_rename)\nBTF_ID(func, bpf_lsm_inode_rmdir)\nBTF_ID(func, bpf_lsm_inode_setattr)\nBTF_ID(func, bpf_lsm_inode_setxattr)\nBTF_ID(func, bpf_lsm_inode_symlink)\nBTF_ID(func, bpf_lsm_inode_unlink)\nBTF_ID(func, bpf_lsm_kernel_module_request)\nBTF_ID(func, bpf_lsm_kernfs_init_security)\n\n#ifdef CONFIG_KEYS\nBTF_ID(func, bpf_lsm_key_free)\n#endif /* CONFIG_KEYS */\n\nBTF_ID(func, bpf_lsm_mmap_file)\nBTF_ID(func, bpf_lsm_netlink_send)\nBTF_ID(func, bpf_lsm_path_notify)\nBTF_ID(func, bpf_lsm_release_secctx)\nBTF_ID(func, bpf_lsm_sb_alloc_security)\nBTF_ID(func, bpf_lsm_sb_eat_lsm_opts)\nBTF_ID(func, bpf_lsm_sb_kern_mount)\nBTF_ID(func, bpf_lsm_sb_mount)\nBTF_ID(func, bpf_lsm_sb_remount)\nBTF_ID(func, bpf_lsm_sb_set_mnt_opts)\nBTF_ID(func, bpf_lsm_sb_show_options)\nBTF_ID(func, bpf_lsm_sb_statfs)\nBTF_ID(func, bpf_lsm_sb_umount)\nBTF_ID(func, bpf_lsm_settime)\n\n#ifdef CONFIG_SECURITY_NETWORK\nBTF_ID(func, bpf_lsm_socket_accept)\nBTF_ID(func, bpf_lsm_socket_bind)\nBTF_ID(func, bpf_lsm_socket_connect)\nBTF_ID(func, bpf_lsm_socket_create)\nBTF_ID(func, bpf_lsm_socket_getpeername)\nBTF_ID(func, bpf_lsm_socket_getpeersec_dgram)\nBTF_ID(func, bpf_lsm_socket_getsockname)\nBTF_ID(func, bpf_lsm_socket_getsockopt)\nBTF_ID(func, bpf_lsm_socket_listen)\nBTF_ID(func, bpf_lsm_socket_post_create)\nBTF_ID(func, bpf_lsm_socket_recvmsg)\nBTF_ID(func, bpf_lsm_socket_sendmsg)\nBTF_ID(func, bpf_lsm_socket_shutdown)\nBTF_ID(func, bpf_lsm_socket_socketpair)\n#endif /* CONFIG_SECURITY_NETWORK */\n\nBTF_ID(func, bpf_lsm_syslog)\nBTF_ID(func, bpf_lsm_task_alloc)\nBTF_ID(func, bpf_lsm_task_getsecid_subj)\nBTF_ID(func, bpf_lsm_task_getsecid_obj)\nBTF_ID(func, bpf_lsm_task_prctl)\nBTF_ID(func, bpf_lsm_task_setscheduler)\nBTF_ID(func, bpf_lsm_task_to_inode)\nBTF_SET_END(sleepable_lsm_hooks)\n\nbool bpf_lsm_is_sleepable_hook(u32 btf_id)\n{\n\treturn btf_id_set_contains(&sleepable_lsm_hooks, btf_id);\n}",
    "includes": [
      "#include <linux/lsm_hook_defs.h>",
      "#include <linux/lsm_hook_defs.h>",
      "#include <linux/ima.h>",
      "#include <linux/btf_ids.h>",
      "#include <linux/bpf_local_storage.h>",
      "#include <net/bpf_sk_storage.h>",
      "#include <linux/bpf_verifier.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/bpf_lsm.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/btf.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "btf_id_set_contains",
          "args": [
            "&sleepable_lsm_hooks",
            "btf_id"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "btf_id_set_contains",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/btf.c",
          "lines": "6198-6201",
          "snippet": "bool btf_id_set_contains(const struct btf_id_set *set, u32 id)\n{\n\treturn bsearch(&id, set->ids, set->cnt, sizeof(u32), btf_id_cmp_func) != NULL;\n}",
          "includes": [
            "#include <linux/bpf_types.h>",
            "#include \"../tools/lib/bpf/relo_core.h\"",
            "#include <net/sock.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/skmsg.h>",
            "#include <linux/btf_ids.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf_verifier.h>",
            "#include <linux/sort.h>",
            "#include <linux/idr.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/slab.h>",
            "#include <linux/errno.h>",
            "#include <linux/ctype.h>",
            "#include <linux/compiler.h>",
            "#include <linux/seq_file.h>",
            "#include <uapi/linux/types.h>",
            "#include <uapi/linux/bpf_perf_event.h>",
            "#include <uapi/linux/bpf.h>",
            "#include <uapi/linux/btf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_types.h>\n#include \"../tools/lib/bpf/relo_core.h\"\n#include <net/sock.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/bsearch.h>\n#include <linux/perf_event.h>\n#include <linux/skmsg.h>\n#include <linux/btf_ids.h>\n#include <linux/btf.h>\n#include <linux/bpf_verifier.h>\n#include <linux/sort.h>\n#include <linux/idr.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <linux/file.h>\n#include <linux/anon_inodes.h>\n#include <linux/slab.h>\n#include <linux/errno.h>\n#include <linux/ctype.h>\n#include <linux/compiler.h>\n#include <linux/seq_file.h>\n#include <uapi/linux/types.h>\n#include <uapi/linux/bpf_perf_event.h>\n#include <uapi/linux/bpf.h>\n#include <uapi/linux/btf.h>\n\nbool btf_id_set_contains(const struct btf_id_set *set, u32 id)\n{\n\treturn bsearch(&id, set->ids, set->cnt, sizeof(u32), btf_id_cmp_func) != NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpf_lsm_is_sleepable_hook",
          "args": [
            "u32btf_id"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BTF_SET_END",
          "args": [
            "sleepable_lsm_hooks"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BTF_ID",
          "args": [
            "func",
            "bpf_lsm_task_to_inode"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "BTF_ID",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/bpf_lsm.c",
          "lines": "132-220",
          "snippet": "BTF_SET_START(sleepable_lsm_hooks)\nBTF_ID(func, bpf_lsm_bpf)\nBTF_ID(func, bpf_lsm_bpf_map)\nBTF_ID(func, bpf_lsm_bpf_map_alloc_security)\nBTF_ID(func, bpf_lsm_bpf_map_free_security)\nBTF_ID(func, bpf_lsm_bpf_prog)\nBTF_ID(func, bpf_lsm_bprm_check_security)\nBTF_ID(func, bpf_lsm_bprm_committed_creds)\nBTF_ID(func, bpf_lsm_bprm_committing_creds)\nBTF_ID(func, bpf_lsm_bprm_creds_for_exec)\nBTF_ID(func, bpf_lsm_bprm_creds_from_file)\nBTF_ID(func, bpf_lsm_capget)\nBTF_ID(func, bpf_lsm_capset)\nBTF_ID(func, bpf_lsm_cred_prepare)\nBTF_ID(func, bpf_lsm_file_ioctl)\nBTF_ID(func, bpf_lsm_file_lock)\nBTF_ID(func, bpf_lsm_file_open)\nBTF_ID(func, bpf_lsm_file_receive)\n\n#ifdef CONFIG_SECURITY_NETWORK\nBTF_ID(func, bpf_lsm_inet_conn_established)\n#endif /* CONFIG_SECURITY_NETWORK */\n\nBTF_ID(func, bpf_lsm_inode_create)\nBTF_ID(func, bpf_lsm_inode_free_security)\nBTF_ID(func, bpf_lsm_inode_getattr)\nBTF_ID(func, bpf_lsm_inode_getxattr)\nBTF_ID(func, bpf_lsm_inode_mknod)\nBTF_ID(func, bpf_lsm_inode_need_killpriv)\nBTF_ID(func, bpf_lsm_inode_post_setxattr)\nBTF_ID(func, bpf_lsm_inode_readlink)\nBTF_ID(func, bpf_lsm_inode_rename)\nBTF_ID(func, bpf_lsm_inode_rmdir)\nBTF_ID(func, bpf_lsm_inode_setattr)\nBTF_ID(func, bpf_lsm_inode_setxattr)\nBTF_ID(func, bpf_lsm_inode_symlink)\nBTF_ID(func, bpf_lsm_inode_unlink)\nBTF_ID(func, bpf_lsm_kernel_module_request)\nBTF_ID(func, bpf_lsm_kernfs_init_security)\n\n#ifdef CONFIG_KEYS\nBTF_ID(func, bpf_lsm_key_free)\n#endif /* CONFIG_KEYS */\n\nBTF_ID(func, bpf_lsm_mmap_file)\nBTF_ID(func, bpf_lsm_netlink_send)\nBTF_ID(func, bpf_lsm_path_notify)\nBTF_ID(func, bpf_lsm_release_secctx)\nBTF_ID(func, bpf_lsm_sb_alloc_security)\nBTF_ID(func, bpf_lsm_sb_eat_lsm_opts)\nBTF_ID(func, bpf_lsm_sb_kern_mount)\nBTF_ID(func, bpf_lsm_sb_mount)\nBTF_ID(func, bpf_lsm_sb_remount)\nBTF_ID(func, bpf_lsm_sb_set_mnt_opts)\nBTF_ID(func, bpf_lsm_sb_show_options)\nBTF_ID(func, bpf_lsm_sb_statfs)\nBTF_ID(func, bpf_lsm_sb_umount)\nBTF_ID(func, bpf_lsm_settime)\n\n#ifdef CONFIG_SECURITY_NETWORK\nBTF_ID(func, bpf_lsm_socket_accept)\nBTF_ID(func, bpf_lsm_socket_bind)\nBTF_ID(func, bpf_lsm_socket_connect)\nBTF_ID(func, bpf_lsm_socket_create)\nBTF_ID(func, bpf_lsm_socket_getpeername)\nBTF_ID(func, bpf_lsm_socket_getpeersec_dgram)\nBTF_ID(func, bpf_lsm_socket_getsockname)\nBTF_ID(func, bpf_lsm_socket_getsockopt)\nBTF_ID(func, bpf_lsm_socket_listen)\nBTF_ID(func, bpf_lsm_socket_post_create)\nBTF_ID(func, bpf_lsm_socket_recvmsg)\nBTF_ID(func, bpf_lsm_socket_sendmsg)\nBTF_ID(func, bpf_lsm_socket_shutdown)\nBTF_ID(func, bpf_lsm_socket_socketpair)\n#endif /* CONFIG_SECURITY_NETWORK */\n\nBTF_ID(func, bpf_lsm_syslog)\nBTF_ID(func, bpf_lsm_task_alloc)\nBTF_ID(func, bpf_lsm_task_getsecid_subj)\nBTF_ID(func, bpf_lsm_task_getsecid_obj)\nBTF_ID(func, bpf_lsm_task_prctl)\nBTF_ID(func, bpf_lsm_task_setscheduler)\nBTF_ID(func, bpf_lsm_task_to_inode)\nBTF_SET_END(sleepable_lsm_hooks)\n\nbool bpf_lsm_is_sleepable_hook(u32 btf_id)\n{\n\treturn btf_id_set_contains(&sleepable_lsm_hooks, btf_id);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <linux/lsm_hook_defs.h>\n#include <linux/lsm_hook_defs.h>\n#include <linux/ima.h>\n#include <linux/btf_ids.h>\n#include <linux/bpf_local_storage.h>\n#include <net/bpf_sk_storage.h>\n#include <linux/bpf_verifier.h>\n#include <linux/kallsyms.h>\n#include <linux/bpf_lsm.h>\n#include <linux/lsm_hooks.h>\n#include <linux/binfmts.h>\n#include <linux/btf.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n\nBTF_SET_START(sleepable_lsm_hooks)\nBTF_ID(func, bpf_lsm_bpf)\nBTF_ID(func, bpf_lsm_bpf_map)\nBTF_ID(func, bpf_lsm_bpf_map_alloc_security)\nBTF_ID(func, bpf_lsm_bpf_map_free_security)\nBTF_ID(func, bpf_lsm_bpf_prog)\nBTF_ID(func, bpf_lsm_bprm_check_security)\nBTF_ID(func, bpf_lsm_bprm_committed_creds)\nBTF_ID(func, bpf_lsm_bprm_committing_creds)\nBTF_ID(func, bpf_lsm_bprm_creds_for_exec)\nBTF_ID(func, bpf_lsm_bprm_creds_from_file)\nBTF_ID(func, bpf_lsm_capget)\nBTF_ID(func, bpf_lsm_capset)\nBTF_ID(func, bpf_lsm_cred_prepare)\nBTF_ID(func, bpf_lsm_file_ioctl)\nBTF_ID(func, bpf_lsm_file_lock)\nBTF_ID(func, bpf_lsm_file_open)\nBTF_ID(func, bpf_lsm_file_receive)\n\n#ifdef CONFIG_SECURITY_NETWORK\nBTF_ID(func, bpf_lsm_inet_conn_established)\n#endif /* CONFIG_SECURITY_NETWORK */\n\nBTF_ID(func, bpf_lsm_inode_create)\nBTF_ID(func, bpf_lsm_inode_free_security)\nBTF_ID(func, bpf_lsm_inode_getattr)\nBTF_ID(func, bpf_lsm_inode_getxattr)\nBTF_ID(func, bpf_lsm_inode_mknod)\nBTF_ID(func, bpf_lsm_inode_need_killpriv)\nBTF_ID(func, bpf_lsm_inode_post_setxattr)\nBTF_ID(func, bpf_lsm_inode_readlink)\nBTF_ID(func, bpf_lsm_inode_rename)\nBTF_ID(func, bpf_lsm_inode_rmdir)\nBTF_ID(func, bpf_lsm_inode_setattr)\nBTF_ID(func, bpf_lsm_inode_setxattr)\nBTF_ID(func, bpf_lsm_inode_symlink)\nBTF_ID(func, bpf_lsm_inode_unlink)\nBTF_ID(func, bpf_lsm_kernel_module_request)\nBTF_ID(func, bpf_lsm_kernfs_init_security)\n\n#ifdef CONFIG_KEYS\nBTF_ID(func, bpf_lsm_key_free)\n#endif /* CONFIG_KEYS */\n\nBTF_ID(func, bpf_lsm_mmap_file)\nBTF_ID(func, bpf_lsm_netlink_send)\nBTF_ID(func, bpf_lsm_path_notify)\nBTF_ID(func, bpf_lsm_release_secctx)\nBTF_ID(func, bpf_lsm_sb_alloc_security)\nBTF_ID(func, bpf_lsm_sb_eat_lsm_opts)\nBTF_ID(func, bpf_lsm_sb_kern_mount)\nBTF_ID(func, bpf_lsm_sb_mount)\nBTF_ID(func, bpf_lsm_sb_remount)\nBTF_ID(func, bpf_lsm_sb_set_mnt_opts)\nBTF_ID(func, bpf_lsm_sb_show_options)\nBTF_ID(func, bpf_lsm_sb_statfs)\nBTF_ID(func, bpf_lsm_sb_umount)\nBTF_ID(func, bpf_lsm_settime)\n\n#ifdef CONFIG_SECURITY_NETWORK\nBTF_ID(func, bpf_lsm_socket_accept)\nBTF_ID(func, bpf_lsm_socket_bind)\nBTF_ID(func, bpf_lsm_socket_connect)\nBTF_ID(func, bpf_lsm_socket_create)\nBTF_ID(func, bpf_lsm_socket_getpeername)\nBTF_ID(func, bpf_lsm_socket_getpeersec_dgram)\nBTF_ID(func, bpf_lsm_socket_getsockname)\nBTF_ID(func, bpf_lsm_socket_getsockopt)\nBTF_ID(func, bpf_lsm_socket_listen)\nBTF_ID(func, bpf_lsm_socket_post_create)\nBTF_ID(func, bpf_lsm_socket_recvmsg)\nBTF_ID(func, bpf_lsm_socket_sendmsg)\nBTF_ID(func, bpf_lsm_socket_shutdown)\nBTF_ID(func, bpf_lsm_socket_socketpair)\n#endif /* CONFIG_SECURITY_NETWORK */\n\nBTF_ID(func, bpf_lsm_syslog)\nBTF_ID(func, bpf_lsm_task_alloc)\nBTF_ID(func, bpf_lsm_task_getsecid_subj)\nBTF_ID(func, bpf_lsm_task_getsecid_obj)\nBTF_ID(func, bpf_lsm_task_prctl)\nBTF_ID(func, bpf_lsm_task_setscheduler)\nBTF_ID(func, bpf_lsm_task_to_inode)\nBTF_SET_END(sleepable_lsm_hooks)\n\nbool bpf_lsm_is_sleepable_hook(u32 btf_id)\n{\n\treturn btf_id_set_contains(&sleepable_lsm_hooks, btf_id);\n}"
  },
  {
    "function_name": "bpf_lsm_func_proto",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/bpf_lsm.c",
    "lines": "102-127",
    "snippet": "static const struct bpf_func_proto *\nbpf_lsm_func_proto(enum bpf_func_id func_id, const struct bpf_prog *prog)\n{\n\tswitch (func_id) {\n\tcase BPF_FUNC_inode_storage_get:\n\t\treturn &bpf_inode_storage_get_proto;\n\tcase BPF_FUNC_inode_storage_delete:\n\t\treturn &bpf_inode_storage_delete_proto;\n#ifdef CONFIG_NET\n\tcase BPF_FUNC_sk_storage_get:\n\t\treturn &bpf_sk_storage_get_proto;\n\tcase BPF_FUNC_sk_storage_delete:\n\t\treturn &bpf_sk_storage_delete_proto;\n#endif /* CONFIG_NET */\n\tcase BPF_FUNC_spin_lock:\n\t\treturn &bpf_spin_lock_proto;\n\tcase BPF_FUNC_spin_unlock:\n\t\treturn &bpf_spin_unlock_proto;\n\tcase BPF_FUNC_bprm_opts_set:\n\t\treturn &bpf_bprm_opts_set_proto;\n\tcase BPF_FUNC_ima_inode_hash:\n\t\treturn prog->aux->sleepable ? &bpf_ima_inode_hash_proto : NULL;\n\tdefault:\n\t\treturn tracing_prog_func_proto(func_id, prog);\n\t}\n}",
    "includes": [
      "#include <linux/lsm_hook_defs.h>",
      "#include <linux/lsm_hook_defs.h>",
      "#include <linux/ima.h>",
      "#include <linux/btf_ids.h>",
      "#include <linux/bpf_local_storage.h>",
      "#include <net/bpf_sk_storage.h>",
      "#include <linux/bpf_verifier.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/bpf_lsm.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/btf.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct bpf_func_proto bpf_bprm_opts_set_proto = {\n\t.func\t\t= bpf_bprm_opts_set,\n\t.gpl_only\t= false,\n\t.ret_type\t= RET_INTEGER,\n\t.arg1_type\t= ARG_PTR_TO_BTF_ID,\n\t.arg1_btf_id\t= &bpf_bprm_opts_set_btf_ids[0],\n\t.arg2_type\t= ARG_ANYTHING,\n};",
      "static const struct bpf_func_proto bpf_ima_inode_hash_proto = {\n\t.func\t\t= bpf_ima_inode_hash,\n\t.gpl_only\t= false,\n\t.ret_type\t= RET_INTEGER,\n\t.arg1_type\t= ARG_PTR_TO_BTF_ID,\n\t.arg1_btf_id\t= &bpf_ima_inode_hash_btf_ids[0],\n\t.arg2_type\t= ARG_PTR_TO_UNINIT_MEM,\n\t.arg3_type\t= ARG_CONST_SIZE,\n\t.allowed\t= bpf_ima_inode_hash_allowed,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "tracing_prog_func_proto",
          "args": [
            "func_id",
            "prog"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "tracing_prog_func_proto",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/syscall.c",
          "lines": "4780-4784",
          "snippet": "const struct bpf_func_proto * __weak\ntracing_prog_func_proto(enum bpf_func_id func_id, const struct bpf_prog *prog)\n{\n\treturn bpf_base_func_proto(func_id);\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/rcupdate_trace.h>",
            "#include <linux/bpf-netns.h>",
            "#include <linux/poll.h>",
            "#include <linux/bpf_lsm.h>",
            "#include <linux/pgtable.h>",
            "#include <uapi/linux/btf.h>",
            "#include <linux/audit.h>",
            "#include <linux/nospec.h>",
            "#include <linux/ctype.h>",
            "#include <linux/timekeeping.h>",
            "#include <linux/cred.h>",
            "#include <linux/idr.h>",
            "#include <linux/kernel.h>",
            "#include <linux/filter.h>",
            "#include <linux/license.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf_verifier.h>",
            "#include <linux/bpf_lirc.h>",
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf-cgroup.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/rcupdate_trace.h>\n#include <linux/bpf-netns.h>\n#include <linux/poll.h>\n#include <linux/bpf_lsm.h>\n#include <linux/pgtable.h>\n#include <uapi/linux/btf.h>\n#include <linux/audit.h>\n#include <linux/nospec.h>\n#include <linux/ctype.h>\n#include <linux/timekeeping.h>\n#include <linux/cred.h>\n#include <linux/idr.h>\n#include <linux/kernel.h>\n#include <linux/filter.h>\n#include <linux/license.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/fdtable.h>\n#include <linux/anon_inodes.h>\n#include <linux/mmzone.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/syscalls.h>\n#include <linux/btf.h>\n#include <linux/bpf_verifier.h>\n#include <linux/bpf_lirc.h>\n#include <linux/bpf_trace.h>\n#include <linux/bpf-cgroup.h>\n#include <linux/bpf.h>\n\nconst struct bpf_func_proto * __weak\ntracing_prog_func_proto(enum bpf_func_id func_id, const struct bpf_prog *prog)\n{\n\treturn bpf_base_func_proto(func_id);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/lsm_hook_defs.h>\n#include <linux/lsm_hook_defs.h>\n#include <linux/ima.h>\n#include <linux/btf_ids.h>\n#include <linux/bpf_local_storage.h>\n#include <net/bpf_sk_storage.h>\n#include <linux/bpf_verifier.h>\n#include <linux/kallsyms.h>\n#include <linux/bpf_lsm.h>\n#include <linux/lsm_hooks.h>\n#include <linux/binfmts.h>\n#include <linux/btf.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n\nstatic const struct bpf_func_proto bpf_bprm_opts_set_proto = {\n\t.func\t\t= bpf_bprm_opts_set,\n\t.gpl_only\t= false,\n\t.ret_type\t= RET_INTEGER,\n\t.arg1_type\t= ARG_PTR_TO_BTF_ID,\n\t.arg1_btf_id\t= &bpf_bprm_opts_set_btf_ids[0],\n\t.arg2_type\t= ARG_ANYTHING,\n};\nstatic const struct bpf_func_proto bpf_ima_inode_hash_proto = {\n\t.func\t\t= bpf_ima_inode_hash,\n\t.gpl_only\t= false,\n\t.ret_type\t= RET_INTEGER,\n\t.arg1_type\t= ARG_PTR_TO_BTF_ID,\n\t.arg1_btf_id\t= &bpf_ima_inode_hash_btf_ids[0],\n\t.arg2_type\t= ARG_PTR_TO_UNINIT_MEM,\n\t.arg3_type\t= ARG_CONST_SIZE,\n\t.allowed\t= bpf_ima_inode_hash_allowed,\n};\n\nstatic const struct bpf_func_proto *\nbpf_lsm_func_proto(enum bpf_func_id func_id, const struct bpf_prog *prog)\n{\n\tswitch (func_id) {\n\tcase BPF_FUNC_inode_storage_get:\n\t\treturn &bpf_inode_storage_get_proto;\n\tcase BPF_FUNC_inode_storage_delete:\n\t\treturn &bpf_inode_storage_delete_proto;\n#ifdef CONFIG_NET\n\tcase BPF_FUNC_sk_storage_get:\n\t\treturn &bpf_sk_storage_get_proto;\n\tcase BPF_FUNC_sk_storage_delete:\n\t\treturn &bpf_sk_storage_delete_proto;\n#endif /* CONFIG_NET */\n\tcase BPF_FUNC_spin_lock:\n\t\treturn &bpf_spin_lock_proto;\n\tcase BPF_FUNC_spin_unlock:\n\t\treturn &bpf_spin_unlock_proto;\n\tcase BPF_FUNC_bprm_opts_set:\n\t\treturn &bpf_bprm_opts_set_proto;\n\tcase BPF_FUNC_ima_inode_hash:\n\t\treturn prog->aux->sleepable ? &bpf_ima_inode_hash_proto : NULL;\n\tdefault:\n\t\treturn tracing_prog_func_proto(func_id, prog);\n\t}\n}"
  },
  {
    "function_name": "bpf_ima_inode_hash_allowed",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/bpf_lsm.c",
    "lines": "84-87",
    "snippet": "static bool bpf_ima_inode_hash_allowed(const struct bpf_prog *prog)\n{\n\treturn bpf_lsm_is_sleepable_hook(prog->aux->attach_btf_id);\n}",
    "includes": [
      "#include <linux/lsm_hook_defs.h>",
      "#include <linux/lsm_hook_defs.h>",
      "#include <linux/ima.h>",
      "#include <linux/btf_ids.h>",
      "#include <linux/bpf_local_storage.h>",
      "#include <net/bpf_sk_storage.h>",
      "#include <linux/bpf_verifier.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/bpf_lsm.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/btf.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bpf_lsm_is_sleepable_hook",
          "args": [
            "prog->aux->attach_btf_id"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/lsm_hook_defs.h>\n#include <linux/lsm_hook_defs.h>\n#include <linux/ima.h>\n#include <linux/btf_ids.h>\n#include <linux/bpf_local_storage.h>\n#include <net/bpf_sk_storage.h>\n#include <linux/bpf_verifier.h>\n#include <linux/kallsyms.h>\n#include <linux/bpf_lsm.h>\n#include <linux/lsm_hooks.h>\n#include <linux/binfmts.h>\n#include <linux/btf.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n\nstatic bool bpf_ima_inode_hash_allowed(const struct bpf_prog *prog)\n{\n\treturn bpf_lsm_is_sleepable_hook(prog->aux->attach_btf_id);\n}"
  },
  {
    "function_name": "bpf_lsm_verify_prog",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/bpf_lsm.c",
    "lines": "36-54",
    "snippet": "BTF_SET_END(bpf_lsm_hooks)\n\nint bpf_lsm_verify_prog(struct bpf_verifier_log *vlog,\n\t\t\tconst struct bpf_prog *prog)\n{\n\tif (!prog->gpl_compatible) {\n\t\tbpf_log(vlog,\n\t\t\t\"LSM programs must have a GPL compatible license\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\tif (!btf_id_set_contains(&bpf_lsm_hooks, prog->aux->attach_btf_id)) {\n\t\tbpf_log(vlog, \"attach_btf_id %u points to wrong type name %s\\n\",\n\t\t\tprog->aux->attach_btf_id, prog->aux->attach_func_name);\n\t\treturn -EINVAL;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/lsm_hook_defs.h>",
      "#include <linux/lsm_hook_defs.h>",
      "#include <linux/ima.h>",
      "#include <linux/btf_ids.h>",
      "#include <linux/bpf_local_storage.h>",
      "#include <net/bpf_sk_storage.h>",
      "#include <linux/bpf_verifier.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/bpf_lsm.h>",
      "#include <linux/lsm_hooks.h>",
      "#include <linux/binfmts.h>",
      "#include <linux/btf.h>",
      "#include <linux/bpf.h>",
      "#include <linux/filter.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bpf_log",
          "args": [
            "vlog",
            "\"attach_btf_id %u points to wrong type name %s\\n\"",
            "prog->aux->attach_btf_id",
            "prog->aux->attach_func_name"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_log",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/verifier.c",
          "lines": "355-366",
          "snippet": "void bpf_log(struct bpf_verifier_log *log,\n\t\t\t    const char *fmt, ...)\n{\n\tva_list args;\n\n\tif (!bpf_verifier_log_needed(log))\n\t\treturn;\n\n\tva_start(args, fmt);\n\tbpf_verifier_vlog(log, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"disasm.h\"",
            "#include <linux/btf_ids.h>",
            "#include <linux/bpf_lsm.h>",
            "#include <linux/error-injection.h>",
            "#include <linux/ctype.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/sort.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/stringify.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/file.h>",
            "#include <net/netlink.h>",
            "#include <linux/filter.h>",
            "#include <linux/bpf_verifier.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/bpf-cgroup.h>",
            "#include <uapi/linux/btf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"disasm.h\"\n#include <linux/btf_ids.h>\n#include <linux/bpf_lsm.h>\n#include <linux/error-injection.h>\n#include <linux/ctype.h>\n#include <linux/perf_event.h>\n#include <linux/sort.h>\n#include <linux/bsearch.h>\n#include <linux/stringify.h>\n#include <linux/vmalloc.h>\n#include <linux/file.h>\n#include <net/netlink.h>\n#include <linux/filter.h>\n#include <linux/bpf_verifier.h>\n#include <linux/btf.h>\n#include <linux/bpf.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/bpf-cgroup.h>\n#include <uapi/linux/btf.h>\n\nvoid bpf_log(struct bpf_verifier_log *log,\n\t\t\t    const char *fmt, ...)\n{\n\tva_list args;\n\n\tif (!bpf_verifier_log_needed(log))\n\t\treturn;\n\n\tva_start(args, fmt);\n\tbpf_verifier_vlog(log, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "btf_id_set_contains",
          "args": [
            "&bpf_lsm_hooks",
            "prog->aux->attach_btf_id"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "btf_id_set_contains",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/btf.c",
          "lines": "6198-6201",
          "snippet": "bool btf_id_set_contains(const struct btf_id_set *set, u32 id)\n{\n\treturn bsearch(&id, set->ids, set->cnt, sizeof(u32), btf_id_cmp_func) != NULL;\n}",
          "includes": [
            "#include <linux/bpf_types.h>",
            "#include \"../tools/lib/bpf/relo_core.h\"",
            "#include <net/sock.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/skmsg.h>",
            "#include <linux/btf_ids.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf_verifier.h>",
            "#include <linux/sort.h>",
            "#include <linux/idr.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/slab.h>",
            "#include <linux/errno.h>",
            "#include <linux/ctype.h>",
            "#include <linux/compiler.h>",
            "#include <linux/seq_file.h>",
            "#include <uapi/linux/types.h>",
            "#include <uapi/linux/bpf_perf_event.h>",
            "#include <uapi/linux/bpf.h>",
            "#include <uapi/linux/btf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_types.h>\n#include \"../tools/lib/bpf/relo_core.h\"\n#include <net/sock.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/bsearch.h>\n#include <linux/perf_event.h>\n#include <linux/skmsg.h>\n#include <linux/btf_ids.h>\n#include <linux/btf.h>\n#include <linux/bpf_verifier.h>\n#include <linux/sort.h>\n#include <linux/idr.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <linux/file.h>\n#include <linux/anon_inodes.h>\n#include <linux/slab.h>\n#include <linux/errno.h>\n#include <linux/ctype.h>\n#include <linux/compiler.h>\n#include <linux/seq_file.h>\n#include <uapi/linux/types.h>\n#include <uapi/linux/bpf_perf_event.h>\n#include <uapi/linux/bpf.h>\n#include <uapi/linux/btf.h>\n\nbool btf_id_set_contains(const struct btf_id_set *set, u32 id)\n{\n\treturn bsearch(&id, set->ids, set->cnt, sizeof(u32), btf_id_cmp_func) != NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/lsm_hook_defs.h>\n#include <linux/lsm_hook_defs.h>\n#include <linux/ima.h>\n#include <linux/btf_ids.h>\n#include <linux/bpf_local_storage.h>\n#include <net/bpf_sk_storage.h>\n#include <linux/bpf_verifier.h>\n#include <linux/kallsyms.h>\n#include <linux/bpf_lsm.h>\n#include <linux/lsm_hooks.h>\n#include <linux/binfmts.h>\n#include <linux/btf.h>\n#include <linux/bpf.h>\n#include <linux/filter.h>\n\nBTF_SET_END(bpf_lsm_hooks)\n\nint bpf_lsm_verify_prog(struct bpf_verifier_log *vlog,\n\t\t\tconst struct bpf_prog *prog)\n{\n\tif (!prog->gpl_compatible) {\n\t\tbpf_log(vlog,\n\t\t\t\"LSM programs must have a GPL compatible license\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\tif (!btf_id_set_contains(&bpf_lsm_hooks, prog->aux->attach_btf_id)) {\n\t\tbpf_log(vlog, \"attach_btf_id %u points to wrong type name %s\\n\",\n\t\t\tprog->aux->attach_btf_id, prog->aux->attach_func_name);\n\t\treturn -EINVAL;\n\t}\n\n\treturn 0;\n}"
  }
]