[
  {
    "function_name": "preemptirq_delay_exit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/preemptirq_delay_test.c",
    "lines": "211-214",
    "snippet": "static void __exit preemptirq_delay_exit(void)\n{\n\tkobject_put(preemptirq_delay_kobj);\n}",
    "includes": [
      "#include <linux/completion.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/string.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/irq.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/delay.h>",
      "#include <linux/trace_clock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kobject *preemptirq_delay_kobj;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "preemptirq_delay_kobj"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "mod_kobject_put",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/module.c",
          "lines": "1804-1810",
          "snippet": "static void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel_read_file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/buildid.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/module_signature.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void cfi_cleanup(struct module *mod);",
            "static void cfi_init(struct module *mod);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel_read_file.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/buildid.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/module_signature.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void cfi_cleanup(struct module *mod);\nstatic void cfi_init(struct module *mod);\n\nstatic void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/completion.h>\n#include <linux/sysfs.h>\n#include <linux/string.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/trace_clock.h>\n\nstatic struct kobject *preemptirq_delay_kobj;\n\nstatic void __exit preemptirq_delay_exit(void)\n{\n\tkobject_put(preemptirq_delay_kobj);\n}"
  },
  {
    "function_name": "preemptirq_delay_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/preemptirq_delay_test.c",
    "lines": "191-209",
    "snippet": "static int __init preemptirq_delay_init(void)\n{\n\tint retval;\n\n\tretval = preemptirq_run_test();\n\tif (retval != 0)\n\t\treturn retval;\n\n\tpreemptirq_delay_kobj = kobject_create_and_add(\"preemptirq_delay_test\",\n\t\t\t\t\t\t       kernel_kobj);\n\tif (!preemptirq_delay_kobj)\n\t\treturn -ENOMEM;\n\n\tretval = sysfs_create_group(preemptirq_delay_kobj, &attr_group);\n\tif (retval)\n\t\tkobject_put(preemptirq_delay_kobj);\n\n\treturn retval;\n}",
    "includes": [
      "#include <linux/completion.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/string.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/irq.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/delay.h>",
      "#include <linux/trace_clock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct attribute_group attr_group = {\n\t.attrs = attrs,\n};",
      "static struct kobject *preemptirq_delay_kobj;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "preemptirq_delay_kobj"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "mod_kobject_put",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/module.c",
          "lines": "1804-1810",
          "snippet": "static void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel_read_file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/buildid.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/module_signature.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void cfi_cleanup(struct module *mod);",
            "static void cfi_init(struct module *mod);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel_read_file.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/buildid.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/module_signature.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void cfi_cleanup(struct module *mod);\nstatic void cfi_init(struct module *mod);\n\nstatic void mod_kobject_put(struct module *mod)\n{\n\tDECLARE_COMPLETION_ONSTACK(c);\n\tmod->mkobj.kobj_completion = &c;\n\tkobject_put(&mod->mkobj.kobj);\n\twait_for_completion(&c);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sysfs_create_group",
          "args": [
            "preemptirq_delay_kobj",
            "&attr_group"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_create_and_add",
          "args": [
            "\"preemptirq_delay_test\"",
            "kernel_kobj"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preemptirq_run_test",
          "args": [],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "preemptirq_run_test",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/preemptirq_delay_test.c",
          "lines": "147-163",
          "snippet": "static int preemptirq_run_test(void)\n{\n\tstruct task_struct *task;\n\tchar task_name[50];\n\n\tinit_completion(&done);\n\n\tsnprintf(task_name, sizeof(task_name), \"%s_test\", test_mode);\n\ttask =  kthread_run(preemptirq_delay_run, NULL, task_name);\n\tif (IS_ERR(task))\n\t\treturn PTR_ERR(task);\n\tif (task) {\n\t\twait_for_completion(&done);\n\t\tkthread_stop(task);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/completion.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/string.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/delay.h>",
            "#include <linux/trace_clock.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char test_mode[12] = \"irq\";",
            "static struct completion done;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/completion.h>\n#include <linux/sysfs.h>\n#include <linux/string.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/trace_clock.h>\n\nstatic char test_mode[12] = \"irq\";\nstatic struct completion done;\n\nstatic int preemptirq_run_test(void)\n{\n\tstruct task_struct *task;\n\tchar task_name[50];\n\n\tinit_completion(&done);\n\n\tsnprintf(task_name, sizeof(task_name), \"%s_test\", test_mode);\n\ttask =  kthread_run(preemptirq_delay_run, NULL, task_name);\n\tif (IS_ERR(task))\n\t\treturn PTR_ERR(task);\n\tif (task) {\n\t\twait_for_completion(&done);\n\t\tkthread_stop(task);\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/completion.h>\n#include <linux/sysfs.h>\n#include <linux/string.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/trace_clock.h>\n\nstatic struct attribute_group attr_group = {\n\t.attrs = attrs,\n};\nstatic struct kobject *preemptirq_delay_kobj;\n\nstatic int __init preemptirq_delay_init(void)\n{\n\tint retval;\n\n\tretval = preemptirq_run_test();\n\tif (retval != 0)\n\t\treturn retval;\n\n\tpreemptirq_delay_kobj = kobject_create_and_add(\"preemptirq_delay_test\",\n\t\t\t\t\t\t       kernel_kobj);\n\tif (!preemptirq_delay_kobj)\n\t\treturn -ENOMEM;\n\n\tretval = sysfs_create_group(preemptirq_delay_kobj, &attr_group);\n\tif (retval)\n\t\tkobject_put(preemptirq_delay_kobj);\n\n\treturn retval;\n}"
  },
  {
    "function_name": "trigger_store",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/preemptirq_delay_test.c",
    "lines": "166-175",
    "snippet": "static ssize_t trigger_store(struct kobject *kobj, struct kobj_attribute *attr,\n\t\t\t const char *buf, size_t count)\n{\n\tssize_t ret;\n\n\tret = preemptirq_run_test();\n\tif (ret)\n\t\treturn ret;\n\treturn count;\n}",
    "includes": [
      "#include <linux/completion.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/string.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/irq.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/delay.h>",
      "#include <linux/trace_clock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preemptirq_run_test",
          "args": [],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "preemptirq_run_test",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/preemptirq_delay_test.c",
          "lines": "147-163",
          "snippet": "static int preemptirq_run_test(void)\n{\n\tstruct task_struct *task;\n\tchar task_name[50];\n\n\tinit_completion(&done);\n\n\tsnprintf(task_name, sizeof(task_name), \"%s_test\", test_mode);\n\ttask =  kthread_run(preemptirq_delay_run, NULL, task_name);\n\tif (IS_ERR(task))\n\t\treturn PTR_ERR(task);\n\tif (task) {\n\t\twait_for_completion(&done);\n\t\tkthread_stop(task);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/completion.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/string.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/delay.h>",
            "#include <linux/trace_clock.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char test_mode[12] = \"irq\";",
            "static struct completion done;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/completion.h>\n#include <linux/sysfs.h>\n#include <linux/string.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/trace_clock.h>\n\nstatic char test_mode[12] = \"irq\";\nstatic struct completion done;\n\nstatic int preemptirq_run_test(void)\n{\n\tstruct task_struct *task;\n\tchar task_name[50];\n\n\tinit_completion(&done);\n\n\tsnprintf(task_name, sizeof(task_name), \"%s_test\", test_mode);\n\ttask =  kthread_run(preemptirq_delay_run, NULL, task_name);\n\tif (IS_ERR(task))\n\t\treturn PTR_ERR(task);\n\tif (task) {\n\t\twait_for_completion(&done);\n\t\tkthread_stop(task);\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/completion.h>\n#include <linux/sysfs.h>\n#include <linux/string.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/trace_clock.h>\n\nstatic ssize_t trigger_store(struct kobject *kobj, struct kobj_attribute *attr,\n\t\t\t const char *buf, size_t count)\n{\n\tssize_t ret;\n\n\tret = preemptirq_run_test();\n\tif (ret)\n\t\treturn ret;\n\treturn count;\n}"
  },
  {
    "function_name": "preemptirq_run_test",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/preemptirq_delay_test.c",
    "lines": "147-163",
    "snippet": "static int preemptirq_run_test(void)\n{\n\tstruct task_struct *task;\n\tchar task_name[50];\n\n\tinit_completion(&done);\n\n\tsnprintf(task_name, sizeof(task_name), \"%s_test\", test_mode);\n\ttask =  kthread_run(preemptirq_delay_run, NULL, task_name);\n\tif (IS_ERR(task))\n\t\treturn PTR_ERR(task);\n\tif (task) {\n\t\twait_for_completion(&done);\n\t\tkthread_stop(task);\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <linux/completion.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/string.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/irq.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/delay.h>",
      "#include <linux/trace_clock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char test_mode[12] = \"irq\";",
      "static struct completion done;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kthread_stop",
          "args": [
            "task"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "kthread_stop",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/kthread.c",
          "lines": "697-715",
          "snippet": "int kthread_stop(struct task_struct *k)\n{\n\tstruct kthread *kthread;\n\tint ret;\n\n\ttrace_sched_kthread_stop(k);\n\n\tget_task_struct(k);\n\tkthread = to_kthread(k);\n\tset_bit(KTHREAD_SHOULD_STOP, &kthread->flags);\n\tkthread_unpark(k);\n\twake_up_process(k);\n\twait_for_completion(&kthread->exited);\n\tret = kthread->result;\n\tput_task_struct(k);\n\n\ttrace_sched_kthread_stop_ret(ret);\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/numa.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/freezer.h>",
            "#include <linux/slab.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/file.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/err.h>",
            "#include <linux/completion.h>",
            "#include <linux/kthread.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/mmu_context.h>",
            "#include <linux/mm.h>",
            "#include <uapi/linux/sched/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include <linux/sched/isolation.h>\n#include <linux/numa.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/freezer.h>\n#include <linux/slab.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/file.h>\n#include <linux/unistd.h>\n#include <linux/cpuset.h>\n#include <linux/cgroup.h>\n#include <linux/err.h>\n#include <linux/completion.h>\n#include <linux/kthread.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/mmu_context.h>\n#include <linux/mm.h>\n#include <uapi/linux/sched/types.h>\n\nint kthread_stop(struct task_struct *k)\n{\n\tstruct kthread *kthread;\n\tint ret;\n\n\ttrace_sched_kthread_stop(k);\n\n\tget_task_struct(k);\n\tkthread = to_kthread(k);\n\tset_bit(KTHREAD_SHOULD_STOP, &kthread->flags);\n\tkthread_unpark(k);\n\twake_up_process(k);\n\twait_for_completion(&kthread->exited);\n\tret = kthread->result;\n\tput_task_struct(k);\n\n\ttrace_sched_kthread_stop_ret(ret);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "wait_for_completion",
          "args": [
            "&done"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "try_wait_for_completion",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/completion.c",
          "lines": "282-303",
          "snippet": "bool try_wait_for_completion(struct completion *x)\n{\n\tunsigned long flags;\n\tbool ret = true;\n\n\t/*\n\t * Since x->done will need to be locked only\n\t * in the non-blocking case, we check x->done\n\t * first without taking the lock so we can\n\t * return early in the blocking case.\n\t */\n\tif (!READ_ONCE(x->done))\n\t\treturn false;\n\n\traw_spin_lock_irqsave(&x->wait.lock, flags);\n\tif (!x->done)\n\t\tret = false;\n\telse if (x->done != UINT_MAX)\n\t\tx->done--;\n\traw_spin_unlock_irqrestore(&x->wait.lock, flags);\n\treturn ret;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nbool try_wait_for_completion(struct completion *x)\n{\n\tunsigned long flags;\n\tbool ret = true;\n\n\t/*\n\t * Since x->done will need to be locked only\n\t * in the non-blocking case, we check x->done\n\t * first without taking the lock so we can\n\t * return early in the blocking case.\n\t */\n\tif (!READ_ONCE(x->done))\n\t\treturn false;\n\n\traw_spin_lock_irqsave(&x->wait.lock, flags);\n\tif (!x->done)\n\t\tret = false;\n\telse if (x->done != UINT_MAX)\n\t\tx->done--;\n\traw_spin_unlock_irqrestore(&x->wait.lock, flags);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "task"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "task"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kthread_run",
          "args": [
            "preemptirq_delay_run",
            "NULL",
            "task_name"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "task_name",
            "sizeof(task_name)",
            "\"%s_test\"",
            "test_mode"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_completion",
          "args": [
            "&done"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/completion.h>\n#include <linux/sysfs.h>\n#include <linux/string.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/trace_clock.h>\n\nstatic char test_mode[12] = \"irq\";\nstatic struct completion done;\n\nstatic int preemptirq_run_test(void)\n{\n\tstruct task_struct *task;\n\tchar task_name[50];\n\n\tinit_completion(&done);\n\n\tsnprintf(task_name, sizeof(task_name), \"%s_test\", test_mode);\n\ttask =  kthread_run(preemptirq_delay_run, NULL, task_name);\n\tif (IS_ERR(task))\n\t\treturn PTR_ERR(task);\n\tif (task) {\n\t\twait_for_completion(&done);\n\t\tkthread_stop(task);\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "preemptirq_delay_run",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/preemptirq_delay_test.c",
    "lines": "118-145",
    "snippet": "static int preemptirq_delay_run(void *data)\n{\n\tint i;\n\tint s = MIN(burst_size, NR_TEST_FUNCS);\n\tstruct cpumask cpu_mask;\n\n\tif (cpu_affinity > -1) {\n\t\tcpumask_clear(&cpu_mask);\n\t\tcpumask_set_cpu(cpu_affinity, &cpu_mask);\n\t\tif (set_cpus_allowed_ptr(current, &cpu_mask))\n\t\t\tpr_err(\"cpu_affinity:%d, failed\\n\", cpu_affinity);\n\t}\n\n\tfor (i = 0; i < s; i++)\n\t\t(testfuncs[i])(i);\n\n\tcomplete(&done);\n\n\tset_current_state(TASK_INTERRUPTIBLE);\n\twhile (!kthread_should_stop()) {\n\t\tschedule();\n\t\tset_current_state(TASK_INTERRUPTIBLE);\n\t}\n\n\t__set_current_state(TASK_RUNNING);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/completion.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/string.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/irq.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/delay.h>",
      "#include <linux/trace_clock.h>"
    ],
    "macros_used": [
      "#define NR_TEST_FUNCS ARRAY_SIZE(testfuncs)"
    ],
    "globals_used": [
      "static uint burst_size = 1;",
      "static int  cpu_affinity = -1;",
      "static struct completion done;",
      "static void (*testfuncs[])(int)  = {\n\tpreemptirqtest_0,\n\tpreemptirqtest_1,\n\tpreemptirqtest_2,\n\tpreemptirqtest_3,\n\tpreemptirqtest_4,\n\tpreemptirqtest_5,\n\tpreemptirqtest_6,\n\tpreemptirqtest_7,\n\tpreemptirqtest_8,\n\tpreemptirqtest_9,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__set_current_state",
          "args": [
            "TASK_RUNNING"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_current_state",
          "args": [
            "TASK_INTERRUPTIBLE"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schedule",
          "args": [],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "audit_schedule_prune",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/audit_tree.c",
          "lines": "963-966",
          "snippet": "static void audit_schedule_prune(void)\n{\n\twake_up_process(prune_thread);\n}",
          "includes": [
            "#include <linux/slab.h>",
            "#include <linux/refcount.h>",
            "#include <linux/kthread.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/fsnotify_backend.h>",
            "#include \"audit.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct task_struct *prune_thread;",
            "static void audit_schedule_prune(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/slab.h>\n#include <linux/refcount.h>\n#include <linux/kthread.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/fsnotify_backend.h>\n#include \"audit.h\"\n\nstatic struct task_struct *prune_thread;\nstatic void audit_schedule_prune(void);\n\nstatic void audit_schedule_prune(void)\n{\n\twake_up_process(prune_thread);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kthread_should_stop",
          "args": [],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "kthread_should_stop",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/kthread.c",
          "lines": "156-159",
          "snippet": "bool kthread_should_stop(void)\n{\n\treturn test_bit(KTHREAD_SHOULD_STOP, &to_kthread(current)->flags);\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/numa.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/freezer.h>",
            "#include <linux/slab.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/file.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/err.h>",
            "#include <linux/completion.h>",
            "#include <linux/kthread.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/mmu_context.h>",
            "#include <linux/mm.h>",
            "#include <uapi/linux/sched/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include <linux/sched/isolation.h>\n#include <linux/numa.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/freezer.h>\n#include <linux/slab.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/file.h>\n#include <linux/unistd.h>\n#include <linux/cpuset.h>\n#include <linux/cgroup.h>\n#include <linux/err.h>\n#include <linux/completion.h>\n#include <linux/kthread.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/mmu_context.h>\n#include <linux/mm.h>\n#include <uapi/linux/sched/types.h>\n\nbool kthread_should_stop(void)\n{\n\treturn test_bit(KTHREAD_SHOULD_STOP, &to_kthread(current)->flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_current_state",
          "args": [
            "TASK_INTERRUPTIBLE"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "complete",
          "args": [
            "&done"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "complete_vfork_done",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/fork.c",
          "lines": "1334-1345",
          "snippet": "static void complete_vfork_done(struct task_struct *tsk)\n{\n\tstruct completion *vfork;\n\n\ttask_lock(tsk);\n\tvfork = tsk->vfork_done;\n\tif (likely(vfork)) {\n\t\ttsk->vfork_done = NULL;\n\t\tcomplete(vfork);\n\t}\n\ttask_unlock(tsk);\n}",
          "includes": [
            "#include <linux/init_task.h>",
            "#include <trace/events/task.h>",
            "#include <trace/events/sched.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/cacheflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/pgalloc.h>",
            "#include <linux/bpf.h>",
            "#include <linux/io_uring.h>",
            "#include <linux/scs.h>",
            "#include <linux/kasan.h>",
            "#include <linux/stackleak.h>",
            "#include <linux/thread_info.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/kcov.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/compiler.h>",
            "#include <linux/aio.h>",
            "#include <linux/uprobes.h>",
            "#include <linux/signalfd.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/oom.h>",
            "#include <linux/user-return-notifier.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/magic.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/tty.h>",
            "#include <linux/random.h>",
            "#include <linux/taskstats_kern.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/acct.h>",
            "#include <linux/ksm.h>",
            "#include <linux/rmap.h>",
            "#include <linux/profile.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/kthread.h>",
            "#include <linux/compat.h>",
            "#include <linux/futex.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swap.h>",
            "#include <linux/seccomp.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/security.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mman.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/key.h>",
            "#include <linux/iocontext.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/sem.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/personality.h>",
            "#include <linux/completion.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/module.h>",
            "#include <linux/unistd.h>",
            "#include <linux/init.h>",
            "#include <linux/rtmutex.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/slab.h>",
            "#include <linux/anon_inodes.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __latent_entropy struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/init_task.h>\n#include <trace/events/task.h>\n#include <trace/events/sched.h>\n#include <asm/tlbflush.h>\n#include <asm/cacheflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <asm/pgalloc.h>\n#include <linux/bpf.h>\n#include <linux/io_uring.h>\n#include <linux/scs.h>\n#include <linux/kasan.h>\n#include <linux/stackleak.h>\n#include <linux/thread_info.h>\n#include <linux/livepatch.h>\n#include <linux/kcov.h>\n#include <linux/sysctl.h>\n#include <linux/compiler.h>\n#include <linux/aio.h>\n#include <linux/uprobes.h>\n#include <linux/signalfd.h>\n#include <linux/khugepaged.h>\n#include <linux/oom.h>\n#include <linux/user-return-notifier.h>\n#include <linux/posix-timers.h>\n#include <linux/perf_event.h>\n#include <linux/magic.h>\n#include <linux/fs_struct.h>\n#include <linux/tty.h>\n#include <linux/random.h>\n#include <linux/taskstats_kern.h>\n#include <linux/delayacct.h>\n#include <linux/freezer.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/acct.h>\n#include <linux/ksm.h>\n#include <linux/rmap.h>\n#include <linux/profile.h>\n#include <linux/proc_fs.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/ptrace.h>\n#include <linux/rcupdate.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/kthread.h>\n#include <linux/compat.h>\n#include <linux/futex.h>\n#include <linux/jiffies.h>\n#include <linux/syscalls.h>\n#include <linux/swap.h>\n#include <linux/seccomp.h>\n#include <linux/hugetlb.h>\n#include <linux/security.h>\n#include <linux/cgroup.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/nsproxy.h>\n#include <linux/vmacache.h>\n#include <linux/mm_inline.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mman.h>\n#include <linux/binfmts.h>\n#include <linux/key.h>\n#include <linux/iocontext.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/sem.h>\n#include <linux/mempolicy.h>\n#include <linux/personality.h>\n#include <linux/completion.h>\n#include <linux/vmalloc.h>\n#include <linux/module.h>\n#include <linux/unistd.h>\n#include <linux/init.h>\n#include <linux/rtmutex.h>\n#include <linux/seq_file.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/user.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/autogroup.h>\n#include <linux/slab.h>\n#include <linux/anon_inodes.h>\n\nstatic __latent_entropy struct;\n\nstatic void complete_vfork_done(struct task_struct *tsk)\n{\n\tstruct completion *vfork;\n\n\ttask_lock(tsk);\n\tvfork = tsk->vfork_done;\n\tif (likely(vfork)) {\n\t\ttsk->vfork_done = NULL;\n\t\tcomplete(vfork);\n\t}\n\ttask_unlock(tsk);\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "i"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"cpu_affinity:%d, failed\\n\"",
            "cpu_affinity"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_cpus_allowed_ptr",
          "args": [
            "current",
            "&cpu_mask"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "set_cpus_allowed_ptr",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "2888-2891",
          "snippet": "int set_cpus_allowed_ptr(struct task_struct *p, const struct cpumask *new_mask)\n{\n\treturn __set_cpus_allowed_ptr(p, new_mask, 0);\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic __always_inline struct;\n\nint set_cpus_allowed_ptr(struct task_struct *p, const struct cpumask *new_mask)\n{\n\treturn __set_cpus_allowed_ptr(p, new_mask, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "cpu_affinity",
            "&cpu_mask"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_clear",
          "args": [
            "&cpu_mask"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MIN",
          "args": [
            "burst_size",
            "NR_TEST_FUNCS"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/completion.h>\n#include <linux/sysfs.h>\n#include <linux/string.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/trace_clock.h>\n\n#define NR_TEST_FUNCS ARRAY_SIZE(testfuncs)\n\nstatic uint burst_size = 1;\nstatic int  cpu_affinity = -1;\nstatic struct completion done;\nstatic void (*testfuncs[])(int)  = {\n\tpreemptirqtest_0,\n\tpreemptirqtest_1,\n\tpreemptirqtest_2,\n\tpreemptirqtest_3,\n\tpreemptirqtest_4,\n\tpreemptirqtest_5,\n\tpreemptirqtest_6,\n\tpreemptirqtest_7,\n\tpreemptirqtest_8,\n\tpreemptirqtest_9,\n};\n\nstatic int preemptirq_delay_run(void *data)\n{\n\tint i;\n\tint s = MIN(burst_size, NR_TEST_FUNCS);\n\tstruct cpumask cpu_mask;\n\n\tif (cpu_affinity > -1) {\n\t\tcpumask_clear(&cpu_mask);\n\t\tcpumask_set_cpu(cpu_affinity, &cpu_mask);\n\t\tif (set_cpus_allowed_ptr(current, &cpu_mask))\n\t\t\tpr_err(\"cpu_affinity:%d, failed\\n\", cpu_affinity);\n\t}\n\n\tfor (i = 0; i < s; i++)\n\t\t(testfuncs[i])(i);\n\n\tcomplete(&done);\n\n\tset_current_state(TASK_INTERRUPTIBLE);\n\twhile (!kthread_should_stop()) {\n\t\tschedule();\n\t\tset_current_state(TASK_INTERRUPTIBLE);\n\t}\n\n\t__set_current_state(TASK_RUNNING);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "execute_preemptirqtest",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/preemptirq_delay_test.c",
    "lines": "68-80",
    "snippet": "static void execute_preemptirqtest(int idx)\n{\n\tif (!strcmp(test_mode, \"irq\"))\n\t\tirqoff_test();\n\telse if (!strcmp(test_mode, \"preempt\"))\n\t\tpreemptoff_test();\n\telse if (!strcmp(test_mode, \"alternate\")) {\n\t\tif (idx % 2 == 0)\n\t\t\tirqoff_test();\n\t\telse\n\t\t\tpreemptoff_test();\n\t}\n}",
    "includes": [
      "#include <linux/completion.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/string.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/irq.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/delay.h>",
      "#include <linux/trace_clock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char test_mode[12] = \"irq\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "preemptoff_test",
          "args": [],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "preemptoff_test",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/preemptirq_delay_test.c",
          "lines": "61-66",
          "snippet": "static __always_inline void preemptoff_test(void)\n{\n\tpreempt_disable();\n\tbusy_wait(delay);\n\tpreempt_enable();\n}",
          "includes": [
            "#include <linux/completion.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/string.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/delay.h>",
            "#include <linux/trace_clock.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ulong delay = 100;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/completion.h>\n#include <linux/sysfs.h>\n#include <linux/string.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/trace_clock.h>\n\nstatic ulong delay = 100;\n\nstatic __always_inline void preemptoff_test(void)\n{\n\tpreempt_disable();\n\tbusy_wait(delay);\n\tpreempt_enable();\n}"
        }
      },
      {
        "call_info": {
          "callee": "irqoff_test",
          "args": [],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "irqoff_test",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/preemptirq_delay_test.c",
          "lines": "52-59",
          "snippet": "static __always_inline void irqoff_test(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tbusy_wait(delay);\n\tlocal_irq_restore(flags);\n}",
          "includes": [
            "#include <linux/completion.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/string.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/delay.h>",
            "#include <linux/trace_clock.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static ulong delay = 100;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/completion.h>\n#include <linux/sysfs.h>\n#include <linux/string.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/trace_clock.h>\n\nstatic ulong delay = 100;\n\nstatic __always_inline void irqoff_test(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tbusy_wait(delay);\n\tlocal_irq_restore(flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "test_mode",
            "\"alternate\""
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "sym_strcmp",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/kcsan/report.c",
          "lines": "356-365",
          "snippet": "static int sym_strcmp(void *addr1, void *addr2)\n{\n\tchar buf1[64];\n\tchar buf2[64];\n\n\tsnprintf(buf1, sizeof(buf1), \"%pS\", addr1);\n\tsnprintf(buf2, sizeof(buf2), \"%pS\", addr2);\n\n\treturn strncmp(buf1, buf2, sizeof(buf1));\n}",
          "includes": [
            "#include \"encoding.h\"",
            "#include \"kcsan.h\"",
            "#include <linux/stacktrace.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/preempt.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/delay.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"encoding.h\"\n#include \"kcsan.h\"\n#include <linux/stacktrace.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/preempt.h>\n#include <linux/lockdep.h>\n#include <linux/kernel.h>\n#include <linux/kallsyms.h>\n#include <linux/jiffies.h>\n#include <linux/delay.h>\n#include <linux/debug_locks.h>\n\nstatic int sym_strcmp(void *addr1, void *addr2)\n{\n\tchar buf1[64];\n\tchar buf2[64];\n\n\tsnprintf(buf1, sizeof(buf1), \"%pS\", addr1);\n\tsnprintf(buf2, sizeof(buf2), \"%pS\", addr2);\n\n\treturn strncmp(buf1, buf2, sizeof(buf1));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/completion.h>\n#include <linux/sysfs.h>\n#include <linux/string.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/trace_clock.h>\n\nstatic char test_mode[12] = \"irq\";\n\nstatic void execute_preemptirqtest(int idx)\n{\n\tif (!strcmp(test_mode, \"irq\"))\n\t\tirqoff_test();\n\telse if (!strcmp(test_mode, \"preempt\"))\n\t\tpreemptoff_test();\n\telse if (!strcmp(test_mode, \"alternate\")) {\n\t\tif (idx % 2 == 0)\n\t\t\tirqoff_test();\n\t\telse\n\t\t\tpreemptoff_test();\n\t}\n}"
  },
  {
    "function_name": "preemptoff_test",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/preemptirq_delay_test.c",
    "lines": "61-66",
    "snippet": "static __always_inline void preemptoff_test(void)\n{\n\tpreempt_disable();\n\tbusy_wait(delay);\n\tpreempt_enable();\n}",
    "includes": [
      "#include <linux/completion.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/string.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/irq.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/delay.h>",
      "#include <linux/trace_clock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ulong delay = 100;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "busy_wait",
          "args": [
            "delay"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "busy_wait",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/preemptirq_delay_test.c",
          "lines": "39-50",
          "snippet": "static void busy_wait(ulong time)\n{\n\tu64 start, end;\n\n\tstart = trace_clock_local();\n\n\tdo {\n\t\tend = trace_clock_local();\n\t\tif (kthread_should_stop())\n\t\t\tbreak;\n\t} while ((end - start) < (time * 1000));\n}",
          "includes": [
            "#include <linux/completion.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/string.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/delay.h>",
            "#include <linux/trace_clock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/completion.h>\n#include <linux/sysfs.h>\n#include <linux/string.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/trace_clock.h>\n\nstatic void busy_wait(ulong time)\n{\n\tu64 start, end;\n\n\tstart = trace_clock_local();\n\n\tdo {\n\t\tend = trace_clock_local();\n\t\tif (kthread_should_stop())\n\t\t\tbreak;\n\t} while ((end - start) < (time * 1000));\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "6425-6430",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/completion.h>\n#include <linux/sysfs.h>\n#include <linux/string.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/trace_clock.h>\n\nstatic ulong delay = 100;\n\nstatic __always_inline void preemptoff_test(void)\n{\n\tpreempt_disable();\n\tbusy_wait(delay);\n\tpreempt_enable();\n}"
  },
  {
    "function_name": "irqoff_test",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/preemptirq_delay_test.c",
    "lines": "52-59",
    "snippet": "static __always_inline void irqoff_test(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tbusy_wait(delay);\n\tlocal_irq_restore(flags);\n}",
    "includes": [
      "#include <linux/completion.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/string.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/irq.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/delay.h>",
      "#include <linux/trace_clock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static ulong delay = 100;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_irq_restore",
          "args": [
            "flags"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "busy_wait",
          "args": [
            "delay"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "busy_wait",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/preemptirq_delay_test.c",
          "lines": "39-50",
          "snippet": "static void busy_wait(ulong time)\n{\n\tu64 start, end;\n\n\tstart = trace_clock_local();\n\n\tdo {\n\t\tend = trace_clock_local();\n\t\tif (kthread_should_stop())\n\t\t\tbreak;\n\t} while ((end - start) < (time * 1000));\n}",
          "includes": [
            "#include <linux/completion.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/string.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/delay.h>",
            "#include <linux/trace_clock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/completion.h>\n#include <linux/sysfs.h>\n#include <linux/string.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/trace_clock.h>\n\nstatic void busy_wait(ulong time)\n{\n\tu64 start, end;\n\n\tstart = trace_clock_local();\n\n\tdo {\n\t\tend = trace_clock_local();\n\t\tif (kthread_should_stop())\n\t\t\tbreak;\n\t} while ((end - start) < (time * 1000));\n}"
        }
      },
      {
        "call_info": {
          "callee": "local_irq_save",
          "args": [
            "flags"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/completion.h>\n#include <linux/sysfs.h>\n#include <linux/string.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/trace_clock.h>\n\nstatic ulong delay = 100;\n\nstatic __always_inline void irqoff_test(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tbusy_wait(delay);\n\tlocal_irq_restore(flags);\n}"
  },
  {
    "function_name": "busy_wait",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/preemptirq_delay_test.c",
    "lines": "39-50",
    "snippet": "static void busy_wait(ulong time)\n{\n\tu64 start, end;\n\n\tstart = trace_clock_local();\n\n\tdo {\n\t\tend = trace_clock_local();\n\t\tif (kthread_should_stop())\n\t\t\tbreak;\n\t} while ((end - start) < (time * 1000));\n}",
    "includes": [
      "#include <linux/completion.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/string.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/kthread.h>",
      "#include <linux/kobject.h>",
      "#include <linux/kernel.h>",
      "#include <linux/irq.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/delay.h>",
      "#include <linux/trace_clock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kthread_should_stop",
          "args": [],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "kthread_should_stop",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/kthread.c",
          "lines": "156-159",
          "snippet": "bool kthread_should_stop(void)\n{\n\treturn test_bit(KTHREAD_SHOULD_STOP, &to_kthread(current)->flags);\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/numa.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/freezer.h>",
            "#include <linux/slab.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/file.h>",
            "#include <linux/unistd.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/err.h>",
            "#include <linux/completion.h>",
            "#include <linux/kthread.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/mmu_context.h>",
            "#include <linux/mm.h>",
            "#include <uapi/linux/sched/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include <linux/sched/isolation.h>\n#include <linux/numa.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/freezer.h>\n#include <linux/slab.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/file.h>\n#include <linux/unistd.h>\n#include <linux/cpuset.h>\n#include <linux/cgroup.h>\n#include <linux/err.h>\n#include <linux/completion.h>\n#include <linux/kthread.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/mmu_context.h>\n#include <linux/mm.h>\n#include <uapi/linux/sched/types.h>\n\nbool kthread_should_stop(void)\n{\n\treturn test_bit(KTHREAD_SHOULD_STOP, &to_kthread(current)->flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_clock_local",
          "args": [],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "trace_clock_local",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/trace_clock.c",
          "lines": "32-46",
          "snippet": "u64 notrace trace_clock_local(void)\n{\n\tu64 clock;\n\n\t/*\n\t * sched_clock() is an architecture implemented, fast, scalable,\n\t * lockless clock. It is not guaranteed to be coherent across\n\t * CPUs, nor across CPU idle events.\n\t */\n\tpreempt_disable_notrace();\n\tclock = sched_clock();\n\tpreempt_enable_notrace();\n\n\treturn clock;\n}",
          "includes": [
            "#include <linux/trace_clock.h>",
            "#include <linux/ktime.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/percpu.h>",
            "#include <linux/module.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/trace_clock.h>\n#include <linux/ktime.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/percpu.h>\n#include <linux/module.h>\n#include <linux/hardirq.h>\n#include <linux/irqflags.h>\n#include <linux/spinlock.h>\n\nu64 notrace trace_clock_local(void)\n{\n\tu64 clock;\n\n\t/*\n\t * sched_clock() is an architecture implemented, fast, scalable,\n\t * lockless clock. It is not guaranteed to be coherent across\n\t * CPUs, nor across CPU idle events.\n\t */\n\tpreempt_disable_notrace();\n\tclock = sched_clock();\n\tpreempt_enable_notrace();\n\n\treturn clock;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/completion.h>\n#include <linux/sysfs.h>\n#include <linux/string.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/kthread.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/delay.h>\n#include <linux/trace_clock.h>\n\nstatic void busy_wait(ulong time)\n{\n\tu64 start, end;\n\n\tstart = trace_clock_local();\n\n\tdo {\n\t\tend = trace_clock_local();\n\t\tif (kthread_should_stop())\n\t\t\tbreak;\n\t} while ((end - start) < (time * 1000));\n}"
  }
]