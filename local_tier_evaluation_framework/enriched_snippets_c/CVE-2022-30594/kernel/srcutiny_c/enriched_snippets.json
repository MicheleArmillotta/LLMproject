[
  {
    "function_name": "srcu_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
    "lines": "261-272",
    "snippet": "void __init srcu_init(void)\n{\n\tstruct srcu_struct *ssp;\n\n\tsrcu_init_done = true;\n\twhile (!list_empty(&srcu_boot_list)) {\n\t\tssp = list_first_entry(&srcu_boot_list,\n\t\t\t\t      struct srcu_struct, srcu_work.entry);\n\t\tlist_del_init(&ssp->srcu_work.entry);\n\t\tschedule_work(&ssp->srcu_work);\n\t}\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcu_node_tree.h>",
      "#include <linux/srcu.h>",
      "#include <linux/delay.h>",
      "#include <linux/sched.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/preempt.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(srcu_boot_list);",
      "static bool srcu_init_done;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "schedule_work",
          "args": [
            "&ssp->srcu_work"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&ssp->srcu_work.entry"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_first_entry",
          "args": [
            "&srcu_boot_list",
            "structsrcu_struct",
            "srcu_work.entry"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&srcu_boot_list"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_empty",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "41-44",
          "snippet": "static inline bool rcu_segcblist_empty(struct rcu_segcblist *rsclp)\n{\n\treturn !READ_ONCE(rsclp->head);\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_empty(struct rcu_segcblist *rsclp)\n{\n\treturn !READ_ONCE(rsclp->head);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(srcu_boot_list);\nstatic bool srcu_init_done;\n\nvoid __init srcu_init(void)\n{\n\tstruct srcu_struct *ssp;\n\n\tsrcu_init_done = true;\n\twhile (!list_empty(&srcu_boot_list)) {\n\t\tssp = list_first_entry(&srcu_boot_list,\n\t\t\t\t      struct srcu_struct, srcu_work.entry);\n\t\tlist_del_init(&ssp->srcu_work.entry);\n\t\tschedule_work(&ssp->srcu_work);\n\t}\n}"
  },
  {
    "function_name": "rcu_scheduler_starting",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
    "lines": "251-254",
    "snippet": "void __init rcu_scheduler_starting(void)\n{\n\trcu_scheduler_active = RCU_SCHEDULER_RUNNING;\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcu_node_tree.h>",
      "#include <linux/srcu.h>",
      "#include <linux/delay.h>",
      "#include <linux/sched.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/preempt.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int rcu_scheduler_active"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nint rcu_scheduler_active;\n\nvoid __init rcu_scheduler_starting(void)\n{\n\trcu_scheduler_active = RCU_SCHEDULER_RUNNING;\n}"
  },
  {
    "function_name": "poll_state_synchronize_srcu",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
    "lines": "241-247",
    "snippet": "bool poll_state_synchronize_srcu(struct srcu_struct *ssp, unsigned long cookie)\n{\n\tbool ret = USHORT_CMP_GE(READ_ONCE(ssp->srcu_idx), cookie);\n\n\tbarrier();\n\treturn ret;\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcu_node_tree.h>",
      "#include <linux/srcu.h>",
      "#include <linux/delay.h>",
      "#include <linux/sched.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/preempt.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "barrier",
          "args": [],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_barrier_tasks_trace",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tasks.h",
          "lines": "1569-1572",
          "snippet": "void rcu_barrier_tasks_trace(void)\n{\n\trcu_barrier_tasks_generic(&rcu_tasks_trace);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n\nvoid rcu_barrier_tasks_trace(void)\n{\n\trcu_barrier_tasks_generic(&rcu_tasks_trace);\n}"
        }
      },
      {
        "call_info": {
          "callee": "USHORT_CMP_GE",
          "args": [
            "READ_ONCE(ssp->srcu_idx)",
            "cookie"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "ssp->srcu_idx"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nbool poll_state_synchronize_srcu(struct srcu_struct *ssp, unsigned long cookie)\n{\n\tbool ret = USHORT_CMP_GE(READ_ONCE(ssp->srcu_idx), cookie);\n\n\tbarrier();\n\treturn ret;\n}"
  },
  {
    "function_name": "start_poll_synchronize_srcu",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
    "lines": "229-235",
    "snippet": "unsigned long start_poll_synchronize_srcu(struct srcu_struct *ssp)\n{\n\tunsigned long ret = get_state_synchronize_srcu(ssp);\n\n\tsrcu_gp_start_if_needed(ssp);\n\treturn ret;\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcu_node_tree.h>",
      "#include <linux/srcu.h>",
      "#include <linux/delay.h>",
      "#include <linux/sched.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/preempt.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "srcu_gp_start_if_needed",
          "args": [
            "ssp"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "srcu_gp_start_if_needed",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
          "lines": "158-172",
          "snippet": "static void srcu_gp_start_if_needed(struct srcu_struct *ssp)\n{\n\tunsigned short cookie;\n\n\tcookie = get_state_synchronize_srcu(ssp);\n\tif (USHORT_CMP_GE(READ_ONCE(ssp->srcu_idx_max), cookie))\n\t\treturn;\n\tWRITE_ONCE(ssp->srcu_idx_max, cookie);\n\tif (!READ_ONCE(ssp->srcu_gp_running)) {\n\t\tif (likely(srcu_init_done))\n\t\t\tschedule_work(&ssp->srcu_work);\n\t\telse if (list_empty(&ssp->srcu_work.entry))\n\t\t\tlist_add(&ssp->srcu_work.entry, &srcu_boot_list);\n\t}\n}",
          "includes": [
            "#include \"rcu.h\"",
            "#include \"rcu_segcblist.h\"",
            "#include <linux/rcu_node_tree.h>",
            "#include <linux/srcu.h>",
            "#include <linux/delay.h>",
            "#include <linux/sched.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/preempt.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(srcu_boot_list);",
            "static bool srcu_init_done;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(srcu_boot_list);\nstatic bool srcu_init_done;\n\nstatic void srcu_gp_start_if_needed(struct srcu_struct *ssp)\n{\n\tunsigned short cookie;\n\n\tcookie = get_state_synchronize_srcu(ssp);\n\tif (USHORT_CMP_GE(READ_ONCE(ssp->srcu_idx_max), cookie))\n\t\treturn;\n\tWRITE_ONCE(ssp->srcu_idx_max, cookie);\n\tif (!READ_ONCE(ssp->srcu_gp_running)) {\n\t\tif (likely(srcu_init_done))\n\t\t\tschedule_work(&ssp->srcu_work);\n\t\telse if (list_empty(&ssp->srcu_work.entry))\n\t\t\tlist_add(&ssp->srcu_work.entry, &srcu_boot_list);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_state_synchronize_srcu",
          "args": [
            "ssp"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "get_state_synchronize_srcu",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
          "lines": "211-219",
          "snippet": "unsigned long get_state_synchronize_srcu(struct srcu_struct *ssp)\n{\n\tunsigned long ret;\n\n\tbarrier();\n\tret = (READ_ONCE(ssp->srcu_idx) + 3) & ~0x1;\n\tbarrier();\n\treturn ret & USHRT_MAX;\n}",
          "includes": [
            "#include \"rcu.h\"",
            "#include \"rcu_segcblist.h\"",
            "#include <linux/rcu_node_tree.h>",
            "#include <linux/srcu.h>",
            "#include <linux/delay.h>",
            "#include <linux/sched.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/preempt.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nunsigned long get_state_synchronize_srcu(struct srcu_struct *ssp)\n{\n\tunsigned long ret;\n\n\tbarrier();\n\tret = (READ_ONCE(ssp->srcu_idx) + 3) & ~0x1;\n\tbarrier();\n\treturn ret & USHRT_MAX;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nunsigned long start_poll_synchronize_srcu(struct srcu_struct *ssp)\n{\n\tunsigned long ret = get_state_synchronize_srcu(ssp);\n\n\tsrcu_gp_start_if_needed(ssp);\n\treturn ret;\n}"
  },
  {
    "function_name": "get_state_synchronize_srcu",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
    "lines": "211-219",
    "snippet": "unsigned long get_state_synchronize_srcu(struct srcu_struct *ssp)\n{\n\tunsigned long ret;\n\n\tbarrier();\n\tret = (READ_ONCE(ssp->srcu_idx) + 3) & ~0x1;\n\tbarrier();\n\treturn ret & USHRT_MAX;\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcu_node_tree.h>",
      "#include <linux/srcu.h>",
      "#include <linux/delay.h>",
      "#include <linux/sched.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/preempt.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "barrier",
          "args": [],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_barrier_tasks_trace",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tasks.h",
          "lines": "1569-1572",
          "snippet": "void rcu_barrier_tasks_trace(void)\n{\n\trcu_barrier_tasks_generic(&rcu_tasks_trace);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n\nvoid rcu_barrier_tasks_trace(void)\n{\n\trcu_barrier_tasks_generic(&rcu_tasks_trace);\n}"
        }
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "ssp->srcu_idx"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nunsigned long get_state_synchronize_srcu(struct srcu_struct *ssp)\n{\n\tunsigned long ret;\n\n\tbarrier();\n\tret = (READ_ONCE(ssp->srcu_idx) + 3) & ~0x1;\n\tbarrier();\n\treturn ret & USHRT_MAX;\n}"
  },
  {
    "function_name": "synchronize_srcu",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
    "lines": "196-205",
    "snippet": "void synchronize_srcu(struct srcu_struct *ssp)\n{\n\tstruct rcu_synchronize rs;\n\n\tinit_rcu_head_on_stack(&rs.head);\n\tinit_completion(&rs.completion);\n\tcall_srcu(ssp, &rs.head, wakeme_after_rcu);\n\twait_for_completion(&rs.completion);\n\tdestroy_rcu_head_on_stack(&rs.head);\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcu_node_tree.h>",
      "#include <linux/srcu.h>",
      "#include <linux/delay.h>",
      "#include <linux/sched.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/preempt.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "destroy_rcu_head_on_stack",
          "args": [
            "&rs.head"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "destroy_rcu_head_on_stack",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/update.c",
          "lines": "455-458",
          "snippet": "void destroy_rcu_head_on_stack(struct rcu_head *head)\n{\n\tdebug_object_free(head, &rcuhead_debug_descr);\n}",
          "includes": [
            "#include \"tasks.h\"",
            "#include \"rcu.h\"",
            "#include <linux/rcupdate_trace.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/slab.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/tick.h>",
            "#include <linux/kthread.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/delay.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/export.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tasks.h\"\n#include \"rcu.h\"\n#include <linux/rcupdate_trace.h>\n#include <linux/irq_work.h>\n#include <linux/slab.h>\n#include <linux/kprobes.h>\n#include <linux/sched/isolation.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/tick.h>\n#include <linux/kthread.h>\n#include <linux/moduleparam.h>\n#include <linux/delay.h>\n#include <linux/hardirq.h>\n#include <linux/export.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/signal.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid destroy_rcu_head_on_stack(struct rcu_head *head)\n{\n\tdebug_object_free(head, &rcuhead_debug_descr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wait_for_completion",
          "args": [
            "&rs.completion"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "try_wait_for_completion",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/completion.c",
          "lines": "282-303",
          "snippet": "bool try_wait_for_completion(struct completion *x)\n{\n\tunsigned long flags;\n\tbool ret = true;\n\n\t/*\n\t * Since x->done will need to be locked only\n\t * in the non-blocking case, we check x->done\n\t * first without taking the lock so we can\n\t * return early in the blocking case.\n\t */\n\tif (!READ_ONCE(x->done))\n\t\treturn false;\n\n\traw_spin_lock_irqsave(&x->wait.lock, flags);\n\tif (!x->done)\n\t\tret = false;\n\telse if (x->done != UINT_MAX)\n\t\tx->done--;\n\traw_spin_unlock_irqrestore(&x->wait.lock, flags);\n\treturn ret;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nbool try_wait_for_completion(struct completion *x)\n{\n\tunsigned long flags;\n\tbool ret = true;\n\n\t/*\n\t * Since x->done will need to be locked only\n\t * in the non-blocking case, we check x->done\n\t * first without taking the lock so we can\n\t * return early in the blocking case.\n\t */\n\tif (!READ_ONCE(x->done))\n\t\treturn false;\n\n\traw_spin_lock_irqsave(&x->wait.lock, flags);\n\tif (!x->done)\n\t\tret = false;\n\telse if (x->done != UINT_MAX)\n\t\tx->done--;\n\traw_spin_unlock_irqrestore(&x->wait.lock, flags);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_srcu",
          "args": [
            "ssp",
            "&rs.head",
            "wakeme_after_rcu"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "call_srcu",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
          "lines": "178-190",
          "snippet": "void call_srcu(struct srcu_struct *ssp, struct rcu_head *rhp,\n\t       rcu_callback_t func)\n{\n\tunsigned long flags;\n\n\trhp->func = func;\n\trhp->next = NULL;\n\tlocal_irq_save(flags);\n\t*ssp->srcu_cb_tail = rhp;\n\tssp->srcu_cb_tail = &rhp->next;\n\tlocal_irq_restore(flags);\n\tsrcu_gp_start_if_needed(ssp);\n}",
          "includes": [
            "#include \"rcu.h\"",
            "#include \"rcu_segcblist.h\"",
            "#include <linux/rcu_node_tree.h>",
            "#include <linux/srcu.h>",
            "#include <linux/delay.h>",
            "#include <linux/sched.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/preempt.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nvoid call_srcu(struct srcu_struct *ssp, struct rcu_head *rhp,\n\t       rcu_callback_t func)\n{\n\tunsigned long flags;\n\n\trhp->func = func;\n\trhp->next = NULL;\n\tlocal_irq_save(flags);\n\t*ssp->srcu_cb_tail = rhp;\n\tssp->srcu_cb_tail = &rhp->next;\n\tlocal_irq_restore(flags);\n\tsrcu_gp_start_if_needed(ssp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "init_completion",
          "args": [
            "&rs.completion"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_rcu_head_on_stack",
          "args": [
            "&rs.head"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "init_rcu_head_on_stack",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/update.c",
          "lines": "438-441",
          "snippet": "void init_rcu_head_on_stack(struct rcu_head *head)\n{\n\tdebug_object_init_on_stack(head, &rcuhead_debug_descr);\n}",
          "includes": [
            "#include \"tasks.h\"",
            "#include \"rcu.h\"",
            "#include <linux/rcupdate_trace.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/slab.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/tick.h>",
            "#include <linux/kthread.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/delay.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/export.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tasks.h\"\n#include \"rcu.h\"\n#include <linux/rcupdate_trace.h>\n#include <linux/irq_work.h>\n#include <linux/slab.h>\n#include <linux/kprobes.h>\n#include <linux/sched/isolation.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/tick.h>\n#include <linux/kthread.h>\n#include <linux/moduleparam.h>\n#include <linux/delay.h>\n#include <linux/hardirq.h>\n#include <linux/export.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/signal.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid init_rcu_head_on_stack(struct rcu_head *head)\n{\n\tdebug_object_init_on_stack(head, &rcuhead_debug_descr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nvoid synchronize_srcu(struct srcu_struct *ssp)\n{\n\tstruct rcu_synchronize rs;\n\n\tinit_rcu_head_on_stack(&rs.head);\n\tinit_completion(&rs.completion);\n\tcall_srcu(ssp, &rs.head, wakeme_after_rcu);\n\twait_for_completion(&rs.completion);\n\tdestroy_rcu_head_on_stack(&rs.head);\n}"
  },
  {
    "function_name": "call_srcu",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
    "lines": "178-190",
    "snippet": "void call_srcu(struct srcu_struct *ssp, struct rcu_head *rhp,\n\t       rcu_callback_t func)\n{\n\tunsigned long flags;\n\n\trhp->func = func;\n\trhp->next = NULL;\n\tlocal_irq_save(flags);\n\t*ssp->srcu_cb_tail = rhp;\n\tssp->srcu_cb_tail = &rhp->next;\n\tlocal_irq_restore(flags);\n\tsrcu_gp_start_if_needed(ssp);\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcu_node_tree.h>",
      "#include <linux/srcu.h>",
      "#include <linux/delay.h>",
      "#include <linux/sched.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/preempt.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "srcu_gp_start_if_needed",
          "args": [
            "ssp"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "srcu_gp_start_if_needed",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
          "lines": "158-172",
          "snippet": "static void srcu_gp_start_if_needed(struct srcu_struct *ssp)\n{\n\tunsigned short cookie;\n\n\tcookie = get_state_synchronize_srcu(ssp);\n\tif (USHORT_CMP_GE(READ_ONCE(ssp->srcu_idx_max), cookie))\n\t\treturn;\n\tWRITE_ONCE(ssp->srcu_idx_max, cookie);\n\tif (!READ_ONCE(ssp->srcu_gp_running)) {\n\t\tif (likely(srcu_init_done))\n\t\t\tschedule_work(&ssp->srcu_work);\n\t\telse if (list_empty(&ssp->srcu_work.entry))\n\t\t\tlist_add(&ssp->srcu_work.entry, &srcu_boot_list);\n\t}\n}",
          "includes": [
            "#include \"rcu.h\"",
            "#include \"rcu_segcblist.h\"",
            "#include <linux/rcu_node_tree.h>",
            "#include <linux/srcu.h>",
            "#include <linux/delay.h>",
            "#include <linux/sched.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/preempt.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(srcu_boot_list);",
            "static bool srcu_init_done;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(srcu_boot_list);\nstatic bool srcu_init_done;\n\nstatic void srcu_gp_start_if_needed(struct srcu_struct *ssp)\n{\n\tunsigned short cookie;\n\n\tcookie = get_state_synchronize_srcu(ssp);\n\tif (USHORT_CMP_GE(READ_ONCE(ssp->srcu_idx_max), cookie))\n\t\treturn;\n\tWRITE_ONCE(ssp->srcu_idx_max, cookie);\n\tif (!READ_ONCE(ssp->srcu_gp_running)) {\n\t\tif (likely(srcu_init_done))\n\t\t\tschedule_work(&ssp->srcu_work);\n\t\telse if (list_empty(&ssp->srcu_work.entry))\n\t\t\tlist_add(&ssp->srcu_work.entry, &srcu_boot_list);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "local_irq_restore",
          "args": [
            "flags"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_save",
          "args": [
            "flags"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nvoid call_srcu(struct srcu_struct *ssp, struct rcu_head *rhp,\n\t       rcu_callback_t func)\n{\n\tunsigned long flags;\n\n\trhp->func = func;\n\trhp->next = NULL;\n\tlocal_irq_save(flags);\n\t*ssp->srcu_cb_tail = rhp;\n\tssp->srcu_cb_tail = &rhp->next;\n\tlocal_irq_restore(flags);\n\tsrcu_gp_start_if_needed(ssp);\n}"
  },
  {
    "function_name": "srcu_gp_start_if_needed",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
    "lines": "158-172",
    "snippet": "static void srcu_gp_start_if_needed(struct srcu_struct *ssp)\n{\n\tunsigned short cookie;\n\n\tcookie = get_state_synchronize_srcu(ssp);\n\tif (USHORT_CMP_GE(READ_ONCE(ssp->srcu_idx_max), cookie))\n\t\treturn;\n\tWRITE_ONCE(ssp->srcu_idx_max, cookie);\n\tif (!READ_ONCE(ssp->srcu_gp_running)) {\n\t\tif (likely(srcu_init_done))\n\t\t\tschedule_work(&ssp->srcu_work);\n\t\telse if (list_empty(&ssp->srcu_work.entry))\n\t\t\tlist_add(&ssp->srcu_work.entry, &srcu_boot_list);\n\t}\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcu_node_tree.h>",
      "#include <linux/srcu.h>",
      "#include <linux/delay.h>",
      "#include <linux/sched.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/preempt.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(srcu_boot_list);",
      "static bool srcu_init_done;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&ssp->srcu_work.entry",
            "&srcu_boot_list"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_add_len",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "210-221",
          "snippet": "void rcu_segcblist_add_len(struct rcu_segcblist *rsclp, long v)\n{\n#ifdef CONFIG_RCU_NOCB_CPU\n\tsmp_mb__before_atomic(); // Read header comment above.\n\tatomic_long_add(v, &rsclp->len);\n\tsmp_mb__after_atomic();  // Read header comment above.\n#else\n\tsmp_mb(); // Read header comment above.\n\tWRITE_ONCE(rsclp->len, rsclp->len + v);\n\tsmp_mb(); // Read header comment above.\n#endif\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_add_len(struct rcu_segcblist *rsclp, long v)\n{\n#ifdef CONFIG_RCU_NOCB_CPU\n\tsmp_mb__before_atomic(); // Read header comment above.\n\tatomic_long_add(v, &rsclp->len);\n\tsmp_mb__after_atomic();  // Read header comment above.\n#else\n\tsmp_mb(); // Read header comment above.\n\tWRITE_ONCE(rsclp->len, rsclp->len + v);\n\tsmp_mb(); // Read header comment above.\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&ssp->srcu_work.entry"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_empty",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "41-44",
          "snippet": "static inline bool rcu_segcblist_empty(struct rcu_segcblist *rsclp)\n{\n\treturn !READ_ONCE(rsclp->head);\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_empty(struct rcu_segcblist *rsclp)\n{\n\treturn !READ_ONCE(rsclp->head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "schedule_work",
          "args": [
            "&ssp->srcu_work"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "srcu_init_done"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "ssp->srcu_gp_running"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "ssp->srcu_idx_max",
            "cookie"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "USHORT_CMP_GE",
          "args": [
            "READ_ONCE(ssp->srcu_idx_max)",
            "cookie"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "ssp->srcu_idx_max"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_state_synchronize_srcu",
          "args": [
            "ssp"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "get_state_synchronize_srcu",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
          "lines": "211-219",
          "snippet": "unsigned long get_state_synchronize_srcu(struct srcu_struct *ssp)\n{\n\tunsigned long ret;\n\n\tbarrier();\n\tret = (READ_ONCE(ssp->srcu_idx) + 3) & ~0x1;\n\tbarrier();\n\treturn ret & USHRT_MAX;\n}",
          "includes": [
            "#include \"rcu.h\"",
            "#include \"rcu_segcblist.h\"",
            "#include <linux/rcu_node_tree.h>",
            "#include <linux/srcu.h>",
            "#include <linux/delay.h>",
            "#include <linux/sched.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/preempt.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nunsigned long get_state_synchronize_srcu(struct srcu_struct *ssp)\n{\n\tunsigned long ret;\n\n\tbarrier();\n\tret = (READ_ONCE(ssp->srcu_idx) + 3) & ~0x1;\n\tbarrier();\n\treturn ret & USHRT_MAX;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nstatic LIST_HEAD(srcu_boot_list);\nstatic bool srcu_init_done;\n\nstatic void srcu_gp_start_if_needed(struct srcu_struct *ssp)\n{\n\tunsigned short cookie;\n\n\tcookie = get_state_synchronize_srcu(ssp);\n\tif (USHORT_CMP_GE(READ_ONCE(ssp->srcu_idx_max), cookie))\n\t\treturn;\n\tWRITE_ONCE(ssp->srcu_idx_max, cookie);\n\tif (!READ_ONCE(ssp->srcu_gp_running)) {\n\t\tif (likely(srcu_init_done))\n\t\t\tschedule_work(&ssp->srcu_work);\n\t\telse if (list_empty(&ssp->srcu_work.entry))\n\t\t\tlist_add(&ssp->srcu_work.entry, &srcu_boot_list);\n\t}\n}"
  },
  {
    "function_name": "srcu_drive_gp",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
    "lines": "112-155",
    "snippet": "void srcu_drive_gp(struct work_struct *wp)\n{\n\tint idx;\n\tstruct rcu_head *lh;\n\tstruct rcu_head *rhp;\n\tstruct srcu_struct *ssp;\n\n\tssp = container_of(wp, struct srcu_struct, srcu_work);\n\tif (ssp->srcu_gp_running || USHORT_CMP_GE(ssp->srcu_idx, READ_ONCE(ssp->srcu_idx_max)))\n\t\treturn; /* Already running or nothing to do. */\n\n\t/* Remove recently arrived callbacks and wait for readers. */\n\tWRITE_ONCE(ssp->srcu_gp_running, true);\n\tlocal_irq_disable();\n\tlh = ssp->srcu_cb_head;\n\tssp->srcu_cb_head = NULL;\n\tssp->srcu_cb_tail = &ssp->srcu_cb_head;\n\tlocal_irq_enable();\n\tidx = (ssp->srcu_idx & 0x2) / 2;\n\tWRITE_ONCE(ssp->srcu_idx, ssp->srcu_idx + 1);\n\tWRITE_ONCE(ssp->srcu_gp_waiting, true);  /* srcu_read_unlock() wakes! */\n\tswait_event_exclusive(ssp->srcu_wq, !READ_ONCE(ssp->srcu_lock_nesting[idx]));\n\tWRITE_ONCE(ssp->srcu_gp_waiting, false); /* srcu_read_unlock() cheap. */\n\tWRITE_ONCE(ssp->srcu_idx, ssp->srcu_idx + 1);\n\n\t/* Invoke the callbacks we removed above. */\n\twhile (lh) {\n\t\trhp = lh;\n\t\tlh = lh->next;\n\t\tlocal_bh_disable();\n\t\trhp->func(rhp);\n\t\tlocal_bh_enable();\n\t}\n\n\t/*\n\t * Enable rescheduling, and if there are more callbacks,\n\t * reschedule ourselves.  This can race with a call_srcu()\n\t * at interrupt level, but the ->srcu_gp_running checks will\n\t * straighten that out.\n\t */\n\tWRITE_ONCE(ssp->srcu_gp_running, false);\n\tif (USHORT_CMP_LT(ssp->srcu_idx, READ_ONCE(ssp->srcu_idx_max)))\n\t\tschedule_work(&ssp->srcu_work);\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcu_node_tree.h>",
      "#include <linux/srcu.h>",
      "#include <linux/delay.h>",
      "#include <linux/sched.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/preempt.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "schedule_work",
          "args": [
            "&ssp->srcu_work"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "USHORT_CMP_LT",
          "args": [
            "ssp->srcu_idx",
            "READ_ONCE(ssp->srcu_idx_max)"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "ssp->srcu_idx_max"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "ssp->srcu_gp_running",
            "false"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_bh_enable",
          "args": [],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "_local_bh_enable",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/softirq.c",
          "lines": "353-357",
          "snippet": "void _local_bh_enable(void)\n{\n\tWARN_ON_ONCE(in_irq());\n\t__local_bh_enable(SOFTIRQ_DISABLE_OFFSET);\n}",
          "includes": [
            "#include <trace/events/irq.h>",
            "#include <asm/softirq_stack.h>",
            "#include <linux/wait_bit.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/smp.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kthread.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/mm.h>",
            "#include <linux/local_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/irq.h>\n#include <asm/softirq_stack.h>\n#include <linux/wait_bit.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/smpboot.h>\n#include <linux/smp.h>\n#include <linux/ftrace.h>\n#include <linux/rcupdate.h>\n#include <linux/kthread.h>\n#include <linux/freezer.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/notifier.h>\n#include <linux/mm.h>\n#include <linux/local_lock.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/kernel_stat.h>\n#include <linux/export.h>\n\nvoid _local_bh_enable(void)\n{\n\tWARN_ON_ONCE(in_irq());\n\t__local_bh_enable(SOFTIRQ_DISABLE_OFFSET);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rhp->func",
          "args": [
            "rhp"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_bh_disable",
          "args": [],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "ssp->srcu_idx",
            "ssp->srcu_idx + 1"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "ssp->srcu_gp_waiting",
            "false"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swait_event_exclusive",
          "args": [
            "ssp->srcu_wq",
            "!READ_ONCE(ssp->srcu_lock_nesting[idx])"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "ssp->srcu_lock_nesting[idx]"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "ssp->srcu_gp_waiting",
            "true"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "ssp->srcu_idx",
            "ssp->srcu_idx + 1"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_enable",
          "args": [],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_disable",
          "args": [],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "ssp->srcu_gp_running",
            "true"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "USHORT_CMP_GE",
          "args": [
            "ssp->srcu_idx",
            "READ_ONCE(ssp->srcu_idx_max)"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "ssp->srcu_idx_max"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "wp",
            "structsrcu_struct",
            "srcu_work"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nvoid srcu_drive_gp(struct work_struct *wp)\n{\n\tint idx;\n\tstruct rcu_head *lh;\n\tstruct rcu_head *rhp;\n\tstruct srcu_struct *ssp;\n\n\tssp = container_of(wp, struct srcu_struct, srcu_work);\n\tif (ssp->srcu_gp_running || USHORT_CMP_GE(ssp->srcu_idx, READ_ONCE(ssp->srcu_idx_max)))\n\t\treturn; /* Already running or nothing to do. */\n\n\t/* Remove recently arrived callbacks and wait for readers. */\n\tWRITE_ONCE(ssp->srcu_gp_running, true);\n\tlocal_irq_disable();\n\tlh = ssp->srcu_cb_head;\n\tssp->srcu_cb_head = NULL;\n\tssp->srcu_cb_tail = &ssp->srcu_cb_head;\n\tlocal_irq_enable();\n\tidx = (ssp->srcu_idx & 0x2) / 2;\n\tWRITE_ONCE(ssp->srcu_idx, ssp->srcu_idx + 1);\n\tWRITE_ONCE(ssp->srcu_gp_waiting, true);  /* srcu_read_unlock() wakes! */\n\tswait_event_exclusive(ssp->srcu_wq, !READ_ONCE(ssp->srcu_lock_nesting[idx]));\n\tWRITE_ONCE(ssp->srcu_gp_waiting, false); /* srcu_read_unlock() cheap. */\n\tWRITE_ONCE(ssp->srcu_idx, ssp->srcu_idx + 1);\n\n\t/* Invoke the callbacks we removed above. */\n\twhile (lh) {\n\t\trhp = lh;\n\t\tlh = lh->next;\n\t\tlocal_bh_disable();\n\t\trhp->func(rhp);\n\t\tlocal_bh_enable();\n\t}\n\n\t/*\n\t * Enable rescheduling, and if there are more callbacks,\n\t * reschedule ourselves.  This can race with a call_srcu()\n\t * at interrupt level, but the ->srcu_gp_running checks will\n\t * straighten that out.\n\t */\n\tWRITE_ONCE(ssp->srcu_gp_running, false);\n\tif (USHORT_CMP_LT(ssp->srcu_idx, READ_ONCE(ssp->srcu_idx_max)))\n\t\tschedule_work(&ssp->srcu_work);\n}"
  },
  {
    "function_name": "__srcu_read_unlock",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
    "lines": "97-104",
    "snippet": "void __srcu_read_unlock(struct srcu_struct *ssp, int idx)\n{\n\tint newval = READ_ONCE(ssp->srcu_lock_nesting[idx]) - 1;\n\n\tWRITE_ONCE(ssp->srcu_lock_nesting[idx], newval);\n\tif (!newval && READ_ONCE(ssp->srcu_gp_waiting) && in_task())\n\t\tswake_up_one(&ssp->srcu_wq);\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcu_node_tree.h>",
      "#include <linux/srcu.h>",
      "#include <linux/delay.h>",
      "#include <linux/sched.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/preempt.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "swake_up_one",
          "args": [
            "&ssp->srcu_wq"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "swake_up_one",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/swait.c",
          "lines": "48-55",
          "snippet": "void swake_up_one(struct swait_queue_head *q)\n{\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&q->lock, flags);\n\tswake_up_locked(q);\n\traw_spin_unlock_irqrestore(&q->lock, flags);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nvoid swake_up_one(struct swait_queue_head *q)\n{\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&q->lock, flags);\n\tswake_up_locked(q);\n\traw_spin_unlock_irqrestore(&q->lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "in_task",
          "args": [],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "ssp->srcu_gp_waiting"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "ssp->srcu_lock_nesting[idx]",
            "newval"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "ssp->srcu_lock_nesting[idx]"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nvoid __srcu_read_unlock(struct srcu_struct *ssp, int idx)\n{\n\tint newval = READ_ONCE(ssp->srcu_lock_nesting[idx]) - 1;\n\n\tWRITE_ONCE(ssp->srcu_lock_nesting[idx], newval);\n\tif (!newval && READ_ONCE(ssp->srcu_gp_waiting) && in_task())\n\t\tswake_up_one(&ssp->srcu_wq);\n}"
  },
  {
    "function_name": "cleanup_srcu_struct",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
    "lines": "80-90",
    "snippet": "void cleanup_srcu_struct(struct srcu_struct *ssp)\n{\n\tWARN_ON(ssp->srcu_lock_nesting[0] || ssp->srcu_lock_nesting[1]);\n\tflush_work(&ssp->srcu_work);\n\tWARN_ON(ssp->srcu_gp_running);\n\tWARN_ON(ssp->srcu_gp_waiting);\n\tWARN_ON(ssp->srcu_cb_head);\n\tWARN_ON(&ssp->srcu_cb_head != ssp->srcu_cb_tail);\n\tWARN_ON(ssp->srcu_idx != ssp->srcu_idx_max);\n\tWARN_ON(ssp->srcu_idx & 0x1);\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcu_node_tree.h>",
      "#include <linux/srcu.h>",
      "#include <linux/delay.h>",
      "#include <linux/sched.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/preempt.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ssp->srcu_idx & 0x1"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ssp->srcu_idx != ssp->srcu_idx_max"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "&ssp->srcu_cb_head != ssp->srcu_cb_tail"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ssp->srcu_cb_head"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ssp->srcu_gp_waiting"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ssp->srcu_gp_running"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flush_work",
          "args": [
            "&ssp->srcu_work"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "flush_work",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/workqueue.c",
          "lines": "3112-3115",
          "snippet": "bool flush_work(struct work_struct *work)\n{\n\treturn __flush_work(work, false);\n}",
          "includes": [
            "#include <trace/events/workqueue.h>",
            "#include \"workqueue_internal.h\"",
            "#include <linux/kvm_para.h>",
            "#include <linux/nmi.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/rculist.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/jhash.h>",
            "#include <linux/idr.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/freezer.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/kthread.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/completion.h>",
            "#include <linux/signal.h>",
            "#include <linux/init.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/workqueue.h>\n#include \"workqueue_internal.h\"\n#include <linux/kvm_para.h>\n#include <linux/nmi.h>\n#include <linux/sched/isolation.h>\n#include <linux/uaccess.h>\n#include <linux/moduleparam.h>\n#include <linux/nodemask.h>\n#include <linux/rculist.h>\n#include <linux/hashtable.h>\n#include <linux/jhash.h>\n#include <linux/idr.h>\n#include <linux/lockdep.h>\n#include <linux/debug_locks.h>\n#include <linux/freezer.h>\n#include <linux/mempolicy.h>\n#include <linux/hardirq.h>\n#include <linux/kthread.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/completion.h>\n#include <linux/signal.h>\n#include <linux/init.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nbool flush_work(struct work_struct *work)\n{\n\treturn __flush_work(work, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ssp->srcu_lock_nesting[0] || ssp->srcu_lock_nesting[1]"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nvoid cleanup_srcu_struct(struct srcu_struct *ssp)\n{\n\tWARN_ON(ssp->srcu_lock_nesting[0] || ssp->srcu_lock_nesting[1]);\n\tflush_work(&ssp->srcu_work);\n\tWARN_ON(ssp->srcu_gp_running);\n\tWARN_ON(ssp->srcu_gp_waiting);\n\tWARN_ON(ssp->srcu_cb_head);\n\tWARN_ON(&ssp->srcu_cb_head != ssp->srcu_cb_tail);\n\tWARN_ON(ssp->srcu_idx != ssp->srcu_idx_max);\n\tWARN_ON(ssp->srcu_idx & 0x1);\n}"
  },
  {
    "function_name": "init_srcu_struct",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
    "lines": "65-68",
    "snippet": "int init_srcu_struct(struct srcu_struct *ssp)\n{\n\treturn init_srcu_struct_fields(ssp);\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcu_node_tree.h>",
      "#include <linux/srcu.h>",
      "#include <linux/delay.h>",
      "#include <linux/sched.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/preempt.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "init_srcu_struct_fields",
          "args": [
            "ssp"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "init_srcu_struct_fields",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
          "lines": "27-41",
          "snippet": "static int init_srcu_struct_fields(struct srcu_struct *ssp)\n{\n\tssp->srcu_lock_nesting[0] = 0;\n\tssp->srcu_lock_nesting[1] = 0;\n\tinit_swait_queue_head(&ssp->srcu_wq);\n\tssp->srcu_cb_head = NULL;\n\tssp->srcu_cb_tail = &ssp->srcu_cb_head;\n\tssp->srcu_gp_running = false;\n\tssp->srcu_gp_waiting = false;\n\tssp->srcu_idx = 0;\n\tssp->srcu_idx_max = 0;\n\tINIT_WORK(&ssp->srcu_work, srcu_drive_gp);\n\tINIT_LIST_HEAD(&ssp->srcu_work.entry);\n\treturn 0;\n}",
          "includes": [
            "#include \"rcu.h\"",
            "#include \"rcu_segcblist.h\"",
            "#include <linux/rcu_node_tree.h>",
            "#include <linux/srcu.h>",
            "#include <linux/delay.h>",
            "#include <linux/sched.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/preempt.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nstatic int init_srcu_struct_fields(struct srcu_struct *ssp)\n{\n\tssp->srcu_lock_nesting[0] = 0;\n\tssp->srcu_lock_nesting[1] = 0;\n\tinit_swait_queue_head(&ssp->srcu_wq);\n\tssp->srcu_cb_head = NULL;\n\tssp->srcu_cb_tail = &ssp->srcu_cb_head;\n\tssp->srcu_gp_running = false;\n\tssp->srcu_gp_waiting = false;\n\tssp->srcu_idx = 0;\n\tssp->srcu_idx_max = 0;\n\tINIT_WORK(&ssp->srcu_work, srcu_drive_gp);\n\tINIT_LIST_HEAD(&ssp->srcu_work.entry);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nint init_srcu_struct(struct srcu_struct *ssp)\n{\n\treturn init_srcu_struct_fields(ssp);\n}"
  },
  {
    "function_name": "__init_srcu_struct",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
    "lines": "45-52",
    "snippet": "int __init_srcu_struct(struct srcu_struct *ssp, const char *name,\n\t\t       struct lock_class_key *key)\n{\n\t/* Don't re-initialize a lock while it is held. */\n\tdebug_check_no_locks_freed((void *)ssp, sizeof(*ssp));\n\tlockdep_init_map(&ssp->dep_map, name, key, 0);\n\treturn init_srcu_struct_fields(ssp);\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcu_node_tree.h>",
      "#include <linux/srcu.h>",
      "#include <linux/delay.h>",
      "#include <linux/sched.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/preempt.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "init_srcu_struct_fields",
          "args": [
            "ssp"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "init_srcu_struct_fields",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
          "lines": "27-41",
          "snippet": "static int init_srcu_struct_fields(struct srcu_struct *ssp)\n{\n\tssp->srcu_lock_nesting[0] = 0;\n\tssp->srcu_lock_nesting[1] = 0;\n\tinit_swait_queue_head(&ssp->srcu_wq);\n\tssp->srcu_cb_head = NULL;\n\tssp->srcu_cb_tail = &ssp->srcu_cb_head;\n\tssp->srcu_gp_running = false;\n\tssp->srcu_gp_waiting = false;\n\tssp->srcu_idx = 0;\n\tssp->srcu_idx_max = 0;\n\tINIT_WORK(&ssp->srcu_work, srcu_drive_gp);\n\tINIT_LIST_HEAD(&ssp->srcu_work.entry);\n\treturn 0;\n}",
          "includes": [
            "#include \"rcu.h\"",
            "#include \"rcu_segcblist.h\"",
            "#include <linux/rcu_node_tree.h>",
            "#include <linux/srcu.h>",
            "#include <linux/delay.h>",
            "#include <linux/sched.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/preempt.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nstatic int init_srcu_struct_fields(struct srcu_struct *ssp)\n{\n\tssp->srcu_lock_nesting[0] = 0;\n\tssp->srcu_lock_nesting[1] = 0;\n\tinit_swait_queue_head(&ssp->srcu_wq);\n\tssp->srcu_cb_head = NULL;\n\tssp->srcu_cb_tail = &ssp->srcu_cb_head;\n\tssp->srcu_gp_running = false;\n\tssp->srcu_gp_waiting = false;\n\tssp->srcu_idx = 0;\n\tssp->srcu_idx_max = 0;\n\tINIT_WORK(&ssp->srcu_work, srcu_drive_gp);\n\tINIT_LIST_HEAD(&ssp->srcu_work.entry);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lockdep_init_map",
          "args": [
            "&ssp->dep_map",
            "name",
            "key",
            "0"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_check_no_locks_freed",
          "args": [
            "(void *)ssp",
            "sizeof(*ssp)"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "debug_check_no_locks_freed",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/lockdep.c",
          "lines": "6405-6427",
          "snippet": "void debug_check_no_locks_freed(const void *mem_from, unsigned long mem_len)\n{\n\tstruct task_struct *curr = current;\n\tstruct held_lock *hlock;\n\tunsigned long flags;\n\tint i;\n\n\tif (unlikely(!debug_locks))\n\t\treturn;\n\n\traw_local_irq_save(flags);\n\tfor (i = 0; i < curr->lockdep_depth; i++) {\n\t\thlock = curr->held_locks + i;\n\n\t\tif (not_in_range(mem_from, mem_len, hlock->instance,\n\t\t\t\t\tsizeof(*hlock->instance)))\n\t\t\tcontinue;\n\n\t\tprint_freed_lock_bug(curr, mem_from, mem_from + mem_len, hlock);\n\t\tbreak;\n\t}\n\traw_local_irq_restore(flags);\n}",
          "includes": [
            "#include \"lockdep_states.h\"",
            "#include <trace/events/lock.h>",
            "#include \"lockdep_internals.h\"",
            "#include <asm/sections.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jhash.h>",
            "#include <linux/random.h>",
            "#include <linux/gfp.h>",
            "#include <linux/bitops.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/stringify.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/hash.h>",
            "#include <linux/utsname.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/delay.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched.h>",
            "#include <linux/mutex.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinstr struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lockdep_states.h\"\n#include <trace/events/lock.h>\n#include \"lockdep_internals.h\"\n#include <asm/sections.h>\n#include <linux/lockdep.h>\n#include <linux/kprobes.h>\n#include <linux/rcupdate.h>\n#include <linux/nmi.h>\n#include <linux/jhash.h>\n#include <linux/random.h>\n#include <linux/gfp.h>\n#include <linux/bitops.h>\n#include <linux/bitmap.h>\n#include <linux/stringify.h>\n#include <linux/ftrace.h>\n#include <linux/hash.h>\n#include <linux/utsname.h>\n#include <linux/irqflags.h>\n#include <linux/debug_locks.h>\n#include <linux/stacktrace.h>\n#include <linux/interrupt.h>\n#include <linux/kallsyms.h>\n#include <linux/spinlock.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/delay.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/task.h>\n#include <linux/sched/clock.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n\nstatic noinstr struct;\n\nvoid debug_check_no_locks_freed(const void *mem_from, unsigned long mem_len)\n{\n\tstruct task_struct *curr = current;\n\tstruct held_lock *hlock;\n\tunsigned long flags;\n\tint i;\n\n\tif (unlikely(!debug_locks))\n\t\treturn;\n\n\traw_local_irq_save(flags);\n\tfor (i = 0; i < curr->lockdep_depth; i++) {\n\t\thlock = curr->held_locks + i;\n\n\t\tif (not_in_range(mem_from, mem_len, hlock->instance,\n\t\t\t\t\tsizeof(*hlock->instance)))\n\t\t\tcontinue;\n\n\t\tprint_freed_lock_bug(curr, mem_from, mem_from + mem_len, hlock);\n\t\tbreak;\n\t}\n\traw_local_irq_restore(flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nint __init_srcu_struct(struct srcu_struct *ssp, const char *name,\n\t\t       struct lock_class_key *key)\n{\n\t/* Don't re-initialize a lock while it is held. */\n\tdebug_check_no_locks_freed((void *)ssp, sizeof(*ssp));\n\tlockdep_init_map(&ssp->dep_map, name, key, 0);\n\treturn init_srcu_struct_fields(ssp);\n}"
  },
  {
    "function_name": "init_srcu_struct_fields",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutiny.c",
    "lines": "27-41",
    "snippet": "static int init_srcu_struct_fields(struct srcu_struct *ssp)\n{\n\tssp->srcu_lock_nesting[0] = 0;\n\tssp->srcu_lock_nesting[1] = 0;\n\tinit_swait_queue_head(&ssp->srcu_wq);\n\tssp->srcu_cb_head = NULL;\n\tssp->srcu_cb_tail = &ssp->srcu_cb_head;\n\tssp->srcu_gp_running = false;\n\tssp->srcu_gp_waiting = false;\n\tssp->srcu_idx = 0;\n\tssp->srcu_idx_max = 0;\n\tINIT_WORK(&ssp->srcu_work, srcu_drive_gp);\n\tINIT_LIST_HEAD(&ssp->srcu_work.entry);\n\treturn 0;\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include \"rcu_segcblist.h\"",
      "#include <linux/rcu_node_tree.h>",
      "#include <linux/srcu.h>",
      "#include <linux/delay.h>",
      "#include <linux/sched.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/preempt.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&ssp->srcu_work.entry"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_WORK",
          "args": [
            "&ssp->srcu_work",
            "srcu_drive_gp"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_swait_queue_head",
          "args": [
            "&ssp->srcu_wq"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include \"rcu_segcblist.h\"\n#include <linux/rcu_node_tree.h>\n#include <linux/srcu.h>\n#include <linux/delay.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nstatic int init_srcu_struct_fields(struct srcu_struct *ssp)\n{\n\tssp->srcu_lock_nesting[0] = 0;\n\tssp->srcu_lock_nesting[1] = 0;\n\tinit_swait_queue_head(&ssp->srcu_wq);\n\tssp->srcu_cb_head = NULL;\n\tssp->srcu_cb_tail = &ssp->srcu_cb_head;\n\tssp->srcu_gp_running = false;\n\tssp->srcu_gp_waiting = false;\n\tssp->srcu_idx = 0;\n\tssp->srcu_idx_max = 0;\n\tINIT_WORK(&ssp->srcu_work, srcu_drive_gp);\n\tINIT_LIST_HEAD(&ssp->srcu_work.entry);\n\treturn 0;\n}"
  }
]