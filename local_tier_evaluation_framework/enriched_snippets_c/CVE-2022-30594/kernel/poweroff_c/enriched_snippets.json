[
  {
    "function_name": "pm_sysrq_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/poweroff.c",
    "lines": "39-43",
    "snippet": "static int __init pm_sysrq_init(void)\n{\n\tregister_sysrq_key('o', &sysrq_poweroff_op);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/cpumask.h>",
      "#include <linux/reboot.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/pm.h>",
      "#include <linux/init.h>",
      "#include <linux/sysrq.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct sysrq_key_op\tsysrq_poweroff_op = {\n\t.handler        = handle_poweroff,\n\t.help_msg       = \"poweroff(o)\",\n\t.action_msg     = \"Power Off\",\n\t.enable_mask\t= SYSRQ_ENABLE_BOOT,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_sysrq_key",
          "args": [
            "'o'",
            "&sysrq_poweroff_op"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/cpumask.h>\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/pm.h>\n#include <linux/init.h>\n#include <linux/sysrq.h>\n#include <linux/kernel.h>\n\nstatic const struct sysrq_key_op\tsysrq_poweroff_op = {\n\t.handler        = handle_poweroff,\n\t.help_msg       = \"poweroff(o)\",\n\t.action_msg     = \"Power Off\",\n\t.enable_mask\t= SYSRQ_ENABLE_BOOT,\n};\n\nstatic int __init pm_sysrq_init(void)\n{\n\tregister_sysrq_key('o', &sysrq_poweroff_op);\n\treturn 0;\n}"
  },
  {
    "function_name": "handle_poweroff",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/poweroff.c",
    "lines": "26-30",
    "snippet": "static void handle_poweroff(int key)\n{\n\t/* run sysrq poweroff on boot cpu */\n\tschedule_work_on(cpumask_first(cpu_online_mask), &poweroff_work);\n}",
    "includes": [
      "#include <linux/cpumask.h>",
      "#include <linux/reboot.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/pm.h>",
      "#include <linux/init.h>",
      "#include <linux/sysrq.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "schedule_work_on",
          "args": [
            "cpumask_first(cpu_online_mask)",
            "&poweroff_work"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_first",
          "args": [
            "cpu_online_mask"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/cpumask.h>\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/pm.h>\n#include <linux/init.h>\n#include <linux/sysrq.h>\n#include <linux/kernel.h>\n\nstatic void handle_poweroff(int key)\n{\n\t/* run sysrq poweroff on boot cpu */\n\tschedule_work_on(cpumask_first(cpu_online_mask), &poweroff_work);\n}"
  },
  {
    "function_name": "do_poweroff",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/poweroff.c",
    "lines": "19-22",
    "snippet": "static void do_poweroff(struct work_struct *dummy)\n{\n\tkernel_power_off();\n}",
    "includes": [
      "#include <linux/cpumask.h>",
      "#include <linux/reboot.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/pm.h>",
      "#include <linux/init.h>",
      "#include <linux/sysrq.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DECLARE_WORK(poweroff_work, do_poweroff);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kernel_power_off",
          "args": [],
          "line": 21
        },
        "resolved": true,
        "details": {
          "function_name": "kernel_power_off",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/reboot.c",
          "lines": "289-299",
          "snippet": "void kernel_power_off(void)\n{\n\tkernel_shutdown_prepare(SYSTEM_POWER_OFF);\n\tif (pm_power_off_prepare)\n\t\tpm_power_off_prepare();\n\tmigrate_to_reboot_cpu();\n\tsyscore_shutdown();\n\tpr_emerg(\"Power down\\n\");\n\tkmsg_dump(KMSG_DUMP_SHUTDOWN);\n\tmachine_power_off();\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/suspend.h>",
            "#include <linux/reboot.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/kmod.h>",
            "#include <linux/kexec.h>",
            "#include <linux/export.h>",
            "#include <linux/ctype.h>",
            "#include <linux/atomic.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void (*pm_power_off_prepare)(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/syscore_ops.h>\n#include <linux/syscalls.h>\n#include <linux/suspend.h>\n#include <linux/reboot.h>\n#include <linux/kmsg_dump.h>\n#include <linux/kmod.h>\n#include <linux/kexec.h>\n#include <linux/export.h>\n#include <linux/ctype.h>\n#include <linux/atomic.h>\n\nvoid (*pm_power_off_prepare)(void);\n\nvoid kernel_power_off(void)\n{\n\tkernel_shutdown_prepare(SYSTEM_POWER_OFF);\n\tif (pm_power_off_prepare)\n\t\tpm_power_off_prepare();\n\tmigrate_to_reboot_cpu();\n\tsyscore_shutdown();\n\tpr_emerg(\"Power down\\n\");\n\tkmsg_dump(KMSG_DUMP_SHUTDOWN);\n\tmachine_power_off();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/cpumask.h>\n#include <linux/reboot.h>\n#include <linux/workqueue.h>\n#include <linux/pm.h>\n#include <linux/init.h>\n#include <linux/sysrq.h>\n#include <linux/kernel.h>\n\nstatic DECLARE_WORK(poweroff_work, do_poweroff);\n\nstatic void do_poweroff(struct work_struct *dummy)\n{\n\tkernel_power_off();\n}"
  }
]