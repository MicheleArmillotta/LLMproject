[
  {
    "function_name": "irq_gc_init_ops",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "650-654",
    "snippet": "static int __init irq_gc_init_ops(void)\n{\n\tregister_syscore_ops(&irq_gc_syscore_ops);\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct syscore_ops irq_gc_syscore_ops = {\n\t.suspend = irq_gc_suspend,\n\t.resume = irq_gc_resume,\n\t.shutdown = irq_gc_shutdown,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_syscore_ops",
          "args": [
            "&irq_gc_syscore_ops"
          ],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic struct syscore_ops irq_gc_syscore_ops = {\n\t.suspend = irq_gc_suspend,\n\t.resume = irq_gc_resume,\n\t.shutdown = irq_gc_shutdown,\n};\n\nstatic int __init irq_gc_init_ops(void)\n{\n\tregister_syscore_ops(&irq_gc_syscore_ops);\n\treturn 0;\n}"
  },
  {
    "function_name": "irq_gc_shutdown",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "628-642",
    "snippet": "static void irq_gc_shutdown(void)\n{\n\tstruct irq_chip_generic *gc;\n\n\tlist_for_each_entry(gc, &gc_list, list) {\n\t\tstruct irq_chip_type *ct = gc->chip_types;\n\n\t\tif (ct->chip.irq_pm_shutdown) {\n\t\t\tstruct irq_data *data = irq_gc_get_irq_data(gc);\n\n\t\t\tif (data)\n\t\t\t\tct->chip.irq_pm_shutdown(data);\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(gc_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ct->chip.irq_pm_shutdown",
          "args": [
            "data"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_gc_get_irq_data",
          "args": [
            "gc"
          ],
          "line": 636
        },
        "resolved": true,
        "details": {
          "function_name": "irq_gc_get_irq_data",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
          "lines": "566-582",
          "snippet": "static struct irq_data *irq_gc_get_irq_data(struct irq_chip_generic *gc)\n{\n\tunsigned int virq;\n\n\tif (!gc->domain)\n\t\treturn irq_get_irq_data(gc->irq_base);\n\n\t/*\n\t * We don't know which of the irqs has been actually\n\t * installed. Use the first one.\n\t */\n\tif (!gc->installed)\n\t\treturn NULL;\n\n\tvirq = irq_find_mapping(gc->domain, gc->irq_base + __ffs(gc->installed));\n\treturn virq ? irq_get_irq_data(virq) : NULL;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/syscore_ops.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>",
            "#include <linux/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic struct irq_data *irq_gc_get_irq_data(struct irq_chip_generic *gc)\n{\n\tunsigned int virq;\n\n\tif (!gc->domain)\n\t\treturn irq_get_irq_data(gc->irq_base);\n\n\t/*\n\t * We don't know which of the irqs has been actually\n\t * installed. Use the first one.\n\t */\n\tif (!gc->installed)\n\t\treturn NULL;\n\n\tvirq = irq_find_mapping(gc->domain, gc->irq_base + __ffs(gc->installed));\n\treturn virq ? irq_get_irq_data(virq) : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "gc",
            "&gc_list",
            "list"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic LIST_HEAD(gc_list);\n\nstatic void irq_gc_shutdown(void)\n{\n\tstruct irq_chip_generic *gc;\n\n\tlist_for_each_entry(gc, &gc_list, list) {\n\t\tstruct irq_chip_type *ct = gc->chip_types;\n\n\t\tif (ct->chip.irq_pm_shutdown) {\n\t\t\tstruct irq_data *data = irq_gc_get_irq_data(gc);\n\n\t\t\tif (data)\n\t\t\t\tct->chip.irq_pm_shutdown(data);\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "irq_gc_resume",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "605-622",
    "snippet": "static void irq_gc_resume(void)\n{\n\tstruct irq_chip_generic *gc;\n\n\tlist_for_each_entry(gc, &gc_list, list) {\n\t\tstruct irq_chip_type *ct = gc->chip_types;\n\n\t\tif (gc->resume)\n\t\t\tgc->resume(gc);\n\n\t\tif (ct->chip.irq_resume) {\n\t\t\tstruct irq_data *data = irq_gc_get_irq_data(gc);\n\n\t\t\tif (data)\n\t\t\t\tct->chip.irq_resume(data);\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [
      "#define irq_gc_resume NULL"
    ],
    "globals_used": [
      "static LIST_HEAD(gc_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ct->chip.irq_resume",
          "args": [
            "data"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_gc_get_irq_data",
          "args": [
            "gc"
          ],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "irq_gc_get_irq_data",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
          "lines": "566-582",
          "snippet": "static struct irq_data *irq_gc_get_irq_data(struct irq_chip_generic *gc)\n{\n\tunsigned int virq;\n\n\tif (!gc->domain)\n\t\treturn irq_get_irq_data(gc->irq_base);\n\n\t/*\n\t * We don't know which of the irqs has been actually\n\t * installed. Use the first one.\n\t */\n\tif (!gc->installed)\n\t\treturn NULL;\n\n\tvirq = irq_find_mapping(gc->domain, gc->irq_base + __ffs(gc->installed));\n\treturn virq ? irq_get_irq_data(virq) : NULL;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/syscore_ops.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>",
            "#include <linux/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic struct irq_data *irq_gc_get_irq_data(struct irq_chip_generic *gc)\n{\n\tunsigned int virq;\n\n\tif (!gc->domain)\n\t\treturn irq_get_irq_data(gc->irq_base);\n\n\t/*\n\t * We don't know which of the irqs has been actually\n\t * installed. Use the first one.\n\t */\n\tif (!gc->installed)\n\t\treturn NULL;\n\n\tvirq = irq_find_mapping(gc->domain, gc->irq_base + __ffs(gc->installed));\n\treturn virq ? irq_get_irq_data(virq) : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gc->resume",
          "args": [
            "gc"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "gc",
            "&gc_list",
            "list"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\n#define irq_gc_resume NULL\n\nstatic LIST_HEAD(gc_list);\n\nstatic void irq_gc_resume(void)\n{\n\tstruct irq_chip_generic *gc;\n\n\tlist_for_each_entry(gc, &gc_list, list) {\n\t\tstruct irq_chip_type *ct = gc->chip_types;\n\n\t\tif (gc->resume)\n\t\t\tgc->resume(gc);\n\n\t\tif (ct->chip.irq_resume) {\n\t\t\tstruct irq_data *data = irq_gc_get_irq_data(gc);\n\n\t\t\tif (data)\n\t\t\t\tct->chip.irq_resume(data);\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "irq_gc_suspend",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "585-603",
    "snippet": "static int irq_gc_suspend(void)\n{\n\tstruct irq_chip_generic *gc;\n\n\tlist_for_each_entry(gc, &gc_list, list) {\n\t\tstruct irq_chip_type *ct = gc->chip_types;\n\n\t\tif (ct->chip.irq_suspend) {\n\t\t\tstruct irq_data *data = irq_gc_get_irq_data(gc);\n\n\t\t\tif (data)\n\t\t\t\tct->chip.irq_suspend(data);\n\t\t}\n\n\t\tif (gc->suspend)\n\t\t\tgc->suspend(gc);\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [
      "#define irq_gc_suspend NULL"
    ],
    "globals_used": [
      "static LIST_HEAD(gc_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "gc->suspend",
          "args": [
            "gc"
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ct->chip.irq_suspend",
          "args": [
            "data"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_gc_get_irq_data",
          "args": [
            "gc"
          ],
          "line": 593
        },
        "resolved": true,
        "details": {
          "function_name": "irq_gc_get_irq_data",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
          "lines": "566-582",
          "snippet": "static struct irq_data *irq_gc_get_irq_data(struct irq_chip_generic *gc)\n{\n\tunsigned int virq;\n\n\tif (!gc->domain)\n\t\treturn irq_get_irq_data(gc->irq_base);\n\n\t/*\n\t * We don't know which of the irqs has been actually\n\t * installed. Use the first one.\n\t */\n\tif (!gc->installed)\n\t\treturn NULL;\n\n\tvirq = irq_find_mapping(gc->domain, gc->irq_base + __ffs(gc->installed));\n\treturn virq ? irq_get_irq_data(virq) : NULL;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/syscore_ops.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>",
            "#include <linux/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic struct irq_data *irq_gc_get_irq_data(struct irq_chip_generic *gc)\n{\n\tunsigned int virq;\n\n\tif (!gc->domain)\n\t\treturn irq_get_irq_data(gc->irq_base);\n\n\t/*\n\t * We don't know which of the irqs has been actually\n\t * installed. Use the first one.\n\t */\n\tif (!gc->installed)\n\t\treturn NULL;\n\n\tvirq = irq_find_mapping(gc->domain, gc->irq_base + __ffs(gc->installed));\n\treturn virq ? irq_get_irq_data(virq) : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "gc",
            "&gc_list",
            "list"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\n#define irq_gc_suspend NULL\n\nstatic LIST_HEAD(gc_list);\n\nstatic int irq_gc_suspend(void)\n{\n\tstruct irq_chip_generic *gc;\n\n\tlist_for_each_entry(gc, &gc_list, list) {\n\t\tstruct irq_chip_type *ct = gc->chip_types;\n\n\t\tif (ct->chip.irq_suspend) {\n\t\t\tstruct irq_data *data = irq_gc_get_irq_data(gc);\n\n\t\t\tif (data)\n\t\t\t\tct->chip.irq_suspend(data);\n\t\t}\n\n\t\tif (gc->suspend)\n\t\t\tgc->suspend(gc);\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "irq_gc_get_irq_data",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "566-582",
    "snippet": "static struct irq_data *irq_gc_get_irq_data(struct irq_chip_generic *gc)\n{\n\tunsigned int virq;\n\n\tif (!gc->domain)\n\t\treturn irq_get_irq_data(gc->irq_base);\n\n\t/*\n\t * We don't know which of the irqs has been actually\n\t * installed. Use the first one.\n\t */\n\tif (!gc->installed)\n\t\treturn NULL;\n\n\tvirq = irq_find_mapping(gc->domain, gc->irq_base + __ffs(gc->installed));\n\treturn virq ? irq_get_irq_data(virq) : NULL;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_get_irq_data",
          "args": [
            "virq"
          ],
          "line": 581
        },
        "resolved": true,
        "details": {
          "function_name": "irq_get_irq_data",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/chip.c",
          "lines": "158-163",
          "snippet": "struct irq_data *irq_get_irq_data(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\treturn desc ? &desc->irq_data : NULL;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <trace/events/irq.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/msi.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <trace/events/irq.h>\n#include <linux/irqdomain.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/msi.h>\n#include <linux/irq.h>\n\nstruct irq_data *irq_get_irq_data(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\treturn desc ? &desc->irq_data : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_find_mapping",
          "args": [
            "gc->domain",
            "gc->irq_base + __ffs(gc->installed)"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__ffs",
          "args": [
            "gc->installed"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic struct irq_data *irq_gc_get_irq_data(struct irq_chip_generic *gc)\n{\n\tunsigned int virq;\n\n\tif (!gc->domain)\n\t\treturn irq_get_irq_data(gc->irq_base);\n\n\t/*\n\t * We don't know which of the irqs has been actually\n\t * installed. Use the first one.\n\t */\n\tif (!gc->installed)\n\t\treturn NULL;\n\n\tvirq = irq_find_mapping(gc->domain, gc->irq_base + __ffs(gc->installed));\n\treturn virq ? irq_get_irq_data(virq) : NULL;\n}"
  },
  {
    "function_name": "irq_remove_generic_chip",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "544-563",
    "snippet": "void irq_remove_generic_chip(struct irq_chip_generic *gc, u32 msk,\n\t\t\t     unsigned int clr, unsigned int set)\n{\n\tunsigned int i = gc->irq_base;\n\n\traw_spin_lock(&gc_lock);\n\tlist_del(&gc->list);\n\traw_spin_unlock(&gc_lock);\n\n\tfor (; msk; msk >>= 1, i++) {\n\t\tif (!(msk & 0x01))\n\t\t\tcontinue;\n\n\t\t/* Remove handler first. That will mask the irq line */\n\t\tirq_set_handler(i, NULL);\n\t\tirq_set_chip(i, &no_irq_chip);\n\t\tirq_set_chip_data(i, NULL);\n\t\tirq_modify_status(i, clr, set);\n\t}\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_RAW_SPINLOCK(gc_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_modify_status",
          "args": [
            "i",
            "clr",
            "set"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "irq_modify_status",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/chip.c",
          "lines": "1084-1120",
          "snippet": "void irq_modify_status(unsigned int irq, unsigned long clr, unsigned long set)\n{\n\tunsigned long flags, trigger, tmp;\n\tstruct irq_desc *desc = irq_get_desc_lock(irq, &flags, 0);\n\n\tif (!desc)\n\t\treturn;\n\n\t/*\n\t * Warn when a driver sets the no autoenable flag on an already\n\t * active interrupt.\n\t */\n\tWARN_ON_ONCE(!desc->depth && (set & _IRQ_NOAUTOEN));\n\n\tirq_settings_clr_and_set(desc, clr, set);\n\n\ttrigger = irqd_get_trigger_type(&desc->irq_data);\n\n\tirqd_clear(&desc->irq_data, IRQD_NO_BALANCING | IRQD_PER_CPU |\n\t\t   IRQD_TRIGGER_MASK | IRQD_LEVEL | IRQD_MOVE_PCNTXT);\n\tif (irq_settings_has_no_balance_set(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_NO_BALANCING);\n\tif (irq_settings_is_per_cpu(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_PER_CPU);\n\tif (irq_settings_can_move_pcntxt(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_MOVE_PCNTXT);\n\tif (irq_settings_is_level(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_LEVEL);\n\n\ttmp = irq_settings_get_trigger_mask(desc);\n\tif (tmp != IRQ_TYPE_NONE)\n\t\ttrigger = tmp;\n\n\tirqd_set(&desc->irq_data, trigger);\n\n\tirq_put_desc_unlock(desc, flags);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <trace/events/irq.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/msi.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <trace/events/irq.h>\n#include <linux/irqdomain.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/msi.h>\n#include <linux/irq.h>\n\nvoid irq_modify_status(unsigned int irq, unsigned long clr, unsigned long set)\n{\n\tunsigned long flags, trigger, tmp;\n\tstruct irq_desc *desc = irq_get_desc_lock(irq, &flags, 0);\n\n\tif (!desc)\n\t\treturn;\n\n\t/*\n\t * Warn when a driver sets the no autoenable flag on an already\n\t * active interrupt.\n\t */\n\tWARN_ON_ONCE(!desc->depth && (set & _IRQ_NOAUTOEN));\n\n\tirq_settings_clr_and_set(desc, clr, set);\n\n\ttrigger = irqd_get_trigger_type(&desc->irq_data);\n\n\tirqd_clear(&desc->irq_data, IRQD_NO_BALANCING | IRQD_PER_CPU |\n\t\t   IRQD_TRIGGER_MASK | IRQD_LEVEL | IRQD_MOVE_PCNTXT);\n\tif (irq_settings_has_no_balance_set(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_NO_BALANCING);\n\tif (irq_settings_is_per_cpu(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_PER_CPU);\n\tif (irq_settings_can_move_pcntxt(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_MOVE_PCNTXT);\n\tif (irq_settings_is_level(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_LEVEL);\n\n\ttmp = irq_settings_get_trigger_mask(desc);\n\tif (tmp != IRQ_TYPE_NONE)\n\t\ttrigger = tmp;\n\n\tirqd_set(&desc->irq_data, trigger);\n\n\tirq_put_desc_unlock(desc, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_set_chip_data",
          "args": [
            "i",
            "NULL"
          ],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "irq_set_chip_data",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/chip.c",
          "lines": "145-155",
          "snippet": "int irq_set_chip_data(unsigned int irq, void *data)\n{\n\tunsigned long flags;\n\tstruct irq_desc *desc = irq_get_desc_lock(irq, &flags, 0);\n\n\tif (!desc)\n\t\treturn -EINVAL;\n\tdesc->irq_data.chip_data = data;\n\tirq_put_desc_unlock(desc, flags);\n\treturn 0;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <trace/events/irq.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/msi.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <trace/events/irq.h>\n#include <linux/irqdomain.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/msi.h>\n#include <linux/irq.h>\n\nint irq_set_chip_data(unsigned int irq, void *data)\n{\n\tunsigned long flags;\n\tstruct irq_desc *desc = irq_get_desc_lock(irq, &flags, 0);\n\n\tif (!desc)\n\t\treturn -EINVAL;\n\tdesc->irq_data.chip_data = data;\n\tirq_put_desc_unlock(desc, flags);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_set_handler",
          "args": [
            "i",
            "NULL"
          ],
          "line": 558
        },
        "resolved": true,
        "details": {
          "function_name": "irq_set_handler_data",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/chip.c",
          "lines": "90-100",
          "snippet": "int irq_set_handler_data(unsigned int irq, void *data)\n{\n\tunsigned long flags;\n\tstruct irq_desc *desc = irq_get_desc_lock(irq, &flags, 0);\n\n\tif (!desc)\n\t\treturn -EINVAL;\n\tdesc->irq_common_data.handler_data = data;\n\tirq_put_desc_unlock(desc, flags);\n\treturn 0;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <trace/events/irq.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/msi.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <trace/events/irq.h>\n#include <linux/irqdomain.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/msi.h>\n#include <linux/irq.h>\n\nint irq_set_handler_data(unsigned int irq, void *data)\n{\n\tunsigned long flags;\n\tstruct irq_desc *desc = irq_get_desc_lock(irq, &flags, 0);\n\n\tif (!desc)\n\t\treturn -EINVAL;\n\tdesc->irq_common_data.handler_data = data;\n\tirq_put_desc_unlock(desc, flags);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_unlock",
          "args": [
            "&gc_lock"
          ],
          "line": 551
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_bh",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "208-211",
          "snippet": "void __lockfunc _raw_spin_unlock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_bh(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_bh(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&gc->list"
          ],
          "line": 550
        },
        "resolved": true,
        "details": {
          "function_name": "list_del_leaf_cfs_rq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/fair.c",
          "lines": "475-477",
          "snippet": "static inline void list_del_leaf_cfs_rq(struct cfs_rq *cfs_rq)\n{\n}",
          "includes": [
            "#include \"pelt.h\"",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool sched_idle_cfs_rq(struct cfs_rq *cfs_rq);",
            "static void check_enqueue_throttle(struct cfs_rq *cfs_rq);",
            "static __always_inline void return_cfs_rq_runtime(struct cfs_rq *cfs_rq);",
            "static bool check_cfs_rq_runtime(struct cfs_rq *cfs_rq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pelt.h\"\n#include \"sched.h\"\n\nstatic bool sched_idle_cfs_rq(struct cfs_rq *cfs_rq);\nstatic void check_enqueue_throttle(struct cfs_rq *cfs_rq);\nstatic __always_inline void return_cfs_rq_runtime(struct cfs_rq *cfs_rq);\nstatic bool check_cfs_rq_runtime(struct cfs_rq *cfs_rq);\n\nstatic inline void list_del_leaf_cfs_rq(struct cfs_rq *cfs_rq)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_lock",
          "args": [
            "&gc_lock"
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_bh",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "176-179",
          "snippet": "void __lockfunc _raw_spin_lock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_bh(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_lock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_bh(lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic DEFINE_RAW_SPINLOCK(gc_lock);\n\nvoid irq_remove_generic_chip(struct irq_chip_generic *gc, u32 msk,\n\t\t\t     unsigned int clr, unsigned int set)\n{\n\tunsigned int i = gc->irq_base;\n\n\traw_spin_lock(&gc_lock);\n\tlist_del(&gc->list);\n\traw_spin_unlock(&gc_lock);\n\n\tfor (; msk; msk >>= 1, i++) {\n\t\tif (!(msk & 0x01))\n\t\t\tcontinue;\n\n\t\t/* Remove handler first. That will mask the irq line */\n\t\tirq_set_handler(i, NULL);\n\t\tirq_set_chip(i, &no_irq_chip);\n\t\tirq_set_chip_data(i, NULL);\n\t\tirq_modify_status(i, clr, set);\n\t}\n}"
  },
  {
    "function_name": "irq_setup_alt_chip",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "518-532",
    "snippet": "int irq_setup_alt_chip(struct irq_data *d, unsigned int type)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tstruct irq_chip_type *ct = gc->chip_types;\n\tunsigned int i;\n\n\tfor (i = 0; i < gc->num_ct; i++, ct++) {\n\t\tif (ct->type & type) {\n\t\t\td->chip = &ct->chip;\n\t\t\tirq_data_to_desc(d)->handle_irq = ct->handler;\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn -EINVAL;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_data_to_desc",
          "args": [
            "d"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_data_get_irq_chip_data",
          "args": [
            "d"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nint irq_setup_alt_chip(struct irq_data *d, unsigned int type)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tstruct irq_chip_type *ct = gc->chip_types;\n\tunsigned int i;\n\n\tfor (i = 0; i < gc->num_ct; i++, ct++) {\n\t\tif (ct->type & type) {\n\t\t\td->chip = &ct->chip;\n\t\t\tirq_data_to_desc(d)->handle_irq = ct->handler;\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn -EINVAL;\n}"
  },
  {
    "function_name": "irq_setup_generic_chip",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "473-508",
    "snippet": "void irq_setup_generic_chip(struct irq_chip_generic *gc, u32 msk,\n\t\t\t    enum irq_gc_flags flags, unsigned int clr,\n\t\t\t    unsigned int set)\n{\n\tstruct irq_chip_type *ct = gc->chip_types;\n\tstruct irq_chip *chip = &ct->chip;\n\tunsigned int i;\n\n\traw_spin_lock(&gc_lock);\n\tlist_add_tail(&gc->list, &gc_list);\n\traw_spin_unlock(&gc_lock);\n\n\tirq_gc_init_mask_cache(gc, flags);\n\n\tfor (i = gc->irq_base; msk; msk >>= 1, i++) {\n\t\tif (!(msk & 0x01))\n\t\t\tcontinue;\n\n\t\tif (flags & IRQ_GC_INIT_NESTED_LOCK)\n\t\t\tirq_set_lockdep_class(i, &irq_nested_lock_class,\n\t\t\t\t\t      &irq_nested_request_class);\n\n\t\tif (!(flags & IRQ_GC_NO_MASK)) {\n\t\t\tstruct irq_data *d = irq_get_irq_data(i);\n\n\t\t\tif (chip->irq_calc_mask)\n\t\t\t\tchip->irq_calc_mask(d);\n\t\t\telse\n\t\t\t\td->mask = 1 << (i - gc->irq_base);\n\t\t}\n\t\tirq_set_chip_and_handler(i, chip, ct->handler);\n\t\tirq_set_chip_data(i, gc);\n\t\tirq_modify_status(i, clr, set);\n\t}\n\tgc->irq_cnt = i - gc->irq_base;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(gc_list);",
      "static DEFINE_RAW_SPINLOCK(gc_lock);",
      "static struct lock_class_key irq_nested_lock_class;",
      "static struct lock_class_key irq_nested_request_class;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_modify_status",
          "args": [
            "i",
            "clr",
            "set"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "irq_modify_status",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/chip.c",
          "lines": "1084-1120",
          "snippet": "void irq_modify_status(unsigned int irq, unsigned long clr, unsigned long set)\n{\n\tunsigned long flags, trigger, tmp;\n\tstruct irq_desc *desc = irq_get_desc_lock(irq, &flags, 0);\n\n\tif (!desc)\n\t\treturn;\n\n\t/*\n\t * Warn when a driver sets the no autoenable flag on an already\n\t * active interrupt.\n\t */\n\tWARN_ON_ONCE(!desc->depth && (set & _IRQ_NOAUTOEN));\n\n\tirq_settings_clr_and_set(desc, clr, set);\n\n\ttrigger = irqd_get_trigger_type(&desc->irq_data);\n\n\tirqd_clear(&desc->irq_data, IRQD_NO_BALANCING | IRQD_PER_CPU |\n\t\t   IRQD_TRIGGER_MASK | IRQD_LEVEL | IRQD_MOVE_PCNTXT);\n\tif (irq_settings_has_no_balance_set(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_NO_BALANCING);\n\tif (irq_settings_is_per_cpu(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_PER_CPU);\n\tif (irq_settings_can_move_pcntxt(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_MOVE_PCNTXT);\n\tif (irq_settings_is_level(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_LEVEL);\n\n\ttmp = irq_settings_get_trigger_mask(desc);\n\tif (tmp != IRQ_TYPE_NONE)\n\t\ttrigger = tmp;\n\n\tirqd_set(&desc->irq_data, trigger);\n\n\tirq_put_desc_unlock(desc, flags);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <trace/events/irq.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/msi.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <trace/events/irq.h>\n#include <linux/irqdomain.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/msi.h>\n#include <linux/irq.h>\n\nvoid irq_modify_status(unsigned int irq, unsigned long clr, unsigned long set)\n{\n\tunsigned long flags, trigger, tmp;\n\tstruct irq_desc *desc = irq_get_desc_lock(irq, &flags, 0);\n\n\tif (!desc)\n\t\treturn;\n\n\t/*\n\t * Warn when a driver sets the no autoenable flag on an already\n\t * active interrupt.\n\t */\n\tWARN_ON_ONCE(!desc->depth && (set & _IRQ_NOAUTOEN));\n\n\tirq_settings_clr_and_set(desc, clr, set);\n\n\ttrigger = irqd_get_trigger_type(&desc->irq_data);\n\n\tirqd_clear(&desc->irq_data, IRQD_NO_BALANCING | IRQD_PER_CPU |\n\t\t   IRQD_TRIGGER_MASK | IRQD_LEVEL | IRQD_MOVE_PCNTXT);\n\tif (irq_settings_has_no_balance_set(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_NO_BALANCING);\n\tif (irq_settings_is_per_cpu(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_PER_CPU);\n\tif (irq_settings_can_move_pcntxt(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_MOVE_PCNTXT);\n\tif (irq_settings_is_level(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_LEVEL);\n\n\ttmp = irq_settings_get_trigger_mask(desc);\n\tif (tmp != IRQ_TYPE_NONE)\n\t\ttrigger = tmp;\n\n\tirqd_set(&desc->irq_data, trigger);\n\n\tirq_put_desc_unlock(desc, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_set_chip_data",
          "args": [
            "i",
            "gc"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "irq_set_chip_data",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/chip.c",
          "lines": "145-155",
          "snippet": "int irq_set_chip_data(unsigned int irq, void *data)\n{\n\tunsigned long flags;\n\tstruct irq_desc *desc = irq_get_desc_lock(irq, &flags, 0);\n\n\tif (!desc)\n\t\treturn -EINVAL;\n\tdesc->irq_data.chip_data = data;\n\tirq_put_desc_unlock(desc, flags);\n\treturn 0;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <trace/events/irq.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/msi.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <trace/events/irq.h>\n#include <linux/irqdomain.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/msi.h>\n#include <linux/irq.h>\n\nint irq_set_chip_data(unsigned int irq, void *data)\n{\n\tunsigned long flags;\n\tstruct irq_desc *desc = irq_get_desc_lock(irq, &flags, 0);\n\n\tif (!desc)\n\t\treturn -EINVAL;\n\tdesc->irq_data.chip_data = data;\n\tirq_put_desc_unlock(desc, flags);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_set_chip_and_handler",
          "args": [
            "i",
            "chip",
            "ct->handler"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chip->irq_calc_mask",
          "args": [
            "d"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_get_irq_data",
          "args": [
            "i"
          ],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "irq_get_irq_data",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/chip.c",
          "lines": "158-163",
          "snippet": "struct irq_data *irq_get_irq_data(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\treturn desc ? &desc->irq_data : NULL;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <trace/events/irq.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/msi.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <trace/events/irq.h>\n#include <linux/irqdomain.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/msi.h>\n#include <linux/irq.h>\n\nstruct irq_data *irq_get_irq_data(unsigned int irq)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\treturn desc ? &desc->irq_data : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_set_lockdep_class",
          "args": [
            "i",
            "&irq_nested_lock_class",
            "&irq_nested_request_class"
          ],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "__irq_set_lockdep_class",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/irqdesc.c",
          "lines": "933-942",
          "snippet": "void __irq_set_lockdep_class(unsigned int irq, struct lock_class_key *lock_class,\n\t\t\t     struct lock_class_key *request_class)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\tif (desc) {\n\t\tlockdep_set_class(&desc->lock, lock_class);\n\t\tlockdep_set_class(&desc->request_mutex, request_class);\n\t}\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nvoid __irq_set_lockdep_class(unsigned int irq, struct lock_class_key *lock_class,\n\t\t\t     struct lock_class_key *request_class)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\tif (desc) {\n\t\tlockdep_set_class(&desc->lock, lock_class);\n\t\tlockdep_set_class(&desc->request_mutex, request_class);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_gc_init_mask_cache",
          "args": [
            "gc",
            "flags"
          ],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "irq_gc_init_mask_cache",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
          "lines": "256-272",
          "snippet": "static void\nirq_gc_init_mask_cache(struct irq_chip_generic *gc, enum irq_gc_flags flags)\n{\n\tstruct irq_chip_type *ct = gc->chip_types;\n\tu32 *mskptr = &gc->mask_cache, mskreg = ct->regs.mask;\n\tint i;\n\n\tfor (i = 0; i < gc->num_ct; i++) {\n\t\tif (flags & IRQ_GC_MASK_CACHE_PER_TYPE) {\n\t\t\tmskptr = &ct[i].mask_cache_priv;\n\t\t\tmskreg = ct[i].regs.mask;\n\t\t}\n\t\tct[i].mask_cache = mskptr;\n\t\tif (flags & IRQ_GC_INIT_MASK_CACHE)\n\t\t\t*mskptr = irq_reg_readl(gc, mskreg);\n\t}\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/syscore_ops.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>",
            "#include <linux/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic void\nirq_gc_init_mask_cache(struct irq_chip_generic *gc, enum irq_gc_flags flags)\n{\n\tstruct irq_chip_type *ct = gc->chip_types;\n\tu32 *mskptr = &gc->mask_cache, mskreg = ct->regs.mask;\n\tint i;\n\n\tfor (i = 0; i < gc->num_ct; i++) {\n\t\tif (flags & IRQ_GC_MASK_CACHE_PER_TYPE) {\n\t\t\tmskptr = &ct[i].mask_cache_priv;\n\t\t\tmskreg = ct[i].regs.mask;\n\t\t}\n\t\tct[i].mask_cache = mskptr;\n\t\tif (flags & IRQ_GC_INIT_MASK_CACHE)\n\t\t\t*mskptr = irq_reg_readl(gc, mskreg);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_unlock",
          "args": [
            "&gc_lock"
          ],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_bh",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "208-211",
          "snippet": "void __lockfunc _raw_spin_unlock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_bh(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_bh(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&gc->list",
            "&gc_list"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock",
          "args": [
            "&gc_lock"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_bh",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "176-179",
          "snippet": "void __lockfunc _raw_spin_lock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_bh(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_lock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_bh(lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic LIST_HEAD(gc_list);\nstatic DEFINE_RAW_SPINLOCK(gc_lock);\nstatic struct lock_class_key irq_nested_lock_class;\nstatic struct lock_class_key irq_nested_request_class;\n\nvoid irq_setup_generic_chip(struct irq_chip_generic *gc, u32 msk,\n\t\t\t    enum irq_gc_flags flags, unsigned int clr,\n\t\t\t    unsigned int set)\n{\n\tstruct irq_chip_type *ct = gc->chip_types;\n\tstruct irq_chip *chip = &ct->chip;\n\tunsigned int i;\n\n\traw_spin_lock(&gc_lock);\n\tlist_add_tail(&gc->list, &gc_list);\n\traw_spin_unlock(&gc_lock);\n\n\tirq_gc_init_mask_cache(gc, flags);\n\n\tfor (i = gc->irq_base; msk; msk >>= 1, i++) {\n\t\tif (!(msk & 0x01))\n\t\t\tcontinue;\n\n\t\tif (flags & IRQ_GC_INIT_NESTED_LOCK)\n\t\t\tirq_set_lockdep_class(i, &irq_nested_lock_class,\n\t\t\t\t\t      &irq_nested_request_class);\n\n\t\tif (!(flags & IRQ_GC_NO_MASK)) {\n\t\t\tstruct irq_data *d = irq_get_irq_data(i);\n\n\t\t\tif (chip->irq_calc_mask)\n\t\t\t\tchip->irq_calc_mask(d);\n\t\t\telse\n\t\t\t\td->mask = 1 << (i - gc->irq_base);\n\t\t}\n\t\tirq_set_chip_and_handler(i, chip, ct->handler);\n\t\tirq_set_chip_data(i, gc);\n\t\tirq_modify_status(i, clr, set);\n\t}\n\tgc->irq_cnt = i - gc->irq_base;\n}"
  },
  {
    "function_name": "irq_unmap_generic_chip",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "434-452",
    "snippet": "static void irq_unmap_generic_chip(struct irq_domain *d, unsigned int virq)\n{\n\tstruct irq_data *data = irq_domain_get_irq_data(d, virq);\n\tstruct irq_domain_chip_generic *dgc = d->gc;\n\tunsigned int hw_irq = data->hwirq;\n\tstruct irq_chip_generic *gc;\n\tint irq_idx;\n\n\tgc = irq_get_domain_generic_chip(d, hw_irq);\n\tif (!gc)\n\t\treturn;\n\n\tirq_idx = hw_irq % dgc->irqs_per_chip;\n\n\tclear_bit(irq_idx, &gc->installed);\n\tirq_domain_set_info(d, virq, hw_irq, &no_irq_chip, NULL, NULL, NULL,\n\t\t\t    NULL);\n\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_domain_set_info",
          "args": [
            "d",
            "virq",
            "hw_irq",
            "&no_irq_chip",
            "NULL",
            "NULL",
            "NULL",
            "NULL"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "irq_domain_set_info",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/irqdomain.c",
          "lines": "1855-1863",
          "snippet": "void irq_domain_set_info(struct irq_domain *domain, unsigned int virq,\n\t\t\t irq_hw_number_t hwirq, struct irq_chip *chip,\n\t\t\t void *chip_data, irq_flow_handler_t handler,\n\t\t\t void *handler_data, const char *handler_name)\n{\n\tirq_set_chip_and_handler_name(virq, chip, handler, handler_name);\n\tirq_set_chip_data(virq, chip_data);\n\tirq_set_handler_data(virq, handler_data);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/smp.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/topology.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of_address.h>",
            "#include <linux/of.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irqdesc.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/acpi.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void irq_domain_check_hierarchy(struct irq_domain *domain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/topology.h>\n#include <linux/of_irq.h>\n#include <linux/of_address.h>\n#include <linux/of.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/irqdomain.h>\n#include <linux/irqdesc.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/hardirq.h>\n#include <linux/debugfs.h>\n#include <linux/acpi.h>\n\nstatic void irq_domain_check_hierarchy(struct irq_domain *domain);\n\nvoid irq_domain_set_info(struct irq_domain *domain, unsigned int virq,\n\t\t\t irq_hw_number_t hwirq, struct irq_chip *chip,\n\t\t\t void *chip_data, irq_flow_handler_t handler,\n\t\t\t void *handler_data, const char *handler_name)\n{\n\tirq_set_chip_and_handler_name(virq, chip, handler, handler_name);\n\tirq_set_chip_data(virq, chip_data);\n\tirq_set_handler_data(virq, handler_data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "irq_idx",
            "&gc->installed"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_clear_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "830-839",
          "snippet": "static void memory_bm_clear_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tclear_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_clear_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tclear_bit(bit, addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_get_domain_generic_chip",
          "args": [
            "d",
            "hw_irq"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "irq_get_domain_generic_chip",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
          "lines": "365-371",
          "snippet": "struct irq_chip_generic *\nirq_get_domain_generic_chip(struct irq_domain *d, unsigned int hw_irq)\n{\n\tstruct irq_chip_generic *gc = __irq_get_domain_generic_chip(d, hw_irq);\n\n\treturn !IS_ERR(gc) ? gc : NULL;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/syscore_ops.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>",
            "#include <linux/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstruct irq_chip_generic *\nirq_get_domain_generic_chip(struct irq_domain *d, unsigned int hw_irq)\n{\n\tstruct irq_chip_generic *gc = __irq_get_domain_generic_chip(d, hw_irq);\n\n\treturn !IS_ERR(gc) ? gc : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_domain_get_irq_data",
          "args": [
            "d",
            "virq"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "irq_domain_get_irq_data",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/irqdomain.c",
          "lines": "1835-1841",
          "snippet": "struct irq_data *irq_domain_get_irq_data(struct irq_domain *domain,\n\t\t\t\t\t unsigned int virq)\n{\n\tstruct irq_data *irq_data = irq_get_irq_data(virq);\n\n\treturn (irq_data && irq_data->domain == domain) ? irq_data : NULL;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/smp.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/topology.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of_address.h>",
            "#include <linux/of.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irqdesc.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/acpi.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void irq_domain_check_hierarchy(struct irq_domain *domain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/topology.h>\n#include <linux/of_irq.h>\n#include <linux/of_address.h>\n#include <linux/of.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/irqdomain.h>\n#include <linux/irqdesc.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/hardirq.h>\n#include <linux/debugfs.h>\n#include <linux/acpi.h>\n\nstatic void irq_domain_check_hierarchy(struct irq_domain *domain);\n\nstruct irq_data *irq_domain_get_irq_data(struct irq_domain *domain,\n\t\t\t\t\t unsigned int virq)\n{\n\tstruct irq_data *irq_data = irq_get_irq_data(virq);\n\n\treturn (irq_data && irq_data->domain == domain) ? irq_data : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic void irq_unmap_generic_chip(struct irq_domain *d, unsigned int virq)\n{\n\tstruct irq_data *data = irq_domain_get_irq_data(d, virq);\n\tstruct irq_domain_chip_generic *dgc = d->gc;\n\tunsigned int hw_irq = data->hwirq;\n\tstruct irq_chip_generic *gc;\n\tint irq_idx;\n\n\tgc = irq_get_domain_generic_chip(d, hw_irq);\n\tif (!gc)\n\t\treturn;\n\n\tirq_idx = hw_irq % dgc->irqs_per_chip;\n\n\tclear_bit(irq_idx, &gc->installed);\n\tirq_domain_set_info(d, virq, hw_irq, &no_irq_chip, NULL, NULL, NULL,\n\t\t\t    NULL);\n\n}"
  },
  {
    "function_name": "irq_map_generic_chip",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "384-432",
    "snippet": "int irq_map_generic_chip(struct irq_domain *d, unsigned int virq,\n\t\t\t irq_hw_number_t hw_irq)\n{\n\tstruct irq_data *data = irq_domain_get_irq_data(d, virq);\n\tstruct irq_domain_chip_generic *dgc = d->gc;\n\tstruct irq_chip_generic *gc;\n\tstruct irq_chip_type *ct;\n\tstruct irq_chip *chip;\n\tunsigned long flags;\n\tint idx;\n\n\tgc = __irq_get_domain_generic_chip(d, hw_irq);\n\tif (IS_ERR(gc))\n\t\treturn PTR_ERR(gc);\n\n\tidx = hw_irq % dgc->irqs_per_chip;\n\n\tif (test_bit(idx, &gc->unused))\n\t\treturn -ENOTSUPP;\n\n\tif (test_bit(idx, &gc->installed))\n\t\treturn -EBUSY;\n\n\tct = gc->chip_types;\n\tchip = &ct->chip;\n\n\t/* We only init the cache for the first mapping of a generic chip */\n\tif (!gc->installed) {\n\t\traw_spin_lock_irqsave(&gc->lock, flags);\n\t\tirq_gc_init_mask_cache(gc, dgc->gc_flags);\n\t\traw_spin_unlock_irqrestore(&gc->lock, flags);\n\t}\n\n\t/* Mark the interrupt as installed */\n\tset_bit(idx, &gc->installed);\n\n\tif (dgc->gc_flags & IRQ_GC_INIT_NESTED_LOCK)\n\t\tirq_set_lockdep_class(virq, &irq_nested_lock_class,\n\t\t\t\t      &irq_nested_request_class);\n\n\tif (chip->irq_calc_mask)\n\t\tchip->irq_calc_mask(data);\n\telse\n\t\tdata->mask = 1 << idx;\n\n\tirq_domain_set_info(d, virq, hw_irq, chip, gc, ct->handler, NULL, NULL);\n\tirq_modify_status(virq, dgc->irq_flags_to_clear, dgc->irq_flags_to_set);\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct lock_class_key irq_nested_lock_class;",
      "static struct lock_class_key irq_nested_request_class;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_modify_status",
          "args": [
            "virq",
            "dgc->irq_flags_to_clear",
            "dgc->irq_flags_to_set"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "irq_modify_status",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/chip.c",
          "lines": "1084-1120",
          "snippet": "void irq_modify_status(unsigned int irq, unsigned long clr, unsigned long set)\n{\n\tunsigned long flags, trigger, tmp;\n\tstruct irq_desc *desc = irq_get_desc_lock(irq, &flags, 0);\n\n\tif (!desc)\n\t\treturn;\n\n\t/*\n\t * Warn when a driver sets the no autoenable flag on an already\n\t * active interrupt.\n\t */\n\tWARN_ON_ONCE(!desc->depth && (set & _IRQ_NOAUTOEN));\n\n\tirq_settings_clr_and_set(desc, clr, set);\n\n\ttrigger = irqd_get_trigger_type(&desc->irq_data);\n\n\tirqd_clear(&desc->irq_data, IRQD_NO_BALANCING | IRQD_PER_CPU |\n\t\t   IRQD_TRIGGER_MASK | IRQD_LEVEL | IRQD_MOVE_PCNTXT);\n\tif (irq_settings_has_no_balance_set(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_NO_BALANCING);\n\tif (irq_settings_is_per_cpu(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_PER_CPU);\n\tif (irq_settings_can_move_pcntxt(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_MOVE_PCNTXT);\n\tif (irq_settings_is_level(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_LEVEL);\n\n\ttmp = irq_settings_get_trigger_mask(desc);\n\tif (tmp != IRQ_TYPE_NONE)\n\t\ttrigger = tmp;\n\n\tirqd_set(&desc->irq_data, trigger);\n\n\tirq_put_desc_unlock(desc, flags);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <trace/events/irq.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/msi.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <trace/events/irq.h>\n#include <linux/irqdomain.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/msi.h>\n#include <linux/irq.h>\n\nvoid irq_modify_status(unsigned int irq, unsigned long clr, unsigned long set)\n{\n\tunsigned long flags, trigger, tmp;\n\tstruct irq_desc *desc = irq_get_desc_lock(irq, &flags, 0);\n\n\tif (!desc)\n\t\treturn;\n\n\t/*\n\t * Warn when a driver sets the no autoenable flag on an already\n\t * active interrupt.\n\t */\n\tWARN_ON_ONCE(!desc->depth && (set & _IRQ_NOAUTOEN));\n\n\tirq_settings_clr_and_set(desc, clr, set);\n\n\ttrigger = irqd_get_trigger_type(&desc->irq_data);\n\n\tirqd_clear(&desc->irq_data, IRQD_NO_BALANCING | IRQD_PER_CPU |\n\t\t   IRQD_TRIGGER_MASK | IRQD_LEVEL | IRQD_MOVE_PCNTXT);\n\tif (irq_settings_has_no_balance_set(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_NO_BALANCING);\n\tif (irq_settings_is_per_cpu(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_PER_CPU);\n\tif (irq_settings_can_move_pcntxt(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_MOVE_PCNTXT);\n\tif (irq_settings_is_level(desc))\n\t\tirqd_set(&desc->irq_data, IRQD_LEVEL);\n\n\ttmp = irq_settings_get_trigger_mask(desc);\n\tif (tmp != IRQ_TYPE_NONE)\n\t\ttrigger = tmp;\n\n\tirqd_set(&desc->irq_data, trigger);\n\n\tirq_put_desc_unlock(desc, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_domain_set_info",
          "args": [
            "d",
            "virq",
            "hw_irq",
            "chip",
            "gc",
            "ct->handler",
            "NULL",
            "NULL"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "irq_domain_set_info",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/irqdomain.c",
          "lines": "1855-1863",
          "snippet": "void irq_domain_set_info(struct irq_domain *domain, unsigned int virq,\n\t\t\t irq_hw_number_t hwirq, struct irq_chip *chip,\n\t\t\t void *chip_data, irq_flow_handler_t handler,\n\t\t\t void *handler_data, const char *handler_name)\n{\n\tirq_set_chip_and_handler_name(virq, chip, handler, handler_name);\n\tirq_set_chip_data(virq, chip_data);\n\tirq_set_handler_data(virq, handler_data);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/smp.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/topology.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of_address.h>",
            "#include <linux/of.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irqdesc.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/acpi.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void irq_domain_check_hierarchy(struct irq_domain *domain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/topology.h>\n#include <linux/of_irq.h>\n#include <linux/of_address.h>\n#include <linux/of.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/irqdomain.h>\n#include <linux/irqdesc.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/hardirq.h>\n#include <linux/debugfs.h>\n#include <linux/acpi.h>\n\nstatic void irq_domain_check_hierarchy(struct irq_domain *domain);\n\nvoid irq_domain_set_info(struct irq_domain *domain, unsigned int virq,\n\t\t\t irq_hw_number_t hwirq, struct irq_chip *chip,\n\t\t\t void *chip_data, irq_flow_handler_t handler,\n\t\t\t void *handler_data, const char *handler_name)\n{\n\tirq_set_chip_and_handler_name(virq, chip, handler, handler_name);\n\tirq_set_chip_data(virq, chip_data);\n\tirq_set_handler_data(virq, handler_data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "chip->irq_calc_mask",
          "args": [
            "data"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_set_lockdep_class",
          "args": [
            "virq",
            "&irq_nested_lock_class",
            "&irq_nested_request_class"
          ],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "__irq_set_lockdep_class",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/irqdesc.c",
          "lines": "933-942",
          "snippet": "void __irq_set_lockdep_class(unsigned int irq, struct lock_class_key *lock_class,\n\t\t\t     struct lock_class_key *request_class)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\tif (desc) {\n\t\tlockdep_set_class(&desc->lock, lock_class);\n\t\tlockdep_set_class(&desc->request_mutex, request_class);\n\t}\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/sysfs.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/sysfs.h>\n#include <linux/irqdomain.h>\n#include <linux/bitmap.h>\n#include <linux/radix-tree.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n\nvoid __irq_set_lockdep_class(unsigned int irq, struct lock_class_key *lock_class,\n\t\t\t     struct lock_class_key *request_class)\n{\n\tstruct irq_desc *desc = irq_to_desc(irq);\n\n\tif (desc) {\n\t\tlockdep_set_class(&desc->lock, lock_class);\n\t\tlockdep_set_class(&desc->request_mutex, request_class);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "idx",
            "&gc->installed"
          ],
          "line": 418
        },
        "resolved": true,
        "details": {
          "function_name": "mem_bm_set_bit_check",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "817-828",
          "snippet": "static int mem_bm_set_bit_check(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tif (!error)\n\t\tset_bit(bit, addr);\n\n\treturn error;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int mem_bm_set_bit_check(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tif (!error)\n\t\tset_bit(bit, addr);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&gc->lock",
            "flags"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_gc_init_mask_cache",
          "args": [
            "gc",
            "dgc->gc_flags"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "irq_gc_init_mask_cache",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
          "lines": "256-272",
          "snippet": "static void\nirq_gc_init_mask_cache(struct irq_chip_generic *gc, enum irq_gc_flags flags)\n{\n\tstruct irq_chip_type *ct = gc->chip_types;\n\tu32 *mskptr = &gc->mask_cache, mskreg = ct->regs.mask;\n\tint i;\n\n\tfor (i = 0; i < gc->num_ct; i++) {\n\t\tif (flags & IRQ_GC_MASK_CACHE_PER_TYPE) {\n\t\t\tmskptr = &ct[i].mask_cache_priv;\n\t\t\tmskreg = ct[i].regs.mask;\n\t\t}\n\t\tct[i].mask_cache = mskptr;\n\t\tif (flags & IRQ_GC_INIT_MASK_CACHE)\n\t\t\t*mskptr = irq_reg_readl(gc, mskreg);\n\t}\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/syscore_ops.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>",
            "#include <linux/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic void\nirq_gc_init_mask_cache(struct irq_chip_generic *gc, enum irq_gc_flags flags)\n{\n\tstruct irq_chip_type *ct = gc->chip_types;\n\tu32 *mskptr = &gc->mask_cache, mskreg = ct->regs.mask;\n\tint i;\n\n\tfor (i = 0; i < gc->num_ct; i++) {\n\t\tif (flags & IRQ_GC_MASK_CACHE_PER_TYPE) {\n\t\t\tmskptr = &ct[i].mask_cache_priv;\n\t\t\tmskreg = ct[i].regs.mask;\n\t\t}\n\t\tct[i].mask_cache = mskptr;\n\t\tif (flags & IRQ_GC_INIT_MASK_CACHE)\n\t\t\t*mskptr = irq_reg_readl(gc, mskreg);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&gc->lock",
            "flags"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "idx",
            "&gc->installed"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_test_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "849-858",
          "snippet": "static int memory_bm_test_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\treturn test_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int memory_bm_test_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\treturn test_bit(bit, addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "gc"
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "gc"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__irq_get_domain_generic_chip",
          "args": [
            "d",
            "hw_irq"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "__irq_get_domain_generic_chip",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
          "lines": "346-358",
          "snippet": "static struct irq_chip_generic *\n__irq_get_domain_generic_chip(struct irq_domain *d, unsigned int hw_irq)\n{\n\tstruct irq_domain_chip_generic *dgc = d->gc;\n\tint idx;\n\n\tif (!dgc)\n\t\treturn ERR_PTR(-ENODEV);\n\tidx = hw_irq / dgc->irqs_per_chip;\n\tif (idx >= dgc->num_chips)\n\t\treturn ERR_PTR(-EINVAL);\n\treturn dgc->gc[idx];\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/syscore_ops.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>",
            "#include <linux/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic struct irq_chip_generic *\n__irq_get_domain_generic_chip(struct irq_domain *d, unsigned int hw_irq)\n{\n\tstruct irq_domain_chip_generic *dgc = d->gc;\n\tint idx;\n\n\tif (!dgc)\n\t\treturn ERR_PTR(-ENODEV);\n\tidx = hw_irq / dgc->irqs_per_chip;\n\tif (idx >= dgc->num_chips)\n\t\treturn ERR_PTR(-EINVAL);\n\treturn dgc->gc[idx];\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_domain_get_irq_data",
          "args": [
            "d",
            "virq"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "irq_domain_get_irq_data",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/irqdomain.c",
          "lines": "1835-1841",
          "snippet": "struct irq_data *irq_domain_get_irq_data(struct irq_domain *domain,\n\t\t\t\t\t unsigned int virq)\n{\n\tstruct irq_data *irq_data = irq_get_irq_data(virq);\n\n\treturn (irq_data && irq_data->domain == domain) ? irq_data : NULL;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/smp.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/topology.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of_address.h>",
            "#include <linux/of.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irqdesc.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/acpi.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void irq_domain_check_hierarchy(struct irq_domain *domain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/topology.h>\n#include <linux/of_irq.h>\n#include <linux/of_address.h>\n#include <linux/of.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/irqdomain.h>\n#include <linux/irqdesc.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/hardirq.h>\n#include <linux/debugfs.h>\n#include <linux/acpi.h>\n\nstatic void irq_domain_check_hierarchy(struct irq_domain *domain);\n\nstruct irq_data *irq_domain_get_irq_data(struct irq_domain *domain,\n\t\t\t\t\t unsigned int virq)\n{\n\tstruct irq_data *irq_data = irq_get_irq_data(virq);\n\n\treturn (irq_data && irq_data->domain == domain) ? irq_data : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic struct lock_class_key irq_nested_lock_class;\nstatic struct lock_class_key irq_nested_request_class;\n\nint irq_map_generic_chip(struct irq_domain *d, unsigned int virq,\n\t\t\t irq_hw_number_t hw_irq)\n{\n\tstruct irq_data *data = irq_domain_get_irq_data(d, virq);\n\tstruct irq_domain_chip_generic *dgc = d->gc;\n\tstruct irq_chip_generic *gc;\n\tstruct irq_chip_type *ct;\n\tstruct irq_chip *chip;\n\tunsigned long flags;\n\tint idx;\n\n\tgc = __irq_get_domain_generic_chip(d, hw_irq);\n\tif (IS_ERR(gc))\n\t\treturn PTR_ERR(gc);\n\n\tidx = hw_irq % dgc->irqs_per_chip;\n\n\tif (test_bit(idx, &gc->unused))\n\t\treturn -ENOTSUPP;\n\n\tif (test_bit(idx, &gc->installed))\n\t\treturn -EBUSY;\n\n\tct = gc->chip_types;\n\tchip = &ct->chip;\n\n\t/* We only init the cache for the first mapping of a generic chip */\n\tif (!gc->installed) {\n\t\traw_spin_lock_irqsave(&gc->lock, flags);\n\t\tirq_gc_init_mask_cache(gc, dgc->gc_flags);\n\t\traw_spin_unlock_irqrestore(&gc->lock, flags);\n\t}\n\n\t/* Mark the interrupt as installed */\n\tset_bit(idx, &gc->installed);\n\n\tif (dgc->gc_flags & IRQ_GC_INIT_NESTED_LOCK)\n\t\tirq_set_lockdep_class(virq, &irq_nested_lock_class,\n\t\t\t\t      &irq_nested_request_class);\n\n\tif (chip->irq_calc_mask)\n\t\tchip->irq_calc_mask(data);\n\telse\n\t\tdata->mask = 1 << idx;\n\n\tirq_domain_set_info(d, virq, hw_irq, chip, gc, ct->handler, NULL, NULL);\n\tirq_modify_status(virq, dgc->irq_flags_to_clear, dgc->irq_flags_to_set);\n\treturn 0;\n}"
  },
  {
    "function_name": "irq_get_domain_generic_chip",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "365-371",
    "snippet": "struct irq_chip_generic *\nirq_get_domain_generic_chip(struct irq_domain *d, unsigned int hw_irq)\n{\n\tstruct irq_chip_generic *gc = __irq_get_domain_generic_chip(d, hw_irq);\n\n\treturn !IS_ERR(gc) ? gc : NULL;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "gc"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__irq_get_domain_generic_chip",
          "args": [
            "d",
            "hw_irq"
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "__irq_get_domain_generic_chip",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
          "lines": "346-358",
          "snippet": "static struct irq_chip_generic *\n__irq_get_domain_generic_chip(struct irq_domain *d, unsigned int hw_irq)\n{\n\tstruct irq_domain_chip_generic *dgc = d->gc;\n\tint idx;\n\n\tif (!dgc)\n\t\treturn ERR_PTR(-ENODEV);\n\tidx = hw_irq / dgc->irqs_per_chip;\n\tif (idx >= dgc->num_chips)\n\t\treturn ERR_PTR(-EINVAL);\n\treturn dgc->gc[idx];\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/syscore_ops.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>",
            "#include <linux/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic struct irq_chip_generic *\n__irq_get_domain_generic_chip(struct irq_domain *d, unsigned int hw_irq)\n{\n\tstruct irq_domain_chip_generic *dgc = d->gc;\n\tint idx;\n\n\tif (!dgc)\n\t\treturn ERR_PTR(-ENODEV);\n\tidx = hw_irq / dgc->irqs_per_chip;\n\tif (idx >= dgc->num_chips)\n\t\treturn ERR_PTR(-EINVAL);\n\treturn dgc->gc[idx];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstruct irq_chip_generic *\nirq_get_domain_generic_chip(struct irq_domain *d, unsigned int hw_irq)\n{\n\tstruct irq_chip_generic *gc = __irq_get_domain_generic_chip(d, hw_irq);\n\n\treturn !IS_ERR(gc) ? gc : NULL;\n}"
  },
  {
    "function_name": "__irq_get_domain_generic_chip",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "346-358",
    "snippet": "static struct irq_chip_generic *\n__irq_get_domain_generic_chip(struct irq_domain *d, unsigned int hw_irq)\n{\n\tstruct irq_domain_chip_generic *dgc = d->gc;\n\tint idx;\n\n\tif (!dgc)\n\t\treturn ERR_PTR(-ENODEV);\n\tidx = hw_irq / dgc->irqs_per_chip;\n\tif (idx >= dgc->num_chips)\n\t\treturn ERR_PTR(-EINVAL);\n\treturn dgc->gc[idx];\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EINVAL"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENODEV"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic struct irq_chip_generic *\n__irq_get_domain_generic_chip(struct irq_domain *d, unsigned int hw_irq)\n{\n\tstruct irq_domain_chip_generic *dgc = d->gc;\n\tint idx;\n\n\tif (!dgc)\n\t\treturn ERR_PTR(-ENODEV);\n\tidx = hw_irq / dgc->irqs_per_chip;\n\tif (idx >= dgc->num_chips)\n\t\treturn ERR_PTR(-EINVAL);\n\treturn dgc->gc[idx];\n}"
  },
  {
    "function_name": "__irq_alloc_domain_generic_chips",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "285-343",
    "snippet": "int __irq_alloc_domain_generic_chips(struct irq_domain *d, int irqs_per_chip,\n\t\t\t\t     int num_ct, const char *name,\n\t\t\t\t     irq_flow_handler_t handler,\n\t\t\t\t     unsigned int clr, unsigned int set,\n\t\t\t\t     enum irq_gc_flags gcflags)\n{\n\tstruct irq_domain_chip_generic *dgc;\n\tstruct irq_chip_generic *gc;\n\tunsigned long flags;\n\tint numchips, i;\n\tsize_t dgc_sz;\n\tsize_t gc_sz;\n\tsize_t sz;\n\tvoid *tmp;\n\n\tif (d->gc)\n\t\treturn -EBUSY;\n\n\tnumchips = DIV_ROUND_UP(d->revmap_size, irqs_per_chip);\n\tif (!numchips)\n\t\treturn -EINVAL;\n\n\t/* Allocate a pointer, generic chip and chiptypes for each chip */\n\tgc_sz = struct_size(gc, chip_types, num_ct);\n\tdgc_sz = struct_size(dgc, gc, numchips);\n\tsz = dgc_sz + numchips * gc_sz;\n\n\ttmp = dgc = kzalloc(sz, GFP_KERNEL);\n\tif (!dgc)\n\t\treturn -ENOMEM;\n\tdgc->irqs_per_chip = irqs_per_chip;\n\tdgc->num_chips = numchips;\n\tdgc->irq_flags_to_set = set;\n\tdgc->irq_flags_to_clear = clr;\n\tdgc->gc_flags = gcflags;\n\td->gc = dgc;\n\n\t/* Calc pointer to the first generic chip */\n\ttmp += dgc_sz;\n\tfor (i = 0; i < numchips; i++) {\n\t\t/* Store the pointer to the generic chip */\n\t\tdgc->gc[i] = gc = tmp;\n\t\tirq_init_generic_chip(gc, name, num_ct, i * irqs_per_chip,\n\t\t\t\t      NULL, handler);\n\n\t\tgc->domain = d;\n\t\tif (gcflags & IRQ_GC_BE_IO) {\n\t\t\tgc->reg_readl = &irq_readl_be;\n\t\t\tgc->reg_writel = &irq_writel_be;\n\t\t}\n\n\t\traw_spin_lock_irqsave(&gc_lock, flags);\n\t\tlist_add_tail(&gc->list, &gc_list);\n\t\traw_spin_unlock_irqrestore(&gc_lock, flags);\n\t\t/* Calc pointer to the next generic chip */\n\t\ttmp += gc_sz;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(gc_list);",
      "static DEFINE_RAW_SPINLOCK(gc_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&gc_lock",
            "flags"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&gc->list",
            "&gc_list"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&gc_lock",
            "flags"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_init_generic_chip",
          "args": [
            "gc",
            "name",
            "num_ct",
            "i * irqs_per_chip",
            "NULL",
            "handler"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "irq_init_generic_chip",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
          "lines": "218-228",
          "snippet": "void irq_init_generic_chip(struct irq_chip_generic *gc, const char *name,\n\t\t\t   int num_ct, unsigned int irq_base,\n\t\t\t   void __iomem *reg_base, irq_flow_handler_t handler)\n{\n\traw_spin_lock_init(&gc->lock);\n\tgc->num_ct = num_ct;\n\tgc->irq_base = irq_base;\n\tgc->reg_base = reg_base;\n\tgc->chip_types->chip.name = name;\n\tgc->chip_types->handler = handler;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/syscore_ops.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>",
            "#include <linux/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nvoid irq_init_generic_chip(struct irq_chip_generic *gc, const char *name,\n\t\t\t   int num_ct, unsigned int irq_base,\n\t\t\t   void __iomem *reg_base, irq_flow_handler_t handler)\n{\n\traw_spin_lock_init(&gc->lock);\n\tgc->num_ct = num_ct;\n\tgc->irq_base = irq_base;\n\tgc->reg_base = reg_base;\n\tgc->chip_types->chip.name = name;\n\tgc->chip_types->handler = handler;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sz",
            "GFP_KERNEL"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "struct_size",
          "args": [
            "dgc",
            "gc",
            "numchips"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "struct_size",
          "args": [
            "gc",
            "chip_types",
            "num_ct"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "d->revmap_size",
            "irqs_per_chip"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic LIST_HEAD(gc_list);\nstatic DEFINE_RAW_SPINLOCK(gc_lock);\n\nint __irq_alloc_domain_generic_chips(struct irq_domain *d, int irqs_per_chip,\n\t\t\t\t     int num_ct, const char *name,\n\t\t\t\t     irq_flow_handler_t handler,\n\t\t\t\t     unsigned int clr, unsigned int set,\n\t\t\t\t     enum irq_gc_flags gcflags)\n{\n\tstruct irq_domain_chip_generic *dgc;\n\tstruct irq_chip_generic *gc;\n\tunsigned long flags;\n\tint numchips, i;\n\tsize_t dgc_sz;\n\tsize_t gc_sz;\n\tsize_t sz;\n\tvoid *tmp;\n\n\tif (d->gc)\n\t\treturn -EBUSY;\n\n\tnumchips = DIV_ROUND_UP(d->revmap_size, irqs_per_chip);\n\tif (!numchips)\n\t\treturn -EINVAL;\n\n\t/* Allocate a pointer, generic chip and chiptypes for each chip */\n\tgc_sz = struct_size(gc, chip_types, num_ct);\n\tdgc_sz = struct_size(dgc, gc, numchips);\n\tsz = dgc_sz + numchips * gc_sz;\n\n\ttmp = dgc = kzalloc(sz, GFP_KERNEL);\n\tif (!dgc)\n\t\treturn -ENOMEM;\n\tdgc->irqs_per_chip = irqs_per_chip;\n\tdgc->num_chips = numchips;\n\tdgc->irq_flags_to_set = set;\n\tdgc->irq_flags_to_clear = clr;\n\tdgc->gc_flags = gcflags;\n\td->gc = dgc;\n\n\t/* Calc pointer to the first generic chip */\n\ttmp += dgc_sz;\n\tfor (i = 0; i < numchips; i++) {\n\t\t/* Store the pointer to the generic chip */\n\t\tdgc->gc[i] = gc = tmp;\n\t\tirq_init_generic_chip(gc, name, num_ct, i * irqs_per_chip,\n\t\t\t\t      NULL, handler);\n\n\t\tgc->domain = d;\n\t\tif (gcflags & IRQ_GC_BE_IO) {\n\t\t\tgc->reg_readl = &irq_readl_be;\n\t\t\tgc->reg_writel = &irq_writel_be;\n\t\t}\n\n\t\traw_spin_lock_irqsave(&gc_lock, flags);\n\t\tlist_add_tail(&gc->list, &gc_list);\n\t\traw_spin_unlock_irqrestore(&gc_lock, flags);\n\t\t/* Calc pointer to the next generic chip */\n\t\ttmp += gc_sz;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "irq_gc_init_mask_cache",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "256-272",
    "snippet": "static void\nirq_gc_init_mask_cache(struct irq_chip_generic *gc, enum irq_gc_flags flags)\n{\n\tstruct irq_chip_type *ct = gc->chip_types;\n\tu32 *mskptr = &gc->mask_cache, mskreg = ct->regs.mask;\n\tint i;\n\n\tfor (i = 0; i < gc->num_ct; i++) {\n\t\tif (flags & IRQ_GC_MASK_CACHE_PER_TYPE) {\n\t\t\tmskptr = &ct[i].mask_cache_priv;\n\t\t\tmskreg = ct[i].regs.mask;\n\t\t}\n\t\tct[i].mask_cache = mskptr;\n\t\tif (flags & IRQ_GC_INIT_MASK_CACHE)\n\t\t\t*mskptr = irq_reg_readl(gc, mskreg);\n\t}\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_reg_readl",
          "args": [
            "gc",
            "mskreg"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic void\nirq_gc_init_mask_cache(struct irq_chip_generic *gc, enum irq_gc_flags flags)\n{\n\tstruct irq_chip_type *ct = gc->chip_types;\n\tu32 *mskptr = &gc->mask_cache, mskreg = ct->regs.mask;\n\tint i;\n\n\tfor (i = 0; i < gc->num_ct; i++) {\n\t\tif (flags & IRQ_GC_MASK_CACHE_PER_TYPE) {\n\t\t\tmskptr = &ct[i].mask_cache_priv;\n\t\t\tmskreg = ct[i].regs.mask;\n\t\t}\n\t\tct[i].mask_cache = mskptr;\n\t\tif (flags & IRQ_GC_INIT_MASK_CACHE)\n\t\t\t*mskptr = irq_reg_readl(gc, mskreg);\n\t}\n}"
  },
  {
    "function_name": "irq_alloc_generic_chip",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "241-253",
    "snippet": "struct irq_chip_generic *\nirq_alloc_generic_chip(const char *name, int num_ct, unsigned int irq_base,\n\t\t       void __iomem *reg_base, irq_flow_handler_t handler)\n{\n\tstruct irq_chip_generic *gc;\n\n\tgc = kzalloc(struct_size(gc, chip_types, num_ct), GFP_KERNEL);\n\tif (gc) {\n\t\tirq_init_generic_chip(gc, name, num_ct, irq_base, reg_base,\n\t\t\t\t      handler);\n\t}\n\treturn gc;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_init_generic_chip",
          "args": [
            "gc",
            "name",
            "num_ct",
            "irq_base",
            "reg_base",
            "handler"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "irq_init_generic_chip",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
          "lines": "218-228",
          "snippet": "void irq_init_generic_chip(struct irq_chip_generic *gc, const char *name,\n\t\t\t   int num_ct, unsigned int irq_base,\n\t\t\t   void __iomem *reg_base, irq_flow_handler_t handler)\n{\n\traw_spin_lock_init(&gc->lock);\n\tgc->num_ct = num_ct;\n\tgc->irq_base = irq_base;\n\tgc->reg_base = reg_base;\n\tgc->chip_types->chip.name = name;\n\tgc->chip_types->handler = handler;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/syscore_ops.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/irq.h>",
            "#include <linux/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nvoid irq_init_generic_chip(struct irq_chip_generic *gc, const char *name,\n\t\t\t   int num_ct, unsigned int irq_base,\n\t\t\t   void __iomem *reg_base, irq_flow_handler_t handler)\n{\n\traw_spin_lock_init(&gc->lock);\n\tgc->num_ct = num_ct;\n\tgc->irq_base = irq_base;\n\tgc->reg_base = reg_base;\n\tgc->chip_types->chip.name = name;\n\tgc->chip_types->handler = handler;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "struct_size(gc, chip_types, num_ct)",
            "GFP_KERNEL"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "struct_size",
          "args": [
            "gc",
            "chip_types",
            "num_ct"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstruct irq_chip_generic *\nirq_alloc_generic_chip(const char *name, int num_ct, unsigned int irq_base,\n\t\t       void __iomem *reg_base, irq_flow_handler_t handler)\n{\n\tstruct irq_chip_generic *gc;\n\n\tgc = kzalloc(struct_size(gc, chip_types, num_ct), GFP_KERNEL);\n\tif (gc) {\n\t\tirq_init_generic_chip(gc, name, num_ct, irq_base, reg_base,\n\t\t\t\t      handler);\n\t}\n\treturn gc;\n}"
  },
  {
    "function_name": "irq_init_generic_chip",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "218-228",
    "snippet": "void irq_init_generic_chip(struct irq_chip_generic *gc, const char *name,\n\t\t\t   int num_ct, unsigned int irq_base,\n\t\t\t   void __iomem *reg_base, irq_flow_handler_t handler)\n{\n\traw_spin_lock_init(&gc->lock);\n\tgc->num_ct = num_ct;\n\tgc->irq_base = irq_base;\n\tgc->reg_base = reg_base;\n\tgc->chip_types->chip.name = name;\n\tgc->chip_types->handler = handler;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_lock_init",
          "args": [
            "&gc->lock"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nvoid irq_init_generic_chip(struct irq_chip_generic *gc, const char *name,\n\t\t\t   int num_ct, unsigned int irq_base,\n\t\t\t   void __iomem *reg_base, irq_flow_handler_t handler)\n{\n\traw_spin_lock_init(&gc->lock);\n\tgc->num_ct = num_ct;\n\tgc->irq_base = irq_base;\n\tgc->reg_base = reg_base;\n\tgc->chip_types->chip.name = name;\n\tgc->chip_types->handler = handler;\n}"
  },
  {
    "function_name": "irq_writel_be",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "213-216",
    "snippet": "static void irq_writel_be(u32 val, void __iomem *addr)\n{\n\tiowrite32be(val, addr);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iowrite32be",
          "args": [
            "val",
            "addr"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic void irq_writel_be(u32 val, void __iomem *addr)\n{\n\tiowrite32be(val, addr);\n}"
  },
  {
    "function_name": "irq_readl_be",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "208-211",
    "snippet": "static u32 irq_readl_be(void __iomem *addr)\n{\n\treturn ioread32be(addr);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ioread32be",
          "args": [
            "addr"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nstatic u32 irq_readl_be(void __iomem *addr)\n{\n\treturn ioread32be(addr);\n}"
  },
  {
    "function_name": "irq_gc_set_wake",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "190-205",
    "snippet": "int irq_gc_set_wake(struct irq_data *d, unsigned int on)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tu32 mask = d->mask;\n\n\tif (!(mask & gc->wake_enabled))\n\t\treturn -EINVAL;\n\n\tirq_gc_lock(gc);\n\tif (on)\n\t\tgc->wake_active |= mask;\n\telse\n\t\tgc->wake_active &= ~mask;\n\tirq_gc_unlock(gc);\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_gc_unlock",
          "args": [
            "gc"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_gc_lock",
          "args": [
            "gc"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_data_get_irq_chip_data",
          "args": [
            "d"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nint irq_gc_set_wake(struct irq_data *d, unsigned int on)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tu32 mask = d->mask;\n\n\tif (!(mask & gc->wake_enabled))\n\t\treturn -EINVAL;\n\n\tirq_gc_lock(gc);\n\tif (on)\n\t\tgc->wake_active |= mask;\n\telse\n\t\tgc->wake_active &= ~mask;\n\tirq_gc_unlock(gc);\n\treturn 0;\n}"
  },
  {
    "function_name": "irq_gc_eoi",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "170-179",
    "snippet": "void irq_gc_eoi(struct irq_data *d)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tstruct irq_chip_type *ct = irq_data_get_chip_type(d);\n\tu32 mask = d->mask;\n\n\tirq_gc_lock(gc);\n\tirq_reg_writel(gc, mask, ct->regs.eoi);\n\tirq_gc_unlock(gc);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_gc_unlock",
          "args": [
            "gc"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_reg_writel",
          "args": [
            "gc",
            "mask",
            "ct->regs.eoi"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_gc_lock",
          "args": [
            "gc"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_data_get_chip_type",
          "args": [
            "d"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_data_get_irq_chip_data",
          "args": [
            "d"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nvoid irq_gc_eoi(struct irq_data *d)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tstruct irq_chip_type *ct = irq_data_get_chip_type(d);\n\tu32 mask = d->mask;\n\n\tirq_gc_lock(gc);\n\tirq_reg_writel(gc, mask, ct->regs.eoi);\n\tirq_gc_unlock(gc);\n}"
  },
  {
    "function_name": "irq_gc_mask_disable_and_ack_set",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "153-164",
    "snippet": "void irq_gc_mask_disable_and_ack_set(struct irq_data *d)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tstruct irq_chip_type *ct = irq_data_get_chip_type(d);\n\tu32 mask = d->mask;\n\n\tirq_gc_lock(gc);\n\tirq_reg_writel(gc, mask, ct->regs.disable);\n\t*ct->mask_cache &= ~mask;\n\tirq_reg_writel(gc, mask, ct->regs.ack);\n\tirq_gc_unlock(gc);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_gc_unlock",
          "args": [
            "gc"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_reg_writel",
          "args": [
            "gc",
            "mask",
            "ct->regs.ack"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_reg_writel",
          "args": [
            "gc",
            "mask",
            "ct->regs.disable"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_gc_lock",
          "args": [
            "gc"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_data_get_chip_type",
          "args": [
            "d"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_data_get_irq_chip_data",
          "args": [
            "d"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nvoid irq_gc_mask_disable_and_ack_set(struct irq_data *d)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tstruct irq_chip_type *ct = irq_data_get_chip_type(d);\n\tu32 mask = d->mask;\n\n\tirq_gc_lock(gc);\n\tirq_reg_writel(gc, mask, ct->regs.disable);\n\t*ct->mask_cache &= ~mask;\n\tirq_reg_writel(gc, mask, ct->regs.ack);\n\tirq_gc_unlock(gc);\n}"
  },
  {
    "function_name": "irq_gc_ack_clr_bit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "130-139",
    "snippet": "void irq_gc_ack_clr_bit(struct irq_data *d)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tstruct irq_chip_type *ct = irq_data_get_chip_type(d);\n\tu32 mask = ~d->mask;\n\n\tirq_gc_lock(gc);\n\tirq_reg_writel(gc, mask, ct->regs.ack);\n\tirq_gc_unlock(gc);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_gc_unlock",
          "args": [
            "gc"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_reg_writel",
          "args": [
            "gc",
            "mask",
            "ct->regs.ack"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_gc_lock",
          "args": [
            "gc"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_data_get_chip_type",
          "args": [
            "d"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_data_get_irq_chip_data",
          "args": [
            "d"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nvoid irq_gc_ack_clr_bit(struct irq_data *d)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tstruct irq_chip_type *ct = irq_data_get_chip_type(d);\n\tu32 mask = ~d->mask;\n\n\tirq_gc_lock(gc);\n\tirq_reg_writel(gc, mask, ct->regs.ack);\n\tirq_gc_unlock(gc);\n}"
  },
  {
    "function_name": "irq_gc_ack_set_bit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "114-123",
    "snippet": "void irq_gc_ack_set_bit(struct irq_data *d)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tstruct irq_chip_type *ct = irq_data_get_chip_type(d);\n\tu32 mask = d->mask;\n\n\tirq_gc_lock(gc);\n\tirq_reg_writel(gc, mask, ct->regs.ack);\n\tirq_gc_unlock(gc);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_gc_unlock",
          "args": [
            "gc"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_reg_writel",
          "args": [
            "gc",
            "mask",
            "ct->regs.ack"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_gc_lock",
          "args": [
            "gc"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_data_get_chip_type",
          "args": [
            "d"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_data_get_irq_chip_data",
          "args": [
            "d"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nvoid irq_gc_ack_set_bit(struct irq_data *d)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tstruct irq_chip_type *ct = irq_data_get_chip_type(d);\n\tu32 mask = d->mask;\n\n\tirq_gc_lock(gc);\n\tirq_reg_writel(gc, mask, ct->regs.ack);\n\tirq_gc_unlock(gc);\n}"
  },
  {
    "function_name": "irq_gc_unmask_enable_reg",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "97-107",
    "snippet": "void irq_gc_unmask_enable_reg(struct irq_data *d)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tstruct irq_chip_type *ct = irq_data_get_chip_type(d);\n\tu32 mask = d->mask;\n\n\tirq_gc_lock(gc);\n\tirq_reg_writel(gc, mask, ct->regs.enable);\n\t*ct->mask_cache |= mask;\n\tirq_gc_unlock(gc);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_gc_unlock",
          "args": [
            "gc"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_reg_writel",
          "args": [
            "gc",
            "mask",
            "ct->regs.enable"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_gc_lock",
          "args": [
            "gc"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_data_get_chip_type",
          "args": [
            "d"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_data_get_irq_chip_data",
          "args": [
            "d"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nvoid irq_gc_unmask_enable_reg(struct irq_data *d)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tstruct irq_chip_type *ct = irq_data_get_chip_type(d);\n\tu32 mask = d->mask;\n\n\tirq_gc_lock(gc);\n\tirq_reg_writel(gc, mask, ct->regs.enable);\n\t*ct->mask_cache |= mask;\n\tirq_gc_unlock(gc);\n}"
  },
  {
    "function_name": "irq_gc_mask_clr_bit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "77-87",
    "snippet": "void irq_gc_mask_clr_bit(struct irq_data *d)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tstruct irq_chip_type *ct = irq_data_get_chip_type(d);\n\tu32 mask = d->mask;\n\n\tirq_gc_lock(gc);\n\t*ct->mask_cache &= ~mask;\n\tirq_reg_writel(gc, *ct->mask_cache, ct->regs.mask);\n\tirq_gc_unlock(gc);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_gc_unlock",
          "args": [
            "gc"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_reg_writel",
          "args": [
            "gc",
            "*ct->mask_cache",
            "ct->regs.mask"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_gc_lock",
          "args": [
            "gc"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_data_get_chip_type",
          "args": [
            "d"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_data_get_irq_chip_data",
          "args": [
            "d"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nvoid irq_gc_mask_clr_bit(struct irq_data *d)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tstruct irq_chip_type *ct = irq_data_get_chip_type(d);\n\tu32 mask = d->mask;\n\n\tirq_gc_lock(gc);\n\t*ct->mask_cache &= ~mask;\n\tirq_reg_writel(gc, *ct->mask_cache, ct->regs.mask);\n\tirq_gc_unlock(gc);\n}"
  },
  {
    "function_name": "irq_gc_mask_set_bit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "57-67",
    "snippet": "void irq_gc_mask_set_bit(struct irq_data *d)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tstruct irq_chip_type *ct = irq_data_get_chip_type(d);\n\tu32 mask = d->mask;\n\n\tirq_gc_lock(gc);\n\t*ct->mask_cache |= mask;\n\tirq_reg_writel(gc, *ct->mask_cache, ct->regs.mask);\n\tirq_gc_unlock(gc);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_gc_unlock",
          "args": [
            "gc"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_reg_writel",
          "args": [
            "gc",
            "*ct->mask_cache",
            "ct->regs.mask"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_gc_lock",
          "args": [
            "gc"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_data_get_chip_type",
          "args": [
            "d"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_data_get_irq_chip_data",
          "args": [
            "d"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nvoid irq_gc_mask_set_bit(struct irq_data *d)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tstruct irq_chip_type *ct = irq_data_get_chip_type(d);\n\tu32 mask = d->mask;\n\n\tirq_gc_lock(gc);\n\t*ct->mask_cache |= mask;\n\tirq_reg_writel(gc, *ct->mask_cache, ct->regs.mask);\n\tirq_gc_unlock(gc);\n}"
  },
  {
    "function_name": "irq_gc_mask_disable_reg",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "37-47",
    "snippet": "void irq_gc_mask_disable_reg(struct irq_data *d)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tstruct irq_chip_type *ct = irq_data_get_chip_type(d);\n\tu32 mask = d->mask;\n\n\tirq_gc_lock(gc);\n\tirq_reg_writel(gc, mask, ct->regs.disable);\n\t*ct->mask_cache &= ~mask;\n\tirq_gc_unlock(gc);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_gc_unlock",
          "args": [
            "gc"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_reg_writel",
          "args": [
            "gc",
            "mask",
            "ct->regs.disable"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_gc_lock",
          "args": [
            "gc"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_data_get_chip_type",
          "args": [
            "d"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_data_get_irq_chip_data",
          "args": [
            "d"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nvoid irq_gc_mask_disable_reg(struct irq_data *d)\n{\n\tstruct irq_chip_generic *gc = irq_data_get_irq_chip_data(d);\n\tstruct irq_chip_type *ct = irq_data_get_chip_type(d);\n\tu32 mask = d->mask;\n\n\tirq_gc_lock(gc);\n\tirq_reg_writel(gc, mask, ct->regs.disable);\n\t*ct->mask_cache &= ~mask;\n\tirq_gc_unlock(gc);\n}"
  },
  {
    "function_name": "irq_gc_noop",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/generic-chip.c",
    "lines": "25-27",
    "snippet": "void irq_gc_noop(struct irq_data *d)\n{\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/syscore_ops.h>",
      "#include <linux/kernel_stat.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/irq.h>",
      "#include <linux/io.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/irqdomain.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/irq.h>\n#include <linux/io.h>\n\nvoid irq_gc_noop(struct irq_data *d)\n{\n}"
  }
]