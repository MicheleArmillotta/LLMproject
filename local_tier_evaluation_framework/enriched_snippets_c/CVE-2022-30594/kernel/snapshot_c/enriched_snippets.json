[
  {
    "function_name": "restore_highmem",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2742-2760",
    "snippet": "int restore_highmem(void)\n{\n\tstruct highmem_pbe *pbe = highmem_pblist;\n\tvoid *buf;\n\n\tif (!pbe)\n\t\treturn 0;\n\n\tbuf = get_image_page(GFP_ATOMIC, PG_SAFE);\n\tif (!buf)\n\t\treturn -ENOMEM;\n\n\twhile (pbe) {\n\t\tswap_two_pages_data(pbe->copy_page, pbe->orig_page, buf);\n\t\tpbe = pbe->next;\n\t}\n\tfree_image_page(buf, PG_UNSAFE_CLEAR);\n\treturn 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define PG_UNSAFE_CLEAR\t1",
      "#define PG_SAFE\t\t1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_image_page",
          "args": [
            "buf",
            "PG_UNSAFE_CLEAR"
          ],
          "line": 2758
        },
        "resolved": true,
        "details": {
          "function_name": "free_image_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "253-266",
          "snippet": "static inline void free_image_page(void *addr, int clear_nosave_free)\n{\n\tstruct page *page;\n\n\tBUG_ON(!virt_addr_valid(addr));\n\n\tpage = virt_to_page(addr);\n\n\tswsusp_unset_page_forbidden(page);\n\tif (clear_nosave_free)\n\t\tswsusp_unset_page_free(page);\n\n\t__free_page(page);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);",
            "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);\n\nstatic inline void free_image_page(void *addr, int clear_nosave_free)\n{\n\tstruct page *page;\n\n\tBUG_ON(!virt_addr_valid(addr));\n\n\tpage = virt_to_page(addr);\n\n\tswsusp_unset_page_forbidden(page);\n\tif (clear_nosave_free)\n\t\tswsusp_unset_page_free(page);\n\n\t__free_page(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "swap_two_pages_data",
          "args": [
            "pbe->copy_page",
            "pbe->orig_page",
            "buf"
          ],
          "line": 2755
        },
        "resolved": true,
        "details": {
          "function_name": "swap_two_pages_data",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2718-2730",
          "snippet": "static inline void swap_two_pages_data(struct page *p1, struct page *p2,\n\t\t\t\t       void *buf)\n{\n\tvoid *kaddr1, *kaddr2;\n\n\tkaddr1 = kmap_atomic(p1);\n\tkaddr2 = kmap_atomic(p2);\n\tcopy_page(buf, kaddr1);\n\tcopy_page(kaddr1, kaddr2);\n\tcopy_page(kaddr2, buf);\n\tkunmap_atomic(kaddr2);\n\tkunmap_atomic(kaddr1);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic inline void swap_two_pages_data(struct page *p1, struct page *p2,\n\t\t\t\t       void *buf)\n{\n\tvoid *kaddr1, *kaddr2;\n\n\tkaddr1 = kmap_atomic(p1);\n\tkaddr2 = kmap_atomic(p2);\n\tcopy_page(buf, kaddr1);\n\tcopy_page(kaddr1, kaddr2);\n\tcopy_page(kaddr2, buf);\n\tkunmap_atomic(kaddr2);\n\tkunmap_atomic(kaddr1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_image_page",
          "args": [
            "GFP_ATOMIC",
            "PG_SAFE"
          ],
          "line": 2750
        },
        "resolved": true,
        "details": {
          "function_name": "get_image_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "189-206",
          "snippet": "static void *get_image_page(gfp_t gfp_mask, int safe_needed)\n{\n\tvoid *res;\n\n\tres = (void *)get_zeroed_page(gfp_mask);\n\tif (safe_needed)\n\t\twhile (res && swsusp_page_is_free(virt_to_page(res))) {\n\t\t\t/* The page is unsafe, mark it for swsusp_free() */\n\t\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\t\tallocated_unsafe_pages++;\n\t\t\tres = (void *)get_zeroed_page(gfp_mask);\n\t\t}\n\tif (res) {\n\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\tswsusp_set_page_free(virt_to_page(res));\n\t}\n\treturn res;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static unsigned int allocated_unsafe_pages;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic unsigned int allocated_unsafe_pages;\n\nstatic void *get_image_page(gfp_t gfp_mask, int safe_needed)\n{\n\tvoid *res;\n\n\tres = (void *)get_zeroed_page(gfp_mask);\n\tif (safe_needed)\n\t\twhile (res && swsusp_page_is_free(virt_to_page(res))) {\n\t\t\t/* The page is unsafe, mark it for swsusp_free() */\n\t\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\t\tallocated_unsafe_pages++;\n\t\t\tres = (void *)get_zeroed_page(gfp_mask);\n\t\t}\n\tif (res) {\n\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\tswsusp_set_page_free(virt_to_page(res));\n\t}\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_UNSAFE_CLEAR\t1\n#define PG_SAFE\t\t1\n\nint restore_highmem(void)\n{\n\tstruct highmem_pbe *pbe = highmem_pblist;\n\tvoid *buf;\n\n\tif (!pbe)\n\t\treturn 0;\n\n\tbuf = get_image_page(GFP_ATOMIC, PG_SAFE);\n\tif (!buf)\n\t\treturn -ENOMEM;\n\n\twhile (pbe) {\n\t\tswap_two_pages_data(pbe->copy_page, pbe->orig_page, buf);\n\t\tpbe = pbe->next;\n\t}\n\tfree_image_page(buf, PG_UNSAFE_CLEAR);\n\treturn 0;\n}"
  },
  {
    "function_name": "swap_two_pages_data",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2718-2730",
    "snippet": "static inline void swap_two_pages_data(struct page *p1, struct page *p2,\n\t\t\t\t       void *buf)\n{\n\tvoid *kaddr1, *kaddr2;\n\n\tkaddr1 = kmap_atomic(p1);\n\tkaddr2 = kmap_atomic(p2);\n\tcopy_page(buf, kaddr1);\n\tcopy_page(kaddr1, kaddr2);\n\tcopy_page(kaddr2, buf);\n\tkunmap_atomic(kaddr2);\n\tkunmap_atomic(kaddr1);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "kaddr1"
          ],
          "line": 2729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "kaddr2"
          ],
          "line": 2728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_page",
          "args": [
            "kaddr2",
            "buf"
          ],
          "line": 2727
        },
        "resolved": true,
        "details": {
          "function_name": "safe_copy_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1395-1404",
          "snippet": "static void safe_copy_page(void *dst, struct page *s_page)\n{\n\tif (kernel_page_present(s_page)) {\n\t\tdo_copy_page(dst, page_address(s_page));\n\t} else {\n\t\thibernate_map_page(s_page);\n\t\tdo_copy_page(dst, page_address(s_page));\n\t\thibernate_unmap_page(s_page);\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic void safe_copy_page(void *dst, struct page *s_page)\n{\n\tif (kernel_page_present(s_page)) {\n\t\tdo_copy_page(dst, page_address(s_page));\n\t} else {\n\t\thibernate_map_page(s_page);\n\t\tdo_copy_page(dst, page_address(s_page));\n\t\thibernate_unmap_page(s_page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "p2"
          ],
          "line": 2724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "p1"
          ],
          "line": 2723
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic inline void swap_two_pages_data(struct page *p1, struct page *p2,\n\t\t\t\t       void *buf)\n{\n\tvoid *kaddr1, *kaddr2;\n\n\tkaddr1 = kmap_atomic(p1);\n\tkaddr2 = kmap_atomic(p2);\n\tcopy_page(buf, kaddr1);\n\tcopy_page(kaddr1, kaddr2);\n\tcopy_page(kaddr2, buf);\n\tkunmap_atomic(kaddr2);\n\tkunmap_atomic(kaddr1);\n}"
  },
  {
    "function_name": "snapshot_image_loaded",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2710-2714",
    "snippet": "int snapshot_image_loaded(struct snapshot_handle *handle)\n{\n\treturn !(!nr_copy_pages || !last_highmem_page_copied() ||\n\t\t\thandle->cur <= nr_meta_pages + nr_copy_pages);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int nr_copy_pages;",
      "static unsigned int nr_meta_pages;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "last_highmem_page_copied",
          "args": [],
          "line": 2712
        },
        "resolved": true,
        "details": {
          "function_name": "last_highmem_page_copied",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2478-2478",
          "snippet": "static inline int last_highmem_page_copied(void) { return 1; }",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline int last_highmem_page_copied(void) { return 1; }"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int nr_copy_pages;\nstatic unsigned int nr_meta_pages;\n\nint snapshot_image_loaded(struct snapshot_handle *handle)\n{\n\treturn !(!nr_copy_pages || !last_highmem_page_copied() ||\n\t\t\thandle->cur <= nr_meta_pages + nr_copy_pages);\n}"
  },
  {
    "function_name": "snapshot_write_finalize",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2699-2708",
    "snippet": "void snapshot_write_finalize(struct snapshot_handle *handle)\n{\n\tcopy_last_highmem_page();\n\thibernate_restore_protect_page(handle->buffer);\n\t/* Do that only if we have loaded the image entirely */\n\tif (handle->cur > 1 && handle->cur > nr_meta_pages + nr_copy_pages) {\n\t\tmemory_bm_recycle(&orig_bm);\n\t\tfree_highmem_data();\n\t}\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void *buffer;",
      "static unsigned int nr_copy_pages;",
      "static unsigned int nr_meta_pages;",
      "static struct memory_bitmap orig_bm;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_highmem_data",
          "args": [],
          "line": 2706
        },
        "resolved": true,
        "details": {
          "function_name": "free_highmem_data",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2479-2479",
          "snippet": "static inline void free_highmem_data(void) {}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void free_highmem_data(void) {}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_recycle",
          "args": [
            "&orig_bm"
          ],
          "line": 2705
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_recycle",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "958-973",
          "snippet": "static void memory_bm_recycle(struct memory_bitmap *bm)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\tstruct linked_page *p_list;\n\n\tlist_for_each_entry(zone, &bm->zones, list)\n\t\trecycle_zone_bm_rtree(zone);\n\n\tp_list = bm->p_list;\n\twhile (p_list) {\n\t\tstruct linked_page *lp = p_list;\n\n\t\tp_list = lp->next;\n\t\trecycle_safe_page(lp);\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_recycle(struct memory_bitmap *bm)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\tstruct linked_page *p_list;\n\n\tlist_for_each_entry(zone, &bm->zones, list)\n\t\trecycle_zone_bm_rtree(zone);\n\n\tp_list = bm->p_list;\n\twhile (p_list) {\n\t\tstruct linked_page *lp = p_list;\n\n\t\tp_list = lp->next;\n\t\trecycle_safe_page(lp);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "hibernate_restore_protect_page",
          "args": [
            "handle->buffer"
          ],
          "line": 2702
        },
        "resolved": true,
        "details": {
          "function_name": "hibernate_restore_protect_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "75-75",
          "snippet": "static inline void hibernate_restore_protect_page(void *page_address) {}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void hibernate_restore_protect_page(void *page_address) {}"
        }
      },
      {
        "call_info": {
          "callee": "copy_last_highmem_page",
          "args": [],
          "line": 2701
        },
        "resolved": true,
        "details": {
          "function_name": "copy_last_highmem_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2477-2477",
          "snippet": "static inline void copy_last_highmem_page(void) {}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void copy_last_highmem_page(void) {}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void *buffer;\nstatic unsigned int nr_copy_pages;\nstatic unsigned int nr_meta_pages;\nstatic struct memory_bitmap orig_bm;\n\nvoid snapshot_write_finalize(struct snapshot_handle *handle)\n{\n\tcopy_last_highmem_page();\n\thibernate_restore_protect_page(handle->buffer);\n\t/* Do that only if we have loaded the image entirely */\n\tif (handle->cur > 1 && handle->cur > nr_meta_pages + nr_copy_pages) {\n\t\tmemory_bm_recycle(&orig_bm);\n\t\tfree_highmem_data();\n\t}\n}"
  },
  {
    "function_name": "snapshot_write_next",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2628-2689",
    "snippet": "int snapshot_write_next(struct snapshot_handle *handle)\n{\n\tstatic struct chain_allocator ca;\n\tint error = 0;\n\n\t/* Check if we have already loaded the entire image */\n\tif (handle->cur > 1 && handle->cur > nr_meta_pages + nr_copy_pages)\n\t\treturn 0;\n\n\thandle->sync_read = 1;\n\n\tif (!handle->cur) {\n\t\tif (!buffer)\n\t\t\t/* This makes the buffer be freed by swsusp_free() */\n\t\t\tbuffer = get_image_page(GFP_ATOMIC, PG_ANY);\n\n\t\tif (!buffer)\n\t\t\treturn -ENOMEM;\n\n\t\thandle->buffer = buffer;\n\t} else if (handle->cur == 1) {\n\t\terror = load_header(buffer);\n\t\tif (error)\n\t\t\treturn error;\n\n\t\tsafe_pages_list = NULL;\n\n\t\terror = memory_bm_create(&copy_bm, GFP_ATOMIC, PG_ANY);\n\t\tif (error)\n\t\t\treturn error;\n\n\t\thibernate_restore_protection_begin();\n\t} else if (handle->cur <= nr_meta_pages + 1) {\n\t\terror = unpack_orig_pfns(buffer, &copy_bm);\n\t\tif (error)\n\t\t\treturn error;\n\n\t\tif (handle->cur == nr_meta_pages + 1) {\n\t\t\terror = prepare_image(&orig_bm, &copy_bm);\n\t\t\tif (error)\n\t\t\t\treturn error;\n\n\t\t\tchain_init(&ca, GFP_ATOMIC, PG_SAFE);\n\t\t\tmemory_bm_position_reset(&orig_bm);\n\t\t\trestore_pblist = NULL;\n\t\t\thandle->buffer = get_buffer(&orig_bm, &ca);\n\t\t\thandle->sync_read = 0;\n\t\t\tif (IS_ERR(handle->buffer))\n\t\t\t\treturn PTR_ERR(handle->buffer);\n\t\t}\n\t} else {\n\t\tcopy_last_highmem_page();\n\t\thibernate_restore_protect_page(handle->buffer);\n\t\thandle->buffer = get_buffer(&orig_bm, &ca);\n\t\tif (IS_ERR(handle->buffer))\n\t\t\treturn PTR_ERR(handle->buffer);\n\t\tif (handle->buffer != buffer)\n\t\t\thandle->sync_read = 0;\n\t}\n\thandle->cur++;\n\treturn PAGE_SIZE;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define PG_SAFE\t\t1",
      "#define PG_ANY\t\t0"
    ],
    "globals_used": [
      "struct pbe *restore_pblist;",
      "static struct linked_page *safe_pages_list;",
      "static void *buffer;",
      "static unsigned int nr_copy_pages;",
      "static unsigned int nr_meta_pages;",
      "static struct memory_bitmap orig_bm;",
      "static struct memory_bitmap copy_bm;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "handle->buffer"
          ],
          "line": 2683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "handle->buffer"
          ],
          "line": 2682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_buffer",
          "args": [
            "&orig_bm",
            "&ca"
          ],
          "line": 2681
        },
        "resolved": true,
        "details": {
          "function_name": "get_buffer",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2575-2610",
          "snippet": "static void *get_buffer(struct memory_bitmap *bm, struct chain_allocator *ca)\n{\n\tstruct pbe *pbe;\n\tstruct page *page;\n\tunsigned long pfn = memory_bm_next_pfn(bm);\n\n\tif (pfn == BM_END_OF_MAP)\n\t\treturn ERR_PTR(-EFAULT);\n\n\tpage = pfn_to_page(pfn);\n\tif (PageHighMem(page))\n\t\treturn get_highmem_page_buffer(page, ca);\n\n\tif (swsusp_page_is_forbidden(page) && swsusp_page_is_free(page))\n\t\t/*\n\t\t * We have allocated the \"original\" page frame and we can\n\t\t * use it directly to store the loaded page.\n\t\t */\n\t\treturn page_address(page);\n\n\t/*\n\t * The \"original\" page frame has not been allocated and we have to\n\t * use a \"safe\" page frame to store the loaded page.\n\t */\n\tpbe = chain_alloc(ca, sizeof(struct pbe));\n\tif (!pbe) {\n\t\tswsusp_free();\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\tpbe->orig_address = page_address(page);\n\tpbe->address = safe_pages_list;\n\tsafe_pages_list = safe_pages_list->next;\n\tpbe->next = restore_pblist;\n\trestore_pblist = pbe;\n\treturn pbe->address;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "struct pbe *restore_pblist;",
            "static struct linked_page *safe_pages_list;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstruct pbe *restore_pblist;\nstatic struct linked_page *safe_pages_list;\n\nstatic void *get_buffer(struct memory_bitmap *bm, struct chain_allocator *ca)\n{\n\tstruct pbe *pbe;\n\tstruct page *page;\n\tunsigned long pfn = memory_bm_next_pfn(bm);\n\n\tif (pfn == BM_END_OF_MAP)\n\t\treturn ERR_PTR(-EFAULT);\n\n\tpage = pfn_to_page(pfn);\n\tif (PageHighMem(page))\n\t\treturn get_highmem_page_buffer(page, ca);\n\n\tif (swsusp_page_is_forbidden(page) && swsusp_page_is_free(page))\n\t\t/*\n\t\t * We have allocated the \"original\" page frame and we can\n\t\t * use it directly to store the loaded page.\n\t\t */\n\t\treturn page_address(page);\n\n\t/*\n\t * The \"original\" page frame has not been allocated and we have to\n\t * use a \"safe\" page frame to store the loaded page.\n\t */\n\tpbe = chain_alloc(ca, sizeof(struct pbe));\n\tif (!pbe) {\n\t\tswsusp_free();\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\tpbe->orig_address = page_address(page);\n\tpbe->address = safe_pages_list;\n\tsafe_pages_list = safe_pages_list->next;\n\tpbe->next = restore_pblist;\n\trestore_pblist = pbe;\n\treturn pbe->address;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hibernate_restore_protect_page",
          "args": [
            "handle->buffer"
          ],
          "line": 2680
        },
        "resolved": true,
        "details": {
          "function_name": "hibernate_restore_protect_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "75-75",
          "snippet": "static inline void hibernate_restore_protect_page(void *page_address) {}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void hibernate_restore_protect_page(void *page_address) {}"
        }
      },
      {
        "call_info": {
          "callee": "copy_last_highmem_page",
          "args": [],
          "line": 2679
        },
        "resolved": true,
        "details": {
          "function_name": "copy_last_highmem_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2477-2477",
          "snippet": "static inline void copy_last_highmem_page(void) {}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void copy_last_highmem_page(void) {}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "handle->buffer"
          ],
          "line": 2676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "handle->buffer"
          ],
          "line": 2675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_bm_position_reset",
          "args": [
            "&orig_bm"
          ],
          "line": 2671
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_position_reset",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "581-589",
          "snippet": "static void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "chain_init",
          "args": [
            "&ca",
            "GFP_ATOMIC",
            "PG_SAFE"
          ],
          "line": 2670
        },
        "resolved": true,
        "details": {
          "function_name": "chain_init",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "299-306",
          "snippet": "static void chain_init(struct chain_allocator *ca, gfp_t gfp_mask,\n\t\t       int safe_needed)\n{\n\tca->chain = NULL;\n\tca->used_space = LINKED_PAGE_DATA_SIZE;\n\tca->gfp_mask = gfp_mask;\n\tca->safe_needed = safe_needed;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))\n\nstatic void chain_init(struct chain_allocator *ca, gfp_t gfp_mask,\n\t\t       int safe_needed)\n{\n\tca->chain = NULL;\n\tca->used_space = LINKED_PAGE_DATA_SIZE;\n\tca->gfp_mask = gfp_mask;\n\tca->safe_needed = safe_needed;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prepare_image",
          "args": [
            "&orig_bm",
            "&copy_bm"
          ],
          "line": 2666
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_image",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2499-2567",
          "snippet": "static int prepare_image(struct memory_bitmap *new_bm, struct memory_bitmap *bm)\n{\n\tunsigned int nr_pages, nr_highmem;\n\tstruct linked_page *lp;\n\tint error;\n\n\t/* If there is no highmem, the buffer will not be necessary */\n\tfree_image_page(buffer, PG_UNSAFE_CLEAR);\n\tbuffer = NULL;\n\n\tnr_highmem = count_highmem_image_pages(bm);\n\tmark_unsafe_pages(bm);\n\n\terror = memory_bm_create(new_bm, GFP_ATOMIC, PG_SAFE);\n\tif (error)\n\t\tgoto Free;\n\n\tduplicate_memory_bitmap(new_bm, bm);\n\tmemory_bm_free(bm, PG_UNSAFE_KEEP);\n\tif (nr_highmem > 0) {\n\t\terror = prepare_highmem_image(bm, &nr_highmem);\n\t\tif (error)\n\t\t\tgoto Free;\n\t}\n\t/*\n\t * Reserve some safe pages for potential later use.\n\t *\n\t * NOTE: This way we make sure there will be enough safe pages for the\n\t * chain_alloc() in get_buffer().  It is a bit wasteful, but\n\t * nr_copy_pages cannot be greater than 50% of the memory anyway.\n\t *\n\t * nr_copy_pages cannot be less than allocated_unsafe_pages too.\n\t */\n\tnr_pages = nr_copy_pages - nr_highmem - allocated_unsafe_pages;\n\tnr_pages = DIV_ROUND_UP(nr_pages, PBES_PER_LINKED_PAGE);\n\twhile (nr_pages > 0) {\n\t\tlp = get_image_page(GFP_ATOMIC, PG_SAFE);\n\t\tif (!lp) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Free;\n\t\t}\n\t\tlp->next = safe_pages_list;\n\t\tsafe_pages_list = lp;\n\t\tnr_pages--;\n\t}\n\t/* Preallocate memory for the image */\n\tnr_pages = nr_copy_pages - nr_highmem - allocated_unsafe_pages;\n\twhile (nr_pages > 0) {\n\t\tlp = (struct linked_page *)get_zeroed_page(GFP_ATOMIC);\n\t\tif (!lp) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Free;\n\t\t}\n\t\tif (!swsusp_page_is_free(virt_to_page(lp))) {\n\t\t\t/* The page is \"safe\", add it to the list */\n\t\t\tlp->next = safe_pages_list;\n\t\t\tsafe_pages_list = lp;\n\t\t}\n\t\t/* Mark the page as allocated */\n\t\tswsusp_set_page_forbidden(virt_to_page(lp));\n\t\tswsusp_set_page_free(virt_to_page(lp));\n\t\tnr_pages--;\n\t}\n\treturn 0;\n\n Free:\n\tswsusp_free();\n\treturn error;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define PBES_PER_LINKED_PAGE\t(LINKED_PAGE_DATA_SIZE / sizeof(struct pbe))",
            "#define PG_UNSAFE_KEEP\t0",
            "#define PG_UNSAFE_CLEAR\t1",
            "#define PG_SAFE\t\t1"
          ],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct linked_page *safe_pages_list;",
            "static void *buffer;",
            "static unsigned int allocated_unsafe_pages;",
            "static unsigned int nr_copy_pages;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PBES_PER_LINKED_PAGE\t(LINKED_PAGE_DATA_SIZE / sizeof(struct pbe))\n#define PG_UNSAFE_KEEP\t0\n#define PG_UNSAFE_CLEAR\t1\n#define PG_SAFE\t\t1\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct linked_page *safe_pages_list;\nstatic void *buffer;\nstatic unsigned int allocated_unsafe_pages;\nstatic unsigned int nr_copy_pages;\n\nstatic int prepare_image(struct memory_bitmap *new_bm, struct memory_bitmap *bm)\n{\n\tunsigned int nr_pages, nr_highmem;\n\tstruct linked_page *lp;\n\tint error;\n\n\t/* If there is no highmem, the buffer will not be necessary */\n\tfree_image_page(buffer, PG_UNSAFE_CLEAR);\n\tbuffer = NULL;\n\n\tnr_highmem = count_highmem_image_pages(bm);\n\tmark_unsafe_pages(bm);\n\n\terror = memory_bm_create(new_bm, GFP_ATOMIC, PG_SAFE);\n\tif (error)\n\t\tgoto Free;\n\n\tduplicate_memory_bitmap(new_bm, bm);\n\tmemory_bm_free(bm, PG_UNSAFE_KEEP);\n\tif (nr_highmem > 0) {\n\t\terror = prepare_highmem_image(bm, &nr_highmem);\n\t\tif (error)\n\t\t\tgoto Free;\n\t}\n\t/*\n\t * Reserve some safe pages for potential later use.\n\t *\n\t * NOTE: This way we make sure there will be enough safe pages for the\n\t * chain_alloc() in get_buffer().  It is a bit wasteful, but\n\t * nr_copy_pages cannot be greater than 50% of the memory anyway.\n\t *\n\t * nr_copy_pages cannot be less than allocated_unsafe_pages too.\n\t */\n\tnr_pages = nr_copy_pages - nr_highmem - allocated_unsafe_pages;\n\tnr_pages = DIV_ROUND_UP(nr_pages, PBES_PER_LINKED_PAGE);\n\twhile (nr_pages > 0) {\n\t\tlp = get_image_page(GFP_ATOMIC, PG_SAFE);\n\t\tif (!lp) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Free;\n\t\t}\n\t\tlp->next = safe_pages_list;\n\t\tsafe_pages_list = lp;\n\t\tnr_pages--;\n\t}\n\t/* Preallocate memory for the image */\n\tnr_pages = nr_copy_pages - nr_highmem - allocated_unsafe_pages;\n\twhile (nr_pages > 0) {\n\t\tlp = (struct linked_page *)get_zeroed_page(GFP_ATOMIC);\n\t\tif (!lp) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Free;\n\t\t}\n\t\tif (!swsusp_page_is_free(virt_to_page(lp))) {\n\t\t\t/* The page is \"safe\", add it to the list */\n\t\t\tlp->next = safe_pages_list;\n\t\t\tsafe_pages_list = lp;\n\t\t}\n\t\t/* Mark the page as allocated */\n\t\tswsusp_set_page_forbidden(virt_to_page(lp));\n\t\tswsusp_set_page_free(virt_to_page(lp));\n\t\tnr_pages--;\n\t}\n\treturn 0;\n\n Free:\n\tswsusp_free();\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unpack_orig_pfns",
          "args": [
            "buffer",
            "&copy_bm"
          ],
          "line": 2661
        },
        "resolved": true,
        "details": {
          "function_name": "unpack_orig_pfns",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2257-2272",
          "snippet": "static int unpack_orig_pfns(unsigned long *buf, struct memory_bitmap *bm)\n{\n\tint j;\n\n\tfor (j = 0; j < PAGE_SIZE / sizeof(long); j++) {\n\t\tif (unlikely(buf[j] == BM_END_OF_MAP))\n\t\t\tbreak;\n\n\t\tif (pfn_valid(buf[j]) && memory_bm_pfn_present(bm, buf[j]))\n\t\t\tmemory_bm_set_bit(bm, buf[j]);\n\t\telse\n\t\t\treturn -EFAULT;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic int unpack_orig_pfns(unsigned long *buf, struct memory_bitmap *bm)\n{\n\tint j;\n\n\tfor (j = 0; j < PAGE_SIZE / sizeof(long); j++) {\n\t\tif (unlikely(buf[j] == BM_END_OF_MAP))\n\t\t\tbreak;\n\n\t\tif (pfn_valid(buf[j]) && memory_bm_pfn_present(bm, buf[j]))\n\t\t\tmemory_bm_set_bit(bm, buf[j]);\n\t\telse\n\t\t\treturn -EFAULT;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hibernate_restore_protection_begin",
          "args": [],
          "line": 2659
        },
        "resolved": true,
        "details": {
          "function_name": "hibernate_restore_protection_begin",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "73-73",
          "snippet": "static inline void hibernate_restore_protection_begin(void) {}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void hibernate_restore_protection_begin(void) {}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_create",
          "args": [
            "&copy_bm",
            "GFP_ATOMIC",
            "PG_ANY"
          ],
          "line": 2655
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_create",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "676-713",
          "snippet": "static int memory_bm_create(struct memory_bitmap *bm, gfp_t gfp_mask,\n\t\t\t    int safe_needed)\n{\n\tstruct chain_allocator ca;\n\tstruct list_head mem_extents;\n\tstruct mem_extent *ext;\n\tint error;\n\n\tchain_init(&ca, gfp_mask, safe_needed);\n\tINIT_LIST_HEAD(&bm->zones);\n\n\terror = create_mem_extents(&mem_extents, gfp_mask);\n\tif (error)\n\t\treturn error;\n\n\tlist_for_each_entry(ext, &mem_extents, hook) {\n\t\tstruct mem_zone_bm_rtree *zone;\n\n\t\tzone = create_zone_bm_rtree(gfp_mask, safe_needed, &ca,\n\t\t\t\t\t    ext->start, ext->end);\n\t\tif (!zone) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Error;\n\t\t}\n\t\tlist_add_tail(&zone->list, &bm->zones);\n\t}\n\n\tbm->p_list = ca.chain;\n\tmemory_bm_position_reset(bm);\n Exit:\n\tfree_mem_extents(&mem_extents);\n\treturn error;\n\n Error:\n\tbm->p_list = ca.chain;\n\tmemory_bm_free(bm, PG_UNSAFE_CLEAR);\n\tgoto Exit;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define PG_UNSAFE_CLEAR\t1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_UNSAFE_CLEAR\t1\n\nstatic int memory_bm_create(struct memory_bitmap *bm, gfp_t gfp_mask,\n\t\t\t    int safe_needed)\n{\n\tstruct chain_allocator ca;\n\tstruct list_head mem_extents;\n\tstruct mem_extent *ext;\n\tint error;\n\n\tchain_init(&ca, gfp_mask, safe_needed);\n\tINIT_LIST_HEAD(&bm->zones);\n\n\terror = create_mem_extents(&mem_extents, gfp_mask);\n\tif (error)\n\t\treturn error;\n\n\tlist_for_each_entry(ext, &mem_extents, hook) {\n\t\tstruct mem_zone_bm_rtree *zone;\n\n\t\tzone = create_zone_bm_rtree(gfp_mask, safe_needed, &ca,\n\t\t\t\t\t    ext->start, ext->end);\n\t\tif (!zone) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Error;\n\t\t}\n\t\tlist_add_tail(&zone->list, &bm->zones);\n\t}\n\n\tbm->p_list = ca.chain;\n\tmemory_bm_position_reset(bm);\n Exit:\n\tfree_mem_extents(&mem_extents);\n\treturn error;\n\n Error:\n\tbm->p_list = ca.chain;\n\tmemory_bm_free(bm, PG_UNSAFE_CLEAR);\n\tgoto Exit;\n}"
        }
      },
      {
        "call_info": {
          "callee": "load_header",
          "args": [
            "buffer"
          ],
          "line": 2649
        },
        "resolved": true,
        "details": {
          "function_name": "load_header",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2236-2247",
          "snippet": "static int load_header(struct swsusp_info *info)\n{\n\tint error;\n\n\trestore_pblist = NULL;\n\terror = check_header(info);\n\tif (!error) {\n\t\tnr_copy_pages = info->image_pages;\n\t\tnr_meta_pages = info->pages - info->image_pages - 1;\n\t}\n\treturn error;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct pbe *restore_pblist;",
            "static unsigned int nr_copy_pages;",
            "static unsigned int nr_meta_pages;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstruct pbe *restore_pblist;\nstatic unsigned int nr_copy_pages;\nstatic unsigned int nr_meta_pages;\n\nstatic int load_header(struct swsusp_info *info)\n{\n\tint error;\n\n\trestore_pblist = NULL;\n\terror = check_header(info);\n\tif (!error) {\n\t\tnr_copy_pages = info->image_pages;\n\t\tnr_meta_pages = info->pages - info->image_pages - 1;\n\t}\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_image_page",
          "args": [
            "GFP_ATOMIC",
            "PG_ANY"
          ],
          "line": 2642
        },
        "resolved": true,
        "details": {
          "function_name": "get_image_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "189-206",
          "snippet": "static void *get_image_page(gfp_t gfp_mask, int safe_needed)\n{\n\tvoid *res;\n\n\tres = (void *)get_zeroed_page(gfp_mask);\n\tif (safe_needed)\n\t\twhile (res && swsusp_page_is_free(virt_to_page(res))) {\n\t\t\t/* The page is unsafe, mark it for swsusp_free() */\n\t\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\t\tallocated_unsafe_pages++;\n\t\t\tres = (void *)get_zeroed_page(gfp_mask);\n\t\t}\n\tif (res) {\n\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\tswsusp_set_page_free(virt_to_page(res));\n\t}\n\treturn res;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static unsigned int allocated_unsafe_pages;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic unsigned int allocated_unsafe_pages;\n\nstatic void *get_image_page(gfp_t gfp_mask, int safe_needed)\n{\n\tvoid *res;\n\n\tres = (void *)get_zeroed_page(gfp_mask);\n\tif (safe_needed)\n\t\twhile (res && swsusp_page_is_free(virt_to_page(res))) {\n\t\t\t/* The page is unsafe, mark it for swsusp_free() */\n\t\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\t\tallocated_unsafe_pages++;\n\t\t\tres = (void *)get_zeroed_page(gfp_mask);\n\t\t}\n\tif (res) {\n\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\tswsusp_set_page_free(virt_to_page(res));\n\t}\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_SAFE\t\t1\n#define PG_ANY\t\t0\n\nstruct pbe *restore_pblist;\nstatic struct linked_page *safe_pages_list;\nstatic void *buffer;\nstatic unsigned int nr_copy_pages;\nstatic unsigned int nr_meta_pages;\nstatic struct memory_bitmap orig_bm;\nstatic struct memory_bitmap copy_bm;\n\nint snapshot_write_next(struct snapshot_handle *handle)\n{\n\tstatic struct chain_allocator ca;\n\tint error = 0;\n\n\t/* Check if we have already loaded the entire image */\n\tif (handle->cur > 1 && handle->cur > nr_meta_pages + nr_copy_pages)\n\t\treturn 0;\n\n\thandle->sync_read = 1;\n\n\tif (!handle->cur) {\n\t\tif (!buffer)\n\t\t\t/* This makes the buffer be freed by swsusp_free() */\n\t\t\tbuffer = get_image_page(GFP_ATOMIC, PG_ANY);\n\n\t\tif (!buffer)\n\t\t\treturn -ENOMEM;\n\n\t\thandle->buffer = buffer;\n\t} else if (handle->cur == 1) {\n\t\terror = load_header(buffer);\n\t\tif (error)\n\t\t\treturn error;\n\n\t\tsafe_pages_list = NULL;\n\n\t\terror = memory_bm_create(&copy_bm, GFP_ATOMIC, PG_ANY);\n\t\tif (error)\n\t\t\treturn error;\n\n\t\thibernate_restore_protection_begin();\n\t} else if (handle->cur <= nr_meta_pages + 1) {\n\t\terror = unpack_orig_pfns(buffer, &copy_bm);\n\t\tif (error)\n\t\t\treturn error;\n\n\t\tif (handle->cur == nr_meta_pages + 1) {\n\t\t\terror = prepare_image(&orig_bm, &copy_bm);\n\t\t\tif (error)\n\t\t\t\treturn error;\n\n\t\t\tchain_init(&ca, GFP_ATOMIC, PG_SAFE);\n\t\t\tmemory_bm_position_reset(&orig_bm);\n\t\t\trestore_pblist = NULL;\n\t\t\thandle->buffer = get_buffer(&orig_bm, &ca);\n\t\t\thandle->sync_read = 0;\n\t\t\tif (IS_ERR(handle->buffer))\n\t\t\t\treturn PTR_ERR(handle->buffer);\n\t\t}\n\t} else {\n\t\tcopy_last_highmem_page();\n\t\thibernate_restore_protect_page(handle->buffer);\n\t\thandle->buffer = get_buffer(&orig_bm, &ca);\n\t\tif (IS_ERR(handle->buffer))\n\t\t\treturn PTR_ERR(handle->buffer);\n\t\tif (handle->buffer != buffer)\n\t\t\thandle->sync_read = 0;\n\t}\n\thandle->cur++;\n\treturn PAGE_SIZE;\n}"
  },
  {
    "function_name": "get_buffer",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2575-2610",
    "snippet": "static void *get_buffer(struct memory_bitmap *bm, struct chain_allocator *ca)\n{\n\tstruct pbe *pbe;\n\tstruct page *page;\n\tunsigned long pfn = memory_bm_next_pfn(bm);\n\n\tif (pfn == BM_END_OF_MAP)\n\t\treturn ERR_PTR(-EFAULT);\n\n\tpage = pfn_to_page(pfn);\n\tif (PageHighMem(page))\n\t\treturn get_highmem_page_buffer(page, ca);\n\n\tif (swsusp_page_is_forbidden(page) && swsusp_page_is_free(page))\n\t\t/*\n\t\t * We have allocated the \"original\" page frame and we can\n\t\t * use it directly to store the loaded page.\n\t\t */\n\t\treturn page_address(page);\n\n\t/*\n\t * The \"original\" page frame has not been allocated and we have to\n\t * use a \"safe\" page frame to store the loaded page.\n\t */\n\tpbe = chain_alloc(ca, sizeof(struct pbe));\n\tif (!pbe) {\n\t\tswsusp_free();\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\tpbe->orig_address = page_address(page);\n\tpbe->address = safe_pages_list;\n\tsafe_pages_list = safe_pages_list->next;\n\tpbe->next = restore_pblist;\n\trestore_pblist = pbe;\n\treturn pbe->address;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define BM_END_OF_MAP\t(~0UL)"
    ],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);",
      "struct pbe *restore_pblist;",
      "static struct linked_page *safe_pages_list;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 2604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 2602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swsusp_free",
          "args": [],
          "line": 2601
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1506-1549",
          "snippet": "void swsusp_free(void)\n{\n\tunsigned long fb_pfn, fr_pfn;\n\n\tif (!forbidden_pages_map || !free_pages_map)\n\t\tgoto out;\n\n\tmemory_bm_position_reset(forbidden_pages_map);\n\tmemory_bm_position_reset(free_pages_map);\n\nloop:\n\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\n\t/*\n\t * Find the next bit set in both bitmaps. This is guaranteed to\n\t * terminate when fb_pfn == fr_pfn == BM_END_OF_MAP.\n\t */\n\tdo {\n\t\tif (fb_pfn < fr_pfn)\n\t\t\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\t\tif (fr_pfn < fb_pfn)\n\t\t\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\t} while (fb_pfn != fr_pfn);\n\n\tif (fr_pfn != BM_END_OF_MAP && pfn_valid(fr_pfn)) {\n\t\tstruct page *page = pfn_to_page(fr_pfn);\n\n\t\tmemory_bm_clear_current(forbidden_pages_map);\n\t\tmemory_bm_clear_current(free_pages_map);\n\t\thibernate_restore_unprotect_page(page_address(page));\n\t\t__free_page(page);\n\t\tgoto loop;\n\t}\n\nout:\n\tnr_copy_pages = 0;\n\tnr_meta_pages = 0;\n\trestore_pblist = NULL;\n\tbuffer = NULL;\n\talloc_normal = 0;\n\talloc_highmem = 0;\n\thibernate_restore_protection_end();\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "struct pbe *restore_pblist;",
            "static void *buffer;",
            "static struct memory_bitmap *forbidden_pages_map;",
            "static struct memory_bitmap *free_pages_map;",
            "static unsigned int nr_copy_pages;",
            "static unsigned int nr_meta_pages;",
            "static unsigned int alloc_normal, alloc_highmem;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstruct pbe *restore_pblist;\nstatic void *buffer;\nstatic struct memory_bitmap *forbidden_pages_map;\nstatic struct memory_bitmap *free_pages_map;\nstatic unsigned int nr_copy_pages;\nstatic unsigned int nr_meta_pages;\nstatic unsigned int alloc_normal, alloc_highmem;\n\nvoid swsusp_free(void)\n{\n\tunsigned long fb_pfn, fr_pfn;\n\n\tif (!forbidden_pages_map || !free_pages_map)\n\t\tgoto out;\n\n\tmemory_bm_position_reset(forbidden_pages_map);\n\tmemory_bm_position_reset(free_pages_map);\n\nloop:\n\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\n\t/*\n\t * Find the next bit set in both bitmaps. This is guaranteed to\n\t * terminate when fb_pfn == fr_pfn == BM_END_OF_MAP.\n\t */\n\tdo {\n\t\tif (fb_pfn < fr_pfn)\n\t\t\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\t\tif (fr_pfn < fb_pfn)\n\t\t\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\t} while (fb_pfn != fr_pfn);\n\n\tif (fr_pfn != BM_END_OF_MAP && pfn_valid(fr_pfn)) {\n\t\tstruct page *page = pfn_to_page(fr_pfn);\n\n\t\tmemory_bm_clear_current(forbidden_pages_map);\n\t\tmemory_bm_clear_current(free_pages_map);\n\t\thibernate_restore_unprotect_page(page_address(page));\n\t\t__free_page(page);\n\t\tgoto loop;\n\t}\n\nout:\n\tnr_copy_pages = 0;\n\tnr_meta_pages = 0;\n\trestore_pblist = NULL;\n\tbuffer = NULL;\n\talloc_normal = 0;\n\talloc_highmem = 0;\n\thibernate_restore_protection_end();\n}"
        }
      },
      {
        "call_info": {
          "callee": "chain_alloc",
          "args": [
            "ca",
            "sizeof(struct pbe)"
          ],
          "line": 2599
        },
        "resolved": true,
        "details": {
          "function_name": "chain_alloc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "308-327",
          "snippet": "static void *chain_alloc(struct chain_allocator *ca, unsigned int size)\n{\n\tvoid *ret;\n\n\tif (LINKED_PAGE_DATA_SIZE - ca->used_space < size) {\n\t\tstruct linked_page *lp;\n\n\t\tlp = ca->safe_needed ? __get_safe_page(ca->gfp_mask) :\n\t\t\t\t\tget_image_page(ca->gfp_mask, PG_ANY);\n\t\tif (!lp)\n\t\t\treturn NULL;\n\n\t\tlp->next = ca->chain;\n\t\tca->chain = lp;\n\t\tca->used_space = 0;\n\t}\n\tret = ca->chain->data + ca->used_space;\n\tca->used_space += size;\n\treturn ret;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define PG_ANY\t\t0",
            "#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_ANY\t\t0\n#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic void *chain_alloc(struct chain_allocator *ca, unsigned int size)\n{\n\tvoid *ret;\n\n\tif (LINKED_PAGE_DATA_SIZE - ca->used_space < size) {\n\t\tstruct linked_page *lp;\n\n\t\tlp = ca->safe_needed ? __get_safe_page(ca->gfp_mask) :\n\t\t\t\t\tget_image_page(ca->gfp_mask, PG_ANY);\n\t\tif (!lp)\n\t\t\treturn NULL;\n\n\t\tlp->next = ca->chain;\n\t\tca->chain = lp;\n\t\tca->used_space = 0;\n\t}\n\tret = ca->chain->data + ca->used_space;\n\tca->used_space += size;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 2593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swsusp_page_is_free",
          "args": [
            "page"
          ],
          "line": 2588
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_page_is_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1039-1043",
          "snippet": "static int swsusp_page_is_free(struct page *page)\n{\n\treturn free_pages_map ?\n\t\tmemory_bm_test_bit(free_pages_map, page_to_pfn(page)) : 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *free_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *free_pages_map;\n\nstatic int swsusp_page_is_free(struct page *page)\n{\n\treturn free_pages_map ?\n\t\tmemory_bm_test_bit(free_pages_map, page_to_pfn(page)) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "swsusp_page_is_forbidden",
          "args": [
            "page"
          ],
          "line": 2588
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_page_is_forbidden",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1057-1061",
          "snippet": "int swsusp_page_is_forbidden(struct page *page)\n{\n\treturn forbidden_pages_map ?\n\t\tmemory_bm_test_bit(forbidden_pages_map, page_to_pfn(page)) : 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *forbidden_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *forbidden_pages_map;\n\nint swsusp_page_is_forbidden(struct page *page)\n{\n\treturn forbidden_pages_map ?\n\t\tmemory_bm_test_bit(forbidden_pages_map, page_to_pfn(page)) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_highmem_page_buffer",
          "args": [
            "page",
            "ca"
          ],
          "line": 2586
        },
        "resolved": true,
        "details": {
          "function_name": "get_highmem_page_buffer",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2471-2475",
          "snippet": "static inline void *get_highmem_page_buffer(struct page *page,\n\t\t\t\t\t    struct chain_allocator *ca)\n{\n\treturn ERR_PTR(-EINVAL);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic inline void *get_highmem_page_buffer(struct page *page,\n\t\t\t\t\t    struct chain_allocator *ca)\n{\n\treturn ERR_PTR(-EINVAL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PageHighMem",
          "args": [
            "page"
          ],
          "line": 2585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfn_to_page",
          "args": [
            "pfn"
          ],
          "line": 2584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EFAULT"
          ],
          "line": 2582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_bm_next_pfn",
          "args": [
            "bm"
          ],
          "line": 2579
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_next_pfn",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "915-933",
          "snippet": "static unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)",
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)\n#define BM_END_OF_MAP\t(~0UL)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstruct pbe *restore_pblist;\nstatic struct linked_page *safe_pages_list;\n\nstatic void *get_buffer(struct memory_bitmap *bm, struct chain_allocator *ca)\n{\n\tstruct pbe *pbe;\n\tstruct page *page;\n\tunsigned long pfn = memory_bm_next_pfn(bm);\n\n\tif (pfn == BM_END_OF_MAP)\n\t\treturn ERR_PTR(-EFAULT);\n\n\tpage = pfn_to_page(pfn);\n\tif (PageHighMem(page))\n\t\treturn get_highmem_page_buffer(page, ca);\n\n\tif (swsusp_page_is_forbidden(page) && swsusp_page_is_free(page))\n\t\t/*\n\t\t * We have allocated the \"original\" page frame and we can\n\t\t * use it directly to store the loaded page.\n\t\t */\n\t\treturn page_address(page);\n\n\t/*\n\t * The \"original\" page frame has not been allocated and we have to\n\t * use a \"safe\" page frame to store the loaded page.\n\t */\n\tpbe = chain_alloc(ca, sizeof(struct pbe));\n\tif (!pbe) {\n\t\tswsusp_free();\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\tpbe->orig_address = page_address(page);\n\tpbe->address = safe_pages_list;\n\tsafe_pages_list = safe_pages_list->next;\n\tpbe->next = restore_pblist;\n\trestore_pblist = pbe;\n\treturn pbe->address;\n}"
  },
  {
    "function_name": "prepare_image",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2499-2567",
    "snippet": "static int prepare_image(struct memory_bitmap *new_bm, struct memory_bitmap *bm)\n{\n\tunsigned int nr_pages, nr_highmem;\n\tstruct linked_page *lp;\n\tint error;\n\n\t/* If there is no highmem, the buffer will not be necessary */\n\tfree_image_page(buffer, PG_UNSAFE_CLEAR);\n\tbuffer = NULL;\n\n\tnr_highmem = count_highmem_image_pages(bm);\n\tmark_unsafe_pages(bm);\n\n\terror = memory_bm_create(new_bm, GFP_ATOMIC, PG_SAFE);\n\tif (error)\n\t\tgoto Free;\n\n\tduplicate_memory_bitmap(new_bm, bm);\n\tmemory_bm_free(bm, PG_UNSAFE_KEEP);\n\tif (nr_highmem > 0) {\n\t\terror = prepare_highmem_image(bm, &nr_highmem);\n\t\tif (error)\n\t\t\tgoto Free;\n\t}\n\t/*\n\t * Reserve some safe pages for potential later use.\n\t *\n\t * NOTE: This way we make sure there will be enough safe pages for the\n\t * chain_alloc() in get_buffer().  It is a bit wasteful, but\n\t * nr_copy_pages cannot be greater than 50% of the memory anyway.\n\t *\n\t * nr_copy_pages cannot be less than allocated_unsafe_pages too.\n\t */\n\tnr_pages = nr_copy_pages - nr_highmem - allocated_unsafe_pages;\n\tnr_pages = DIV_ROUND_UP(nr_pages, PBES_PER_LINKED_PAGE);\n\twhile (nr_pages > 0) {\n\t\tlp = get_image_page(GFP_ATOMIC, PG_SAFE);\n\t\tif (!lp) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Free;\n\t\t}\n\t\tlp->next = safe_pages_list;\n\t\tsafe_pages_list = lp;\n\t\tnr_pages--;\n\t}\n\t/* Preallocate memory for the image */\n\tnr_pages = nr_copy_pages - nr_highmem - allocated_unsafe_pages;\n\twhile (nr_pages > 0) {\n\t\tlp = (struct linked_page *)get_zeroed_page(GFP_ATOMIC);\n\t\tif (!lp) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Free;\n\t\t}\n\t\tif (!swsusp_page_is_free(virt_to_page(lp))) {\n\t\t\t/* The page is \"safe\", add it to the list */\n\t\t\tlp->next = safe_pages_list;\n\t\t\tsafe_pages_list = lp;\n\t\t}\n\t\t/* Mark the page as allocated */\n\t\tswsusp_set_page_forbidden(virt_to_page(lp));\n\t\tswsusp_set_page_free(virt_to_page(lp));\n\t\tnr_pages--;\n\t}\n\treturn 0;\n\n Free:\n\tswsusp_free();\n\treturn error;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define PBES_PER_LINKED_PAGE\t(LINKED_PAGE_DATA_SIZE / sizeof(struct pbe))",
      "#define PG_UNSAFE_KEEP\t0",
      "#define PG_UNSAFE_CLEAR\t1",
      "#define PG_SAFE\t\t1"
    ],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);",
      "static struct linked_page *safe_pages_list;",
      "static void *buffer;",
      "static unsigned int allocated_unsafe_pages;",
      "static unsigned int nr_copy_pages;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "swsusp_free",
          "args": [],
          "line": 2565
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1506-1549",
          "snippet": "void swsusp_free(void)\n{\n\tunsigned long fb_pfn, fr_pfn;\n\n\tif (!forbidden_pages_map || !free_pages_map)\n\t\tgoto out;\n\n\tmemory_bm_position_reset(forbidden_pages_map);\n\tmemory_bm_position_reset(free_pages_map);\n\nloop:\n\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\n\t/*\n\t * Find the next bit set in both bitmaps. This is guaranteed to\n\t * terminate when fb_pfn == fr_pfn == BM_END_OF_MAP.\n\t */\n\tdo {\n\t\tif (fb_pfn < fr_pfn)\n\t\t\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\t\tif (fr_pfn < fb_pfn)\n\t\t\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\t} while (fb_pfn != fr_pfn);\n\n\tif (fr_pfn != BM_END_OF_MAP && pfn_valid(fr_pfn)) {\n\t\tstruct page *page = pfn_to_page(fr_pfn);\n\n\t\tmemory_bm_clear_current(forbidden_pages_map);\n\t\tmemory_bm_clear_current(free_pages_map);\n\t\thibernate_restore_unprotect_page(page_address(page));\n\t\t__free_page(page);\n\t\tgoto loop;\n\t}\n\nout:\n\tnr_copy_pages = 0;\n\tnr_meta_pages = 0;\n\trestore_pblist = NULL;\n\tbuffer = NULL;\n\talloc_normal = 0;\n\talloc_highmem = 0;\n\thibernate_restore_protection_end();\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "struct pbe *restore_pblist;",
            "static void *buffer;",
            "static struct memory_bitmap *forbidden_pages_map;",
            "static struct memory_bitmap *free_pages_map;",
            "static unsigned int nr_copy_pages;",
            "static unsigned int nr_meta_pages;",
            "static unsigned int alloc_normal, alloc_highmem;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstruct pbe *restore_pblist;\nstatic void *buffer;\nstatic struct memory_bitmap *forbidden_pages_map;\nstatic struct memory_bitmap *free_pages_map;\nstatic unsigned int nr_copy_pages;\nstatic unsigned int nr_meta_pages;\nstatic unsigned int alloc_normal, alloc_highmem;\n\nvoid swsusp_free(void)\n{\n\tunsigned long fb_pfn, fr_pfn;\n\n\tif (!forbidden_pages_map || !free_pages_map)\n\t\tgoto out;\n\n\tmemory_bm_position_reset(forbidden_pages_map);\n\tmemory_bm_position_reset(free_pages_map);\n\nloop:\n\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\n\t/*\n\t * Find the next bit set in both bitmaps. This is guaranteed to\n\t * terminate when fb_pfn == fr_pfn == BM_END_OF_MAP.\n\t */\n\tdo {\n\t\tif (fb_pfn < fr_pfn)\n\t\t\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\t\tif (fr_pfn < fb_pfn)\n\t\t\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\t} while (fb_pfn != fr_pfn);\n\n\tif (fr_pfn != BM_END_OF_MAP && pfn_valid(fr_pfn)) {\n\t\tstruct page *page = pfn_to_page(fr_pfn);\n\n\t\tmemory_bm_clear_current(forbidden_pages_map);\n\t\tmemory_bm_clear_current(free_pages_map);\n\t\thibernate_restore_unprotect_page(page_address(page));\n\t\t__free_page(page);\n\t\tgoto loop;\n\t}\n\nout:\n\tnr_copy_pages = 0;\n\tnr_meta_pages = 0;\n\trestore_pblist = NULL;\n\tbuffer = NULL;\n\talloc_normal = 0;\n\talloc_highmem = 0;\n\thibernate_restore_protection_end();\n}"
        }
      },
      {
        "call_info": {
          "callee": "swsusp_set_page_free",
          "args": [
            "virt_to_page(lp)"
          ],
          "line": 2559
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_set_page_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1033-1037",
          "snippet": "void swsusp_set_page_free(struct page *page)\n{\n\tif (free_pages_map)\n\t\tmemory_bm_set_bit(free_pages_map, page_to_pfn(page));\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *free_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *free_pages_map;\n\nvoid swsusp_set_page_free(struct page *page)\n{\n\tif (free_pages_map)\n\t\tmemory_bm_set_bit(free_pages_map, page_to_pfn(page));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virt_to_page",
          "args": [
            "lp"
          ],
          "line": 2559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swsusp_set_page_forbidden",
          "args": [
            "virt_to_page(lp)"
          ],
          "line": 2558
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_set_page_forbidden",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1051-1055",
          "snippet": "static void swsusp_set_page_forbidden(struct page *page)\n{\n\tif (forbidden_pages_map)\n\t\tmemory_bm_set_bit(forbidden_pages_map, page_to_pfn(page));\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *forbidden_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *forbidden_pages_map;\n\nstatic void swsusp_set_page_forbidden(struct page *page)\n{\n\tif (forbidden_pages_map)\n\t\tmemory_bm_set_bit(forbidden_pages_map, page_to_pfn(page));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virt_to_page",
          "args": [
            "lp"
          ],
          "line": 2558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swsusp_page_is_free",
          "args": [
            "virt_to_page(lp)"
          ],
          "line": 2552
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_page_is_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1039-1043",
          "snippet": "static int swsusp_page_is_free(struct page *page)\n{\n\treturn free_pages_map ?\n\t\tmemory_bm_test_bit(free_pages_map, page_to_pfn(page)) : 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *free_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *free_pages_map;\n\nstatic int swsusp_page_is_free(struct page *page)\n{\n\treturn free_pages_map ?\n\t\tmemory_bm_test_bit(free_pages_map, page_to_pfn(page)) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virt_to_page",
          "args": [
            "lp"
          ],
          "line": 2552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_zeroed_page",
          "args": [
            "GFP_ATOMIC"
          ],
          "line": 2547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_image_page",
          "args": [
            "GFP_ATOMIC",
            "PG_SAFE"
          ],
          "line": 2535
        },
        "resolved": true,
        "details": {
          "function_name": "get_image_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "189-206",
          "snippet": "static void *get_image_page(gfp_t gfp_mask, int safe_needed)\n{\n\tvoid *res;\n\n\tres = (void *)get_zeroed_page(gfp_mask);\n\tif (safe_needed)\n\t\twhile (res && swsusp_page_is_free(virt_to_page(res))) {\n\t\t\t/* The page is unsafe, mark it for swsusp_free() */\n\t\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\t\tallocated_unsafe_pages++;\n\t\t\tres = (void *)get_zeroed_page(gfp_mask);\n\t\t}\n\tif (res) {\n\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\tswsusp_set_page_free(virt_to_page(res));\n\t}\n\treturn res;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static unsigned int allocated_unsafe_pages;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic unsigned int allocated_unsafe_pages;\n\nstatic void *get_image_page(gfp_t gfp_mask, int safe_needed)\n{\n\tvoid *res;\n\n\tres = (void *)get_zeroed_page(gfp_mask);\n\tif (safe_needed)\n\t\twhile (res && swsusp_page_is_free(virt_to_page(res))) {\n\t\t\t/* The page is unsafe, mark it for swsusp_free() */\n\t\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\t\tallocated_unsafe_pages++;\n\t\t\tres = (void *)get_zeroed_page(gfp_mask);\n\t\t}\n\tif (res) {\n\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\tswsusp_set_page_free(virt_to_page(res));\n\t}\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "nr_pages",
            "PBES_PER_LINKED_PAGE"
          ],
          "line": 2533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_highmem_image",
          "args": [
            "bm",
            "&nr_highmem"
          ],
          "line": 2519
        },
        "resolved": true,
        "details": {
          "function_name": "prepare_highmem_image",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2468-2469",
          "snippet": "static inline int prepare_highmem_image(struct memory_bitmap *bm,\n\t\t\t\t\tunsigned int *nr_highmem_p) { return 0; }",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline int prepare_highmem_image(struct memory_bitmap *bm,\n\t\t\t\t\tunsigned int *nr_highmem_p) { return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_free",
          "args": [
            "bm",
            "PG_UNSAFE_KEEP"
          ],
          "line": 2517
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "719-729",
          "snippet": "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\n\tlist_for_each_entry(zone, &bm->zones, list)\n\t\tfree_zone_bm_rtree(zone, clear_nosave_free);\n\n\tfree_list_of_pages(bm->p_list, clear_nosave_free);\n\n\tINIT_LIST_HEAD(&bm->zones);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);",
            "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);\n\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\n\tlist_for_each_entry(zone, &bm->zones, list)\n\t\tfree_zone_bm_rtree(zone, clear_nosave_free);\n\n\tfree_list_of_pages(bm->p_list, clear_nosave_free);\n\n\tINIT_LIST_HEAD(&bm->zones);\n}"
        }
      },
      {
        "call_info": {
          "callee": "duplicate_memory_bitmap",
          "args": [
            "new_bm",
            "bm"
          ],
          "line": 2516
        },
        "resolved": true,
        "details": {
          "function_name": "duplicate_memory_bitmap",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2182-2193",
          "snippet": "static void duplicate_memory_bitmap(struct memory_bitmap *dst,\n\t\t\t\t    struct memory_bitmap *src)\n{\n\tunsigned long pfn;\n\n\tmemory_bm_position_reset(src);\n\tpfn = memory_bm_next_pfn(src);\n\twhile (pfn != BM_END_OF_MAP) {\n\t\tmemory_bm_set_bit(dst, pfn);\n\t\tpfn = memory_bm_next_pfn(src);\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic void duplicate_memory_bitmap(struct memory_bitmap *dst,\n\t\t\t\t    struct memory_bitmap *src)\n{\n\tunsigned long pfn;\n\n\tmemory_bm_position_reset(src);\n\tpfn = memory_bm_next_pfn(src);\n\twhile (pfn != BM_END_OF_MAP) {\n\t\tmemory_bm_set_bit(dst, pfn);\n\t\tpfn = memory_bm_next_pfn(src);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_create",
          "args": [
            "new_bm",
            "GFP_ATOMIC",
            "PG_SAFE"
          ],
          "line": 2512
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_create",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "676-713",
          "snippet": "static int memory_bm_create(struct memory_bitmap *bm, gfp_t gfp_mask,\n\t\t\t    int safe_needed)\n{\n\tstruct chain_allocator ca;\n\tstruct list_head mem_extents;\n\tstruct mem_extent *ext;\n\tint error;\n\n\tchain_init(&ca, gfp_mask, safe_needed);\n\tINIT_LIST_HEAD(&bm->zones);\n\n\terror = create_mem_extents(&mem_extents, gfp_mask);\n\tif (error)\n\t\treturn error;\n\n\tlist_for_each_entry(ext, &mem_extents, hook) {\n\t\tstruct mem_zone_bm_rtree *zone;\n\n\t\tzone = create_zone_bm_rtree(gfp_mask, safe_needed, &ca,\n\t\t\t\t\t    ext->start, ext->end);\n\t\tif (!zone) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Error;\n\t\t}\n\t\tlist_add_tail(&zone->list, &bm->zones);\n\t}\n\n\tbm->p_list = ca.chain;\n\tmemory_bm_position_reset(bm);\n Exit:\n\tfree_mem_extents(&mem_extents);\n\treturn error;\n\n Error:\n\tbm->p_list = ca.chain;\n\tmemory_bm_free(bm, PG_UNSAFE_CLEAR);\n\tgoto Exit;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define PG_UNSAFE_CLEAR\t1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_UNSAFE_CLEAR\t1\n\nstatic int memory_bm_create(struct memory_bitmap *bm, gfp_t gfp_mask,\n\t\t\t    int safe_needed)\n{\n\tstruct chain_allocator ca;\n\tstruct list_head mem_extents;\n\tstruct mem_extent *ext;\n\tint error;\n\n\tchain_init(&ca, gfp_mask, safe_needed);\n\tINIT_LIST_HEAD(&bm->zones);\n\n\terror = create_mem_extents(&mem_extents, gfp_mask);\n\tif (error)\n\t\treturn error;\n\n\tlist_for_each_entry(ext, &mem_extents, hook) {\n\t\tstruct mem_zone_bm_rtree *zone;\n\n\t\tzone = create_zone_bm_rtree(gfp_mask, safe_needed, &ca,\n\t\t\t\t\t    ext->start, ext->end);\n\t\tif (!zone) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Error;\n\t\t}\n\t\tlist_add_tail(&zone->list, &bm->zones);\n\t}\n\n\tbm->p_list = ca.chain;\n\tmemory_bm_position_reset(bm);\n Exit:\n\tfree_mem_extents(&mem_extents);\n\treturn error;\n\n Error:\n\tbm->p_list = ca.chain;\n\tmemory_bm_free(bm, PG_UNSAFE_CLEAR);\n\tgoto Exit;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_unsafe_pages",
          "args": [
            "bm"
          ],
          "line": 2510
        },
        "resolved": true,
        "details": {
          "function_name": "mark_unsafe_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2201-2217",
          "snippet": "static void mark_unsafe_pages(struct memory_bitmap *bm)\n{\n\tunsigned long pfn;\n\n\t/* Clear the \"free\"/\"unsafe\" bit for all PFNs */\n\tmemory_bm_position_reset(free_pages_map);\n\tpfn = memory_bm_next_pfn(free_pages_map);\n\twhile (pfn != BM_END_OF_MAP) {\n\t\tmemory_bm_clear_current(free_pages_map);\n\t\tpfn = memory_bm_next_pfn(free_pages_map);\n\t}\n\n\t/* Mark pages that correspond to the \"original\" PFNs as \"unsafe\" */\n\tduplicate_memory_bitmap(free_pages_map, bm);\n\n\tallocated_unsafe_pages = 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "static unsigned int allocated_unsafe_pages;",
            "static struct memory_bitmap *free_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic unsigned int allocated_unsafe_pages;\nstatic struct memory_bitmap *free_pages_map;\n\nstatic void mark_unsafe_pages(struct memory_bitmap *bm)\n{\n\tunsigned long pfn;\n\n\t/* Clear the \"free\"/\"unsafe\" bit for all PFNs */\n\tmemory_bm_position_reset(free_pages_map);\n\tpfn = memory_bm_next_pfn(free_pages_map);\n\twhile (pfn != BM_END_OF_MAP) {\n\t\tmemory_bm_clear_current(free_pages_map);\n\t\tpfn = memory_bm_next_pfn(free_pages_map);\n\t}\n\n\t/* Mark pages that correspond to the \"original\" PFNs as \"unsafe\" */\n\tduplicate_memory_bitmap(free_pages_map, bm);\n\n\tallocated_unsafe_pages = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "count_highmem_image_pages",
          "args": [
            "bm"
          ],
          "line": 2509
        },
        "resolved": true,
        "details": {
          "function_name": "count_highmem_image_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2466-2466",
          "snippet": "static unsigned int count_highmem_image_pages(struct memory_bitmap *bm) { return 0; }",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int count_highmem_image_pages(struct memory_bitmap *bm) { return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "free_image_page",
          "args": [
            "buffer",
            "PG_UNSAFE_CLEAR"
          ],
          "line": 2506
        },
        "resolved": true,
        "details": {
          "function_name": "free_image_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "253-266",
          "snippet": "static inline void free_image_page(void *addr, int clear_nosave_free)\n{\n\tstruct page *page;\n\n\tBUG_ON(!virt_addr_valid(addr));\n\n\tpage = virt_to_page(addr);\n\n\tswsusp_unset_page_forbidden(page);\n\tif (clear_nosave_free)\n\t\tswsusp_unset_page_free(page);\n\n\t__free_page(page);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);",
            "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);\n\nstatic inline void free_image_page(void *addr, int clear_nosave_free)\n{\n\tstruct page *page;\n\n\tBUG_ON(!virt_addr_valid(addr));\n\n\tpage = virt_to_page(addr);\n\n\tswsusp_unset_page_forbidden(page);\n\tif (clear_nosave_free)\n\t\tswsusp_unset_page_free(page);\n\n\t__free_page(page);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PBES_PER_LINKED_PAGE\t(LINKED_PAGE_DATA_SIZE / sizeof(struct pbe))\n#define PG_UNSAFE_KEEP\t0\n#define PG_UNSAFE_CLEAR\t1\n#define PG_SAFE\t\t1\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct linked_page *safe_pages_list;\nstatic void *buffer;\nstatic unsigned int allocated_unsafe_pages;\nstatic unsigned int nr_copy_pages;\n\nstatic int prepare_image(struct memory_bitmap *new_bm, struct memory_bitmap *bm)\n{\n\tunsigned int nr_pages, nr_highmem;\n\tstruct linked_page *lp;\n\tint error;\n\n\t/* If there is no highmem, the buffer will not be necessary */\n\tfree_image_page(buffer, PG_UNSAFE_CLEAR);\n\tbuffer = NULL;\n\n\tnr_highmem = count_highmem_image_pages(bm);\n\tmark_unsafe_pages(bm);\n\n\terror = memory_bm_create(new_bm, GFP_ATOMIC, PG_SAFE);\n\tif (error)\n\t\tgoto Free;\n\n\tduplicate_memory_bitmap(new_bm, bm);\n\tmemory_bm_free(bm, PG_UNSAFE_KEEP);\n\tif (nr_highmem > 0) {\n\t\terror = prepare_highmem_image(bm, &nr_highmem);\n\t\tif (error)\n\t\t\tgoto Free;\n\t}\n\t/*\n\t * Reserve some safe pages for potential later use.\n\t *\n\t * NOTE: This way we make sure there will be enough safe pages for the\n\t * chain_alloc() in get_buffer().  It is a bit wasteful, but\n\t * nr_copy_pages cannot be greater than 50% of the memory anyway.\n\t *\n\t * nr_copy_pages cannot be less than allocated_unsafe_pages too.\n\t */\n\tnr_pages = nr_copy_pages - nr_highmem - allocated_unsafe_pages;\n\tnr_pages = DIV_ROUND_UP(nr_pages, PBES_PER_LINKED_PAGE);\n\twhile (nr_pages > 0) {\n\t\tlp = get_image_page(GFP_ATOMIC, PG_SAFE);\n\t\tif (!lp) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Free;\n\t\t}\n\t\tlp->next = safe_pages_list;\n\t\tsafe_pages_list = lp;\n\t\tnr_pages--;\n\t}\n\t/* Preallocate memory for the image */\n\tnr_pages = nr_copy_pages - nr_highmem - allocated_unsafe_pages;\n\twhile (nr_pages > 0) {\n\t\tlp = (struct linked_page *)get_zeroed_page(GFP_ATOMIC);\n\t\tif (!lp) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Free;\n\t\t}\n\t\tif (!swsusp_page_is_free(virt_to_page(lp))) {\n\t\t\t/* The page is \"safe\", add it to the list */\n\t\t\tlp->next = safe_pages_list;\n\t\t\tsafe_pages_list = lp;\n\t\t}\n\t\t/* Mark the page as allocated */\n\t\tswsusp_set_page_forbidden(virt_to_page(lp));\n\t\tswsusp_set_page_free(virt_to_page(lp));\n\t\tnr_pages--;\n\t}\n\treturn 0;\n\n Free:\n\tswsusp_free();\n\treturn error;\n}"
  },
  {
    "function_name": "free_highmem_data",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2479-2479",
    "snippet": "static inline void free_highmem_data(void) {}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void free_highmem_data(void) {}"
  },
  {
    "function_name": "last_highmem_page_copied",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2478-2478",
    "snippet": "static inline int last_highmem_page_copied(void) { return 1; }",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline int last_highmem_page_copied(void) { return 1; }"
  },
  {
    "function_name": "copy_last_highmem_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2477-2477",
    "snippet": "static inline void copy_last_highmem_page(void) {}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void copy_last_highmem_page(void) {}"
  },
  {
    "function_name": "get_highmem_page_buffer",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2471-2475",
    "snippet": "static inline void *get_highmem_page_buffer(struct page *page,\n\t\t\t\t\t    struct chain_allocator *ca)\n{\n\treturn ERR_PTR(-EINVAL);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EINVAL"
          ],
          "line": 2474
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic inline void *get_highmem_page_buffer(struct page *page,\n\t\t\t\t\t    struct chain_allocator *ca)\n{\n\treturn ERR_PTR(-EINVAL);\n}"
  },
  {
    "function_name": "prepare_highmem_image",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2468-2469",
    "snippet": "static inline int prepare_highmem_image(struct memory_bitmap *bm,\n\t\t\t\t\tunsigned int *nr_highmem_p) { return 0; }",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline int prepare_highmem_image(struct memory_bitmap *bm,\n\t\t\t\t\tunsigned int *nr_highmem_p) { return 0; }"
  },
  {
    "function_name": "count_highmem_image_pages",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2466-2466",
    "snippet": "static unsigned int count_highmem_image_pages(struct memory_bitmap *bm) { return 0; }",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int count_highmem_image_pages(struct memory_bitmap *bm) { return 0; }"
  },
  {
    "function_name": "free_highmem_data",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2457-2464",
    "snippet": "static inline void free_highmem_data(void)\n{\n\tif (safe_highmem_bm)\n\t\tmemory_bm_free(safe_highmem_bm, PG_UNSAFE_CLEAR);\n\n\tif (buffer)\n\t\tfree_image_page(buffer, PG_UNSAFE_CLEAR);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define PG_UNSAFE_CLEAR\t1"
    ],
    "globals_used": [
      "static void *buffer;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_image_page",
          "args": [
            "buffer",
            "PG_UNSAFE_CLEAR"
          ],
          "line": 2463
        },
        "resolved": true,
        "details": {
          "function_name": "free_image_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "253-266",
          "snippet": "static inline void free_image_page(void *addr, int clear_nosave_free)\n{\n\tstruct page *page;\n\n\tBUG_ON(!virt_addr_valid(addr));\n\n\tpage = virt_to_page(addr);\n\n\tswsusp_unset_page_forbidden(page);\n\tif (clear_nosave_free)\n\t\tswsusp_unset_page_free(page);\n\n\t__free_page(page);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);",
            "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);\n\nstatic inline void free_image_page(void *addr, int clear_nosave_free)\n{\n\tstruct page *page;\n\n\tBUG_ON(!virt_addr_valid(addr));\n\n\tpage = virt_to_page(addr);\n\n\tswsusp_unset_page_forbidden(page);\n\tif (clear_nosave_free)\n\t\tswsusp_unset_page_free(page);\n\n\t__free_page(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_free",
          "args": [
            "safe_highmem_bm",
            "PG_UNSAFE_CLEAR"
          ],
          "line": 2460
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "719-729",
          "snippet": "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\n\tlist_for_each_entry(zone, &bm->zones, list)\n\t\tfree_zone_bm_rtree(zone, clear_nosave_free);\n\n\tfree_list_of_pages(bm->p_list, clear_nosave_free);\n\n\tINIT_LIST_HEAD(&bm->zones);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);",
            "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);\n\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\n\tlist_for_each_entry(zone, &bm->zones, list)\n\t\tfree_zone_bm_rtree(zone, clear_nosave_free);\n\n\tfree_list_of_pages(bm->p_list, clear_nosave_free);\n\n\tINIT_LIST_HEAD(&bm->zones);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_UNSAFE_CLEAR\t1\n\nstatic void *buffer;\n\nstatic inline void free_highmem_data(void)\n{\n\tif (safe_highmem_bm)\n\t\tmemory_bm_free(safe_highmem_bm, PG_UNSAFE_CLEAR);\n\n\tif (buffer)\n\t\tfree_image_page(buffer, PG_UNSAFE_CLEAR);\n}"
  },
  {
    "function_name": "last_highmem_page_copied",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2452-2455",
    "snippet": "static inline int last_highmem_page_copied(void)\n{\n\treturn !last_highmem_page;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline int last_highmem_page_copied(void)\n{\n\treturn !last_highmem_page;\n}"
  },
  {
    "function_name": "copy_last_highmem_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2440-2450",
    "snippet": "static void copy_last_highmem_page(void)\n{\n\tif (last_highmem_page) {\n\t\tvoid *dst;\n\n\t\tdst = kmap_atomic(last_highmem_page);\n\t\tcopy_page(dst, buffer);\n\t\tkunmap_atomic(dst);\n\t\tlast_highmem_page = NULL;\n\t}\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void *buffer;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "dst"
          ],
          "line": 2447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_page",
          "args": [
            "dst",
            "buffer"
          ],
          "line": 2446
        },
        "resolved": true,
        "details": {
          "function_name": "safe_copy_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1395-1404",
          "snippet": "static void safe_copy_page(void *dst, struct page *s_page)\n{\n\tif (kernel_page_present(s_page)) {\n\t\tdo_copy_page(dst, page_address(s_page));\n\t} else {\n\t\thibernate_map_page(s_page);\n\t\tdo_copy_page(dst, page_address(s_page));\n\t\thibernate_unmap_page(s_page);\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic void safe_copy_page(void *dst, struct page *s_page)\n{\n\tif (kernel_page_present(s_page)) {\n\t\tdo_copy_page(dst, page_address(s_page));\n\t} else {\n\t\thibernate_map_page(s_page);\n\t\tdo_copy_page(dst, page_address(s_page));\n\t\thibernate_unmap_page(s_page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "last_highmem_page"
          ],
          "line": 2445
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void *buffer;\n\nstatic void copy_last_highmem_page(void)\n{\n\tif (last_highmem_page) {\n\t\tvoid *dst;\n\n\t\tdst = kmap_atomic(last_highmem_page);\n\t\tcopy_page(dst, buffer);\n\t\tkunmap_atomic(dst);\n\t\tlast_highmem_page = NULL;\n\t}\n}"
  },
  {
    "function_name": "get_highmem_page_buffer",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2389-2431",
    "snippet": "static void *get_highmem_page_buffer(struct page *page,\n\t\t\t\t     struct chain_allocator *ca)\n{\n\tstruct highmem_pbe *pbe;\n\tvoid *kaddr;\n\n\tif (swsusp_page_is_forbidden(page) && swsusp_page_is_free(page)) {\n\t\t/*\n\t\t * We have allocated the \"original\" page frame and we can\n\t\t * use it directly to store the loaded page.\n\t\t */\n\t\tlast_highmem_page = page;\n\t\treturn buffer;\n\t}\n\t/*\n\t * The \"original\" page frame has not been allocated and we have to\n\t * use a \"safe\" page frame to store the loaded page.\n\t */\n\tpbe = chain_alloc(ca, sizeof(struct highmem_pbe));\n\tif (!pbe) {\n\t\tswsusp_free();\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\tpbe->orig_page = page;\n\tif (safe_highmem_pages > 0) {\n\t\tstruct page *tmp;\n\n\t\t/* Copy of the page will be stored in high memory */\n\t\tkaddr = buffer;\n\t\ttmp = pfn_to_page(memory_bm_next_pfn(safe_highmem_bm));\n\t\tsafe_highmem_pages--;\n\t\tlast_highmem_page = tmp;\n\t\tpbe->copy_page = tmp;\n\t} else {\n\t\t/* Copy of the page will be stored in normal memory */\n\t\tkaddr = safe_pages_list;\n\t\tsafe_pages_list = safe_pages_list->next;\n\t\tpbe->copy_page = virt_to_page(kaddr);\n\t}\n\tpbe->next = highmem_pblist;\n\thighmem_pblist = pbe;\n\treturn kaddr;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);",
      "static struct linked_page *safe_pages_list;",
      "static void *buffer;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virt_to_page",
          "args": [
            "kaddr"
          ],
          "line": 2426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfn_to_page",
          "args": [
            "memory_bm_next_pfn(safe_highmem_bm)"
          ],
          "line": 2418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_bm_next_pfn",
          "args": [
            "safe_highmem_bm"
          ],
          "line": 2418
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_next_pfn",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "915-933",
          "snippet": "static unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)",
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)\n#define BM_END_OF_MAP\t(~0UL)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 2410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swsusp_free",
          "args": [],
          "line": 2409
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1506-1549",
          "snippet": "void swsusp_free(void)\n{\n\tunsigned long fb_pfn, fr_pfn;\n\n\tif (!forbidden_pages_map || !free_pages_map)\n\t\tgoto out;\n\n\tmemory_bm_position_reset(forbidden_pages_map);\n\tmemory_bm_position_reset(free_pages_map);\n\nloop:\n\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\n\t/*\n\t * Find the next bit set in both bitmaps. This is guaranteed to\n\t * terminate when fb_pfn == fr_pfn == BM_END_OF_MAP.\n\t */\n\tdo {\n\t\tif (fb_pfn < fr_pfn)\n\t\t\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\t\tif (fr_pfn < fb_pfn)\n\t\t\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\t} while (fb_pfn != fr_pfn);\n\n\tif (fr_pfn != BM_END_OF_MAP && pfn_valid(fr_pfn)) {\n\t\tstruct page *page = pfn_to_page(fr_pfn);\n\n\t\tmemory_bm_clear_current(forbidden_pages_map);\n\t\tmemory_bm_clear_current(free_pages_map);\n\t\thibernate_restore_unprotect_page(page_address(page));\n\t\t__free_page(page);\n\t\tgoto loop;\n\t}\n\nout:\n\tnr_copy_pages = 0;\n\tnr_meta_pages = 0;\n\trestore_pblist = NULL;\n\tbuffer = NULL;\n\talloc_normal = 0;\n\talloc_highmem = 0;\n\thibernate_restore_protection_end();\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "struct pbe *restore_pblist;",
            "static void *buffer;",
            "static struct memory_bitmap *forbidden_pages_map;",
            "static struct memory_bitmap *free_pages_map;",
            "static unsigned int nr_copy_pages;",
            "static unsigned int nr_meta_pages;",
            "static unsigned int alloc_normal, alloc_highmem;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstruct pbe *restore_pblist;\nstatic void *buffer;\nstatic struct memory_bitmap *forbidden_pages_map;\nstatic struct memory_bitmap *free_pages_map;\nstatic unsigned int nr_copy_pages;\nstatic unsigned int nr_meta_pages;\nstatic unsigned int alloc_normal, alloc_highmem;\n\nvoid swsusp_free(void)\n{\n\tunsigned long fb_pfn, fr_pfn;\n\n\tif (!forbidden_pages_map || !free_pages_map)\n\t\tgoto out;\n\n\tmemory_bm_position_reset(forbidden_pages_map);\n\tmemory_bm_position_reset(free_pages_map);\n\nloop:\n\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\n\t/*\n\t * Find the next bit set in both bitmaps. This is guaranteed to\n\t * terminate when fb_pfn == fr_pfn == BM_END_OF_MAP.\n\t */\n\tdo {\n\t\tif (fb_pfn < fr_pfn)\n\t\t\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\t\tif (fr_pfn < fb_pfn)\n\t\t\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\t} while (fb_pfn != fr_pfn);\n\n\tif (fr_pfn != BM_END_OF_MAP && pfn_valid(fr_pfn)) {\n\t\tstruct page *page = pfn_to_page(fr_pfn);\n\n\t\tmemory_bm_clear_current(forbidden_pages_map);\n\t\tmemory_bm_clear_current(free_pages_map);\n\t\thibernate_restore_unprotect_page(page_address(page));\n\t\t__free_page(page);\n\t\tgoto loop;\n\t}\n\nout:\n\tnr_copy_pages = 0;\n\tnr_meta_pages = 0;\n\trestore_pblist = NULL;\n\tbuffer = NULL;\n\talloc_normal = 0;\n\talloc_highmem = 0;\n\thibernate_restore_protection_end();\n}"
        }
      },
      {
        "call_info": {
          "callee": "chain_alloc",
          "args": [
            "ca",
            "sizeof(struct highmem_pbe)"
          ],
          "line": 2407
        },
        "resolved": true,
        "details": {
          "function_name": "chain_alloc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "308-327",
          "snippet": "static void *chain_alloc(struct chain_allocator *ca, unsigned int size)\n{\n\tvoid *ret;\n\n\tif (LINKED_PAGE_DATA_SIZE - ca->used_space < size) {\n\t\tstruct linked_page *lp;\n\n\t\tlp = ca->safe_needed ? __get_safe_page(ca->gfp_mask) :\n\t\t\t\t\tget_image_page(ca->gfp_mask, PG_ANY);\n\t\tif (!lp)\n\t\t\treturn NULL;\n\n\t\tlp->next = ca->chain;\n\t\tca->chain = lp;\n\t\tca->used_space = 0;\n\t}\n\tret = ca->chain->data + ca->used_space;\n\tca->used_space += size;\n\treturn ret;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define PG_ANY\t\t0",
            "#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_ANY\t\t0\n#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic void *chain_alloc(struct chain_allocator *ca, unsigned int size)\n{\n\tvoid *ret;\n\n\tif (LINKED_PAGE_DATA_SIZE - ca->used_space < size) {\n\t\tstruct linked_page *lp;\n\n\t\tlp = ca->safe_needed ? __get_safe_page(ca->gfp_mask) :\n\t\t\t\t\tget_image_page(ca->gfp_mask, PG_ANY);\n\t\tif (!lp)\n\t\t\treturn NULL;\n\n\t\tlp->next = ca->chain;\n\t\tca->chain = lp;\n\t\tca->used_space = 0;\n\t}\n\tret = ca->chain->data + ca->used_space;\n\tca->used_space += size;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "swsusp_page_is_free",
          "args": [
            "page"
          ],
          "line": 2395
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_page_is_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1039-1043",
          "snippet": "static int swsusp_page_is_free(struct page *page)\n{\n\treturn free_pages_map ?\n\t\tmemory_bm_test_bit(free_pages_map, page_to_pfn(page)) : 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *free_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *free_pages_map;\n\nstatic int swsusp_page_is_free(struct page *page)\n{\n\treturn free_pages_map ?\n\t\tmemory_bm_test_bit(free_pages_map, page_to_pfn(page)) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "swsusp_page_is_forbidden",
          "args": [
            "page"
          ],
          "line": 2395
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_page_is_forbidden",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1057-1061",
          "snippet": "int swsusp_page_is_forbidden(struct page *page)\n{\n\treturn forbidden_pages_map ?\n\t\tmemory_bm_test_bit(forbidden_pages_map, page_to_pfn(page)) : 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *forbidden_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *forbidden_pages_map;\n\nint swsusp_page_is_forbidden(struct page *page)\n{\n\treturn forbidden_pages_map ?\n\t\tmemory_bm_test_bit(forbidden_pages_map, page_to_pfn(page)) : 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct linked_page *safe_pages_list;\nstatic void *buffer;\n\nstatic void *get_highmem_page_buffer(struct page *page,\n\t\t\t\t     struct chain_allocator *ca)\n{\n\tstruct highmem_pbe *pbe;\n\tvoid *kaddr;\n\n\tif (swsusp_page_is_forbidden(page) && swsusp_page_is_free(page)) {\n\t\t/*\n\t\t * We have allocated the \"original\" page frame and we can\n\t\t * use it directly to store the loaded page.\n\t\t */\n\t\tlast_highmem_page = page;\n\t\treturn buffer;\n\t}\n\t/*\n\t * The \"original\" page frame has not been allocated and we have to\n\t * use a \"safe\" page frame to store the loaded page.\n\t */\n\tpbe = chain_alloc(ca, sizeof(struct highmem_pbe));\n\tif (!pbe) {\n\t\tswsusp_free();\n\t\treturn ERR_PTR(-ENOMEM);\n\t}\n\tpbe->orig_page = page;\n\tif (safe_highmem_pages > 0) {\n\t\tstruct page *tmp;\n\n\t\t/* Copy of the page will be stored in high memory */\n\t\tkaddr = buffer;\n\t\ttmp = pfn_to_page(memory_bm_next_pfn(safe_highmem_bm));\n\t\tsafe_highmem_pages--;\n\t\tlast_highmem_page = tmp;\n\t\tpbe->copy_page = tmp;\n\t} else {\n\t\t/* Copy of the page will be stored in normal memory */\n\t\tkaddr = safe_pages_list;\n\t\tsafe_pages_list = safe_pages_list->next;\n\t\tpbe->copy_page = virt_to_page(kaddr);\n\t}\n\tpbe->next = highmem_pblist;\n\thighmem_pblist = pbe;\n\treturn kaddr;\n}"
  },
  {
    "function_name": "prepare_highmem_image",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2333-2367",
    "snippet": "static int prepare_highmem_image(struct memory_bitmap *bm,\n\t\t\t\t unsigned int *nr_highmem_p)\n{\n\tunsigned int to_alloc;\n\n\tif (memory_bm_create(bm, GFP_ATOMIC, PG_SAFE))\n\t\treturn -ENOMEM;\n\n\tif (get_highmem_buffer(PG_SAFE))\n\t\treturn -ENOMEM;\n\n\tto_alloc = count_free_highmem_pages();\n\tif (to_alloc > *nr_highmem_p)\n\t\tto_alloc = *nr_highmem_p;\n\telse\n\t\t*nr_highmem_p = to_alloc;\n\n\tsafe_highmem_pages = 0;\n\twhile (to_alloc-- > 0) {\n\t\tstruct page *page;\n\n\t\tpage = alloc_page(__GFP_HIGHMEM);\n\t\tif (!swsusp_page_is_free(page)) {\n\t\t\t/* The page is \"safe\", set its bit the bitmap */\n\t\t\tmemory_bm_set_bit(bm, page_to_pfn(page));\n\t\t\tsafe_highmem_pages++;\n\t\t}\n\t\t/* Mark the page as allocated */\n\t\tswsusp_set_page_forbidden(page);\n\t\tswsusp_set_page_free(page);\n\t}\n\tmemory_bm_position_reset(bm);\n\tsafe_highmem_bm = bm;\n\treturn 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define PG_SAFE\t\t1"
    ],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memory_bm_position_reset",
          "args": [
            "bm"
          ],
          "line": 2364
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_position_reset",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "581-589",
          "snippet": "static void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "swsusp_set_page_free",
          "args": [
            "page"
          ],
          "line": 2362
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_set_page_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1033-1037",
          "snippet": "void swsusp_set_page_free(struct page *page)\n{\n\tif (free_pages_map)\n\t\tmemory_bm_set_bit(free_pages_map, page_to_pfn(page));\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *free_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *free_pages_map;\n\nvoid swsusp_set_page_free(struct page *page)\n{\n\tif (free_pages_map)\n\t\tmemory_bm_set_bit(free_pages_map, page_to_pfn(page));\n}"
        }
      },
      {
        "call_info": {
          "callee": "swsusp_set_page_forbidden",
          "args": [
            "page"
          ],
          "line": 2361
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_set_page_forbidden",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1051-1055",
          "snippet": "static void swsusp_set_page_forbidden(struct page *page)\n{\n\tif (forbidden_pages_map)\n\t\tmemory_bm_set_bit(forbidden_pages_map, page_to_pfn(page));\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *forbidden_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *forbidden_pages_map;\n\nstatic void swsusp_set_page_forbidden(struct page *page)\n{\n\tif (forbidden_pages_map)\n\t\tmemory_bm_set_bit(forbidden_pages_map, page_to_pfn(page));\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_set_bit",
          "args": [
            "bm",
            "page_to_pfn(page)"
          ],
          "line": 2357
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_set_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "806-815",
          "snippet": "static void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_to_pfn",
          "args": [
            "page"
          ],
          "line": 2357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swsusp_page_is_free",
          "args": [
            "page"
          ],
          "line": 2355
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_page_is_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1039-1043",
          "snippet": "static int swsusp_page_is_free(struct page *page)\n{\n\treturn free_pages_map ?\n\t\tmemory_bm_test_bit(free_pages_map, page_to_pfn(page)) : 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *free_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *free_pages_map;\n\nstatic int swsusp_page_is_free(struct page *page)\n{\n\treturn free_pages_map ?\n\t\tmemory_bm_test_bit(free_pages_map, page_to_pfn(page)) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "alloc_page",
          "args": [
            "__GFP_HIGHMEM"
          ],
          "line": 2354
        },
        "resolved": true,
        "details": {
          "function_name": "relay_alloc_page_array",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/relay.c",
          "lines": "61-67",
          "snippet": "static struct page **relay_alloc_page_array(unsigned int n_pages)\n{\n\tconst size_t pa_size = n_pages * sizeof(struct page *);\n\tif (pa_size > PAGE_SIZE)\n\t\treturn vzalloc(pa_size);\n\treturn kzalloc(pa_size, GFP_KERNEL);\n}",
          "includes": [
            "#include <linux/splice.h>",
            "#include <linux/cpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/relay.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/stddef.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/splice.h>\n#include <linux/cpu.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n#include <linux/relay.h>\n#include <linux/string.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/stddef.h>\n#include <linux/errno.h>\n\nstatic struct page **relay_alloc_page_array(unsigned int n_pages)\n{\n\tconst size_t pa_size = n_pages * sizeof(struct page *);\n\tif (pa_size > PAGE_SIZE)\n\t\treturn vzalloc(pa_size);\n\treturn kzalloc(pa_size, GFP_KERNEL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "count_free_highmem_pages",
          "args": [],
          "line": 2344
        },
        "resolved": true,
        "details": {
          "function_name": "count_free_highmem_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1240-1250",
          "snippet": "static unsigned int count_free_highmem_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned int cnt = 0;\n\n\tfor_each_populated_zone(zone)\n\t\tif (is_highmem(zone))\n\t\t\tcnt += zone_page_state(zone, NR_FREE_PAGES);\n\n\treturn cnt;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int count_free_highmem_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned int cnt = 0;\n\n\tfor_each_populated_zone(zone)\n\t\tif (is_highmem(zone))\n\t\t\tcnt += zone_page_state(zone, NR_FREE_PAGES);\n\n\treturn cnt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_highmem_buffer",
          "args": [
            "PG_SAFE"
          ],
          "line": 2341
        },
        "resolved": true,
        "details": {
          "function_name": "get_highmem_buffer",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1970-1970",
          "snippet": "static inline int get_highmem_buffer(int safe_needed) { return 0; }",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline int get_highmem_buffer(int safe_needed) { return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_create",
          "args": [
            "bm",
            "GFP_ATOMIC",
            "PG_SAFE"
          ],
          "line": 2338
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_create",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "676-713",
          "snippet": "static int memory_bm_create(struct memory_bitmap *bm, gfp_t gfp_mask,\n\t\t\t    int safe_needed)\n{\n\tstruct chain_allocator ca;\n\tstruct list_head mem_extents;\n\tstruct mem_extent *ext;\n\tint error;\n\n\tchain_init(&ca, gfp_mask, safe_needed);\n\tINIT_LIST_HEAD(&bm->zones);\n\n\terror = create_mem_extents(&mem_extents, gfp_mask);\n\tif (error)\n\t\treturn error;\n\n\tlist_for_each_entry(ext, &mem_extents, hook) {\n\t\tstruct mem_zone_bm_rtree *zone;\n\n\t\tzone = create_zone_bm_rtree(gfp_mask, safe_needed, &ca,\n\t\t\t\t\t    ext->start, ext->end);\n\t\tif (!zone) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Error;\n\t\t}\n\t\tlist_add_tail(&zone->list, &bm->zones);\n\t}\n\n\tbm->p_list = ca.chain;\n\tmemory_bm_position_reset(bm);\n Exit:\n\tfree_mem_extents(&mem_extents);\n\treturn error;\n\n Error:\n\tbm->p_list = ca.chain;\n\tmemory_bm_free(bm, PG_UNSAFE_CLEAR);\n\tgoto Exit;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define PG_UNSAFE_CLEAR\t1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_UNSAFE_CLEAR\t1\n\nstatic int memory_bm_create(struct memory_bitmap *bm, gfp_t gfp_mask,\n\t\t\t    int safe_needed)\n{\n\tstruct chain_allocator ca;\n\tstruct list_head mem_extents;\n\tstruct mem_extent *ext;\n\tint error;\n\n\tchain_init(&ca, gfp_mask, safe_needed);\n\tINIT_LIST_HEAD(&bm->zones);\n\n\terror = create_mem_extents(&mem_extents, gfp_mask);\n\tif (error)\n\t\treturn error;\n\n\tlist_for_each_entry(ext, &mem_extents, hook) {\n\t\tstruct mem_zone_bm_rtree *zone;\n\n\t\tzone = create_zone_bm_rtree(gfp_mask, safe_needed, &ca,\n\t\t\t\t\t    ext->start, ext->end);\n\t\tif (!zone) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Error;\n\t\t}\n\t\tlist_add_tail(&zone->list, &bm->zones);\n\t}\n\n\tbm->p_list = ca.chain;\n\tmemory_bm_position_reset(bm);\n Exit:\n\tfree_mem_extents(&mem_extents);\n\treturn error;\n\n Error:\n\tbm->p_list = ca.chain;\n\tmemory_bm_free(bm, PG_UNSAFE_CLEAR);\n\tgoto Exit;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_SAFE\t\t1\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic int prepare_highmem_image(struct memory_bitmap *bm,\n\t\t\t\t unsigned int *nr_highmem_p)\n{\n\tunsigned int to_alloc;\n\n\tif (memory_bm_create(bm, GFP_ATOMIC, PG_SAFE))\n\t\treturn -ENOMEM;\n\n\tif (get_highmem_buffer(PG_SAFE))\n\t\treturn -ENOMEM;\n\n\tto_alloc = count_free_highmem_pages();\n\tif (to_alloc > *nr_highmem_p)\n\t\tto_alloc = *nr_highmem_p;\n\telse\n\t\t*nr_highmem_p = to_alloc;\n\n\tsafe_highmem_pages = 0;\n\twhile (to_alloc-- > 0) {\n\t\tstruct page *page;\n\n\t\tpage = alloc_page(__GFP_HIGHMEM);\n\t\tif (!swsusp_page_is_free(page)) {\n\t\t\t/* The page is \"safe\", set its bit the bitmap */\n\t\t\tmemory_bm_set_bit(bm, page_to_pfn(page));\n\t\t\tsafe_highmem_pages++;\n\t\t}\n\t\t/* Mark the page as allocated */\n\t\tswsusp_set_page_forbidden(page);\n\t\tswsusp_set_page_free(page);\n\t}\n\tmemory_bm_position_reset(bm);\n\tsafe_highmem_bm = bm;\n\treturn 0;\n}"
  },
  {
    "function_name": "count_highmem_image_pages",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2300-2314",
    "snippet": "static unsigned int count_highmem_image_pages(struct memory_bitmap *bm)\n{\n\tunsigned long pfn;\n\tunsigned int cnt = 0;\n\n\tmemory_bm_position_reset(bm);\n\tpfn = memory_bm_next_pfn(bm);\n\twhile (pfn != BM_END_OF_MAP) {\n\t\tif (PageHighMem(pfn_to_page(pfn)))\n\t\t\tcnt++;\n\n\t\tpfn = memory_bm_next_pfn(bm);\n\t}\n\treturn cnt;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define BM_END_OF_MAP\t(~0UL)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memory_bm_next_pfn",
          "args": [
            "bm"
          ],
          "line": 2311
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_next_pfn",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "915-933",
          "snippet": "static unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)",
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)\n#define BM_END_OF_MAP\t(~0UL)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PageHighMem",
          "args": [
            "pfn_to_page(pfn)"
          ],
          "line": 2308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfn_to_page",
          "args": [
            "pfn"
          ],
          "line": 2308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_bm_position_reset",
          "args": [
            "bm"
          ],
          "line": 2305
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_position_reset",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "581-589",
          "snippet": "static void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic unsigned int count_highmem_image_pages(struct memory_bitmap *bm)\n{\n\tunsigned long pfn;\n\tunsigned int cnt = 0;\n\n\tmemory_bm_position_reset(bm);\n\tpfn = memory_bm_next_pfn(bm);\n\twhile (pfn != BM_END_OF_MAP) {\n\t\tif (PageHighMem(pfn_to_page(pfn)))\n\t\t\tcnt++;\n\n\t\tpfn = memory_bm_next_pfn(bm);\n\t}\n\treturn cnt;\n}"
  },
  {
    "function_name": "unpack_orig_pfns",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2257-2272",
    "snippet": "static int unpack_orig_pfns(unsigned long *buf, struct memory_bitmap *bm)\n{\n\tint j;\n\n\tfor (j = 0; j < PAGE_SIZE / sizeof(long); j++) {\n\t\tif (unlikely(buf[j] == BM_END_OF_MAP))\n\t\t\tbreak;\n\n\t\tif (pfn_valid(buf[j]) && memory_bm_pfn_present(bm, buf[j]))\n\t\t\tmemory_bm_set_bit(bm, buf[j]);\n\t\telse\n\t\t\treturn -EFAULT;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define BM_END_OF_MAP\t(~0UL)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memory_bm_set_bit",
          "args": [
            "bm",
            "buf[j]"
          ],
          "line": 2266
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_set_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "806-815",
          "snippet": "static void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_pfn_present",
          "args": [
            "bm",
            "buf[j]"
          ],
          "line": 2265
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_pfn_present",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "860-866",
          "snippet": "static bool memory_bm_pfn_present(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\n\treturn !memory_bm_find_bit(bm, pfn, &addr, &bit);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic bool memory_bm_pfn_present(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\n\treturn !memory_bm_find_bit(bm, pfn, &addr, &bit);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pfn_valid",
          "args": [
            "buf[j]"
          ],
          "line": 2265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "buf[j] == BM_END_OF_MAP"
          ],
          "line": 2262
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic int unpack_orig_pfns(unsigned long *buf, struct memory_bitmap *bm)\n{\n\tint j;\n\n\tfor (j = 0; j < PAGE_SIZE / sizeof(long); j++) {\n\t\tif (unlikely(buf[j] == BM_END_OF_MAP))\n\t\t\tbreak;\n\n\t\tif (pfn_valid(buf[j]) && memory_bm_pfn_present(bm, buf[j]))\n\t\t\tmemory_bm_set_bit(bm, buf[j]);\n\t\telse\n\t\t\treturn -EFAULT;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "load_header",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2236-2247",
    "snippet": "static int load_header(struct swsusp_info *info)\n{\n\tint error;\n\n\trestore_pblist = NULL;\n\terror = check_header(info);\n\tif (!error) {\n\t\tnr_copy_pages = info->image_pages;\n\t\tnr_meta_pages = info->pages - info->image_pages - 1;\n\t}\n\treturn error;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct pbe *restore_pblist;",
      "static unsigned int nr_copy_pages;",
      "static unsigned int nr_meta_pages;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "check_header",
          "args": [
            "info"
          ],
          "line": 2241
        },
        "resolved": true,
        "details": {
          "function_name": "check_header",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2219-2231",
          "snippet": "static int check_header(struct swsusp_info *info)\n{\n\tconst char *reason;\n\n\treason = check_image_kernel(info);\n\tif (!reason && info->num_physpages != get_num_physpages())\n\t\treason = \"memory size\";\n\tif (reason) {\n\t\tpr_err(\"Image mismatch: %s\\n\", reason);\n\t\treturn -EPERM;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int check_header(struct swsusp_info *info)\n{\n\tconst char *reason;\n\n\treason = check_image_kernel(info);\n\tif (!reason && info->num_physpages != get_num_physpages())\n\t\treason = \"memory size\";\n\tif (reason) {\n\t\tpr_err(\"Image mismatch: %s\\n\", reason);\n\t\treturn -EPERM;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstruct pbe *restore_pblist;\nstatic unsigned int nr_copy_pages;\nstatic unsigned int nr_meta_pages;\n\nstatic int load_header(struct swsusp_info *info)\n{\n\tint error;\n\n\trestore_pblist = NULL;\n\terror = check_header(info);\n\tif (!error) {\n\t\tnr_copy_pages = info->image_pages;\n\t\tnr_meta_pages = info->pages - info->image_pages - 1;\n\t}\n\treturn error;\n}"
  },
  {
    "function_name": "check_header",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2219-2231",
    "snippet": "static int check_header(struct swsusp_info *info)\n{\n\tconst char *reason;\n\n\treason = check_image_kernel(info);\n\tif (!reason && info->num_physpages != get_num_physpages())\n\t\treason = \"memory size\";\n\tif (reason) {\n\t\tpr_err(\"Image mismatch: %s\\n\", reason);\n\t\treturn -EPERM;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Image mismatch: %s\\n\"",
            "reason"
          ],
          "line": 2227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_num_physpages",
          "args": [],
          "line": 2224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_image_kernel",
          "args": [
            "info"
          ],
          "line": 2223
        },
        "resolved": true,
        "details": {
          "function_name": "check_image_kernel",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2068-2081",
          "snippet": "static const char *check_image_kernel(struct swsusp_info *info)\n{\n\tif (info->version_code != LINUX_VERSION_CODE)\n\t\treturn \"kernel version\";\n\tif (strcmp(info->uts.sysname,init_utsname()->sysname))\n\t\treturn \"system type\";\n\tif (strcmp(info->uts.release,init_utsname()->release))\n\t\treturn \"kernel release\";\n\tif (strcmp(info->uts.version,init_utsname()->version))\n\t\treturn \"version\";\n\tif (strcmp(info->uts.machine,init_utsname()->machine))\n\t\treturn \"machine\";\n\treturn NULL;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic const char *check_image_kernel(struct swsusp_info *info)\n{\n\tif (info->version_code != LINUX_VERSION_CODE)\n\t\treturn \"kernel version\";\n\tif (strcmp(info->uts.sysname,init_utsname()->sysname))\n\t\treturn \"system type\";\n\tif (strcmp(info->uts.release,init_utsname()->release))\n\t\treturn \"kernel release\";\n\tif (strcmp(info->uts.version,init_utsname()->version))\n\t\treturn \"version\";\n\tif (strcmp(info->uts.machine,init_utsname()->machine))\n\t\treturn \"machine\";\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int check_header(struct swsusp_info *info)\n{\n\tconst char *reason;\n\n\treason = check_image_kernel(info);\n\tif (!reason && info->num_physpages != get_num_physpages())\n\t\treason = \"memory size\";\n\tif (reason) {\n\t\tpr_err(\"Image mismatch: %s\\n\", reason);\n\t\treturn -EPERM;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "mark_unsafe_pages",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2201-2217",
    "snippet": "static void mark_unsafe_pages(struct memory_bitmap *bm)\n{\n\tunsigned long pfn;\n\n\t/* Clear the \"free\"/\"unsafe\" bit for all PFNs */\n\tmemory_bm_position_reset(free_pages_map);\n\tpfn = memory_bm_next_pfn(free_pages_map);\n\twhile (pfn != BM_END_OF_MAP) {\n\t\tmemory_bm_clear_current(free_pages_map);\n\t\tpfn = memory_bm_next_pfn(free_pages_map);\n\t}\n\n\t/* Mark pages that correspond to the \"original\" PFNs as \"unsafe\" */\n\tduplicate_memory_bitmap(free_pages_map, bm);\n\n\tallocated_unsafe_pages = 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define BM_END_OF_MAP\t(~0UL)"
    ],
    "globals_used": [
      "static unsigned int allocated_unsafe_pages;",
      "static struct memory_bitmap *free_pages_map;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "duplicate_memory_bitmap",
          "args": [
            "free_pages_map",
            "bm"
          ],
          "line": 2214
        },
        "resolved": true,
        "details": {
          "function_name": "duplicate_memory_bitmap",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2182-2193",
          "snippet": "static void duplicate_memory_bitmap(struct memory_bitmap *dst,\n\t\t\t\t    struct memory_bitmap *src)\n{\n\tunsigned long pfn;\n\n\tmemory_bm_position_reset(src);\n\tpfn = memory_bm_next_pfn(src);\n\twhile (pfn != BM_END_OF_MAP) {\n\t\tmemory_bm_set_bit(dst, pfn);\n\t\tpfn = memory_bm_next_pfn(src);\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic void duplicate_memory_bitmap(struct memory_bitmap *dst,\n\t\t\t\t    struct memory_bitmap *src)\n{\n\tunsigned long pfn;\n\n\tmemory_bm_position_reset(src);\n\tpfn = memory_bm_next_pfn(src);\n\twhile (pfn != BM_END_OF_MAP) {\n\t\tmemory_bm_set_bit(dst, pfn);\n\t\tpfn = memory_bm_next_pfn(src);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_next_pfn",
          "args": [
            "free_pages_map"
          ],
          "line": 2210
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_next_pfn",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "915-933",
          "snippet": "static unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)",
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)\n#define BM_END_OF_MAP\t(~0UL)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_clear_current",
          "args": [
            "free_pages_map"
          ],
          "line": 2209
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_clear_current",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "841-847",
          "snippet": "static void memory_bm_clear_current(struct memory_bitmap *bm)\n{\n\tint bit;\n\n\tbit = max(bm->cur.node_bit - 1, 0);\n\tclear_bit(bit, bm->cur.node->data);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic void memory_bm_clear_current(struct memory_bitmap *bm)\n{\n\tint bit;\n\n\tbit = max(bm->cur.node_bit - 1, 0);\n\tclear_bit(bit, bm->cur.node->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_position_reset",
          "args": [
            "free_pages_map"
          ],
          "line": 2206
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_position_reset",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "581-589",
          "snippet": "static void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic unsigned int allocated_unsafe_pages;\nstatic struct memory_bitmap *free_pages_map;\n\nstatic void mark_unsafe_pages(struct memory_bitmap *bm)\n{\n\tunsigned long pfn;\n\n\t/* Clear the \"free\"/\"unsafe\" bit for all PFNs */\n\tmemory_bm_position_reset(free_pages_map);\n\tpfn = memory_bm_next_pfn(free_pages_map);\n\twhile (pfn != BM_END_OF_MAP) {\n\t\tmemory_bm_clear_current(free_pages_map);\n\t\tpfn = memory_bm_next_pfn(free_pages_map);\n\t}\n\n\t/* Mark pages that correspond to the \"original\" PFNs as \"unsafe\" */\n\tduplicate_memory_bitmap(free_pages_map, bm);\n\n\tallocated_unsafe_pages = 0;\n}"
  },
  {
    "function_name": "duplicate_memory_bitmap",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2182-2193",
    "snippet": "static void duplicate_memory_bitmap(struct memory_bitmap *dst,\n\t\t\t\t    struct memory_bitmap *src)\n{\n\tunsigned long pfn;\n\n\tmemory_bm_position_reset(src);\n\tpfn = memory_bm_next_pfn(src);\n\twhile (pfn != BM_END_OF_MAP) {\n\t\tmemory_bm_set_bit(dst, pfn);\n\t\tpfn = memory_bm_next_pfn(src);\n\t}\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define BM_END_OF_MAP\t(~0UL)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memory_bm_next_pfn",
          "args": [
            "src"
          ],
          "line": 2191
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_next_pfn",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "915-933",
          "snippet": "static unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)",
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)\n#define BM_END_OF_MAP\t(~0UL)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_set_bit",
          "args": [
            "dst",
            "pfn"
          ],
          "line": 2190
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_set_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "806-815",
          "snippet": "static void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_position_reset",
          "args": [
            "src"
          ],
          "line": 2187
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_position_reset",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "581-589",
          "snippet": "static void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic void duplicate_memory_bitmap(struct memory_bitmap *dst,\n\t\t\t\t    struct memory_bitmap *src)\n{\n\tunsigned long pfn;\n\n\tmemory_bm_position_reset(src);\n\tpfn = memory_bm_next_pfn(src);\n\twhile (pfn != BM_END_OF_MAP) {\n\t\tmemory_bm_set_bit(dst, pfn);\n\t\tpfn = memory_bm_next_pfn(src);\n\t}\n}"
  },
  {
    "function_name": "snapshot_read_next",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2135-2180",
    "snippet": "int snapshot_read_next(struct snapshot_handle *handle)\n{\n\tif (handle->cur > nr_meta_pages + nr_copy_pages)\n\t\treturn 0;\n\n\tif (!buffer) {\n\t\t/* This makes the buffer be freed by swsusp_free() */\n\t\tbuffer = get_image_page(GFP_ATOMIC, PG_ANY);\n\t\tif (!buffer)\n\t\t\treturn -ENOMEM;\n\t}\n\tif (!handle->cur) {\n\t\tint error;\n\n\t\terror = init_header((struct swsusp_info *)buffer);\n\t\tif (error)\n\t\t\treturn error;\n\t\thandle->buffer = buffer;\n\t\tmemory_bm_position_reset(&orig_bm);\n\t\tmemory_bm_position_reset(&copy_bm);\n\t} else if (handle->cur <= nr_meta_pages) {\n\t\tclear_page(buffer);\n\t\tpack_pfns(buffer, &orig_bm);\n\t} else {\n\t\tstruct page *page;\n\n\t\tpage = pfn_to_page(memory_bm_next_pfn(&copy_bm));\n\t\tif (PageHighMem(page)) {\n\t\t\t/*\n\t\t\t * Highmem pages are copied to the buffer,\n\t\t\t * because we can't return with a kmapped\n\t\t\t * highmem page (we may not be called again).\n\t\t\t */\n\t\t\tvoid *kaddr;\n\n\t\t\tkaddr = kmap_atomic(page);\n\t\t\tcopy_page(buffer, kaddr);\n\t\t\tkunmap_atomic(kaddr);\n\t\t\thandle->buffer = buffer;\n\t\t} else {\n\t\t\thandle->buffer = page_address(page);\n\t\t}\n\t}\n\thandle->cur++;\n\treturn PAGE_SIZE;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define PG_ANY\t\t0"
    ],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);",
      "static void *buffer;",
      "static unsigned int nr_copy_pages;",
      "static unsigned int nr_meta_pages;",
      "static struct memory_bitmap orig_bm;",
      "static struct memory_bitmap copy_bm;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 2175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "kaddr"
          ],
          "line": 2172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_page",
          "args": [
            "buffer",
            "kaddr"
          ],
          "line": 2171
        },
        "resolved": true,
        "details": {
          "function_name": "safe_copy_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1395-1404",
          "snippet": "static void safe_copy_page(void *dst, struct page *s_page)\n{\n\tif (kernel_page_present(s_page)) {\n\t\tdo_copy_page(dst, page_address(s_page));\n\t} else {\n\t\thibernate_map_page(s_page);\n\t\tdo_copy_page(dst, page_address(s_page));\n\t\thibernate_unmap_page(s_page);\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic void safe_copy_page(void *dst, struct page *s_page)\n{\n\tif (kernel_page_present(s_page)) {\n\t\tdo_copy_page(dst, page_address(s_page));\n\t} else {\n\t\thibernate_map_page(s_page);\n\t\tdo_copy_page(dst, page_address(s_page));\n\t\thibernate_unmap_page(s_page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "page"
          ],
          "line": 2170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageHighMem",
          "args": [
            "page"
          ],
          "line": 2162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfn_to_page",
          "args": [
            "memory_bm_next_pfn(&copy_bm)"
          ],
          "line": 2161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_bm_next_pfn",
          "args": [
            "&copy_bm"
          ],
          "line": 2161
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_next_pfn",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "915-933",
          "snippet": "static unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)",
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)\n#define BM_END_OF_MAP\t(~0UL)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pack_pfns",
          "args": [
            "buffer",
            "&orig_bm"
          ],
          "line": 2157
        },
        "resolved": true,
        "details": {
          "function_name": "pack_pfns",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2108-2117",
          "snippet": "static inline void pack_pfns(unsigned long *buf, struct memory_bitmap *bm)\n{\n\tint j;\n\n\tfor (j = 0; j < PAGE_SIZE / sizeof(long); j++) {\n\t\tbuf[j] = memory_bm_next_pfn(bm);\n\t\tif (unlikely(buf[j] == BM_END_OF_MAP))\n\t\t\tbreak;\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic inline void pack_pfns(unsigned long *buf, struct memory_bitmap *bm)\n{\n\tint j;\n\n\tfor (j = 0; j < PAGE_SIZE / sizeof(long); j++) {\n\t\tbuf[j] = memory_bm_next_pfn(bm);\n\t\tif (unlikely(buf[j] == BM_END_OF_MAP))\n\t\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_page",
          "args": [
            "buffer"
          ],
          "line": 2156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_bm_position_reset",
          "args": [
            "&copy_bm"
          ],
          "line": 2154
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_position_reset",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "581-589",
          "snippet": "static void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "init_header",
          "args": [
            "(struct swsusp_info *)buffer"
          ],
          "line": 2149
        },
        "resolved": true,
        "details": {
          "function_name": "init_header",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2089-2098",
          "snippet": "static int init_header(struct swsusp_info *info)\n{\n\tmemset(info, 0, sizeof(struct swsusp_info));\n\tinfo->num_physpages = get_num_physpages();\n\tinfo->image_pages = nr_copy_pages;\n\tinfo->pages = snapshot_get_image_size();\n\tinfo->size = info->pages;\n\tinfo->size <<= PAGE_SHIFT;\n\treturn init_header_complete(info);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int nr_copy_pages;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int nr_copy_pages;\n\nstatic int init_header(struct swsusp_info *info)\n{\n\tmemset(info, 0, sizeof(struct swsusp_info));\n\tinfo->num_physpages = get_num_physpages();\n\tinfo->image_pages = nr_copy_pages;\n\tinfo->pages = snapshot_get_image_size();\n\tinfo->size = info->pages;\n\tinfo->size <<= PAGE_SHIFT;\n\treturn init_header_complete(info);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_image_page",
          "args": [
            "GFP_ATOMIC",
            "PG_ANY"
          ],
          "line": 2142
        },
        "resolved": true,
        "details": {
          "function_name": "get_image_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "189-206",
          "snippet": "static void *get_image_page(gfp_t gfp_mask, int safe_needed)\n{\n\tvoid *res;\n\n\tres = (void *)get_zeroed_page(gfp_mask);\n\tif (safe_needed)\n\t\twhile (res && swsusp_page_is_free(virt_to_page(res))) {\n\t\t\t/* The page is unsafe, mark it for swsusp_free() */\n\t\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\t\tallocated_unsafe_pages++;\n\t\t\tres = (void *)get_zeroed_page(gfp_mask);\n\t\t}\n\tif (res) {\n\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\tswsusp_set_page_free(virt_to_page(res));\n\t}\n\treturn res;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static unsigned int allocated_unsafe_pages;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic unsigned int allocated_unsafe_pages;\n\nstatic void *get_image_page(gfp_t gfp_mask, int safe_needed)\n{\n\tvoid *res;\n\n\tres = (void *)get_zeroed_page(gfp_mask);\n\tif (safe_needed)\n\t\twhile (res && swsusp_page_is_free(virt_to_page(res))) {\n\t\t\t/* The page is unsafe, mark it for swsusp_free() */\n\t\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\t\tallocated_unsafe_pages++;\n\t\t\tres = (void *)get_zeroed_page(gfp_mask);\n\t\t}\n\tif (res) {\n\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\tswsusp_set_page_free(virt_to_page(res));\n\t}\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_ANY\t\t0\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic void *buffer;\nstatic unsigned int nr_copy_pages;\nstatic unsigned int nr_meta_pages;\nstatic struct memory_bitmap orig_bm;\nstatic struct memory_bitmap copy_bm;\n\nint snapshot_read_next(struct snapshot_handle *handle)\n{\n\tif (handle->cur > nr_meta_pages + nr_copy_pages)\n\t\treturn 0;\n\n\tif (!buffer) {\n\t\t/* This makes the buffer be freed by swsusp_free() */\n\t\tbuffer = get_image_page(GFP_ATOMIC, PG_ANY);\n\t\tif (!buffer)\n\t\t\treturn -ENOMEM;\n\t}\n\tif (!handle->cur) {\n\t\tint error;\n\n\t\terror = init_header((struct swsusp_info *)buffer);\n\t\tif (error)\n\t\t\treturn error;\n\t\thandle->buffer = buffer;\n\t\tmemory_bm_position_reset(&orig_bm);\n\t\tmemory_bm_position_reset(&copy_bm);\n\t} else if (handle->cur <= nr_meta_pages) {\n\t\tclear_page(buffer);\n\t\tpack_pfns(buffer, &orig_bm);\n\t} else {\n\t\tstruct page *page;\n\n\t\tpage = pfn_to_page(memory_bm_next_pfn(&copy_bm));\n\t\tif (PageHighMem(page)) {\n\t\t\t/*\n\t\t\t * Highmem pages are copied to the buffer,\n\t\t\t * because we can't return with a kmapped\n\t\t\t * highmem page (we may not be called again).\n\t\t\t */\n\t\t\tvoid *kaddr;\n\n\t\t\tkaddr = kmap_atomic(page);\n\t\t\tcopy_page(buffer, kaddr);\n\t\t\tkunmap_atomic(kaddr);\n\t\t\thandle->buffer = buffer;\n\t\t} else {\n\t\t\thandle->buffer = page_address(page);\n\t\t}\n\t}\n\thandle->cur++;\n\treturn PAGE_SIZE;\n}"
  },
  {
    "function_name": "pack_pfns",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2108-2117",
    "snippet": "static inline void pack_pfns(unsigned long *buf, struct memory_bitmap *bm)\n{\n\tint j;\n\n\tfor (j = 0; j < PAGE_SIZE / sizeof(long); j++) {\n\t\tbuf[j] = memory_bm_next_pfn(bm);\n\t\tif (unlikely(buf[j] == BM_END_OF_MAP))\n\t\t\tbreak;\n\t}\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define BM_END_OF_MAP\t(~0UL)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "buf[j] == BM_END_OF_MAP"
          ],
          "line": 2114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_bm_next_pfn",
          "args": [
            "bm"
          ],
          "line": 2113
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_next_pfn",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "915-933",
          "snippet": "static unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)",
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)\n#define BM_END_OF_MAP\t(~0UL)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic inline void pack_pfns(unsigned long *buf, struct memory_bitmap *bm)\n{\n\tint j;\n\n\tfor (j = 0; j < PAGE_SIZE / sizeof(long); j++) {\n\t\tbuf[j] = memory_bm_next_pfn(bm);\n\t\tif (unlikely(buf[j] == BM_END_OF_MAP))\n\t\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "init_header",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2089-2098",
    "snippet": "static int init_header(struct swsusp_info *info)\n{\n\tmemset(info, 0, sizeof(struct swsusp_info));\n\tinfo->num_physpages = get_num_physpages();\n\tinfo->image_pages = nr_copy_pages;\n\tinfo->pages = snapshot_get_image_size();\n\tinfo->size = info->pages;\n\tinfo->size <<= PAGE_SHIFT;\n\treturn init_header_complete(info);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int nr_copy_pages;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "init_header_complete",
          "args": [
            "info"
          ],
          "line": 2097
        },
        "resolved": true,
        "details": {
          "function_name": "init_header_complete",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2061-2066",
          "snippet": "static int init_header_complete(struct swsusp_info *info)\n{\n\tmemcpy(&info->uts, init_utsname(), sizeof(struct new_utsname));\n\tinfo->version_code = LINUX_VERSION_CODE;\n\treturn 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int init_header_complete(struct swsusp_info *info)\n{\n\tmemcpy(&info->uts, init_utsname(), sizeof(struct new_utsname));\n\tinfo->version_code = LINUX_VERSION_CODE;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snapshot_get_image_size",
          "args": [],
          "line": 2094
        },
        "resolved": true,
        "details": {
          "function_name": "snapshot_get_image_size",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "2084-2087",
          "snippet": "unsigned long snapshot_get_image_size(void)\n{\n\treturn nr_copy_pages + nr_meta_pages + 1;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int nr_copy_pages;",
            "static unsigned int nr_meta_pages;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int nr_copy_pages;\nstatic unsigned int nr_meta_pages;\n\nunsigned long snapshot_get_image_size(void)\n{\n\treturn nr_copy_pages + nr_meta_pages + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_num_physpages",
          "args": [],
          "line": 2092
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "info",
            "0",
            "sizeof(struct swsusp_info)"
          ],
          "line": 2091
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int nr_copy_pages;\n\nstatic int init_header(struct swsusp_info *info)\n{\n\tmemset(info, 0, sizeof(struct swsusp_info));\n\tinfo->num_physpages = get_num_physpages();\n\tinfo->image_pages = nr_copy_pages;\n\tinfo->pages = snapshot_get_image_size();\n\tinfo->size = info->pages;\n\tinfo->size <<= PAGE_SHIFT;\n\treturn init_header_complete(info);\n}"
  },
  {
    "function_name": "snapshot_get_image_size",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2084-2087",
    "snippet": "unsigned long snapshot_get_image_size(void)\n{\n\treturn nr_copy_pages + nr_meta_pages + 1;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int nr_copy_pages;",
      "static unsigned int nr_meta_pages;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int nr_copy_pages;\nstatic unsigned int nr_meta_pages;\n\nunsigned long snapshot_get_image_size(void)\n{\n\treturn nr_copy_pages + nr_meta_pages + 1;\n}"
  },
  {
    "function_name": "check_image_kernel",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2068-2081",
    "snippet": "static const char *check_image_kernel(struct swsusp_info *info)\n{\n\tif (info->version_code != LINUX_VERSION_CODE)\n\t\treturn \"kernel version\";\n\tif (strcmp(info->uts.sysname,init_utsname()->sysname))\n\t\treturn \"system type\";\n\tif (strcmp(info->uts.release,init_utsname()->release))\n\t\treturn \"kernel release\";\n\tif (strcmp(info->uts.version,init_utsname()->version))\n\t\treturn \"version\";\n\tif (strcmp(info->uts.machine,init_utsname()->machine))\n\t\treturn \"machine\";\n\treturn NULL;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "info->uts.machine",
            "init_utsname()->machine"
          ],
          "line": 2078
        },
        "resolved": true,
        "details": {
          "function_name": "sym_strcmp",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/kcsan/report.c",
          "lines": "356-365",
          "snippet": "static int sym_strcmp(void *addr1, void *addr2)\n{\n\tchar buf1[64];\n\tchar buf2[64];\n\n\tsnprintf(buf1, sizeof(buf1), \"%pS\", addr1);\n\tsnprintf(buf2, sizeof(buf2), \"%pS\", addr2);\n\n\treturn strncmp(buf1, buf2, sizeof(buf1));\n}",
          "includes": [
            "#include \"encoding.h\"",
            "#include \"kcsan.h\"",
            "#include <linux/stacktrace.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/preempt.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/delay.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"encoding.h\"\n#include \"kcsan.h\"\n#include <linux/stacktrace.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/preempt.h>\n#include <linux/lockdep.h>\n#include <linux/kernel.h>\n#include <linux/kallsyms.h>\n#include <linux/jiffies.h>\n#include <linux/delay.h>\n#include <linux/debug_locks.h>\n\nstatic int sym_strcmp(void *addr1, void *addr2)\n{\n\tchar buf1[64];\n\tchar buf2[64];\n\n\tsnprintf(buf1, sizeof(buf1), \"%pS\", addr1);\n\tsnprintf(buf2, sizeof(buf2), \"%pS\", addr2);\n\n\treturn strncmp(buf1, buf2, sizeof(buf1));\n}"
        }
      },
      {
        "call_info": {
          "callee": "init_utsname",
          "args": [],
          "line": 2078
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_utsname",
          "args": [],
          "line": 2076
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_utsname",
          "args": [],
          "line": 2074
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_utsname",
          "args": [],
          "line": 2072
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic const char *check_image_kernel(struct swsusp_info *info)\n{\n\tif (info->version_code != LINUX_VERSION_CODE)\n\t\treturn \"kernel version\";\n\tif (strcmp(info->uts.sysname,init_utsname()->sysname))\n\t\treturn \"system type\";\n\tif (strcmp(info->uts.release,init_utsname()->release))\n\t\treturn \"kernel release\";\n\tif (strcmp(info->uts.version,init_utsname()->version))\n\t\treturn \"version\";\n\tif (strcmp(info->uts.machine,init_utsname()->machine))\n\t\treturn \"machine\";\n\treturn NULL;\n}"
  },
  {
    "function_name": "init_header_complete",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2061-2066",
    "snippet": "static int init_header_complete(struct swsusp_info *info)\n{\n\tmemcpy(&info->uts, init_utsname(), sizeof(struct new_utsname));\n\tinfo->version_code = LINUX_VERSION_CODE;\n\treturn 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&info->uts",
            "init_utsname()",
            "sizeof(struct new_utsname)"
          ],
          "line": 2063
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy_skip",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/events/internal.h",
          "lines": "180-184",
          "snippet": "static inline unsigned long\nmemcpy_skip(void *dst, const void *src, unsigned long n)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/refcount.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hardirq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/refcount.h>\n#include <linux/uaccess.h>\n#include <linux/hardirq.h>\n\nstatic inline unsigned long\nmemcpy_skip(void *dst, const void *src, unsigned long n)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "init_utsname",
          "args": [],
          "line": 2063
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int init_header_complete(struct swsusp_info *info)\n{\n\tmemcpy(&info->uts, init_utsname(), sizeof(struct new_utsname));\n\tinfo->version_code = LINUX_VERSION_CODE;\n\treturn 0;\n}"
  },
  {
    "function_name": "swsusp_save",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "2017-2058",
    "snippet": "int swsusp_save(void)\n{\n\tunsigned int nr_pages, nr_highmem;\n\n\tpr_info(\"Creating image:\\n\");\n\n\tdrain_local_pages(NULL);\n\tnr_pages = count_data_pages();\n\tnr_highmem = count_highmem_pages();\n\tpr_info(\"Need to copy %u pages\\n\", nr_pages + nr_highmem);\n\n\tif (!enough_free_mem(nr_pages, nr_highmem)) {\n\t\tpr_err(\"Not enough free memory\\n\");\n\t\treturn -ENOMEM;\n\t}\n\n\tif (swsusp_alloc(&copy_bm, nr_pages, nr_highmem)) {\n\t\tpr_err(\"Memory allocation failed\\n\");\n\t\treturn -ENOMEM;\n\t}\n\n\t/*\n\t * During allocating of suspend pagedir, new cold pages may appear.\n\t * Kill them.\n\t */\n\tdrain_local_pages(NULL);\n\tcopy_data_pages(&copy_bm, &orig_bm);\n\n\t/*\n\t * End of critical section. From now on, we can write to memory,\n\t * but we should not touch disk. This specially means we must _not_\n\t * touch swap space! Except we must write out our image of course.\n\t */\n\n\tnr_pages += nr_highmem;\n\tnr_copy_pages = nr_pages;\n\tnr_meta_pages = DIV_ROUND_UP(nr_pages * sizeof(long), PAGE_SIZE);\n\n\tpr_info(\"Image created (%d pages copied)\\n\", nr_pages);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int nr_copy_pages;",
      "static unsigned int nr_meta_pages;",
      "static struct memory_bitmap orig_bm;",
      "static struct memory_bitmap copy_bm;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Image created (%d pages copied)\\n\"",
            "nr_pages"
          ],
          "line": 2055
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "nr_pages * sizeof(long)",
            "PAGE_SIZE"
          ],
          "line": 2053
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_data_pages",
          "args": [
            "&copy_bm",
            "&orig_bm"
          ],
          "line": 2043
        },
        "resolved": true,
        "details": {
          "function_name": "copy_data_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1451-1474",
          "snippet": "static void copy_data_pages(struct memory_bitmap *copy_bm,\n\t\t\t    struct memory_bitmap *orig_bm)\n{\n\tstruct zone *zone;\n\tunsigned long pfn;\n\n\tfor_each_populated_zone(zone) {\n\t\tunsigned long max_zone_pfn;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (page_is_saveable(zone, pfn))\n\t\t\t\tmemory_bm_set_bit(orig_bm, pfn);\n\t}\n\tmemory_bm_position_reset(orig_bm);\n\tmemory_bm_position_reset(copy_bm);\n\tfor(;;) {\n\t\tpfn = memory_bm_next_pfn(orig_bm);\n\t\tif (unlikely(pfn == BM_END_OF_MAP))\n\t\t\tbreak;\n\t\tcopy_data_page(memory_bm_next_pfn(copy_bm), pfn);\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "static struct memory_bitmap orig_bm;",
            "static struct memory_bitmap copy_bm;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic struct memory_bitmap orig_bm;\nstatic struct memory_bitmap copy_bm;\n\nstatic void copy_data_pages(struct memory_bitmap *copy_bm,\n\t\t\t    struct memory_bitmap *orig_bm)\n{\n\tstruct zone *zone;\n\tunsigned long pfn;\n\n\tfor_each_populated_zone(zone) {\n\t\tunsigned long max_zone_pfn;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (page_is_saveable(zone, pfn))\n\t\t\t\tmemory_bm_set_bit(orig_bm, pfn);\n\t}\n\tmemory_bm_position_reset(orig_bm);\n\tmemory_bm_position_reset(copy_bm);\n\tfor(;;) {\n\t\tpfn = memory_bm_next_pfn(orig_bm);\n\t\tif (unlikely(pfn == BM_END_OF_MAP))\n\t\t\tbreak;\n\t\tcopy_data_page(memory_bm_next_pfn(copy_bm), pfn);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "drain_local_pages",
          "args": [
            "NULL"
          ],
          "line": 2042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Memory allocation failed\\n\""
          ],
          "line": 2034
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swsusp_alloc",
          "args": [
            "&copy_bm",
            "nr_pages",
            "nr_highmem"
          ],
          "line": 2033
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_alloc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1987-2015",
          "snippet": "static int swsusp_alloc(struct memory_bitmap *copy_bm,\n\t\t\tunsigned int nr_pages, unsigned int nr_highmem)\n{\n\tif (nr_highmem > 0) {\n\t\tif (get_highmem_buffer(PG_ANY))\n\t\t\tgoto err_out;\n\t\tif (nr_highmem > alloc_highmem) {\n\t\t\tnr_highmem -= alloc_highmem;\n\t\t\tnr_pages += alloc_highmem_pages(copy_bm, nr_highmem);\n\t\t}\n\t}\n\tif (nr_pages > alloc_normal) {\n\t\tnr_pages -= alloc_normal;\n\t\twhile (nr_pages-- > 0) {\n\t\t\tstruct page *page;\n\n\t\t\tpage = alloc_image_page(GFP_ATOMIC);\n\t\t\tif (!page)\n\t\t\t\tgoto err_out;\n\t\t\tmemory_bm_set_bit(copy_bm, page_to_pfn(page));\n\t\t}\n\t}\n\n\treturn 0;\n\n err_out:\n\tswsusp_free();\n\treturn -ENOMEM;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define PG_ANY\t\t0"
          ],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static unsigned int alloc_normal, alloc_highmem;",
            "static struct memory_bitmap copy_bm;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_ANY\t\t0\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic unsigned int alloc_normal, alloc_highmem;\nstatic struct memory_bitmap copy_bm;\n\nstatic int swsusp_alloc(struct memory_bitmap *copy_bm,\n\t\t\tunsigned int nr_pages, unsigned int nr_highmem)\n{\n\tif (nr_highmem > 0) {\n\t\tif (get_highmem_buffer(PG_ANY))\n\t\t\tgoto err_out;\n\t\tif (nr_highmem > alloc_highmem) {\n\t\t\tnr_highmem -= alloc_highmem;\n\t\t\tnr_pages += alloc_highmem_pages(copy_bm, nr_highmem);\n\t\t}\n\t}\n\tif (nr_pages > alloc_normal) {\n\t\tnr_pages -= alloc_normal;\n\t\twhile (nr_pages-- > 0) {\n\t\t\tstruct page *page;\n\n\t\t\tpage = alloc_image_page(GFP_ATOMIC);\n\t\t\tif (!page)\n\t\t\t\tgoto err_out;\n\t\t\tmemory_bm_set_bit(copy_bm, page_to_pfn(page));\n\t\t}\n\t}\n\n\treturn 0;\n\n err_out:\n\tswsusp_free();\n\treturn -ENOMEM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Not enough free memory\\n\""
          ],
          "line": 2029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "enough_free_mem",
          "args": [
            "nr_pages",
            "nr_highmem"
          ],
          "line": 2028
        },
        "resolved": true,
        "details": {
          "function_name": "enough_free_mem",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1917-1931",
          "snippet": "static int enough_free_mem(unsigned int nr_pages, unsigned int nr_highmem)\n{\n\tstruct zone *zone;\n\tunsigned int free = alloc_normal;\n\n\tfor_each_populated_zone(zone)\n\t\tif (!is_highmem(zone))\n\t\t\tfree += zone_page_state(zone, NR_FREE_PAGES);\n\n\tnr_pages += count_pages_for_highmem(nr_highmem);\n\tpr_debug(\"Normal pages needed: %u + %u, available pages: %u\\n\",\n\t\t nr_pages, PAGES_FOR_IO, free);\n\n\treturn free > nr_pages + PAGES_FOR_IO;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int enough_free_mem(unsigned int nr_pages, unsigned int nr_highmem)\n{\n\tstruct zone *zone;\n\tunsigned int free = alloc_normal;\n\n\tfor_each_populated_zone(zone)\n\t\tif (!is_highmem(zone))\n\t\t\tfree += zone_page_state(zone, NR_FREE_PAGES);\n\n\tnr_pages += count_pages_for_highmem(nr_highmem);\n\tpr_debug(\"Normal pages needed: %u + %u, available pages: %u\\n\",\n\t\t nr_pages, PAGES_FOR_IO, free);\n\n\treturn free > nr_pages + PAGES_FOR_IO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Need to copy %u pages\\n\"",
            "nr_pages + nr_highmem"
          ],
          "line": 2026
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "count_highmem_pages",
          "args": [],
          "line": 2025
        },
        "resolved": true,
        "details": {
          "function_name": "count_highmem_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1288-1306",
          "snippet": "static unsigned int count_highmem_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned int n = 0;\n\n\tfor_each_populated_zone(zone) {\n\t\tunsigned long pfn, max_zone_pfn;\n\n\t\tif (!is_highmem(zone))\n\t\t\tcontinue;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (saveable_highmem_page(zone, pfn))\n\t\t\t\tn++;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int count_highmem_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned int n = 0;\n\n\tfor_each_populated_zone(zone) {\n\t\tunsigned long pfn, max_zone_pfn;\n\n\t\tif (!is_highmem(zone))\n\t\t\tcontinue;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (saveable_highmem_page(zone, pfn))\n\t\t\t\tn++;\n\t}\n\treturn n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "count_data_pages",
          "args": [],
          "line": 2024
        },
        "resolved": true,
        "details": {
          "function_name": "count_data_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1356-1373",
          "snippet": "static unsigned int count_data_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned long pfn, max_zone_pfn;\n\tunsigned int n = 0;\n\n\tfor_each_populated_zone(zone) {\n\t\tif (is_highmem(zone))\n\t\t\tcontinue;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (saveable_page(zone, pfn))\n\t\t\t\tn++;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int count_data_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned long pfn, max_zone_pfn;\n\tunsigned int n = 0;\n\n\tfor_each_populated_zone(zone) {\n\t\tif (is_highmem(zone))\n\t\t\tcontinue;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (saveable_page(zone, pfn))\n\t\t\t\tn++;\n\t}\n\treturn n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "drain_local_pages",
          "args": [
            "NULL"
          ],
          "line": 2023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Creating image:\\n\""
          ],
          "line": 2021
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int nr_copy_pages;\nstatic unsigned int nr_meta_pages;\nstatic struct memory_bitmap orig_bm;\nstatic struct memory_bitmap copy_bm;\n\nint swsusp_save(void)\n{\n\tunsigned int nr_pages, nr_highmem;\n\n\tpr_info(\"Creating image:\\n\");\n\n\tdrain_local_pages(NULL);\n\tnr_pages = count_data_pages();\n\tnr_highmem = count_highmem_pages();\n\tpr_info(\"Need to copy %u pages\\n\", nr_pages + nr_highmem);\n\n\tif (!enough_free_mem(nr_pages, nr_highmem)) {\n\t\tpr_err(\"Not enough free memory\\n\");\n\t\treturn -ENOMEM;\n\t}\n\n\tif (swsusp_alloc(&copy_bm, nr_pages, nr_highmem)) {\n\t\tpr_err(\"Memory allocation failed\\n\");\n\t\treturn -ENOMEM;\n\t}\n\n\t/*\n\t * During allocating of suspend pagedir, new cold pages may appear.\n\t * Kill them.\n\t */\n\tdrain_local_pages(NULL);\n\tcopy_data_pages(&copy_bm, &orig_bm);\n\n\t/*\n\t * End of critical section. From now on, we can write to memory,\n\t * but we should not touch disk. This specially means we must _not_\n\t * touch swap space! Except we must write out our image of course.\n\t */\n\n\tnr_pages += nr_highmem;\n\tnr_copy_pages = nr_pages;\n\tnr_meta_pages = DIV_ROUND_UP(nr_pages * sizeof(long), PAGE_SIZE);\n\n\tpr_info(\"Image created (%d pages copied)\\n\", nr_pages);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "swsusp_alloc",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1987-2015",
    "snippet": "static int swsusp_alloc(struct memory_bitmap *copy_bm,\n\t\t\tunsigned int nr_pages, unsigned int nr_highmem)\n{\n\tif (nr_highmem > 0) {\n\t\tif (get_highmem_buffer(PG_ANY))\n\t\t\tgoto err_out;\n\t\tif (nr_highmem > alloc_highmem) {\n\t\t\tnr_highmem -= alloc_highmem;\n\t\t\tnr_pages += alloc_highmem_pages(copy_bm, nr_highmem);\n\t\t}\n\t}\n\tif (nr_pages > alloc_normal) {\n\t\tnr_pages -= alloc_normal;\n\t\twhile (nr_pages-- > 0) {\n\t\t\tstruct page *page;\n\n\t\t\tpage = alloc_image_page(GFP_ATOMIC);\n\t\t\tif (!page)\n\t\t\t\tgoto err_out;\n\t\t\tmemory_bm_set_bit(copy_bm, page_to_pfn(page));\n\t\t}\n\t}\n\n\treturn 0;\n\n err_out:\n\tswsusp_free();\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define PG_ANY\t\t0"
    ],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);",
      "static unsigned int alloc_normal, alloc_highmem;",
      "static struct memory_bitmap copy_bm;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "swsusp_free",
          "args": [],
          "line": 2013
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1506-1549",
          "snippet": "void swsusp_free(void)\n{\n\tunsigned long fb_pfn, fr_pfn;\n\n\tif (!forbidden_pages_map || !free_pages_map)\n\t\tgoto out;\n\n\tmemory_bm_position_reset(forbidden_pages_map);\n\tmemory_bm_position_reset(free_pages_map);\n\nloop:\n\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\n\t/*\n\t * Find the next bit set in both bitmaps. This is guaranteed to\n\t * terminate when fb_pfn == fr_pfn == BM_END_OF_MAP.\n\t */\n\tdo {\n\t\tif (fb_pfn < fr_pfn)\n\t\t\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\t\tif (fr_pfn < fb_pfn)\n\t\t\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\t} while (fb_pfn != fr_pfn);\n\n\tif (fr_pfn != BM_END_OF_MAP && pfn_valid(fr_pfn)) {\n\t\tstruct page *page = pfn_to_page(fr_pfn);\n\n\t\tmemory_bm_clear_current(forbidden_pages_map);\n\t\tmemory_bm_clear_current(free_pages_map);\n\t\thibernate_restore_unprotect_page(page_address(page));\n\t\t__free_page(page);\n\t\tgoto loop;\n\t}\n\nout:\n\tnr_copy_pages = 0;\n\tnr_meta_pages = 0;\n\trestore_pblist = NULL;\n\tbuffer = NULL;\n\talloc_normal = 0;\n\talloc_highmem = 0;\n\thibernate_restore_protection_end();\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "struct pbe *restore_pblist;",
            "static void *buffer;",
            "static struct memory_bitmap *forbidden_pages_map;",
            "static struct memory_bitmap *free_pages_map;",
            "static unsigned int nr_copy_pages;",
            "static unsigned int nr_meta_pages;",
            "static unsigned int alloc_normal, alloc_highmem;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstruct pbe *restore_pblist;\nstatic void *buffer;\nstatic struct memory_bitmap *forbidden_pages_map;\nstatic struct memory_bitmap *free_pages_map;\nstatic unsigned int nr_copy_pages;\nstatic unsigned int nr_meta_pages;\nstatic unsigned int alloc_normal, alloc_highmem;\n\nvoid swsusp_free(void)\n{\n\tunsigned long fb_pfn, fr_pfn;\n\n\tif (!forbidden_pages_map || !free_pages_map)\n\t\tgoto out;\n\n\tmemory_bm_position_reset(forbidden_pages_map);\n\tmemory_bm_position_reset(free_pages_map);\n\nloop:\n\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\n\t/*\n\t * Find the next bit set in both bitmaps. This is guaranteed to\n\t * terminate when fb_pfn == fr_pfn == BM_END_OF_MAP.\n\t */\n\tdo {\n\t\tif (fb_pfn < fr_pfn)\n\t\t\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\t\tif (fr_pfn < fb_pfn)\n\t\t\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\t} while (fb_pfn != fr_pfn);\n\n\tif (fr_pfn != BM_END_OF_MAP && pfn_valid(fr_pfn)) {\n\t\tstruct page *page = pfn_to_page(fr_pfn);\n\n\t\tmemory_bm_clear_current(forbidden_pages_map);\n\t\tmemory_bm_clear_current(free_pages_map);\n\t\thibernate_restore_unprotect_page(page_address(page));\n\t\t__free_page(page);\n\t\tgoto loop;\n\t}\n\nout:\n\tnr_copy_pages = 0;\n\tnr_meta_pages = 0;\n\trestore_pblist = NULL;\n\tbuffer = NULL;\n\talloc_normal = 0;\n\talloc_highmem = 0;\n\thibernate_restore_protection_end();\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_set_bit",
          "args": [
            "copy_bm",
            "page_to_pfn(page)"
          ],
          "line": 2006
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_set_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "806-815",
          "snippet": "static void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_to_pfn",
          "args": [
            "page"
          ],
          "line": 2006
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_image_page",
          "args": [
            "GFP_ATOMIC"
          ],
          "line": 2003
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_image_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "225-235",
          "snippet": "static struct page *alloc_image_page(gfp_t gfp_mask)\n{\n\tstruct page *page;\n\n\tpage = alloc_page(gfp_mask);\n\tif (page) {\n\t\tswsusp_set_page_forbidden(page);\n\t\tswsusp_set_page_free(page);\n\t}\n\treturn page;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic struct page *alloc_image_page(gfp_t gfp_mask)\n{\n\tstruct page *page;\n\n\tpage = alloc_page(gfp_mask);\n\tif (page) {\n\t\tswsusp_set_page_forbidden(page);\n\t\tswsusp_set_page_free(page);\n\t}\n\treturn page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "alloc_highmem_pages",
          "args": [
            "copy_bm",
            "nr_highmem"
          ],
          "line": 1995
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_highmem_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1972-1973",
          "snippet": "static inline unsigned int alloc_highmem_pages(struct memory_bitmap *bm,\n\t\t\t\t\t       unsigned int n) { return 0; }",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline unsigned int alloc_highmem_pages(struct memory_bitmap *bm,\n\t\t\t\t\t       unsigned int n) { return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "get_highmem_buffer",
          "args": [
            "PG_ANY"
          ],
          "line": 1991
        },
        "resolved": true,
        "details": {
          "function_name": "get_highmem_buffer",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1970-1970",
          "snippet": "static inline int get_highmem_buffer(int safe_needed) { return 0; }",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline int get_highmem_buffer(int safe_needed) { return 0; }"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_ANY\t\t0\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic unsigned int alloc_normal, alloc_highmem;\nstatic struct memory_bitmap copy_bm;\n\nstatic int swsusp_alloc(struct memory_bitmap *copy_bm,\n\t\t\tunsigned int nr_pages, unsigned int nr_highmem)\n{\n\tif (nr_highmem > 0) {\n\t\tif (get_highmem_buffer(PG_ANY))\n\t\t\tgoto err_out;\n\t\tif (nr_highmem > alloc_highmem) {\n\t\t\tnr_highmem -= alloc_highmem;\n\t\t\tnr_pages += alloc_highmem_pages(copy_bm, nr_highmem);\n\t\t}\n\t}\n\tif (nr_pages > alloc_normal) {\n\t\tnr_pages -= alloc_normal;\n\t\twhile (nr_pages-- > 0) {\n\t\t\tstruct page *page;\n\n\t\t\tpage = alloc_image_page(GFP_ATOMIC);\n\t\t\tif (!page)\n\t\t\t\tgoto err_out;\n\t\t\tmemory_bm_set_bit(copy_bm, page_to_pfn(page));\n\t\t}\n\t}\n\n\treturn 0;\n\n err_out:\n\tswsusp_free();\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "alloc_highmem_pages",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1972-1973",
    "snippet": "static inline unsigned int alloc_highmem_pages(struct memory_bitmap *bm,\n\t\t\t\t\t       unsigned int n) { return 0; }",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline unsigned int alloc_highmem_pages(struct memory_bitmap *bm,\n\t\t\t\t\t       unsigned int n) { return 0; }"
  },
  {
    "function_name": "get_highmem_buffer",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1970-1970",
    "snippet": "static inline int get_highmem_buffer(int safe_needed) { return 0; }",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline int get_highmem_buffer(int safe_needed) { return 0; }"
  },
  {
    "function_name": "alloc_highmem_pages",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1952-1968",
    "snippet": "static inline unsigned int alloc_highmem_pages(struct memory_bitmap *bm,\n\t\t\t\t\t       unsigned int nr_highmem)\n{\n\tunsigned int to_alloc = count_free_highmem_pages();\n\n\tif (to_alloc > nr_highmem)\n\t\tto_alloc = nr_highmem;\n\n\tnr_highmem -= to_alloc;\n\twhile (to_alloc-- > 0) {\n\t\tstruct page *page;\n\n\t\tpage = alloc_image_page(__GFP_HIGHMEM|__GFP_KSWAPD_RECLAIM);\n\t\tmemory_bm_set_bit(bm, page_to_pfn(page));\n\t}\n\treturn nr_highmem;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memory_bm_set_bit",
          "args": [
            "bm",
            "page_to_pfn(page)"
          ],
          "line": 1965
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_set_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "806-815",
          "snippet": "static void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_to_pfn",
          "args": [
            "page"
          ],
          "line": 1965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_image_page",
          "args": [
            "__GFP_HIGHMEM|__GFP_KSWAPD_RECLAIM"
          ],
          "line": 1964
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_image_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "225-235",
          "snippet": "static struct page *alloc_image_page(gfp_t gfp_mask)\n{\n\tstruct page *page;\n\n\tpage = alloc_page(gfp_mask);\n\tif (page) {\n\t\tswsusp_set_page_forbidden(page);\n\t\tswsusp_set_page_free(page);\n\t}\n\treturn page;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic struct page *alloc_image_page(gfp_t gfp_mask)\n{\n\tstruct page *page;\n\n\tpage = alloc_page(gfp_mask);\n\tif (page) {\n\t\tswsusp_set_page_forbidden(page);\n\t\tswsusp_set_page_free(page);\n\t}\n\treturn page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "count_free_highmem_pages",
          "args": [],
          "line": 1955
        },
        "resolved": true,
        "details": {
          "function_name": "count_free_highmem_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1240-1250",
          "snippet": "static unsigned int count_free_highmem_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned int cnt = 0;\n\n\tfor_each_populated_zone(zone)\n\t\tif (is_highmem(zone))\n\t\t\tcnt += zone_page_state(zone, NR_FREE_PAGES);\n\n\treturn cnt;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int count_free_highmem_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned int cnt = 0;\n\n\tfor_each_populated_zone(zone)\n\t\tif (is_highmem(zone))\n\t\t\tcnt += zone_page_state(zone, NR_FREE_PAGES);\n\n\treturn cnt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic inline unsigned int alloc_highmem_pages(struct memory_bitmap *bm,\n\t\t\t\t\t       unsigned int nr_highmem)\n{\n\tunsigned int to_alloc = count_free_highmem_pages();\n\n\tif (to_alloc > nr_highmem)\n\t\tto_alloc = nr_highmem;\n\n\tnr_highmem -= to_alloc;\n\twhile (to_alloc-- > 0) {\n\t\tstruct page *page;\n\n\t\tpage = alloc_image_page(__GFP_HIGHMEM|__GFP_KSWAPD_RECLAIM);\n\t\tmemory_bm_set_bit(bm, page_to_pfn(page));\n\t}\n\treturn nr_highmem;\n}"
  },
  {
    "function_name": "get_highmem_buffer",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1940-1944",
    "snippet": "static inline int get_highmem_buffer(int safe_needed)\n{\n\tbuffer = get_image_page(GFP_ATOMIC, safe_needed);\n\treturn buffer ? 0 : -ENOMEM;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void *buffer;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_image_page",
          "args": [
            "GFP_ATOMIC",
            "safe_needed"
          ],
          "line": 1942
        },
        "resolved": true,
        "details": {
          "function_name": "get_image_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "189-206",
          "snippet": "static void *get_image_page(gfp_t gfp_mask, int safe_needed)\n{\n\tvoid *res;\n\n\tres = (void *)get_zeroed_page(gfp_mask);\n\tif (safe_needed)\n\t\twhile (res && swsusp_page_is_free(virt_to_page(res))) {\n\t\t\t/* The page is unsafe, mark it for swsusp_free() */\n\t\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\t\tallocated_unsafe_pages++;\n\t\t\tres = (void *)get_zeroed_page(gfp_mask);\n\t\t}\n\tif (res) {\n\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\tswsusp_set_page_free(virt_to_page(res));\n\t}\n\treturn res;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static unsigned int allocated_unsafe_pages;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic unsigned int allocated_unsafe_pages;\n\nstatic void *get_image_page(gfp_t gfp_mask, int safe_needed)\n{\n\tvoid *res;\n\n\tres = (void *)get_zeroed_page(gfp_mask);\n\tif (safe_needed)\n\t\twhile (res && swsusp_page_is_free(virt_to_page(res))) {\n\t\t\t/* The page is unsafe, mark it for swsusp_free() */\n\t\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\t\tallocated_unsafe_pages++;\n\t\t\tres = (void *)get_zeroed_page(gfp_mask);\n\t\t}\n\tif (res) {\n\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\tswsusp_set_page_free(virt_to_page(res));\n\t}\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void *buffer;\n\nstatic inline int get_highmem_buffer(int safe_needed)\n{\n\tbuffer = get_image_page(GFP_ATOMIC, safe_needed);\n\treturn buffer ? 0 : -ENOMEM;\n}"
  },
  {
    "function_name": "enough_free_mem",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1917-1931",
    "snippet": "static int enough_free_mem(unsigned int nr_pages, unsigned int nr_highmem)\n{\n\tstruct zone *zone;\n\tunsigned int free = alloc_normal;\n\n\tfor_each_populated_zone(zone)\n\t\tif (!is_highmem(zone))\n\t\t\tfree += zone_page_state(zone, NR_FREE_PAGES);\n\n\tnr_pages += count_pages_for_highmem(nr_highmem);\n\tpr_debug(\"Normal pages needed: %u + %u, available pages: %u\\n\",\n\t\t nr_pages, PAGES_FOR_IO, free);\n\n\treturn free > nr_pages + PAGES_FOR_IO;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"Normal pages needed: %u + %u, available pages: %u\\n\"",
            "nr_pages",
            "PAGES_FOR_IO",
            "free"
          ],
          "line": 1927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "count_pages_for_highmem",
          "args": [
            "nr_highmem"
          ],
          "line": 1926
        },
        "resolved": true,
        "details": {
          "function_name": "count_pages_for_highmem",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1911-1911",
          "snippet": "static unsigned int count_pages_for_highmem(unsigned int nr_highmem) { return 0; }",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int count_pages_for_highmem(unsigned int nr_highmem) { return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "zone_page_state",
          "args": [
            "zone",
            "NR_FREE_PAGES"
          ],
          "line": 1924
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int enough_free_mem(unsigned int nr_pages, unsigned int nr_highmem)\n{\n\tstruct zone *zone;\n\tunsigned int free = alloc_normal;\n\n\tfor_each_populated_zone(zone)\n\t\tif (!is_highmem(zone))\n\t\t\tfree += zone_page_state(zone, NR_FREE_PAGES);\n\n\tnr_pages += count_pages_for_highmem(nr_highmem);\n\tpr_debug(\"Normal pages needed: %u + %u, available pages: %u\\n\",\n\t\t nr_pages, PAGES_FOR_IO, free);\n\n\treturn free > nr_pages + PAGES_FOR_IO;\n}"
  },
  {
    "function_name": "count_pages_for_highmem",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1911-1911",
    "snippet": "static unsigned int count_pages_for_highmem(unsigned int nr_highmem) { return 0; }",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int count_pages_for_highmem(unsigned int nr_highmem) { return 0; }"
  },
  {
    "function_name": "count_pages_for_highmem",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1899-1909",
    "snippet": "static unsigned int count_pages_for_highmem(unsigned int nr_highmem)\n{\n\tunsigned int free_highmem = count_free_highmem_pages() + alloc_highmem;\n\n\tif (free_highmem >= nr_highmem)\n\t\tnr_highmem = 0;\n\telse\n\t\tnr_highmem -= free_highmem;\n\n\treturn nr_highmem;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int alloc_normal, alloc_highmem;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "count_free_highmem_pages",
          "args": [],
          "line": 1901
        },
        "resolved": true,
        "details": {
          "function_name": "count_free_highmem_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1240-1250",
          "snippet": "static unsigned int count_free_highmem_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned int cnt = 0;\n\n\tfor_each_populated_zone(zone)\n\t\tif (is_highmem(zone))\n\t\t\tcnt += zone_page_state(zone, NR_FREE_PAGES);\n\n\treturn cnt;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int count_free_highmem_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned int cnt = 0;\n\n\tfor_each_populated_zone(zone)\n\t\tif (is_highmem(zone))\n\t\t\tcnt += zone_page_state(zone, NR_FREE_PAGES);\n\n\treturn cnt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int alloc_normal, alloc_highmem;\n\nstatic unsigned int count_pages_for_highmem(unsigned int nr_highmem)\n{\n\tunsigned int free_highmem = count_free_highmem_pages() + alloc_highmem;\n\n\tif (free_highmem >= nr_highmem)\n\t\tnr_highmem = 0;\n\telse\n\t\tnr_highmem -= free_highmem;\n\n\treturn nr_highmem;\n}"
  },
  {
    "function_name": "hibernate_preallocate_memory",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1739-1890",
    "snippet": "int hibernate_preallocate_memory(void)\n{\n\tstruct zone *zone;\n\tunsigned long saveable, size, max_size, count, highmem, pages = 0;\n\tunsigned long alloc, save_highmem, pages_highmem, avail_normal;\n\tktime_t start, stop;\n\tint error;\n\n\tpr_info(\"Preallocating image memory\\n\");\n\tstart = ktime_get();\n\n\terror = memory_bm_create(&orig_bm, GFP_IMAGE, PG_ANY);\n\tif (error) {\n\t\tpr_err(\"Cannot allocate original bitmap\\n\");\n\t\tgoto err_out;\n\t}\n\n\terror = memory_bm_create(&copy_bm, GFP_IMAGE, PG_ANY);\n\tif (error) {\n\t\tpr_err(\"Cannot allocate copy bitmap\\n\");\n\t\tgoto err_out;\n\t}\n\n\talloc_normal = 0;\n\talloc_highmem = 0;\n\n\t/* Count the number of saveable data pages. */\n\tsave_highmem = count_highmem_pages();\n\tsaveable = count_data_pages();\n\n\t/*\n\t * Compute the total number of page frames we can use (count) and the\n\t * number of pages needed for image metadata (size).\n\t */\n\tcount = saveable;\n\tsaveable += save_highmem;\n\thighmem = save_highmem;\n\tsize = 0;\n\tfor_each_populated_zone(zone) {\n\t\tsize += snapshot_additional_pages(zone);\n\t\tif (is_highmem(zone))\n\t\t\thighmem += zone_page_state(zone, NR_FREE_PAGES);\n\t\telse\n\t\t\tcount += zone_page_state(zone, NR_FREE_PAGES);\n\t}\n\tavail_normal = count;\n\tcount += highmem;\n\tcount -= totalreserve_pages;\n\n\t/* Compute the maximum number of saveable pages to leave in memory. */\n\tmax_size = (count - (size + PAGES_FOR_IO)) / 2\n\t\t\t- 2 * DIV_ROUND_UP(reserved_size, PAGE_SIZE);\n\t/* Compute the desired number of image pages specified by image_size. */\n\tsize = DIV_ROUND_UP(image_size, PAGE_SIZE);\n\tif (size > max_size)\n\t\tsize = max_size;\n\t/*\n\t * If the desired number of image pages is at least as large as the\n\t * current number of saveable pages in memory, allocate page frames for\n\t * the image and we're done.\n\t */\n\tif (size >= saveable) {\n\t\tpages = preallocate_image_highmem(save_highmem);\n\t\tpages += preallocate_image_memory(saveable - pages, avail_normal);\n\t\tgoto out;\n\t}\n\n\t/* Estimate the minimum size of the image. */\n\tpages = minimum_image_size(saveable);\n\t/*\n\t * To avoid excessive pressure on the normal zone, leave room in it to\n\t * accommodate an image of the minimum size (unless it's already too\n\t * small, in which case don't preallocate pages from it at all).\n\t */\n\tif (avail_normal > pages)\n\t\tavail_normal -= pages;\n\telse\n\t\tavail_normal = 0;\n\tif (size < pages)\n\t\tsize = min_t(unsigned long, pages, max_size);\n\n\t/*\n\t * Let the memory management subsystem know that we're going to need a\n\t * large number of page frames to allocate and make it free some memory.\n\t * NOTE: If this is not done, performance will be hurt badly in some\n\t * test cases.\n\t */\n\tshrink_all_memory(saveable - size);\n\n\t/*\n\t * The number of saveable pages in memory was too high, so apply some\n\t * pressure to decrease it.  First, make room for the largest possible\n\t * image and fail if that doesn't work.  Next, try to decrease the size\n\t * of the image as much as indicated by 'size' using allocations from\n\t * highmem and non-highmem zones separately.\n\t */\n\tpages_highmem = preallocate_image_highmem(highmem / 2);\n\talloc = count - max_size;\n\tif (alloc > pages_highmem)\n\t\talloc -= pages_highmem;\n\telse\n\t\talloc = 0;\n\tpages = preallocate_image_memory(alloc, avail_normal);\n\tif (pages < alloc) {\n\t\t/* We have exhausted non-highmem pages, try highmem. */\n\t\talloc -= pages;\n\t\tpages += pages_highmem;\n\t\tpages_highmem = preallocate_image_highmem(alloc);\n\t\tif (pages_highmem < alloc) {\n\t\t\tpr_err(\"Image allocation is %lu pages short\\n\",\n\t\t\t\talloc - pages_highmem);\n\t\t\tgoto err_out;\n\t\t}\n\t\tpages += pages_highmem;\n\t\t/*\n\t\t * size is the desired number of saveable pages to leave in\n\t\t * memory, so try to preallocate (all memory - size) pages.\n\t\t */\n\t\talloc = (count - pages) - size;\n\t\tpages += preallocate_image_highmem(alloc);\n\t} else {\n\t\t/*\n\t\t * There are approximately max_size saveable pages at this point\n\t\t * and we want to reduce this number down to size.\n\t\t */\n\t\talloc = max_size - size;\n\t\tsize = preallocate_highmem_fraction(alloc, highmem, count);\n\t\tpages_highmem += size;\n\t\talloc -= size;\n\t\tsize = preallocate_image_memory(alloc, avail_normal);\n\t\tpages_highmem += preallocate_image_highmem(alloc - size);\n\t\tpages += pages_highmem + size;\n\t}\n\n\t/*\n\t * We only need as many page frames for the image as there are saveable\n\t * pages in memory, but we have allocated more.  Release the excessive\n\t * ones now.\n\t */\n\tpages -= free_unnecessary_pages();\n\n out:\n\tstop = ktime_get();\n\tpr_info(\"Allocated %lu pages for snapshot\\n\", pages);\n\tswsusp_show_speed(start, stop, pages, \"Allocated\");\n\n\treturn 0;\n\n err_out:\n\tswsusp_free();\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define GFP_IMAGE\t(GFP_KERNEL | __GFP_NOWARN)",
      "#define PG_ANY\t\t0"
    ],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);",
      "unsigned long reserved_size;",
      "unsigned long image_size;",
      "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;",
      "static unsigned int alloc_normal, alloc_highmem;",
      "static struct memory_bitmap orig_bm;",
      "static struct memory_bitmap copy_bm;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "swsusp_free",
          "args": [],
          "line": 1888
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1506-1549",
          "snippet": "void swsusp_free(void)\n{\n\tunsigned long fb_pfn, fr_pfn;\n\n\tif (!forbidden_pages_map || !free_pages_map)\n\t\tgoto out;\n\n\tmemory_bm_position_reset(forbidden_pages_map);\n\tmemory_bm_position_reset(free_pages_map);\n\nloop:\n\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\n\t/*\n\t * Find the next bit set in both bitmaps. This is guaranteed to\n\t * terminate when fb_pfn == fr_pfn == BM_END_OF_MAP.\n\t */\n\tdo {\n\t\tif (fb_pfn < fr_pfn)\n\t\t\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\t\tif (fr_pfn < fb_pfn)\n\t\t\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\t} while (fb_pfn != fr_pfn);\n\n\tif (fr_pfn != BM_END_OF_MAP && pfn_valid(fr_pfn)) {\n\t\tstruct page *page = pfn_to_page(fr_pfn);\n\n\t\tmemory_bm_clear_current(forbidden_pages_map);\n\t\tmemory_bm_clear_current(free_pages_map);\n\t\thibernate_restore_unprotect_page(page_address(page));\n\t\t__free_page(page);\n\t\tgoto loop;\n\t}\n\nout:\n\tnr_copy_pages = 0;\n\tnr_meta_pages = 0;\n\trestore_pblist = NULL;\n\tbuffer = NULL;\n\talloc_normal = 0;\n\talloc_highmem = 0;\n\thibernate_restore_protection_end();\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "struct pbe *restore_pblist;",
            "static void *buffer;",
            "static struct memory_bitmap *forbidden_pages_map;",
            "static struct memory_bitmap *free_pages_map;",
            "static unsigned int nr_copy_pages;",
            "static unsigned int nr_meta_pages;",
            "static unsigned int alloc_normal, alloc_highmem;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstruct pbe *restore_pblist;\nstatic void *buffer;\nstatic struct memory_bitmap *forbidden_pages_map;\nstatic struct memory_bitmap *free_pages_map;\nstatic unsigned int nr_copy_pages;\nstatic unsigned int nr_meta_pages;\nstatic unsigned int alloc_normal, alloc_highmem;\n\nvoid swsusp_free(void)\n{\n\tunsigned long fb_pfn, fr_pfn;\n\n\tif (!forbidden_pages_map || !free_pages_map)\n\t\tgoto out;\n\n\tmemory_bm_position_reset(forbidden_pages_map);\n\tmemory_bm_position_reset(free_pages_map);\n\nloop:\n\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\n\t/*\n\t * Find the next bit set in both bitmaps. This is guaranteed to\n\t * terminate when fb_pfn == fr_pfn == BM_END_OF_MAP.\n\t */\n\tdo {\n\t\tif (fb_pfn < fr_pfn)\n\t\t\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\t\tif (fr_pfn < fb_pfn)\n\t\t\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\t} while (fb_pfn != fr_pfn);\n\n\tif (fr_pfn != BM_END_OF_MAP && pfn_valid(fr_pfn)) {\n\t\tstruct page *page = pfn_to_page(fr_pfn);\n\n\t\tmemory_bm_clear_current(forbidden_pages_map);\n\t\tmemory_bm_clear_current(free_pages_map);\n\t\thibernate_restore_unprotect_page(page_address(page));\n\t\t__free_page(page);\n\t\tgoto loop;\n\t}\n\nout:\n\tnr_copy_pages = 0;\n\tnr_meta_pages = 0;\n\trestore_pblist = NULL;\n\tbuffer = NULL;\n\talloc_normal = 0;\n\talloc_highmem = 0;\n\thibernate_restore_protection_end();\n}"
        }
      },
      {
        "call_info": {
          "callee": "swsusp_show_speed",
          "args": [
            "start",
            "stop",
            "pages",
            "\"Allocated\""
          ],
          "line": 1883
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_show_speed",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/hibernate.c",
          "lines": "254-273",
          "snippet": "void swsusp_show_speed(ktime_t start, ktime_t stop,\n\t\t      unsigned nr_pages, char *msg)\n{\n\tktime_t diff;\n\tu64 elapsed_centisecs64;\n\tunsigned int centisecs;\n\tunsigned int k;\n\tunsigned int kps;\n\n\tdiff = ktime_sub(stop, start);\n\telapsed_centisecs64 = ktime_divns(diff, 10*NSEC_PER_MSEC);\n\tcentisecs = elapsed_centisecs64;\n\tif (centisecs == 0)\n\t\tcentisecs = 1;\t/* avoid div-by-zero */\n\tk = nr_pages * (PAGE_SIZE / 1024);\n\tkps = (k * 100) / centisecs;\n\tpr_info(\"%s %u kbytes in %u.%02u seconds (%u.%02u MB/s)\\n\",\n\t\tmsg, k, centisecs / 100, centisecs % 100, kps / 1000,\n\t\t(kps % 1000) / 10);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <trace/events/power.h>",
            "#include <linux/secretmem.h>",
            "#include <linux/security.h>",
            "#include <linux/ktime.h>",
            "#include <linux/genhd.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/gfp.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/nmi.h>",
            "#include <linux/pm.h>",
            "#include <linux/mount.h>",
            "#include <linux/fs.h>",
            "#include <linux/delay.h>",
            "#include <linux/async.h>",
            "#include <linux/device.h>",
            "#include <linux/string.h>",
            "#include <linux/reboot.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <trace/events/power.h>\n#include <linux/secretmem.h>\n#include <linux/security.h>\n#include <linux/ktime.h>\n#include <linux/genhd.h>\n#include <linux/ctype.h>\n#include <linux/syscore_ops.h>\n#include <linux/gfp.h>\n#include <linux/freezer.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/nmi.h>\n#include <linux/pm.h>\n#include <linux/mount.h>\n#include <linux/fs.h>\n#include <linux/delay.h>\n#include <linux/async.h>\n#include <linux/device.h>\n#include <linux/string.h>\n#include <linux/reboot.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n\nvoid swsusp_show_speed(ktime_t start, ktime_t stop,\n\t\t      unsigned nr_pages, char *msg)\n{\n\tktime_t diff;\n\tu64 elapsed_centisecs64;\n\tunsigned int centisecs;\n\tunsigned int k;\n\tunsigned int kps;\n\n\tdiff = ktime_sub(stop, start);\n\telapsed_centisecs64 = ktime_divns(diff, 10*NSEC_PER_MSEC);\n\tcentisecs = elapsed_centisecs64;\n\tif (centisecs == 0)\n\t\tcentisecs = 1;\t/* avoid div-by-zero */\n\tk = nr_pages * (PAGE_SIZE / 1024);\n\tkps = (k * 100) / centisecs;\n\tpr_info(\"%s %u kbytes in %u.%02u seconds (%u.%02u MB/s)\\n\",\n\t\tmsg, k, centisecs / 100, centisecs % 100, kps / 1000,\n\t\t(kps % 1000) / 10);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Allocated %lu pages for snapshot\\n\"",
            "pages"
          ],
          "line": 1882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_get",
          "args": [],
          "line": 1881
        },
        "resolved": true,
        "details": {
          "function_name": "__ktime_get_real_seconds",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/timekeeping.c",
          "lines": "1025-1030",
          "snippet": "noinstr time64_t __ktime_get_real_seconds(void)\n{\n\tstruct timekeeper *tk = &tk_core.timekeeper;\n\n\treturn tk->xtime_sec;\n}",
          "includes": [
            "#include \"timekeeping_internal.h\"",
            "#include \"ntp_internal.h\"",
            "#include \"tick-internal.h\"",
            "#include <linux/audit.h>",
            "#include <linux/compiler.h>",
            "#include <linux/pvclock_gtod.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/tick.h>",
            "#include <linux/time.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched.h>",
            "#include <linux/nmi.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/timekeeper_internal.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping_internal.h\"\n#include \"ntp_internal.h\"\n#include \"tick-internal.h\"\n#include <linux/audit.h>\n#include <linux/compiler.h>\n#include <linux/pvclock_gtod.h>\n#include <linux/stop_machine.h>\n#include <linux/tick.h>\n#include <linux/time.h>\n#include <linux/jiffies.h>\n#include <linux/clocksource.h>\n#include <linux/syscore_ops.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched.h>\n#include <linux/nmi.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/timekeeper_internal.h>\n\nnoinstr time64_t __ktime_get_real_seconds(void)\n{\n\tstruct timekeeper *tk = &tk_core.timekeeper;\n\n\treturn tk->xtime_sec;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_unnecessary_pages",
          "args": [],
          "line": 1878
        },
        "resolved": true,
        "details": {
          "function_name": "free_unnecessary_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1638-1687",
          "snippet": "static unsigned long free_unnecessary_pages(void)\n{\n\tunsigned long save, to_free_normal, to_free_highmem, free;\n\n\tsave = count_data_pages();\n\tif (alloc_normal >= save) {\n\t\tto_free_normal = alloc_normal - save;\n\t\tsave = 0;\n\t} else {\n\t\tto_free_normal = 0;\n\t\tsave -= alloc_normal;\n\t}\n\tsave += count_highmem_pages();\n\tif (alloc_highmem >= save) {\n\t\tto_free_highmem = alloc_highmem - save;\n\t} else {\n\t\tto_free_highmem = 0;\n\t\tsave -= alloc_highmem;\n\t\tif (to_free_normal > save)\n\t\t\tto_free_normal -= save;\n\t\telse\n\t\t\tto_free_normal = 0;\n\t}\n\tfree = to_free_normal + to_free_highmem;\n\n\tmemory_bm_position_reset(&copy_bm);\n\n\twhile (to_free_normal > 0 || to_free_highmem > 0) {\n\t\tunsigned long pfn = memory_bm_next_pfn(&copy_bm);\n\t\tstruct page *page = pfn_to_page(pfn);\n\n\t\tif (PageHighMem(page)) {\n\t\t\tif (!to_free_highmem)\n\t\t\t\tcontinue;\n\t\t\tto_free_highmem--;\n\t\t\talloc_highmem--;\n\t\t} else {\n\t\t\tif (!to_free_normal)\n\t\t\t\tcontinue;\n\t\t\tto_free_normal--;\n\t\t\talloc_normal--;\n\t\t}\n\t\tmemory_bm_clear_bit(&copy_bm, pfn);\n\t\tswsusp_unset_page_forbidden(page);\n\t\tswsusp_unset_page_free(page);\n\t\t__free_page(page);\n\t}\n\n\treturn free;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static unsigned int alloc_normal, alloc_highmem;",
            "static struct memory_bitmap copy_bm;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic unsigned int alloc_normal, alloc_highmem;\nstatic struct memory_bitmap copy_bm;\n\nstatic unsigned long free_unnecessary_pages(void)\n{\n\tunsigned long save, to_free_normal, to_free_highmem, free;\n\n\tsave = count_data_pages();\n\tif (alloc_normal >= save) {\n\t\tto_free_normal = alloc_normal - save;\n\t\tsave = 0;\n\t} else {\n\t\tto_free_normal = 0;\n\t\tsave -= alloc_normal;\n\t}\n\tsave += count_highmem_pages();\n\tif (alloc_highmem >= save) {\n\t\tto_free_highmem = alloc_highmem - save;\n\t} else {\n\t\tto_free_highmem = 0;\n\t\tsave -= alloc_highmem;\n\t\tif (to_free_normal > save)\n\t\t\tto_free_normal -= save;\n\t\telse\n\t\t\tto_free_normal = 0;\n\t}\n\tfree = to_free_normal + to_free_highmem;\n\n\tmemory_bm_position_reset(&copy_bm);\n\n\twhile (to_free_normal > 0 || to_free_highmem > 0) {\n\t\tunsigned long pfn = memory_bm_next_pfn(&copy_bm);\n\t\tstruct page *page = pfn_to_page(pfn);\n\n\t\tif (PageHighMem(page)) {\n\t\t\tif (!to_free_highmem)\n\t\t\t\tcontinue;\n\t\t\tto_free_highmem--;\n\t\t\talloc_highmem--;\n\t\t} else {\n\t\t\tif (!to_free_normal)\n\t\t\t\tcontinue;\n\t\t\tto_free_normal--;\n\t\t\talloc_normal--;\n\t\t}\n\t\tmemory_bm_clear_bit(&copy_bm, pfn);\n\t\tswsusp_unset_page_forbidden(page);\n\t\tswsusp_unset_page_free(page);\n\t\t__free_page(page);\n\t}\n\n\treturn free;\n}"
        }
      },
      {
        "call_info": {
          "callee": "preallocate_image_highmem",
          "args": [
            "alloc - size"
          ],
          "line": 1869
        },
        "resolved": true,
        "details": {
          "function_name": "preallocate_image_highmem",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1622-1625",
          "snippet": "static inline unsigned long preallocate_image_highmem(unsigned long nr_pages)\n{\n\treturn 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline unsigned long preallocate_image_highmem(unsigned long nr_pages)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "preallocate_image_memory",
          "args": [
            "alloc",
            "avail_normal"
          ],
          "line": 1868
        },
        "resolved": true,
        "details": {
          "function_name": "preallocate_image_memory",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1584-1597",
          "snippet": "static unsigned long preallocate_image_memory(unsigned long nr_pages,\n\t\t\t\t\t      unsigned long avail_normal)\n{\n\tunsigned long alloc;\n\n\tif (avail_normal <= alloc_normal)\n\t\treturn 0;\n\n\talloc = avail_normal - alloc_normal;\n\tif (nr_pages < alloc)\n\t\talloc = nr_pages;\n\n\treturn preallocate_image_pages(alloc, GFP_IMAGE);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define GFP_IMAGE\t(GFP_KERNEL | __GFP_NOWARN)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define GFP_IMAGE\t(GFP_KERNEL | __GFP_NOWARN)\n\nstatic unsigned long preallocate_image_memory(unsigned long nr_pages,\n\t\t\t\t\t      unsigned long avail_normal)\n{\n\tunsigned long alloc;\n\n\tif (avail_normal <= alloc_normal)\n\t\treturn 0;\n\n\talloc = avail_normal - alloc_normal;\n\tif (nr_pages < alloc)\n\t\talloc = nr_pages;\n\n\treturn preallocate_image_pages(alloc, GFP_IMAGE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "preallocate_highmem_fraction",
          "args": [
            "alloc",
            "highmem",
            "count"
          ],
          "line": 1865
        },
        "resolved": true,
        "details": {
          "function_name": "preallocate_highmem_fraction",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1627-1632",
          "snippet": "static inline unsigned long preallocate_highmem_fraction(unsigned long nr_pages,\n\t\t\t\t\t\t\t unsigned long highmem,\n\t\t\t\t\t\t\t unsigned long total)\n{\n\treturn 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline unsigned long preallocate_highmem_fraction(unsigned long nr_pages,\n\t\t\t\t\t\t\t unsigned long highmem,\n\t\t\t\t\t\t\t unsigned long total)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Image allocation is %lu pages short\\n\"",
            "alloc - pages_highmem"
          ],
          "line": 1848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shrink_all_memory",
          "args": [
            "saveable - size"
          ],
          "line": 1826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min_t",
          "args": [
            "unsignedlong",
            "pages",
            "max_size"
          ],
          "line": 1818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "minimum_image_size",
          "args": [
            "saveable"
          ],
          "line": 1807
        },
        "resolved": true,
        "details": {
          "function_name": "minimum_image_size",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1704-1715",
          "snippet": "static unsigned long minimum_image_size(unsigned long saveable)\n{\n\tunsigned long size;\n\n\tsize = global_node_page_state_pages(NR_SLAB_RECLAIMABLE_B)\n\t\t+ global_node_page_state(NR_ACTIVE_ANON)\n\t\t+ global_node_page_state(NR_INACTIVE_ANON)\n\t\t+ global_node_page_state(NR_ACTIVE_FILE)\n\t\t+ global_node_page_state(NR_INACTIVE_FILE);\n\n\treturn saveable <= size ? 0 : saveable - size;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned long minimum_image_size(unsigned long saveable)\n{\n\tunsigned long size;\n\n\tsize = global_node_page_state_pages(NR_SLAB_RECLAIMABLE_B)\n\t\t+ global_node_page_state(NR_ACTIVE_ANON)\n\t\t+ global_node_page_state(NR_INACTIVE_ANON)\n\t\t+ global_node_page_state(NR_ACTIVE_FILE)\n\t\t+ global_node_page_state(NR_INACTIVE_FILE);\n\n\treturn saveable <= size ? 0 : saveable - size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "image_size",
            "PAGE_SIZE"
          ],
          "line": 1792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "reserved_size",
            "PAGE_SIZE"
          ],
          "line": 1790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zone_page_state",
          "args": [
            "zone",
            "NR_FREE_PAGES"
          ],
          "line": 1782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zone_page_state",
          "args": [
            "zone",
            "NR_FREE_PAGES"
          ],
          "line": 1780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_highmem",
          "args": [
            "zone"
          ],
          "line": 1779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snapshot_additional_pages",
          "args": [
            "zone"
          ],
          "line": 1778
        },
        "resolved": true,
        "details": {
          "function_name": "snapshot_additional_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1219-1232",
          "snippet": "unsigned int snapshot_additional_pages(struct zone *zone)\n{\n\tunsigned int rtree, nodes;\n\n\trtree = nodes = DIV_ROUND_UP(zone->spanned_pages, BM_BITS_PER_BLOCK);\n\trtree += DIV_ROUND_UP(rtree * sizeof(struct rtree_node),\n\t\t\t      LINKED_PAGE_DATA_SIZE);\n\twhile (nodes > 1) {\n\t\tnodes = DIV_ROUND_UP(nodes, BM_ENTRIES_PER_LEVEL);\n\t\trtree += nodes;\n\t}\n\n\treturn 2 * rtree;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_ENTRIES_PER_LEVEL\t(PAGE_SIZE / sizeof(unsigned long))",
            "#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)",
            "#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_ENTRIES_PER_LEVEL\t(PAGE_SIZE / sizeof(unsigned long))\n#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)\n#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))\n\nunsigned int snapshot_additional_pages(struct zone *zone)\n{\n\tunsigned int rtree, nodes;\n\n\trtree = nodes = DIV_ROUND_UP(zone->spanned_pages, BM_BITS_PER_BLOCK);\n\trtree += DIV_ROUND_UP(rtree * sizeof(struct rtree_node),\n\t\t\t      LINKED_PAGE_DATA_SIZE);\n\twhile (nodes > 1) {\n\t\tnodes = DIV_ROUND_UP(nodes, BM_ENTRIES_PER_LEVEL);\n\t\trtree += nodes;\n\t}\n\n\treturn 2 * rtree;\n}"
        }
      },
      {
        "call_info": {
          "callee": "count_data_pages",
          "args": [],
          "line": 1767
        },
        "resolved": true,
        "details": {
          "function_name": "count_data_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1356-1373",
          "snippet": "static unsigned int count_data_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned long pfn, max_zone_pfn;\n\tunsigned int n = 0;\n\n\tfor_each_populated_zone(zone) {\n\t\tif (is_highmem(zone))\n\t\t\tcontinue;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (saveable_page(zone, pfn))\n\t\t\t\tn++;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int count_data_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned long pfn, max_zone_pfn;\n\tunsigned int n = 0;\n\n\tfor_each_populated_zone(zone) {\n\t\tif (is_highmem(zone))\n\t\t\tcontinue;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (saveable_page(zone, pfn))\n\t\t\t\tn++;\n\t}\n\treturn n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "count_highmem_pages",
          "args": [],
          "line": 1766
        },
        "resolved": true,
        "details": {
          "function_name": "count_highmem_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1288-1306",
          "snippet": "static unsigned int count_highmem_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned int n = 0;\n\n\tfor_each_populated_zone(zone) {\n\t\tunsigned long pfn, max_zone_pfn;\n\n\t\tif (!is_highmem(zone))\n\t\t\tcontinue;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (saveable_highmem_page(zone, pfn))\n\t\t\t\tn++;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int count_highmem_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned int n = 0;\n\n\tfor_each_populated_zone(zone) {\n\t\tunsigned long pfn, max_zone_pfn;\n\n\t\tif (!is_highmem(zone))\n\t\t\tcontinue;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (saveable_highmem_page(zone, pfn))\n\t\t\t\tn++;\n\t}\n\treturn n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Cannot allocate copy bitmap\\n\""
          ],
          "line": 1758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_bm_create",
          "args": [
            "&copy_bm",
            "GFP_IMAGE",
            "PG_ANY"
          ],
          "line": 1756
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_create",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "676-713",
          "snippet": "static int memory_bm_create(struct memory_bitmap *bm, gfp_t gfp_mask,\n\t\t\t    int safe_needed)\n{\n\tstruct chain_allocator ca;\n\tstruct list_head mem_extents;\n\tstruct mem_extent *ext;\n\tint error;\n\n\tchain_init(&ca, gfp_mask, safe_needed);\n\tINIT_LIST_HEAD(&bm->zones);\n\n\terror = create_mem_extents(&mem_extents, gfp_mask);\n\tif (error)\n\t\treturn error;\n\n\tlist_for_each_entry(ext, &mem_extents, hook) {\n\t\tstruct mem_zone_bm_rtree *zone;\n\n\t\tzone = create_zone_bm_rtree(gfp_mask, safe_needed, &ca,\n\t\t\t\t\t    ext->start, ext->end);\n\t\tif (!zone) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Error;\n\t\t}\n\t\tlist_add_tail(&zone->list, &bm->zones);\n\t}\n\n\tbm->p_list = ca.chain;\n\tmemory_bm_position_reset(bm);\n Exit:\n\tfree_mem_extents(&mem_extents);\n\treturn error;\n\n Error:\n\tbm->p_list = ca.chain;\n\tmemory_bm_free(bm, PG_UNSAFE_CLEAR);\n\tgoto Exit;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define PG_UNSAFE_CLEAR\t1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_UNSAFE_CLEAR\t1\n\nstatic int memory_bm_create(struct memory_bitmap *bm, gfp_t gfp_mask,\n\t\t\t    int safe_needed)\n{\n\tstruct chain_allocator ca;\n\tstruct list_head mem_extents;\n\tstruct mem_extent *ext;\n\tint error;\n\n\tchain_init(&ca, gfp_mask, safe_needed);\n\tINIT_LIST_HEAD(&bm->zones);\n\n\terror = create_mem_extents(&mem_extents, gfp_mask);\n\tif (error)\n\t\treturn error;\n\n\tlist_for_each_entry(ext, &mem_extents, hook) {\n\t\tstruct mem_zone_bm_rtree *zone;\n\n\t\tzone = create_zone_bm_rtree(gfp_mask, safe_needed, &ca,\n\t\t\t\t\t    ext->start, ext->end);\n\t\tif (!zone) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Error;\n\t\t}\n\t\tlist_add_tail(&zone->list, &bm->zones);\n\t}\n\n\tbm->p_list = ca.chain;\n\tmemory_bm_position_reset(bm);\n Exit:\n\tfree_mem_extents(&mem_extents);\n\treturn error;\n\n Error:\n\tbm->p_list = ca.chain;\n\tmemory_bm_free(bm, PG_UNSAFE_CLEAR);\n\tgoto Exit;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Cannot allocate original bitmap\\n\""
          ],
          "line": 1752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Preallocating image memory\\n\""
          ],
          "line": 1747
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define GFP_IMAGE\t(GFP_KERNEL | __GFP_NOWARN)\n#define PG_ANY\t\t0\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nunsigned long reserved_size;\nunsigned long image_size;\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\nstatic unsigned int alloc_normal, alloc_highmem;\nstatic struct memory_bitmap orig_bm;\nstatic struct memory_bitmap copy_bm;\n\nint hibernate_preallocate_memory(void)\n{\n\tstruct zone *zone;\n\tunsigned long saveable, size, max_size, count, highmem, pages = 0;\n\tunsigned long alloc, save_highmem, pages_highmem, avail_normal;\n\tktime_t start, stop;\n\tint error;\n\n\tpr_info(\"Preallocating image memory\\n\");\n\tstart = ktime_get();\n\n\terror = memory_bm_create(&orig_bm, GFP_IMAGE, PG_ANY);\n\tif (error) {\n\t\tpr_err(\"Cannot allocate original bitmap\\n\");\n\t\tgoto err_out;\n\t}\n\n\terror = memory_bm_create(&copy_bm, GFP_IMAGE, PG_ANY);\n\tif (error) {\n\t\tpr_err(\"Cannot allocate copy bitmap\\n\");\n\t\tgoto err_out;\n\t}\n\n\talloc_normal = 0;\n\talloc_highmem = 0;\n\n\t/* Count the number of saveable data pages. */\n\tsave_highmem = count_highmem_pages();\n\tsaveable = count_data_pages();\n\n\t/*\n\t * Compute the total number of page frames we can use (count) and the\n\t * number of pages needed for image metadata (size).\n\t */\n\tcount = saveable;\n\tsaveable += save_highmem;\n\thighmem = save_highmem;\n\tsize = 0;\n\tfor_each_populated_zone(zone) {\n\t\tsize += snapshot_additional_pages(zone);\n\t\tif (is_highmem(zone))\n\t\t\thighmem += zone_page_state(zone, NR_FREE_PAGES);\n\t\telse\n\t\t\tcount += zone_page_state(zone, NR_FREE_PAGES);\n\t}\n\tavail_normal = count;\n\tcount += highmem;\n\tcount -= totalreserve_pages;\n\n\t/* Compute the maximum number of saveable pages to leave in memory. */\n\tmax_size = (count - (size + PAGES_FOR_IO)) / 2\n\t\t\t- 2 * DIV_ROUND_UP(reserved_size, PAGE_SIZE);\n\t/* Compute the desired number of image pages specified by image_size. */\n\tsize = DIV_ROUND_UP(image_size, PAGE_SIZE);\n\tif (size > max_size)\n\t\tsize = max_size;\n\t/*\n\t * If the desired number of image pages is at least as large as the\n\t * current number of saveable pages in memory, allocate page frames for\n\t * the image and we're done.\n\t */\n\tif (size >= saveable) {\n\t\tpages = preallocate_image_highmem(save_highmem);\n\t\tpages += preallocate_image_memory(saveable - pages, avail_normal);\n\t\tgoto out;\n\t}\n\n\t/* Estimate the minimum size of the image. */\n\tpages = minimum_image_size(saveable);\n\t/*\n\t * To avoid excessive pressure on the normal zone, leave room in it to\n\t * accommodate an image of the minimum size (unless it's already too\n\t * small, in which case don't preallocate pages from it at all).\n\t */\n\tif (avail_normal > pages)\n\t\tavail_normal -= pages;\n\telse\n\t\tavail_normal = 0;\n\tif (size < pages)\n\t\tsize = min_t(unsigned long, pages, max_size);\n\n\t/*\n\t * Let the memory management subsystem know that we're going to need a\n\t * large number of page frames to allocate and make it free some memory.\n\t * NOTE: If this is not done, performance will be hurt badly in some\n\t * test cases.\n\t */\n\tshrink_all_memory(saveable - size);\n\n\t/*\n\t * The number of saveable pages in memory was too high, so apply some\n\t * pressure to decrease it.  First, make room for the largest possible\n\t * image and fail if that doesn't work.  Next, try to decrease the size\n\t * of the image as much as indicated by 'size' using allocations from\n\t * highmem and non-highmem zones separately.\n\t */\n\tpages_highmem = preallocate_image_highmem(highmem / 2);\n\talloc = count - max_size;\n\tif (alloc > pages_highmem)\n\t\talloc -= pages_highmem;\n\telse\n\t\talloc = 0;\n\tpages = preallocate_image_memory(alloc, avail_normal);\n\tif (pages < alloc) {\n\t\t/* We have exhausted non-highmem pages, try highmem. */\n\t\talloc -= pages;\n\t\tpages += pages_highmem;\n\t\tpages_highmem = preallocate_image_highmem(alloc);\n\t\tif (pages_highmem < alloc) {\n\t\t\tpr_err(\"Image allocation is %lu pages short\\n\",\n\t\t\t\talloc - pages_highmem);\n\t\t\tgoto err_out;\n\t\t}\n\t\tpages += pages_highmem;\n\t\t/*\n\t\t * size is the desired number of saveable pages to leave in\n\t\t * memory, so try to preallocate (all memory - size) pages.\n\t\t */\n\t\talloc = (count - pages) - size;\n\t\tpages += preallocate_image_highmem(alloc);\n\t} else {\n\t\t/*\n\t\t * There are approximately max_size saveable pages at this point\n\t\t * and we want to reduce this number down to size.\n\t\t */\n\t\talloc = max_size - size;\n\t\tsize = preallocate_highmem_fraction(alloc, highmem, count);\n\t\tpages_highmem += size;\n\t\talloc -= size;\n\t\tsize = preallocate_image_memory(alloc, avail_normal);\n\t\tpages_highmem += preallocate_image_highmem(alloc - size);\n\t\tpages += pages_highmem + size;\n\t}\n\n\t/*\n\t * We only need as many page frames for the image as there are saveable\n\t * pages in memory, but we have allocated more.  Release the excessive\n\t * ones now.\n\t */\n\tpages -= free_unnecessary_pages();\n\n out:\n\tstop = ktime_get();\n\tpr_info(\"Allocated %lu pages for snapshot\\n\", pages);\n\tswsusp_show_speed(start, stop, pages, \"Allocated\");\n\n\treturn 0;\n\n err_out:\n\tswsusp_free();\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "minimum_image_size",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1704-1715",
    "snippet": "static unsigned long minimum_image_size(unsigned long saveable)\n{\n\tunsigned long size;\n\n\tsize = global_node_page_state_pages(NR_SLAB_RECLAIMABLE_B)\n\t\t+ global_node_page_state(NR_ACTIVE_ANON)\n\t\t+ global_node_page_state(NR_INACTIVE_ANON)\n\t\t+ global_node_page_state(NR_ACTIVE_FILE)\n\t\t+ global_node_page_state(NR_INACTIVE_FILE);\n\n\treturn saveable <= size ? 0 : saveable - size;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "global_node_page_state",
          "args": [
            "NR_INACTIVE_FILE"
          ],
          "line": 1712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "global_node_page_state",
          "args": [
            "NR_ACTIVE_FILE"
          ],
          "line": 1711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "global_node_page_state",
          "args": [
            "NR_INACTIVE_ANON"
          ],
          "line": 1710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "global_node_page_state",
          "args": [
            "NR_ACTIVE_ANON"
          ],
          "line": 1709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "global_node_page_state_pages",
          "args": [
            "NR_SLAB_RECLAIMABLE_B"
          ],
          "line": 1708
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned long minimum_image_size(unsigned long saveable)\n{\n\tunsigned long size;\n\n\tsize = global_node_page_state_pages(NR_SLAB_RECLAIMABLE_B)\n\t\t+ global_node_page_state(NR_ACTIVE_ANON)\n\t\t+ global_node_page_state(NR_INACTIVE_ANON)\n\t\t+ global_node_page_state(NR_ACTIVE_FILE)\n\t\t+ global_node_page_state(NR_INACTIVE_FILE);\n\n\treturn saveable <= size ? 0 : saveable - size;\n}"
  },
  {
    "function_name": "free_unnecessary_pages",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1638-1687",
    "snippet": "static unsigned long free_unnecessary_pages(void)\n{\n\tunsigned long save, to_free_normal, to_free_highmem, free;\n\n\tsave = count_data_pages();\n\tif (alloc_normal >= save) {\n\t\tto_free_normal = alloc_normal - save;\n\t\tsave = 0;\n\t} else {\n\t\tto_free_normal = 0;\n\t\tsave -= alloc_normal;\n\t}\n\tsave += count_highmem_pages();\n\tif (alloc_highmem >= save) {\n\t\tto_free_highmem = alloc_highmem - save;\n\t} else {\n\t\tto_free_highmem = 0;\n\t\tsave -= alloc_highmem;\n\t\tif (to_free_normal > save)\n\t\t\tto_free_normal -= save;\n\t\telse\n\t\t\tto_free_normal = 0;\n\t}\n\tfree = to_free_normal + to_free_highmem;\n\n\tmemory_bm_position_reset(&copy_bm);\n\n\twhile (to_free_normal > 0 || to_free_highmem > 0) {\n\t\tunsigned long pfn = memory_bm_next_pfn(&copy_bm);\n\t\tstruct page *page = pfn_to_page(pfn);\n\n\t\tif (PageHighMem(page)) {\n\t\t\tif (!to_free_highmem)\n\t\t\t\tcontinue;\n\t\t\tto_free_highmem--;\n\t\t\talloc_highmem--;\n\t\t} else {\n\t\t\tif (!to_free_normal)\n\t\t\t\tcontinue;\n\t\t\tto_free_normal--;\n\t\t\talloc_normal--;\n\t\t}\n\t\tmemory_bm_clear_bit(&copy_bm, pfn);\n\t\tswsusp_unset_page_forbidden(page);\n\t\tswsusp_unset_page_free(page);\n\t\t__free_page(page);\n\t}\n\n\treturn free;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);",
      "static unsigned int alloc_normal, alloc_highmem;",
      "static struct memory_bitmap copy_bm;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__free_page",
          "args": [
            "page"
          ],
          "line": 1683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swsusp_unset_page_free",
          "args": [
            "page"
          ],
          "line": 1682
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_unset_page_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1045-1049",
          "snippet": "void swsusp_unset_page_free(struct page *page)\n{\n\tif (free_pages_map)\n\t\tmemory_bm_clear_bit(free_pages_map, page_to_pfn(page));\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *free_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *free_pages_map;\n\nvoid swsusp_unset_page_free(struct page *page)\n{\n\tif (free_pages_map)\n\t\tmemory_bm_clear_bit(free_pages_map, page_to_pfn(page));\n}"
        }
      },
      {
        "call_info": {
          "callee": "swsusp_unset_page_forbidden",
          "args": [
            "page"
          ],
          "line": 1681
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_unset_page_forbidden",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1063-1067",
          "snippet": "static void swsusp_unset_page_forbidden(struct page *page)\n{\n\tif (forbidden_pages_map)\n\t\tmemory_bm_clear_bit(forbidden_pages_map, page_to_pfn(page));\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *forbidden_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *forbidden_pages_map;\n\nstatic void swsusp_unset_page_forbidden(struct page *page)\n{\n\tif (forbidden_pages_map)\n\t\tmemory_bm_clear_bit(forbidden_pages_map, page_to_pfn(page));\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_clear_bit",
          "args": [
            "&copy_bm",
            "pfn"
          ],
          "line": 1680
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_clear_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "830-839",
          "snippet": "static void memory_bm_clear_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tclear_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_clear_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tclear_bit(bit, addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PageHighMem",
          "args": [
            "page"
          ],
          "line": 1669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfn_to_page",
          "args": [
            "pfn"
          ],
          "line": 1667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_bm_next_pfn",
          "args": [
            "&copy_bm"
          ],
          "line": 1666
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_next_pfn",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "915-933",
          "snippet": "static unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)",
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)\n#define BM_END_OF_MAP\t(~0UL)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_position_reset",
          "args": [
            "&copy_bm"
          ],
          "line": 1663
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_position_reset",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "581-589",
          "snippet": "static void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "count_highmem_pages",
          "args": [],
          "line": 1650
        },
        "resolved": true,
        "details": {
          "function_name": "count_highmem_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1288-1306",
          "snippet": "static unsigned int count_highmem_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned int n = 0;\n\n\tfor_each_populated_zone(zone) {\n\t\tunsigned long pfn, max_zone_pfn;\n\n\t\tif (!is_highmem(zone))\n\t\t\tcontinue;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (saveable_highmem_page(zone, pfn))\n\t\t\t\tn++;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int count_highmem_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned int n = 0;\n\n\tfor_each_populated_zone(zone) {\n\t\tunsigned long pfn, max_zone_pfn;\n\n\t\tif (!is_highmem(zone))\n\t\t\tcontinue;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (saveable_highmem_page(zone, pfn))\n\t\t\t\tn++;\n\t}\n\treturn n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "count_data_pages",
          "args": [],
          "line": 1642
        },
        "resolved": true,
        "details": {
          "function_name": "count_data_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1356-1373",
          "snippet": "static unsigned int count_data_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned long pfn, max_zone_pfn;\n\tunsigned int n = 0;\n\n\tfor_each_populated_zone(zone) {\n\t\tif (is_highmem(zone))\n\t\t\tcontinue;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (saveable_page(zone, pfn))\n\t\t\t\tn++;\n\t}\n\treturn n;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int count_data_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned long pfn, max_zone_pfn;\n\tunsigned int n = 0;\n\n\tfor_each_populated_zone(zone) {\n\t\tif (is_highmem(zone))\n\t\t\tcontinue;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (saveable_page(zone, pfn))\n\t\t\t\tn++;\n\t}\n\treturn n;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic unsigned int alloc_normal, alloc_highmem;\nstatic struct memory_bitmap copy_bm;\n\nstatic unsigned long free_unnecessary_pages(void)\n{\n\tunsigned long save, to_free_normal, to_free_highmem, free;\n\n\tsave = count_data_pages();\n\tif (alloc_normal >= save) {\n\t\tto_free_normal = alloc_normal - save;\n\t\tsave = 0;\n\t} else {\n\t\tto_free_normal = 0;\n\t\tsave -= alloc_normal;\n\t}\n\tsave += count_highmem_pages();\n\tif (alloc_highmem >= save) {\n\t\tto_free_highmem = alloc_highmem - save;\n\t} else {\n\t\tto_free_highmem = 0;\n\t\tsave -= alloc_highmem;\n\t\tif (to_free_normal > save)\n\t\t\tto_free_normal -= save;\n\t\telse\n\t\t\tto_free_normal = 0;\n\t}\n\tfree = to_free_normal + to_free_highmem;\n\n\tmemory_bm_position_reset(&copy_bm);\n\n\twhile (to_free_normal > 0 || to_free_highmem > 0) {\n\t\tunsigned long pfn = memory_bm_next_pfn(&copy_bm);\n\t\tstruct page *page = pfn_to_page(pfn);\n\n\t\tif (PageHighMem(page)) {\n\t\t\tif (!to_free_highmem)\n\t\t\t\tcontinue;\n\t\t\tto_free_highmem--;\n\t\t\talloc_highmem--;\n\t\t} else {\n\t\t\tif (!to_free_normal)\n\t\t\t\tcontinue;\n\t\t\tto_free_normal--;\n\t\t\talloc_normal--;\n\t\t}\n\t\tmemory_bm_clear_bit(&copy_bm, pfn);\n\t\tswsusp_unset_page_forbidden(page);\n\t\tswsusp_unset_page_free(page);\n\t\t__free_page(page);\n\t}\n\n\treturn free;\n}"
  },
  {
    "function_name": "preallocate_highmem_fraction",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1627-1632",
    "snippet": "static inline unsigned long preallocate_highmem_fraction(unsigned long nr_pages,\n\t\t\t\t\t\t\t unsigned long highmem,\n\t\t\t\t\t\t\t unsigned long total)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline unsigned long preallocate_highmem_fraction(unsigned long nr_pages,\n\t\t\t\t\t\t\t unsigned long highmem,\n\t\t\t\t\t\t\t unsigned long total)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "preallocate_image_highmem",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1622-1625",
    "snippet": "static inline unsigned long preallocate_image_highmem(unsigned long nr_pages)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline unsigned long preallocate_image_highmem(unsigned long nr_pages)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "preallocate_highmem_fraction",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1613-1620",
    "snippet": "static unsigned long preallocate_highmem_fraction(unsigned long nr_pages,\n\t\t\t\t\t\t  unsigned long highmem,\n\t\t\t\t\t\t  unsigned long total)\n{\n\tunsigned long alloc = __fraction(nr_pages, highmem, total);\n\n\treturn preallocate_image_pages(alloc, GFP_IMAGE | __GFP_HIGHMEM);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define GFP_IMAGE\t(GFP_KERNEL | __GFP_NOWARN)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preallocate_image_pages",
          "args": [
            "alloc",
            "GFP_IMAGE | __GFP_HIGHMEM"
          ],
          "line": 1619
        },
        "resolved": true,
        "details": {
          "function_name": "preallocate_image_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1562-1582",
          "snippet": "static unsigned long preallocate_image_pages(unsigned long nr_pages, gfp_t mask)\n{\n\tunsigned long nr_alloc = 0;\n\n\twhile (nr_pages > 0) {\n\t\tstruct page *page;\n\n\t\tpage = alloc_image_page(mask);\n\t\tif (!page)\n\t\t\tbreak;\n\t\tmemory_bm_set_bit(&copy_bm, page_to_pfn(page));\n\t\tif (PageHighMem(page))\n\t\t\talloc_highmem++;\n\t\telse\n\t\t\talloc_normal++;\n\t\tnr_pages--;\n\t\tnr_alloc++;\n\t}\n\n\treturn nr_alloc;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static unsigned int alloc_normal, alloc_highmem;",
            "static struct memory_bitmap copy_bm;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic unsigned int alloc_normal, alloc_highmem;\nstatic struct memory_bitmap copy_bm;\n\nstatic unsigned long preallocate_image_pages(unsigned long nr_pages, gfp_t mask)\n{\n\tunsigned long nr_alloc = 0;\n\n\twhile (nr_pages > 0) {\n\t\tstruct page *page;\n\n\t\tpage = alloc_image_page(mask);\n\t\tif (!page)\n\t\t\tbreak;\n\t\tmemory_bm_set_bit(&copy_bm, page_to_pfn(page));\n\t\tif (PageHighMem(page))\n\t\t\talloc_highmem++;\n\t\telse\n\t\t\talloc_normal++;\n\t\tnr_pages--;\n\t\tnr_alloc++;\n\t}\n\n\treturn nr_alloc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__fraction",
          "args": [
            "nr_pages",
            "highmem",
            "total"
          ],
          "line": 1617
        },
        "resolved": true,
        "details": {
          "function_name": "__fraction",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1608-1611",
          "snippet": "static unsigned long __fraction(u64 x, u64 multiplier, u64 base)\n{\n\treturn div64_u64(x * multiplier, base);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned long __fraction(u64 x, u64 multiplier, u64 base)\n{\n\treturn div64_u64(x * multiplier, base);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define GFP_IMAGE\t(GFP_KERNEL | __GFP_NOWARN)\n\nstatic unsigned long preallocate_highmem_fraction(unsigned long nr_pages,\n\t\t\t\t\t\t  unsigned long highmem,\n\t\t\t\t\t\t  unsigned long total)\n{\n\tunsigned long alloc = __fraction(nr_pages, highmem, total);\n\n\treturn preallocate_image_pages(alloc, GFP_IMAGE | __GFP_HIGHMEM);\n}"
  },
  {
    "function_name": "__fraction",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1608-1611",
    "snippet": "static unsigned long __fraction(u64 x, u64 multiplier, u64 base)\n{\n\treturn div64_u64(x * multiplier, base);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "div64_u64",
          "args": [
            "x * multiplier",
            "base"
          ],
          "line": 1610
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned long __fraction(u64 x, u64 multiplier, u64 base)\n{\n\treturn div64_u64(x * multiplier, base);\n}"
  },
  {
    "function_name": "preallocate_image_highmem",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1600-1603",
    "snippet": "static unsigned long preallocate_image_highmem(unsigned long nr_pages)\n{\n\treturn preallocate_image_pages(nr_pages, GFP_IMAGE | __GFP_HIGHMEM);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define GFP_IMAGE\t(GFP_KERNEL | __GFP_NOWARN)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preallocate_image_pages",
          "args": [
            "nr_pages",
            "GFP_IMAGE | __GFP_HIGHMEM"
          ],
          "line": 1602
        },
        "resolved": true,
        "details": {
          "function_name": "preallocate_image_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1562-1582",
          "snippet": "static unsigned long preallocate_image_pages(unsigned long nr_pages, gfp_t mask)\n{\n\tunsigned long nr_alloc = 0;\n\n\twhile (nr_pages > 0) {\n\t\tstruct page *page;\n\n\t\tpage = alloc_image_page(mask);\n\t\tif (!page)\n\t\t\tbreak;\n\t\tmemory_bm_set_bit(&copy_bm, page_to_pfn(page));\n\t\tif (PageHighMem(page))\n\t\t\talloc_highmem++;\n\t\telse\n\t\t\talloc_normal++;\n\t\tnr_pages--;\n\t\tnr_alloc++;\n\t}\n\n\treturn nr_alloc;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static unsigned int alloc_normal, alloc_highmem;",
            "static struct memory_bitmap copy_bm;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic unsigned int alloc_normal, alloc_highmem;\nstatic struct memory_bitmap copy_bm;\n\nstatic unsigned long preallocate_image_pages(unsigned long nr_pages, gfp_t mask)\n{\n\tunsigned long nr_alloc = 0;\n\n\twhile (nr_pages > 0) {\n\t\tstruct page *page;\n\n\t\tpage = alloc_image_page(mask);\n\t\tif (!page)\n\t\t\tbreak;\n\t\tmemory_bm_set_bit(&copy_bm, page_to_pfn(page));\n\t\tif (PageHighMem(page))\n\t\t\talloc_highmem++;\n\t\telse\n\t\t\talloc_normal++;\n\t\tnr_pages--;\n\t\tnr_alloc++;\n\t}\n\n\treturn nr_alloc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define GFP_IMAGE\t(GFP_KERNEL | __GFP_NOWARN)\n\nstatic unsigned long preallocate_image_highmem(unsigned long nr_pages)\n{\n\treturn preallocate_image_pages(nr_pages, GFP_IMAGE | __GFP_HIGHMEM);\n}"
  },
  {
    "function_name": "preallocate_image_memory",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1584-1597",
    "snippet": "static unsigned long preallocate_image_memory(unsigned long nr_pages,\n\t\t\t\t\t      unsigned long avail_normal)\n{\n\tunsigned long alloc;\n\n\tif (avail_normal <= alloc_normal)\n\t\treturn 0;\n\n\talloc = avail_normal - alloc_normal;\n\tif (nr_pages < alloc)\n\t\talloc = nr_pages;\n\n\treturn preallocate_image_pages(alloc, GFP_IMAGE);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define GFP_IMAGE\t(GFP_KERNEL | __GFP_NOWARN)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preallocate_image_pages",
          "args": [
            "alloc",
            "GFP_IMAGE"
          ],
          "line": 1596
        },
        "resolved": true,
        "details": {
          "function_name": "preallocate_image_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1562-1582",
          "snippet": "static unsigned long preallocate_image_pages(unsigned long nr_pages, gfp_t mask)\n{\n\tunsigned long nr_alloc = 0;\n\n\twhile (nr_pages > 0) {\n\t\tstruct page *page;\n\n\t\tpage = alloc_image_page(mask);\n\t\tif (!page)\n\t\t\tbreak;\n\t\tmemory_bm_set_bit(&copy_bm, page_to_pfn(page));\n\t\tif (PageHighMem(page))\n\t\t\talloc_highmem++;\n\t\telse\n\t\t\talloc_normal++;\n\t\tnr_pages--;\n\t\tnr_alloc++;\n\t}\n\n\treturn nr_alloc;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static unsigned int alloc_normal, alloc_highmem;",
            "static struct memory_bitmap copy_bm;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic unsigned int alloc_normal, alloc_highmem;\nstatic struct memory_bitmap copy_bm;\n\nstatic unsigned long preallocate_image_pages(unsigned long nr_pages, gfp_t mask)\n{\n\tunsigned long nr_alloc = 0;\n\n\twhile (nr_pages > 0) {\n\t\tstruct page *page;\n\n\t\tpage = alloc_image_page(mask);\n\t\tif (!page)\n\t\t\tbreak;\n\t\tmemory_bm_set_bit(&copy_bm, page_to_pfn(page));\n\t\tif (PageHighMem(page))\n\t\t\talloc_highmem++;\n\t\telse\n\t\t\talloc_normal++;\n\t\tnr_pages--;\n\t\tnr_alloc++;\n\t}\n\n\treturn nr_alloc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define GFP_IMAGE\t(GFP_KERNEL | __GFP_NOWARN)\n\nstatic unsigned long preallocate_image_memory(unsigned long nr_pages,\n\t\t\t\t\t      unsigned long avail_normal)\n{\n\tunsigned long alloc;\n\n\tif (avail_normal <= alloc_normal)\n\t\treturn 0;\n\n\talloc = avail_normal - alloc_normal;\n\tif (nr_pages < alloc)\n\t\talloc = nr_pages;\n\n\treturn preallocate_image_pages(alloc, GFP_IMAGE);\n}"
  },
  {
    "function_name": "preallocate_image_pages",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1562-1582",
    "snippet": "static unsigned long preallocate_image_pages(unsigned long nr_pages, gfp_t mask)\n{\n\tunsigned long nr_alloc = 0;\n\n\twhile (nr_pages > 0) {\n\t\tstruct page *page;\n\n\t\tpage = alloc_image_page(mask);\n\t\tif (!page)\n\t\t\tbreak;\n\t\tmemory_bm_set_bit(&copy_bm, page_to_pfn(page));\n\t\tif (PageHighMem(page))\n\t\t\talloc_highmem++;\n\t\telse\n\t\t\talloc_normal++;\n\t\tnr_pages--;\n\t\tnr_alloc++;\n\t}\n\n\treturn nr_alloc;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);",
      "static unsigned int alloc_normal, alloc_highmem;",
      "static struct memory_bitmap copy_bm;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PageHighMem",
          "args": [
            "page"
          ],
          "line": 1573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_bm_set_bit",
          "args": [
            "&copy_bm",
            "page_to_pfn(page)"
          ],
          "line": 1572
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_set_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "806-815",
          "snippet": "static void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_to_pfn",
          "args": [
            "page"
          ],
          "line": 1572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_image_page",
          "args": [
            "mask"
          ],
          "line": 1569
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_image_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "225-235",
          "snippet": "static struct page *alloc_image_page(gfp_t gfp_mask)\n{\n\tstruct page *page;\n\n\tpage = alloc_page(gfp_mask);\n\tif (page) {\n\t\tswsusp_set_page_forbidden(page);\n\t\tswsusp_set_page_free(page);\n\t}\n\treturn page;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic struct page *alloc_image_page(gfp_t gfp_mask)\n{\n\tstruct page *page;\n\n\tpage = alloc_page(gfp_mask);\n\tif (page) {\n\t\tswsusp_set_page_forbidden(page);\n\t\tswsusp_set_page_free(page);\n\t}\n\treturn page;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic unsigned int alloc_normal, alloc_highmem;\nstatic struct memory_bitmap copy_bm;\n\nstatic unsigned long preallocate_image_pages(unsigned long nr_pages, gfp_t mask)\n{\n\tunsigned long nr_alloc = 0;\n\n\twhile (nr_pages > 0) {\n\t\tstruct page *page;\n\n\t\tpage = alloc_image_page(mask);\n\t\tif (!page)\n\t\t\tbreak;\n\t\tmemory_bm_set_bit(&copy_bm, page_to_pfn(page));\n\t\tif (PageHighMem(page))\n\t\t\talloc_highmem++;\n\t\telse\n\t\t\talloc_normal++;\n\t\tnr_pages--;\n\t\tnr_alloc++;\n\t}\n\n\treturn nr_alloc;\n}"
  },
  {
    "function_name": "swsusp_free",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1506-1549",
    "snippet": "void swsusp_free(void)\n{\n\tunsigned long fb_pfn, fr_pfn;\n\n\tif (!forbidden_pages_map || !free_pages_map)\n\t\tgoto out;\n\n\tmemory_bm_position_reset(forbidden_pages_map);\n\tmemory_bm_position_reset(free_pages_map);\n\nloop:\n\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\n\t/*\n\t * Find the next bit set in both bitmaps. This is guaranteed to\n\t * terminate when fb_pfn == fr_pfn == BM_END_OF_MAP.\n\t */\n\tdo {\n\t\tif (fb_pfn < fr_pfn)\n\t\t\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\t\tif (fr_pfn < fb_pfn)\n\t\t\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\t} while (fb_pfn != fr_pfn);\n\n\tif (fr_pfn != BM_END_OF_MAP && pfn_valid(fr_pfn)) {\n\t\tstruct page *page = pfn_to_page(fr_pfn);\n\n\t\tmemory_bm_clear_current(forbidden_pages_map);\n\t\tmemory_bm_clear_current(free_pages_map);\n\t\thibernate_restore_unprotect_page(page_address(page));\n\t\t__free_page(page);\n\t\tgoto loop;\n\t}\n\nout:\n\tnr_copy_pages = 0;\n\tnr_meta_pages = 0;\n\trestore_pblist = NULL;\n\tbuffer = NULL;\n\talloc_normal = 0;\n\talloc_highmem = 0;\n\thibernate_restore_protection_end();\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define BM_END_OF_MAP\t(~0UL)"
    ],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);",
      "struct pbe *restore_pblist;",
      "static void *buffer;",
      "static struct memory_bitmap *forbidden_pages_map;",
      "static struct memory_bitmap *free_pages_map;",
      "static unsigned int nr_copy_pages;",
      "static unsigned int nr_meta_pages;",
      "static unsigned int alloc_normal, alloc_highmem;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hibernate_restore_protection_end",
          "args": [],
          "line": 1548
        },
        "resolved": true,
        "details": {
          "function_name": "hibernate_restore_protection_end",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "74-74",
          "snippet": "static inline void hibernate_restore_protection_end(void) {}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void hibernate_restore_protection_end(void) {}"
        }
      },
      {
        "call_info": {
          "callee": "__free_page",
          "args": [
            "page"
          ],
          "line": 1537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hibernate_restore_unprotect_page",
          "args": [
            "page_address(page)"
          ],
          "line": 1536
        },
        "resolved": true,
        "details": {
          "function_name": "hibernate_restore_unprotect_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "76-76",
          "snippet": "static inline void hibernate_restore_unprotect_page(void *page_address) {}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void hibernate_restore_unprotect_page(void *page_address) {}"
        }
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 1536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_bm_clear_current",
          "args": [
            "free_pages_map"
          ],
          "line": 1535
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_clear_current",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "841-847",
          "snippet": "static void memory_bm_clear_current(struct memory_bitmap *bm)\n{\n\tint bit;\n\n\tbit = max(bm->cur.node_bit - 1, 0);\n\tclear_bit(bit, bm->cur.node->data);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic void memory_bm_clear_current(struct memory_bitmap *bm)\n{\n\tint bit;\n\n\tbit = max(bm->cur.node_bit - 1, 0);\n\tclear_bit(bit, bm->cur.node->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pfn_to_page",
          "args": [
            "fr_pfn"
          ],
          "line": 1532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfn_valid",
          "args": [
            "fr_pfn"
          ],
          "line": 1531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_bm_next_pfn",
          "args": [
            "free_pages_map"
          ],
          "line": 1528
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_next_pfn",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "915-933",
          "snippet": "static unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)",
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)\n#define BM_END_OF_MAP\t(~0UL)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_position_reset",
          "args": [
            "free_pages_map"
          ],
          "line": 1514
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_position_reset",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "581-589",
          "snippet": "static void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstruct pbe *restore_pblist;\nstatic void *buffer;\nstatic struct memory_bitmap *forbidden_pages_map;\nstatic struct memory_bitmap *free_pages_map;\nstatic unsigned int nr_copy_pages;\nstatic unsigned int nr_meta_pages;\nstatic unsigned int alloc_normal, alloc_highmem;\n\nvoid swsusp_free(void)\n{\n\tunsigned long fb_pfn, fr_pfn;\n\n\tif (!forbidden_pages_map || !free_pages_map)\n\t\tgoto out;\n\n\tmemory_bm_position_reset(forbidden_pages_map);\n\tmemory_bm_position_reset(free_pages_map);\n\nloop:\n\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\n\t/*\n\t * Find the next bit set in both bitmaps. This is guaranteed to\n\t * terminate when fb_pfn == fr_pfn == BM_END_OF_MAP.\n\t */\n\tdo {\n\t\tif (fb_pfn < fr_pfn)\n\t\t\tfb_pfn = memory_bm_next_pfn(forbidden_pages_map);\n\t\tif (fr_pfn < fb_pfn)\n\t\t\tfr_pfn = memory_bm_next_pfn(free_pages_map);\n\t} while (fb_pfn != fr_pfn);\n\n\tif (fr_pfn != BM_END_OF_MAP && pfn_valid(fr_pfn)) {\n\t\tstruct page *page = pfn_to_page(fr_pfn);\n\n\t\tmemory_bm_clear_current(forbidden_pages_map);\n\t\tmemory_bm_clear_current(free_pages_map);\n\t\thibernate_restore_unprotect_page(page_address(page));\n\t\t__free_page(page);\n\t\tgoto loop;\n\t}\n\nout:\n\tnr_copy_pages = 0;\n\tnr_meta_pages = 0;\n\trestore_pblist = NULL;\n\tbuffer = NULL;\n\talloc_normal = 0;\n\talloc_highmem = 0;\n\thibernate_restore_protection_end();\n}"
  },
  {
    "function_name": "copy_data_pages",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1451-1474",
    "snippet": "static void copy_data_pages(struct memory_bitmap *copy_bm,\n\t\t\t    struct memory_bitmap *orig_bm)\n{\n\tstruct zone *zone;\n\tunsigned long pfn;\n\n\tfor_each_populated_zone(zone) {\n\t\tunsigned long max_zone_pfn;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (page_is_saveable(zone, pfn))\n\t\t\t\tmemory_bm_set_bit(orig_bm, pfn);\n\t}\n\tmemory_bm_position_reset(orig_bm);\n\tmemory_bm_position_reset(copy_bm);\n\tfor(;;) {\n\t\tpfn = memory_bm_next_pfn(orig_bm);\n\t\tif (unlikely(pfn == BM_END_OF_MAP))\n\t\t\tbreak;\n\t\tcopy_data_page(memory_bm_next_pfn(copy_bm), pfn);\n\t}\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define BM_END_OF_MAP\t(~0UL)"
    ],
    "globals_used": [
      "static struct memory_bitmap orig_bm;",
      "static struct memory_bitmap copy_bm;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_data_page",
          "args": [
            "memory_bm_next_pfn(copy_bm)",
            "pfn"
          ],
          "line": 1472
        },
        "resolved": true,
        "details": {
          "function_name": "copy_data_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1451-1474",
          "snippet": "static void copy_data_pages(struct memory_bitmap *copy_bm,\n\t\t\t    struct memory_bitmap *orig_bm)\n{\n\tstruct zone *zone;\n\tunsigned long pfn;\n\n\tfor_each_populated_zone(zone) {\n\t\tunsigned long max_zone_pfn;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (page_is_saveable(zone, pfn))\n\t\t\t\tmemory_bm_set_bit(orig_bm, pfn);\n\t}\n\tmemory_bm_position_reset(orig_bm);\n\tmemory_bm_position_reset(copy_bm);\n\tfor(;;) {\n\t\tpfn = memory_bm_next_pfn(orig_bm);\n\t\tif (unlikely(pfn == BM_END_OF_MAP))\n\t\t\tbreak;\n\t\tcopy_data_page(memory_bm_next_pfn(copy_bm), pfn);\n\t}\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_next_pfn",
          "args": [
            "copy_bm"
          ],
          "line": 1472
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_next_pfn",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "915-933",
          "snippet": "static unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)",
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)\n#define BM_END_OF_MAP\t(~0UL)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "pfn == BM_END_OF_MAP"
          ],
          "line": 1470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_bm_position_reset",
          "args": [
            "copy_bm"
          ],
          "line": 1467
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_position_reset",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "581-589",
          "snippet": "static void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_set_bit",
          "args": [
            "orig_bm",
            "pfn"
          ],
          "line": 1464
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_set_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "806-815",
          "snippet": "static void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_is_saveable",
          "args": [
            "zone",
            "pfn"
          ],
          "line": 1463
        },
        "resolved": true,
        "details": {
          "function_name": "page_is_saveable",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1407-1411",
          "snippet": "static inline struct page *page_is_saveable(struct zone *zone, unsigned long pfn)\n{\n\treturn is_highmem(zone) ?\n\t\tsaveable_highmem_page(zone, pfn) : saveable_page(zone, pfn);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic inline struct page *page_is_saveable(struct zone *zone, unsigned long pfn)\n{\n\treturn is_highmem(zone) ?\n\t\tsaveable_highmem_page(zone, pfn) : saveable_page(zone, pfn);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zone_end_pfn",
          "args": [
            "zone"
          ],
          "line": 1461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mark_free_pages",
          "args": [
            "zone"
          ],
          "line": 1460
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic struct memory_bitmap orig_bm;\nstatic struct memory_bitmap copy_bm;\n\nstatic void copy_data_pages(struct memory_bitmap *copy_bm,\n\t\t\t    struct memory_bitmap *orig_bm)\n{\n\tstruct zone *zone;\n\tunsigned long pfn;\n\n\tfor_each_populated_zone(zone) {\n\t\tunsigned long max_zone_pfn;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (page_is_saveable(zone, pfn))\n\t\t\t\tmemory_bm_set_bit(orig_bm, pfn);\n\t}\n\tmemory_bm_position_reset(orig_bm);\n\tmemory_bm_position_reset(copy_bm);\n\tfor(;;) {\n\t\tpfn = memory_bm_next_pfn(orig_bm);\n\t\tif (unlikely(pfn == BM_END_OF_MAP))\n\t\t\tbreak;\n\t\tcopy_data_page(memory_bm_next_pfn(copy_bm), pfn);\n\t}\n}"
  },
  {
    "function_name": "copy_data_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1444-1448",
    "snippet": "static inline void copy_data_page(unsigned long dst_pfn, unsigned long src_pfn)\n{\n\tsafe_copy_page(page_address(pfn_to_page(dst_pfn)),\n\t\t\t\tpfn_to_page(src_pfn));\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "safe_copy_page",
          "args": [
            "page_address(pfn_to_page(dst_pfn))",
            "pfn_to_page(src_pfn)"
          ],
          "line": 1446
        },
        "resolved": true,
        "details": {
          "function_name": "safe_copy_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1395-1404",
          "snippet": "static void safe_copy_page(void *dst, struct page *s_page)\n{\n\tif (kernel_page_present(s_page)) {\n\t\tdo_copy_page(dst, page_address(s_page));\n\t} else {\n\t\thibernate_map_page(s_page);\n\t\tdo_copy_page(dst, page_address(s_page));\n\t\thibernate_unmap_page(s_page);\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic void safe_copy_page(void *dst, struct page *s_page)\n{\n\tif (kernel_page_present(s_page)) {\n\t\tdo_copy_page(dst, page_address(s_page));\n\t} else {\n\t\thibernate_map_page(s_page);\n\t\tdo_copy_page(dst, page_address(s_page));\n\t\thibernate_unmap_page(s_page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pfn_to_page",
          "args": [
            "src_pfn"
          ],
          "line": 1447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "pfn_to_page(dst_pfn)"
          ],
          "line": 1446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfn_to_page",
          "args": [
            "dst_pfn"
          ],
          "line": 1446
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void copy_data_page(unsigned long dst_pfn, unsigned long src_pfn)\n{\n\tsafe_copy_page(page_address(pfn_to_page(dst_pfn)),\n\t\t\t\tpfn_to_page(src_pfn));\n}"
  },
  {
    "function_name": "copy_data_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1413-1440",
    "snippet": "static void copy_data_page(unsigned long dst_pfn, unsigned long src_pfn)\n{\n\tstruct page *s_page, *d_page;\n\tvoid *src, *dst;\n\n\ts_page = pfn_to_page(src_pfn);\n\td_page = pfn_to_page(dst_pfn);\n\tif (PageHighMem(s_page)) {\n\t\tsrc = kmap_atomic(s_page);\n\t\tdst = kmap_atomic(d_page);\n\t\tdo_copy_page(dst, src);\n\t\tkunmap_atomic(dst);\n\t\tkunmap_atomic(src);\n\t} else {\n\t\tif (PageHighMem(d_page)) {\n\t\t\t/*\n\t\t\t * The page pointed to by src may contain some kernel\n\t\t\t * data modified by kmap_atomic()\n\t\t\t */\n\t\t\tsafe_copy_page(buffer, s_page);\n\t\t\tdst = kmap_atomic(d_page);\n\t\t\tcopy_page(dst, buffer);\n\t\t\tkunmap_atomic(dst);\n\t\t} else {\n\t\t\tsafe_copy_page(page_address(d_page), s_page);\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);",
      "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;",
      "static void *buffer;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "safe_copy_page",
          "args": [
            "page_address(d_page)",
            "s_page"
          ],
          "line": 1437
        },
        "resolved": true,
        "details": {
          "function_name": "safe_copy_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1395-1404",
          "snippet": "static void safe_copy_page(void *dst, struct page *s_page)\n{\n\tif (kernel_page_present(s_page)) {\n\t\tdo_copy_page(dst, page_address(s_page));\n\t} else {\n\t\thibernate_map_page(s_page);\n\t\tdo_copy_page(dst, page_address(s_page));\n\t\thibernate_unmap_page(s_page);\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic void safe_copy_page(void *dst, struct page *s_page)\n{\n\tif (kernel_page_present(s_page)) {\n\t\tdo_copy_page(dst, page_address(s_page));\n\t} else {\n\t\thibernate_map_page(s_page);\n\t\tdo_copy_page(dst, page_address(s_page));\n\t\thibernate_unmap_page(s_page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "d_page"
          ],
          "line": 1437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "dst"
          ],
          "line": 1435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "d_page"
          ],
          "line": 1433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageHighMem",
          "args": [
            "d_page"
          ],
          "line": 1427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "src"
          ],
          "line": 1425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "dst"
          ],
          "line": 1424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_copy_page",
          "args": [
            "dst",
            "src"
          ],
          "line": 1423
        },
        "resolved": true,
        "details": {
          "function_name": "do_copy_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1379-1385",
          "snippet": "static inline void do_copy_page(long *dst, long *src)\n{\n\tint n;\n\n\tfor (n = PAGE_SIZE / sizeof(long); n; n--)\n\t\t*dst++ = *src++;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void do_copy_page(long *dst, long *src)\n{\n\tint n;\n\n\tfor (n = PAGE_SIZE / sizeof(long); n; n--)\n\t\t*dst++ = *src++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "d_page"
          ],
          "line": 1422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "s_page"
          ],
          "line": 1421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageHighMem",
          "args": [
            "s_page"
          ],
          "line": 1420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfn_to_page",
          "args": [
            "dst_pfn"
          ],
          "line": 1419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfn_to_page",
          "args": [
            "src_pfn"
          ],
          "line": 1418
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\nstatic void *buffer;\n\nstatic void copy_data_page(unsigned long dst_pfn, unsigned long src_pfn)\n{\n\tstruct page *s_page, *d_page;\n\tvoid *src, *dst;\n\n\ts_page = pfn_to_page(src_pfn);\n\td_page = pfn_to_page(dst_pfn);\n\tif (PageHighMem(s_page)) {\n\t\tsrc = kmap_atomic(s_page);\n\t\tdst = kmap_atomic(d_page);\n\t\tdo_copy_page(dst, src);\n\t\tkunmap_atomic(dst);\n\t\tkunmap_atomic(src);\n\t} else {\n\t\tif (PageHighMem(d_page)) {\n\t\t\t/*\n\t\t\t * The page pointed to by src may contain some kernel\n\t\t\t * data modified by kmap_atomic()\n\t\t\t */\n\t\t\tsafe_copy_page(buffer, s_page);\n\t\t\tdst = kmap_atomic(d_page);\n\t\t\tcopy_page(dst, buffer);\n\t\t\tkunmap_atomic(dst);\n\t\t} else {\n\t\t\tsafe_copy_page(page_address(d_page), s_page);\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "page_is_saveable",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1407-1411",
    "snippet": "static inline struct page *page_is_saveable(struct zone *zone, unsigned long pfn)\n{\n\treturn is_highmem(zone) ?\n\t\tsaveable_highmem_page(zone, pfn) : saveable_page(zone, pfn);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "saveable_page",
          "args": [
            "zone",
            "pfn"
          ],
          "line": 1410
        },
        "resolved": true,
        "details": {
          "function_name": "saveable_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1324-1351",
          "snippet": "static struct page *saveable_page(struct zone *zone, unsigned long pfn)\n{\n\tstruct page *page;\n\n\tif (!pfn_valid(pfn))\n\t\treturn NULL;\n\n\tpage = pfn_to_online_page(pfn);\n\tif (!page || page_zone(page) != zone)\n\t\treturn NULL;\n\n\tBUG_ON(PageHighMem(page));\n\n\tif (swsusp_page_is_forbidden(page) || swsusp_page_is_free(page))\n\t\treturn NULL;\n\n\tif (PageOffline(page))\n\t\treturn NULL;\n\n\tif (PageReserved(page)\n\t    && (!kernel_page_present(page) || pfn_is_nosave(pfn)))\n\t\treturn NULL;\n\n\tif (page_is_guard(page))\n\t\treturn NULL;\n\n\treturn page;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic struct page *saveable_page(struct zone *zone, unsigned long pfn)\n{\n\tstruct page *page;\n\n\tif (!pfn_valid(pfn))\n\t\treturn NULL;\n\n\tpage = pfn_to_online_page(pfn);\n\tif (!page || page_zone(page) != zone)\n\t\treturn NULL;\n\n\tBUG_ON(PageHighMem(page));\n\n\tif (swsusp_page_is_forbidden(page) || swsusp_page_is_free(page))\n\t\treturn NULL;\n\n\tif (PageOffline(page))\n\t\treturn NULL;\n\n\tif (PageReserved(page)\n\t    && (!kernel_page_present(page) || pfn_is_nosave(pfn)))\n\t\treturn NULL;\n\n\tif (page_is_guard(page))\n\t\treturn NULL;\n\n\treturn page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "saveable_highmem_page",
          "args": [
            "zone",
            "pfn"
          ],
          "line": 1410
        },
        "resolved": true,
        "details": {
          "function_name": "saveable_highmem_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1308-1311",
          "snippet": "static inline void *saveable_highmem_page(struct zone *z, unsigned long p)\n{\n\treturn NULL;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void *saveable_highmem_page(struct zone *z, unsigned long p)\n{\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_highmem",
          "args": [
            "zone"
          ],
          "line": 1409
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic inline struct page *page_is_saveable(struct zone *zone, unsigned long pfn)\n{\n\treturn is_highmem(zone) ?\n\t\tsaveable_highmem_page(zone, pfn) : saveable_page(zone, pfn);\n}"
  },
  {
    "function_name": "safe_copy_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1395-1404",
    "snippet": "static void safe_copy_page(void *dst, struct page *s_page)\n{\n\tif (kernel_page_present(s_page)) {\n\t\tdo_copy_page(dst, page_address(s_page));\n\t} else {\n\t\thibernate_map_page(s_page);\n\t\tdo_copy_page(dst, page_address(s_page));\n\t\thibernate_unmap_page(s_page);\n\t}\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hibernate_unmap_page",
          "args": [
            "s_page"
          ],
          "line": 1402
        },
        "resolved": true,
        "details": {
          "function_name": "hibernate_unmap_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "98-111",
          "snippet": "static inline void hibernate_unmap_page(struct page *page)\n{\n\tif (IS_ENABLED(CONFIG_ARCH_HAS_SET_DIRECT_MAP)) {\n\t\tunsigned long addr = (unsigned long)page_address(page);\n\t\tint ret  = set_direct_map_invalid_noflush(page);\n\n\t\tif (ret)\n\t\t\tpr_warn_once(\"Failed to remap page\\n\");\n\n\t\tflush_tlb_kernel_range(addr, addr + PAGE_SIZE);\n\t} else {\n\t\tdebug_pagealloc_unmap_pages(page, 1);\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic inline void hibernate_unmap_page(struct page *page)\n{\n\tif (IS_ENABLED(CONFIG_ARCH_HAS_SET_DIRECT_MAP)) {\n\t\tunsigned long addr = (unsigned long)page_address(page);\n\t\tint ret  = set_direct_map_invalid_noflush(page);\n\n\t\tif (ret)\n\t\t\tpr_warn_once(\"Failed to remap page\\n\");\n\n\t\tflush_tlb_kernel_range(addr, addr + PAGE_SIZE);\n\t} else {\n\t\tdebug_pagealloc_unmap_pages(page, 1);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_copy_page",
          "args": [
            "dst",
            "page_address(s_page)"
          ],
          "line": 1401
        },
        "resolved": true,
        "details": {
          "function_name": "do_copy_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1379-1385",
          "snippet": "static inline void do_copy_page(long *dst, long *src)\n{\n\tint n;\n\n\tfor (n = PAGE_SIZE / sizeof(long); n; n--)\n\t\t*dst++ = *src++;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void do_copy_page(long *dst, long *src)\n{\n\tint n;\n\n\tfor (n = PAGE_SIZE / sizeof(long); n; n--)\n\t\t*dst++ = *src++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "s_page"
          ],
          "line": 1401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hibernate_map_page",
          "args": [
            "s_page"
          ],
          "line": 1400
        },
        "resolved": true,
        "details": {
          "function_name": "hibernate_map_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "86-96",
          "snippet": "static inline void hibernate_map_page(struct page *page)\n{\n\tif (IS_ENABLED(CONFIG_ARCH_HAS_SET_DIRECT_MAP)) {\n\t\tint ret = set_direct_map_default_noflush(page);\n\n\t\tif (ret)\n\t\t\tpr_warn_once(\"Failed to remap page\\n\");\n\t} else {\n\t\tdebug_pagealloc_map_pages(page, 1);\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic inline void hibernate_map_page(struct page *page)\n{\n\tif (IS_ENABLED(CONFIG_ARCH_HAS_SET_DIRECT_MAP)) {\n\t\tint ret = set_direct_map_default_noflush(page);\n\n\t\tif (ret)\n\t\t\tpr_warn_once(\"Failed to remap page\\n\");\n\t} else {\n\t\tdebug_pagealloc_map_pages(page, 1);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "s_page"
          ],
          "line": 1398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kernel_page_present",
          "args": [
            "s_page"
          ],
          "line": 1397
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic void safe_copy_page(void *dst, struct page *s_page)\n{\n\tif (kernel_page_present(s_page)) {\n\t\tdo_copy_page(dst, page_address(s_page));\n\t} else {\n\t\thibernate_map_page(s_page);\n\t\tdo_copy_page(dst, page_address(s_page));\n\t\thibernate_unmap_page(s_page);\n\t}\n}"
  },
  {
    "function_name": "do_copy_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1379-1385",
    "snippet": "static inline void do_copy_page(long *dst, long *src)\n{\n\tint n;\n\n\tfor (n = PAGE_SIZE / sizeof(long); n; n--)\n\t\t*dst++ = *src++;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void do_copy_page(long *dst, long *src)\n{\n\tint n;\n\n\tfor (n = PAGE_SIZE / sizeof(long); n; n--)\n\t\t*dst++ = *src++;\n}"
  },
  {
    "function_name": "count_data_pages",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1356-1373",
    "snippet": "static unsigned int count_data_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned long pfn, max_zone_pfn;\n\tunsigned int n = 0;\n\n\tfor_each_populated_zone(zone) {\n\t\tif (is_highmem(zone))\n\t\t\tcontinue;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (saveable_page(zone, pfn))\n\t\t\t\tn++;\n\t}\n\treturn n;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "saveable_page",
          "args": [
            "zone",
            "pfn"
          ],
          "line": 1369
        },
        "resolved": true,
        "details": {
          "function_name": "saveable_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1324-1351",
          "snippet": "static struct page *saveable_page(struct zone *zone, unsigned long pfn)\n{\n\tstruct page *page;\n\n\tif (!pfn_valid(pfn))\n\t\treturn NULL;\n\n\tpage = pfn_to_online_page(pfn);\n\tif (!page || page_zone(page) != zone)\n\t\treturn NULL;\n\n\tBUG_ON(PageHighMem(page));\n\n\tif (swsusp_page_is_forbidden(page) || swsusp_page_is_free(page))\n\t\treturn NULL;\n\n\tif (PageOffline(page))\n\t\treturn NULL;\n\n\tif (PageReserved(page)\n\t    && (!kernel_page_present(page) || pfn_is_nosave(pfn)))\n\t\treturn NULL;\n\n\tif (page_is_guard(page))\n\t\treturn NULL;\n\n\treturn page;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic struct page *saveable_page(struct zone *zone, unsigned long pfn)\n{\n\tstruct page *page;\n\n\tif (!pfn_valid(pfn))\n\t\treturn NULL;\n\n\tpage = pfn_to_online_page(pfn);\n\tif (!page || page_zone(page) != zone)\n\t\treturn NULL;\n\n\tBUG_ON(PageHighMem(page));\n\n\tif (swsusp_page_is_forbidden(page) || swsusp_page_is_free(page))\n\t\treturn NULL;\n\n\tif (PageOffline(page))\n\t\treturn NULL;\n\n\tif (PageReserved(page)\n\t    && (!kernel_page_present(page) || pfn_is_nosave(pfn)))\n\t\treturn NULL;\n\n\tif (page_is_guard(page))\n\t\treturn NULL;\n\n\treturn page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "zone_end_pfn",
          "args": [
            "zone"
          ],
          "line": 1367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mark_free_pages",
          "args": [
            "zone"
          ],
          "line": 1366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_highmem",
          "args": [
            "zone"
          ],
          "line": 1363
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int count_data_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned long pfn, max_zone_pfn;\n\tunsigned int n = 0;\n\n\tfor_each_populated_zone(zone) {\n\t\tif (is_highmem(zone))\n\t\t\tcontinue;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (saveable_page(zone, pfn))\n\t\t\t\tn++;\n\t}\n\treturn n;\n}"
  },
  {
    "function_name": "saveable_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1324-1351",
    "snippet": "static struct page *saveable_page(struct zone *zone, unsigned long pfn)\n{\n\tstruct page *page;\n\n\tif (!pfn_valid(pfn))\n\t\treturn NULL;\n\n\tpage = pfn_to_online_page(pfn);\n\tif (!page || page_zone(page) != zone)\n\t\treturn NULL;\n\n\tBUG_ON(PageHighMem(page));\n\n\tif (swsusp_page_is_forbidden(page) || swsusp_page_is_free(page))\n\t\treturn NULL;\n\n\tif (PageOffline(page))\n\t\treturn NULL;\n\n\tif (PageReserved(page)\n\t    && (!kernel_page_present(page) || pfn_is_nosave(pfn)))\n\t\treturn NULL;\n\n\tif (page_is_guard(page))\n\t\treturn NULL;\n\n\treturn page;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "page_is_guard",
          "args": [
            "page"
          ],
          "line": 1347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfn_is_nosave",
          "args": [
            "pfn"
          ],
          "line": 1344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kernel_page_present",
          "args": [
            "page"
          ],
          "line": 1344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageReserved",
          "args": [
            "page"
          ],
          "line": 1343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageOffline",
          "args": [
            "page"
          ],
          "line": 1340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swsusp_page_is_free",
          "args": [
            "page"
          ],
          "line": 1337
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_page_is_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1039-1043",
          "snippet": "static int swsusp_page_is_free(struct page *page)\n{\n\treturn free_pages_map ?\n\t\tmemory_bm_test_bit(free_pages_map, page_to_pfn(page)) : 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *free_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *free_pages_map;\n\nstatic int swsusp_page_is_free(struct page *page)\n{\n\treturn free_pages_map ?\n\t\tmemory_bm_test_bit(free_pages_map, page_to_pfn(page)) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "swsusp_page_is_forbidden",
          "args": [
            "page"
          ],
          "line": 1337
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_page_is_forbidden",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1057-1061",
          "snippet": "int swsusp_page_is_forbidden(struct page *page)\n{\n\treturn forbidden_pages_map ?\n\t\tmemory_bm_test_bit(forbidden_pages_map, page_to_pfn(page)) : 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *forbidden_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *forbidden_pages_map;\n\nint swsusp_page_is_forbidden(struct page *page)\n{\n\treturn forbidden_pages_map ?\n\t\tmemory_bm_test_bit(forbidden_pages_map, page_to_pfn(page)) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "PageHighMem(page)"
          ],
          "line": 1335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageHighMem",
          "args": [
            "page"
          ],
          "line": 1335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_zone",
          "args": [
            "page"
          ],
          "line": 1332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfn_to_online_page",
          "args": [
            "pfn"
          ],
          "line": 1331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfn_valid",
          "args": [
            "pfn"
          ],
          "line": 1328
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic struct page *saveable_page(struct zone *zone, unsigned long pfn)\n{\n\tstruct page *page;\n\n\tif (!pfn_valid(pfn))\n\t\treturn NULL;\n\n\tpage = pfn_to_online_page(pfn);\n\tif (!page || page_zone(page) != zone)\n\t\treturn NULL;\n\n\tBUG_ON(PageHighMem(page));\n\n\tif (swsusp_page_is_forbidden(page) || swsusp_page_is_free(page))\n\t\treturn NULL;\n\n\tif (PageOffline(page))\n\t\treturn NULL;\n\n\tif (PageReserved(page)\n\t    && (!kernel_page_present(page) || pfn_is_nosave(pfn)))\n\t\treturn NULL;\n\n\tif (page_is_guard(page))\n\t\treturn NULL;\n\n\treturn page;\n}"
  },
  {
    "function_name": "saveable_highmem_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1308-1311",
    "snippet": "static inline void *saveable_highmem_page(struct zone *z, unsigned long p)\n{\n\treturn NULL;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void *saveable_highmem_page(struct zone *z, unsigned long p)\n{\n\treturn NULL;\n}"
  },
  {
    "function_name": "count_highmem_pages",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1288-1306",
    "snippet": "static unsigned int count_highmem_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned int n = 0;\n\n\tfor_each_populated_zone(zone) {\n\t\tunsigned long pfn, max_zone_pfn;\n\n\t\tif (!is_highmem(zone))\n\t\t\tcontinue;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (saveable_highmem_page(zone, pfn))\n\t\t\t\tn++;\n\t}\n\treturn n;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "saveable_highmem_page",
          "args": [
            "zone",
            "pfn"
          ],
          "line": 1302
        },
        "resolved": true,
        "details": {
          "function_name": "saveable_highmem_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1308-1311",
          "snippet": "static inline void *saveable_highmem_page(struct zone *z, unsigned long p)\n{\n\treturn NULL;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void *saveable_highmem_page(struct zone *z, unsigned long p)\n{\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "zone_end_pfn",
          "args": [
            "zone"
          ],
          "line": 1300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mark_free_pages",
          "args": [
            "zone"
          ],
          "line": 1299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_highmem",
          "args": [
            "zone"
          ],
          "line": 1296
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int count_highmem_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned int n = 0;\n\n\tfor_each_populated_zone(zone) {\n\t\tunsigned long pfn, max_zone_pfn;\n\n\t\tif (!is_highmem(zone))\n\t\t\tcontinue;\n\n\t\tmark_free_pages(zone);\n\t\tmax_zone_pfn = zone_end_pfn(zone);\n\t\tfor (pfn = zone->zone_start_pfn; pfn < max_zone_pfn; pfn++)\n\t\t\tif (saveable_highmem_page(zone, pfn))\n\t\t\t\tn++;\n\t}\n\treturn n;\n}"
  },
  {
    "function_name": "saveable_highmem_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1260-1283",
    "snippet": "static struct page *saveable_highmem_page(struct zone *zone, unsigned long pfn)\n{\n\tstruct page *page;\n\n\tif (!pfn_valid(pfn))\n\t\treturn NULL;\n\n\tpage = pfn_to_online_page(pfn);\n\tif (!page || page_zone(page) != zone)\n\t\treturn NULL;\n\n\tBUG_ON(!PageHighMem(page));\n\n\tif (swsusp_page_is_forbidden(page) ||  swsusp_page_is_free(page))\n\t\treturn NULL;\n\n\tif (PageReserved(page) || PageOffline(page))\n\t\treturn NULL;\n\n\tif (page_is_guard(page))\n\t\treturn NULL;\n\n\treturn page;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "page_is_guard",
          "args": [
            "page"
          ],
          "line": 1279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageOffline",
          "args": [
            "page"
          ],
          "line": 1276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageReserved",
          "args": [
            "page"
          ],
          "line": 1276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swsusp_page_is_free",
          "args": [
            "page"
          ],
          "line": 1273
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_page_is_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1039-1043",
          "snippet": "static int swsusp_page_is_free(struct page *page)\n{\n\treturn free_pages_map ?\n\t\tmemory_bm_test_bit(free_pages_map, page_to_pfn(page)) : 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *free_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *free_pages_map;\n\nstatic int swsusp_page_is_free(struct page *page)\n{\n\treturn free_pages_map ?\n\t\tmemory_bm_test_bit(free_pages_map, page_to_pfn(page)) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "swsusp_page_is_forbidden",
          "args": [
            "page"
          ],
          "line": 1273
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_page_is_forbidden",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1057-1061",
          "snippet": "int swsusp_page_is_forbidden(struct page *page)\n{\n\treturn forbidden_pages_map ?\n\t\tmemory_bm_test_bit(forbidden_pages_map, page_to_pfn(page)) : 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *forbidden_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *forbidden_pages_map;\n\nint swsusp_page_is_forbidden(struct page *page)\n{\n\treturn forbidden_pages_map ?\n\t\tmemory_bm_test_bit(forbidden_pages_map, page_to_pfn(page)) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!PageHighMem(page)"
          ],
          "line": 1271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageHighMem",
          "args": [
            "page"
          ],
          "line": 1271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_zone",
          "args": [
            "page"
          ],
          "line": 1268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfn_to_online_page",
          "args": [
            "pfn"
          ],
          "line": 1267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfn_valid",
          "args": [
            "pfn"
          ],
          "line": 1264
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic struct page *saveable_highmem_page(struct zone *zone, unsigned long pfn)\n{\n\tstruct page *page;\n\n\tif (!pfn_valid(pfn))\n\t\treturn NULL;\n\n\tpage = pfn_to_online_page(pfn);\n\tif (!page || page_zone(page) != zone)\n\t\treturn NULL;\n\n\tBUG_ON(!PageHighMem(page));\n\n\tif (swsusp_page_is_forbidden(page) ||  swsusp_page_is_free(page))\n\t\treturn NULL;\n\n\tif (PageReserved(page) || PageOffline(page))\n\t\treturn NULL;\n\n\tif (page_is_guard(page))\n\t\treturn NULL;\n\n\treturn page;\n}"
  },
  {
    "function_name": "count_free_highmem_pages",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1240-1250",
    "snippet": "static unsigned int count_free_highmem_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned int cnt = 0;\n\n\tfor_each_populated_zone(zone)\n\t\tif (is_highmem(zone))\n\t\t\tcnt += zone_page_state(zone, NR_FREE_PAGES);\n\n\treturn cnt;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zone_page_state",
          "args": [
            "zone",
            "NR_FREE_PAGES"
          ],
          "line": 1247
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic unsigned int count_free_highmem_pages(void)\n{\n\tstruct zone *zone;\n\tunsigned int cnt = 0;\n\n\tfor_each_populated_zone(zone)\n\t\tif (is_highmem(zone))\n\t\t\tcnt += zone_page_state(zone, NR_FREE_PAGES);\n\n\treturn cnt;\n}"
  },
  {
    "function_name": "snapshot_additional_pages",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1219-1232",
    "snippet": "unsigned int snapshot_additional_pages(struct zone *zone)\n{\n\tunsigned int rtree, nodes;\n\n\trtree = nodes = DIV_ROUND_UP(zone->spanned_pages, BM_BITS_PER_BLOCK);\n\trtree += DIV_ROUND_UP(rtree * sizeof(struct rtree_node),\n\t\t\t      LINKED_PAGE_DATA_SIZE);\n\twhile (nodes > 1) {\n\t\tnodes = DIV_ROUND_UP(nodes, BM_ENTRIES_PER_LEVEL);\n\t\trtree += nodes;\n\t}\n\n\treturn 2 * rtree;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define BM_ENTRIES_PER_LEVEL\t(PAGE_SIZE / sizeof(unsigned long))",
      "#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)",
      "#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "nodes",
            "BM_ENTRIES_PER_LEVEL"
          ],
          "line": 1227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "rtree * sizeof(struct rtree_node)",
            "LINKED_PAGE_DATA_SIZE"
          ],
          "line": 1224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "zone->spanned_pages",
            "BM_BITS_PER_BLOCK"
          ],
          "line": 1223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_ENTRIES_PER_LEVEL\t(PAGE_SIZE / sizeof(unsigned long))\n#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)\n#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))\n\nunsigned int snapshot_additional_pages(struct zone *zone)\n{\n\tunsigned int rtree, nodes;\n\n\trtree = nodes = DIV_ROUND_UP(zone->spanned_pages, BM_BITS_PER_BLOCK);\n\trtree += DIV_ROUND_UP(rtree * sizeof(struct rtree_node),\n\t\t\t      LINKED_PAGE_DATA_SIZE);\n\twhile (nodes > 1) {\n\t\tnodes = DIV_ROUND_UP(nodes, BM_ENTRIES_PER_LEVEL);\n\t\trtree += nodes;\n\t}\n\n\treturn 2 * rtree;\n}"
  },
  {
    "function_name": "clear_or_poison_free_pages",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1189-1209",
    "snippet": "void clear_or_poison_free_pages(void)\n{\n\tstruct memory_bitmap *bm = free_pages_map;\n\tunsigned long pfn;\n\n\tif (WARN_ON(!(free_pages_map)))\n\t\treturn;\n\n\tif (page_poisoning_enabled() || want_init_on_free()) {\n\t\tmemory_bm_position_reset(bm);\n\t\tpfn = memory_bm_next_pfn(bm);\n\t\twhile (pfn != BM_END_OF_MAP) {\n\t\t\tif (pfn_valid(pfn))\n\t\t\t\tclear_or_poison_free_page(pfn_to_page(pfn));\n\n\t\t\tpfn = memory_bm_next_pfn(bm);\n\t\t}\n\t\tmemory_bm_position_reset(bm);\n\t\tpr_info(\"free pages cleared after restore\\n\");\n\t}\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define BM_END_OF_MAP\t(~0UL)"
    ],
    "globals_used": [
      "static struct memory_bitmap *free_pages_map;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"free pages cleared after restore\\n\""
          ],
          "line": 1207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_bm_position_reset",
          "args": [
            "bm"
          ],
          "line": 1206
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_position_reset",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "581-589",
          "snippet": "static void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_next_pfn",
          "args": [
            "bm"
          ],
          "line": 1204
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_next_pfn",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "915-933",
          "snippet": "static unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)",
            "#define BM_END_OF_MAP\t(~0UL)"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)\n#define BM_END_OF_MAP\t(~0UL)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}"
        }
      },
      {
        "call_info": {
          "callee": "clear_or_poison_free_page",
          "args": [
            "pfn_to_page(pfn)"
          ],
          "line": 1202
        },
        "resolved": true,
        "details": {
          "function_name": "clear_or_poison_free_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1181-1187",
          "snippet": "static void clear_or_poison_free_page(struct page *page)\n{\n\tif (page_poisoning_enabled_static())\n\t\t__kernel_poison_pages(page, 1);\n\telse if (want_init_on_free())\n\t\tclear_highpage(page);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic void clear_or_poison_free_page(struct page *page)\n{\n\tif (page_poisoning_enabled_static())\n\t\t__kernel_poison_pages(page, 1);\n\telse if (want_init_on_free())\n\t\tclear_highpage(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pfn_to_page",
          "args": [
            "pfn"
          ],
          "line": 1202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfn_valid",
          "args": [
            "pfn"
          ],
          "line": 1201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "want_init_on_free",
          "args": [],
          "line": 1197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_poisoning_enabled",
          "args": [],
          "line": 1197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!(free_pages_map)"
          ],
          "line": 1194
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_END_OF_MAP\t(~0UL)\n\nstatic struct memory_bitmap *free_pages_map;\n\nvoid clear_or_poison_free_pages(void)\n{\n\tstruct memory_bitmap *bm = free_pages_map;\n\tunsigned long pfn;\n\n\tif (WARN_ON(!(free_pages_map)))\n\t\treturn;\n\n\tif (page_poisoning_enabled() || want_init_on_free()) {\n\t\tmemory_bm_position_reset(bm);\n\t\tpfn = memory_bm_next_pfn(bm);\n\t\twhile (pfn != BM_END_OF_MAP) {\n\t\t\tif (pfn_valid(pfn))\n\t\t\t\tclear_or_poison_free_page(pfn_to_page(pfn));\n\n\t\t\tpfn = memory_bm_next_pfn(bm);\n\t\t}\n\t\tmemory_bm_position_reset(bm);\n\t\tpr_info(\"free pages cleared after restore\\n\");\n\t}\n}"
  },
  {
    "function_name": "clear_or_poison_free_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1181-1187",
    "snippet": "static void clear_or_poison_free_page(struct page *page)\n{\n\tif (page_poisoning_enabled_static())\n\t\t__kernel_poison_pages(page, 1);\n\telse if (want_init_on_free())\n\t\tclear_highpage(page);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "clear_highpage",
          "args": [
            "page"
          ],
          "line": 1186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "want_init_on_free",
          "args": [],
          "line": 1185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__kernel_poison_pages",
          "args": [
            "page",
            "1"
          ],
          "line": 1184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_poisoning_enabled_static",
          "args": [],
          "line": 1183
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic void clear_or_poison_free_page(struct page *page)\n{\n\tif (page_poisoning_enabled_static())\n\t\t__kernel_poison_pages(page, 1);\n\telse if (want_init_on_free())\n\t\tclear_highpage(page);\n}"
  },
  {
    "function_name": "free_basic_memory_bitmaps",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1162-1179",
    "snippet": "void free_basic_memory_bitmaps(void)\n{\n\tstruct memory_bitmap *bm1, *bm2;\n\n\tif (WARN_ON(!(forbidden_pages_map && free_pages_map)))\n\t\treturn;\n\n\tbm1 = forbidden_pages_map;\n\tbm2 = free_pages_map;\n\tforbidden_pages_map = NULL;\n\tfree_pages_map = NULL;\n\tmemory_bm_free(bm1, PG_UNSAFE_CLEAR);\n\tkfree(bm1);\n\tmemory_bm_free(bm2, PG_UNSAFE_CLEAR);\n\tkfree(bm2);\n\n\tpr_debug(\"Basic memory bitmaps freed\\n\");\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define PG_UNSAFE_CLEAR\t1"
    ],
    "globals_used": [
      "static struct memory_bitmap *forbidden_pages_map;",
      "static struct memory_bitmap *free_pages_map;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"Basic memory bitmaps freed\\n\""
          ],
          "line": 1178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "bm2"
          ],
          "line": 1176
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/params.c",
          "lines": "62-75",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/security.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/security.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_free",
          "args": [
            "bm2",
            "PG_UNSAFE_CLEAR"
          ],
          "line": 1175
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "719-729",
          "snippet": "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\n\tlist_for_each_entry(zone, &bm->zones, list)\n\t\tfree_zone_bm_rtree(zone, clear_nosave_free);\n\n\tfree_list_of_pages(bm->p_list, clear_nosave_free);\n\n\tINIT_LIST_HEAD(&bm->zones);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);",
            "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);\n\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\n\tlist_for_each_entry(zone, &bm->zones, list)\n\t\tfree_zone_bm_rtree(zone, clear_nosave_free);\n\n\tfree_list_of_pages(bm->p_list, clear_nosave_free);\n\n\tINIT_LIST_HEAD(&bm->zones);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!(forbidden_pages_map && free_pages_map)"
          ],
          "line": 1166
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_UNSAFE_CLEAR\t1\n\nstatic struct memory_bitmap *forbidden_pages_map;\nstatic struct memory_bitmap *free_pages_map;\n\nvoid free_basic_memory_bitmaps(void)\n{\n\tstruct memory_bitmap *bm1, *bm2;\n\n\tif (WARN_ON(!(forbidden_pages_map && free_pages_map)))\n\t\treturn;\n\n\tbm1 = forbidden_pages_map;\n\tbm2 = free_pages_map;\n\tforbidden_pages_map = NULL;\n\tfree_pages_map = NULL;\n\tmemory_bm_free(bm1, PG_UNSAFE_CLEAR);\n\tkfree(bm1);\n\tmemory_bm_free(bm2, PG_UNSAFE_CLEAR);\n\tkfree(bm2);\n\n\tpr_debug(\"Basic memory bitmaps freed\\n\");\n}"
  },
  {
    "function_name": "create_basic_memory_bitmaps",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1112-1153",
    "snippet": "int create_basic_memory_bitmaps(void)\n{\n\tstruct memory_bitmap *bm1, *bm2;\n\tint error = 0;\n\n\tif (forbidden_pages_map && free_pages_map)\n\t\treturn 0;\n\telse\n\t\tBUG_ON(forbidden_pages_map || free_pages_map);\n\n\tbm1 = kzalloc(sizeof(struct memory_bitmap), GFP_KERNEL);\n\tif (!bm1)\n\t\treturn -ENOMEM;\n\n\terror = memory_bm_create(bm1, GFP_KERNEL, PG_ANY);\n\tif (error)\n\t\tgoto Free_first_object;\n\n\tbm2 = kzalloc(sizeof(struct memory_bitmap), GFP_KERNEL);\n\tif (!bm2)\n\t\tgoto Free_first_bitmap;\n\n\terror = memory_bm_create(bm2, GFP_KERNEL, PG_ANY);\n\tif (error)\n\t\tgoto Free_second_object;\n\n\tforbidden_pages_map = bm1;\n\tfree_pages_map = bm2;\n\tmark_nosave_pages(forbidden_pages_map);\n\n\tpr_debug(\"Basic memory bitmaps created\\n\");\n\n\treturn 0;\n\n Free_second_object:\n\tkfree(bm2);\n Free_first_bitmap:\n\tmemory_bm_free(bm1, PG_UNSAFE_CLEAR);\n Free_first_object:\n\tkfree(bm1);\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define PG_UNSAFE_CLEAR\t1",
      "#define PG_ANY\t\t0"
    ],
    "globals_used": [
      "static struct memory_bitmap *forbidden_pages_map;",
      "static struct memory_bitmap *free_pages_map;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "bm1"
          ],
          "line": 1151
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/params.c",
          "lines": "62-75",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/security.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/security.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_free",
          "args": [
            "bm1",
            "PG_UNSAFE_CLEAR"
          ],
          "line": 1149
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "719-729",
          "snippet": "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\n\tlist_for_each_entry(zone, &bm->zones, list)\n\t\tfree_zone_bm_rtree(zone, clear_nosave_free);\n\n\tfree_list_of_pages(bm->p_list, clear_nosave_free);\n\n\tINIT_LIST_HEAD(&bm->zones);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);",
            "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);\n\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\n\tlist_for_each_entry(zone, &bm->zones, list)\n\t\tfree_zone_bm_rtree(zone, clear_nosave_free);\n\n\tfree_list_of_pages(bm->p_list, clear_nosave_free);\n\n\tINIT_LIST_HEAD(&bm->zones);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"Basic memory bitmaps created\\n\""
          ],
          "line": 1142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mark_nosave_pages",
          "args": [
            "forbidden_pages_map"
          ],
          "line": 1140
        },
        "resolved": true,
        "details": {
          "function_name": "mark_nosave_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1076-1102",
          "snippet": "static void mark_nosave_pages(struct memory_bitmap *bm)\n{\n\tstruct nosave_region *region;\n\n\tif (list_empty(&nosave_regions))\n\t\treturn;\n\n\tlist_for_each_entry(region, &nosave_regions, list) {\n\t\tunsigned long pfn;\n\n\t\tpr_debug(\"Marking nosave pages: [mem %#010llx-%#010llx]\\n\",\n\t\t\t (unsigned long long) region->start_pfn << PAGE_SHIFT,\n\t\t\t ((unsigned long long) region->end_pfn << PAGE_SHIFT)\n\t\t\t\t- 1);\n\n\t\tfor (pfn = region->start_pfn; pfn < region->end_pfn; pfn++)\n\t\t\tif (pfn_valid(pfn)) {\n\t\t\t\t/*\n\t\t\t\t * It is safe to ignore the result of\n\t\t\t\t * mem_bm_set_bit_check() here, since we won't\n\t\t\t\t * touch the PFNs for which the error is\n\t\t\t\t * returned anyway.\n\t\t\t\t */\n\t\t\t\tmem_bm_set_bit_check(bm, pfn);\n\t\t\t}\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(nosave_regions);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic LIST_HEAD(nosave_regions);\n\nstatic void mark_nosave_pages(struct memory_bitmap *bm)\n{\n\tstruct nosave_region *region;\n\n\tif (list_empty(&nosave_regions))\n\t\treturn;\n\n\tlist_for_each_entry(region, &nosave_regions, list) {\n\t\tunsigned long pfn;\n\n\t\tpr_debug(\"Marking nosave pages: [mem %#010llx-%#010llx]\\n\",\n\t\t\t (unsigned long long) region->start_pfn << PAGE_SHIFT,\n\t\t\t ((unsigned long long) region->end_pfn << PAGE_SHIFT)\n\t\t\t\t- 1);\n\n\t\tfor (pfn = region->start_pfn; pfn < region->end_pfn; pfn++)\n\t\t\tif (pfn_valid(pfn)) {\n\t\t\t\t/*\n\t\t\t\t * It is safe to ignore the result of\n\t\t\t\t * mem_bm_set_bit_check() here, since we won't\n\t\t\t\t * touch the PFNs for which the error is\n\t\t\t\t * returned anyway.\n\t\t\t\t */\n\t\t\t\tmem_bm_set_bit_check(bm, pfn);\n\t\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_create",
          "args": [
            "bm2",
            "GFP_KERNEL",
            "PG_ANY"
          ],
          "line": 1134
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_create",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "676-713",
          "snippet": "static int memory_bm_create(struct memory_bitmap *bm, gfp_t gfp_mask,\n\t\t\t    int safe_needed)\n{\n\tstruct chain_allocator ca;\n\tstruct list_head mem_extents;\n\tstruct mem_extent *ext;\n\tint error;\n\n\tchain_init(&ca, gfp_mask, safe_needed);\n\tINIT_LIST_HEAD(&bm->zones);\n\n\terror = create_mem_extents(&mem_extents, gfp_mask);\n\tif (error)\n\t\treturn error;\n\n\tlist_for_each_entry(ext, &mem_extents, hook) {\n\t\tstruct mem_zone_bm_rtree *zone;\n\n\t\tzone = create_zone_bm_rtree(gfp_mask, safe_needed, &ca,\n\t\t\t\t\t    ext->start, ext->end);\n\t\tif (!zone) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Error;\n\t\t}\n\t\tlist_add_tail(&zone->list, &bm->zones);\n\t}\n\n\tbm->p_list = ca.chain;\n\tmemory_bm_position_reset(bm);\n Exit:\n\tfree_mem_extents(&mem_extents);\n\treturn error;\n\n Error:\n\tbm->p_list = ca.chain;\n\tmemory_bm_free(bm, PG_UNSAFE_CLEAR);\n\tgoto Exit;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define PG_UNSAFE_CLEAR\t1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_UNSAFE_CLEAR\t1\n\nstatic int memory_bm_create(struct memory_bitmap *bm, gfp_t gfp_mask,\n\t\t\t    int safe_needed)\n{\n\tstruct chain_allocator ca;\n\tstruct list_head mem_extents;\n\tstruct mem_extent *ext;\n\tint error;\n\n\tchain_init(&ca, gfp_mask, safe_needed);\n\tINIT_LIST_HEAD(&bm->zones);\n\n\terror = create_mem_extents(&mem_extents, gfp_mask);\n\tif (error)\n\t\treturn error;\n\n\tlist_for_each_entry(ext, &mem_extents, hook) {\n\t\tstruct mem_zone_bm_rtree *zone;\n\n\t\tzone = create_zone_bm_rtree(gfp_mask, safe_needed, &ca,\n\t\t\t\t\t    ext->start, ext->end);\n\t\tif (!zone) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Error;\n\t\t}\n\t\tlist_add_tail(&zone->list, &bm->zones);\n\t}\n\n\tbm->p_list = ca.chain;\n\tmemory_bm_position_reset(bm);\n Exit:\n\tfree_mem_extents(&mem_extents);\n\treturn error;\n\n Error:\n\tbm->p_list = ca.chain;\n\tmemory_bm_free(bm, PG_UNSAFE_CLEAR);\n\tgoto Exit;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct memory_bitmap)",
            "GFP_KERNEL"
          ],
          "line": 1130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct memory_bitmap)",
            "GFP_KERNEL"
          ],
          "line": 1122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "forbidden_pages_map || free_pages_map"
          ],
          "line": 1120
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_UNSAFE_CLEAR\t1\n#define PG_ANY\t\t0\n\nstatic struct memory_bitmap *forbidden_pages_map;\nstatic struct memory_bitmap *free_pages_map;\n\nint create_basic_memory_bitmaps(void)\n{\n\tstruct memory_bitmap *bm1, *bm2;\n\tint error = 0;\n\n\tif (forbidden_pages_map && free_pages_map)\n\t\treturn 0;\n\telse\n\t\tBUG_ON(forbidden_pages_map || free_pages_map);\n\n\tbm1 = kzalloc(sizeof(struct memory_bitmap), GFP_KERNEL);\n\tif (!bm1)\n\t\treturn -ENOMEM;\n\n\terror = memory_bm_create(bm1, GFP_KERNEL, PG_ANY);\n\tif (error)\n\t\tgoto Free_first_object;\n\n\tbm2 = kzalloc(sizeof(struct memory_bitmap), GFP_KERNEL);\n\tif (!bm2)\n\t\tgoto Free_first_bitmap;\n\n\terror = memory_bm_create(bm2, GFP_KERNEL, PG_ANY);\n\tif (error)\n\t\tgoto Free_second_object;\n\n\tforbidden_pages_map = bm1;\n\tfree_pages_map = bm2;\n\tmark_nosave_pages(forbidden_pages_map);\n\n\tpr_debug(\"Basic memory bitmaps created\\n\");\n\n\treturn 0;\n\n Free_second_object:\n\tkfree(bm2);\n Free_first_bitmap:\n\tmemory_bm_free(bm1, PG_UNSAFE_CLEAR);\n Free_first_object:\n\tkfree(bm1);\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "mark_nosave_pages",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1076-1102",
    "snippet": "static void mark_nosave_pages(struct memory_bitmap *bm)\n{\n\tstruct nosave_region *region;\n\n\tif (list_empty(&nosave_regions))\n\t\treturn;\n\n\tlist_for_each_entry(region, &nosave_regions, list) {\n\t\tunsigned long pfn;\n\n\t\tpr_debug(\"Marking nosave pages: [mem %#010llx-%#010llx]\\n\",\n\t\t\t (unsigned long long) region->start_pfn << PAGE_SHIFT,\n\t\t\t ((unsigned long long) region->end_pfn << PAGE_SHIFT)\n\t\t\t\t- 1);\n\n\t\tfor (pfn = region->start_pfn; pfn < region->end_pfn; pfn++)\n\t\t\tif (pfn_valid(pfn)) {\n\t\t\t\t/*\n\t\t\t\t * It is safe to ignore the result of\n\t\t\t\t * mem_bm_set_bit_check() here, since we won't\n\t\t\t\t * touch the PFNs for which the error is\n\t\t\t\t * returned anyway.\n\t\t\t\t */\n\t\t\t\tmem_bm_set_bit_check(bm, pfn);\n\t\t\t}\n\t}\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(nosave_regions);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mem_bm_set_bit_check",
          "args": [
            "bm",
            "pfn"
          ],
          "line": 1099
        },
        "resolved": true,
        "details": {
          "function_name": "mem_bm_set_bit_check",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "817-828",
          "snippet": "static int mem_bm_set_bit_check(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tif (!error)\n\t\tset_bit(bit, addr);\n\n\treturn error;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int mem_bm_set_bit_check(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tif (!error)\n\t\tset_bit(bit, addr);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pfn_valid",
          "args": [
            "pfn"
          ],
          "line": 1092
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"Marking nosave pages: [mem %#010llx-%#010llx]\\n\"",
            "(unsigned long long) region->start_pfn << PAGE_SHIFT",
            "((unsigned long long) region->end_pfn << PAGE_SHIFT)\n\t\t\t\t- 1"
          ],
          "line": 1086
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "region",
            "&nosave_regions",
            "list"
          ],
          "line": 1083
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&nosave_regions"
          ],
          "line": 1080
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_empty",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "41-44",
          "snippet": "static inline bool rcu_segcblist_empty(struct rcu_segcblist *rsclp)\n{\n\treturn !READ_ONCE(rsclp->head);\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_empty(struct rcu_segcblist *rsclp)\n{\n\treturn !READ_ONCE(rsclp->head);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic LIST_HEAD(nosave_regions);\n\nstatic void mark_nosave_pages(struct memory_bitmap *bm)\n{\n\tstruct nosave_region *region;\n\n\tif (list_empty(&nosave_regions))\n\t\treturn;\n\n\tlist_for_each_entry(region, &nosave_regions, list) {\n\t\tunsigned long pfn;\n\n\t\tpr_debug(\"Marking nosave pages: [mem %#010llx-%#010llx]\\n\",\n\t\t\t (unsigned long long) region->start_pfn << PAGE_SHIFT,\n\t\t\t ((unsigned long long) region->end_pfn << PAGE_SHIFT)\n\t\t\t\t- 1);\n\n\t\tfor (pfn = region->start_pfn; pfn < region->end_pfn; pfn++)\n\t\t\tif (pfn_valid(pfn)) {\n\t\t\t\t/*\n\t\t\t\t * It is safe to ignore the result of\n\t\t\t\t * mem_bm_set_bit_check() here, since we won't\n\t\t\t\t * touch the PFNs for which the error is\n\t\t\t\t * returned anyway.\n\t\t\t\t */\n\t\t\t\tmem_bm_set_bit_check(bm, pfn);\n\t\t\t}\n\t}\n}"
  },
  {
    "function_name": "swsusp_unset_page_forbidden",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1063-1067",
    "snippet": "static void swsusp_unset_page_forbidden(struct page *page)\n{\n\tif (forbidden_pages_map)\n\t\tmemory_bm_clear_bit(forbidden_pages_map, page_to_pfn(page));\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);",
      "static struct memory_bitmap *forbidden_pages_map;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memory_bm_clear_bit",
          "args": [
            "forbidden_pages_map",
            "page_to_pfn(page)"
          ],
          "line": 1066
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_clear_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "830-839",
          "snippet": "static void memory_bm_clear_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tclear_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_clear_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tclear_bit(bit, addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_to_pfn",
          "args": [
            "page"
          ],
          "line": 1066
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *forbidden_pages_map;\n\nstatic void swsusp_unset_page_forbidden(struct page *page)\n{\n\tif (forbidden_pages_map)\n\t\tmemory_bm_clear_bit(forbidden_pages_map, page_to_pfn(page));\n}"
  },
  {
    "function_name": "swsusp_page_is_forbidden",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1057-1061",
    "snippet": "int swsusp_page_is_forbidden(struct page *page)\n{\n\treturn forbidden_pages_map ?\n\t\tmemory_bm_test_bit(forbidden_pages_map, page_to_pfn(page)) : 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);",
      "static struct memory_bitmap *forbidden_pages_map;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memory_bm_test_bit",
          "args": [
            "forbidden_pages_map",
            "page_to_pfn(page)"
          ],
          "line": 1060
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_test_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "849-858",
          "snippet": "static int memory_bm_test_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\treturn test_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int memory_bm_test_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\treturn test_bit(bit, addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_to_pfn",
          "args": [
            "page"
          ],
          "line": 1060
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *forbidden_pages_map;\n\nint swsusp_page_is_forbidden(struct page *page)\n{\n\treturn forbidden_pages_map ?\n\t\tmemory_bm_test_bit(forbidden_pages_map, page_to_pfn(page)) : 0;\n}"
  },
  {
    "function_name": "swsusp_set_page_forbidden",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1051-1055",
    "snippet": "static void swsusp_set_page_forbidden(struct page *page)\n{\n\tif (forbidden_pages_map)\n\t\tmemory_bm_set_bit(forbidden_pages_map, page_to_pfn(page));\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);",
      "static struct memory_bitmap *forbidden_pages_map;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memory_bm_set_bit",
          "args": [
            "forbidden_pages_map",
            "page_to_pfn(page)"
          ],
          "line": 1054
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_set_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "806-815",
          "snippet": "static void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_to_pfn",
          "args": [
            "page"
          ],
          "line": 1054
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *forbidden_pages_map;\n\nstatic void swsusp_set_page_forbidden(struct page *page)\n{\n\tif (forbidden_pages_map)\n\t\tmemory_bm_set_bit(forbidden_pages_map, page_to_pfn(page));\n}"
  },
  {
    "function_name": "swsusp_unset_page_free",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1045-1049",
    "snippet": "void swsusp_unset_page_free(struct page *page)\n{\n\tif (free_pages_map)\n\t\tmemory_bm_clear_bit(free_pages_map, page_to_pfn(page));\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);",
      "static struct memory_bitmap *free_pages_map;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memory_bm_clear_bit",
          "args": [
            "free_pages_map",
            "page_to_pfn(page)"
          ],
          "line": 1048
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_clear_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "830-839",
          "snippet": "static void memory_bm_clear_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tclear_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_clear_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tclear_bit(bit, addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_to_pfn",
          "args": [
            "page"
          ],
          "line": 1048
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *free_pages_map;\n\nvoid swsusp_unset_page_free(struct page *page)\n{\n\tif (free_pages_map)\n\t\tmemory_bm_clear_bit(free_pages_map, page_to_pfn(page));\n}"
  },
  {
    "function_name": "swsusp_page_is_free",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1039-1043",
    "snippet": "static int swsusp_page_is_free(struct page *page)\n{\n\treturn free_pages_map ?\n\t\tmemory_bm_test_bit(free_pages_map, page_to_pfn(page)) : 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);",
      "static struct memory_bitmap *free_pages_map;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memory_bm_test_bit",
          "args": [
            "free_pages_map",
            "page_to_pfn(page)"
          ],
          "line": 1042
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_test_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "849-858",
          "snippet": "static int memory_bm_test_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\treturn test_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int memory_bm_test_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\treturn test_bit(bit, addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_to_pfn",
          "args": [
            "page"
          ],
          "line": 1042
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *free_pages_map;\n\nstatic int swsusp_page_is_free(struct page *page)\n{\n\treturn free_pages_map ?\n\t\tmemory_bm_test_bit(free_pages_map, page_to_pfn(page)) : 0;\n}"
  },
  {
    "function_name": "swsusp_set_page_free",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "1033-1037",
    "snippet": "void swsusp_set_page_free(struct page *page)\n{\n\tif (free_pages_map)\n\t\tmemory_bm_set_bit(free_pages_map, page_to_pfn(page));\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);",
      "static struct memory_bitmap *free_pages_map;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memory_bm_set_bit",
          "args": [
            "free_pages_map",
            "page_to_pfn(page)"
          ],
          "line": 1036
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_set_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "806-815",
          "snippet": "static void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_to_pfn",
          "args": [
            "page"
          ],
          "line": 1036
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *free_pages_map;\n\nvoid swsusp_set_page_free(struct page *page)\n{\n\tif (free_pages_map)\n\t\tmemory_bm_set_bit(free_pages_map, page_to_pfn(page));\n}"
  },
  {
    "function_name": "__register_nosave_region",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "981-1017",
    "snippet": "void __init __register_nosave_region(unsigned long start_pfn,\n\t\t\t\t     unsigned long end_pfn, int use_kmalloc)\n{\n\tstruct nosave_region *region;\n\n\tif (start_pfn >= end_pfn)\n\t\treturn;\n\n\tif (!list_empty(&nosave_regions)) {\n\t\t/* Try to extend the previous region (they should be sorted) */\n\t\tregion = list_entry(nosave_regions.prev,\n\t\t\t\t\tstruct nosave_region, list);\n\t\tif (region->end_pfn == start_pfn) {\n\t\t\tregion->end_pfn = end_pfn;\n\t\t\tgoto Report;\n\t\t}\n\t}\n\tif (use_kmalloc) {\n\t\t/* During init, this shouldn't fail */\n\t\tregion = kmalloc(sizeof(struct nosave_region), GFP_KERNEL);\n\t\tBUG_ON(!region);\n\t} else {\n\t\t/* This allocation cannot fail */\n\t\tregion = memblock_alloc(sizeof(struct nosave_region),\n\t\t\t\t\tSMP_CACHE_BYTES);\n\t\tif (!region)\n\t\t\tpanic(\"%s: Failed to allocate %zu bytes\\n\", __func__,\n\t\t\t      sizeof(struct nosave_region));\n\t}\n\tregion->start_pfn = start_pfn;\n\tregion->end_pfn = end_pfn;\n\tlist_add_tail(&region->list, &nosave_regions);\n Report:\n\tpr_info(\"Registered nosave memory: [mem %#010llx-%#010llx]\\n\",\n\t\t(unsigned long long) start_pfn << PAGE_SHIFT,\n\t\t((unsigned long long) end_pfn << PAGE_SHIFT) - 1);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(nosave_regions);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Registered nosave memory: [mem %#010llx-%#010llx]\\n\"",
            "(unsigned long long) start_pfn << PAGE_SHIFT",
            "((unsigned long long) end_pfn << PAGE_SHIFT) - 1"
          ],
          "line": 1014
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&region->list",
            "&nosave_regions"
          ],
          "line": 1012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"%s: Failed to allocate %zu bytes\\n\"",
            "__func__",
            "sizeof(struct nosave_region)"
          ],
          "line": 1007
        },
        "resolved": true,
        "details": {
          "function_name": "panic",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/panic.c",
          "lines": "179-361",
          "snippet": "void panic(const char *fmt, ...)\n{\n\tstatic char buf[1024];\n\tva_list args;\n\tlong i, i_next = 0, len;\n\tint state = 0;\n\tint old_cpu, this_cpu;\n\tbool _crash_kexec_post_notifiers = crash_kexec_post_notifiers;\n\n\t/*\n\t * Disable local interrupts. This will prevent panic_smp_self_stop\n\t * from deadlocking the first cpu that invokes the panic, since\n\t * there is nothing to prevent an interrupt handler (that runs\n\t * after setting panic_cpu) from invoking panic() again.\n\t */\n\tlocal_irq_disable();\n\tpreempt_disable_notrace();\n\n\t/*\n\t * It's possible to come here directly from a panic-assertion and\n\t * not have preempt disabled. Some functions called from here want\n\t * preempt to be disabled. No point enabling it later though...\n\t *\n\t * Only one CPU is allowed to execute the panic code from here. For\n\t * multiple parallel invocations of panic, all other CPUs either\n\t * stop themself or will wait until they are stopped by the 1st CPU\n\t * with smp_send_stop().\n\t *\n\t * `old_cpu == PANIC_CPU_INVALID' means this is the 1st CPU which\n\t * comes here, so go ahead.\n\t * `old_cpu == this_cpu' means we came from nmi_panic() which sets\n\t * panic_cpu to this CPU.  In this case, this is also the 1st CPU.\n\t */\n\tthis_cpu = raw_smp_processor_id();\n\told_cpu  = atomic_cmpxchg(&panic_cpu, PANIC_CPU_INVALID, this_cpu);\n\n\tif (old_cpu != PANIC_CPU_INVALID && old_cpu != this_cpu)\n\t\tpanic_smp_self_stop();\n\n\tconsole_verbose();\n\tbust_spinlocks(1);\n\tva_start(args, fmt);\n\tlen = vscnprintf(buf, sizeof(buf), fmt, args);\n\tva_end(args);\n\n\tif (len && buf[len - 1] == '\\n')\n\t\tbuf[len - 1] = '\\0';\n\n\tpr_emerg(\"Kernel panic - not syncing: %s\\n\", buf);\n#ifdef CONFIG_DEBUG_BUGVERBOSE\n\t/*\n\t * Avoid nested stack-dumping if a panic occurs during oops processing\n\t */\n\tif (!test_taint(TAINT_DIE) && oops_in_progress <= 1)\n\t\tdump_stack();\n#endif\n\n\t/*\n\t * If kgdb is enabled, give it a chance to run before we stop all\n\t * the other CPUs or else we won't be able to debug processes left\n\t * running on them.\n\t */\n\tkgdb_panic(buf);\n\n\t/*\n\t * If we have crashed and we have a crash kernel loaded let it handle\n\t * everything else.\n\t * If we want to run this after calling panic_notifiers, pass\n\t * the \"crash_kexec_post_notifiers\" option to the kernel.\n\t *\n\t * Bypass the panic_cpu check and call __crash_kexec directly.\n\t */\n\tif (!_crash_kexec_post_notifiers) {\n\t\t__crash_kexec(NULL);\n\n\t\t/*\n\t\t * Note smp_send_stop is the usual smp shutdown function, which\n\t\t * unfortunately means it may not be hardened to work in a\n\t\t * panic situation.\n\t\t */\n\t\tsmp_send_stop();\n\t} else {\n\t\t/*\n\t\t * If we want to do crash dump after notifier calls and\n\t\t * kmsg_dump, we will need architecture dependent extra\n\t\t * works in addition to stopping other CPUs.\n\t\t */\n\t\tcrash_smp_send_stop();\n\t}\n\n\t/*\n\t * Run any panic handlers, including those that might need to\n\t * add information to the kmsg dump output.\n\t */\n\tatomic_notifier_call_chain(&panic_notifier_list, 0, buf);\n\n\tkmsg_dump(KMSG_DUMP_PANIC);\n\n\t/*\n\t * If you doubt kdump always works fine in any situation,\n\t * \"crash_kexec_post_notifiers\" offers you a chance to run\n\t * panic_notifiers and dumping kmsg before kdump.\n\t * Note: since some panic_notifiers can make crashed kernel\n\t * more unstable, it can increase risks of the kdump failure too.\n\t *\n\t * Bypass the panic_cpu check and call __crash_kexec directly.\n\t */\n\tif (_crash_kexec_post_notifiers)\n\t\t__crash_kexec(NULL);\n\n#ifdef CONFIG_VT\n\tunblank_screen();\n#endif\n\tconsole_unblank();\n\n\t/*\n\t * We may have ended up stopping the CPU holding the lock (in\n\t * smp_send_stop()) while still having some valuable data in the console\n\t * buffer.  Try to acquire the lock then release it regardless of the\n\t * result.  The release will also print the buffers out.  Locks debug\n\t * should be disabled to avoid reporting bad unlock balance when\n\t * panic() is not being callled from OOPS.\n\t */\n\tdebug_locks_off();\n\tconsole_flush_on_panic(CONSOLE_FLUSH_PENDING);\n\n\tpanic_print_sys_info();\n\n\tif (!panic_blink)\n\t\tpanic_blink = no_blink;\n\n\tif (panic_timeout > 0) {\n\t\t/*\n\t\t * Delay timeout seconds before rebooting the machine.\n\t\t * We can't use the \"normal\" timers since we just panicked.\n\t\t */\n\t\tpr_emerg(\"Rebooting in %d seconds..\\n\", panic_timeout);\n\n\t\tfor (i = 0; i < panic_timeout * 1000; i += PANIC_TIMER_STEP) {\n\t\t\ttouch_nmi_watchdog();\n\t\t\tif (i >= i_next) {\n\t\t\t\ti += panic_blink(state ^= 1);\n\t\t\t\ti_next = i + 3600 / PANIC_BLINK_SPD;\n\t\t\t}\n\t\t\tmdelay(PANIC_TIMER_STEP);\n\t\t}\n\t}\n\tif (panic_timeout != 0) {\n\t\t/*\n\t\t * This will not be a clean reboot, with everything\n\t\t * shutting down.  But if there is a chance of\n\t\t * rebooting the system it will be rebooted.\n\t\t */\n\t\tif (panic_reboot_mode != REBOOT_UNDEFINED)\n\t\t\treboot_mode = panic_reboot_mode;\n\t\temergency_restart();\n\t}\n#ifdef __sparc__\n\t{\n\t\textern int stop_a_enabled;\n\t\t/* Make sure the user can actually press Stop-A (L1-A) */\n\t\tstop_a_enabled = 1;\n\t\tpr_emerg(\"Press Stop-A (L1-A) from sun keyboard or send break\\n\"\n\t\t\t \"twice on console to return to the boot prom\\n\");\n\t}\n#endif\n#if defined(CONFIG_S390)\n\tdisabled_wait();\n#endif\n\tpr_emerg(\"---[ end Kernel panic - not syncing: %s ]---\\n\", buf);\n\n\t/* Do not scroll important messages printed above */\n\tsuppress_printk = 1;\n\tlocal_irq_enable();\n\tfor (i = 0; ; i += PANIC_TIMER_STEP) {\n\t\ttouch_softlockup_watchdog();\n\t\tif (i >= i_next) {\n\t\t\ti += panic_blink(state ^= 1);\n\t\t\ti_next = i + 3600 / PANIC_BLINK_SPD;\n\t\t}\n\t\tmdelay(PANIC_TIMER_STEP);\n\t}\n}",
          "includes": [
            "#include <asm/sections.h>",
            "#include <trace/events/error_report.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/bug.h>",
            "#include <linux/console.h>",
            "#include <linux/nmi.h>",
            "#include <linux/init.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/sched.h>",
            "#include <linux/panic_notifier.h>",
            "#include <linux/kexec.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/notifier.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/kgdb.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [
            "#define PANIC_BLINK_SPD 18",
            "#define PANIC_TIMER_STEP 100"
          ],
          "globals_used": [
            "bool crash_kexec_post_notifiers;",
            "int panic_timeout = CONFIG_PANIC_TIMEOUT;",
            "long (*panic_blink)(int state);",
            "atomic_t panic_cpu = ATOMIC_INIT(PANIC_CPU_INVALID);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/sections.h>\n#include <trace/events/error_report.h>\n#include <linux/debugfs.h>\n#include <linux/ratelimit.h>\n#include <linux/bug.h>\n#include <linux/console.h>\n#include <linux/nmi.h>\n#include <linux/init.h>\n#include <linux/sysrq.h>\n#include <linux/sched.h>\n#include <linux/panic_notifier.h>\n#include <linux/kexec.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/ftrace.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/vt_kern.h>\n#include <linux/notifier.h>\n#include <linux/kallsyms.h>\n#include <linux/kmsg_dump.h>\n#include <linux/kgdb.h>\n#include <linux/interrupt.h>\n#include <linux/sched/debug.h>\n#include <linux/debug_locks.h>\n\n#define PANIC_BLINK_SPD 18\n#define PANIC_TIMER_STEP 100\n\nbool crash_kexec_post_notifiers;\nint panic_timeout = CONFIG_PANIC_TIMEOUT;\nlong (*panic_blink)(int state);\natomic_t panic_cpu = ATOMIC_INIT(PANIC_CPU_INVALID);\n\nvoid panic(const char *fmt, ...)\n{\n\tstatic char buf[1024];\n\tva_list args;\n\tlong i, i_next = 0, len;\n\tint state = 0;\n\tint old_cpu, this_cpu;\n\tbool _crash_kexec_post_notifiers = crash_kexec_post_notifiers;\n\n\t/*\n\t * Disable local interrupts. This will prevent panic_smp_self_stop\n\t * from deadlocking the first cpu that invokes the panic, since\n\t * there is nothing to prevent an interrupt handler (that runs\n\t * after setting panic_cpu) from invoking panic() again.\n\t */\n\tlocal_irq_disable();\n\tpreempt_disable_notrace();\n\n\t/*\n\t * It's possible to come here directly from a panic-assertion and\n\t * not have preempt disabled. Some functions called from here want\n\t * preempt to be disabled. No point enabling it later though...\n\t *\n\t * Only one CPU is allowed to execute the panic code from here. For\n\t * multiple parallel invocations of panic, all other CPUs either\n\t * stop themself or will wait until they are stopped by the 1st CPU\n\t * with smp_send_stop().\n\t *\n\t * `old_cpu == PANIC_CPU_INVALID' means this is the 1st CPU which\n\t * comes here, so go ahead.\n\t * `old_cpu == this_cpu' means we came from nmi_panic() which sets\n\t * panic_cpu to this CPU.  In this case, this is also the 1st CPU.\n\t */\n\tthis_cpu = raw_smp_processor_id();\n\told_cpu  = atomic_cmpxchg(&panic_cpu, PANIC_CPU_INVALID, this_cpu);\n\n\tif (old_cpu != PANIC_CPU_INVALID && old_cpu != this_cpu)\n\t\tpanic_smp_self_stop();\n\n\tconsole_verbose();\n\tbust_spinlocks(1);\n\tva_start(args, fmt);\n\tlen = vscnprintf(buf, sizeof(buf), fmt, args);\n\tva_end(args);\n\n\tif (len && buf[len - 1] == '\\n')\n\t\tbuf[len - 1] = '\\0';\n\n\tpr_emerg(\"Kernel panic - not syncing: %s\\n\", buf);\n#ifdef CONFIG_DEBUG_BUGVERBOSE\n\t/*\n\t * Avoid nested stack-dumping if a panic occurs during oops processing\n\t */\n\tif (!test_taint(TAINT_DIE) && oops_in_progress <= 1)\n\t\tdump_stack();\n#endif\n\n\t/*\n\t * If kgdb is enabled, give it a chance to run before we stop all\n\t * the other CPUs or else we won't be able to debug processes left\n\t * running on them.\n\t */\n\tkgdb_panic(buf);\n\n\t/*\n\t * If we have crashed and we have a crash kernel loaded let it handle\n\t * everything else.\n\t * If we want to run this after calling panic_notifiers, pass\n\t * the \"crash_kexec_post_notifiers\" option to the kernel.\n\t *\n\t * Bypass the panic_cpu check and call __crash_kexec directly.\n\t */\n\tif (!_crash_kexec_post_notifiers) {\n\t\t__crash_kexec(NULL);\n\n\t\t/*\n\t\t * Note smp_send_stop is the usual smp shutdown function, which\n\t\t * unfortunately means it may not be hardened to work in a\n\t\t * panic situation.\n\t\t */\n\t\tsmp_send_stop();\n\t} else {\n\t\t/*\n\t\t * If we want to do crash dump after notifier calls and\n\t\t * kmsg_dump, we will need architecture dependent extra\n\t\t * works in addition to stopping other CPUs.\n\t\t */\n\t\tcrash_smp_send_stop();\n\t}\n\n\t/*\n\t * Run any panic handlers, including those that might need to\n\t * add information to the kmsg dump output.\n\t */\n\tatomic_notifier_call_chain(&panic_notifier_list, 0, buf);\n\n\tkmsg_dump(KMSG_DUMP_PANIC);\n\n\t/*\n\t * If you doubt kdump always works fine in any situation,\n\t * \"crash_kexec_post_notifiers\" offers you a chance to run\n\t * panic_notifiers and dumping kmsg before kdump.\n\t * Note: since some panic_notifiers can make crashed kernel\n\t * more unstable, it can increase risks of the kdump failure too.\n\t *\n\t * Bypass the panic_cpu check and call __crash_kexec directly.\n\t */\n\tif (_crash_kexec_post_notifiers)\n\t\t__crash_kexec(NULL);\n\n#ifdef CONFIG_VT\n\tunblank_screen();\n#endif\n\tconsole_unblank();\n\n\t/*\n\t * We may have ended up stopping the CPU holding the lock (in\n\t * smp_send_stop()) while still having some valuable data in the console\n\t * buffer.  Try to acquire the lock then release it regardless of the\n\t * result.  The release will also print the buffers out.  Locks debug\n\t * should be disabled to avoid reporting bad unlock balance when\n\t * panic() is not being callled from OOPS.\n\t */\n\tdebug_locks_off();\n\tconsole_flush_on_panic(CONSOLE_FLUSH_PENDING);\n\n\tpanic_print_sys_info();\n\n\tif (!panic_blink)\n\t\tpanic_blink = no_blink;\n\n\tif (panic_timeout > 0) {\n\t\t/*\n\t\t * Delay timeout seconds before rebooting the machine.\n\t\t * We can't use the \"normal\" timers since we just panicked.\n\t\t */\n\t\tpr_emerg(\"Rebooting in %d seconds..\\n\", panic_timeout);\n\n\t\tfor (i = 0; i < panic_timeout * 1000; i += PANIC_TIMER_STEP) {\n\t\t\ttouch_nmi_watchdog();\n\t\t\tif (i >= i_next) {\n\t\t\t\ti += panic_blink(state ^= 1);\n\t\t\t\ti_next = i + 3600 / PANIC_BLINK_SPD;\n\t\t\t}\n\t\t\tmdelay(PANIC_TIMER_STEP);\n\t\t}\n\t}\n\tif (panic_timeout != 0) {\n\t\t/*\n\t\t * This will not be a clean reboot, with everything\n\t\t * shutting down.  But if there is a chance of\n\t\t * rebooting the system it will be rebooted.\n\t\t */\n\t\tif (panic_reboot_mode != REBOOT_UNDEFINED)\n\t\t\treboot_mode = panic_reboot_mode;\n\t\temergency_restart();\n\t}\n#ifdef __sparc__\n\t{\n\t\textern int stop_a_enabled;\n\t\t/* Make sure the user can actually press Stop-A (L1-A) */\n\t\tstop_a_enabled = 1;\n\t\tpr_emerg(\"Press Stop-A (L1-A) from sun keyboard or send break\\n\"\n\t\t\t \"twice on console to return to the boot prom\\n\");\n\t}\n#endif\n#if defined(CONFIG_S390)\n\tdisabled_wait();\n#endif\n\tpr_emerg(\"---[ end Kernel panic - not syncing: %s ]---\\n\", buf);\n\n\t/* Do not scroll important messages printed above */\n\tsuppress_printk = 1;\n\tlocal_irq_enable();\n\tfor (i = 0; ; i += PANIC_TIMER_STEP) {\n\t\ttouch_softlockup_watchdog();\n\t\tif (i >= i_next) {\n\t\t\ti += panic_blink(state ^= 1);\n\t\t\ti_next = i + 3600 / PANIC_BLINK_SPD;\n\t\t}\n\t\tmdelay(PANIC_TIMER_STEP);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "memblock_alloc",
          "args": [
            "sizeof(struct nosave_region)",
            "SMP_CACHE_BYTES"
          ],
          "line": 1004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!region"
          ],
          "line": 1001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(struct nosave_region)",
            "GFP_KERNEL"
          ],
          "line": 1000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "nosave_regions.prev",
            "structnosave_region",
            "list"
          ],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&nosave_regions"
          ],
          "line": 989
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_empty",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "41-44",
          "snippet": "static inline bool rcu_segcblist_empty(struct rcu_segcblist *rsclp)\n{\n\treturn !READ_ONCE(rsclp->head);\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_empty(struct rcu_segcblist *rsclp)\n{\n\treturn !READ_ONCE(rsclp->head);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic LIST_HEAD(nosave_regions);\n\nvoid __init __register_nosave_region(unsigned long start_pfn,\n\t\t\t\t     unsigned long end_pfn, int use_kmalloc)\n{\n\tstruct nosave_region *region;\n\n\tif (start_pfn >= end_pfn)\n\t\treturn;\n\n\tif (!list_empty(&nosave_regions)) {\n\t\t/* Try to extend the previous region (they should be sorted) */\n\t\tregion = list_entry(nosave_regions.prev,\n\t\t\t\t\tstruct nosave_region, list);\n\t\tif (region->end_pfn == start_pfn) {\n\t\t\tregion->end_pfn = end_pfn;\n\t\t\tgoto Report;\n\t\t}\n\t}\n\tif (use_kmalloc) {\n\t\t/* During init, this shouldn't fail */\n\t\tregion = kmalloc(sizeof(struct nosave_region), GFP_KERNEL);\n\t\tBUG_ON(!region);\n\t} else {\n\t\t/* This allocation cannot fail */\n\t\tregion = memblock_alloc(sizeof(struct nosave_region),\n\t\t\t\t\tSMP_CACHE_BYTES);\n\t\tif (!region)\n\t\t\tpanic(\"%s: Failed to allocate %zu bytes\\n\", __func__,\n\t\t\t      sizeof(struct nosave_region));\n\t}\n\tregion->start_pfn = start_pfn;\n\tregion->end_pfn = end_pfn;\n\tlist_add_tail(&region->list, &nosave_regions);\n Report:\n\tpr_info(\"Registered nosave memory: [mem %#010llx-%#010llx]\\n\",\n\t\t(unsigned long long) start_pfn << PAGE_SHIFT,\n\t\t((unsigned long long) end_pfn << PAGE_SHIFT) - 1);\n}"
  },
  {
    "function_name": "memory_bm_recycle",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "958-973",
    "snippet": "static void memory_bm_recycle(struct memory_bitmap *bm)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\tstruct linked_page *p_list;\n\n\tlist_for_each_entry(zone, &bm->zones, list)\n\t\trecycle_zone_bm_rtree(zone);\n\n\tp_list = bm->p_list;\n\twhile (p_list) {\n\t\tstruct linked_page *lp = p_list;\n\n\t\tp_list = lp->next;\n\t\trecycle_safe_page(lp);\n\t}\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "recycle_safe_page",
          "args": [
            "lp"
          ],
          "line": 971
        },
        "resolved": true,
        "details": {
          "function_name": "recycle_safe_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "237-243",
          "snippet": "static void recycle_safe_page(void *page_address)\n{\n\tstruct linked_page *lp = page_address;\n\n\tlp->next = safe_pages_list;\n\tsafe_pages_list = lp;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct linked_page *safe_pages_list;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic struct linked_page *safe_pages_list;\n\nstatic void recycle_safe_page(void *page_address)\n{\n\tstruct linked_page *lp = page_address;\n\n\tlp->next = safe_pages_list;\n\tsafe_pages_list = lp;\n}"
        }
      },
      {
        "call_info": {
          "callee": "recycle_zone_bm_rtree",
          "args": [
            "zone"
          ],
          "line": 964
        },
        "resolved": true,
        "details": {
          "function_name": "recycle_zone_bm_rtree",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "947-956",
          "snippet": "static void recycle_zone_bm_rtree(struct mem_zone_bm_rtree *zone)\n{\n\tstruct rtree_node *node;\n\n\tlist_for_each_entry(node, &zone->nodes, list)\n\t\trecycle_safe_page(node->data);\n\n\tlist_for_each_entry(node, &zone->leaves, list)\n\t\trecycle_safe_page(node->data);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic void recycle_zone_bm_rtree(struct mem_zone_bm_rtree *zone)\n{\n\tstruct rtree_node *node;\n\n\tlist_for_each_entry(node, &zone->nodes, list)\n\t\trecycle_safe_page(node->data);\n\n\tlist_for_each_entry(node, &zone->leaves, list)\n\t\trecycle_safe_page(node->data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "zone",
            "&bm->zones",
            "list"
          ],
          "line": 963
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_recycle(struct memory_bitmap *bm)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\tstruct linked_page *p_list;\n\n\tlist_for_each_entry(zone, &bm->zones, list)\n\t\trecycle_zone_bm_rtree(zone);\n\n\tp_list = bm->p_list;\n\twhile (p_list) {\n\t\tstruct linked_page *lp = p_list;\n\n\t\tp_list = lp->next;\n\t\trecycle_safe_page(lp);\n\t}\n}"
  },
  {
    "function_name": "recycle_zone_bm_rtree",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "947-956",
    "snippet": "static void recycle_zone_bm_rtree(struct mem_zone_bm_rtree *zone)\n{\n\tstruct rtree_node *node;\n\n\tlist_for_each_entry(node, &zone->nodes, list)\n\t\trecycle_safe_page(node->data);\n\n\tlist_for_each_entry(node, &zone->leaves, list)\n\t\trecycle_safe_page(node->data);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "recycle_safe_page",
          "args": [
            "node->data"
          ],
          "line": 955
        },
        "resolved": true,
        "details": {
          "function_name": "recycle_safe_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "237-243",
          "snippet": "static void recycle_safe_page(void *page_address)\n{\n\tstruct linked_page *lp = page_address;\n\n\tlp->next = safe_pages_list;\n\tsafe_pages_list = lp;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct linked_page *safe_pages_list;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic struct linked_page *safe_pages_list;\n\nstatic void recycle_safe_page(void *page_address)\n{\n\tstruct linked_page *lp = page_address;\n\n\tlp->next = safe_pages_list;\n\tsafe_pages_list = lp;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "node",
            "&zone->leaves",
            "list"
          ],
          "line": 954
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "node",
            "&zone->nodes",
            "list"
          ],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic void recycle_zone_bm_rtree(struct mem_zone_bm_rtree *zone)\n{\n\tstruct rtree_node *node;\n\n\tlist_for_each_entry(node, &zone->nodes, list)\n\t\trecycle_safe_page(node->data);\n\n\tlist_for_each_entry(node, &zone->leaves, list)\n\t\trecycle_safe_page(node->data);\n}"
  },
  {
    "function_name": "memory_bm_next_pfn",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "915-933",
    "snippet": "static unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)",
      "#define BM_END_OF_MAP\t(~0UL)"
    ],
    "globals_used": [
      "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rtree_next_node",
          "args": [
            "bm"
          ],
          "line": 930
        },
        "resolved": true,
        "details": {
          "function_name": "rtree_next_node",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "878-902",
          "snippet": "static bool rtree_next_node(struct memory_bitmap *bm)\n{\n\tif (!list_is_last(&bm->cur.node->list, &bm->cur.zone->leaves)) {\n\t\tbm->cur.node = list_entry(bm->cur.node->list.next,\n\t\t\t\t\t  struct rtree_node, list);\n\t\tbm->cur.node_pfn += BM_BITS_PER_BLOCK;\n\t\tbm->cur.node_bit  = 0;\n\t\ttouch_softlockup_watchdog();\n\t\treturn true;\n\t}\n\n\t/* No more nodes, goto next zone */\n\tif (!list_is_last(&bm->cur.zone->list, &bm->zones)) {\n\t\tbm->cur.zone = list_entry(bm->cur.zone->list.next,\n\t\t\t\t  struct mem_zone_bm_rtree, list);\n\t\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t\t  struct rtree_node, list);\n\t\tbm->cur.node_pfn = 0;\n\t\tbm->cur.node_bit = 0;\n\t\treturn true;\n\t}\n\n\t/* No more zones */\n\treturn false;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)\n\nstatic bool rtree_next_node(struct memory_bitmap *bm)\n{\n\tif (!list_is_last(&bm->cur.node->list, &bm->cur.zone->leaves)) {\n\t\tbm->cur.node = list_entry(bm->cur.node->list.next,\n\t\t\t\t\t  struct rtree_node, list);\n\t\tbm->cur.node_pfn += BM_BITS_PER_BLOCK;\n\t\tbm->cur.node_bit  = 0;\n\t\ttouch_softlockup_watchdog();\n\t\treturn true;\n\t}\n\n\t/* No more nodes, goto next zone */\n\tif (!list_is_last(&bm->cur.zone->list, &bm->zones)) {\n\t\tbm->cur.zone = list_entry(bm->cur.zone->list.next,\n\t\t\t\t  struct mem_zone_bm_rtree, list);\n\t\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t\t  struct rtree_node, list);\n\t\tbm->cur.node_pfn = 0;\n\t\tbm->cur.node_bit = 0;\n\t\treturn true;\n\t}\n\n\t/* No more zones */\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_next_bit",
          "args": [
            "bm->cur.node->data",
            "bits",
            "bm->cur.node_bit"
          ],
          "line": 923
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "pages - bm->cur.node_pfn",
            "BM_BITS_PER_BLOCK"
          ],
          "line": 922
        },
        "resolved": true,
        "details": {
          "function_name": "irq_setup_timings",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/internals.h",
          "lines": "388-389",
          "snippet": "static inline void irq_setup_timings(struct irq_desc *desc,\n\t\t\t\t     struct irqaction *act) {}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include \"settings.h\"",
            "#include \"debug.h\"",
            "#include <linux/sched/clock.h>",
            "#include <linux/pm_runtime.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/irqdesc.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void __disable_irq(struct irq_desc *desc);",
            "extern void __enable_irq(struct irq_desc *desc);",
            "extern int irq_activate(struct irq_desc *desc);",
            "extern void irq_shutdown(struct irq_desc *desc);",
            "extern void irq_shutdown_and_deactivate(struct irq_desc *desc);",
            "extern void irq_enable(struct irq_desc *desc);",
            "extern void irq_disable(struct irq_desc *desc);",
            "extern void mask_irq(struct irq_desc *desc);",
            "extern void unmask_irq(struct irq_desc *desc);",
            "extern void unmask_threaded_irq(struct irq_desc *desc);",
            "irqreturn_t __handle_irq_event_percpu(struct irq_desc *desc);",
            "irqreturn_t handle_irq_event_percpu(struct irq_desc *desc);",
            "irqreturn_t handle_irq_event(struct irq_desc *desc);",
            "bool irq_wait_for_poll(struct irq_desc *desc);",
            "extern void irq_set_thread_affinity(struct irq_desc *desc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include \"settings.h\"\n#include \"debug.h\"\n#include <linux/sched/clock.h>\n#include <linux/pm_runtime.h>\n#include <linux/kernel_stat.h>\n#include <linux/irqdesc.h>\n\nextern void __disable_irq(struct irq_desc *desc);\nextern void __enable_irq(struct irq_desc *desc);\nextern int irq_activate(struct irq_desc *desc);\nextern void irq_shutdown(struct irq_desc *desc);\nextern void irq_shutdown_and_deactivate(struct irq_desc *desc);\nextern void irq_enable(struct irq_desc *desc);\nextern void irq_disable(struct irq_desc *desc);\nextern void mask_irq(struct irq_desc *desc);\nextern void unmask_irq(struct irq_desc *desc);\nextern void unmask_threaded_irq(struct irq_desc *desc);\nirqreturn_t __handle_irq_event_percpu(struct irq_desc *desc);\nirqreturn_t handle_irq_event_percpu(struct irq_desc *desc);\nirqreturn_t handle_irq_event(struct irq_desc *desc);\nbool irq_wait_for_poll(struct irq_desc *desc);\nextern void irq_set_thread_affinity(struct irq_desc *desc);\n\nstatic inline void irq_setup_timings(struct irq_desc *desc,\n\t\t\t\t     struct irqaction *act) {}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)\n#define BM_END_OF_MAP\t(~0UL)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic unsigned long memory_bm_next_pfn(struct memory_bitmap *bm)\n{\n\tunsigned long bits, pfn, pages;\n\tint bit;\n\n\tdo {\n\t\tpages\t  = bm->cur.zone->end_pfn - bm->cur.zone->start_pfn;\n\t\tbits      = min(pages - bm->cur.node_pfn, BM_BITS_PER_BLOCK);\n\t\tbit\t  = find_next_bit(bm->cur.node->data, bits,\n\t\t\t\t\t  bm->cur.node_bit);\n\t\tif (bit < bits) {\n\t\t\tpfn = bm->cur.zone->start_pfn + bm->cur.node_pfn + bit;\n\t\t\tbm->cur.node_bit = bit + 1;\n\t\t\treturn pfn;\n\t\t}\n\t} while (rtree_next_node(bm));\n\n\treturn BM_END_OF_MAP;\n}"
  },
  {
    "function_name": "rtree_next_node",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "878-902",
    "snippet": "static bool rtree_next_node(struct memory_bitmap *bm)\n{\n\tif (!list_is_last(&bm->cur.node->list, &bm->cur.zone->leaves)) {\n\t\tbm->cur.node = list_entry(bm->cur.node->list.next,\n\t\t\t\t\t  struct rtree_node, list);\n\t\tbm->cur.node_pfn += BM_BITS_PER_BLOCK;\n\t\tbm->cur.node_bit  = 0;\n\t\ttouch_softlockup_watchdog();\n\t\treturn true;\n\t}\n\n\t/* No more nodes, goto next zone */\n\tif (!list_is_last(&bm->cur.zone->list, &bm->zones)) {\n\t\tbm->cur.zone = list_entry(bm->cur.zone->list.next,\n\t\t\t\t  struct mem_zone_bm_rtree, list);\n\t\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t\t  struct rtree_node, list);\n\t\tbm->cur.node_pfn = 0;\n\t\tbm->cur.node_bit = 0;\n\t\treturn true;\n\t}\n\n\t/* No more zones */\n\treturn false;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "bm->cur.zone->leaves.next",
            "structrtree_node",
            "list"
          ],
          "line": 893
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "bm->cur.zone->list.next",
            "structmem_zone_bm_rtree",
            "list"
          ],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_is_last",
          "args": [
            "&bm->cur.zone->list",
            "&bm->zones"
          ],
          "line": 890
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "touch_softlockup_watchdog",
          "args": [],
          "line": 885
        },
        "resolved": true,
        "details": {
          "function_name": "touch_softlockup_watchdog_sync",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/watchdog.c",
          "lines": "299-303",
          "snippet": "void touch_softlockup_watchdog_sync(void)\n{\n\t__this_cpu_write(softlockup_touch_sync, true);\n\t__this_cpu_write(watchdog_report_ts, SOFTLOCKUP_DELAY_REPORT);\n}",
          "includes": [
            "#include <linux/kvm_para.h>",
            "#include <asm/irq_regs.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/tick.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>",
            "#include <linux/nmi.h>",
            "#include <linux/cpu.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [
            "#define SOFTLOCKUP_DELAY_REPORT\tULONG_MAX"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_para.h>\n#include <asm/irq_regs.h>\n#include <linux/stop_machine.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/tick.h>\n#include <linux/sysctl.h>\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/nmi.h>\n#include <linux/cpu.h>\n#include <linux/mm.h>\n\n#define SOFTLOCKUP_DELAY_REPORT\tULONG_MAX\n\nvoid touch_softlockup_watchdog_sync(void)\n{\n\t__this_cpu_write(softlockup_touch_sync, true);\n\t__this_cpu_write(watchdog_report_ts, SOFTLOCKUP_DELAY_REPORT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "bm->cur.node->list.next",
            "structrtree_node",
            "list"
          ],
          "line": 881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_is_last",
          "args": [
            "&bm->cur.node->list",
            "&bm->cur.zone->leaves"
          ],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)\n\nstatic bool rtree_next_node(struct memory_bitmap *bm)\n{\n\tif (!list_is_last(&bm->cur.node->list, &bm->cur.zone->leaves)) {\n\t\tbm->cur.node = list_entry(bm->cur.node->list.next,\n\t\t\t\t\t  struct rtree_node, list);\n\t\tbm->cur.node_pfn += BM_BITS_PER_BLOCK;\n\t\tbm->cur.node_bit  = 0;\n\t\ttouch_softlockup_watchdog();\n\t\treturn true;\n\t}\n\n\t/* No more nodes, goto next zone */\n\tif (!list_is_last(&bm->cur.zone->list, &bm->zones)) {\n\t\tbm->cur.zone = list_entry(bm->cur.zone->list.next,\n\t\t\t\t  struct mem_zone_bm_rtree, list);\n\t\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t\t  struct rtree_node, list);\n\t\tbm->cur.node_pfn = 0;\n\t\tbm->cur.node_bit = 0;\n\t\treturn true;\n\t}\n\n\t/* No more zones */\n\treturn false;\n}"
  },
  {
    "function_name": "memory_bm_pfn_present",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "860-866",
    "snippet": "static bool memory_bm_pfn_present(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\n\treturn !memory_bm_find_bit(bm, pfn, &addr, &bit);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memory_bm_find_bit",
          "args": [
            "bm",
            "pfn",
            "&addr",
            "&bit"
          ],
          "line": 865
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_find_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "740-804",
          "snippet": "static int memory_bm_find_bit(struct memory_bitmap *bm, unsigned long pfn,\n\t\t\t      void **addr, unsigned int *bit_nr)\n{\n\tstruct mem_zone_bm_rtree *curr, *zone;\n\tstruct rtree_node *node;\n\tint i, block_nr;\n\n\tzone = bm->cur.zone;\n\n\tif (pfn >= zone->start_pfn && pfn < zone->end_pfn)\n\t\tgoto zone_found;\n\n\tzone = NULL;\n\n\t/* Find the right zone */\n\tlist_for_each_entry(curr, &bm->zones, list) {\n\t\tif (pfn >= curr->start_pfn && pfn < curr->end_pfn) {\n\t\t\tzone = curr;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!zone)\n\t\treturn -EFAULT;\n\nzone_found:\n\t/*\n\t * We have found the zone. Now walk the radix tree to find the leaf node\n\t * for our PFN.\n\t */\n\n\t/*\n\t * If the zone we wish to scan is the current zone and the\n\t * pfn falls into the current node then we do not need to walk\n\t * the tree.\n\t */\n\tnode = bm->cur.node;\n\tif (zone == bm->cur.zone &&\n\t    ((pfn - zone->start_pfn) & ~BM_BLOCK_MASK) == bm->cur.node_pfn)\n\t\tgoto node_found;\n\n\tnode      = zone->rtree;\n\tblock_nr  = (pfn - zone->start_pfn) >> BM_BLOCK_SHIFT;\n\n\tfor (i = zone->levels; i > 0; i--) {\n\t\tint index;\n\n\t\tindex = block_nr >> ((i - 1) * BM_RTREE_LEVEL_SHIFT);\n\t\tindex &= BM_RTREE_LEVEL_MASK;\n\t\tBUG_ON(node->data[index] == 0);\n\t\tnode = (struct rtree_node *)node->data[index];\n\t}\n\nnode_found:\n\t/* Update last position */\n\tbm->cur.zone = zone;\n\tbm->cur.node = node;\n\tbm->cur.node_pfn = (pfn - zone->start_pfn) & ~BM_BLOCK_MASK;\n\n\t/* Set return values */\n\t*addr = node->data;\n\t*bit_nr = (pfn - zone->start_pfn) & BM_BLOCK_MASK;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_RTREE_LEVEL_MASK\t((1UL << BM_RTREE_LEVEL_SHIFT) - 1)",
            "#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 3)",
            "#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 2)",
            "#define BM_BLOCK_MASK\t\t((1UL << BM_BLOCK_SHIFT) - 1)",
            "#define BM_BLOCK_SHIFT\t\t(PAGE_SHIFT + 3)"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_RTREE_LEVEL_MASK\t((1UL << BM_RTREE_LEVEL_SHIFT) - 1)\n#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 3)\n#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 2)\n#define BM_BLOCK_MASK\t\t((1UL << BM_BLOCK_SHIFT) - 1)\n#define BM_BLOCK_SHIFT\t\t(PAGE_SHIFT + 3)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic int memory_bm_find_bit(struct memory_bitmap *bm, unsigned long pfn,\n\t\t\t      void **addr, unsigned int *bit_nr)\n{\n\tstruct mem_zone_bm_rtree *curr, *zone;\n\tstruct rtree_node *node;\n\tint i, block_nr;\n\n\tzone = bm->cur.zone;\n\n\tif (pfn >= zone->start_pfn && pfn < zone->end_pfn)\n\t\tgoto zone_found;\n\n\tzone = NULL;\n\n\t/* Find the right zone */\n\tlist_for_each_entry(curr, &bm->zones, list) {\n\t\tif (pfn >= curr->start_pfn && pfn < curr->end_pfn) {\n\t\t\tzone = curr;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!zone)\n\t\treturn -EFAULT;\n\nzone_found:\n\t/*\n\t * We have found the zone. Now walk the radix tree to find the leaf node\n\t * for our PFN.\n\t */\n\n\t/*\n\t * If the zone we wish to scan is the current zone and the\n\t * pfn falls into the current node then we do not need to walk\n\t * the tree.\n\t */\n\tnode = bm->cur.node;\n\tif (zone == bm->cur.zone &&\n\t    ((pfn - zone->start_pfn) & ~BM_BLOCK_MASK) == bm->cur.node_pfn)\n\t\tgoto node_found;\n\n\tnode      = zone->rtree;\n\tblock_nr  = (pfn - zone->start_pfn) >> BM_BLOCK_SHIFT;\n\n\tfor (i = zone->levels; i > 0; i--) {\n\t\tint index;\n\n\t\tindex = block_nr >> ((i - 1) * BM_RTREE_LEVEL_SHIFT);\n\t\tindex &= BM_RTREE_LEVEL_MASK;\n\t\tBUG_ON(node->data[index] == 0);\n\t\tnode = (struct rtree_node *)node->data[index];\n\t}\n\nnode_found:\n\t/* Update last position */\n\tbm->cur.zone = zone;\n\tbm->cur.node = node;\n\tbm->cur.node_pfn = (pfn - zone->start_pfn) & ~BM_BLOCK_MASK;\n\n\t/* Set return values */\n\t*addr = node->data;\n\t*bit_nr = (pfn - zone->start_pfn) & BM_BLOCK_MASK;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic bool memory_bm_pfn_present(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\n\treturn !memory_bm_find_bit(bm, pfn, &addr, &bit);\n}"
  },
  {
    "function_name": "memory_bm_test_bit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "849-858",
    "snippet": "static int memory_bm_test_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\treturn test_bit(bit, addr);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "bit",
            "addr"
          ],
          "line": 857
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_test_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "849-858",
          "snippet": "static int memory_bm_test_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\treturn test_bit(bit, addr);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "error"
          ],
          "line": 856
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_bm_find_bit",
          "args": [
            "bm",
            "pfn",
            "&addr",
            "&bit"
          ],
          "line": 855
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_find_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "740-804",
          "snippet": "static int memory_bm_find_bit(struct memory_bitmap *bm, unsigned long pfn,\n\t\t\t      void **addr, unsigned int *bit_nr)\n{\n\tstruct mem_zone_bm_rtree *curr, *zone;\n\tstruct rtree_node *node;\n\tint i, block_nr;\n\n\tzone = bm->cur.zone;\n\n\tif (pfn >= zone->start_pfn && pfn < zone->end_pfn)\n\t\tgoto zone_found;\n\n\tzone = NULL;\n\n\t/* Find the right zone */\n\tlist_for_each_entry(curr, &bm->zones, list) {\n\t\tif (pfn >= curr->start_pfn && pfn < curr->end_pfn) {\n\t\t\tzone = curr;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!zone)\n\t\treturn -EFAULT;\n\nzone_found:\n\t/*\n\t * We have found the zone. Now walk the radix tree to find the leaf node\n\t * for our PFN.\n\t */\n\n\t/*\n\t * If the zone we wish to scan is the current zone and the\n\t * pfn falls into the current node then we do not need to walk\n\t * the tree.\n\t */\n\tnode = bm->cur.node;\n\tif (zone == bm->cur.zone &&\n\t    ((pfn - zone->start_pfn) & ~BM_BLOCK_MASK) == bm->cur.node_pfn)\n\t\tgoto node_found;\n\n\tnode      = zone->rtree;\n\tblock_nr  = (pfn - zone->start_pfn) >> BM_BLOCK_SHIFT;\n\n\tfor (i = zone->levels; i > 0; i--) {\n\t\tint index;\n\n\t\tindex = block_nr >> ((i - 1) * BM_RTREE_LEVEL_SHIFT);\n\t\tindex &= BM_RTREE_LEVEL_MASK;\n\t\tBUG_ON(node->data[index] == 0);\n\t\tnode = (struct rtree_node *)node->data[index];\n\t}\n\nnode_found:\n\t/* Update last position */\n\tbm->cur.zone = zone;\n\tbm->cur.node = node;\n\tbm->cur.node_pfn = (pfn - zone->start_pfn) & ~BM_BLOCK_MASK;\n\n\t/* Set return values */\n\t*addr = node->data;\n\t*bit_nr = (pfn - zone->start_pfn) & BM_BLOCK_MASK;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_RTREE_LEVEL_MASK\t((1UL << BM_RTREE_LEVEL_SHIFT) - 1)",
            "#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 3)",
            "#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 2)",
            "#define BM_BLOCK_MASK\t\t((1UL << BM_BLOCK_SHIFT) - 1)",
            "#define BM_BLOCK_SHIFT\t\t(PAGE_SHIFT + 3)"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_RTREE_LEVEL_MASK\t((1UL << BM_RTREE_LEVEL_SHIFT) - 1)\n#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 3)\n#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 2)\n#define BM_BLOCK_MASK\t\t((1UL << BM_BLOCK_SHIFT) - 1)\n#define BM_BLOCK_SHIFT\t\t(PAGE_SHIFT + 3)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic int memory_bm_find_bit(struct memory_bitmap *bm, unsigned long pfn,\n\t\t\t      void **addr, unsigned int *bit_nr)\n{\n\tstruct mem_zone_bm_rtree *curr, *zone;\n\tstruct rtree_node *node;\n\tint i, block_nr;\n\n\tzone = bm->cur.zone;\n\n\tif (pfn >= zone->start_pfn && pfn < zone->end_pfn)\n\t\tgoto zone_found;\n\n\tzone = NULL;\n\n\t/* Find the right zone */\n\tlist_for_each_entry(curr, &bm->zones, list) {\n\t\tif (pfn >= curr->start_pfn && pfn < curr->end_pfn) {\n\t\t\tzone = curr;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!zone)\n\t\treturn -EFAULT;\n\nzone_found:\n\t/*\n\t * We have found the zone. Now walk the radix tree to find the leaf node\n\t * for our PFN.\n\t */\n\n\t/*\n\t * If the zone we wish to scan is the current zone and the\n\t * pfn falls into the current node then we do not need to walk\n\t * the tree.\n\t */\n\tnode = bm->cur.node;\n\tif (zone == bm->cur.zone &&\n\t    ((pfn - zone->start_pfn) & ~BM_BLOCK_MASK) == bm->cur.node_pfn)\n\t\tgoto node_found;\n\n\tnode      = zone->rtree;\n\tblock_nr  = (pfn - zone->start_pfn) >> BM_BLOCK_SHIFT;\n\n\tfor (i = zone->levels; i > 0; i--) {\n\t\tint index;\n\n\t\tindex = block_nr >> ((i - 1) * BM_RTREE_LEVEL_SHIFT);\n\t\tindex &= BM_RTREE_LEVEL_MASK;\n\t\tBUG_ON(node->data[index] == 0);\n\t\tnode = (struct rtree_node *)node->data[index];\n\t}\n\nnode_found:\n\t/* Update last position */\n\tbm->cur.zone = zone;\n\tbm->cur.node = node;\n\tbm->cur.node_pfn = (pfn - zone->start_pfn) & ~BM_BLOCK_MASK;\n\n\t/* Set return values */\n\t*addr = node->data;\n\t*bit_nr = (pfn - zone->start_pfn) & BM_BLOCK_MASK;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int memory_bm_test_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\treturn test_bit(bit, addr);\n}"
  },
  {
    "function_name": "memory_bm_clear_current",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "841-847",
    "snippet": "static void memory_bm_clear_current(struct memory_bitmap *bm)\n{\n\tint bit;\n\n\tbit = max(bm->cur.node_bit - 1, 0);\n\tclear_bit(bit, bm->cur.node->data);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "bit",
            "bm->cur.node->data"
          ],
          "line": 846
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_clear_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "830-839",
          "snippet": "static void memory_bm_clear_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tclear_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_clear_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tclear_bit(bit, addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "max",
          "args": [
            "bm->cur.node_bit - 1",
            "0"
          ],
          "line": 845
        },
        "resolved": true,
        "details": {
          "function_name": "module_extend_max_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/module_decompress.c",
          "lines": "17-32",
          "snippet": "static int module_extend_max_pages(struct load_info *info, unsigned int extent)\n{\n\tstruct page **new_pages;\n\n\tnew_pages = kvmalloc_array(info->max_pages + extent,\n\t\t\t\t   sizeof(info->pages), GFP_KERNEL);\n\tif (!new_pages)\n\t\treturn -ENOMEM;\n\n\tmemcpy(new_pages, info->pages, info->max_pages * sizeof(info->pages));\n\tkvfree(info->pages);\n\tinfo->pages = new_pages;\n\tinfo->max_pages += extent;\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/xz.h>",
            "#include <linux/zlib.h>",
            "#include \"module-internal.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/kobject.h>",
            "#include <linux/highmem.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/xz.h>\n#include <linux/zlib.h>\n#include \"module-internal.h\"\n#include <linux/vmalloc.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/kobject.h>\n#include <linux/highmem.h>\n#include <linux/init.h>\n\nstatic int module_extend_max_pages(struct load_info *info, unsigned int extent)\n{\n\tstruct page **new_pages;\n\n\tnew_pages = kvmalloc_array(info->max_pages + extent,\n\t\t\t\t   sizeof(info->pages), GFP_KERNEL);\n\tif (!new_pages)\n\t\treturn -ENOMEM;\n\n\tmemcpy(new_pages, info->pages, info->max_pages * sizeof(info->pages));\n\tkvfree(info->pages);\n\tinfo->pages = new_pages;\n\tinfo->max_pages += extent;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic void memory_bm_clear_current(struct memory_bitmap *bm)\n{\n\tint bit;\n\n\tbit = max(bm->cur.node_bit - 1, 0);\n\tclear_bit(bit, bm->cur.node->data);\n}"
  },
  {
    "function_name": "memory_bm_clear_bit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "830-839",
    "snippet": "static void memory_bm_clear_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tclear_bit(bit, addr);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "bit",
            "addr"
          ],
          "line": 838
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_clear_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "830-839",
          "snippet": "static void memory_bm_clear_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tclear_bit(bit, addr);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "error"
          ],
          "line": 837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_bm_find_bit",
          "args": [
            "bm",
            "pfn",
            "&addr",
            "&bit"
          ],
          "line": 836
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_find_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "740-804",
          "snippet": "static int memory_bm_find_bit(struct memory_bitmap *bm, unsigned long pfn,\n\t\t\t      void **addr, unsigned int *bit_nr)\n{\n\tstruct mem_zone_bm_rtree *curr, *zone;\n\tstruct rtree_node *node;\n\tint i, block_nr;\n\n\tzone = bm->cur.zone;\n\n\tif (pfn >= zone->start_pfn && pfn < zone->end_pfn)\n\t\tgoto zone_found;\n\n\tzone = NULL;\n\n\t/* Find the right zone */\n\tlist_for_each_entry(curr, &bm->zones, list) {\n\t\tif (pfn >= curr->start_pfn && pfn < curr->end_pfn) {\n\t\t\tzone = curr;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!zone)\n\t\treturn -EFAULT;\n\nzone_found:\n\t/*\n\t * We have found the zone. Now walk the radix tree to find the leaf node\n\t * for our PFN.\n\t */\n\n\t/*\n\t * If the zone we wish to scan is the current zone and the\n\t * pfn falls into the current node then we do not need to walk\n\t * the tree.\n\t */\n\tnode = bm->cur.node;\n\tif (zone == bm->cur.zone &&\n\t    ((pfn - zone->start_pfn) & ~BM_BLOCK_MASK) == bm->cur.node_pfn)\n\t\tgoto node_found;\n\n\tnode      = zone->rtree;\n\tblock_nr  = (pfn - zone->start_pfn) >> BM_BLOCK_SHIFT;\n\n\tfor (i = zone->levels; i > 0; i--) {\n\t\tint index;\n\n\t\tindex = block_nr >> ((i - 1) * BM_RTREE_LEVEL_SHIFT);\n\t\tindex &= BM_RTREE_LEVEL_MASK;\n\t\tBUG_ON(node->data[index] == 0);\n\t\tnode = (struct rtree_node *)node->data[index];\n\t}\n\nnode_found:\n\t/* Update last position */\n\tbm->cur.zone = zone;\n\tbm->cur.node = node;\n\tbm->cur.node_pfn = (pfn - zone->start_pfn) & ~BM_BLOCK_MASK;\n\n\t/* Set return values */\n\t*addr = node->data;\n\t*bit_nr = (pfn - zone->start_pfn) & BM_BLOCK_MASK;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_RTREE_LEVEL_MASK\t((1UL << BM_RTREE_LEVEL_SHIFT) - 1)",
            "#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 3)",
            "#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 2)",
            "#define BM_BLOCK_MASK\t\t((1UL << BM_BLOCK_SHIFT) - 1)",
            "#define BM_BLOCK_SHIFT\t\t(PAGE_SHIFT + 3)"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_RTREE_LEVEL_MASK\t((1UL << BM_RTREE_LEVEL_SHIFT) - 1)\n#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 3)\n#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 2)\n#define BM_BLOCK_MASK\t\t((1UL << BM_BLOCK_SHIFT) - 1)\n#define BM_BLOCK_SHIFT\t\t(PAGE_SHIFT + 3)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic int memory_bm_find_bit(struct memory_bitmap *bm, unsigned long pfn,\n\t\t\t      void **addr, unsigned int *bit_nr)\n{\n\tstruct mem_zone_bm_rtree *curr, *zone;\n\tstruct rtree_node *node;\n\tint i, block_nr;\n\n\tzone = bm->cur.zone;\n\n\tif (pfn >= zone->start_pfn && pfn < zone->end_pfn)\n\t\tgoto zone_found;\n\n\tzone = NULL;\n\n\t/* Find the right zone */\n\tlist_for_each_entry(curr, &bm->zones, list) {\n\t\tif (pfn >= curr->start_pfn && pfn < curr->end_pfn) {\n\t\t\tzone = curr;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!zone)\n\t\treturn -EFAULT;\n\nzone_found:\n\t/*\n\t * We have found the zone. Now walk the radix tree to find the leaf node\n\t * for our PFN.\n\t */\n\n\t/*\n\t * If the zone we wish to scan is the current zone and the\n\t * pfn falls into the current node then we do not need to walk\n\t * the tree.\n\t */\n\tnode = bm->cur.node;\n\tif (zone == bm->cur.zone &&\n\t    ((pfn - zone->start_pfn) & ~BM_BLOCK_MASK) == bm->cur.node_pfn)\n\t\tgoto node_found;\n\n\tnode      = zone->rtree;\n\tblock_nr  = (pfn - zone->start_pfn) >> BM_BLOCK_SHIFT;\n\n\tfor (i = zone->levels; i > 0; i--) {\n\t\tint index;\n\n\t\tindex = block_nr >> ((i - 1) * BM_RTREE_LEVEL_SHIFT);\n\t\tindex &= BM_RTREE_LEVEL_MASK;\n\t\tBUG_ON(node->data[index] == 0);\n\t\tnode = (struct rtree_node *)node->data[index];\n\t}\n\nnode_found:\n\t/* Update last position */\n\tbm->cur.zone = zone;\n\tbm->cur.node = node;\n\tbm->cur.node_pfn = (pfn - zone->start_pfn) & ~BM_BLOCK_MASK;\n\n\t/* Set return values */\n\t*addr = node->data;\n\t*bit_nr = (pfn - zone->start_pfn) & BM_BLOCK_MASK;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_clear_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tclear_bit(bit, addr);\n}"
  },
  {
    "function_name": "mem_bm_set_bit_check",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "817-828",
    "snippet": "static int mem_bm_set_bit_check(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tif (!error)\n\t\tset_bit(bit, addr);\n\n\treturn error;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "bit",
            "addr"
          ],
          "line": 825
        },
        "resolved": true,
        "details": {
          "function_name": "mem_bm_set_bit_check",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "817-828",
          "snippet": "static int mem_bm_set_bit_check(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tif (!error)\n\t\tset_bit(bit, addr);\n\n\treturn error;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_find_bit",
          "args": [
            "bm",
            "pfn",
            "&addr",
            "&bit"
          ],
          "line": 823
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_find_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "740-804",
          "snippet": "static int memory_bm_find_bit(struct memory_bitmap *bm, unsigned long pfn,\n\t\t\t      void **addr, unsigned int *bit_nr)\n{\n\tstruct mem_zone_bm_rtree *curr, *zone;\n\tstruct rtree_node *node;\n\tint i, block_nr;\n\n\tzone = bm->cur.zone;\n\n\tif (pfn >= zone->start_pfn && pfn < zone->end_pfn)\n\t\tgoto zone_found;\n\n\tzone = NULL;\n\n\t/* Find the right zone */\n\tlist_for_each_entry(curr, &bm->zones, list) {\n\t\tif (pfn >= curr->start_pfn && pfn < curr->end_pfn) {\n\t\t\tzone = curr;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!zone)\n\t\treturn -EFAULT;\n\nzone_found:\n\t/*\n\t * We have found the zone. Now walk the radix tree to find the leaf node\n\t * for our PFN.\n\t */\n\n\t/*\n\t * If the zone we wish to scan is the current zone and the\n\t * pfn falls into the current node then we do not need to walk\n\t * the tree.\n\t */\n\tnode = bm->cur.node;\n\tif (zone == bm->cur.zone &&\n\t    ((pfn - zone->start_pfn) & ~BM_BLOCK_MASK) == bm->cur.node_pfn)\n\t\tgoto node_found;\n\n\tnode      = zone->rtree;\n\tblock_nr  = (pfn - zone->start_pfn) >> BM_BLOCK_SHIFT;\n\n\tfor (i = zone->levels; i > 0; i--) {\n\t\tint index;\n\n\t\tindex = block_nr >> ((i - 1) * BM_RTREE_LEVEL_SHIFT);\n\t\tindex &= BM_RTREE_LEVEL_MASK;\n\t\tBUG_ON(node->data[index] == 0);\n\t\tnode = (struct rtree_node *)node->data[index];\n\t}\n\nnode_found:\n\t/* Update last position */\n\tbm->cur.zone = zone;\n\tbm->cur.node = node;\n\tbm->cur.node_pfn = (pfn - zone->start_pfn) & ~BM_BLOCK_MASK;\n\n\t/* Set return values */\n\t*addr = node->data;\n\t*bit_nr = (pfn - zone->start_pfn) & BM_BLOCK_MASK;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_RTREE_LEVEL_MASK\t((1UL << BM_RTREE_LEVEL_SHIFT) - 1)",
            "#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 3)",
            "#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 2)",
            "#define BM_BLOCK_MASK\t\t((1UL << BM_BLOCK_SHIFT) - 1)",
            "#define BM_BLOCK_SHIFT\t\t(PAGE_SHIFT + 3)"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_RTREE_LEVEL_MASK\t((1UL << BM_RTREE_LEVEL_SHIFT) - 1)\n#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 3)\n#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 2)\n#define BM_BLOCK_MASK\t\t((1UL << BM_BLOCK_SHIFT) - 1)\n#define BM_BLOCK_SHIFT\t\t(PAGE_SHIFT + 3)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic int memory_bm_find_bit(struct memory_bitmap *bm, unsigned long pfn,\n\t\t\t      void **addr, unsigned int *bit_nr)\n{\n\tstruct mem_zone_bm_rtree *curr, *zone;\n\tstruct rtree_node *node;\n\tint i, block_nr;\n\n\tzone = bm->cur.zone;\n\n\tif (pfn >= zone->start_pfn && pfn < zone->end_pfn)\n\t\tgoto zone_found;\n\n\tzone = NULL;\n\n\t/* Find the right zone */\n\tlist_for_each_entry(curr, &bm->zones, list) {\n\t\tif (pfn >= curr->start_pfn && pfn < curr->end_pfn) {\n\t\t\tzone = curr;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!zone)\n\t\treturn -EFAULT;\n\nzone_found:\n\t/*\n\t * We have found the zone. Now walk the radix tree to find the leaf node\n\t * for our PFN.\n\t */\n\n\t/*\n\t * If the zone we wish to scan is the current zone and the\n\t * pfn falls into the current node then we do not need to walk\n\t * the tree.\n\t */\n\tnode = bm->cur.node;\n\tif (zone == bm->cur.zone &&\n\t    ((pfn - zone->start_pfn) & ~BM_BLOCK_MASK) == bm->cur.node_pfn)\n\t\tgoto node_found;\n\n\tnode      = zone->rtree;\n\tblock_nr  = (pfn - zone->start_pfn) >> BM_BLOCK_SHIFT;\n\n\tfor (i = zone->levels; i > 0; i--) {\n\t\tint index;\n\n\t\tindex = block_nr >> ((i - 1) * BM_RTREE_LEVEL_SHIFT);\n\t\tindex &= BM_RTREE_LEVEL_MASK;\n\t\tBUG_ON(node->data[index] == 0);\n\t\tnode = (struct rtree_node *)node->data[index];\n\t}\n\nnode_found:\n\t/* Update last position */\n\tbm->cur.zone = zone;\n\tbm->cur.node = node;\n\tbm->cur.node_pfn = (pfn - zone->start_pfn) & ~BM_BLOCK_MASK;\n\n\t/* Set return values */\n\t*addr = node->data;\n\t*bit_nr = (pfn - zone->start_pfn) & BM_BLOCK_MASK;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int mem_bm_set_bit_check(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tif (!error)\n\t\tset_bit(bit, addr);\n\n\treturn error;\n}"
  },
  {
    "function_name": "memory_bm_set_bit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "806-815",
    "snippet": "static void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "bit",
            "addr"
          ],
          "line": 814
        },
        "resolved": true,
        "details": {
          "function_name": "mem_bm_set_bit_check",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "817-828",
          "snippet": "static int mem_bm_set_bit_check(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tif (!error)\n\t\tset_bit(bit, addr);\n\n\treturn error;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int mem_bm_set_bit_check(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tif (!error)\n\t\tset_bit(bit, addr);\n\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "error"
          ],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_bm_find_bit",
          "args": [
            "bm",
            "pfn",
            "&addr",
            "&bit"
          ],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_find_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "740-804",
          "snippet": "static int memory_bm_find_bit(struct memory_bitmap *bm, unsigned long pfn,\n\t\t\t      void **addr, unsigned int *bit_nr)\n{\n\tstruct mem_zone_bm_rtree *curr, *zone;\n\tstruct rtree_node *node;\n\tint i, block_nr;\n\n\tzone = bm->cur.zone;\n\n\tif (pfn >= zone->start_pfn && pfn < zone->end_pfn)\n\t\tgoto zone_found;\n\n\tzone = NULL;\n\n\t/* Find the right zone */\n\tlist_for_each_entry(curr, &bm->zones, list) {\n\t\tif (pfn >= curr->start_pfn && pfn < curr->end_pfn) {\n\t\t\tzone = curr;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!zone)\n\t\treturn -EFAULT;\n\nzone_found:\n\t/*\n\t * We have found the zone. Now walk the radix tree to find the leaf node\n\t * for our PFN.\n\t */\n\n\t/*\n\t * If the zone we wish to scan is the current zone and the\n\t * pfn falls into the current node then we do not need to walk\n\t * the tree.\n\t */\n\tnode = bm->cur.node;\n\tif (zone == bm->cur.zone &&\n\t    ((pfn - zone->start_pfn) & ~BM_BLOCK_MASK) == bm->cur.node_pfn)\n\t\tgoto node_found;\n\n\tnode      = zone->rtree;\n\tblock_nr  = (pfn - zone->start_pfn) >> BM_BLOCK_SHIFT;\n\n\tfor (i = zone->levels; i > 0; i--) {\n\t\tint index;\n\n\t\tindex = block_nr >> ((i - 1) * BM_RTREE_LEVEL_SHIFT);\n\t\tindex &= BM_RTREE_LEVEL_MASK;\n\t\tBUG_ON(node->data[index] == 0);\n\t\tnode = (struct rtree_node *)node->data[index];\n\t}\n\nnode_found:\n\t/* Update last position */\n\tbm->cur.zone = zone;\n\tbm->cur.node = node;\n\tbm->cur.node_pfn = (pfn - zone->start_pfn) & ~BM_BLOCK_MASK;\n\n\t/* Set return values */\n\t*addr = node->data;\n\t*bit_nr = (pfn - zone->start_pfn) & BM_BLOCK_MASK;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_RTREE_LEVEL_MASK\t((1UL << BM_RTREE_LEVEL_SHIFT) - 1)",
            "#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 3)",
            "#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 2)",
            "#define BM_BLOCK_MASK\t\t((1UL << BM_BLOCK_SHIFT) - 1)",
            "#define BM_BLOCK_SHIFT\t\t(PAGE_SHIFT + 3)"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_RTREE_LEVEL_MASK\t((1UL << BM_RTREE_LEVEL_SHIFT) - 1)\n#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 3)\n#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 2)\n#define BM_BLOCK_MASK\t\t((1UL << BM_BLOCK_SHIFT) - 1)\n#define BM_BLOCK_SHIFT\t\t(PAGE_SHIFT + 3)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic int memory_bm_find_bit(struct memory_bitmap *bm, unsigned long pfn,\n\t\t\t      void **addr, unsigned int *bit_nr)\n{\n\tstruct mem_zone_bm_rtree *curr, *zone;\n\tstruct rtree_node *node;\n\tint i, block_nr;\n\n\tzone = bm->cur.zone;\n\n\tif (pfn >= zone->start_pfn && pfn < zone->end_pfn)\n\t\tgoto zone_found;\n\n\tzone = NULL;\n\n\t/* Find the right zone */\n\tlist_for_each_entry(curr, &bm->zones, list) {\n\t\tif (pfn >= curr->start_pfn && pfn < curr->end_pfn) {\n\t\t\tzone = curr;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!zone)\n\t\treturn -EFAULT;\n\nzone_found:\n\t/*\n\t * We have found the zone. Now walk the radix tree to find the leaf node\n\t * for our PFN.\n\t */\n\n\t/*\n\t * If the zone we wish to scan is the current zone and the\n\t * pfn falls into the current node then we do not need to walk\n\t * the tree.\n\t */\n\tnode = bm->cur.node;\n\tif (zone == bm->cur.zone &&\n\t    ((pfn - zone->start_pfn) & ~BM_BLOCK_MASK) == bm->cur.node_pfn)\n\t\tgoto node_found;\n\n\tnode      = zone->rtree;\n\tblock_nr  = (pfn - zone->start_pfn) >> BM_BLOCK_SHIFT;\n\n\tfor (i = zone->levels; i > 0; i--) {\n\t\tint index;\n\n\t\tindex = block_nr >> ((i - 1) * BM_RTREE_LEVEL_SHIFT);\n\t\tindex &= BM_RTREE_LEVEL_MASK;\n\t\tBUG_ON(node->data[index] == 0);\n\t\tnode = (struct rtree_node *)node->data[index];\n\t}\n\nnode_found:\n\t/* Update last position */\n\tbm->cur.zone = zone;\n\tbm->cur.node = node;\n\tbm->cur.node_pfn = (pfn - zone->start_pfn) & ~BM_BLOCK_MASK;\n\n\t/* Set return values */\n\t*addr = node->data;\n\t*bit_nr = (pfn - zone->start_pfn) & BM_BLOCK_MASK;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_set_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\tset_bit(bit, addr);\n}"
  },
  {
    "function_name": "memory_bm_find_bit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "740-804",
    "snippet": "static int memory_bm_find_bit(struct memory_bitmap *bm, unsigned long pfn,\n\t\t\t      void **addr, unsigned int *bit_nr)\n{\n\tstruct mem_zone_bm_rtree *curr, *zone;\n\tstruct rtree_node *node;\n\tint i, block_nr;\n\n\tzone = bm->cur.zone;\n\n\tif (pfn >= zone->start_pfn && pfn < zone->end_pfn)\n\t\tgoto zone_found;\n\n\tzone = NULL;\n\n\t/* Find the right zone */\n\tlist_for_each_entry(curr, &bm->zones, list) {\n\t\tif (pfn >= curr->start_pfn && pfn < curr->end_pfn) {\n\t\t\tzone = curr;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!zone)\n\t\treturn -EFAULT;\n\nzone_found:\n\t/*\n\t * We have found the zone. Now walk the radix tree to find the leaf node\n\t * for our PFN.\n\t */\n\n\t/*\n\t * If the zone we wish to scan is the current zone and the\n\t * pfn falls into the current node then we do not need to walk\n\t * the tree.\n\t */\n\tnode = bm->cur.node;\n\tif (zone == bm->cur.zone &&\n\t    ((pfn - zone->start_pfn) & ~BM_BLOCK_MASK) == bm->cur.node_pfn)\n\t\tgoto node_found;\n\n\tnode      = zone->rtree;\n\tblock_nr  = (pfn - zone->start_pfn) >> BM_BLOCK_SHIFT;\n\n\tfor (i = zone->levels; i > 0; i--) {\n\t\tint index;\n\n\t\tindex = block_nr >> ((i - 1) * BM_RTREE_LEVEL_SHIFT);\n\t\tindex &= BM_RTREE_LEVEL_MASK;\n\t\tBUG_ON(node->data[index] == 0);\n\t\tnode = (struct rtree_node *)node->data[index];\n\t}\n\nnode_found:\n\t/* Update last position */\n\tbm->cur.zone = zone;\n\tbm->cur.node = node;\n\tbm->cur.node_pfn = (pfn - zone->start_pfn) & ~BM_BLOCK_MASK;\n\n\t/* Set return values */\n\t*addr = node->data;\n\t*bit_nr = (pfn - zone->start_pfn) & BM_BLOCK_MASK;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define BM_RTREE_LEVEL_MASK\t((1UL << BM_RTREE_LEVEL_SHIFT) - 1)",
      "#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 3)",
      "#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 2)",
      "#define BM_BLOCK_MASK\t\t((1UL << BM_BLOCK_SHIFT) - 1)",
      "#define BM_BLOCK_SHIFT\t\t(PAGE_SHIFT + 3)"
    ],
    "globals_used": [
      "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "node->data[index] == 0"
          ],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "curr",
            "&bm->zones",
            "list"
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_RTREE_LEVEL_MASK\t((1UL << BM_RTREE_LEVEL_SHIFT) - 1)\n#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 3)\n#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 2)\n#define BM_BLOCK_MASK\t\t((1UL << BM_BLOCK_SHIFT) - 1)\n#define BM_BLOCK_SHIFT\t\t(PAGE_SHIFT + 3)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic int memory_bm_find_bit(struct memory_bitmap *bm, unsigned long pfn,\n\t\t\t      void **addr, unsigned int *bit_nr)\n{\n\tstruct mem_zone_bm_rtree *curr, *zone;\n\tstruct rtree_node *node;\n\tint i, block_nr;\n\n\tzone = bm->cur.zone;\n\n\tif (pfn >= zone->start_pfn && pfn < zone->end_pfn)\n\t\tgoto zone_found;\n\n\tzone = NULL;\n\n\t/* Find the right zone */\n\tlist_for_each_entry(curr, &bm->zones, list) {\n\t\tif (pfn >= curr->start_pfn && pfn < curr->end_pfn) {\n\t\t\tzone = curr;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (!zone)\n\t\treturn -EFAULT;\n\nzone_found:\n\t/*\n\t * We have found the zone. Now walk the radix tree to find the leaf node\n\t * for our PFN.\n\t */\n\n\t/*\n\t * If the zone we wish to scan is the current zone and the\n\t * pfn falls into the current node then we do not need to walk\n\t * the tree.\n\t */\n\tnode = bm->cur.node;\n\tif (zone == bm->cur.zone &&\n\t    ((pfn - zone->start_pfn) & ~BM_BLOCK_MASK) == bm->cur.node_pfn)\n\t\tgoto node_found;\n\n\tnode      = zone->rtree;\n\tblock_nr  = (pfn - zone->start_pfn) >> BM_BLOCK_SHIFT;\n\n\tfor (i = zone->levels; i > 0; i--) {\n\t\tint index;\n\n\t\tindex = block_nr >> ((i - 1) * BM_RTREE_LEVEL_SHIFT);\n\t\tindex &= BM_RTREE_LEVEL_MASK;\n\t\tBUG_ON(node->data[index] == 0);\n\t\tnode = (struct rtree_node *)node->data[index];\n\t}\n\nnode_found:\n\t/* Update last position */\n\tbm->cur.zone = zone;\n\tbm->cur.node = node;\n\tbm->cur.node_pfn = (pfn - zone->start_pfn) & ~BM_BLOCK_MASK;\n\n\t/* Set return values */\n\t*addr = node->data;\n\t*bit_nr = (pfn - zone->start_pfn) & BM_BLOCK_MASK;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "memory_bm_free",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "719-729",
    "snippet": "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\n\tlist_for_each_entry(zone, &bm->zones, list)\n\t\tfree_zone_bm_rtree(zone, clear_nosave_free);\n\n\tfree_list_of_pages(bm->p_list, clear_nosave_free);\n\n\tINIT_LIST_HEAD(&bm->zones);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);",
      "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&bm->zones"
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_list_of_pages",
          "args": [
            "bm->p_list",
            "clear_nosave_free"
          ],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "free_list_of_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "268-277",
          "snippet": "static inline void free_list_of_pages(struct linked_page *list,\n\t\t\t\t      int clear_page_nosave)\n{\n\twhile (list) {\n\t\tstruct linked_page *lp = list->next;\n\n\t\tfree_image_page(list, clear_page_nosave);\n\t\tlist = lp;\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void free_list_of_pages(struct linked_page *list,\n\t\t\t\t      int clear_page_nosave)\n{\n\twhile (list) {\n\t\tstruct linked_page *lp = list->next;\n\n\t\tfree_image_page(list, clear_page_nosave);\n\t\tlist = lp;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_zone_bm_rtree",
          "args": [
            "zone",
            "clear_nosave_free"
          ],
          "line": 724
        },
        "resolved": true,
        "details": {
          "function_name": "free_zone_bm_rtree",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "569-579",
          "snippet": "static void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free)\n{\n\tstruct rtree_node *node;\n\n\tlist_for_each_entry(node, &zone->nodes, list)\n\t\tfree_image_page(node->data, clear_nosave_free);\n\n\tlist_for_each_entry(node, &zone->leaves, list)\n\t\tfree_image_page(node->data, clear_nosave_free);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;",
            "static void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);",
            "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\nstatic void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);\n\nstatic void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free)\n{\n\tstruct rtree_node *node;\n\n\tlist_for_each_entry(node, &zone->nodes, list)\n\t\tfree_image_page(node->data, clear_nosave_free);\n\n\tlist_for_each_entry(node, &zone->leaves, list)\n\t\tfree_image_page(node->data, clear_nosave_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "zone",
            "&bm->zones",
            "list"
          ],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);\n\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\n\tlist_for_each_entry(zone, &bm->zones, list)\n\t\tfree_zone_bm_rtree(zone, clear_nosave_free);\n\n\tfree_list_of_pages(bm->p_list, clear_nosave_free);\n\n\tINIT_LIST_HEAD(&bm->zones);\n}"
  },
  {
    "function_name": "memory_bm_create",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "676-713",
    "snippet": "static int memory_bm_create(struct memory_bitmap *bm, gfp_t gfp_mask,\n\t\t\t    int safe_needed)\n{\n\tstruct chain_allocator ca;\n\tstruct list_head mem_extents;\n\tstruct mem_extent *ext;\n\tint error;\n\n\tchain_init(&ca, gfp_mask, safe_needed);\n\tINIT_LIST_HEAD(&bm->zones);\n\n\terror = create_mem_extents(&mem_extents, gfp_mask);\n\tif (error)\n\t\treturn error;\n\n\tlist_for_each_entry(ext, &mem_extents, hook) {\n\t\tstruct mem_zone_bm_rtree *zone;\n\n\t\tzone = create_zone_bm_rtree(gfp_mask, safe_needed, &ca,\n\t\t\t\t\t    ext->start, ext->end);\n\t\tif (!zone) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Error;\n\t\t}\n\t\tlist_add_tail(&zone->list, &bm->zones);\n\t}\n\n\tbm->p_list = ca.chain;\n\tmemory_bm_position_reset(bm);\n Exit:\n\tfree_mem_extents(&mem_extents);\n\treturn error;\n\n Error:\n\tbm->p_list = ca.chain;\n\tmemory_bm_free(bm, PG_UNSAFE_CLEAR);\n\tgoto Exit;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define PG_UNSAFE_CLEAR\t1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memory_bm_free",
          "args": [
            "bm",
            "PG_UNSAFE_CLEAR"
          ],
          "line": 711
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "719-729",
          "snippet": "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\n\tlist_for_each_entry(zone, &bm->zones, list)\n\t\tfree_zone_bm_rtree(zone, clear_nosave_free);\n\n\tfree_list_of_pages(bm->p_list, clear_nosave_free);\n\n\tINIT_LIST_HEAD(&bm->zones);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);",
            "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);\n\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\n\tlist_for_each_entry(zone, &bm->zones, list)\n\t\tfree_zone_bm_rtree(zone, clear_nosave_free);\n\n\tfree_list_of_pages(bm->p_list, clear_nosave_free);\n\n\tINIT_LIST_HEAD(&bm->zones);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_mem_extents",
          "args": [
            "&mem_extents"
          ],
          "line": 706
        },
        "resolved": true,
        "details": {
          "function_name": "free_mem_extents",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "603-611",
          "snippet": "static void free_mem_extents(struct list_head *list)\n{\n\tstruct mem_extent *ext, *aux;\n\n\tlist_for_each_entry_safe(ext, aux, list, hook) {\n\t\tlist_del(&ext->hook);\n\t\tkfree(ext);\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void free_mem_extents(struct list_head *list)\n{\n\tstruct mem_extent *ext, *aux;\n\n\tlist_for_each_entry_safe(ext, aux, list, hook) {\n\t\tlist_del(&ext->hook);\n\t\tkfree(ext);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_bm_position_reset",
          "args": [
            "bm"
          ],
          "line": 704
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_position_reset",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "581-589",
          "snippet": "static void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&zone->list",
            "&bm->zones"
          ],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "create_zone_bm_rtree",
          "args": [
            "gfp_mask",
            "safe_needed",
            "&ca",
            "ext->start",
            "ext->end"
          ],
          "line": 694
        },
        "resolved": true,
        "details": {
          "function_name": "create_zone_bm_rtree",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "531-560",
          "snippet": "static struct mem_zone_bm_rtree *create_zone_bm_rtree(gfp_t gfp_mask,\n\t\t\t\t\t\t      int safe_needed,\n\t\t\t\t\t\t      struct chain_allocator *ca,\n\t\t\t\t\t\t      unsigned long start,\n\t\t\t\t\t\t      unsigned long end)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\tunsigned int i, nr_blocks;\n\tunsigned long pages;\n\n\tpages = end - start;\n\tzone  = chain_alloc(ca, sizeof(struct mem_zone_bm_rtree));\n\tif (!zone)\n\t\treturn NULL;\n\n\tINIT_LIST_HEAD(&zone->nodes);\n\tINIT_LIST_HEAD(&zone->leaves);\n\tzone->start_pfn = start;\n\tzone->end_pfn = end;\n\tnr_blocks = DIV_ROUND_UP(pages, BM_BITS_PER_BLOCK);\n\n\tfor (i = 0; i < nr_blocks; i++) {\n\t\tif (add_rtree_block(zone, gfp_mask, safe_needed, ca)) {\n\t\t\tfree_zone_bm_rtree(zone, PG_UNSAFE_CLEAR);\n\t\t\treturn NULL;\n\t\t}\n\t}\n\n\treturn zone;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)",
            "#define PG_UNSAFE_CLEAR\t1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)\n#define PG_UNSAFE_CLEAR\t1\n\nstatic struct mem_zone_bm_rtree *create_zone_bm_rtree(gfp_t gfp_mask,\n\t\t\t\t\t\t      int safe_needed,\n\t\t\t\t\t\t      struct chain_allocator *ca,\n\t\t\t\t\t\t      unsigned long start,\n\t\t\t\t\t\t      unsigned long end)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\tunsigned int i, nr_blocks;\n\tunsigned long pages;\n\n\tpages = end - start;\n\tzone  = chain_alloc(ca, sizeof(struct mem_zone_bm_rtree));\n\tif (!zone)\n\t\treturn NULL;\n\n\tINIT_LIST_HEAD(&zone->nodes);\n\tINIT_LIST_HEAD(&zone->leaves);\n\tzone->start_pfn = start;\n\tzone->end_pfn = end;\n\tnr_blocks = DIV_ROUND_UP(pages, BM_BITS_PER_BLOCK);\n\n\tfor (i = 0; i < nr_blocks; i++) {\n\t\tif (add_rtree_block(zone, gfp_mask, safe_needed, ca)) {\n\t\t\tfree_zone_bm_rtree(zone, PG_UNSAFE_CLEAR);\n\t\t\treturn NULL;\n\t\t}\n\t}\n\n\treturn zone;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "ext",
            "&mem_extents",
            "hook"
          ],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "create_mem_extents",
          "args": [
            "&mem_extents",
            "gfp_mask"
          ],
          "line": 687
        },
        "resolved": true,
        "details": {
          "function_name": "create_mem_extents",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "620-671",
          "snippet": "static int create_mem_extents(struct list_head *list, gfp_t gfp_mask)\n{\n\tstruct zone *zone;\n\n\tINIT_LIST_HEAD(list);\n\n\tfor_each_populated_zone(zone) {\n\t\tunsigned long zone_start, zone_end;\n\t\tstruct mem_extent *ext, *cur, *aux;\n\n\t\tzone_start = zone->zone_start_pfn;\n\t\tzone_end = zone_end_pfn(zone);\n\n\t\tlist_for_each_entry(ext, list, hook)\n\t\t\tif (zone_start <= ext->end)\n\t\t\t\tbreak;\n\n\t\tif (&ext->hook == list || zone_end < ext->start) {\n\t\t\t/* New extent is necessary */\n\t\t\tstruct mem_extent *new_ext;\n\n\t\t\tnew_ext = kzalloc(sizeof(struct mem_extent), gfp_mask);\n\t\t\tif (!new_ext) {\n\t\t\t\tfree_mem_extents(list);\n\t\t\t\treturn -ENOMEM;\n\t\t\t}\n\t\t\tnew_ext->start = zone_start;\n\t\t\tnew_ext->end = zone_end;\n\t\t\tlist_add_tail(&new_ext->hook, &ext->hook);\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* Merge this zone's range of PFNs with the existing one */\n\t\tif (zone_start < ext->start)\n\t\t\text->start = zone_start;\n\t\tif (zone_end > ext->end)\n\t\t\text->end = zone_end;\n\n\t\t/* More merging may be possible */\n\t\tcur = ext;\n\t\tlist_for_each_entry_safe_continue(cur, aux, list, hook) {\n\t\t\tif (zone_end < cur->start)\n\t\t\t\tbreak;\n\t\t\tif (zone_end < cur->end)\n\t\t\t\text->end = cur->end;\n\t\t\tlist_del(&cur->hook);\n\t\t\tkfree(cur);\n\t\t}\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int create_mem_extents(struct list_head *list, gfp_t gfp_mask)\n{\n\tstruct zone *zone;\n\n\tINIT_LIST_HEAD(list);\n\n\tfor_each_populated_zone(zone) {\n\t\tunsigned long zone_start, zone_end;\n\t\tstruct mem_extent *ext, *cur, *aux;\n\n\t\tzone_start = zone->zone_start_pfn;\n\t\tzone_end = zone_end_pfn(zone);\n\n\t\tlist_for_each_entry(ext, list, hook)\n\t\t\tif (zone_start <= ext->end)\n\t\t\t\tbreak;\n\n\t\tif (&ext->hook == list || zone_end < ext->start) {\n\t\t\t/* New extent is necessary */\n\t\t\tstruct mem_extent *new_ext;\n\n\t\t\tnew_ext = kzalloc(sizeof(struct mem_extent), gfp_mask);\n\t\t\tif (!new_ext) {\n\t\t\t\tfree_mem_extents(list);\n\t\t\t\treturn -ENOMEM;\n\t\t\t}\n\t\t\tnew_ext->start = zone_start;\n\t\t\tnew_ext->end = zone_end;\n\t\t\tlist_add_tail(&new_ext->hook, &ext->hook);\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* Merge this zone's range of PFNs with the existing one */\n\t\tif (zone_start < ext->start)\n\t\t\text->start = zone_start;\n\t\tif (zone_end > ext->end)\n\t\t\text->end = zone_end;\n\n\t\t/* More merging may be possible */\n\t\tcur = ext;\n\t\tlist_for_each_entry_safe_continue(cur, aux, list, hook) {\n\t\t\tif (zone_end < cur->start)\n\t\t\t\tbreak;\n\t\t\tif (zone_end < cur->end)\n\t\t\t\text->end = cur->end;\n\t\t\tlist_del(&cur->hook);\n\t\t\tkfree(cur);\n\t\t}\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&bm->zones"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chain_init",
          "args": [
            "&ca",
            "gfp_mask",
            "safe_needed"
          ],
          "line": 684
        },
        "resolved": true,
        "details": {
          "function_name": "chain_init",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "299-306",
          "snippet": "static void chain_init(struct chain_allocator *ca, gfp_t gfp_mask,\n\t\t       int safe_needed)\n{\n\tca->chain = NULL;\n\tca->used_space = LINKED_PAGE_DATA_SIZE;\n\tca->gfp_mask = gfp_mask;\n\tca->safe_needed = safe_needed;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))\n\nstatic void chain_init(struct chain_allocator *ca, gfp_t gfp_mask,\n\t\t       int safe_needed)\n{\n\tca->chain = NULL;\n\tca->used_space = LINKED_PAGE_DATA_SIZE;\n\tca->gfp_mask = gfp_mask;\n\tca->safe_needed = safe_needed;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_UNSAFE_CLEAR\t1\n\nstatic int memory_bm_create(struct memory_bitmap *bm, gfp_t gfp_mask,\n\t\t\t    int safe_needed)\n{\n\tstruct chain_allocator ca;\n\tstruct list_head mem_extents;\n\tstruct mem_extent *ext;\n\tint error;\n\n\tchain_init(&ca, gfp_mask, safe_needed);\n\tINIT_LIST_HEAD(&bm->zones);\n\n\terror = create_mem_extents(&mem_extents, gfp_mask);\n\tif (error)\n\t\treturn error;\n\n\tlist_for_each_entry(ext, &mem_extents, hook) {\n\t\tstruct mem_zone_bm_rtree *zone;\n\n\t\tzone = create_zone_bm_rtree(gfp_mask, safe_needed, &ca,\n\t\t\t\t\t    ext->start, ext->end);\n\t\tif (!zone) {\n\t\t\terror = -ENOMEM;\n\t\t\tgoto Error;\n\t\t}\n\t\tlist_add_tail(&zone->list, &bm->zones);\n\t}\n\n\tbm->p_list = ca.chain;\n\tmemory_bm_position_reset(bm);\n Exit:\n\tfree_mem_extents(&mem_extents);\n\treturn error;\n\n Error:\n\tbm->p_list = ca.chain;\n\tmemory_bm_free(bm, PG_UNSAFE_CLEAR);\n\tgoto Exit;\n}"
  },
  {
    "function_name": "create_mem_extents",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "620-671",
    "snippet": "static int create_mem_extents(struct list_head *list, gfp_t gfp_mask)\n{\n\tstruct zone *zone;\n\n\tINIT_LIST_HEAD(list);\n\n\tfor_each_populated_zone(zone) {\n\t\tunsigned long zone_start, zone_end;\n\t\tstruct mem_extent *ext, *cur, *aux;\n\n\t\tzone_start = zone->zone_start_pfn;\n\t\tzone_end = zone_end_pfn(zone);\n\n\t\tlist_for_each_entry(ext, list, hook)\n\t\t\tif (zone_start <= ext->end)\n\t\t\t\tbreak;\n\n\t\tif (&ext->hook == list || zone_end < ext->start) {\n\t\t\t/* New extent is necessary */\n\t\t\tstruct mem_extent *new_ext;\n\n\t\t\tnew_ext = kzalloc(sizeof(struct mem_extent), gfp_mask);\n\t\t\tif (!new_ext) {\n\t\t\t\tfree_mem_extents(list);\n\t\t\t\treturn -ENOMEM;\n\t\t\t}\n\t\t\tnew_ext->start = zone_start;\n\t\t\tnew_ext->end = zone_end;\n\t\t\tlist_add_tail(&new_ext->hook, &ext->hook);\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* Merge this zone's range of PFNs with the existing one */\n\t\tif (zone_start < ext->start)\n\t\t\text->start = zone_start;\n\t\tif (zone_end > ext->end)\n\t\t\text->end = zone_end;\n\n\t\t/* More merging may be possible */\n\t\tcur = ext;\n\t\tlist_for_each_entry_safe_continue(cur, aux, list, hook) {\n\t\t\tif (zone_end < cur->start)\n\t\t\t\tbreak;\n\t\t\tif (zone_end < cur->end)\n\t\t\t\text->end = cur->end;\n\t\t\tlist_del(&cur->hook);\n\t\t\tkfree(cur);\n\t\t}\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cur"
          ],
          "line": 666
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/params.c",
          "lines": "62-75",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/security.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/security.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&cur->hook"
          ],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "list_del_leaf_cfs_rq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/fair.c",
          "lines": "475-477",
          "snippet": "static inline void list_del_leaf_cfs_rq(struct cfs_rq *cfs_rq)\n{\n}",
          "includes": [
            "#include \"pelt.h\"",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool sched_idle_cfs_rq(struct cfs_rq *cfs_rq);",
            "static void check_enqueue_throttle(struct cfs_rq *cfs_rq);",
            "static __always_inline void return_cfs_rq_runtime(struct cfs_rq *cfs_rq);",
            "static bool check_cfs_rq_runtime(struct cfs_rq *cfs_rq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pelt.h\"\n#include \"sched.h\"\n\nstatic bool sched_idle_cfs_rq(struct cfs_rq *cfs_rq);\nstatic void check_enqueue_throttle(struct cfs_rq *cfs_rq);\nstatic __always_inline void return_cfs_rq_runtime(struct cfs_rq *cfs_rq);\nstatic bool check_cfs_rq_runtime(struct cfs_rq *cfs_rq);\n\nstatic inline void list_del_leaf_cfs_rq(struct cfs_rq *cfs_rq)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe_continue",
          "args": [
            "cur",
            "aux",
            "list",
            "hook"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&new_ext->hook",
            "&ext->hook"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_mem_extents",
          "args": [
            "list"
          ],
          "line": 643
        },
        "resolved": true,
        "details": {
          "function_name": "free_mem_extents",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "603-611",
          "snippet": "static void free_mem_extents(struct list_head *list)\n{\n\tstruct mem_extent *ext, *aux;\n\n\tlist_for_each_entry_safe(ext, aux, list, hook) {\n\t\tlist_del(&ext->hook);\n\t\tkfree(ext);\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void free_mem_extents(struct list_head *list)\n{\n\tstruct mem_extent *ext, *aux;\n\n\tlist_for_each_entry_safe(ext, aux, list, hook) {\n\t\tlist_del(&ext->hook);\n\t\tkfree(ext);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct mem_extent)",
            "gfp_mask"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "ext",
            "list",
            "hook"
          ],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zone_end_pfn",
          "args": [
            "zone"
          ],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "list"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int create_mem_extents(struct list_head *list, gfp_t gfp_mask)\n{\n\tstruct zone *zone;\n\n\tINIT_LIST_HEAD(list);\n\n\tfor_each_populated_zone(zone) {\n\t\tunsigned long zone_start, zone_end;\n\t\tstruct mem_extent *ext, *cur, *aux;\n\n\t\tzone_start = zone->zone_start_pfn;\n\t\tzone_end = zone_end_pfn(zone);\n\n\t\tlist_for_each_entry(ext, list, hook)\n\t\t\tif (zone_start <= ext->end)\n\t\t\t\tbreak;\n\n\t\tif (&ext->hook == list || zone_end < ext->start) {\n\t\t\t/* New extent is necessary */\n\t\t\tstruct mem_extent *new_ext;\n\n\t\t\tnew_ext = kzalloc(sizeof(struct mem_extent), gfp_mask);\n\t\t\tif (!new_ext) {\n\t\t\t\tfree_mem_extents(list);\n\t\t\t\treturn -ENOMEM;\n\t\t\t}\n\t\t\tnew_ext->start = zone_start;\n\t\t\tnew_ext->end = zone_end;\n\t\t\tlist_add_tail(&new_ext->hook, &ext->hook);\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* Merge this zone's range of PFNs with the existing one */\n\t\tif (zone_start < ext->start)\n\t\t\text->start = zone_start;\n\t\tif (zone_end > ext->end)\n\t\t\text->end = zone_end;\n\n\t\t/* More merging may be possible */\n\t\tcur = ext;\n\t\tlist_for_each_entry_safe_continue(cur, aux, list, hook) {\n\t\t\tif (zone_end < cur->start)\n\t\t\t\tbreak;\n\t\t\tif (zone_end < cur->end)\n\t\t\t\text->end = cur->end;\n\t\t\tlist_del(&cur->hook);\n\t\t\tkfree(cur);\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "free_mem_extents",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "603-611",
    "snippet": "static void free_mem_extents(struct list_head *list)\n{\n\tstruct mem_extent *ext, *aux;\n\n\tlist_for_each_entry_safe(ext, aux, list, hook) {\n\t\tlist_del(&ext->hook);\n\t\tkfree(ext);\n\t}\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "ext"
          ],
          "line": 609
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/params.c",
          "lines": "62-75",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/security.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/security.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&ext->hook"
          ],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "list_del_leaf_cfs_rq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/fair.c",
          "lines": "475-477",
          "snippet": "static inline void list_del_leaf_cfs_rq(struct cfs_rq *cfs_rq)\n{\n}",
          "includes": [
            "#include \"pelt.h\"",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool sched_idle_cfs_rq(struct cfs_rq *cfs_rq);",
            "static void check_enqueue_throttle(struct cfs_rq *cfs_rq);",
            "static __always_inline void return_cfs_rq_runtime(struct cfs_rq *cfs_rq);",
            "static bool check_cfs_rq_runtime(struct cfs_rq *cfs_rq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pelt.h\"\n#include \"sched.h\"\n\nstatic bool sched_idle_cfs_rq(struct cfs_rq *cfs_rq);\nstatic void check_enqueue_throttle(struct cfs_rq *cfs_rq);\nstatic __always_inline void return_cfs_rq_runtime(struct cfs_rq *cfs_rq);\nstatic bool check_cfs_rq_runtime(struct cfs_rq *cfs_rq);\n\nstatic inline void list_del_leaf_cfs_rq(struct cfs_rq *cfs_rq)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "ext",
            "aux",
            "list",
            "hook"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void free_mem_extents(struct list_head *list)\n{\n\tstruct mem_extent *ext, *aux;\n\n\tlist_for_each_entry_safe(ext, aux, list, hook) {\n\t\tlist_del(&ext->hook);\n\t\tkfree(ext);\n\t}\n}"
  },
  {
    "function_name": "memory_bm_position_reset",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "581-589",
    "snippet": "static void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "bm->cur.zone->leaves.next",
            "structrtree_node",
            "list"
          ],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "bm->zones.next",
            "structmem_zone_bm_rtree",
            "list"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic void memory_bm_position_reset(struct memory_bitmap *bm)\n{\n\tbm->cur.zone = list_entry(bm->zones.next, struct mem_zone_bm_rtree,\n\t\t\t\t  list);\n\tbm->cur.node = list_entry(bm->cur.zone->leaves.next,\n\t\t\t\t  struct rtree_node, list);\n\tbm->cur.node_pfn = 0;\n\tbm->cur.node_bit = 0;\n}"
  },
  {
    "function_name": "free_zone_bm_rtree",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "569-579",
    "snippet": "static void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free)\n{\n\tstruct rtree_node *node;\n\n\tlist_for_each_entry(node, &zone->nodes, list)\n\t\tfree_image_page(node->data, clear_nosave_free);\n\n\tlist_for_each_entry(node, &zone->leaves, list)\n\t\tfree_image_page(node->data, clear_nosave_free);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;",
      "static void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);",
      "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_image_page",
          "args": [
            "node->data",
            "clear_nosave_free"
          ],
          "line": 578
        },
        "resolved": true,
        "details": {
          "function_name": "free_image_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "253-266",
          "snippet": "static inline void free_image_page(void *addr, int clear_nosave_free)\n{\n\tstruct page *page;\n\n\tBUG_ON(!virt_addr_valid(addr));\n\n\tpage = virt_to_page(addr);\n\n\tswsusp_unset_page_forbidden(page);\n\tif (clear_nosave_free)\n\t\tswsusp_unset_page_free(page);\n\n\t__free_page(page);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);",
            "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);\n\nstatic inline void free_image_page(void *addr, int clear_nosave_free)\n{\n\tstruct page *page;\n\n\tBUG_ON(!virt_addr_valid(addr));\n\n\tpage = virt_to_page(addr);\n\n\tswsusp_unset_page_forbidden(page);\n\tif (clear_nosave_free)\n\t\tswsusp_unset_page_free(page);\n\n\t__free_page(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "node",
            "&zone->leaves",
            "list"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "node",
            "&zone->nodes",
            "list"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\nstatic void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);\n\nstatic void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free)\n{\n\tstruct rtree_node *node;\n\n\tlist_for_each_entry(node, &zone->nodes, list)\n\t\tfree_image_page(node->data, clear_nosave_free);\n\n\tlist_for_each_entry(node, &zone->leaves, list)\n\t\tfree_image_page(node->data, clear_nosave_free);\n}"
  },
  {
    "function_name": "create_zone_bm_rtree",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "531-560",
    "snippet": "static struct mem_zone_bm_rtree *create_zone_bm_rtree(gfp_t gfp_mask,\n\t\t\t\t\t\t      int safe_needed,\n\t\t\t\t\t\t      struct chain_allocator *ca,\n\t\t\t\t\t\t      unsigned long start,\n\t\t\t\t\t\t      unsigned long end)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\tunsigned int i, nr_blocks;\n\tunsigned long pages;\n\n\tpages = end - start;\n\tzone  = chain_alloc(ca, sizeof(struct mem_zone_bm_rtree));\n\tif (!zone)\n\t\treturn NULL;\n\n\tINIT_LIST_HEAD(&zone->nodes);\n\tINIT_LIST_HEAD(&zone->leaves);\n\tzone->start_pfn = start;\n\tzone->end_pfn = end;\n\tnr_blocks = DIV_ROUND_UP(pages, BM_BITS_PER_BLOCK);\n\n\tfor (i = 0; i < nr_blocks; i++) {\n\t\tif (add_rtree_block(zone, gfp_mask, safe_needed, ca)) {\n\t\t\tfree_zone_bm_rtree(zone, PG_UNSAFE_CLEAR);\n\t\t\treturn NULL;\n\t\t}\n\t}\n\n\treturn zone;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)",
      "#define PG_UNSAFE_CLEAR\t1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_zone_bm_rtree",
          "args": [
            "zone",
            "PG_UNSAFE_CLEAR"
          ],
          "line": 554
        },
        "resolved": true,
        "details": {
          "function_name": "free_zone_bm_rtree",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "569-579",
          "snippet": "static void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free)\n{\n\tstruct rtree_node *node;\n\n\tlist_for_each_entry(node, &zone->nodes, list)\n\t\tfree_image_page(node->data, clear_nosave_free);\n\n\tlist_for_each_entry(node, &zone->leaves, list)\n\t\tfree_image_page(node->data, clear_nosave_free);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;",
            "static void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);",
            "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\nstatic void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);\n\nstatic void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free)\n{\n\tstruct rtree_node *node;\n\n\tlist_for_each_entry(node, &zone->nodes, list)\n\t\tfree_image_page(node->data, clear_nosave_free);\n\n\tlist_for_each_entry(node, &zone->leaves, list)\n\t\tfree_image_page(node->data, clear_nosave_free);\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_rtree_block",
          "args": [
            "zone",
            "gfp_mask",
            "safe_needed",
            "ca"
          ],
          "line": 553
        },
        "resolved": true,
        "details": {
          "function_name": "add_rtree_block",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "461-519",
          "snippet": "static int add_rtree_block(struct mem_zone_bm_rtree *zone, gfp_t gfp_mask,\n\t\t\t   int safe_needed, struct chain_allocator *ca)\n{\n\tstruct rtree_node *node, *block, **dst;\n\tunsigned int levels_needed, block_nr;\n\tint i;\n\n\tblock_nr = zone->blocks;\n\tlevels_needed = 0;\n\n\t/* How many levels do we need for this block nr? */\n\twhile (block_nr) {\n\t\tlevels_needed += 1;\n\t\tblock_nr >>= BM_RTREE_LEVEL_SHIFT;\n\t}\n\n\t/* Make sure the rtree has enough levels */\n\tfor (i = zone->levels; i < levels_needed; i++) {\n\t\tnode = alloc_rtree_node(gfp_mask, safe_needed, ca,\n\t\t\t\t\t&zone->nodes);\n\t\tif (!node)\n\t\t\treturn -ENOMEM;\n\n\t\tnode->data[0] = (unsigned long)zone->rtree;\n\t\tzone->rtree = node;\n\t\tzone->levels += 1;\n\t}\n\n\t/* Allocate new block */\n\tblock = alloc_rtree_node(gfp_mask, safe_needed, ca, &zone->leaves);\n\tif (!block)\n\t\treturn -ENOMEM;\n\n\t/* Now walk the rtree to insert the block */\n\tnode = zone->rtree;\n\tdst = &zone->rtree;\n\tblock_nr = zone->blocks;\n\tfor (i = zone->levels; i > 0; i--) {\n\t\tint index;\n\n\t\tif (!node) {\n\t\t\tnode = alloc_rtree_node(gfp_mask, safe_needed, ca,\n\t\t\t\t\t\t&zone->nodes);\n\t\t\tif (!node)\n\t\t\t\treturn -ENOMEM;\n\t\t\t*dst = node;\n\t\t}\n\n\t\tindex = block_nr >> ((i - 1) * BM_RTREE_LEVEL_SHIFT);\n\t\tindex &= BM_RTREE_LEVEL_MASK;\n\t\tdst = (struct rtree_node **)&((*dst)->data[index]);\n\t\tnode = *dst;\n\t}\n\n\tzone->blocks += 1;\n\t*dst = block;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define BM_RTREE_LEVEL_MASK\t((1UL << BM_RTREE_LEVEL_SHIFT) - 1)",
            "#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 3)",
            "#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 2)"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_RTREE_LEVEL_MASK\t((1UL << BM_RTREE_LEVEL_SHIFT) - 1)\n#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 3)\n#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 2)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic int add_rtree_block(struct mem_zone_bm_rtree *zone, gfp_t gfp_mask,\n\t\t\t   int safe_needed, struct chain_allocator *ca)\n{\n\tstruct rtree_node *node, *block, **dst;\n\tunsigned int levels_needed, block_nr;\n\tint i;\n\n\tblock_nr = zone->blocks;\n\tlevels_needed = 0;\n\n\t/* How many levels do we need for this block nr? */\n\twhile (block_nr) {\n\t\tlevels_needed += 1;\n\t\tblock_nr >>= BM_RTREE_LEVEL_SHIFT;\n\t}\n\n\t/* Make sure the rtree has enough levels */\n\tfor (i = zone->levels; i < levels_needed; i++) {\n\t\tnode = alloc_rtree_node(gfp_mask, safe_needed, ca,\n\t\t\t\t\t&zone->nodes);\n\t\tif (!node)\n\t\t\treturn -ENOMEM;\n\n\t\tnode->data[0] = (unsigned long)zone->rtree;\n\t\tzone->rtree = node;\n\t\tzone->levels += 1;\n\t}\n\n\t/* Allocate new block */\n\tblock = alloc_rtree_node(gfp_mask, safe_needed, ca, &zone->leaves);\n\tif (!block)\n\t\treturn -ENOMEM;\n\n\t/* Now walk the rtree to insert the block */\n\tnode = zone->rtree;\n\tdst = &zone->rtree;\n\tblock_nr = zone->blocks;\n\tfor (i = zone->levels; i > 0; i--) {\n\t\tint index;\n\n\t\tif (!node) {\n\t\t\tnode = alloc_rtree_node(gfp_mask, safe_needed, ca,\n\t\t\t\t\t\t&zone->nodes);\n\t\t\tif (!node)\n\t\t\t\treturn -ENOMEM;\n\t\t\t*dst = node;\n\t\t}\n\n\t\tindex = block_nr >> ((i - 1) * BM_RTREE_LEVEL_SHIFT);\n\t\tindex &= BM_RTREE_LEVEL_MASK;\n\t\tdst = (struct rtree_node **)&((*dst)->data[index]);\n\t\tnode = *dst;\n\t}\n\n\tzone->blocks += 1;\n\t*dst = block;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "pages",
            "BM_BITS_PER_BLOCK"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&zone->leaves"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&zone->nodes"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chain_alloc",
          "args": [
            "ca",
            "sizeof(struct mem_zone_bm_rtree)"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "chain_alloc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "308-327",
          "snippet": "static void *chain_alloc(struct chain_allocator *ca, unsigned int size)\n{\n\tvoid *ret;\n\n\tif (LINKED_PAGE_DATA_SIZE - ca->used_space < size) {\n\t\tstruct linked_page *lp;\n\n\t\tlp = ca->safe_needed ? __get_safe_page(ca->gfp_mask) :\n\t\t\t\t\tget_image_page(ca->gfp_mask, PG_ANY);\n\t\tif (!lp)\n\t\t\treturn NULL;\n\n\t\tlp->next = ca->chain;\n\t\tca->chain = lp;\n\t\tca->used_space = 0;\n\t}\n\tret = ca->chain->data + ca->used_space;\n\tca->used_space += size;\n\treturn ret;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define PG_ANY\t\t0",
            "#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_ANY\t\t0\n#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic void *chain_alloc(struct chain_allocator *ca, unsigned int size)\n{\n\tvoid *ret;\n\n\tif (LINKED_PAGE_DATA_SIZE - ca->used_space < size) {\n\t\tstruct linked_page *lp;\n\n\t\tlp = ca->safe_needed ? __get_safe_page(ca->gfp_mask) :\n\t\t\t\t\tget_image_page(ca->gfp_mask, PG_ANY);\n\t\tif (!lp)\n\t\t\treturn NULL;\n\n\t\tlp->next = ca->chain;\n\t\tca->chain = lp;\n\t\tca->used_space = 0;\n\t}\n\tret = ca->chain->data + ca->used_space;\n\tca->used_space += size;\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_BITS_PER_BLOCK\t(PAGE_SIZE * BITS_PER_BYTE)\n#define PG_UNSAFE_CLEAR\t1\n\nstatic struct mem_zone_bm_rtree *create_zone_bm_rtree(gfp_t gfp_mask,\n\t\t\t\t\t\t      int safe_needed,\n\t\t\t\t\t\t      struct chain_allocator *ca,\n\t\t\t\t\t\t      unsigned long start,\n\t\t\t\t\t\t      unsigned long end)\n{\n\tstruct mem_zone_bm_rtree *zone;\n\tunsigned int i, nr_blocks;\n\tunsigned long pages;\n\n\tpages = end - start;\n\tzone  = chain_alloc(ca, sizeof(struct mem_zone_bm_rtree));\n\tif (!zone)\n\t\treturn NULL;\n\n\tINIT_LIST_HEAD(&zone->nodes);\n\tINIT_LIST_HEAD(&zone->leaves);\n\tzone->start_pfn = start;\n\tzone->end_pfn = end;\n\tnr_blocks = DIV_ROUND_UP(pages, BM_BITS_PER_BLOCK);\n\n\tfor (i = 0; i < nr_blocks; i++) {\n\t\tif (add_rtree_block(zone, gfp_mask, safe_needed, ca)) {\n\t\t\tfree_zone_bm_rtree(zone, PG_UNSAFE_CLEAR);\n\t\t\treturn NULL;\n\t\t}\n\t}\n\n\treturn zone;\n}"
  },
  {
    "function_name": "add_rtree_block",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "461-519",
    "snippet": "static int add_rtree_block(struct mem_zone_bm_rtree *zone, gfp_t gfp_mask,\n\t\t\t   int safe_needed, struct chain_allocator *ca)\n{\n\tstruct rtree_node *node, *block, **dst;\n\tunsigned int levels_needed, block_nr;\n\tint i;\n\n\tblock_nr = zone->blocks;\n\tlevels_needed = 0;\n\n\t/* How many levels do we need for this block nr? */\n\twhile (block_nr) {\n\t\tlevels_needed += 1;\n\t\tblock_nr >>= BM_RTREE_LEVEL_SHIFT;\n\t}\n\n\t/* Make sure the rtree has enough levels */\n\tfor (i = zone->levels; i < levels_needed; i++) {\n\t\tnode = alloc_rtree_node(gfp_mask, safe_needed, ca,\n\t\t\t\t\t&zone->nodes);\n\t\tif (!node)\n\t\t\treturn -ENOMEM;\n\n\t\tnode->data[0] = (unsigned long)zone->rtree;\n\t\tzone->rtree = node;\n\t\tzone->levels += 1;\n\t}\n\n\t/* Allocate new block */\n\tblock = alloc_rtree_node(gfp_mask, safe_needed, ca, &zone->leaves);\n\tif (!block)\n\t\treturn -ENOMEM;\n\n\t/* Now walk the rtree to insert the block */\n\tnode = zone->rtree;\n\tdst = &zone->rtree;\n\tblock_nr = zone->blocks;\n\tfor (i = zone->levels; i > 0; i--) {\n\t\tint index;\n\n\t\tif (!node) {\n\t\t\tnode = alloc_rtree_node(gfp_mask, safe_needed, ca,\n\t\t\t\t\t\t&zone->nodes);\n\t\t\tif (!node)\n\t\t\t\treturn -ENOMEM;\n\t\t\t*dst = node;\n\t\t}\n\n\t\tindex = block_nr >> ((i - 1) * BM_RTREE_LEVEL_SHIFT);\n\t\tindex &= BM_RTREE_LEVEL_MASK;\n\t\tdst = (struct rtree_node **)&((*dst)->data[index]);\n\t\tnode = *dst;\n\t}\n\n\tzone->blocks += 1;\n\t*dst = block;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define BM_RTREE_LEVEL_MASK\t((1UL << BM_RTREE_LEVEL_SHIFT) - 1)",
      "#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 3)",
      "#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 2)"
    ],
    "globals_used": [
      "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "alloc_rtree_node",
          "args": [
            "gfp_mask",
            "safe_needed",
            "ca",
            "&zone->nodes"
          ],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_rtree_node",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "435-452",
          "snippet": "static struct rtree_node *alloc_rtree_node(gfp_t gfp_mask, int safe_needed,\n\t\t\t\t\t   struct chain_allocator *ca,\n\t\t\t\t\t   struct list_head *list)\n{\n\tstruct rtree_node *node;\n\n\tnode = chain_alloc(ca, sizeof(struct rtree_node));\n\tif (!node)\n\t\treturn NULL;\n\n\tnode->data = get_image_page(gfp_mask, safe_needed);\n\tif (!node->data)\n\t\treturn NULL;\n\n\tlist_add_tail(&node->list, list);\n\n\treturn node;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic struct rtree_node *alloc_rtree_node(gfp_t gfp_mask, int safe_needed,\n\t\t\t\t\t   struct chain_allocator *ca,\n\t\t\t\t\t   struct list_head *list)\n{\n\tstruct rtree_node *node;\n\n\tnode = chain_alloc(ca, sizeof(struct rtree_node));\n\tif (!node)\n\t\treturn NULL;\n\n\tnode->data = get_image_page(gfp_mask, safe_needed);\n\tif (!node->data)\n\t\treturn NULL;\n\n\tlist_add_tail(&node->list, list);\n\n\treturn node;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define BM_RTREE_LEVEL_MASK\t((1UL << BM_RTREE_LEVEL_SHIFT) - 1)\n#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 3)\n#define BM_RTREE_LEVEL_SHIFT\t(PAGE_SHIFT - 2)\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic int add_rtree_block(struct mem_zone_bm_rtree *zone, gfp_t gfp_mask,\n\t\t\t   int safe_needed, struct chain_allocator *ca)\n{\n\tstruct rtree_node *node, *block, **dst;\n\tunsigned int levels_needed, block_nr;\n\tint i;\n\n\tblock_nr = zone->blocks;\n\tlevels_needed = 0;\n\n\t/* How many levels do we need for this block nr? */\n\twhile (block_nr) {\n\t\tlevels_needed += 1;\n\t\tblock_nr >>= BM_RTREE_LEVEL_SHIFT;\n\t}\n\n\t/* Make sure the rtree has enough levels */\n\tfor (i = zone->levels; i < levels_needed; i++) {\n\t\tnode = alloc_rtree_node(gfp_mask, safe_needed, ca,\n\t\t\t\t\t&zone->nodes);\n\t\tif (!node)\n\t\t\treturn -ENOMEM;\n\n\t\tnode->data[0] = (unsigned long)zone->rtree;\n\t\tzone->rtree = node;\n\t\tzone->levels += 1;\n\t}\n\n\t/* Allocate new block */\n\tblock = alloc_rtree_node(gfp_mask, safe_needed, ca, &zone->leaves);\n\tif (!block)\n\t\treturn -ENOMEM;\n\n\t/* Now walk the rtree to insert the block */\n\tnode = zone->rtree;\n\tdst = &zone->rtree;\n\tblock_nr = zone->blocks;\n\tfor (i = zone->levels; i > 0; i--) {\n\t\tint index;\n\n\t\tif (!node) {\n\t\t\tnode = alloc_rtree_node(gfp_mask, safe_needed, ca,\n\t\t\t\t\t\t&zone->nodes);\n\t\t\tif (!node)\n\t\t\t\treturn -ENOMEM;\n\t\t\t*dst = node;\n\t\t}\n\n\t\tindex = block_nr >> ((i - 1) * BM_RTREE_LEVEL_SHIFT);\n\t\tindex &= BM_RTREE_LEVEL_MASK;\n\t\tdst = (struct rtree_node **)&((*dst)->data[index]);\n\t\tnode = *dst;\n\t}\n\n\tzone->blocks += 1;\n\t*dst = block;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "alloc_rtree_node",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "435-452",
    "snippet": "static struct rtree_node *alloc_rtree_node(gfp_t gfp_mask, int safe_needed,\n\t\t\t\t\t   struct chain_allocator *ca,\n\t\t\t\t\t   struct list_head *list)\n{\n\tstruct rtree_node *node;\n\n\tnode = chain_alloc(ca, sizeof(struct rtree_node));\n\tif (!node)\n\t\treturn NULL;\n\n\tnode->data = get_image_page(gfp_mask, safe_needed);\n\tif (!node->data)\n\t\treturn NULL;\n\n\tlist_add_tail(&node->list, list);\n\n\treturn node;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&node->list",
            "list"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_image_page",
          "args": [
            "gfp_mask",
            "safe_needed"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "get_image_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "189-206",
          "snippet": "static void *get_image_page(gfp_t gfp_mask, int safe_needed)\n{\n\tvoid *res;\n\n\tres = (void *)get_zeroed_page(gfp_mask);\n\tif (safe_needed)\n\t\twhile (res && swsusp_page_is_free(virt_to_page(res))) {\n\t\t\t/* The page is unsafe, mark it for swsusp_free() */\n\t\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\t\tallocated_unsafe_pages++;\n\t\t\tres = (void *)get_zeroed_page(gfp_mask);\n\t\t}\n\tif (res) {\n\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\tswsusp_set_page_free(virt_to_page(res));\n\t}\n\treturn res;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static unsigned int allocated_unsafe_pages;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic unsigned int allocated_unsafe_pages;\n\nstatic void *get_image_page(gfp_t gfp_mask, int safe_needed)\n{\n\tvoid *res;\n\n\tres = (void *)get_zeroed_page(gfp_mask);\n\tif (safe_needed)\n\t\twhile (res && swsusp_page_is_free(virt_to_page(res))) {\n\t\t\t/* The page is unsafe, mark it for swsusp_free() */\n\t\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\t\tallocated_unsafe_pages++;\n\t\t\tres = (void *)get_zeroed_page(gfp_mask);\n\t\t}\n\tif (res) {\n\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\tswsusp_set_page_free(virt_to_page(res));\n\t}\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "chain_alloc",
          "args": [
            "ca",
            "sizeof(struct rtree_node)"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "chain_alloc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "308-327",
          "snippet": "static void *chain_alloc(struct chain_allocator *ca, unsigned int size)\n{\n\tvoid *ret;\n\n\tif (LINKED_PAGE_DATA_SIZE - ca->used_space < size) {\n\t\tstruct linked_page *lp;\n\n\t\tlp = ca->safe_needed ? __get_safe_page(ca->gfp_mask) :\n\t\t\t\t\tget_image_page(ca->gfp_mask, PG_ANY);\n\t\tif (!lp)\n\t\t\treturn NULL;\n\n\t\tlp->next = ca->chain;\n\t\tca->chain = lp;\n\t\tca->used_space = 0;\n\t}\n\tret = ca->chain->data + ca->used_space;\n\tca->used_space += size;\n\treturn ret;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define PG_ANY\t\t0",
            "#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))"
          ],
          "globals_used": [
            "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_ANY\t\t0\n#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic void *chain_alloc(struct chain_allocator *ca, unsigned int size)\n{\n\tvoid *ret;\n\n\tif (LINKED_PAGE_DATA_SIZE - ca->used_space < size) {\n\t\tstruct linked_page *lp;\n\n\t\tlp = ca->safe_needed ? __get_safe_page(ca->gfp_mask) :\n\t\t\t\t\tget_image_page(ca->gfp_mask, PG_ANY);\n\t\tif (!lp)\n\t\t\treturn NULL;\n\n\t\tlp->next = ca->chain;\n\t\tca->chain = lp;\n\t\tca->used_space = 0;\n\t}\n\tret = ca->chain->data + ca->used_space;\n\tca->used_space += size;\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic struct rtree_node *alloc_rtree_node(gfp_t gfp_mask, int safe_needed,\n\t\t\t\t\t   struct chain_allocator *ca,\n\t\t\t\t\t   struct list_head *list)\n{\n\tstruct rtree_node *node;\n\n\tnode = chain_alloc(ca, sizeof(struct rtree_node));\n\tif (!node)\n\t\treturn NULL;\n\n\tnode->data = get_image_page(gfp_mask, safe_needed);\n\tif (!node->data)\n\t\treturn NULL;\n\n\tlist_add_tail(&node->list, list);\n\n\treturn node;\n}"
  },
  {
    "function_name": "chain_alloc",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "308-327",
    "snippet": "static void *chain_alloc(struct chain_allocator *ca, unsigned int size)\n{\n\tvoid *ret;\n\n\tif (LINKED_PAGE_DATA_SIZE - ca->used_space < size) {\n\t\tstruct linked_page *lp;\n\n\t\tlp = ca->safe_needed ? __get_safe_page(ca->gfp_mask) :\n\t\t\t\t\tget_image_page(ca->gfp_mask, PG_ANY);\n\t\tif (!lp)\n\t\t\treturn NULL;\n\n\t\tlp->next = ca->chain;\n\t\tca->chain = lp;\n\t\tca->used_space = 0;\n\t}\n\tret = ca->chain->data + ca->used_space;\n\tca->used_space += size;\n\treturn ret;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define PG_ANY\t\t0",
      "#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))"
    ],
    "globals_used": [
      "struct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_image_page",
          "args": [
            "ca->gfp_mask",
            "PG_ANY"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "get_image_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "189-206",
          "snippet": "static void *get_image_page(gfp_t gfp_mask, int safe_needed)\n{\n\tvoid *res;\n\n\tres = (void *)get_zeroed_page(gfp_mask);\n\tif (safe_needed)\n\t\twhile (res && swsusp_page_is_free(virt_to_page(res))) {\n\t\t\t/* The page is unsafe, mark it for swsusp_free() */\n\t\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\t\tallocated_unsafe_pages++;\n\t\t\tres = (void *)get_zeroed_page(gfp_mask);\n\t\t}\n\tif (res) {\n\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\tswsusp_set_page_free(virt_to_page(res));\n\t}\n\treturn res;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static unsigned int allocated_unsafe_pages;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic unsigned int allocated_unsafe_pages;\n\nstatic void *get_image_page(gfp_t gfp_mask, int safe_needed)\n{\n\tvoid *res;\n\n\tres = (void *)get_zeroed_page(gfp_mask);\n\tif (safe_needed)\n\t\twhile (res && swsusp_page_is_free(virt_to_page(res))) {\n\t\t\t/* The page is unsafe, mark it for swsusp_free() */\n\t\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\t\tallocated_unsafe_pages++;\n\t\t\tres = (void *)get_zeroed_page(gfp_mask);\n\t\t}\n\tif (res) {\n\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\tswsusp_set_page_free(virt_to_page(res));\n\t}\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__get_safe_page",
          "args": [
            "ca->gfp_mask"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "__get_safe_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "208-218",
          "snippet": "static void *__get_safe_page(gfp_t gfp_mask)\n{\n\tif (safe_pages_list) {\n\t\tvoid *ret = safe_pages_list;\n\n\t\tsafe_pages_list = safe_pages_list->next;\n\t\tmemset(ret, 0, PAGE_SIZE);\n\t\treturn ret;\n\t}\n\treturn get_image_page(gfp_mask, PG_SAFE);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define PG_SAFE\t\t1"
          ],
          "globals_used": [
            "static struct linked_page *safe_pages_list;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_SAFE\t\t1\n\nstatic struct linked_page *safe_pages_list;\n\nstatic void *__get_safe_page(gfp_t gfp_mask)\n{\n\tif (safe_pages_list) {\n\t\tvoid *ret = safe_pages_list;\n\n\t\tsafe_pages_list = safe_pages_list->next;\n\t\tmemset(ret, 0, PAGE_SIZE);\n\t\treturn ret;\n\t}\n\treturn get_image_page(gfp_mask, PG_SAFE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_ANY\t\t0\n#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))\n\nstruct linked_page {\n\tstruct linked_page *next;\n\tchar data[LINKED_PAGE_DATA_SIZE];\n} __packed;\n\nstatic void *chain_alloc(struct chain_allocator *ca, unsigned int size)\n{\n\tvoid *ret;\n\n\tif (LINKED_PAGE_DATA_SIZE - ca->used_space < size) {\n\t\tstruct linked_page *lp;\n\n\t\tlp = ca->safe_needed ? __get_safe_page(ca->gfp_mask) :\n\t\t\t\t\tget_image_page(ca->gfp_mask, PG_ANY);\n\t\tif (!lp)\n\t\t\treturn NULL;\n\n\t\tlp->next = ca->chain;\n\t\tca->chain = lp;\n\t\tca->used_space = 0;\n\t}\n\tret = ca->chain->data + ca->used_space;\n\tca->used_space += size;\n\treturn ret;\n}"
  },
  {
    "function_name": "chain_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "299-306",
    "snippet": "static void chain_init(struct chain_allocator *ca, gfp_t gfp_mask,\n\t\t       int safe_needed)\n{\n\tca->chain = NULL;\n\tca->used_space = LINKED_PAGE_DATA_SIZE;\n\tca->gfp_mask = gfp_mask;\n\tca->safe_needed = safe_needed;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define LINKED_PAGE_DATA_SIZE\t(PAGE_SIZE - sizeof(void *))\n\nstatic void chain_init(struct chain_allocator *ca, gfp_t gfp_mask,\n\t\t       int safe_needed)\n{\n\tca->chain = NULL;\n\tca->used_space = LINKED_PAGE_DATA_SIZE;\n\tca->gfp_mask = gfp_mask;\n\tca->safe_needed = safe_needed;\n}"
  },
  {
    "function_name": "free_list_of_pages",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "268-277",
    "snippet": "static inline void free_list_of_pages(struct linked_page *list,\n\t\t\t\t      int clear_page_nosave)\n{\n\twhile (list) {\n\t\tstruct linked_page *lp = list->next;\n\n\t\tfree_image_page(list, clear_page_nosave);\n\t\tlist = lp;\n\t}\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_image_page",
          "args": [
            "list",
            "clear_page_nosave"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "free_image_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "253-266",
          "snippet": "static inline void free_image_page(void *addr, int clear_nosave_free)\n{\n\tstruct page *page;\n\n\tBUG_ON(!virt_addr_valid(addr));\n\n\tpage = virt_to_page(addr);\n\n\tswsusp_unset_page_forbidden(page);\n\tif (clear_nosave_free)\n\t\tswsusp_unset_page_free(page);\n\n\t__free_page(page);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);",
            "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);\n\nstatic inline void free_image_page(void *addr, int clear_nosave_free)\n{\n\tstruct page *page;\n\n\tBUG_ON(!virt_addr_valid(addr));\n\n\tpage = virt_to_page(addr);\n\n\tswsusp_unset_page_forbidden(page);\n\tif (clear_nosave_free)\n\t\tswsusp_unset_page_free(page);\n\n\t__free_page(page);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void free_list_of_pages(struct linked_page *list,\n\t\t\t\t      int clear_page_nosave)\n{\n\twhile (list) {\n\t\tstruct linked_page *lp = list->next;\n\n\t\tfree_image_page(list, clear_page_nosave);\n\t\tlist = lp;\n\t}\n}"
  },
  {
    "function_name": "free_image_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "253-266",
    "snippet": "static inline void free_image_page(void *addr, int clear_nosave_free)\n{\n\tstruct page *page;\n\n\tBUG_ON(!virt_addr_valid(addr));\n\n\tpage = virt_to_page(addr);\n\n\tswsusp_unset_page_forbidden(page);\n\tif (clear_nosave_free)\n\t\tswsusp_unset_page_free(page);\n\n\t__free_page(page);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);",
      "static void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);",
      "static void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__free_page",
          "args": [
            "page"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swsusp_unset_page_free",
          "args": [
            "page"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_unset_page_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1045-1049",
          "snippet": "void swsusp_unset_page_free(struct page *page)\n{\n\tif (free_pages_map)\n\t\tmemory_bm_clear_bit(free_pages_map, page_to_pfn(page));\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *free_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *free_pages_map;\n\nvoid swsusp_unset_page_free(struct page *page)\n{\n\tif (free_pages_map)\n\t\tmemory_bm_clear_bit(free_pages_map, page_to_pfn(page));\n}"
        }
      },
      {
        "call_info": {
          "callee": "swsusp_unset_page_forbidden",
          "args": [
            "page"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_unset_page_forbidden",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1063-1067",
          "snippet": "static void swsusp_unset_page_forbidden(struct page *page)\n{\n\tif (forbidden_pages_map)\n\t\tmemory_bm_clear_bit(forbidden_pages_map, page_to_pfn(page));\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *forbidden_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *forbidden_pages_map;\n\nstatic void swsusp_unset_page_forbidden(struct page *page)\n{\n\tif (forbidden_pages_map)\n\t\tmemory_bm_clear_bit(forbidden_pages_map, page_to_pfn(page));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virt_to_page",
          "args": [
            "addr"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!virt_addr_valid(addr)"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virt_addr_valid",
          "args": [
            "addr"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic void free_zone_bm_rtree(struct mem_zone_bm_rtree *zone,\n\t\t\t       int clear_nosave_free);\nstatic void memory_bm_free(struct memory_bitmap *bm, int clear_nosave_free);\n\nstatic inline void free_image_page(void *addr, int clear_nosave_free)\n{\n\tstruct page *page;\n\n\tBUG_ON(!virt_addr_valid(addr));\n\n\tpage = virt_to_page(addr);\n\n\tswsusp_unset_page_forbidden(page);\n\tif (clear_nosave_free)\n\t\tswsusp_unset_page_free(page);\n\n\t__free_page(page);\n}"
  },
  {
    "function_name": "recycle_safe_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "237-243",
    "snippet": "static void recycle_safe_page(void *page_address)\n{\n\tstruct linked_page *lp = page_address;\n\n\tlp->next = safe_pages_list;\n\tsafe_pages_list = lp;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct linked_page *safe_pages_list;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic struct linked_page *safe_pages_list;\n\nstatic void recycle_safe_page(void *page_address)\n{\n\tstruct linked_page *lp = page_address;\n\n\tlp->next = safe_pages_list;\n\tsafe_pages_list = lp;\n}"
  },
  {
    "function_name": "alloc_image_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "225-235",
    "snippet": "static struct page *alloc_image_page(gfp_t gfp_mask)\n{\n\tstruct page *page;\n\n\tpage = alloc_page(gfp_mask);\n\tif (page) {\n\t\tswsusp_set_page_forbidden(page);\n\t\tswsusp_set_page_free(page);\n\t}\n\treturn page;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "swsusp_set_page_free",
          "args": [
            "page"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_set_page_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1033-1037",
          "snippet": "void swsusp_set_page_free(struct page *page)\n{\n\tif (free_pages_map)\n\t\tmemory_bm_set_bit(free_pages_map, page_to_pfn(page));\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *free_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *free_pages_map;\n\nvoid swsusp_set_page_free(struct page *page)\n{\n\tif (free_pages_map)\n\t\tmemory_bm_set_bit(free_pages_map, page_to_pfn(page));\n}"
        }
      },
      {
        "call_info": {
          "callee": "swsusp_set_page_forbidden",
          "args": [
            "page"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_set_page_forbidden",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1051-1055",
          "snippet": "static void swsusp_set_page_forbidden(struct page *page)\n{\n\tif (forbidden_pages_map)\n\t\tmemory_bm_set_bit(forbidden_pages_map, page_to_pfn(page));\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *forbidden_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *forbidden_pages_map;\n\nstatic void swsusp_set_page_forbidden(struct page *page)\n{\n\tif (forbidden_pages_map)\n\t\tmemory_bm_set_bit(forbidden_pages_map, page_to_pfn(page));\n}"
        }
      },
      {
        "call_info": {
          "callee": "alloc_page",
          "args": [
            "gfp_mask"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "relay_alloc_page_array",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/relay.c",
          "lines": "61-67",
          "snippet": "static struct page **relay_alloc_page_array(unsigned int n_pages)\n{\n\tconst size_t pa_size = n_pages * sizeof(struct page *);\n\tif (pa_size > PAGE_SIZE)\n\t\treturn vzalloc(pa_size);\n\treturn kzalloc(pa_size, GFP_KERNEL);\n}",
          "includes": [
            "#include <linux/splice.h>",
            "#include <linux/cpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/relay.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/stddef.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/splice.h>\n#include <linux/cpu.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n#include <linux/relay.h>\n#include <linux/string.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/stddef.h>\n#include <linux/errno.h>\n\nstatic struct page **relay_alloc_page_array(unsigned int n_pages)\n{\n\tconst size_t pa_size = n_pages * sizeof(struct page *);\n\tif (pa_size > PAGE_SIZE)\n\t\treturn vzalloc(pa_size);\n\treturn kzalloc(pa_size, GFP_KERNEL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic struct page *alloc_image_page(gfp_t gfp_mask)\n{\n\tstruct page *page;\n\n\tpage = alloc_page(gfp_mask);\n\tif (page) {\n\t\tswsusp_set_page_forbidden(page);\n\t\tswsusp_set_page_free(page);\n\t}\n\treturn page;\n}"
  },
  {
    "function_name": "get_safe_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "220-223",
    "snippet": "unsigned long get_safe_page(gfp_t gfp_mask)\n{\n\treturn (unsigned long)__get_safe_page(gfp_mask);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__get_safe_page",
          "args": [
            "gfp_mask"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "__get_safe_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "208-218",
          "snippet": "static void *__get_safe_page(gfp_t gfp_mask)\n{\n\tif (safe_pages_list) {\n\t\tvoid *ret = safe_pages_list;\n\n\t\tsafe_pages_list = safe_pages_list->next;\n\t\tmemset(ret, 0, PAGE_SIZE);\n\t\treturn ret;\n\t}\n\treturn get_image_page(gfp_mask, PG_SAFE);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [
            "#define PG_SAFE\t\t1"
          ],
          "globals_used": [
            "static struct linked_page *safe_pages_list;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_SAFE\t\t1\n\nstatic struct linked_page *safe_pages_list;\n\nstatic void *__get_safe_page(gfp_t gfp_mask)\n{\n\tif (safe_pages_list) {\n\t\tvoid *ret = safe_pages_list;\n\n\t\tsafe_pages_list = safe_pages_list->next;\n\t\tmemset(ret, 0, PAGE_SIZE);\n\t\treturn ret;\n\t}\n\treturn get_image_page(gfp_mask, PG_SAFE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nunsigned long get_safe_page(gfp_t gfp_mask)\n{\n\treturn (unsigned long)__get_safe_page(gfp_mask);\n}"
  },
  {
    "function_name": "__get_safe_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "208-218",
    "snippet": "static void *__get_safe_page(gfp_t gfp_mask)\n{\n\tif (safe_pages_list) {\n\t\tvoid *ret = safe_pages_list;\n\n\t\tsafe_pages_list = safe_pages_list->next;\n\t\tmemset(ret, 0, PAGE_SIZE);\n\t\treturn ret;\n\t}\n\treturn get_image_page(gfp_mask, PG_SAFE);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [
      "#define PG_SAFE\t\t1"
    ],
    "globals_used": [
      "static struct linked_page *safe_pages_list;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_image_page",
          "args": [
            "gfp_mask",
            "PG_SAFE"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "get_image_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "189-206",
          "snippet": "static void *get_image_page(gfp_t gfp_mask, int safe_needed)\n{\n\tvoid *res;\n\n\tres = (void *)get_zeroed_page(gfp_mask);\n\tif (safe_needed)\n\t\twhile (res && swsusp_page_is_free(virt_to_page(res))) {\n\t\t\t/* The page is unsafe, mark it for swsusp_free() */\n\t\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\t\tallocated_unsafe_pages++;\n\t\t\tres = (void *)get_zeroed_page(gfp_mask);\n\t\t}\n\tif (res) {\n\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\tswsusp_set_page_free(virt_to_page(res));\n\t}\n\treturn res;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static unsigned int allocated_unsafe_pages;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic unsigned int allocated_unsafe_pages;\n\nstatic void *get_image_page(gfp_t gfp_mask, int safe_needed)\n{\n\tvoid *res;\n\n\tres = (void *)get_zeroed_page(gfp_mask);\n\tif (safe_needed)\n\t\twhile (res && swsusp_page_is_free(virt_to_page(res))) {\n\t\t\t/* The page is unsafe, mark it for swsusp_free() */\n\t\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\t\tallocated_unsafe_pages++;\n\t\t\tres = (void *)get_zeroed_page(gfp_mask);\n\t\t}\n\tif (res) {\n\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\tswsusp_set_page_free(virt_to_page(res));\n\t}\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "ret",
            "0",
            "PAGE_SIZE"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\n#define PG_SAFE\t\t1\n\nstatic struct linked_page *safe_pages_list;\n\nstatic void *__get_safe_page(gfp_t gfp_mask)\n{\n\tif (safe_pages_list) {\n\t\tvoid *ret = safe_pages_list;\n\n\t\tsafe_pages_list = safe_pages_list->next;\n\t\tmemset(ret, 0, PAGE_SIZE);\n\t\treturn ret;\n\t}\n\treturn get_image_page(gfp_mask, PG_SAFE);\n}"
  },
  {
    "function_name": "get_image_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "189-206",
    "snippet": "static void *get_image_page(gfp_t gfp_mask, int safe_needed)\n{\n\tvoid *res;\n\n\tres = (void *)get_zeroed_page(gfp_mask);\n\tif (safe_needed)\n\t\twhile (res && swsusp_page_is_free(virt_to_page(res))) {\n\t\t\t/* The page is unsafe, mark it for swsusp_free() */\n\t\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\t\tallocated_unsafe_pages++;\n\t\t\tres = (void *)get_zeroed_page(gfp_mask);\n\t\t}\n\tif (res) {\n\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\tswsusp_set_page_free(virt_to_page(res));\n\t}\n\treturn res;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);",
      "static unsigned int allocated_unsafe_pages;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "swsusp_set_page_free",
          "args": [
            "virt_to_page(res)"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_set_page_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1033-1037",
          "snippet": "void swsusp_set_page_free(struct page *page)\n{\n\tif (free_pages_map)\n\t\tmemory_bm_set_bit(free_pages_map, page_to_pfn(page));\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *free_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *free_pages_map;\n\nvoid swsusp_set_page_free(struct page *page)\n{\n\tif (free_pages_map)\n\t\tmemory_bm_set_bit(free_pages_map, page_to_pfn(page));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virt_to_page",
          "args": [
            "res"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swsusp_set_page_forbidden",
          "args": [
            "virt_to_page(res)"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_set_page_forbidden",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1051-1055",
          "snippet": "static void swsusp_set_page_forbidden(struct page *page)\n{\n\tif (forbidden_pages_map)\n\t\tmemory_bm_set_bit(forbidden_pages_map, page_to_pfn(page));\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *forbidden_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *forbidden_pages_map;\n\nstatic void swsusp_set_page_forbidden(struct page *page)\n{\n\tif (forbidden_pages_map)\n\t\tmemory_bm_set_bit(forbidden_pages_map, page_to_pfn(page));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virt_to_page",
          "args": [
            "res"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_zeroed_page",
          "args": [
            "gfp_mask"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virt_to_page",
          "args": [
            "res"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swsusp_page_is_free",
          "args": [
            "virt_to_page(res)"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "swsusp_page_is_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "1039-1043",
          "snippet": "static int swsusp_page_is_free(struct page *page)\n{\n\treturn free_pages_map ?\n\t\tmemory_bm_test_bit(free_pages_map, page_to_pfn(page)) : 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int swsusp_page_is_free(struct page *);",
            "static void swsusp_set_page_forbidden(struct page *);",
            "static void swsusp_unset_page_forbidden(struct page *);",
            "static struct memory_bitmap *free_pages_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic struct memory_bitmap *free_pages_map;\n\nstatic int swsusp_page_is_free(struct page *page)\n{\n\treturn free_pages_map ?\n\t\tmemory_bm_test_bit(free_pages_map, page_to_pfn(page)) : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virt_to_page",
          "args": [
            "res"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_zeroed_page",
          "args": [
            "gfp_mask"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\nstatic unsigned int allocated_unsafe_pages;\n\nstatic void *get_image_page(gfp_t gfp_mask, int safe_needed)\n{\n\tvoid *res;\n\n\tres = (void *)get_zeroed_page(gfp_mask);\n\tif (safe_needed)\n\t\twhile (res && swsusp_page_is_free(virt_to_page(res))) {\n\t\t\t/* The page is unsafe, mark it for swsusp_free() */\n\t\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\t\tallocated_unsafe_pages++;\n\t\t\tres = (void *)get_zeroed_page(gfp_mask);\n\t\t}\n\tif (res) {\n\t\tswsusp_set_page_forbidden(virt_to_page(res));\n\t\tswsusp_set_page_free(virt_to_page(res));\n\t}\n\treturn res;\n}"
  },
  {
    "function_name": "hibernate_image_size_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "137-140",
    "snippet": "void __init hibernate_image_size_init(void)\n{\n\timage_size = ((totalram_pages() * 2) / 5) * PAGE_SIZE;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned long image_size;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "totalram_pages",
          "args": [],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nunsigned long image_size;\n\nvoid __init hibernate_image_size_init(void)\n{\n\timage_size = ((totalram_pages() * 2) / 5) * PAGE_SIZE;\n}"
  },
  {
    "function_name": "hibernate_reserved_size_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "124-127",
    "snippet": "void __init hibernate_reserved_size_init(void)\n{\n\treserved_size = SPARE_PAGES * PAGE_SIZE;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned long reserved_size;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nunsigned long reserved_size;\n\nvoid __init hibernate_reserved_size_init(void)\n{\n\treserved_size = SPARE_PAGES * PAGE_SIZE;\n}"
  },
  {
    "function_name": "hibernate_unmap_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "98-111",
    "snippet": "static inline void hibernate_unmap_page(struct page *page)\n{\n\tif (IS_ENABLED(CONFIG_ARCH_HAS_SET_DIRECT_MAP)) {\n\t\tunsigned long addr = (unsigned long)page_address(page);\n\t\tint ret  = set_direct_map_invalid_noflush(page);\n\n\t\tif (ret)\n\t\t\tpr_warn_once(\"Failed to remap page\\n\");\n\n\t\tflush_tlb_kernel_range(addr, addr + PAGE_SIZE);\n\t} else {\n\t\tdebug_pagealloc_unmap_pages(page, 1);\n\t}\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug_pagealloc_unmap_pages",
          "args": [
            "page",
            "1"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flush_tlb_kernel_range",
          "args": [
            "addr",
            "addr + PAGE_SIZE"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn_once",
          "args": [
            "\"Failed to remap page\\n\""
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_direct_map_invalid_noflush",
          "args": [
            "page"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_ARCH_HAS_SET_DIRECT_MAP"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic inline void hibernate_unmap_page(struct page *page)\n{\n\tif (IS_ENABLED(CONFIG_ARCH_HAS_SET_DIRECT_MAP)) {\n\t\tunsigned long addr = (unsigned long)page_address(page);\n\t\tint ret  = set_direct_map_invalid_noflush(page);\n\n\t\tif (ret)\n\t\t\tpr_warn_once(\"Failed to remap page\\n\");\n\n\t\tflush_tlb_kernel_range(addr, addr + PAGE_SIZE);\n\t} else {\n\t\tdebug_pagealloc_unmap_pages(page, 1);\n\t}\n}"
  },
  {
    "function_name": "hibernate_map_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "86-96",
    "snippet": "static inline void hibernate_map_page(struct page *page)\n{\n\tif (IS_ENABLED(CONFIG_ARCH_HAS_SET_DIRECT_MAP)) {\n\t\tint ret = set_direct_map_default_noflush(page);\n\n\t\tif (ret)\n\t\t\tpr_warn_once(\"Failed to remap page\\n\");\n\t} else {\n\t\tdebug_pagealloc_map_pages(page, 1);\n\t}\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int swsusp_page_is_free(struct page *);",
      "static void swsusp_set_page_forbidden(struct page *);",
      "static void swsusp_unset_page_forbidden(struct page *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug_pagealloc_map_pages",
          "args": [
            "page",
            "1"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn_once",
          "args": [
            "\"Failed to remap page\\n\""
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_direct_map_default_noflush",
          "args": [
            "page"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_ARCH_HAS_SET_DIRECT_MAP"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int swsusp_page_is_free(struct page *);\nstatic void swsusp_set_page_forbidden(struct page *);\nstatic void swsusp_unset_page_forbidden(struct page *);\n\nstatic inline void hibernate_map_page(struct page *page)\n{\n\tif (IS_ENABLED(CONFIG_ARCH_HAS_SET_DIRECT_MAP)) {\n\t\tint ret = set_direct_map_default_noflush(page);\n\n\t\tif (ret)\n\t\t\tpr_warn_once(\"Failed to remap page\\n\");\n\t} else {\n\t\tdebug_pagealloc_map_pages(page, 1);\n\t}\n}"
  },
  {
    "function_name": "hibernate_restore_unprotect_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "76-76",
    "snippet": "static inline void hibernate_restore_unprotect_page(void *page_address) {}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void hibernate_restore_unprotect_page(void *page_address) {}"
  },
  {
    "function_name": "hibernate_restore_protect_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "75-75",
    "snippet": "static inline void hibernate_restore_protect_page(void *page_address) {}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void hibernate_restore_protect_page(void *page_address) {}"
  },
  {
    "function_name": "hibernate_restore_protection_end",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "74-74",
    "snippet": "static inline void hibernate_restore_protection_end(void) {}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void hibernate_restore_protection_end(void) {}"
  },
  {
    "function_name": "hibernate_restore_protection_begin",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "73-73",
    "snippet": "static inline void hibernate_restore_protection_begin(void) {}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void hibernate_restore_protection_begin(void) {}"
  },
  {
    "function_name": "hibernate_restore_unprotect_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "67-71",
    "snippet": "static inline void hibernate_restore_unprotect_page(void *page_address)\n{\n\tif (hibernate_restore_protection_active)\n\t\tset_memory_rw((unsigned long)page_address, 1);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_memory_rw",
          "args": [
            "(unsigned long)page_address",
            "1"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void hibernate_restore_unprotect_page(void *page_address)\n{\n\tif (hibernate_restore_protection_active)\n\t\tset_memory_rw((unsigned long)page_address, 1);\n}"
  },
  {
    "function_name": "hibernate_restore_protect_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "61-65",
    "snippet": "static inline void hibernate_restore_protect_page(void *page_address)\n{\n\tif (hibernate_restore_protection_active)\n\t\tset_memory_ro((unsigned long)page_address, 1);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_memory_ro",
          "args": [
            "(unsigned long)page_address",
            "1"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void hibernate_restore_protect_page(void *page_address)\n{\n\tif (hibernate_restore_protection_active)\n\t\tset_memory_ro((unsigned long)page_address, 1);\n}"
  },
  {
    "function_name": "hibernate_restore_protection_end",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "56-59",
    "snippet": "static inline void hibernate_restore_protection_end(void)\n{\n\thibernate_restore_protection_active = false;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void hibernate_restore_protection_end(void)\n{\n\thibernate_restore_protection_active = false;\n}"
  },
  {
    "function_name": "hibernate_restore_protection_begin",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "51-54",
    "snippet": "static inline void hibernate_restore_protection_begin(void)\n{\n\thibernate_restore_protection_active = hibernate_restore_protection;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic inline void hibernate_restore_protection_begin(void)\n{\n\thibernate_restore_protection_active = hibernate_restore_protection;\n}"
  },
  {
    "function_name": "enable_restore_image_protection",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
    "lines": "46-49",
    "snippet": "void enable_restore_image_protection(void)\n{\n\thibernate_restore_protection = true;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <asm/io.h>",
      "#include <asm/tlbflush.h>",
      "#include <asm/mmu_context.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/set_memory.h>",
      "#include <linux/ktime.h>",
      "#include <linux/compiler.h>",
      "#include <linux/slab.h>",
      "#include <linux/list.h>",
      "#include <linux/highmem.h>",
      "#include <linux/console.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/nmi.h>",
      "#include <linux/memblock.h>",
      "#include <linux/init.h>",
      "#include <linux/device.h>",
      "#include <linux/pm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/bitops.h>",
      "#include <linux/delay.h>",
      "#include <linux/suspend.h>",
      "#include <linux/mm.h>",
      "#include <linux/module.h>",
      "#include <linux/version.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nvoid enable_restore_image_protection(void)\n{\n\thibernate_restore_protection = true;\n}"
  }
]