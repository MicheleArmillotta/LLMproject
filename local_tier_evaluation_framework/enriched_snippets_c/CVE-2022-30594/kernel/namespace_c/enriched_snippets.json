[
  {
    "function_name": "proc_timens_set_offset",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "362-440",
    "snippet": "int proc_timens_set_offset(struct file *file, struct task_struct *p,\n\t\t\t   struct proc_timens_offset *offsets, int noffsets)\n{\n\tstruct ns_common *ns;\n\tstruct time_namespace *time_ns;\n\tstruct timespec64 tp;\n\tint i, err;\n\n\tns = timens_for_children_get(p);\n\tif (!ns)\n\t\treturn -ESRCH;\n\ttime_ns = to_time_ns(ns);\n\n\tif (!file_ns_capable(file, time_ns->user_ns, CAP_SYS_TIME)) {\n\t\tput_time_ns(time_ns);\n\t\treturn -EPERM;\n\t}\n\n\tfor (i = 0; i < noffsets; i++) {\n\t\tstruct proc_timens_offset *off = &offsets[i];\n\n\t\tswitch (off->clockid) {\n\t\tcase CLOCK_MONOTONIC:\n\t\t\tktime_get_ts64(&tp);\n\t\t\tbreak;\n\t\tcase CLOCK_BOOTTIME:\n\t\t\tktime_get_boottime_ts64(&tp);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\terr = -EINVAL;\n\t\t\tgoto out;\n\t\t}\n\n\t\terr = -ERANGE;\n\n\t\tif (off->val.tv_sec > KTIME_SEC_MAX ||\n\t\t    off->val.tv_sec < -KTIME_SEC_MAX)\n\t\t\tgoto out;\n\n\t\ttp = timespec64_add(tp, off->val);\n\t\t/*\n\t\t * KTIME_SEC_MAX is divided by 2 to be sure that KTIME_MAX is\n\t\t * still unreachable.\n\t\t */\n\t\tif (tp.tv_sec < 0 || tp.tv_sec > KTIME_SEC_MAX / 2)\n\t\t\tgoto out;\n\t}\n\n\tmutex_lock(&offset_lock);\n\tif (time_ns->frozen_offsets) {\n\t\terr = -EACCES;\n\t\tgoto out_unlock;\n\t}\n\n\terr = 0;\n\t/* Don't report errors after this line */\n\tfor (i = 0; i < noffsets; i++) {\n\t\tstruct proc_timens_offset *off = &offsets[i];\n\t\tstruct timespec64 *offset = NULL;\n\n\t\tswitch (off->clockid) {\n\t\tcase CLOCK_MONOTONIC:\n\t\t\toffset = &time_ns->offsets.monotonic;\n\t\t\tbreak;\n\t\tcase CLOCK_BOOTTIME:\n\t\t\toffset = &time_ns->offsets.boottime;\n\t\t\tbreak;\n\t\t}\n\n\t\t*offset = off->val;\n\t}\n\nout_unlock:\n\tmutex_unlock(&offset_lock);\nout:\n\tput_time_ns(time_ns);\n\n\treturn err;\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(offset_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_time_ns",
          "args": [
            "time_ns"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&offset_lock"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "__rt_mutex_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex.c",
          "lines": "1350-1356",
          "snippet": "static __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}",
          "includes": [
            "# include \"ww_mutex.h\"",
            "#include \"rtmutex_common.h\"",
            "#include <linux/ww_mutex.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"ww_mutex.h\"\n#include \"rtmutex_common.h\"\n#include <linux/ww_mutex.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n\nstatic __always_inline struct;\n\nstatic __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&offset_lock"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_lock_io",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex_api.c",
          "lines": "580-586",
          "snippet": "void __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}",
          "includes": [
            "#include \"rtmutex.c\"",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex.c\"\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}"
        }
      },
      {
        "call_info": {
          "callee": "timespec64_add",
          "args": [
            "tp",
            "off->val"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "timespec64_add_safe",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/time.c",
          "lines": "765-779",
          "snippet": "struct timespec64 timespec64_add_safe(const struct timespec64 lhs,\n\t\t\t\tconst struct timespec64 rhs)\n{\n\tstruct timespec64 res;\n\n\tset_normalized_timespec64(&res, (timeu64_t) lhs.tv_sec + rhs.tv_sec,\n\t\t\tlhs.tv_nsec + rhs.tv_nsec);\n\n\tif (unlikely(res.tv_sec < lhs.tv_sec || res.tv_sec < rhs.tv_sec)) {\n\t\tres.tv_sec = TIME64_MAX;\n\t\tres.tv_nsec = 0;\n\t}\n\n\treturn res;\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nstruct timespec64 timespec64_add_safe(const struct timespec64 lhs,\n\t\t\t\tconst struct timespec64 rhs)\n{\n\tstruct timespec64 res;\n\n\tset_normalized_timespec64(&res, (timeu64_t) lhs.tv_sec + rhs.tv_sec,\n\t\t\tlhs.tv_nsec + rhs.tv_nsec);\n\n\tif (unlikely(res.tv_sec < lhs.tv_sec || res.tv_sec < rhs.tv_sec)) {\n\t\tres.tv_sec = TIME64_MAX;\n\t\tres.tv_nsec = 0;\n\t}\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ktime_get_boottime_ts64",
          "args": [
            "&tp"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_get_ts64",
          "args": [
            "&tp"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "ktime_get_ts64",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/timekeeping.c",
          "lines": "950-970",
          "snippet": "void ktime_get_ts64(struct timespec64 *ts)\n{\n\tstruct timekeeper *tk = &tk_core.timekeeper;\n\tstruct timespec64 tomono;\n\tunsigned int seq;\n\tu64 nsec;\n\n\tWARN_ON(timekeeping_suspended);\n\n\tdo {\n\t\tseq = read_seqcount_begin(&tk_core.seq);\n\t\tts->tv_sec = tk->xtime_sec;\n\t\tnsec = timekeeping_get_ns(&tk->tkr_mono);\n\t\ttomono = tk->wall_to_monotonic;\n\n\t} while (read_seqcount_retry(&tk_core.seq, seq));\n\n\tts->tv_sec += tomono.tv_sec;\n\tts->tv_nsec = 0;\n\ttimespec64_add_ns(ts, nsec + tomono.tv_nsec);\n}",
          "includes": [
            "#include \"timekeeping_internal.h\"",
            "#include \"ntp_internal.h\"",
            "#include \"tick-internal.h\"",
            "#include <linux/audit.h>",
            "#include <linux/compiler.h>",
            "#include <linux/pvclock_gtod.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/tick.h>",
            "#include <linux/time.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched.h>",
            "#include <linux/nmi.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/timekeeper_internal.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping_internal.h\"\n#include \"ntp_internal.h\"\n#include \"tick-internal.h\"\n#include <linux/audit.h>\n#include <linux/compiler.h>\n#include <linux/pvclock_gtod.h>\n#include <linux/stop_machine.h>\n#include <linux/tick.h>\n#include <linux/time.h>\n#include <linux/jiffies.h>\n#include <linux/clocksource.h>\n#include <linux/syscore_ops.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched.h>\n#include <linux/nmi.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/timekeeper_internal.h>\n\nvoid ktime_get_ts64(struct timespec64 *ts)\n{\n\tstruct timekeeper *tk = &tk_core.timekeeper;\n\tstruct timespec64 tomono;\n\tunsigned int seq;\n\tu64 nsec;\n\n\tWARN_ON(timekeeping_suspended);\n\n\tdo {\n\t\tseq = read_seqcount_begin(&tk_core.seq);\n\t\tts->tv_sec = tk->xtime_sec;\n\t\tnsec = timekeeping_get_ns(&tk->tkr_mono);\n\t\ttomono = tk->wall_to_monotonic;\n\n\t} while (read_seqcount_retry(&tk_core.seq, seq));\n\n\tts->tv_sec += tomono.tv_sec;\n\tts->tv_nsec = 0;\n\ttimespec64_add_ns(ts, nsec + tomono.tv_nsec);\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_time_ns",
          "args": [
            "time_ns"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file_ns_capable",
          "args": [
            "file",
            "time_ns->user_ns",
            "CAP_SYS_TIME"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "file_ns_capable",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/capability.c",
          "lines": "466-477",
          "snippet": "bool file_ns_capable(const struct file *file, struct user_namespace *ns,\n\t\t     int cap)\n{\n\n\tif (WARN_ON_ONCE(!cap_valid(cap)))\n\t\treturn false;\n\n\tif (security_capable(file->f_cred, ns, cap, CAP_OPT_NONE) == 0)\n\t\treturn true;\n\n\treturn false;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/user_namespace.h>\n#include <linux/pid_namespace.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n\nbool file_ns_capable(const struct file *file, struct user_namespace *ns,\n\t\t     int cap)\n{\n\n\tif (WARN_ON_ONCE(!cap_valid(cap)))\n\t\treturn false;\n\n\tif (security_capable(file->f_cred, ns, cap, CAP_OPT_NONE) == 0)\n\t\treturn true;\n\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_time_ns",
          "args": [
            "ns"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "to_time_ns",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
          "lines": "238-241",
          "snippet": "static struct time_namespace *to_time_ns(struct ns_common *ns)\n{\n\treturn container_of(ns, struct time_namespace, ns);\n}",
          "includes": [
            "#include <vdso/datapage.h>",
            "#include <linux/mm.h>",
            "#include <linux/err.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/time_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic struct time_namespace *to_time_ns(struct ns_common *ns)\n{\n\treturn container_of(ns, struct time_namespace, ns);\n}"
        }
      },
      {
        "call_info": {
          "callee": "timens_for_children_get",
          "args": [
            "p"
          ],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "timens_for_children_get",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
          "lines": "259-273",
          "snippet": "static struct ns_common *timens_for_children_get(struct task_struct *task)\n{\n\tstruct time_namespace *ns = NULL;\n\tstruct nsproxy *nsproxy;\n\n\ttask_lock(task);\n\tnsproxy = task->nsproxy;\n\tif (nsproxy) {\n\t\tns = nsproxy->time_ns_for_children;\n\t\tget_time_ns(ns);\n\t}\n\ttask_unlock(task);\n\n\treturn ns ? &ns->ns : NULL;\n}",
          "includes": [
            "#include <vdso/datapage.h>",
            "#include <linux/mm.h>",
            "#include <linux/err.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/time_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic struct ns_common *timens_for_children_get(struct task_struct *task)\n{\n\tstruct time_namespace *ns = NULL;\n\tstruct nsproxy *nsproxy;\n\n\ttask_lock(task);\n\tnsproxy = task->nsproxy;\n\tif (nsproxy) {\n\t\tns = nsproxy->time_ns_for_children;\n\t\tget_time_ns(ns);\n\t}\n\ttask_unlock(task);\n\n\treturn ns ? &ns->ns : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic DEFINE_MUTEX(offset_lock);\n\nint proc_timens_set_offset(struct file *file, struct task_struct *p,\n\t\t\t   struct proc_timens_offset *offsets, int noffsets)\n{\n\tstruct ns_common *ns;\n\tstruct time_namespace *time_ns;\n\tstruct timespec64 tp;\n\tint i, err;\n\n\tns = timens_for_children_get(p);\n\tif (!ns)\n\t\treturn -ESRCH;\n\ttime_ns = to_time_ns(ns);\n\n\tif (!file_ns_capable(file, time_ns->user_ns, CAP_SYS_TIME)) {\n\t\tput_time_ns(time_ns);\n\t\treturn -EPERM;\n\t}\n\n\tfor (i = 0; i < noffsets; i++) {\n\t\tstruct proc_timens_offset *off = &offsets[i];\n\n\t\tswitch (off->clockid) {\n\t\tcase CLOCK_MONOTONIC:\n\t\t\tktime_get_ts64(&tp);\n\t\t\tbreak;\n\t\tcase CLOCK_BOOTTIME:\n\t\t\tktime_get_boottime_ts64(&tp);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\terr = -EINVAL;\n\t\t\tgoto out;\n\t\t}\n\n\t\terr = -ERANGE;\n\n\t\tif (off->val.tv_sec > KTIME_SEC_MAX ||\n\t\t    off->val.tv_sec < -KTIME_SEC_MAX)\n\t\t\tgoto out;\n\n\t\ttp = timespec64_add(tp, off->val);\n\t\t/*\n\t\t * KTIME_SEC_MAX is divided by 2 to be sure that KTIME_MAX is\n\t\t * still unreachable.\n\t\t */\n\t\tif (tp.tv_sec < 0 || tp.tv_sec > KTIME_SEC_MAX / 2)\n\t\t\tgoto out;\n\t}\n\n\tmutex_lock(&offset_lock);\n\tif (time_ns->frozen_offsets) {\n\t\terr = -EACCES;\n\t\tgoto out_unlock;\n\t}\n\n\terr = 0;\n\t/* Don't report errors after this line */\n\tfor (i = 0; i < noffsets; i++) {\n\t\tstruct proc_timens_offset *off = &offsets[i];\n\t\tstruct timespec64 *offset = NULL;\n\n\t\tswitch (off->clockid) {\n\t\tcase CLOCK_MONOTONIC:\n\t\t\toffset = &time_ns->offsets.monotonic;\n\t\t\tbreak;\n\t\tcase CLOCK_BOOTTIME:\n\t\t\toffset = &time_ns->offsets.boottime;\n\t\t\tbreak;\n\t\t}\n\n\t\t*offset = off->val;\n\t}\n\nout_unlock:\n\tmutex_unlock(&offset_lock);\nout:\n\tput_time_ns(time_ns);\n\n\treturn err;\n}"
  },
  {
    "function_name": "proc_timens_show_offsets",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "347-360",
    "snippet": "void proc_timens_show_offsets(struct task_struct *p, struct seq_file *m)\n{\n\tstruct ns_common *ns;\n\tstruct time_namespace *time_ns;\n\n\tns = timens_for_children_get(p);\n\tif (!ns)\n\t\treturn;\n\ttime_ns = to_time_ns(ns);\n\n\tshow_offset(m, CLOCK_MONOTONIC, &time_ns->offsets.monotonic);\n\tshow_offset(m, CLOCK_BOOTTIME, &time_ns->offsets.boottime);\n\tput_time_ns(time_ns);\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_time_ns",
          "args": [
            "time_ns"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "show_offset",
          "args": [
            "m",
            "CLOCK_BOOTTIME",
            "&time_ns->offsets.boottime"
          ],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "show_offset",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
          "lines": "329-345",
          "snippet": "static void show_offset(struct seq_file *m, int clockid, struct timespec64 *ts)\n{\n\tchar *clock;\n\n\tswitch (clockid) {\n\tcase CLOCK_BOOTTIME:\n\t\tclock = \"boottime\";\n\t\tbreak;\n\tcase CLOCK_MONOTONIC:\n\t\tclock = \"monotonic\";\n\t\tbreak;\n\tdefault:\n\t\tclock = \"unknown\";\n\t\tbreak;\n\t}\n\tseq_printf(m, \"%-10s %10lld %9ld\\n\", clock, ts->tv_sec, ts->tv_nsec);\n}",
          "includes": [
            "#include <vdso/datapage.h>",
            "#include <linux/mm.h>",
            "#include <linux/err.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/time_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic void show_offset(struct seq_file *m, int clockid, struct timespec64 *ts)\n{\n\tchar *clock;\n\n\tswitch (clockid) {\n\tcase CLOCK_BOOTTIME:\n\t\tclock = \"boottime\";\n\t\tbreak;\n\tcase CLOCK_MONOTONIC:\n\t\tclock = \"monotonic\";\n\t\tbreak;\n\tdefault:\n\t\tclock = \"unknown\";\n\t\tbreak;\n\t}\n\tseq_printf(m, \"%-10s %10lld %9ld\\n\", clock, ts->tv_sec, ts->tv_nsec);\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_time_ns",
          "args": [
            "ns"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "to_time_ns",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
          "lines": "238-241",
          "snippet": "static struct time_namespace *to_time_ns(struct ns_common *ns)\n{\n\treturn container_of(ns, struct time_namespace, ns);\n}",
          "includes": [
            "#include <vdso/datapage.h>",
            "#include <linux/mm.h>",
            "#include <linux/err.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/time_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic struct time_namespace *to_time_ns(struct ns_common *ns)\n{\n\treturn container_of(ns, struct time_namespace, ns);\n}"
        }
      },
      {
        "call_info": {
          "callee": "timens_for_children_get",
          "args": [
            "p"
          ],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "timens_for_children_get",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
          "lines": "259-273",
          "snippet": "static struct ns_common *timens_for_children_get(struct task_struct *task)\n{\n\tstruct time_namespace *ns = NULL;\n\tstruct nsproxy *nsproxy;\n\n\ttask_lock(task);\n\tnsproxy = task->nsproxy;\n\tif (nsproxy) {\n\t\tns = nsproxy->time_ns_for_children;\n\t\tget_time_ns(ns);\n\t}\n\ttask_unlock(task);\n\n\treturn ns ? &ns->ns : NULL;\n}",
          "includes": [
            "#include <vdso/datapage.h>",
            "#include <linux/mm.h>",
            "#include <linux/err.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/time_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic struct ns_common *timens_for_children_get(struct task_struct *task)\n{\n\tstruct time_namespace *ns = NULL;\n\tstruct nsproxy *nsproxy;\n\n\ttask_lock(task);\n\tnsproxy = task->nsproxy;\n\tif (nsproxy) {\n\t\tns = nsproxy->time_ns_for_children;\n\t\tget_time_ns(ns);\n\t}\n\ttask_unlock(task);\n\n\treturn ns ? &ns->ns : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nvoid proc_timens_show_offsets(struct task_struct *p, struct seq_file *m)\n{\n\tstruct ns_common *ns;\n\tstruct time_namespace *time_ns;\n\n\tns = timens_for_children_get(p);\n\tif (!ns)\n\t\treturn;\n\ttime_ns = to_time_ns(ns);\n\n\tshow_offset(m, CLOCK_MONOTONIC, &time_ns->offsets.monotonic);\n\tshow_offset(m, CLOCK_BOOTTIME, &time_ns->offsets.boottime);\n\tput_time_ns(time_ns);\n}"
  },
  {
    "function_name": "show_offset",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "329-345",
    "snippet": "static void show_offset(struct seq_file *m, int clockid, struct timespec64 *ts)\n{\n\tchar *clock;\n\n\tswitch (clockid) {\n\tcase CLOCK_BOOTTIME:\n\t\tclock = \"boottime\";\n\t\tbreak;\n\tcase CLOCK_MONOTONIC:\n\t\tclock = \"monotonic\";\n\t\tbreak;\n\tdefault:\n\t\tclock = \"unknown\";\n\t\tbreak;\n\t}\n\tseq_printf(m, \"%-10s %10lld %9ld\\n\", clock, ts->tv_sec, ts->tv_nsec);\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"%-10s %10lld %9ld\\n\"",
            "clock",
            "ts->tv_sec",
            "ts->tv_nsec"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "trace_seq_printf",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/trace_seq.c",
          "lines": "81-100",
          "snippet": "void trace_seq_printf(struct trace_seq *s, const char *fmt, ...)\n{\n\tunsigned int save_len = s->seq.len;\n\tva_list ap;\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tva_start(ap, fmt);\n\tseq_buf_vprintf(&s->seq, fmt, ap);\n\tva_end(ap);\n\n\t/* If we can't write it all, don't bother writing anything */\n\tif (unlikely(seq_buf_has_overflowed(&s->seq))) {\n\t\ts->seq.len = save_len;\n\t\ts->full = 1;\n\t}\n}",
          "includes": [
            "#include <linux/trace_seq.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/trace_seq.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n\nvoid trace_seq_printf(struct trace_seq *s, const char *fmt, ...)\n{\n\tunsigned int save_len = s->seq.len;\n\tva_list ap;\n\n\tif (s->full)\n\t\treturn;\n\n\t__trace_seq_init(s);\n\n\tva_start(ap, fmt);\n\tseq_buf_vprintf(&s->seq, fmt, ap);\n\tva_end(ap);\n\n\t/* If we can't write it all, don't bother writing anything */\n\tif (unlikely(seq_buf_has_overflowed(&s->seq))) {\n\t\ts->seq.len = save_len;\n\t\ts->full = 1;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic void show_offset(struct seq_file *m, int clockid, struct timespec64 *ts)\n{\n\tchar *clock;\n\n\tswitch (clockid) {\n\tcase CLOCK_BOOTTIME:\n\t\tclock = \"boottime\";\n\t\tbreak;\n\tcase CLOCK_MONOTONIC:\n\t\tclock = \"monotonic\";\n\t\tbreak;\n\tdefault:\n\t\tclock = \"unknown\";\n\t\tbreak;\n\t}\n\tseq_printf(m, \"%-10s %10lld %9ld\\n\", clock, ts->tv_sec, ts->tv_nsec);\n}"
  },
  {
    "function_name": "timens_owner",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "324-327",
    "snippet": "static struct user_namespace *timens_owner(struct ns_common *ns)\n{\n\treturn to_time_ns(ns)->user_ns;\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "to_time_ns",
          "args": [
            "ns"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "to_time_ns",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
          "lines": "238-241",
          "snippet": "static struct time_namespace *to_time_ns(struct ns_common *ns)\n{\n\treturn container_of(ns, struct time_namespace, ns);\n}",
          "includes": [
            "#include <vdso/datapage.h>",
            "#include <linux/mm.h>",
            "#include <linux/err.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/time_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic struct time_namespace *to_time_ns(struct ns_common *ns)\n{\n\treturn container_of(ns, struct time_namespace, ns);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic struct user_namespace *timens_owner(struct ns_common *ns)\n{\n\treturn to_time_ns(ns)->user_ns;\n}"
  },
  {
    "function_name": "timens_on_fork",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "308-322",
    "snippet": "void timens_on_fork(struct nsproxy *nsproxy, struct task_struct *tsk)\n{\n\tstruct ns_common *nsc = &nsproxy->time_ns_for_children->ns;\n\tstruct time_namespace *ns = to_time_ns(nsc);\n\n\t/* create_new_namespaces() already incremented the ref counter */\n\tif (nsproxy->time_ns == nsproxy->time_ns_for_children)\n\t\treturn;\n\n\tget_time_ns(ns);\n\tput_time_ns(nsproxy->time_ns);\n\tnsproxy->time_ns = ns;\n\n\ttimens_commit(tsk, ns);\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "timens_commit",
          "args": [
            "tsk",
            "ns"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "timens_commit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
          "lines": "280-284",
          "snippet": "void timens_commit(struct task_struct *tsk, struct time_namespace *ns)\n{\n\ttimens_set_vvar_page(tsk, ns);\n\tvdso_join_timens(tsk, ns);\n}",
          "includes": [
            "#include <vdso/datapage.h>",
            "#include <linux/mm.h>",
            "#include <linux/err.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/time_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nvoid timens_commit(struct task_struct *tsk, struct time_namespace *ns)\n{\n\ttimens_set_vvar_page(tsk, ns);\n\tvdso_join_timens(tsk, ns);\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_time_ns",
          "args": [
            "nsproxy->time_ns"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_time_ns",
          "args": [
            "ns"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_time_ns",
          "args": [
            "nsc"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "to_time_ns",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
          "lines": "238-241",
          "snippet": "static struct time_namespace *to_time_ns(struct ns_common *ns)\n{\n\treturn container_of(ns, struct time_namespace, ns);\n}",
          "includes": [
            "#include <vdso/datapage.h>",
            "#include <linux/mm.h>",
            "#include <linux/err.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/time_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic struct time_namespace *to_time_ns(struct ns_common *ns)\n{\n\treturn container_of(ns, struct time_namespace, ns);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nvoid timens_on_fork(struct nsproxy *nsproxy, struct task_struct *tsk)\n{\n\tstruct ns_common *nsc = &nsproxy->time_ns_for_children->ns;\n\tstruct time_namespace *ns = to_time_ns(nsc);\n\n\t/* create_new_namespaces() already incremented the ref counter */\n\tif (nsproxy->time_ns == nsproxy->time_ns_for_children)\n\t\treturn;\n\n\tget_time_ns(ns);\n\tput_time_ns(nsproxy->time_ns);\n\tnsproxy->time_ns = ns;\n\n\ttimens_commit(tsk, ns);\n}"
  },
  {
    "function_name": "timens_install",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "286-306",
    "snippet": "static int timens_install(struct nsset *nsset, struct ns_common *new)\n{\n\tstruct nsproxy *nsproxy = nsset->nsproxy;\n\tstruct time_namespace *ns = to_time_ns(new);\n\n\tif (!current_is_single_threaded())\n\t\treturn -EUSERS;\n\n\tif (!ns_capable(ns->user_ns, CAP_SYS_ADMIN) ||\n\t    !ns_capable(nsset->cred->user_ns, CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tget_time_ns(ns);\n\tput_time_ns(nsproxy->time_ns);\n\tnsproxy->time_ns = ns;\n\n\tget_time_ns(ns);\n\tput_time_ns(nsproxy->time_ns_for_children);\n\tnsproxy->time_ns_for_children = ns;\n\treturn 0;\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_time_ns",
          "args": [
            "nsproxy->time_ns_for_children"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_time_ns",
          "args": [
            "ns"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_time_ns",
          "args": [
            "nsproxy->time_ns"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_time_ns",
          "args": [
            "ns"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ns_capable",
          "args": [
            "nsset->cred->user_ns",
            "CAP_SYS_ADMIN"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "ns_capable_setid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/capability.c",
          "lines": "431-434",
          "snippet": "bool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/user_namespace.h>\n#include <linux/pid_namespace.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n\nbool ns_capable_setid(struct user_namespace *ns, int cap)\n{\n\treturn ns_capable_common(ns, cap, CAP_OPT_INSETID);\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_is_single_threaded",
          "args": [],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_time_ns",
          "args": [
            "new"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "to_time_ns",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
          "lines": "238-241",
          "snippet": "static struct time_namespace *to_time_ns(struct ns_common *ns)\n{\n\treturn container_of(ns, struct time_namespace, ns);\n}",
          "includes": [
            "#include <vdso/datapage.h>",
            "#include <linux/mm.h>",
            "#include <linux/err.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/time_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic struct time_namespace *to_time_ns(struct ns_common *ns)\n{\n\treturn container_of(ns, struct time_namespace, ns);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic int timens_install(struct nsset *nsset, struct ns_common *new)\n{\n\tstruct nsproxy *nsproxy = nsset->nsproxy;\n\tstruct time_namespace *ns = to_time_ns(new);\n\n\tif (!current_is_single_threaded())\n\t\treturn -EUSERS;\n\n\tif (!ns_capable(ns->user_ns, CAP_SYS_ADMIN) ||\n\t    !ns_capable(nsset->cred->user_ns, CAP_SYS_ADMIN))\n\t\treturn -EPERM;\n\n\tget_time_ns(ns);\n\tput_time_ns(nsproxy->time_ns);\n\tnsproxy->time_ns = ns;\n\n\tget_time_ns(ns);\n\tput_time_ns(nsproxy->time_ns_for_children);\n\tnsproxy->time_ns_for_children = ns;\n\treturn 0;\n}"
  },
  {
    "function_name": "timens_commit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "280-284",
    "snippet": "void timens_commit(struct task_struct *tsk, struct time_namespace *ns)\n{\n\ttimens_set_vvar_page(tsk, ns);\n\tvdso_join_timens(tsk, ns);\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vdso_join_timens",
          "args": [
            "tsk",
            "ns"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timens_set_vvar_page",
          "args": [
            "tsk",
            "ns"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "timens_set_vvar_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
          "lines": "201-227",
          "snippet": "static void timens_set_vvar_page(struct task_struct *task,\n\t\t\t\tstruct time_namespace *ns)\n{\n\tstruct vdso_data *vdata;\n\tunsigned int i;\n\n\tif (ns == &init_time_ns)\n\t\treturn;\n\n\t/* Fast-path, taken by every task in namespace except the first. */\n\tif (likely(ns->frozen_offsets))\n\t\treturn;\n\n\tmutex_lock(&offset_lock);\n\t/* Nothing to-do: vvar_page has been already initialized. */\n\tif (ns->frozen_offsets)\n\t\tgoto out;\n\n\tns->frozen_offsets = true;\n\tvdata = arch_get_vdso_data(page_address(ns->vvar_page));\n\n\tfor (i = 0; i < CS_BASES; i++)\n\t\ttimens_setup_vdso_data(&vdata[i], ns);\n\nout:\n\tmutex_unlock(&offset_lock);\n}",
          "includes": [
            "#include <vdso/datapage.h>",
            "#include <linux/mm.h>",
            "#include <linux/err.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/time_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(offset_lock);",
            "struct time_namespace init_time_ns = {\n\t.ns.count\t= REFCOUNT_INIT(3),\n\t.user_ns\t= &init_user_ns,\n\t.ns.inum\t= PROC_TIME_INIT_INO,\n\t.ns.ops\t\t= &timens_operations,\n\t.frozen_offsets\t= true,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic DEFINE_MUTEX(offset_lock);\nstruct time_namespace init_time_ns = {\n\t.ns.count\t= REFCOUNT_INIT(3),\n\t.user_ns\t= &init_user_ns,\n\t.ns.inum\t= PROC_TIME_INIT_INO,\n\t.ns.ops\t\t= &timens_operations,\n\t.frozen_offsets\t= true,\n};\n\nstatic void timens_set_vvar_page(struct task_struct *task,\n\t\t\t\tstruct time_namespace *ns)\n{\n\tstruct vdso_data *vdata;\n\tunsigned int i;\n\n\tif (ns == &init_time_ns)\n\t\treturn;\n\n\t/* Fast-path, taken by every task in namespace except the first. */\n\tif (likely(ns->frozen_offsets))\n\t\treturn;\n\n\tmutex_lock(&offset_lock);\n\t/* Nothing to-do: vvar_page has been already initialized. */\n\tif (ns->frozen_offsets)\n\t\tgoto out;\n\n\tns->frozen_offsets = true;\n\tvdata = arch_get_vdso_data(page_address(ns->vvar_page));\n\n\tfor (i = 0; i < CS_BASES; i++)\n\t\ttimens_setup_vdso_data(&vdata[i], ns);\n\nout:\n\tmutex_unlock(&offset_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nvoid timens_commit(struct task_struct *tsk, struct time_namespace *ns)\n{\n\ttimens_set_vvar_page(tsk, ns);\n\tvdso_join_timens(tsk, ns);\n}"
  },
  {
    "function_name": "timens_put",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "275-278",
    "snippet": "static void timens_put(struct ns_common *ns)\n{\n\tput_time_ns(to_time_ns(ns));\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_time_ns",
          "args": [
            "to_time_ns(ns)"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_time_ns",
          "args": [
            "ns"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "to_time_ns",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
          "lines": "238-241",
          "snippet": "static struct time_namespace *to_time_ns(struct ns_common *ns)\n{\n\treturn container_of(ns, struct time_namespace, ns);\n}",
          "includes": [
            "#include <vdso/datapage.h>",
            "#include <linux/mm.h>",
            "#include <linux/err.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/time_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic struct time_namespace *to_time_ns(struct ns_common *ns)\n{\n\treturn container_of(ns, struct time_namespace, ns);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic void timens_put(struct ns_common *ns)\n{\n\tput_time_ns(to_time_ns(ns));\n}"
  },
  {
    "function_name": "timens_for_children_get",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "259-273",
    "snippet": "static struct ns_common *timens_for_children_get(struct task_struct *task)\n{\n\tstruct time_namespace *ns = NULL;\n\tstruct nsproxy *nsproxy;\n\n\ttask_lock(task);\n\tnsproxy = task->nsproxy;\n\tif (nsproxy) {\n\t\tns = nsproxy->time_ns_for_children;\n\t\tget_time_ns(ns);\n\t}\n\ttask_unlock(task);\n\n\treturn ns ? &ns->ns : NULL;\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "task_unlock",
          "args": [
            "task"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_time_ns",
          "args": [
            "ns"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_lock",
          "args": [
            "task"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic struct ns_common *timens_for_children_get(struct task_struct *task)\n{\n\tstruct time_namespace *ns = NULL;\n\tstruct nsproxy *nsproxy;\n\n\ttask_lock(task);\n\tnsproxy = task->nsproxy;\n\tif (nsproxy) {\n\t\tns = nsproxy->time_ns_for_children;\n\t\tget_time_ns(ns);\n\t}\n\ttask_unlock(task);\n\n\treturn ns ? &ns->ns : NULL;\n}"
  },
  {
    "function_name": "timens_get",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "243-257",
    "snippet": "static struct ns_common *timens_get(struct task_struct *task)\n{\n\tstruct time_namespace *ns = NULL;\n\tstruct nsproxy *nsproxy;\n\n\ttask_lock(task);\n\tnsproxy = task->nsproxy;\n\tif (nsproxy) {\n\t\tns = nsproxy->time_ns;\n\t\tget_time_ns(ns);\n\t}\n\ttask_unlock(task);\n\n\treturn ns ? &ns->ns : NULL;\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "task_unlock",
          "args": [
            "task"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_time_ns",
          "args": [
            "ns"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_lock",
          "args": [
            "task"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic struct ns_common *timens_get(struct task_struct *task)\n{\n\tstruct time_namespace *ns = NULL;\n\tstruct nsproxy *nsproxy;\n\n\ttask_lock(task);\n\tnsproxy = task->nsproxy;\n\tif (nsproxy) {\n\t\tns = nsproxy->time_ns;\n\t\tget_time_ns(ns);\n\t}\n\ttask_unlock(task);\n\n\treturn ns ? &ns->ns : NULL;\n}"
  },
  {
    "function_name": "to_time_ns",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "238-241",
    "snippet": "static struct time_namespace *to_time_ns(struct ns_common *ns)\n{\n\treturn container_of(ns, struct time_namespace, ns);\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ns",
            "structtime_namespace",
            "ns"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic struct time_namespace *to_time_ns(struct ns_common *ns)\n{\n\treturn container_of(ns, struct time_namespace, ns);\n}"
  },
  {
    "function_name": "free_time_ns",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "229-236",
    "snippet": "void free_time_ns(struct time_namespace *ns)\n{\n\tdec_time_namespaces(ns->ucounts);\n\tput_user_ns(ns->user_ns);\n\tns_free_inum(&ns->ns);\n\t__free_page(ns->vvar_page);\n\tkfree(ns);\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "ns"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/params.c",
          "lines": "62-75",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/security.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/security.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__free_page",
          "args": [
            "ns->vvar_page"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ns_free_inum",
          "args": [
            "&ns->ns"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user_ns",
          "args": [
            "ns->user_ns"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "__put_user_ns",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/user_namespace.c",
          "lines": "208-211",
          "snippet": "void __put_user_ns(struct user_namespace *ns)\n{\n\tschedule_work(&ns->work);\n}",
          "includes": [
            "#include <linux/sort.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/projid.h>",
            "#include <linux/ctype.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fs.h>",
            "#include <linux/seq_file.h>",
            "#include <keys/user-type.h>",
            "#include <linux/key-type.h>",
            "#include <linux/keyctl.h>",
            "#include <linux/securebits.h>",
            "#include <linux/cred.h>",
            "#include <linux/highuid.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void free_user_ns(struct work_struct *work);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sort.h>\n#include <linux/bsearch.h>\n#include <linux/fs_struct.h>\n#include <linux/projid.h>\n#include <linux/ctype.h>\n#include <linux/uaccess.h>\n#include <linux/fs.h>\n#include <linux/seq_file.h>\n#include <keys/user-type.h>\n#include <linux/key-type.h>\n#include <linux/keyctl.h>\n#include <linux/securebits.h>\n#include <linux/cred.h>\n#include <linux/highuid.h>\n#include <linux/proc_ns.h>\n#include <linux/user_namespace.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n\nstatic void free_user_ns(struct work_struct *work);\n\nvoid __put_user_ns(struct user_namespace *ns)\n{\n\tschedule_work(&ns->work);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dec_time_namespaces",
          "args": [
            "ns->ucounts"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "dec_time_namespaces",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
          "lines": "64-67",
          "snippet": "static void dec_time_namespaces(struct ucounts *ucounts)\n{\n\tdec_ucount(ucounts, UCOUNT_TIME_NAMESPACES);\n}",
          "includes": [
            "#include <vdso/datapage.h>",
            "#include <linux/mm.h>",
            "#include <linux/err.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/time_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic void dec_time_namespaces(struct ucounts *ucounts)\n{\n\tdec_ucount(ucounts, UCOUNT_TIME_NAMESPACES);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nvoid free_time_ns(struct time_namespace *ns)\n{\n\tdec_time_namespaces(ns->ucounts);\n\tput_user_ns(ns->user_ns);\n\tns_free_inum(&ns->ns);\n\t__free_page(ns->vvar_page);\n\tkfree(ns);\n}"
  },
  {
    "function_name": "timens_set_vvar_page",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "201-227",
    "snippet": "static void timens_set_vvar_page(struct task_struct *task,\n\t\t\t\tstruct time_namespace *ns)\n{\n\tstruct vdso_data *vdata;\n\tunsigned int i;\n\n\tif (ns == &init_time_ns)\n\t\treturn;\n\n\t/* Fast-path, taken by every task in namespace except the first. */\n\tif (likely(ns->frozen_offsets))\n\t\treturn;\n\n\tmutex_lock(&offset_lock);\n\t/* Nothing to-do: vvar_page has been already initialized. */\n\tif (ns->frozen_offsets)\n\t\tgoto out;\n\n\tns->frozen_offsets = true;\n\tvdata = arch_get_vdso_data(page_address(ns->vvar_page));\n\n\tfor (i = 0; i < CS_BASES; i++)\n\t\ttimens_setup_vdso_data(&vdata[i], ns);\n\nout:\n\tmutex_unlock(&offset_lock);\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(offset_lock);",
      "struct time_namespace init_time_ns = {\n\t.ns.count\t= REFCOUNT_INIT(3),\n\t.user_ns\t= &init_user_ns,\n\t.ns.inum\t= PROC_TIME_INIT_INO,\n\t.ns.ops\t\t= &timens_operations,\n\t.frozen_offsets\t= true,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&offset_lock"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "__rt_mutex_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex.c",
          "lines": "1350-1356",
          "snippet": "static __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}",
          "includes": [
            "# include \"ww_mutex.h\"",
            "#include \"rtmutex_common.h\"",
            "#include <linux/ww_mutex.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"ww_mutex.h\"\n#include \"rtmutex_common.h\"\n#include <linux/ww_mutex.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n\nstatic __always_inline struct;\n\nstatic __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "timens_setup_vdso_data",
          "args": [
            "&vdata[i]",
            "ns"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "timens_setup_vdso_data",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
          "lines": "179-193",
          "snippet": "static void timens_setup_vdso_data(struct vdso_data *vdata,\n\t\t\t\t   struct time_namespace *ns)\n{\n\tstruct timens_offset *offset = vdata->offset;\n\tstruct timens_offset monotonic = offset_from_ts(ns->offsets.monotonic);\n\tstruct timens_offset boottime = offset_from_ts(ns->offsets.boottime);\n\n\tvdata->seq\t\t\t= 1;\n\tvdata->clock_mode\t\t= VDSO_CLOCKMODE_TIMENS;\n\toffset[CLOCK_MONOTONIC]\t\t= monotonic;\n\toffset[CLOCK_MONOTONIC_RAW]\t= monotonic;\n\toffset[CLOCK_MONOTONIC_COARSE]\t= monotonic;\n\toffset[CLOCK_BOOTTIME]\t\t= boottime;\n\toffset[CLOCK_BOOTTIME_ALARM]\t= boottime;\n}",
          "includes": [
            "#include <vdso/datapage.h>",
            "#include <linux/mm.h>",
            "#include <linux/err.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/time_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic void timens_setup_vdso_data(struct vdso_data *vdata,\n\t\t\t\t   struct time_namespace *ns)\n{\n\tstruct timens_offset *offset = vdata->offset;\n\tstruct timens_offset monotonic = offset_from_ts(ns->offsets.monotonic);\n\tstruct timens_offset boottime = offset_from_ts(ns->offsets.boottime);\n\n\tvdata->seq\t\t\t= 1;\n\tvdata->clock_mode\t\t= VDSO_CLOCKMODE_TIMENS;\n\toffset[CLOCK_MONOTONIC]\t\t= monotonic;\n\toffset[CLOCK_MONOTONIC_RAW]\t= monotonic;\n\toffset[CLOCK_MONOTONIC_COARSE]\t= monotonic;\n\toffset[CLOCK_BOOTTIME]\t\t= boottime;\n\toffset[CLOCK_BOOTTIME_ALARM]\t= boottime;\n}"
        }
      },
      {
        "call_info": {
          "callee": "arch_get_vdso_data",
          "args": [
            "page_address(ns->vvar_page)"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "ns->vvar_page"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&offset_lock"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_lock_io",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex_api.c",
          "lines": "580-586",
          "snippet": "void __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}",
          "includes": [
            "#include \"rtmutex.c\"",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex.c\"\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "ns->frozen_offsets"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic DEFINE_MUTEX(offset_lock);\nstruct time_namespace init_time_ns = {\n\t.ns.count\t= REFCOUNT_INIT(3),\n\t.user_ns\t= &init_user_ns,\n\t.ns.inum\t= PROC_TIME_INIT_INO,\n\t.ns.ops\t\t= &timens_operations,\n\t.frozen_offsets\t= true,\n};\n\nstatic void timens_set_vvar_page(struct task_struct *task,\n\t\t\t\tstruct time_namespace *ns)\n{\n\tstruct vdso_data *vdata;\n\tunsigned int i;\n\n\tif (ns == &init_time_ns)\n\t\treturn;\n\n\t/* Fast-path, taken by every task in namespace except the first. */\n\tif (likely(ns->frozen_offsets))\n\t\treturn;\n\n\tmutex_lock(&offset_lock);\n\t/* Nothing to-do: vvar_page has been already initialized. */\n\tif (ns->frozen_offsets)\n\t\tgoto out;\n\n\tns->frozen_offsets = true;\n\tvdata = arch_get_vdso_data(page_address(ns->vvar_page));\n\n\tfor (i = 0; i < CS_BASES; i++)\n\t\ttimens_setup_vdso_data(&vdata[i], ns);\n\nout:\n\tmutex_unlock(&offset_lock);\n}"
  },
  {
    "function_name": "timens_setup_vdso_data",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "179-193",
    "snippet": "static void timens_setup_vdso_data(struct vdso_data *vdata,\n\t\t\t\t   struct time_namespace *ns)\n{\n\tstruct timens_offset *offset = vdata->offset;\n\tstruct timens_offset monotonic = offset_from_ts(ns->offsets.monotonic);\n\tstruct timens_offset boottime = offset_from_ts(ns->offsets.boottime);\n\n\tvdata->seq\t\t\t= 1;\n\tvdata->clock_mode\t\t= VDSO_CLOCKMODE_TIMENS;\n\toffset[CLOCK_MONOTONIC]\t\t= monotonic;\n\toffset[CLOCK_MONOTONIC_RAW]\t= monotonic;\n\toffset[CLOCK_MONOTONIC_COARSE]\t= monotonic;\n\toffset[CLOCK_BOOTTIME]\t\t= boottime;\n\toffset[CLOCK_BOOTTIME_ALARM]\t= boottime;\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "offset_from_ts",
          "args": [
            "ns->offsets.boottime"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "offset_from_ts",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
          "lines": "142-150",
          "snippet": "static struct timens_offset offset_from_ts(struct timespec64 off)\n{\n\tstruct timens_offset ret;\n\n\tret.sec = off.tv_sec;\n\tret.nsec = off.tv_nsec;\n\n\treturn ret;\n}",
          "includes": [
            "#include <vdso/datapage.h>",
            "#include <linux/mm.h>",
            "#include <linux/err.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/time_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic struct timens_offset offset_from_ts(struct timespec64 off)\n{\n\tstruct timens_offset ret;\n\n\tret.sec = off.tv_sec;\n\tret.nsec = off.tv_nsec;\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic void timens_setup_vdso_data(struct vdso_data *vdata,\n\t\t\t\t   struct time_namespace *ns)\n{\n\tstruct timens_offset *offset = vdata->offset;\n\tstruct timens_offset monotonic = offset_from_ts(ns->offsets.monotonic);\n\tstruct timens_offset boottime = offset_from_ts(ns->offsets.boottime);\n\n\tvdata->seq\t\t\t= 1;\n\tvdata->clock_mode\t\t= VDSO_CLOCKMODE_TIMENS;\n\toffset[CLOCK_MONOTONIC]\t\t= monotonic;\n\toffset[CLOCK_MONOTONIC_RAW]\t= monotonic;\n\toffset[CLOCK_MONOTONIC_COARSE]\t= monotonic;\n\toffset[CLOCK_BOOTTIME]\t\t= boottime;\n\toffset[CLOCK_BOOTTIME_ALARM]\t= boottime;\n}"
  },
  {
    "function_name": "offset_from_ts",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "142-150",
    "snippet": "static struct timens_offset offset_from_ts(struct timespec64 off)\n{\n\tstruct timens_offset ret;\n\n\tret.sec = off.tv_sec;\n\tret.nsec = off.tv_nsec;\n\n\treturn ret;\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic struct timens_offset offset_from_ts(struct timespec64 off)\n{\n\tstruct timens_offset ret;\n\n\tret.sec = off.tv_sec;\n\tret.nsec = off.tv_nsec;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "copy_time_ns",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "133-140",
    "snippet": "struct time_namespace *copy_time_ns(unsigned long flags,\n\tstruct user_namespace *user_ns, struct time_namespace *old_ns)\n{\n\tif (!(flags & CLONE_NEWTIME))\n\t\treturn get_time_ns(old_ns);\n\n\treturn clone_time_ns(user_ns, old_ns);\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "clone_time_ns",
          "args": [
            "user_ns",
            "old_ns"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "clone_time_ns",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
          "lines": "78-120",
          "snippet": "static struct time_namespace *clone_time_ns(struct user_namespace *user_ns,\n\t\t\t\t\t  struct time_namespace *old_ns)\n{\n\tstruct time_namespace *ns;\n\tstruct ucounts *ucounts;\n\tint err;\n\n\terr = -ENOSPC;\n\tucounts = inc_time_namespaces(user_ns);\n\tif (!ucounts)\n\t\tgoto fail;\n\n\terr = -ENOMEM;\n\tns = kmalloc(sizeof(*ns), GFP_KERNEL_ACCOUNT);\n\tif (!ns)\n\t\tgoto fail_dec;\n\n\trefcount_set(&ns->ns.count, 1);\n\n\tns->vvar_page = alloc_page(GFP_KERNEL_ACCOUNT | __GFP_ZERO);\n\tif (!ns->vvar_page)\n\t\tgoto fail_free;\n\n\terr = ns_alloc_inum(&ns->ns);\n\tif (err)\n\t\tgoto fail_free_page;\n\n\tns->ucounts = ucounts;\n\tns->ns.ops = &timens_operations;\n\tns->user_ns = get_user_ns(user_ns);\n\tns->offsets = old_ns->offsets;\n\tns->frozen_offsets = false;\n\treturn ns;\n\nfail_free_page:\n\t__free_page(ns->vvar_page);\nfail_free:\n\tkfree(ns);\nfail_dec:\n\tdec_time_namespaces(ucounts);\nfail:\n\treturn ERR_PTR(err);\n}",
          "includes": [
            "#include <vdso/datapage.h>",
            "#include <linux/mm.h>",
            "#include <linux/err.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/time_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "const struct proc_ns_operations timens_operations = {\n\t.name\t\t= \"time\",\n\t.type\t\t= CLONE_NEWTIME,\n\t.get\t\t= timens_get,\n\t.put\t\t= timens_put,\n\t.install\t= timens_install,\n\t.owner\t\t= timens_owner,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nconst struct proc_ns_operations timens_operations = {\n\t.name\t\t= \"time\",\n\t.type\t\t= CLONE_NEWTIME,\n\t.get\t\t= timens_get,\n\t.put\t\t= timens_put,\n\t.install\t= timens_install,\n\t.owner\t\t= timens_owner,\n};\n\nstatic struct time_namespace *clone_time_ns(struct user_namespace *user_ns,\n\t\t\t\t\t  struct time_namespace *old_ns)\n{\n\tstruct time_namespace *ns;\n\tstruct ucounts *ucounts;\n\tint err;\n\n\terr = -ENOSPC;\n\tucounts = inc_time_namespaces(user_ns);\n\tif (!ucounts)\n\t\tgoto fail;\n\n\terr = -ENOMEM;\n\tns = kmalloc(sizeof(*ns), GFP_KERNEL_ACCOUNT);\n\tif (!ns)\n\t\tgoto fail_dec;\n\n\trefcount_set(&ns->ns.count, 1);\n\n\tns->vvar_page = alloc_page(GFP_KERNEL_ACCOUNT | __GFP_ZERO);\n\tif (!ns->vvar_page)\n\t\tgoto fail_free;\n\n\terr = ns_alloc_inum(&ns->ns);\n\tif (err)\n\t\tgoto fail_free_page;\n\n\tns->ucounts = ucounts;\n\tns->ns.ops = &timens_operations;\n\tns->user_ns = get_user_ns(user_ns);\n\tns->offsets = old_ns->offsets;\n\tns->frozen_offsets = false;\n\treturn ns;\n\nfail_free_page:\n\t__free_page(ns->vvar_page);\nfail_free:\n\tkfree(ns);\nfail_dec:\n\tdec_time_namespaces(ucounts);\nfail:\n\treturn ERR_PTR(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_time_ns",
          "args": [
            "old_ns"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstruct time_namespace *copy_time_ns(unsigned long flags,\n\tstruct user_namespace *user_ns, struct time_namespace *old_ns)\n{\n\tif (!(flags & CLONE_NEWTIME))\n\t\treturn get_time_ns(old_ns);\n\n\treturn clone_time_ns(user_ns, old_ns);\n}"
  },
  {
    "function_name": "clone_time_ns",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "78-120",
    "snippet": "static struct time_namespace *clone_time_ns(struct user_namespace *user_ns,\n\t\t\t\t\t  struct time_namespace *old_ns)\n{\n\tstruct time_namespace *ns;\n\tstruct ucounts *ucounts;\n\tint err;\n\n\terr = -ENOSPC;\n\tucounts = inc_time_namespaces(user_ns);\n\tif (!ucounts)\n\t\tgoto fail;\n\n\terr = -ENOMEM;\n\tns = kmalloc(sizeof(*ns), GFP_KERNEL_ACCOUNT);\n\tif (!ns)\n\t\tgoto fail_dec;\n\n\trefcount_set(&ns->ns.count, 1);\n\n\tns->vvar_page = alloc_page(GFP_KERNEL_ACCOUNT | __GFP_ZERO);\n\tif (!ns->vvar_page)\n\t\tgoto fail_free;\n\n\terr = ns_alloc_inum(&ns->ns);\n\tif (err)\n\t\tgoto fail_free_page;\n\n\tns->ucounts = ucounts;\n\tns->ns.ops = &timens_operations;\n\tns->user_ns = get_user_ns(user_ns);\n\tns->offsets = old_ns->offsets;\n\tns->frozen_offsets = false;\n\treturn ns;\n\nfail_free_page:\n\t__free_page(ns->vvar_page);\nfail_free:\n\tkfree(ns);\nfail_dec:\n\tdec_time_namespaces(ucounts);\nfail:\n\treturn ERR_PTR(err);\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "const struct proc_ns_operations timens_operations = {\n\t.name\t\t= \"time\",\n\t.type\t\t= CLONE_NEWTIME,\n\t.get\t\t= timens_get,\n\t.put\t\t= timens_put,\n\t.install\t= timens_install,\n\t.owner\t\t= timens_owner,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "err"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dec_time_namespaces",
          "args": [
            "ucounts"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "dec_time_namespaces",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
          "lines": "64-67",
          "snippet": "static void dec_time_namespaces(struct ucounts *ucounts)\n{\n\tdec_ucount(ucounts, UCOUNT_TIME_NAMESPACES);\n}",
          "includes": [
            "#include <vdso/datapage.h>",
            "#include <linux/mm.h>",
            "#include <linux/err.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/time_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic void dec_time_namespaces(struct ucounts *ucounts)\n{\n\tdec_ucount(ucounts, UCOUNT_TIME_NAMESPACES);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "ns"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/params.c",
          "lines": "62-75",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/security.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/security.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__free_page",
          "args": [
            "ns->vvar_page"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user_ns",
          "args": [
            "user_ns"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ns_alloc_inum",
          "args": [
            "&ns->ns"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_page",
          "args": [
            "GFP_KERNEL_ACCOUNT | __GFP_ZERO"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "relay_alloc_page_array",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/relay.c",
          "lines": "61-67",
          "snippet": "static struct page **relay_alloc_page_array(unsigned int n_pages)\n{\n\tconst size_t pa_size = n_pages * sizeof(struct page *);\n\tif (pa_size > PAGE_SIZE)\n\t\treturn vzalloc(pa_size);\n\treturn kzalloc(pa_size, GFP_KERNEL);\n}",
          "includes": [
            "#include <linux/splice.h>",
            "#include <linux/cpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/relay.h>",
            "#include <linux/string.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/stddef.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/splice.h>\n#include <linux/cpu.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n#include <linux/relay.h>\n#include <linux/string.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/stddef.h>\n#include <linux/errno.h>\n\nstatic struct page **relay_alloc_page_array(unsigned int n_pages)\n{\n\tconst size_t pa_size = n_pages * sizeof(struct page *);\n\tif (pa_size > PAGE_SIZE)\n\t\treturn vzalloc(pa_size);\n\treturn kzalloc(pa_size, GFP_KERNEL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "refcount_set",
          "args": [
            "&ns->ns.count",
            "1"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*ns)",
            "GFP_KERNEL_ACCOUNT"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inc_time_namespaces",
          "args": [
            "user_ns"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "inc_time_namespaces",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
          "lines": "59-62",
          "snippet": "static struct ucounts *inc_time_namespaces(struct user_namespace *ns)\n{\n\treturn inc_ucount(ns, current_euid(), UCOUNT_TIME_NAMESPACES);\n}",
          "includes": [
            "#include <vdso/datapage.h>",
            "#include <linux/mm.h>",
            "#include <linux/err.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/time.h>",
            "#include <linux/export.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/time_namespace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic struct ucounts *inc_time_namespaces(struct user_namespace *ns)\n{\n\treturn inc_ucount(ns, current_euid(), UCOUNT_TIME_NAMESPACES);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nconst struct proc_ns_operations timens_operations = {\n\t.name\t\t= \"time\",\n\t.type\t\t= CLONE_NEWTIME,\n\t.get\t\t= timens_get,\n\t.put\t\t= timens_put,\n\t.install\t= timens_install,\n\t.owner\t\t= timens_owner,\n};\n\nstatic struct time_namespace *clone_time_ns(struct user_namespace *user_ns,\n\t\t\t\t\t  struct time_namespace *old_ns)\n{\n\tstruct time_namespace *ns;\n\tstruct ucounts *ucounts;\n\tint err;\n\n\terr = -ENOSPC;\n\tucounts = inc_time_namespaces(user_ns);\n\tif (!ucounts)\n\t\tgoto fail;\n\n\terr = -ENOMEM;\n\tns = kmalloc(sizeof(*ns), GFP_KERNEL_ACCOUNT);\n\tif (!ns)\n\t\tgoto fail_dec;\n\n\trefcount_set(&ns->ns.count, 1);\n\n\tns->vvar_page = alloc_page(GFP_KERNEL_ACCOUNT | __GFP_ZERO);\n\tif (!ns->vvar_page)\n\t\tgoto fail_free;\n\n\terr = ns_alloc_inum(&ns->ns);\n\tif (err)\n\t\tgoto fail_free_page;\n\n\tns->ucounts = ucounts;\n\tns->ns.ops = &timens_operations;\n\tns->user_ns = get_user_ns(user_ns);\n\tns->offsets = old_ns->offsets;\n\tns->frozen_offsets = false;\n\treturn ns;\n\nfail_free_page:\n\t__free_page(ns->vvar_page);\nfail_free:\n\tkfree(ns);\nfail_dec:\n\tdec_time_namespaces(ucounts);\nfail:\n\treturn ERR_PTR(err);\n}"
  },
  {
    "function_name": "dec_time_namespaces",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "64-67",
    "snippet": "static void dec_time_namespaces(struct ucounts *ucounts)\n{\n\tdec_ucount(ucounts, UCOUNT_TIME_NAMESPACES);\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dec_ucount",
          "args": [
            "ucounts",
            "UCOUNT_TIME_NAMESPACES"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "dec_ucount",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/ucount.c",
          "lines": "254-262",
          "snippet": "void dec_ucount(struct ucounts *ucounts, enum ucount_type type)\n{\n\tstruct ucounts *iter;\n\tfor (iter = ucounts; iter; iter = iter->ns->ucounts) {\n\t\tlong dec = atomic_long_dec_if_positive(&iter->ucount[type]);\n\t\tWARN_ON_ONCE(dec < 0);\n\t}\n\tput_ucounts(ucounts);\n}",
          "includes": [
            "#include <linux/user_namespace.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/hash.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/user_namespace.h>\n#include <linux/kmemleak.h>\n#include <linux/hash.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/sysctl.h>\n#include <linux/stat.h>\n\nvoid dec_ucount(struct ucounts *ucounts, enum ucount_type type)\n{\n\tstruct ucounts *iter;\n\tfor (iter = ucounts; iter; iter = iter->ns->ucounts) {\n\t\tlong dec = atomic_long_dec_if_positive(&iter->ucount[type]);\n\t\tWARN_ON_ONCE(dec < 0);\n\t}\n\tput_ucounts(ucounts);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic void dec_time_namespaces(struct ucounts *ucounts)\n{\n\tdec_ucount(ucounts, UCOUNT_TIME_NAMESPACES);\n}"
  },
  {
    "function_name": "inc_time_namespaces",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "59-62",
    "snippet": "static struct ucounts *inc_time_namespaces(struct user_namespace *ns)\n{\n\treturn inc_ucount(ns, current_euid(), UCOUNT_TIME_NAMESPACES);\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "inc_ucount",
          "args": [
            "ns",
            "current_euid()",
            "UCOUNT_TIME_NAMESPACES"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "inc_ucount",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/ucount.c",
          "lines": "231-252",
          "snippet": "struct ucounts *inc_ucount(struct user_namespace *ns, kuid_t uid,\n\t\t\t   enum ucount_type type)\n{\n\tstruct ucounts *ucounts, *iter, *bad;\n\tstruct user_namespace *tns;\n\tucounts = alloc_ucounts(ns, uid);\n\tfor (iter = ucounts; iter; iter = tns->ucounts) {\n\t\tlong max;\n\t\ttns = iter->ns;\n\t\tmax = READ_ONCE(tns->ucount_max[type]);\n\t\tif (!atomic_long_inc_below(&iter->ucount[type], max))\n\t\t\tgoto fail;\n\t}\n\treturn ucounts;\nfail:\n\tbad = iter;\n\tfor (iter = ucounts; iter != bad; iter = iter->ns->ucounts)\n\t\tatomic_long_dec(&iter->ucount[type]);\n\n\tput_ucounts(ucounts);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/user_namespace.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/hash.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/user_namespace.h>\n#include <linux/kmemleak.h>\n#include <linux/hash.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/sysctl.h>\n#include <linux/stat.h>\n\nstruct ucounts *inc_ucount(struct user_namespace *ns, kuid_t uid,\n\t\t\t   enum ucount_type type)\n{\n\tstruct ucounts *ucounts, *iter, *bad;\n\tstruct user_namespace *tns;\n\tucounts = alloc_ucounts(ns, uid);\n\tfor (iter = ucounts; iter; iter = tns->ucounts) {\n\t\tlong max;\n\t\ttns = iter->ns;\n\t\tmax = READ_ONCE(tns->ucount_max[type]);\n\t\tif (!atomic_long_inc_below(&iter->ucount[type], max))\n\t\t\tgoto fail;\n\t}\n\treturn ucounts;\nfail:\n\tbad = iter;\n\tfor (iter = ucounts; iter != bad; iter = iter->ns->ucounts)\n\t\tatomic_long_dec(&iter->ucount[type]);\n\n\tput_ucounts(ucounts);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_euid",
          "args": [],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nstatic struct ucounts *inc_time_namespaces(struct user_namespace *ns)\n{\n\treturn inc_ucount(ns, current_euid(), UCOUNT_TIME_NAMESPACES);\n}"
  },
  {
    "function_name": "do_timens_ktime_to_host",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/namespace.c",
    "lines": "23-57",
    "snippet": "ktime_t do_timens_ktime_to_host(clockid_t clockid, ktime_t tim,\n\t\t\t\tstruct timens_offsets *ns_offsets)\n{\n\tktime_t offset;\n\n\tswitch (clockid) {\n\tcase CLOCK_MONOTONIC:\n\t\toffset = timespec64_to_ktime(ns_offsets->monotonic);\n\t\tbreak;\n\tcase CLOCK_BOOTTIME:\n\tcase CLOCK_BOOTTIME_ALARM:\n\t\toffset = timespec64_to_ktime(ns_offsets->boottime);\n\t\tbreak;\n\tdefault:\n\t\treturn tim;\n\t}\n\n\t/*\n\t * Check that @tim value is in [offset, KTIME_MAX + offset]\n\t * and subtract offset.\n\t */\n\tif (tim < offset) {\n\t\t/*\n\t\t * User can specify @tim *absolute* value - if it's lesser than\n\t\t * the time namespace's offset - it's already expired.\n\t\t */\n\t\ttim = 0;\n\t} else {\n\t\ttim = ktime_sub(tim, offset);\n\t\tif (unlikely(tim > KTIME_MAX))\n\t\t\ttim = KTIME_MAX;\n\t}\n\n\treturn tim;\n}",
    "includes": [
      "#include <vdso/datapage.h>",
      "#include <linux/mm.h>",
      "#include <linux/err.h>",
      "#include <linux/cred.h>",
      "#include <linux/slab.h>",
      "#include <linux/time.h>",
      "#include <linux/export.h>",
      "#include <linux/proc_ns.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/clocksource.h>",
      "#include <linux/sched/task.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/user_namespace.h>",
      "#include <linux/time_namespace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "tim > KTIME_MAX"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_sub",
          "args": [
            "tim",
            "offset"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timespec64_to_ktime",
          "args": [
            "ns_offsets->boottime"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timespec64_to_ktime",
          "args": [
            "ns_offsets->monotonic"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vdso/datapage.h>\n#include <linux/mm.h>\n#include <linux/err.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/time.h>\n#include <linux/export.h>\n#include <linux/proc_ns.h>\n#include <linux/seq_file.h>\n#include <linux/clocksource.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/user_namespace.h>\n#include <linux/time_namespace.h>\n\nktime_t do_timens_ktime_to_host(clockid_t clockid, ktime_t tim,\n\t\t\t\tstruct timens_offsets *ns_offsets)\n{\n\tktime_t offset;\n\n\tswitch (clockid) {\n\tcase CLOCK_MONOTONIC:\n\t\toffset = timespec64_to_ktime(ns_offsets->monotonic);\n\t\tbreak;\n\tcase CLOCK_BOOTTIME:\n\tcase CLOCK_BOOTTIME_ALARM:\n\t\toffset = timespec64_to_ktime(ns_offsets->boottime);\n\t\tbreak;\n\tdefault:\n\t\treturn tim;\n\t}\n\n\t/*\n\t * Check that @tim value is in [offset, KTIME_MAX + offset]\n\t * and subtract offset.\n\t */\n\tif (tim < offset) {\n\t\t/*\n\t\t * User can specify @tim *absolute* value - if it's lesser than\n\t\t * the time namespace's offset - it's already expired.\n\t\t */\n\t\ttim = 0;\n\t} else {\n\t\ttim = ktime_sub(tim, offset);\n\t\tif (unlikely(tim > KTIME_MAX))\n\t\t\ttim = KTIME_MAX;\n\t}\n\n\treturn tim;\n}"
  }
]