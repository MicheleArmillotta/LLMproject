[
  {
    "function_name": "cpudl_cleanup",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
    "lines": "292-296",
    "snippet": "void cpudl_cleanup(struct cpudl *cp)\n{\n\tfree_cpumask_var(cp->free_cpus);\n\tkfree(cp->elements);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cp->elements"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/params.c",
          "lines": "62-75",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/security.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/security.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_cpumask_var",
          "args": [
            "cp->free_cpus"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nvoid cpudl_cleanup(struct cpudl *cp)\n{\n\tfree_cpumask_var(cp->free_cpus);\n\tkfree(cp->elements);\n}"
  },
  {
    "function_name": "cpudl_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
    "lines": "264-286",
    "snippet": "int cpudl_init(struct cpudl *cp)\n{\n\tint i;\n\n\traw_spin_lock_init(&cp->lock);\n\tcp->size = 0;\n\n\tcp->elements = kcalloc(nr_cpu_ids,\n\t\t\t       sizeof(struct cpudl_item),\n\t\t\t       GFP_KERNEL);\n\tif (!cp->elements)\n\t\treturn -ENOMEM;\n\n\tif (!zalloc_cpumask_var(&cp->free_cpus, GFP_KERNEL)) {\n\t\tkfree(cp->elements);\n\t\treturn -ENOMEM;\n\t}\n\n\tfor_each_possible_cpu(i)\n\t\tcp->elements[i].idx = IDX_INVALID;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cp->elements"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/params.c",
          "lines": "62-75",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/security.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/security.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zalloc_cpumask_var",
          "args": [
            "&cp->free_cpus",
            "GFP_KERNEL"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcalloc",
          "args": [
            "nr_cpu_ids",
            "sizeof(struct cpudl_item)",
            "GFP_KERNEL"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_init",
          "args": [
            "&cp->lock"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nint cpudl_init(struct cpudl *cp)\n{\n\tint i;\n\n\traw_spin_lock_init(&cp->lock);\n\tcp->size = 0;\n\n\tcp->elements = kcalloc(nr_cpu_ids,\n\t\t\t       sizeof(struct cpudl_item),\n\t\t\t       GFP_KERNEL);\n\tif (!cp->elements)\n\t\treturn -ENOMEM;\n\n\tif (!zalloc_cpumask_var(&cp->free_cpus, GFP_KERNEL)) {\n\t\tkfree(cp->elements);\n\t\treturn -ENOMEM;\n\t}\n\n\tfor_each_possible_cpu(i)\n\t\tcp->elements[i].idx = IDX_INVALID;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "cpudl_clear_freecpu",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
    "lines": "255-258",
    "snippet": "void cpudl_clear_freecpu(struct cpudl *cp, int cpu)\n{\n\tcpumask_clear_cpu(cpu, cp->free_cpus);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumask_clear_cpu",
          "args": [
            "cpu",
            "cp->free_cpus"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nvoid cpudl_clear_freecpu(struct cpudl *cp, int cpu)\n{\n\tcpumask_clear_cpu(cpu, cp->free_cpus);\n}"
  },
  {
    "function_name": "cpudl_set_freecpu",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
    "lines": "245-248",
    "snippet": "void cpudl_set_freecpu(struct cpudl *cp, int cpu)\n{\n\tcpumask_set_cpu(cpu, cp->free_cpus);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "cpu",
            "cp->free_cpus"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nvoid cpudl_set_freecpu(struct cpudl *cp, int cpu)\n{\n\tcpumask_set_cpu(cpu, cp->free_cpus);\n}"
  },
  {
    "function_name": "cpudl_set",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
    "lines": "214-238",
    "snippet": "void cpudl_set(struct cpudl *cp, int cpu, u64 dl)\n{\n\tint old_idx;\n\tunsigned long flags;\n\n\tWARN_ON(!cpu_present(cpu));\n\n\traw_spin_lock_irqsave(&cp->lock, flags);\n\n\told_idx = cp->elements[cpu].idx;\n\tif (old_idx == IDX_INVALID) {\n\t\tint new_idx = cp->size++;\n\n\t\tcp->elements[new_idx].dl = dl;\n\t\tcp->elements[new_idx].cpu = cpu;\n\t\tcp->elements[cpu].idx = new_idx;\n\t\tcpudl_heapify_up(cp, new_idx);\n\t\tcpumask_clear_cpu(cpu, cp->free_cpus);\n\t} else {\n\t\tcp->elements[old_idx].dl = dl;\n\t\tcpudl_heapify(cp, old_idx);\n\t}\n\n\traw_spin_unlock_irqrestore(&cp->lock, flags);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&cp->lock",
            "flags"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpudl_heapify",
          "args": [
            "cp",
            "old_idx"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "cpudl_heapify",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
          "lines": "95-102",
          "snippet": "static void cpudl_heapify(struct cpudl *cp, int idx)\n{\n\tif (idx > 0 && dl_time_before(cp->elements[parent(idx)].dl,\n\t\t\t\tcp->elements[idx].dl))\n\t\tcpudl_heapify_up(cp, idx);\n\telse\n\t\tcpudl_heapify_down(cp, idx);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic void cpudl_heapify(struct cpudl *cp, int idx)\n{\n\tif (idx > 0 && dl_time_before(cp->elements[parent(idx)].dl,\n\t\t\t\tcp->elements[idx].dl))\n\t\tcpudl_heapify_up(cp, idx);\n\telse\n\t\tcpudl_heapify_down(cp, idx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_clear_cpu",
          "args": [
            "cpu",
            "cp->free_cpus"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpudl_heapify_up",
          "args": [
            "cp",
            "new_idx"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "cpudl_heapify_up",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
          "lines": "69-93",
          "snippet": "static void cpudl_heapify_up(struct cpudl *cp, int idx)\n{\n\tint p;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (idx == 0)\n\t\treturn;\n\n\tdo {\n\t\tp = parent(idx);\n\t\tif (dl_time_before(orig_dl, cp->elements[p].dl))\n\t\t\tbreak;\n\t\t/* pull parent onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[p].cpu;\n\t\tcp->elements[idx].dl = cp->elements[p].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = p;\n\t} while (idx != 0);\n\t/* actual push up of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic void cpudl_heapify_up(struct cpudl *cp, int idx)\n{\n\tint p;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (idx == 0)\n\t\treturn;\n\n\tdo {\n\t\tp = parent(idx);\n\t\tif (dl_time_before(orig_dl, cp->elements[p].dl))\n\t\t\tbreak;\n\t\t/* pull parent onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[p].cpu;\n\t\tcp->elements[idx].dl = cp->elements[p].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = p;\n\t} while (idx != 0);\n\t/* actual push up of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&cp->lock",
            "flags"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!cpu_present(cpu)"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_present",
          "args": [
            "cpu"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "init_cpu_present",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu.c",
          "lines": "2606-2609",
          "snippet": "void init_cpu_present(const struct cpumask *src)\n{\n\tcpumask_copy(&__cpu_present_mask, src);\n}",
          "includes": [
            "#include \"smpboot.h\"",
            "#include <trace/events/cpuhp.h>",
            "#include <trace/events/power.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/percpu-rwsem.h>",
            "#include <linux/scs.h>",
            "#include <linux/slab.h>",
            "#include <linux/relay.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/nmi.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/suspend.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mutex.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/kthread.h>",
            "#include <linux/bug.h>",
            "#include <linux/export.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/unistd.h>",
            "#include <linux/sched/smt.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/notifier.h>",
            "#include <linux/init.h>",
            "#include <linux/smp.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/sched/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct cpumask __cpu_present_mask"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"smpboot.h\"\n#include <trace/events/cpuhp.h>\n#include <trace/events/power.h>\n#include <linux/cpuset.h>\n#include <linux/percpu-rwsem.h>\n#include <linux/scs.h>\n#include <linux/slab.h>\n#include <linux/relay.h>\n#include <linux/smpboot.h>\n#include <linux/nmi.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/lockdep.h>\n#include <linux/suspend.h>\n#include <linux/gfp.h>\n#include <linux/mutex.h>\n#include <linux/stop_machine.h>\n#include <linux/kthread.h>\n#include <linux/bug.h>\n#include <linux/export.h>\n#include <linux/rcupdate.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/unistd.h>\n#include <linux/sched/smt.h>\n#include <linux/sched/task.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/signal.h>\n#include <linux/notifier.h>\n#include <linux/init.h>\n#include <linux/smp.h>\n#include <linux/proc_fs.h>\n#include <linux/sched/mm.h>\n\nstruct cpumask __cpu_present_mask;\n\nvoid init_cpu_present(const struct cpumask *src)\n{\n\tcpumask_copy(&__cpu_present_mask, src);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nvoid cpudl_set(struct cpudl *cp, int cpu, u64 dl)\n{\n\tint old_idx;\n\tunsigned long flags;\n\n\tWARN_ON(!cpu_present(cpu));\n\n\traw_spin_lock_irqsave(&cp->lock, flags);\n\n\told_idx = cp->elements[cpu].idx;\n\tif (old_idx == IDX_INVALID) {\n\t\tint new_idx = cp->size++;\n\n\t\tcp->elements[new_idx].dl = dl;\n\t\tcp->elements[new_idx].cpu = cpu;\n\t\tcp->elements[cpu].idx = new_idx;\n\t\tcpudl_heapify_up(cp, new_idx);\n\t\tcpumask_clear_cpu(cpu, cp->free_cpus);\n\t} else {\n\t\tcp->elements[old_idx].dl = dl;\n\t\tcpudl_heapify(cp, old_idx);\n\t}\n\n\traw_spin_unlock_irqrestore(&cp->lock, flags);\n}"
  },
  {
    "function_name": "cpudl_clear",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
    "lines": "174-202",
    "snippet": "void cpudl_clear(struct cpudl *cp, int cpu)\n{\n\tint old_idx, new_cpu;\n\tunsigned long flags;\n\n\tWARN_ON(!cpu_present(cpu));\n\n\traw_spin_lock_irqsave(&cp->lock, flags);\n\n\told_idx = cp->elements[cpu].idx;\n\tif (old_idx == IDX_INVALID) {\n\t\t/*\n\t\t * Nothing to remove if old_idx was invalid.\n\t\t * This could happen if a rq_offline_dl is\n\t\t * called for a CPU without -dl tasks running.\n\t\t */\n\t} else {\n\t\tnew_cpu = cp->elements[cp->size - 1].cpu;\n\t\tcp->elements[old_idx].dl = cp->elements[cp->size - 1].dl;\n\t\tcp->elements[old_idx].cpu = new_cpu;\n\t\tcp->size--;\n\t\tcp->elements[new_cpu].idx = old_idx;\n\t\tcp->elements[cpu].idx = IDX_INVALID;\n\t\tcpudl_heapify(cp, old_idx);\n\n\t\tcpumask_set_cpu(cpu, cp->free_cpus);\n\t}\n\traw_spin_unlock_irqrestore(&cp->lock, flags);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&cp->lock",
            "flags"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "cpu",
            "cp->free_cpus"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpudl_heapify",
          "args": [
            "cp",
            "old_idx"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "cpudl_heapify",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
          "lines": "95-102",
          "snippet": "static void cpudl_heapify(struct cpudl *cp, int idx)\n{\n\tif (idx > 0 && dl_time_before(cp->elements[parent(idx)].dl,\n\t\t\t\tcp->elements[idx].dl))\n\t\tcpudl_heapify_up(cp, idx);\n\telse\n\t\tcpudl_heapify_down(cp, idx);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic void cpudl_heapify(struct cpudl *cp, int idx)\n{\n\tif (idx > 0 && dl_time_before(cp->elements[parent(idx)].dl,\n\t\t\t\tcp->elements[idx].dl))\n\t\tcpudl_heapify_up(cp, idx);\n\telse\n\t\tcpudl_heapify_down(cp, idx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&cp->lock",
            "flags"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!cpu_present(cpu)"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_present",
          "args": [
            "cpu"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "init_cpu_present",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu.c",
          "lines": "2606-2609",
          "snippet": "void init_cpu_present(const struct cpumask *src)\n{\n\tcpumask_copy(&__cpu_present_mask, src);\n}",
          "includes": [
            "#include \"smpboot.h\"",
            "#include <trace/events/cpuhp.h>",
            "#include <trace/events/power.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/percpu-rwsem.h>",
            "#include <linux/scs.h>",
            "#include <linux/slab.h>",
            "#include <linux/relay.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/nmi.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/suspend.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mutex.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/kthread.h>",
            "#include <linux/bug.h>",
            "#include <linux/export.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/unistd.h>",
            "#include <linux/sched/smt.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/notifier.h>",
            "#include <linux/init.h>",
            "#include <linux/smp.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/sched/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct cpumask __cpu_present_mask"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"smpboot.h\"\n#include <trace/events/cpuhp.h>\n#include <trace/events/power.h>\n#include <linux/cpuset.h>\n#include <linux/percpu-rwsem.h>\n#include <linux/scs.h>\n#include <linux/slab.h>\n#include <linux/relay.h>\n#include <linux/smpboot.h>\n#include <linux/nmi.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/lockdep.h>\n#include <linux/suspend.h>\n#include <linux/gfp.h>\n#include <linux/mutex.h>\n#include <linux/stop_machine.h>\n#include <linux/kthread.h>\n#include <linux/bug.h>\n#include <linux/export.h>\n#include <linux/rcupdate.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/unistd.h>\n#include <linux/sched/smt.h>\n#include <linux/sched/task.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/signal.h>\n#include <linux/notifier.h>\n#include <linux/init.h>\n#include <linux/smp.h>\n#include <linux/proc_fs.h>\n#include <linux/sched/mm.h>\n\nstruct cpumask __cpu_present_mask;\n\nvoid init_cpu_present(const struct cpumask *src)\n{\n\tcpumask_copy(&__cpu_present_mask, src);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nvoid cpudl_clear(struct cpudl *cp, int cpu)\n{\n\tint old_idx, new_cpu;\n\tunsigned long flags;\n\n\tWARN_ON(!cpu_present(cpu));\n\n\traw_spin_lock_irqsave(&cp->lock, flags);\n\n\told_idx = cp->elements[cpu].idx;\n\tif (old_idx == IDX_INVALID) {\n\t\t/*\n\t\t * Nothing to remove if old_idx was invalid.\n\t\t * This could happen if a rq_offline_dl is\n\t\t * called for a CPU without -dl tasks running.\n\t\t */\n\t} else {\n\t\tnew_cpu = cp->elements[cp->size - 1].cpu;\n\t\tcp->elements[old_idx].dl = cp->elements[cp->size - 1].dl;\n\t\tcp->elements[old_idx].cpu = new_cpu;\n\t\tcp->size--;\n\t\tcp->elements[new_cpu].idx = old_idx;\n\t\tcp->elements[cpu].idx = IDX_INVALID;\n\t\tcpudl_heapify(cp, old_idx);\n\n\t\tcpumask_set_cpu(cpu, cp->free_cpus);\n\t}\n\traw_spin_unlock_irqrestore(&cp->lock, flags);\n}"
  },
  {
    "function_name": "cpudl_find",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
    "lines": "117-163",
    "snippet": "int cpudl_find(struct cpudl *cp, struct task_struct *p,\n\t       struct cpumask *later_mask)\n{\n\tconst struct sched_dl_entity *dl_se = &p->dl;\n\n\tif (later_mask &&\n\t    cpumask_and(later_mask, cp->free_cpus, &p->cpus_mask)) {\n\t\tunsigned long cap, max_cap = 0;\n\t\tint cpu, max_cpu = -1;\n\n\t\tif (!static_branch_unlikely(&sched_asym_cpucapacity))\n\t\t\treturn 1;\n\n\t\t/* Ensure the capacity of the CPUs fits the task. */\n\t\tfor_each_cpu(cpu, later_mask) {\n\t\t\tif (!dl_task_fits_capacity(p, cpu)) {\n\t\t\t\tcpumask_clear_cpu(cpu, later_mask);\n\n\t\t\t\tcap = capacity_orig_of(cpu);\n\n\t\t\t\tif (cap > max_cap ||\n\t\t\t\t    (cpu == task_cpu(p) && cap == max_cap)) {\n\t\t\t\t\tmax_cap = cap;\n\t\t\t\t\tmax_cpu = cpu;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (cpumask_empty(later_mask))\n\t\t\tcpumask_set_cpu(max_cpu, later_mask);\n\n\t\treturn 1;\n\t} else {\n\t\tint best_cpu = cpudl_maximum(cp);\n\n\t\tWARN_ON(best_cpu != -1 && !cpu_present(best_cpu));\n\n\t\tif (cpumask_test_cpu(best_cpu, &p->cpus_mask) &&\n\t\t    dl_time_before(dl_se->deadline, cp->elements[0].dl)) {\n\t\t\tif (later_mask)\n\t\t\t\tcpumask_set_cpu(best_cpu, later_mask);\n\n\t\t\treturn 1;\n\t\t}\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "best_cpu",
            "later_mask"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dl_time_before",
          "args": [
            "dl_se->deadline",
            "cp->elements[0].dl"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_test_cpu",
          "args": [
            "best_cpu",
            "&p->cpus_mask"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "best_cpu != -1 && !cpu_present(best_cpu)"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_present",
          "args": [
            "best_cpu"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "init_cpu_present",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu.c",
          "lines": "2606-2609",
          "snippet": "void init_cpu_present(const struct cpumask *src)\n{\n\tcpumask_copy(&__cpu_present_mask, src);\n}",
          "includes": [
            "#include \"smpboot.h\"",
            "#include <trace/events/cpuhp.h>",
            "#include <trace/events/power.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/percpu-rwsem.h>",
            "#include <linux/scs.h>",
            "#include <linux/slab.h>",
            "#include <linux/relay.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/nmi.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/suspend.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mutex.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/kthread.h>",
            "#include <linux/bug.h>",
            "#include <linux/export.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/unistd.h>",
            "#include <linux/sched/smt.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/notifier.h>",
            "#include <linux/init.h>",
            "#include <linux/smp.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/sched/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct cpumask __cpu_present_mask"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"smpboot.h\"\n#include <trace/events/cpuhp.h>\n#include <trace/events/power.h>\n#include <linux/cpuset.h>\n#include <linux/percpu-rwsem.h>\n#include <linux/scs.h>\n#include <linux/slab.h>\n#include <linux/relay.h>\n#include <linux/smpboot.h>\n#include <linux/nmi.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/lockdep.h>\n#include <linux/suspend.h>\n#include <linux/gfp.h>\n#include <linux/mutex.h>\n#include <linux/stop_machine.h>\n#include <linux/kthread.h>\n#include <linux/bug.h>\n#include <linux/export.h>\n#include <linux/rcupdate.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/unistd.h>\n#include <linux/sched/smt.h>\n#include <linux/sched/task.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/signal.h>\n#include <linux/notifier.h>\n#include <linux/init.h>\n#include <linux/smp.h>\n#include <linux/proc_fs.h>\n#include <linux/sched/mm.h>\n\nstruct cpumask __cpu_present_mask;\n\nvoid init_cpu_present(const struct cpumask *src)\n{\n\tcpumask_copy(&__cpu_present_mask, src);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpudl_maximum",
          "args": [
            "cp"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "cpudl_maximum",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
          "lines": "104-107",
          "snippet": "static inline int cpudl_maximum(struct cpudl *cp)\n{\n\treturn cp->elements[0].cpu;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic inline int cpudl_maximum(struct cpudl *cp)\n{\n\treturn cp->elements[0].cpu;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_set_cpu",
          "args": [
            "max_cpu",
            "later_mask"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_empty",
          "args": [
            "later_mask"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_cpu",
          "args": [
            "p"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "ignore_task_cpu",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/ftrace.c",
          "lines": "7612-7633",
          "snippet": "static void ignore_task_cpu(void *data)\n{\n\tstruct trace_array *tr = data;\n\tstruct trace_pid_list *pid_list;\n\tstruct trace_pid_list *no_pid_list;\n\n\t/*\n\t * This function is called by on_each_cpu() while the\n\t * event_mutex is held.\n\t */\n\tpid_list = rcu_dereference_protected(tr->function_pids,\n\t\t\t\t\t     mutex_is_locked(&ftrace_lock));\n\tno_pid_list = rcu_dereference_protected(tr->function_no_pids,\n\t\t\t\t\t\tmutex_is_locked(&ftrace_lock));\n\n\tif (trace_ignore_this_task(pid_list, no_pid_list, current))\n\t\tthis_cpu_write(tr->array_buffer.data->ftrace_ignore_pid,\n\t\t\t       FTRACE_PID_IGNORE);\n\telse\n\t\tthis_cpu_write(tr->array_buffer.data->ftrace_ignore_pid,\n\t\t\t       current->pid);\n}",
          "includes": [
            "#include \"trace_stat.h\"",
            "#include \"trace_output.h\"",
            "#include \"ftrace_internal.h\"",
            "#include <asm/setup.h>",
            "#include <asm/sections.h>",
            "#include <trace/events/sched.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/hash.h>",
            "#include <linux/list.h>",
            "#include <linux/sort.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/module.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/kthread.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/tracefs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/stop_machine.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_stat.h\"\n#include \"trace_output.h\"\n#include \"ftrace_internal.h\"\n#include <asm/setup.h>\n#include <asm/sections.h>\n#include <trace/events/sched.h>\n#include <linux/kprobes.h>\n#include <linux/rcupdate.h>\n#include <linux/hash.h>\n#include <linux/list.h>\n#include <linux/sort.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/sysctl.h>\n#include <linux/ftrace.h>\n#include <linux/module.h>\n#include <linux/bsearch.h>\n#include <linux/uaccess.h>\n#include <linux/kthread.h>\n#include <linux/hardirq.h>\n#include <linux/tracefs.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/kallsyms.h>\n#include <linux/sched/task.h>\n#include <linux/clocksource.h>\n#include <linux/stop_machine.h>\n\nstatic void ignore_task_cpu(void *data)\n{\n\tstruct trace_array *tr = data;\n\tstruct trace_pid_list *pid_list;\n\tstruct trace_pid_list *no_pid_list;\n\n\t/*\n\t * This function is called by on_each_cpu() while the\n\t * event_mutex is held.\n\t */\n\tpid_list = rcu_dereference_protected(tr->function_pids,\n\t\t\t\t\t     mutex_is_locked(&ftrace_lock));\n\tno_pid_list = rcu_dereference_protected(tr->function_no_pids,\n\t\t\t\t\t\tmutex_is_locked(&ftrace_lock));\n\n\tif (trace_ignore_this_task(pid_list, no_pid_list, current))\n\t\tthis_cpu_write(tr->array_buffer.data->ftrace_ignore_pid,\n\t\t\t       FTRACE_PID_IGNORE);\n\telse\n\t\tthis_cpu_write(tr->array_buffer.data->ftrace_ignore_pid,\n\t\t\t       current->pid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "capacity_orig_of",
          "args": [
            "cpu"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "capacity_orig_of",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/sched.h",
          "lines": "2935-2938",
          "snippet": "static inline unsigned long capacity_orig_of(int cpu)\n{\n\treturn cpu_rq(cpu)->cpu_capacity_orig;\n}",
          "includes": [
            "#include \"features.h\"",
            "#include \"features.h\"",
            "# include <linux/static_key.h>",
            "#include \"autogroup.h\"",
            "#include \"stats.h\"",
            "#include <linux/psi.h>",
            "#include <linux/cgroup.h>",
            "#include <trace/events/sched.h>",
            "#include \"cpudeadline.h\"",
            "#include \"cpupri.h\"",
            "# include <asm/paravirt.h>",
            "#include <asm/tlb.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/task_work.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swait.h>",
            "#include <linux/suspend.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/security.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/psi.h>",
            "#include <linux/profile.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/nmi.h>",
            "#include <linux/mmu_context.h>",
            "#include <linux/migrate.h>",
            "#include <linux/membarrier.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/init_task.h>",
            "#include <linux/energy_model.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ctype.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpufreq.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/compat.h>",
            "#include <linux/bitops.h>",
            "#include <linux/binfmts.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/sched/xacct.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/sysctl.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/smt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/prio.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/nohz.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched/jobctl.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/init.h>",
            "#include <linux/sched/idle.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/cpufreq.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern bool dl_cpu_busy(unsigned int cpu);",
            "extern void resched_cpu(int cpu);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include \"features.h\"\n# include <linux/static_key.h>\n#include \"autogroup.h\"\n#include \"stats.h\"\n#include <linux/psi.h>\n#include <linux/cgroup.h>\n#include <trace/events/sched.h>\n#include \"cpudeadline.h\"\n#include \"cpupri.h\"\n# include <asm/paravirt.h>\n#include <asm/tlb.h>\n#include <linux/tsacct_kern.h>\n#include <linux/task_work.h>\n#include <linux/syscalls.h>\n#include <linux/swait.h>\n#include <linux/suspend.h>\n#include <linux/stop_machine.h>\n#include <linux/security.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/ratelimit.h>\n#include <linux/psi.h>\n#include <linux/profile.h>\n#include <linux/prefetch.h>\n#include <linux/proc_fs.h>\n#include <linux/nmi.h>\n#include <linux/mmu_context.h>\n#include <linux/migrate.h>\n#include <linux/membarrier.h>\n#include <linux/kthread.h>\n#include <linux/kprobes.h>\n#include <linux/init_task.h>\n#include <linux/energy_model.h>\n#include <linux/delayacct.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/cpuset.h>\n#include <linux/cpuidle.h>\n#include <linux/cpufreq.h>\n#include <linux/context_tracking.h>\n#include <linux/compat.h>\n#include <linux/bitops.h>\n#include <linux/binfmts.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/sched/xacct.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/user.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/sysctl.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/smt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/prio.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/nohz.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/jobctl.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/init.h>\n#include <linux/sched/idle.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/cpufreq.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n\nextern bool dl_cpu_busy(unsigned int cpu);\nextern void resched_cpu(int cpu);\n\nstatic inline unsigned long capacity_orig_of(int cpu)\n{\n\treturn cpu_rq(cpu)->cpu_capacity_orig;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpumask_clear_cpu",
          "args": [
            "cpu",
            "later_mask"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dl_task_fits_capacity",
          "args": [
            "p",
            "cpu"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "dl_task_fits_capacity",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/sched.h",
          "lines": "335-340",
          "snippet": "static inline bool dl_task_fits_capacity(struct task_struct *p, int cpu)\n{\n\tunsigned long cap = arch_scale_cpu_capacity(cpu);\n\n\treturn cap_scale(p->dl.dl_deadline, cap) >= p->dl.dl_runtime;\n}",
          "includes": [
            "#include \"features.h\"",
            "#include \"features.h\"",
            "# include <linux/static_key.h>",
            "#include \"autogroup.h\"",
            "#include \"stats.h\"",
            "#include <linux/psi.h>",
            "#include <linux/cgroup.h>",
            "#include <trace/events/sched.h>",
            "#include \"cpudeadline.h\"",
            "#include \"cpupri.h\"",
            "# include <asm/paravirt.h>",
            "#include <asm/tlb.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/task_work.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swait.h>",
            "#include <linux/suspend.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/security.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/psi.h>",
            "#include <linux/profile.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/nmi.h>",
            "#include <linux/mmu_context.h>",
            "#include <linux/migrate.h>",
            "#include <linux/membarrier.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/init_task.h>",
            "#include <linux/energy_model.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ctype.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpufreq.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/compat.h>",
            "#include <linux/bitops.h>",
            "#include <linux/binfmts.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/sched/xacct.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/sysctl.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/smt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/prio.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/nohz.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched/jobctl.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/init.h>",
            "#include <linux/sched/idle.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/cpufreq.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void __dl_clear_params(struct task_struct *p);",
            "extern bool dl_cpu_busy(unsigned int cpu);",
            "extern void resched_cpu(int cpu);",
            "extern void post_init_entity_util_avg(struct task_struct *p);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include \"features.h\"\n# include <linux/static_key.h>\n#include \"autogroup.h\"\n#include \"stats.h\"\n#include <linux/psi.h>\n#include <linux/cgroup.h>\n#include <trace/events/sched.h>\n#include \"cpudeadline.h\"\n#include \"cpupri.h\"\n# include <asm/paravirt.h>\n#include <asm/tlb.h>\n#include <linux/tsacct_kern.h>\n#include <linux/task_work.h>\n#include <linux/syscalls.h>\n#include <linux/swait.h>\n#include <linux/suspend.h>\n#include <linux/stop_machine.h>\n#include <linux/security.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/ratelimit.h>\n#include <linux/psi.h>\n#include <linux/profile.h>\n#include <linux/prefetch.h>\n#include <linux/proc_fs.h>\n#include <linux/nmi.h>\n#include <linux/mmu_context.h>\n#include <linux/migrate.h>\n#include <linux/membarrier.h>\n#include <linux/kthread.h>\n#include <linux/kprobes.h>\n#include <linux/init_task.h>\n#include <linux/energy_model.h>\n#include <linux/delayacct.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/cpuset.h>\n#include <linux/cpuidle.h>\n#include <linux/cpufreq.h>\n#include <linux/context_tracking.h>\n#include <linux/compat.h>\n#include <linux/bitops.h>\n#include <linux/binfmts.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/sched/xacct.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/user.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/sysctl.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/smt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/prio.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/nohz.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/jobctl.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/init.h>\n#include <linux/sched/idle.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/cpufreq.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n\nvoid __dl_clear_params(struct task_struct *p);\nextern bool dl_cpu_busy(unsigned int cpu);\nextern void resched_cpu(int cpu);\nextern void post_init_entity_util_avg(struct task_struct *p);\n\nstatic inline bool dl_task_fits_capacity(struct task_struct *p, int cpu)\n{\n\tunsigned long cap = arch_scale_cpu_capacity(cpu);\n\n\treturn cap_scale(p->dl.dl_deadline, cap) >= p->dl.dl_runtime;\n}"
        }
      },
      {
        "call_info": {
          "callee": "for_each_cpu",
          "args": [
            "cpu",
            "later_mask"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_branch_unlikely",
          "args": [
            "&sched_asym_cpucapacity"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_and",
          "args": [
            "later_mask",
            "cp->free_cpus",
            "&p->cpus_mask"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nint cpudl_find(struct cpudl *cp, struct task_struct *p,\n\t       struct cpumask *later_mask)\n{\n\tconst struct sched_dl_entity *dl_se = &p->dl;\n\n\tif (later_mask &&\n\t    cpumask_and(later_mask, cp->free_cpus, &p->cpus_mask)) {\n\t\tunsigned long cap, max_cap = 0;\n\t\tint cpu, max_cpu = -1;\n\n\t\tif (!static_branch_unlikely(&sched_asym_cpucapacity))\n\t\t\treturn 1;\n\n\t\t/* Ensure the capacity of the CPUs fits the task. */\n\t\tfor_each_cpu(cpu, later_mask) {\n\t\t\tif (!dl_task_fits_capacity(p, cpu)) {\n\t\t\t\tcpumask_clear_cpu(cpu, later_mask);\n\n\t\t\t\tcap = capacity_orig_of(cpu);\n\n\t\t\t\tif (cap > max_cap ||\n\t\t\t\t    (cpu == task_cpu(p) && cap == max_cap)) {\n\t\t\t\t\tmax_cap = cap;\n\t\t\t\t\tmax_cpu = cpu;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (cpumask_empty(later_mask))\n\t\t\tcpumask_set_cpu(max_cpu, later_mask);\n\n\t\treturn 1;\n\t} else {\n\t\tint best_cpu = cpudl_maximum(cp);\n\n\t\tWARN_ON(best_cpu != -1 && !cpu_present(best_cpu));\n\n\t\tif (cpumask_test_cpu(best_cpu, &p->cpus_mask) &&\n\t\t    dl_time_before(dl_se->deadline, cp->elements[0].dl)) {\n\t\t\tif (later_mask)\n\t\t\t\tcpumask_set_cpu(best_cpu, later_mask);\n\n\t\t\treturn 1;\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "cpudl_maximum",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
    "lines": "104-107",
    "snippet": "static inline int cpudl_maximum(struct cpudl *cp)\n{\n\treturn cp->elements[0].cpu;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic inline int cpudl_maximum(struct cpudl *cp)\n{\n\treturn cp->elements[0].cpu;\n}"
  },
  {
    "function_name": "cpudl_heapify",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
    "lines": "95-102",
    "snippet": "static void cpudl_heapify(struct cpudl *cp, int idx)\n{\n\tif (idx > 0 && dl_time_before(cp->elements[parent(idx)].dl,\n\t\t\t\tcp->elements[idx].dl))\n\t\tcpudl_heapify_up(cp, idx);\n\telse\n\t\tcpudl_heapify_down(cp, idx);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpudl_heapify_down",
          "args": [
            "cp",
            "idx"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "cpudl_heapify_down",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
          "lines": "26-67",
          "snippet": "static void cpudl_heapify_down(struct cpudl *cp, int idx)\n{\n\tint l, r, largest;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (left_child(idx) >= cp->size)\n\t\treturn;\n\n\t/* adapted from lib/prio_heap.c */\n\twhile (1) {\n\t\tu64 largest_dl;\n\n\t\tl = left_child(idx);\n\t\tr = right_child(idx);\n\t\tlargest = idx;\n\t\tlargest_dl = orig_dl;\n\n\t\tif ((l < cp->size) && dl_time_before(orig_dl,\n\t\t\t\t\t\tcp->elements[l].dl)) {\n\t\t\tlargest = l;\n\t\t\tlargest_dl = cp->elements[l].dl;\n\t\t}\n\t\tif ((r < cp->size) && dl_time_before(largest_dl,\n\t\t\t\t\t\tcp->elements[r].dl))\n\t\t\tlargest = r;\n\n\t\tif (largest == idx)\n\t\t\tbreak;\n\n\t\t/* pull largest child onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[largest].cpu;\n\t\tcp->elements[idx].dl = cp->elements[largest].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = largest;\n\t}\n\t/* actual push down of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic void cpudl_heapify_down(struct cpudl *cp, int idx)\n{\n\tint l, r, largest;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (left_child(idx) >= cp->size)\n\t\treturn;\n\n\t/* adapted from lib/prio_heap.c */\n\twhile (1) {\n\t\tu64 largest_dl;\n\n\t\tl = left_child(idx);\n\t\tr = right_child(idx);\n\t\tlargest = idx;\n\t\tlargest_dl = orig_dl;\n\n\t\tif ((l < cp->size) && dl_time_before(orig_dl,\n\t\t\t\t\t\tcp->elements[l].dl)) {\n\t\t\tlargest = l;\n\t\t\tlargest_dl = cp->elements[l].dl;\n\t\t}\n\t\tif ((r < cp->size) && dl_time_before(largest_dl,\n\t\t\t\t\t\tcp->elements[r].dl))\n\t\t\tlargest = r;\n\n\t\tif (largest == idx)\n\t\t\tbreak;\n\n\t\t/* pull largest child onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[largest].cpu;\n\t\tcp->elements[idx].dl = cp->elements[largest].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = largest;\n\t}\n\t/* actual push down of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpudl_heapify_up",
          "args": [
            "cp",
            "idx"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "cpudl_heapify_up",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
          "lines": "69-93",
          "snippet": "static void cpudl_heapify_up(struct cpudl *cp, int idx)\n{\n\tint p;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (idx == 0)\n\t\treturn;\n\n\tdo {\n\t\tp = parent(idx);\n\t\tif (dl_time_before(orig_dl, cp->elements[p].dl))\n\t\t\tbreak;\n\t\t/* pull parent onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[p].cpu;\n\t\tcp->elements[idx].dl = cp->elements[p].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = p;\n\t} while (idx != 0);\n\t/* actual push up of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic void cpudl_heapify_up(struct cpudl *cp, int idx)\n{\n\tint p;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (idx == 0)\n\t\treturn;\n\n\tdo {\n\t\tp = parent(idx);\n\t\tif (dl_time_before(orig_dl, cp->elements[p].dl))\n\t\t\tbreak;\n\t\t/* pull parent onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[p].cpu;\n\t\tcp->elements[idx].dl = cp->elements[p].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = p;\n\t} while (idx != 0);\n\t/* actual push up of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dl_time_before",
          "args": [
            "cp->elements[parent(idx)].dl",
            "cp->elements[idx].dl"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parent",
          "args": [
            "idx"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "parent",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
          "lines": "11-14",
          "snippet": "static inline int parent(int i)\n{\n\treturn (i - 1) >> 1;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic inline int parent(int i)\n{\n\treturn (i - 1) >> 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic void cpudl_heapify(struct cpudl *cp, int idx)\n{\n\tif (idx > 0 && dl_time_before(cp->elements[parent(idx)].dl,\n\t\t\t\tcp->elements[idx].dl))\n\t\tcpudl_heapify_up(cp, idx);\n\telse\n\t\tcpudl_heapify_down(cp, idx);\n}"
  },
  {
    "function_name": "cpudl_heapify_up",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
    "lines": "69-93",
    "snippet": "static void cpudl_heapify_up(struct cpudl *cp, int idx)\n{\n\tint p;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (idx == 0)\n\t\treturn;\n\n\tdo {\n\t\tp = parent(idx);\n\t\tif (dl_time_before(orig_dl, cp->elements[p].dl))\n\t\t\tbreak;\n\t\t/* pull parent onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[p].cpu;\n\t\tcp->elements[idx].dl = cp->elements[p].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = p;\n\t} while (idx != 0);\n\t/* actual push up of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dl_time_before",
          "args": [
            "orig_dl",
            "cp->elements[p].dl"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parent",
          "args": [
            "idx"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "parent",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
          "lines": "11-14",
          "snippet": "static inline int parent(int i)\n{\n\treturn (i - 1) >> 1;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic inline int parent(int i)\n{\n\treturn (i - 1) >> 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic void cpudl_heapify_up(struct cpudl *cp, int idx)\n{\n\tint p;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (idx == 0)\n\t\treturn;\n\n\tdo {\n\t\tp = parent(idx);\n\t\tif (dl_time_before(orig_dl, cp->elements[p].dl))\n\t\t\tbreak;\n\t\t/* pull parent onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[p].cpu;\n\t\tcp->elements[idx].dl = cp->elements[p].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = p;\n\t} while (idx != 0);\n\t/* actual push up of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}"
  },
  {
    "function_name": "cpudl_heapify_down",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
    "lines": "26-67",
    "snippet": "static void cpudl_heapify_down(struct cpudl *cp, int idx)\n{\n\tint l, r, largest;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (left_child(idx) >= cp->size)\n\t\treturn;\n\n\t/* adapted from lib/prio_heap.c */\n\twhile (1) {\n\t\tu64 largest_dl;\n\n\t\tl = left_child(idx);\n\t\tr = right_child(idx);\n\t\tlargest = idx;\n\t\tlargest_dl = orig_dl;\n\n\t\tif ((l < cp->size) && dl_time_before(orig_dl,\n\t\t\t\t\t\tcp->elements[l].dl)) {\n\t\t\tlargest = l;\n\t\t\tlargest_dl = cp->elements[l].dl;\n\t\t}\n\t\tif ((r < cp->size) && dl_time_before(largest_dl,\n\t\t\t\t\t\tcp->elements[r].dl))\n\t\t\tlargest = r;\n\n\t\tif (largest == idx)\n\t\t\tbreak;\n\n\t\t/* pull largest child onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[largest].cpu;\n\t\tcp->elements[idx].dl = cp->elements[largest].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = largest;\n\t}\n\t/* actual push down of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dl_time_before",
          "args": [
            "largest_dl",
            "cp->elements[r].dl"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dl_time_before",
          "args": [
            "orig_dl",
            "cp->elements[l].dl"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "right_child",
          "args": [
            "idx"
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "right_child",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
          "lines": "21-24",
          "snippet": "static inline int right_child(int i)\n{\n\treturn (i << 1) + 2;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic inline int right_child(int i)\n{\n\treturn (i << 1) + 2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "left_child",
          "args": [
            "idx"
          ],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "left_child",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
          "lines": "16-19",
          "snippet": "static inline int left_child(int i)\n{\n\treturn (i << 1) + 1;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic inline int left_child(int i)\n{\n\treturn (i << 1) + 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic void cpudl_heapify_down(struct cpudl *cp, int idx)\n{\n\tint l, r, largest;\n\n\tint orig_cpu = cp->elements[idx].cpu;\n\tu64 orig_dl = cp->elements[idx].dl;\n\n\tif (left_child(idx) >= cp->size)\n\t\treturn;\n\n\t/* adapted from lib/prio_heap.c */\n\twhile (1) {\n\t\tu64 largest_dl;\n\n\t\tl = left_child(idx);\n\t\tr = right_child(idx);\n\t\tlargest = idx;\n\t\tlargest_dl = orig_dl;\n\n\t\tif ((l < cp->size) && dl_time_before(orig_dl,\n\t\t\t\t\t\tcp->elements[l].dl)) {\n\t\t\tlargest = l;\n\t\t\tlargest_dl = cp->elements[l].dl;\n\t\t}\n\t\tif ((r < cp->size) && dl_time_before(largest_dl,\n\t\t\t\t\t\tcp->elements[r].dl))\n\t\t\tlargest = r;\n\n\t\tif (largest == idx)\n\t\t\tbreak;\n\n\t\t/* pull largest child onto idx */\n\t\tcp->elements[idx].cpu = cp->elements[largest].cpu;\n\t\tcp->elements[idx].dl = cp->elements[largest].dl;\n\t\tcp->elements[cp->elements[idx].cpu].idx = idx;\n\t\tidx = largest;\n\t}\n\t/* actual push down of saved original values orig_* */\n\tcp->elements[idx].cpu = orig_cpu;\n\tcp->elements[idx].dl = orig_dl;\n\tcp->elements[cp->elements[idx].cpu].idx = idx;\n}"
  },
  {
    "function_name": "right_child",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
    "lines": "21-24",
    "snippet": "static inline int right_child(int i)\n{\n\treturn (i << 1) + 2;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic inline int right_child(int i)\n{\n\treturn (i << 1) + 2;\n}"
  },
  {
    "function_name": "left_child",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
    "lines": "16-19",
    "snippet": "static inline int left_child(int i)\n{\n\treturn (i << 1) + 1;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic inline int left_child(int i)\n{\n\treturn (i << 1) + 1;\n}"
  },
  {
    "function_name": "parent",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/cpudeadline.c",
    "lines": "11-14",
    "snippet": "static inline int parent(int i)\n{\n\treturn (i - 1) >> 1;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic inline int parent(int i)\n{\n\treturn (i - 1) >> 1;\n}"
  }
]