[
  {
    "function_name": "rmem_cma_setup",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
    "lines": "400-442",
    "snippet": "static int __init rmem_cma_setup(struct reserved_mem *rmem)\n{\n\tphys_addr_t align = PAGE_SIZE << max(MAX_ORDER - 1, pageblock_order);\n\tphys_addr_t mask = align - 1;\n\tunsigned long node = rmem->fdt_node;\n\tbool default_cma = of_get_flat_dt_prop(node, \"linux,cma-default\", NULL);\n\tstruct cma *cma;\n\tint err;\n\n\tif (size_cmdline != -1 && default_cma) {\n\t\tpr_info(\"Reserved memory: bypass %s node, using cmdline CMA params instead\\n\",\n\t\t\trmem->name);\n\t\treturn -EBUSY;\n\t}\n\n\tif (!of_get_flat_dt_prop(node, \"reusable\", NULL) ||\n\t    of_get_flat_dt_prop(node, \"no-map\", NULL))\n\t\treturn -EINVAL;\n\n\tif ((rmem->base & mask) || (rmem->size & mask)) {\n\t\tpr_err(\"Reserved memory: incorrect alignment of CMA region\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\terr = cma_init_reserved_mem(rmem->base, rmem->size, 0, rmem->name, &cma);\n\tif (err) {\n\t\tpr_err(\"Reserved memory: unable to setup CMA region\\n\");\n\t\treturn err;\n\t}\n\t/* Architecture specific contiguous memory fixup. */\n\tdma_contiguous_early_fixup(rmem->base, rmem->size);\n\n\tif (default_cma)\n\t\tdma_contiguous_default_area = cma;\n\n\trmem->ops = &rmem_cma_ops;\n\trmem->priv = cma;\n\n\tpr_info(\"Reserved memory: created CMA memory pool at %pa, size %ld MiB\\n\",\n\t\t&rmem->base, (unsigned long)rmem->size / SZ_1M);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/of_reserved_mem.h>",
      "#include <linux/of_fdt.h>",
      "#include <linux/of.h>",
      "#include <linux/cma.h>",
      "#include <linux/dma-map-ops.h>",
      "#include <linux/sizes.h>",
      "#include <linux/err.h>",
      "#include <linux/memblock.h>",
      "#include <asm/page.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct cma *dma_contiguous_default_area;",
      "static phys_addr_t  size_cmdline"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Reserved memory: created CMA memory pool at %pa, size %ld MiB\\n\"",
            "&rmem->base",
            "(unsigned long)rmem->size / SZ_1M"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dma_contiguous_early_fixup",
          "args": [
            "rmem->base",
            "rmem->size"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "dma_contiguous_early_fixup",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
          "lines": "205-208",
          "snippet": "void __weak\ndma_contiguous_early_fixup(phys_addr_t base, unsigned long size)\n{\n}",
          "includes": [
            "#include <linux/of_reserved_mem.h>",
            "#include <linux/of_fdt.h>",
            "#include <linux/of.h>",
            "#include <linux/cma.h>",
            "#include <linux/dma-map-ops.h>",
            "#include <linux/sizes.h>",
            "#include <linux/err.h>",
            "#include <linux/memblock.h>",
            "#include <asm/page.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\nvoid __weak\ndma_contiguous_early_fixup(phys_addr_t base, unsigned long size)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Reserved memory: unable to setup CMA region\\n\""
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cma_init_reserved_mem",
          "args": [
            "rmem->base",
            "rmem->size",
            "0",
            "rmem->name",
            "&cma"
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Reserved memory: incorrect alignment of CMA region\\n\""
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_prop",
          "args": [
            "node",
            "\"no-map\"",
            "NULL"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_prop",
          "args": [
            "node",
            "\"reusable\"",
            "NULL"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Reserved memory: bypass %s node, using cmdline CMA params instead\\n\"",
            "rmem->name"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "of_get_flat_dt_prop",
          "args": [
            "node",
            "\"linux,cma-default\"",
            "NULL"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "max",
          "args": [
            "MAX_ORDER - 1",
            "pageblock_order"
          ],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "module_extend_max_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/module_decompress.c",
          "lines": "17-32",
          "snippet": "static int module_extend_max_pages(struct load_info *info, unsigned int extent)\n{\n\tstruct page **new_pages;\n\n\tnew_pages = kvmalloc_array(info->max_pages + extent,\n\t\t\t\t   sizeof(info->pages), GFP_KERNEL);\n\tif (!new_pages)\n\t\treturn -ENOMEM;\n\n\tmemcpy(new_pages, info->pages, info->max_pages * sizeof(info->pages));\n\tkvfree(info->pages);\n\tinfo->pages = new_pages;\n\tinfo->max_pages += extent;\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/xz.h>",
            "#include <linux/zlib.h>",
            "#include \"module-internal.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/kobject.h>",
            "#include <linux/highmem.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/xz.h>\n#include <linux/zlib.h>\n#include \"module-internal.h\"\n#include <linux/vmalloc.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/kobject.h>\n#include <linux/highmem.h>\n#include <linux/init.h>\n\nstatic int module_extend_max_pages(struct load_info *info, unsigned int extent)\n{\n\tstruct page **new_pages;\n\n\tnew_pages = kvmalloc_array(info->max_pages + extent,\n\t\t\t\t   sizeof(info->pages), GFP_KERNEL);\n\tif (!new_pages)\n\t\treturn -ENOMEM;\n\n\tmemcpy(new_pages, info->pages, info->max_pages * sizeof(info->pages));\n\tkvfree(info->pages);\n\tinfo->pages = new_pages;\n\tinfo->max_pages += extent;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\nstruct cma *dma_contiguous_default_area;\nstatic phys_addr_t  size_cmdline;\n\nstatic int __init rmem_cma_setup(struct reserved_mem *rmem)\n{\n\tphys_addr_t align = PAGE_SIZE << max(MAX_ORDER - 1, pageblock_order);\n\tphys_addr_t mask = align - 1;\n\tunsigned long node = rmem->fdt_node;\n\tbool default_cma = of_get_flat_dt_prop(node, \"linux,cma-default\", NULL);\n\tstruct cma *cma;\n\tint err;\n\n\tif (size_cmdline != -1 && default_cma) {\n\t\tpr_info(\"Reserved memory: bypass %s node, using cmdline CMA params instead\\n\",\n\t\t\trmem->name);\n\t\treturn -EBUSY;\n\t}\n\n\tif (!of_get_flat_dt_prop(node, \"reusable\", NULL) ||\n\t    of_get_flat_dt_prop(node, \"no-map\", NULL))\n\t\treturn -EINVAL;\n\n\tif ((rmem->base & mask) || (rmem->size & mask)) {\n\t\tpr_err(\"Reserved memory: incorrect alignment of CMA region\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\terr = cma_init_reserved_mem(rmem->base, rmem->size, 0, rmem->name, &cma);\n\tif (err) {\n\t\tpr_err(\"Reserved memory: unable to setup CMA region\\n\");\n\t\treturn err;\n\t}\n\t/* Architecture specific contiguous memory fixup. */\n\tdma_contiguous_early_fixup(rmem->base, rmem->size);\n\n\tif (default_cma)\n\t\tdma_contiguous_default_area = cma;\n\n\trmem->ops = &rmem_cma_ops;\n\trmem->priv = cma;\n\n\tpr_info(\"Reserved memory: created CMA memory pool at %pa, size %ld MiB\\n\",\n\t\t&rmem->base, (unsigned long)rmem->size / SZ_1M);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "rmem_cma_device_release",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
    "lines": "389-393",
    "snippet": "static void rmem_cma_device_release(struct reserved_mem *rmem,\n\t\t\t\t    struct device *dev)\n{\n\tdev->cma_area = NULL;\n}",
    "includes": [
      "#include <linux/of_reserved_mem.h>",
      "#include <linux/of_fdt.h>",
      "#include <linux/of.h>",
      "#include <linux/cma.h>",
      "#include <linux/dma-map-ops.h>",
      "#include <linux/sizes.h>",
      "#include <linux/err.h>",
      "#include <linux/memblock.h>",
      "#include <asm/page.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\nstatic void rmem_cma_device_release(struct reserved_mem *rmem,\n\t\t\t\t    struct device *dev)\n{\n\tdev->cma_area = NULL;\n}"
  },
  {
    "function_name": "rmem_cma_device_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
    "lines": "383-387",
    "snippet": "static int rmem_cma_device_init(struct reserved_mem *rmem, struct device *dev)\n{\n\tdev->cma_area = rmem->priv;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/of_reserved_mem.h>",
      "#include <linux/of_fdt.h>",
      "#include <linux/of.h>",
      "#include <linux/cma.h>",
      "#include <linux/dma-map-ops.h>",
      "#include <linux/sizes.h>",
      "#include <linux/err.h>",
      "#include <linux/memblock.h>",
      "#include <asm/page.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\nstatic int rmem_cma_device_init(struct reserved_mem *rmem, struct device *dev)\n{\n\tdev->cma_area = rmem->priv;\n\treturn 0;\n}"
  },
  {
    "function_name": "dma_free_contiguous",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
    "lines": "347-370",
    "snippet": "void dma_free_contiguous(struct device *dev, struct page *page, size_t size)\n{\n\tunsigned int count = PAGE_ALIGN(size) >> PAGE_SHIFT;\n\n\t/* if dev has its own cma, free page from there */\n\tif (dev->cma_area) {\n\t\tif (cma_release(dev->cma_area, page, count))\n\t\t\treturn;\n\t} else {\n\t\t/*\n\t\t * otherwise, page is from either per-numa cma or default cma\n\t\t */\n#ifdef CONFIG_DMA_PERNUMA_CMA\n\t\tif (cma_release(dma_contiguous_pernuma_area[page_to_nid(page)],\n\t\t\t\t\tpage, count))\n\t\t\treturn;\n#endif\n\t\tif (cma_release(dma_contiguous_default_area, page, count))\n\t\t\treturn;\n\t}\n\n\t/* not in any cma, free from buddy */\n\t__free_pages(page, get_order(size));\n}",
    "includes": [
      "#include <linux/of_reserved_mem.h>",
      "#include <linux/of_fdt.h>",
      "#include <linux/of.h>",
      "#include <linux/cma.h>",
      "#include <linux/dma-map-ops.h>",
      "#include <linux/sizes.h>",
      "#include <linux/err.h>",
      "#include <linux/memblock.h>",
      "#include <asm/page.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct cma *dma_contiguous_default_area;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__free_pages",
          "args": [
            "page",
            "get_order(size)"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_order",
          "args": [
            "size"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cma_release",
          "args": [
            "dma_contiguous_default_area",
            "page",
            "count"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cma_release",
          "args": [
            "dma_contiguous_pernuma_area[page_to_nid(page)]",
            "page",
            "count"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_to_nid",
          "args": [
            "page"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cma_release",
          "args": [
            "dev->cma_area",
            "page",
            "count"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PAGE_ALIGN",
          "args": [
            "size"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\nstruct cma *dma_contiguous_default_area;\n\nvoid dma_free_contiguous(struct device *dev, struct page *page, size_t size)\n{\n\tunsigned int count = PAGE_ALIGN(size) >> PAGE_SHIFT;\n\n\t/* if dev has its own cma, free page from there */\n\tif (dev->cma_area) {\n\t\tif (cma_release(dev->cma_area, page, count))\n\t\t\treturn;\n\t} else {\n\t\t/*\n\t\t * otherwise, page is from either per-numa cma or default cma\n\t\t */\n#ifdef CONFIG_DMA_PERNUMA_CMA\n\t\tif (cma_release(dma_contiguous_pernuma_area[page_to_nid(page)],\n\t\t\t\t\tpage, count))\n\t\t\treturn;\n#endif\n\t\tif (cma_release(dma_contiguous_default_area, page, count))\n\t\t\treturn;\n\t}\n\n\t/* not in any cma, free from buddy */\n\t__free_pages(page, get_order(size));\n}"
  },
  {
    "function_name": "dma_alloc_contiguous",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
    "lines": "304-334",
    "snippet": "struct page *dma_alloc_contiguous(struct device *dev, size_t size, gfp_t gfp)\n{\n#ifdef CONFIG_DMA_PERNUMA_CMA\n\tint nid = dev_to_node(dev);\n#endif\n\n\t/* CMA can be used only in the context which permits sleeping */\n\tif (!gfpflags_allow_blocking(gfp))\n\t\treturn NULL;\n\tif (dev->cma_area)\n\t\treturn cma_alloc_aligned(dev->cma_area, size, gfp);\n\tif (size <= PAGE_SIZE)\n\t\treturn NULL;\n\n#ifdef CONFIG_DMA_PERNUMA_CMA\n\tif (nid != NUMA_NO_NODE && !(gfp & (GFP_DMA | GFP_DMA32))) {\n\t\tstruct cma *cma = dma_contiguous_pernuma_area[nid];\n\t\tstruct page *page;\n\n\t\tif (cma) {\n\t\t\tpage = cma_alloc_aligned(cma, size, gfp);\n\t\t\tif (page)\n\t\t\t\treturn page;\n\t\t}\n\t}\n#endif\n\tif (!dma_contiguous_default_area)\n\t\treturn NULL;\n\n\treturn cma_alloc_aligned(dma_contiguous_default_area, size, gfp);\n}",
    "includes": [
      "#include <linux/of_reserved_mem.h>",
      "#include <linux/of_fdt.h>",
      "#include <linux/of.h>",
      "#include <linux/cma.h>",
      "#include <linux/dma-map-ops.h>",
      "#include <linux/sizes.h>",
      "#include <linux/err.h>",
      "#include <linux/memblock.h>",
      "#include <asm/page.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct cma *dma_contiguous_default_area;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cma_alloc_aligned",
          "args": [
            "dma_contiguous_default_area",
            "size",
            "gfp"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "cma_alloc_aligned",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
          "lines": "282-287",
          "snippet": "static struct page *cma_alloc_aligned(struct cma *cma, size_t size, gfp_t gfp)\n{\n\tunsigned int align = min(get_order(size), CONFIG_CMA_ALIGNMENT);\n\n\treturn cma_alloc(cma, size >> PAGE_SHIFT, align, gfp & __GFP_NOWARN);\n}",
          "includes": [
            "#include <linux/of_reserved_mem.h>",
            "#include <linux/of_fdt.h>",
            "#include <linux/of.h>",
            "#include <linux/cma.h>",
            "#include <linux/dma-map-ops.h>",
            "#include <linux/sizes.h>",
            "#include <linux/err.h>",
            "#include <linux/memblock.h>",
            "#include <asm/page.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\nstatic struct page *cma_alloc_aligned(struct cma *cma, size_t size, gfp_t gfp)\n{\n\tunsigned int align = min(get_order(size), CONFIG_CMA_ALIGNMENT);\n\n\treturn cma_alloc(cma, size >> PAGE_SHIFT, align, gfp & __GFP_NOWARN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gfpflags_allow_blocking",
          "args": [
            "gfp"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev_to_node",
          "args": [
            "dev"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\nstruct cma *dma_contiguous_default_area;\n\nstruct page *dma_alloc_contiguous(struct device *dev, size_t size, gfp_t gfp)\n{\n#ifdef CONFIG_DMA_PERNUMA_CMA\n\tint nid = dev_to_node(dev);\n#endif\n\n\t/* CMA can be used only in the context which permits sleeping */\n\tif (!gfpflags_allow_blocking(gfp))\n\t\treturn NULL;\n\tif (dev->cma_area)\n\t\treturn cma_alloc_aligned(dev->cma_area, size, gfp);\n\tif (size <= PAGE_SIZE)\n\t\treturn NULL;\n\n#ifdef CONFIG_DMA_PERNUMA_CMA\n\tif (nid != NUMA_NO_NODE && !(gfp & (GFP_DMA | GFP_DMA32))) {\n\t\tstruct cma *cma = dma_contiguous_pernuma_area[nid];\n\t\tstruct page *page;\n\n\t\tif (cma) {\n\t\t\tpage = cma_alloc_aligned(cma, size, gfp);\n\t\t\tif (page)\n\t\t\t\treturn page;\n\t\t}\n\t}\n#endif\n\tif (!dma_contiguous_default_area)\n\t\treturn NULL;\n\n\treturn cma_alloc_aligned(dma_contiguous_default_area, size, gfp);\n}"
  },
  {
    "function_name": "cma_alloc_aligned",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
    "lines": "282-287",
    "snippet": "static struct page *cma_alloc_aligned(struct cma *cma, size_t size, gfp_t gfp)\n{\n\tunsigned int align = min(get_order(size), CONFIG_CMA_ALIGNMENT);\n\n\treturn cma_alloc(cma, size >> PAGE_SHIFT, align, gfp & __GFP_NOWARN);\n}",
    "includes": [
      "#include <linux/of_reserved_mem.h>",
      "#include <linux/of_fdt.h>",
      "#include <linux/of.h>",
      "#include <linux/cma.h>",
      "#include <linux/dma-map-ops.h>",
      "#include <linux/sizes.h>",
      "#include <linux/err.h>",
      "#include <linux/memblock.h>",
      "#include <asm/page.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cma_alloc",
          "args": [
            "cma",
            "size >> PAGE_SHIFT",
            "align",
            "gfp & __GFP_NOWARN"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "get_order(size)",
            "CONFIG_CMA_ALIGNMENT"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "irq_setup_timings",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/internals.h",
          "lines": "388-389",
          "snippet": "static inline void irq_setup_timings(struct irq_desc *desc,\n\t\t\t\t     struct irqaction *act) {}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include \"settings.h\"",
            "#include \"debug.h\"",
            "#include <linux/sched/clock.h>",
            "#include <linux/pm_runtime.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/irqdesc.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void __disable_irq(struct irq_desc *desc);",
            "extern void __enable_irq(struct irq_desc *desc);",
            "extern int irq_activate(struct irq_desc *desc);",
            "extern void irq_shutdown(struct irq_desc *desc);",
            "extern void irq_shutdown_and_deactivate(struct irq_desc *desc);",
            "extern void irq_enable(struct irq_desc *desc);",
            "extern void irq_disable(struct irq_desc *desc);",
            "extern void mask_irq(struct irq_desc *desc);",
            "extern void unmask_irq(struct irq_desc *desc);",
            "extern void unmask_threaded_irq(struct irq_desc *desc);",
            "irqreturn_t __handle_irq_event_percpu(struct irq_desc *desc);",
            "irqreturn_t handle_irq_event_percpu(struct irq_desc *desc);",
            "irqreturn_t handle_irq_event(struct irq_desc *desc);",
            "bool irq_wait_for_poll(struct irq_desc *desc);",
            "extern void irq_set_thread_affinity(struct irq_desc *desc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include \"settings.h\"\n#include \"debug.h\"\n#include <linux/sched/clock.h>\n#include <linux/pm_runtime.h>\n#include <linux/kernel_stat.h>\n#include <linux/irqdesc.h>\n\nextern void __disable_irq(struct irq_desc *desc);\nextern void __enable_irq(struct irq_desc *desc);\nextern int irq_activate(struct irq_desc *desc);\nextern void irq_shutdown(struct irq_desc *desc);\nextern void irq_shutdown_and_deactivate(struct irq_desc *desc);\nextern void irq_enable(struct irq_desc *desc);\nextern void irq_disable(struct irq_desc *desc);\nextern void mask_irq(struct irq_desc *desc);\nextern void unmask_irq(struct irq_desc *desc);\nextern void unmask_threaded_irq(struct irq_desc *desc);\nirqreturn_t __handle_irq_event_percpu(struct irq_desc *desc);\nirqreturn_t handle_irq_event_percpu(struct irq_desc *desc);\nirqreturn_t handle_irq_event(struct irq_desc *desc);\nbool irq_wait_for_poll(struct irq_desc *desc);\nextern void irq_set_thread_affinity(struct irq_desc *desc);\n\nstatic inline void irq_setup_timings(struct irq_desc *desc,\n\t\t\t\t     struct irqaction *act) {}"
        }
      },
      {
        "call_info": {
          "callee": "get_order",
          "args": [
            "size"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\nstatic struct page *cma_alloc_aligned(struct cma *cma, size_t size, gfp_t gfp)\n{\n\tunsigned int align = min(get_order(size), CONFIG_CMA_ALIGNMENT);\n\n\treturn cma_alloc(cma, size >> PAGE_SHIFT, align, gfp & __GFP_NOWARN);\n}"
  },
  {
    "function_name": "dma_release_from_contiguous",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
    "lines": "276-280",
    "snippet": "bool dma_release_from_contiguous(struct device *dev, struct page *pages,\n\t\t\t\t int count)\n{\n\treturn cma_release(dev_get_cma_area(dev), pages, count);\n}",
    "includes": [
      "#include <linux/of_reserved_mem.h>",
      "#include <linux/of_fdt.h>",
      "#include <linux/of.h>",
      "#include <linux/cma.h>",
      "#include <linux/dma-map-ops.h>",
      "#include <linux/sizes.h>",
      "#include <linux/err.h>",
      "#include <linux/memblock.h>",
      "#include <asm/page.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cma_release",
          "args": [
            "dev_get_cma_area(dev)",
            "pages",
            "count"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev_get_cma_area",
          "args": [
            "dev"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\nbool dma_release_from_contiguous(struct device *dev, struct page *pages,\n\t\t\t\t int count)\n{\n\treturn cma_release(dev_get_cma_area(dev), pages, count);\n}"
  },
  {
    "function_name": "dma_alloc_from_contiguous",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
    "lines": "257-264",
    "snippet": "struct page *dma_alloc_from_contiguous(struct device *dev, size_t count,\n\t\t\t\t       unsigned int align, bool no_warn)\n{\n\tif (align > CONFIG_CMA_ALIGNMENT)\n\t\talign = CONFIG_CMA_ALIGNMENT;\n\n\treturn cma_alloc(dev_get_cma_area(dev), count, align, no_warn);\n}",
    "includes": [
      "#include <linux/of_reserved_mem.h>",
      "#include <linux/of_fdt.h>",
      "#include <linux/of.h>",
      "#include <linux/cma.h>",
      "#include <linux/dma-map-ops.h>",
      "#include <linux/sizes.h>",
      "#include <linux/err.h>",
      "#include <linux/memblock.h>",
      "#include <asm/page.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cma_alloc",
          "args": [
            "dev_get_cma_area(dev)",
            "count",
            "align",
            "no_warn"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev_get_cma_area",
          "args": [
            "dev"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\nstruct page *dma_alloc_from_contiguous(struct device *dev, size_t count,\n\t\t\t\t       unsigned int align, bool no_warn)\n{\n\tif (align > CONFIG_CMA_ALIGNMENT)\n\t\talign = CONFIG_CMA_ALIGNMENT;\n\n\treturn cma_alloc(dev_get_cma_area(dev), count, align, no_warn);\n}"
  },
  {
    "function_name": "dma_contiguous_reserve_area",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
    "lines": "227-243",
    "snippet": "int __init dma_contiguous_reserve_area(phys_addr_t size, phys_addr_t base,\n\t\t\t\t       phys_addr_t limit, struct cma **res_cma,\n\t\t\t\t       bool fixed)\n{\n\tint ret;\n\n\tret = cma_declare_contiguous(base, size, limit, 0, 0, fixed,\n\t\t\t\t\t\"reserved\", res_cma);\n\tif (ret)\n\t\treturn ret;\n\n\t/* Architecture specific contiguous memory fixup. */\n\tdma_contiguous_early_fixup(cma_get_base(*res_cma),\n\t\t\t\tcma_get_size(*res_cma));\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/of_reserved_mem.h>",
      "#include <linux/of_fdt.h>",
      "#include <linux/of.h>",
      "#include <linux/cma.h>",
      "#include <linux/dma-map-ops.h>",
      "#include <linux/sizes.h>",
      "#include <linux/err.h>",
      "#include <linux/memblock.h>",
      "#include <asm/page.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dma_contiguous_early_fixup",
          "args": [
            "cma_get_base(*res_cma)",
            "cma_get_size(*res_cma)"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "dma_contiguous_early_fixup",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
          "lines": "205-208",
          "snippet": "void __weak\ndma_contiguous_early_fixup(phys_addr_t base, unsigned long size)\n{\n}",
          "includes": [
            "#include <linux/of_reserved_mem.h>",
            "#include <linux/of_fdt.h>",
            "#include <linux/of.h>",
            "#include <linux/cma.h>",
            "#include <linux/dma-map-ops.h>",
            "#include <linux/sizes.h>",
            "#include <linux/err.h>",
            "#include <linux/memblock.h>",
            "#include <asm/page.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\nvoid __weak\ndma_contiguous_early_fixup(phys_addr_t base, unsigned long size)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "cma_get_size",
          "args": [
            "*res_cma"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cma_get_base",
          "args": [
            "*res_cma"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cma_declare_contiguous",
          "args": [
            "base",
            "size",
            "limit",
            "0",
            "0",
            "fixed",
            "\"reserved\"",
            "res_cma"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\nint __init dma_contiguous_reserve_area(phys_addr_t size, phys_addr_t base,\n\t\t\t\t       phys_addr_t limit, struct cma **res_cma,\n\t\t\t\t       bool fixed)\n{\n\tint ret;\n\n\tret = cma_declare_contiguous(base, size, limit, 0, 0, fixed,\n\t\t\t\t\t\"reserved\", res_cma);\n\tif (ret)\n\t\treturn ret;\n\n\t/* Architecture specific contiguous memory fixup. */\n\tdma_contiguous_early_fixup(cma_get_base(*res_cma),\n\t\t\t\tcma_get_size(*res_cma));\n\n\treturn 0;\n}"
  },
  {
    "function_name": "dma_contiguous_early_fixup",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
    "lines": "205-208",
    "snippet": "void __weak\ndma_contiguous_early_fixup(phys_addr_t base, unsigned long size)\n{\n}",
    "includes": [
      "#include <linux/of_reserved_mem.h>",
      "#include <linux/of_fdt.h>",
      "#include <linux/of.h>",
      "#include <linux/cma.h>",
      "#include <linux/dma-map-ops.h>",
      "#include <linux/sizes.h>",
      "#include <linux/err.h>",
      "#include <linux/memblock.h>",
      "#include <asm/page.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\nvoid __weak\ndma_contiguous_early_fixup(phys_addr_t base, unsigned long size)\n{\n}"
  },
  {
    "function_name": "dma_contiguous_reserve",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
    "lines": "167-203",
    "snippet": "void __init dma_contiguous_reserve(phys_addr_t limit)\n{\n\tphys_addr_t selected_size = 0;\n\tphys_addr_t selected_base = 0;\n\tphys_addr_t selected_limit = limit;\n\tbool fixed = false;\n\n\tpr_debug(\"%s(limit %08lx)\\n\", __func__, (unsigned long)limit);\n\n\tif (size_cmdline != -1) {\n\t\tselected_size = size_cmdline;\n\t\tselected_base = base_cmdline;\n\t\tselected_limit = min_not_zero(limit_cmdline, limit);\n\t\tif (base_cmdline + size_cmdline == limit_cmdline)\n\t\t\tfixed = true;\n\t} else {\n#ifdef CONFIG_CMA_SIZE_SEL_MBYTES\n\t\tselected_size = size_bytes;\n#elif defined(CONFIG_CMA_SIZE_SEL_PERCENTAGE)\n\t\tselected_size = cma_early_percent_memory();\n#elif defined(CONFIG_CMA_SIZE_SEL_MIN)\n\t\tselected_size = min(size_bytes, cma_early_percent_memory());\n#elif defined(CONFIG_CMA_SIZE_SEL_MAX)\n\t\tselected_size = max(size_bytes, cma_early_percent_memory());\n#endif\n\t}\n\n\tif (selected_size && !dma_contiguous_default_area) {\n\t\tpr_debug(\"%s: reserving %ld MiB for global area\\n\", __func__,\n\t\t\t (unsigned long)selected_size / SZ_1M);\n\n\t\tdma_contiguous_reserve_area(selected_size, selected_base,\n\t\t\t\t\t    selected_limit,\n\t\t\t\t\t    &dma_contiguous_default_area,\n\t\t\t\t\t    fixed);\n\t}\n}",
    "includes": [
      "#include <linux/of_reserved_mem.h>",
      "#include <linux/of_fdt.h>",
      "#include <linux/of.h>",
      "#include <linux/cma.h>",
      "#include <linux/dma-map-ops.h>",
      "#include <linux/sizes.h>",
      "#include <linux/err.h>",
      "#include <linux/memblock.h>",
      "#include <asm/page.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct cma *dma_contiguous_default_area;",
      "static const phys_addr_t size_bytes",
      "static phys_addr_t  size_cmdline",
      "static phys_addr_t base_cmdline",
      "static phys_addr_t limit_cmdline"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dma_contiguous_reserve_area",
          "args": [
            "selected_size",
            "selected_base",
            "selected_limit",
            "&dma_contiguous_default_area",
            "fixed"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "dma_contiguous_reserve_area",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
          "lines": "227-243",
          "snippet": "int __init dma_contiguous_reserve_area(phys_addr_t size, phys_addr_t base,\n\t\t\t\t       phys_addr_t limit, struct cma **res_cma,\n\t\t\t\t       bool fixed)\n{\n\tint ret;\n\n\tret = cma_declare_contiguous(base, size, limit, 0, 0, fixed,\n\t\t\t\t\t\"reserved\", res_cma);\n\tif (ret)\n\t\treturn ret;\n\n\t/* Architecture specific contiguous memory fixup. */\n\tdma_contiguous_early_fixup(cma_get_base(*res_cma),\n\t\t\t\tcma_get_size(*res_cma));\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/of_reserved_mem.h>",
            "#include <linux/of_fdt.h>",
            "#include <linux/of.h>",
            "#include <linux/cma.h>",
            "#include <linux/dma-map-ops.h>",
            "#include <linux/sizes.h>",
            "#include <linux/err.h>",
            "#include <linux/memblock.h>",
            "#include <asm/page.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\nint __init dma_contiguous_reserve_area(phys_addr_t size, phys_addr_t base,\n\t\t\t\t       phys_addr_t limit, struct cma **res_cma,\n\t\t\t\t       bool fixed)\n{\n\tint ret;\n\n\tret = cma_declare_contiguous(base, size, limit, 0, 0, fixed,\n\t\t\t\t\t\"reserved\", res_cma);\n\tif (ret)\n\t\treturn ret;\n\n\t/* Architecture specific contiguous memory fixup. */\n\tdma_contiguous_early_fixup(cma_get_base(*res_cma),\n\t\t\t\tcma_get_size(*res_cma));\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"%s: reserving %ld MiB for global area\\n\"",
            "__func__",
            "(unsigned long)selected_size / SZ_1M"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "max",
          "args": [
            "size_bytes",
            "cma_early_percent_memory()"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "module_extend_max_pages",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/module_decompress.c",
          "lines": "17-32",
          "snippet": "static int module_extend_max_pages(struct load_info *info, unsigned int extent)\n{\n\tstruct page **new_pages;\n\n\tnew_pages = kvmalloc_array(info->max_pages + extent,\n\t\t\t\t   sizeof(info->pages), GFP_KERNEL);\n\tif (!new_pages)\n\t\treturn -ENOMEM;\n\n\tmemcpy(new_pages, info->pages, info->max_pages * sizeof(info->pages));\n\tkvfree(info->pages);\n\tinfo->pages = new_pages;\n\tinfo->max_pages += extent;\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/xz.h>",
            "#include <linux/zlib.h>",
            "#include \"module-internal.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/kobject.h>",
            "#include <linux/highmem.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/xz.h>\n#include <linux/zlib.h>\n#include \"module-internal.h\"\n#include <linux/vmalloc.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/kobject.h>\n#include <linux/highmem.h>\n#include <linux/init.h>\n\nstatic int module_extend_max_pages(struct load_info *info, unsigned int extent)\n{\n\tstruct page **new_pages;\n\n\tnew_pages = kvmalloc_array(info->max_pages + extent,\n\t\t\t\t   sizeof(info->pages), GFP_KERNEL);\n\tif (!new_pages)\n\t\treturn -ENOMEM;\n\n\tmemcpy(new_pages, info->pages, info->max_pages * sizeof(info->pages));\n\tkvfree(info->pages);\n\tinfo->pages = new_pages;\n\tinfo->max_pages += extent;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cma_early_percent_memory",
          "args": [],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "cma_early_percent_memory",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
          "lines": "114-119",
          "snippet": "__maybe_unused cma_early_percent_memory(void)\n{\n\tunsigned long total_pages = PHYS_PFN(memblock_phys_mem_size());\n\n\treturn (total_pages * CONFIG_CMA_SIZE_PERCENTAGE / 100) << PAGE_SHIFT;\n}",
          "includes": [
            "#include <linux/of_reserved_mem.h>",
            "#include <linux/of_fdt.h>",
            "#include <linux/of.h>",
            "#include <linux/cma.h>",
            "#include <linux/dma-map-ops.h>",
            "#include <linux/sizes.h>",
            "#include <linux/err.h>",
            "#include <linux/memblock.h>",
            "#include <asm/page.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\n__maybe_unused cma_early_percent_memory(void)\n{\n\tunsigned long total_pages = PHYS_PFN(memblock_phys_mem_size());\n\n\treturn (total_pages * CONFIG_CMA_SIZE_PERCENTAGE / 100) << PAGE_SHIFT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "size_bytes",
            "cma_early_percent_memory()"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "irq_setup_timings",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/internals.h",
          "lines": "388-389",
          "snippet": "static inline void irq_setup_timings(struct irq_desc *desc,\n\t\t\t\t     struct irqaction *act) {}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include \"settings.h\"",
            "#include \"debug.h\"",
            "#include <linux/sched/clock.h>",
            "#include <linux/pm_runtime.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/irqdesc.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void __disable_irq(struct irq_desc *desc);",
            "extern void __enable_irq(struct irq_desc *desc);",
            "extern int irq_activate(struct irq_desc *desc);",
            "extern void irq_shutdown(struct irq_desc *desc);",
            "extern void irq_shutdown_and_deactivate(struct irq_desc *desc);",
            "extern void irq_enable(struct irq_desc *desc);",
            "extern void irq_disable(struct irq_desc *desc);",
            "extern void mask_irq(struct irq_desc *desc);",
            "extern void unmask_irq(struct irq_desc *desc);",
            "extern void unmask_threaded_irq(struct irq_desc *desc);",
            "irqreturn_t __handle_irq_event_percpu(struct irq_desc *desc);",
            "irqreturn_t handle_irq_event_percpu(struct irq_desc *desc);",
            "irqreturn_t handle_irq_event(struct irq_desc *desc);",
            "bool irq_wait_for_poll(struct irq_desc *desc);",
            "extern void irq_set_thread_affinity(struct irq_desc *desc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include \"settings.h\"\n#include \"debug.h\"\n#include <linux/sched/clock.h>\n#include <linux/pm_runtime.h>\n#include <linux/kernel_stat.h>\n#include <linux/irqdesc.h>\n\nextern void __disable_irq(struct irq_desc *desc);\nextern void __enable_irq(struct irq_desc *desc);\nextern int irq_activate(struct irq_desc *desc);\nextern void irq_shutdown(struct irq_desc *desc);\nextern void irq_shutdown_and_deactivate(struct irq_desc *desc);\nextern void irq_enable(struct irq_desc *desc);\nextern void irq_disable(struct irq_desc *desc);\nextern void mask_irq(struct irq_desc *desc);\nextern void unmask_irq(struct irq_desc *desc);\nextern void unmask_threaded_irq(struct irq_desc *desc);\nirqreturn_t __handle_irq_event_percpu(struct irq_desc *desc);\nirqreturn_t handle_irq_event_percpu(struct irq_desc *desc);\nirqreturn_t handle_irq_event(struct irq_desc *desc);\nbool irq_wait_for_poll(struct irq_desc *desc);\nextern void irq_set_thread_affinity(struct irq_desc *desc);\n\nstatic inline void irq_setup_timings(struct irq_desc *desc,\n\t\t\t\t     struct irqaction *act) {}"
        }
      },
      {
        "call_info": {
          "callee": "min_not_zero",
          "args": [
            "limit_cmdline",
            "limit"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"%s(limit %08lx)\\n\"",
            "__func__",
            "(unsigned long)limit"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\nstruct cma *dma_contiguous_default_area;\nstatic const phys_addr_t size_bytes;\nstatic phys_addr_t  size_cmdline;\nstatic phys_addr_t base_cmdline;\nstatic phys_addr_t limit_cmdline;\n\nvoid __init dma_contiguous_reserve(phys_addr_t limit)\n{\n\tphys_addr_t selected_size = 0;\n\tphys_addr_t selected_base = 0;\n\tphys_addr_t selected_limit = limit;\n\tbool fixed = false;\n\n\tpr_debug(\"%s(limit %08lx)\\n\", __func__, (unsigned long)limit);\n\n\tif (size_cmdline != -1) {\n\t\tselected_size = size_cmdline;\n\t\tselected_base = base_cmdline;\n\t\tselected_limit = min_not_zero(limit_cmdline, limit);\n\t\tif (base_cmdline + size_cmdline == limit_cmdline)\n\t\t\tfixed = true;\n\t} else {\n#ifdef CONFIG_CMA_SIZE_SEL_MBYTES\n\t\tselected_size = size_bytes;\n#elif defined(CONFIG_CMA_SIZE_SEL_PERCENTAGE)\n\t\tselected_size = cma_early_percent_memory();\n#elif defined(CONFIG_CMA_SIZE_SEL_MIN)\n\t\tselected_size = min(size_bytes, cma_early_percent_memory());\n#elif defined(CONFIG_CMA_SIZE_SEL_MAX)\n\t\tselected_size = max(size_bytes, cma_early_percent_memory());\n#endif\n\t}\n\n\tif (selected_size && !dma_contiguous_default_area) {\n\t\tpr_debug(\"%s: reserving %ld MiB for global area\\n\", __func__,\n\t\t\t (unsigned long)selected_size / SZ_1M);\n\n\t\tdma_contiguous_reserve_area(selected_size, selected_base,\n\t\t\t\t\t    selected_limit,\n\t\t\t\t\t    &dma_contiguous_default_area,\n\t\t\t\t\t    fixed);\n\t}\n}"
  },
  {
    "function_name": "dma_pernuma_cma_reserve",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
    "lines": "131-155",
    "snippet": "void __init dma_pernuma_cma_reserve(void)\n{\n\tint nid;\n\n\tif (!pernuma_size_bytes)\n\t\treturn;\n\n\tfor_each_online_node(nid) {\n\t\tint ret;\n\t\tchar name[CMA_MAX_NAME];\n\t\tstruct cma **cma = &dma_contiguous_pernuma_area[nid];\n\n\t\tsnprintf(name, sizeof(name), \"pernuma%d\", nid);\n\t\tret = cma_declare_contiguous_nid(0, pernuma_size_bytes, 0, 0,\n\t\t\t\t\t\t 0, false, name, cma, nid);\n\t\tif (ret) {\n\t\t\tpr_warn(\"%s: reservation failed: err %d, node %d\", __func__,\n\t\t\t\tret, nid);\n\t\t\tcontinue;\n\t\t}\n\n\t\tpr_debug(\"%s: reserved %llu MiB on node %d\\n\", __func__,\n\t\t\t(unsigned long long)pernuma_size_bytes / SZ_1M, nid);\n\t}\n}",
    "includes": [
      "#include <linux/of_reserved_mem.h>",
      "#include <linux/of_fdt.h>",
      "#include <linux/of.h>",
      "#include <linux/cma.h>",
      "#include <linux/dma-map-ops.h>",
      "#include <linux/sizes.h>",
      "#include <linux/err.h>",
      "#include <linux/memblock.h>",
      "#include <asm/page.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"%s: reserved %llu MiB on node %d\\n\"",
            "__func__",
            "(unsigned long long)pernuma_size_bytes / SZ_1M",
            "nid"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: reservation failed: err %d, node %d\"",
            "__func__",
            "ret",
            "nid"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cma_declare_contiguous_nid",
          "args": [
            "0",
            "pernuma_size_bytes",
            "0",
            "0",
            "0",
            "false",
            "name",
            "cma",
            "nid"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "name",
            "sizeof(name)",
            "\"pernuma%d\"",
            "nid"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\nvoid __init dma_pernuma_cma_reserve(void)\n{\n\tint nid;\n\n\tif (!pernuma_size_bytes)\n\t\treturn;\n\n\tfor_each_online_node(nid) {\n\t\tint ret;\n\t\tchar name[CMA_MAX_NAME];\n\t\tstruct cma **cma = &dma_contiguous_pernuma_area[nid];\n\n\t\tsnprintf(name, sizeof(name), \"pernuma%d\", nid);\n\t\tret = cma_declare_contiguous_nid(0, pernuma_size_bytes, 0, 0,\n\t\t\t\t\t\t 0, false, name, cma, nid);\n\t\tif (ret) {\n\t\t\tpr_warn(\"%s: reservation failed: err %d, node %d\", __func__,\n\t\t\t\tret, nid);\n\t\t\tcontinue;\n\t\t}\n\n\t\tpr_debug(\"%s: reserved %llu MiB on node %d\\n\", __func__,\n\t\t\t(unsigned long long)pernuma_size_bytes / SZ_1M, nid);\n\t}\n}"
  },
  {
    "function_name": "cma_early_percent_memory",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
    "lines": "114-119",
    "snippet": "__maybe_unused cma_early_percent_memory(void)\n{\n\tunsigned long total_pages = PHYS_PFN(memblock_phys_mem_size());\n\n\treturn (total_pages * CONFIG_CMA_SIZE_PERCENTAGE / 100) << PAGE_SHIFT;\n}",
    "includes": [
      "#include <linux/of_reserved_mem.h>",
      "#include <linux/of_fdt.h>",
      "#include <linux/of.h>",
      "#include <linux/cma.h>",
      "#include <linux/dma-map-ops.h>",
      "#include <linux/sizes.h>",
      "#include <linux/err.h>",
      "#include <linux/memblock.h>",
      "#include <asm/page.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PHYS_PFN",
          "args": [
            "memblock_phys_mem_size()"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_phys_mem_size",
          "args": [],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\n__maybe_unused cma_early_percent_memory(void)\n{\n\tunsigned long total_pages = PHYS_PFN(memblock_phys_mem_size());\n\n\treturn (total_pages * CONFIG_CMA_SIZE_PERCENTAGE / 100) << PAGE_SHIFT;\n}"
  },
  {
    "function_name": "early_cma_pernuma",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
    "lines": "104-108",
    "snippet": "static int __init early_cma_pernuma(char *p)\n{\n\tpernuma_size_bytes = memparse(p, &p);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/of_reserved_mem.h>",
      "#include <linux/of_fdt.h>",
      "#include <linux/of.h>",
      "#include <linux/cma.h>",
      "#include <linux/dma-map-ops.h>",
      "#include <linux/sizes.h>",
      "#include <linux/err.h>",
      "#include <linux/memblock.h>",
      "#include <asm/page.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memparse",
          "args": [
            "p",
            "&p"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\nstatic int __init early_cma_pernuma(char *p)\n{\n\tpernuma_size_bytes = memparse(p, &p);\n\treturn 0;\n}"
  },
  {
    "function_name": "early_cma",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/dma/contiguous.c",
    "lines": "78-96",
    "snippet": "static int __init early_cma(char *p)\n{\n\tif (!p) {\n\t\tpr_err(\"Config string not provided\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\tsize_cmdline = memparse(p, &p);\n\tif (*p != '@')\n\t\treturn 0;\n\tbase_cmdline = memparse(p + 1, &p);\n\tif (*p != '-') {\n\t\tlimit_cmdline = base_cmdline + size_cmdline;\n\t\treturn 0;\n\t}\n\tlimit_cmdline = memparse(p + 1, &p);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/of_reserved_mem.h>",
      "#include <linux/of_fdt.h>",
      "#include <linux/of.h>",
      "#include <linux/cma.h>",
      "#include <linux/dma-map-ops.h>",
      "#include <linux/sizes.h>",
      "#include <linux/err.h>",
      "#include <linux/memblock.h>",
      "#include <asm/page.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static phys_addr_t  size_cmdline",
      "static phys_addr_t base_cmdline",
      "static phys_addr_t limit_cmdline"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memparse",
          "args": [
            "p + 1",
            "&p"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memparse",
          "args": [
            "p + 1",
            "&p"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memparse",
          "args": [
            "p",
            "&p"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Config string not provided\\n\""
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/of_reserved_mem.h>\n#include <linux/of_fdt.h>\n#include <linux/of.h>\n#include <linux/cma.h>\n#include <linux/dma-map-ops.h>\n#include <linux/sizes.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <asm/page.h>\n\nstatic phys_addr_t  size_cmdline;\nstatic phys_addr_t base_cmdline;\nstatic phys_addr_t limit_cmdline;\n\nstatic int __init early_cma(char *p)\n{\n\tif (!p) {\n\t\tpr_err(\"Config string not provided\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\tsize_cmdline = memparse(p, &p);\n\tif (*p != '@')\n\t\treturn 0;\n\tbase_cmdline = memparse(p + 1, &p);\n\tif (*p != '-') {\n\t\tlimit_cmdline = base_cmdline + size_cmdline;\n\t\treturn 0;\n\t}\n\tlimit_cmdline = memparse(p + 1, &p);\n\n\treturn 0;\n}"
  }
]