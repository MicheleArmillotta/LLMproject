[
  {
    "function_name": "rcu_segcblist_merge",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "607-633",
    "snippet": "void rcu_segcblist_merge(struct rcu_segcblist *dst_rsclp,\n\t\t\t struct rcu_segcblist *src_rsclp)\n{\n\tstruct rcu_cblist donecbs;\n\tstruct rcu_cblist pendcbs;\n\n\tlockdep_assert_cpus_held();\n\n\trcu_cblist_init(&donecbs);\n\trcu_cblist_init(&pendcbs);\n\n\trcu_segcblist_extract_done_cbs(src_rsclp, &donecbs);\n\trcu_segcblist_extract_pend_cbs(src_rsclp, &pendcbs);\n\n\t/*\n\t * No need smp_mb() before setting length to 0, because CPU hotplug\n\t * lock excludes rcu_barrier.\n\t */\n\trcu_segcblist_set_len(src_rsclp, 0);\n\n\trcu_segcblist_insert_count(dst_rsclp, &donecbs);\n\trcu_segcblist_insert_count(dst_rsclp, &pendcbs);\n\trcu_segcblist_insert_done_cbs(dst_rsclp, &donecbs);\n\trcu_segcblist_insert_pend_cbs(dst_rsclp, &pendcbs);\n\n\trcu_segcblist_init(src_rsclp);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_init",
          "args": [
            "src_rsclp"
          ],
          "line": 632
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_init",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "237-250",
          "snippet": "void rcu_segcblist_init(struct rcu_segcblist *rsclp)\n{\n\tint i;\n\n\tBUILD_BUG_ON(RCU_NEXT_TAIL + 1 != ARRAY_SIZE(rsclp->gp_seq));\n\tBUILD_BUG_ON(ARRAY_SIZE(rsclp->tails) != ARRAY_SIZE(rsclp->gp_seq));\n\trsclp->head = NULL;\n\tfor (i = 0; i < RCU_CBLIST_NSEGS; i++) {\n\t\trsclp->tails[i] = &rsclp->head;\n\t\trcu_segcblist_set_seglen(rsclp, i, 0);\n\t}\n\trcu_segcblist_set_len(rsclp, 0);\n\trcu_segcblist_set_flags(rsclp, SEGCBLIST_ENABLED);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp)\n{\n\tint i;\n\n\tBUILD_BUG_ON(RCU_NEXT_TAIL + 1 != ARRAY_SIZE(rsclp->gp_seq));\n\tBUILD_BUG_ON(ARRAY_SIZE(rsclp->tails) != ARRAY_SIZE(rsclp->gp_seq));\n\trsclp->head = NULL;\n\tfor (i = 0; i < RCU_CBLIST_NSEGS; i++) {\n\t\trsclp->tails[i] = &rsclp->head;\n\t\trcu_segcblist_set_seglen(rsclp, i, 0);\n\t}\n\trcu_segcblist_set_len(rsclp, 0);\n\trcu_segcblist_set_flags(rsclp, SEGCBLIST_ENABLED);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_insert_pend_cbs",
          "args": [
            "dst_rsclp",
            "&pendcbs"
          ],
          "line": 630
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_insert_pend_cbs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "465-474",
          "snippet": "void rcu_segcblist_insert_pend_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t   struct rcu_cblist *rclp)\n{\n\tif (!rclp->head)\n\t\treturn; /* Nothing to do. */\n\n\trcu_segcblist_add_seglen(rsclp, RCU_NEXT_TAIL, rclp->len);\n\tWRITE_ONCE(*rsclp->tails[RCU_NEXT_TAIL], rclp->head);\n\tWRITE_ONCE(rsclp->tails[RCU_NEXT_TAIL], rclp->tail);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_insert_pend_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t   struct rcu_cblist *rclp)\n{\n\tif (!rclp->head)\n\t\treturn; /* Nothing to do. */\n\n\trcu_segcblist_add_seglen(rsclp, RCU_NEXT_TAIL, rclp->len);\n\tWRITE_ONCE(*rsclp->tails[RCU_NEXT_TAIL], rclp->head);\n\tWRITE_ONCE(rsclp->tails[RCU_NEXT_TAIL], rclp->tail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_insert_done_cbs",
          "args": [
            "dst_rsclp",
            "&donecbs"
          ],
          "line": 629
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_insert_done_cbs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "442-459",
          "snippet": "void rcu_segcblist_insert_done_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t   struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rclp->head)\n\t\treturn; /* No callbacks to move. */\n\trcu_segcblist_add_seglen(rsclp, RCU_DONE_TAIL, rclp->len);\n\t*rclp->tail = rsclp->head;\n\tWRITE_ONCE(rsclp->head, rclp->head);\n\tfor (i = RCU_DONE_TAIL; i < RCU_CBLIST_NSEGS; i++)\n\t\tif (&rsclp->head == rsclp->tails[i])\n\t\t\tWRITE_ONCE(rsclp->tails[i], rclp->tail);\n\t\telse\n\t\t\tbreak;\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_insert_done_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t   struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rclp->head)\n\t\treturn; /* No callbacks to move. */\n\trcu_segcblist_add_seglen(rsclp, RCU_DONE_TAIL, rclp->len);\n\t*rclp->tail = rsclp->head;\n\tWRITE_ONCE(rsclp->head, rclp->head);\n\tfor (i = RCU_DONE_TAIL; i < RCU_CBLIST_NSEGS; i++)\n\t\tif (&rsclp->head == rsclp->tails[i])\n\t\t\tWRITE_ONCE(rsclp->tails[i], rclp->tail);\n\t\telse\n\t\t\tbreak;\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_insert_count",
          "args": [
            "dst_rsclp",
            "&pendcbs"
          ],
          "line": 628
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_insert_count",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "432-436",
          "snippet": "void rcu_segcblist_insert_count(struct rcu_segcblist *rsclp,\n\t\t\t\tstruct rcu_cblist *rclp)\n{\n\trcu_segcblist_add_len(rsclp, rclp->len);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_insert_count(struct rcu_segcblist *rsclp,\n\t\t\t\tstruct rcu_cblist *rclp)\n{\n\trcu_segcblist_add_len(rsclp, rclp->len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_set_len",
          "args": [
            "src_rsclp",
            "0"
          ],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_set_len",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "82-89",
          "snippet": "static void rcu_segcblist_set_len(struct rcu_segcblist *rsclp, long v)\n{\n#ifdef CONFIG_RCU_NOCB_CPU\n\tatomic_long_set(&rsclp->len, v);\n#else\n\tWRITE_ONCE(rsclp->len, v);\n#endif\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_set_len(struct rcu_segcblist *rsclp, long v)\n{\n#ifdef CONFIG_RCU_NOCB_CPU\n\tatomic_long_set(&rsclp->len, v);\n#else\n\tWRITE_ONCE(rsclp->len, v);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_extract_pend_cbs",
          "args": [
            "src_rsclp",
            "&pendcbs"
          ],
          "line": 619
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_extract_pend_cbs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "410-426",
          "snippet": "void rcu_segcblist_extract_pend_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t    struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rcu_segcblist_pend_cbs(rsclp))\n\t\treturn; /* Nothing to do. */\n\trclp->len = 0;\n\t*rclp->tail = *rsclp->tails[RCU_DONE_TAIL];\n\trclp->tail = rsclp->tails[RCU_NEXT_TAIL];\n\tWRITE_ONCE(*rsclp->tails[RCU_DONE_TAIL], NULL);\n\tfor (i = RCU_DONE_TAIL + 1; i < RCU_CBLIST_NSEGS; i++) {\n\t\trclp->len += rcu_segcblist_get_seglen(rsclp, i);\n\t\tWRITE_ONCE(rsclp->tails[i], rsclp->tails[RCU_DONE_TAIL]);\n\t\trcu_segcblist_set_seglen(rsclp, i, 0);\n\t}\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_extract_pend_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t    struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rcu_segcblist_pend_cbs(rsclp))\n\t\treturn; /* Nothing to do. */\n\trclp->len = 0;\n\t*rclp->tail = *rsclp->tails[RCU_DONE_TAIL];\n\trclp->tail = rsclp->tails[RCU_NEXT_TAIL];\n\tWRITE_ONCE(*rsclp->tails[RCU_DONE_TAIL], NULL);\n\tfor (i = RCU_DONE_TAIL + 1; i < RCU_CBLIST_NSEGS; i++) {\n\t\trclp->len += rcu_segcblist_get_seglen(rsclp, i);\n\t\tWRITE_ONCE(rsclp->tails[i], rsclp->tails[RCU_DONE_TAIL]);\n\t\trcu_segcblist_set_seglen(rsclp, i, 0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_extract_done_cbs",
          "args": [
            "src_rsclp",
            "&donecbs"
          ],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_extract_done_cbs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "385-401",
          "snippet": "void rcu_segcblist_extract_done_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t    struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rcu_segcblist_ready_cbs(rsclp))\n\t\treturn; /* Nothing to do. */\n\trclp->len = rcu_segcblist_get_seglen(rsclp, RCU_DONE_TAIL);\n\t*rclp->tail = rsclp->head;\n\tWRITE_ONCE(rsclp->head, *rsclp->tails[RCU_DONE_TAIL]);\n\tWRITE_ONCE(*rsclp->tails[RCU_DONE_TAIL], NULL);\n\trclp->tail = rsclp->tails[RCU_DONE_TAIL];\n\tfor (i = RCU_CBLIST_NSEGS - 1; i >= RCU_DONE_TAIL; i--)\n\t\tif (rsclp->tails[i] == rsclp->tails[RCU_DONE_TAIL])\n\t\t\tWRITE_ONCE(rsclp->tails[i], &rsclp->head);\n\trcu_segcblist_set_seglen(rsclp, RCU_DONE_TAIL, 0);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_extract_done_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t    struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rcu_segcblist_ready_cbs(rsclp))\n\t\treturn; /* Nothing to do. */\n\trclp->len = rcu_segcblist_get_seglen(rsclp, RCU_DONE_TAIL);\n\t*rclp->tail = rsclp->head;\n\tWRITE_ONCE(rsclp->head, *rsclp->tails[RCU_DONE_TAIL]);\n\tWRITE_ONCE(*rsclp->tails[RCU_DONE_TAIL], NULL);\n\trclp->tail = rsclp->tails[RCU_DONE_TAIL];\n\tfor (i = RCU_CBLIST_NSEGS - 1; i >= RCU_DONE_TAIL; i--)\n\t\tif (rsclp->tails[i] == rsclp->tails[RCU_DONE_TAIL])\n\t\t\tWRITE_ONCE(rsclp->tails[i], &rsclp->head);\n\trcu_segcblist_set_seglen(rsclp, RCU_DONE_TAIL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_cblist_init",
          "args": [
            "&pendcbs"
          ],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_cblist_init",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "18-23",
          "snippet": "void rcu_cblist_init(struct rcu_cblist *rclp)\n{\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n\trclp->len = 0;\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_cblist_init(struct rcu_cblist *rclp)\n{\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n\trclp->len = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lockdep_assert_cpus_held",
          "args": [],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "lockdep_assert_cpus_held",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu.c",
          "lines": "335-347",
          "snippet": "void lockdep_assert_cpus_held(void)\n{\n\t/*\n\t * We can't have hotplug operations before userspace starts running,\n\t * and some init codepaths will knowingly not take the hotplug lock.\n\t * This is all valid, so mute lockdep until it makes sense to report\n\t * unheld locks.\n\t */\n\tif (system_state < SYSTEM_RUNNING)\n\t\treturn;\n\n\tpercpu_rwsem_assert_held(&cpu_hotplug_lock);\n}",
          "includes": [
            "#include \"smpboot.h\"",
            "#include <trace/events/cpuhp.h>",
            "#include <trace/events/power.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/percpu-rwsem.h>",
            "#include <linux/scs.h>",
            "#include <linux/slab.h>",
            "#include <linux/relay.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/nmi.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/suspend.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mutex.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/kthread.h>",
            "#include <linux/bug.h>",
            "#include <linux/export.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/unistd.h>",
            "#include <linux/sched/smt.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/notifier.h>",
            "#include <linux/init.h>",
            "#include <linux/smp.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/sched/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"smpboot.h\"\n#include <trace/events/cpuhp.h>\n#include <trace/events/power.h>\n#include <linux/cpuset.h>\n#include <linux/percpu-rwsem.h>\n#include <linux/scs.h>\n#include <linux/slab.h>\n#include <linux/relay.h>\n#include <linux/smpboot.h>\n#include <linux/nmi.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/lockdep.h>\n#include <linux/suspend.h>\n#include <linux/gfp.h>\n#include <linux/mutex.h>\n#include <linux/stop_machine.h>\n#include <linux/kthread.h>\n#include <linux/bug.h>\n#include <linux/export.h>\n#include <linux/rcupdate.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/unistd.h>\n#include <linux/sched/smt.h>\n#include <linux/sched/task.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/signal.h>\n#include <linux/notifier.h>\n#include <linux/init.h>\n#include <linux/smp.h>\n#include <linux/proc_fs.h>\n#include <linux/sched/mm.h>\n\nvoid lockdep_assert_cpus_held(void)\n{\n\t/*\n\t * We can't have hotplug operations before userspace starts running,\n\t * and some init codepaths will knowingly not take the hotplug lock.\n\t * This is all valid, so mute lockdep until it makes sense to report\n\t * unheld locks.\n\t */\n\tif (system_state < SYSTEM_RUNNING)\n\t\treturn;\n\n\tpercpu_rwsem_assert_held(&cpu_hotplug_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_merge(struct rcu_segcblist *dst_rsclp,\n\t\t\t struct rcu_segcblist *src_rsclp)\n{\n\tstruct rcu_cblist donecbs;\n\tstruct rcu_cblist pendcbs;\n\n\tlockdep_assert_cpus_held();\n\n\trcu_cblist_init(&donecbs);\n\trcu_cblist_init(&pendcbs);\n\n\trcu_segcblist_extract_done_cbs(src_rsclp, &donecbs);\n\trcu_segcblist_extract_pend_cbs(src_rsclp, &pendcbs);\n\n\t/*\n\t * No need smp_mb() before setting length to 0, because CPU hotplug\n\t * lock excludes rcu_barrier.\n\t */\n\trcu_segcblist_set_len(src_rsclp, 0);\n\n\trcu_segcblist_insert_count(dst_rsclp, &donecbs);\n\trcu_segcblist_insert_count(dst_rsclp, &pendcbs);\n\trcu_segcblist_insert_done_cbs(dst_rsclp, &donecbs);\n\trcu_segcblist_insert_pend_cbs(dst_rsclp, &pendcbs);\n\n\trcu_segcblist_init(src_rsclp);\n}"
  },
  {
    "function_name": "rcu_segcblist_accelerate",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "537-598",
    "snippet": "bool rcu_segcblist_accelerate(struct rcu_segcblist *rsclp, unsigned long seq)\n{\n\tint i, j;\n\n\tWARN_ON_ONCE(!rcu_segcblist_is_enabled(rsclp));\n\tif (rcu_segcblist_restempty(rsclp, RCU_DONE_TAIL))\n\t\treturn false;\n\n\t/*\n\t * Find the segment preceding the oldest segment of callbacks\n\t * whose ->gp_seq[] completion is at or after that passed in via\n\t * \"seq\", skipping any empty segments.  This oldest segment, along\n\t * with any later segments, can be merged in with any newly arrived\n\t * callbacks in the RCU_NEXT_TAIL segment, and assigned \"seq\"\n\t * as their ->gp_seq[] grace-period completion sequence number.\n\t */\n\tfor (i = RCU_NEXT_READY_TAIL; i > RCU_DONE_TAIL; i--)\n\t\tif (rsclp->tails[i] != rsclp->tails[i - 1] &&\n\t\t    ULONG_CMP_LT(rsclp->gp_seq[i], seq))\n\t\t\tbreak;\n\n\t/*\n\t * If all the segments contain callbacks that correspond to\n\t * earlier grace-period sequence numbers than \"seq\", leave.\n\t * Assuming that the rcu_segcblist structure has enough\n\t * segments in its arrays, this can only happen if some of\n\t * the non-done segments contain callbacks that really are\n\t * ready to invoke.  This situation will get straightened\n\t * out by the next call to rcu_segcblist_advance().\n\t *\n\t * Also advance to the oldest segment of callbacks whose\n\t * ->gp_seq[] completion is at or after that passed in via \"seq\",\n\t * skipping any empty segments.\n\t *\n\t * Note that segment \"i\" (and any lower-numbered segments\n\t * containing older callbacks) will be unaffected, and their\n\t * grace-period numbers remain unchanged.  For example, if i ==\n\t * WAIT_TAIL, then neither WAIT_TAIL nor DONE_TAIL will be touched.\n\t * Instead, the CBs in NEXT_TAIL will be merged with those in\n\t * NEXT_READY_TAIL and the grace-period number of NEXT_READY_TAIL\n\t * would be updated.  NEXT_TAIL would then be empty.\n\t */\n\tif (rcu_segcblist_restempty(rsclp, i) || ++i >= RCU_NEXT_TAIL)\n\t\treturn false;\n\n\t/* Accounting: everything below i is about to get merged into i. */\n\tfor (j = i + 1; j <= RCU_NEXT_TAIL; j++)\n\t\trcu_segcblist_move_seglen(rsclp, j, i);\n\n\t/*\n\t * Merge all later callbacks, including newly arrived callbacks,\n\t * into the segment located by the for-loop above.  Assign \"seq\"\n\t * as the ->gp_seq[] value in order to correctly handle the case\n\t * where there were no pending callbacks in the rcu_segcblist\n\t * structure other than in the RCU_NEXT_TAIL segment.\n\t */\n\tfor (; i < RCU_NEXT_TAIL; i++) {\n\t\tWRITE_ONCE(rsclp->tails[i], rsclp->tails[RCU_NEXT_TAIL]);\n\t\trsclp->gp_seq[i] = seq;\n\t}\n\treturn true;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->tails[i]",
            "rsclp->tails[RCU_NEXT_TAIL]"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_move_seglen",
          "args": [
            "rsclp",
            "j",
            "i"
          ],
          "line": 584
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_move_seglen",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "122-135",
          "snippet": "static void rcu_segcblist_move_seglen(struct rcu_segcblist *rsclp, int from, int to)\n{\n\tlong len;\n\n\tif (from == to)\n\t\treturn;\n\n\tlen = rcu_segcblist_get_seglen(rsclp, from);\n\tif (!len)\n\t\treturn;\n\n\trcu_segcblist_add_seglen(rsclp, to, len);\n\trcu_segcblist_set_seglen(rsclp, from, 0);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_move_seglen(struct rcu_segcblist *rsclp, int from, int to)\n{\n\tlong len;\n\n\tif (from == to)\n\t\treturn;\n\n\tlen = rcu_segcblist_get_seglen(rsclp, from);\n\tif (!len)\n\t\treturn;\n\n\trcu_segcblist_add_seglen(rsclp, to, len);\n\trcu_segcblist_set_seglen(rsclp, from, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_restempty",
          "args": [
            "rsclp",
            "i"
          ],
          "line": 579
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_restempty",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "110-113",
          "snippet": "static inline bool rcu_segcblist_restempty(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn !READ_ONCE(*READ_ONCE(rsclp->tails[seg]));\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_restempty(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn !READ_ONCE(*READ_ONCE(rsclp->tails[seg]));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ULONG_CMP_LT",
          "args": [
            "rsclp->gp_seq[i]",
            "seq"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!rcu_segcblist_is_enabled(rsclp)"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_is_enabled",
          "args": [
            "rsclp"
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_is_enabled",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "78-81",
          "snippet": "static inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_test_flags(rsclp, SEGCBLIST_ENABLED);\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_test_flags(rsclp, SEGCBLIST_ENABLED);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nbool rcu_segcblist_accelerate(struct rcu_segcblist *rsclp, unsigned long seq)\n{\n\tint i, j;\n\n\tWARN_ON_ONCE(!rcu_segcblist_is_enabled(rsclp));\n\tif (rcu_segcblist_restempty(rsclp, RCU_DONE_TAIL))\n\t\treturn false;\n\n\t/*\n\t * Find the segment preceding the oldest segment of callbacks\n\t * whose ->gp_seq[] completion is at or after that passed in via\n\t * \"seq\", skipping any empty segments.  This oldest segment, along\n\t * with any later segments, can be merged in with any newly arrived\n\t * callbacks in the RCU_NEXT_TAIL segment, and assigned \"seq\"\n\t * as their ->gp_seq[] grace-period completion sequence number.\n\t */\n\tfor (i = RCU_NEXT_READY_TAIL; i > RCU_DONE_TAIL; i--)\n\t\tif (rsclp->tails[i] != rsclp->tails[i - 1] &&\n\t\t    ULONG_CMP_LT(rsclp->gp_seq[i], seq))\n\t\t\tbreak;\n\n\t/*\n\t * If all the segments contain callbacks that correspond to\n\t * earlier grace-period sequence numbers than \"seq\", leave.\n\t * Assuming that the rcu_segcblist structure has enough\n\t * segments in its arrays, this can only happen if some of\n\t * the non-done segments contain callbacks that really are\n\t * ready to invoke.  This situation will get straightened\n\t * out by the next call to rcu_segcblist_advance().\n\t *\n\t * Also advance to the oldest segment of callbacks whose\n\t * ->gp_seq[] completion is at or after that passed in via \"seq\",\n\t * skipping any empty segments.\n\t *\n\t * Note that segment \"i\" (and any lower-numbered segments\n\t * containing older callbacks) will be unaffected, and their\n\t * grace-period numbers remain unchanged.  For example, if i ==\n\t * WAIT_TAIL, then neither WAIT_TAIL nor DONE_TAIL will be touched.\n\t * Instead, the CBs in NEXT_TAIL will be merged with those in\n\t * NEXT_READY_TAIL and the grace-period number of NEXT_READY_TAIL\n\t * would be updated.  NEXT_TAIL would then be empty.\n\t */\n\tif (rcu_segcblist_restempty(rsclp, i) || ++i >= RCU_NEXT_TAIL)\n\t\treturn false;\n\n\t/* Accounting: everything below i is about to get merged into i. */\n\tfor (j = i + 1; j <= RCU_NEXT_TAIL; j++)\n\t\trcu_segcblist_move_seglen(rsclp, j, i);\n\n\t/*\n\t * Merge all later callbacks, including newly arrived callbacks,\n\t * into the segment located by the for-loop above.  Assign \"seq\"\n\t * as the ->gp_seq[] value in order to correctly handle the case\n\t * where there were no pending callbacks in the rcu_segcblist\n\t * structure other than in the RCU_NEXT_TAIL segment.\n\t */\n\tfor (; i < RCU_NEXT_TAIL; i++) {\n\t\tWRITE_ONCE(rsclp->tails[i], rsclp->tails[RCU_NEXT_TAIL]);\n\t\trsclp->gp_seq[i] = seq;\n\t}\n\treturn true;\n}"
  },
  {
    "function_name": "rcu_segcblist_advance",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "480-520",
    "snippet": "void rcu_segcblist_advance(struct rcu_segcblist *rsclp, unsigned long seq)\n{\n\tint i, j;\n\n\tWARN_ON_ONCE(!rcu_segcblist_is_enabled(rsclp));\n\tif (rcu_segcblist_restempty(rsclp, RCU_DONE_TAIL))\n\t\treturn;\n\n\t/*\n\t * Find all callbacks whose ->gp_seq numbers indicate that they\n\t * are ready to invoke, and put them into the RCU_DONE_TAIL segment.\n\t */\n\tfor (i = RCU_WAIT_TAIL; i < RCU_NEXT_TAIL; i++) {\n\t\tif (ULONG_CMP_LT(seq, rsclp->gp_seq[i]))\n\t\t\tbreak;\n\t\tWRITE_ONCE(rsclp->tails[RCU_DONE_TAIL], rsclp->tails[i]);\n\t\trcu_segcblist_move_seglen(rsclp, i, RCU_DONE_TAIL);\n\t}\n\n\t/* If no callbacks moved, nothing more need be done. */\n\tif (i == RCU_WAIT_TAIL)\n\t\treturn;\n\n\t/* Clean up tail pointers that might have been misordered above. */\n\tfor (j = RCU_WAIT_TAIL; j < i; j++)\n\t\tWRITE_ONCE(rsclp->tails[j], rsclp->tails[RCU_DONE_TAIL]);\n\n\t/*\n\t * Callbacks moved, so clean up the misordered ->tails[] pointers\n\t * that now point into the middle of the list of ready-to-invoke\n\t * callbacks.  The overall effect is to copy down the later pointers\n\t * into the gap that was created by the now-ready segments.\n\t */\n\tfor (j = RCU_WAIT_TAIL; i < RCU_NEXT_TAIL; i++, j++) {\n\t\tif (rsclp->tails[j] == rsclp->tails[RCU_NEXT_TAIL])\n\t\t\tbreak;  /* No more callbacks. */\n\t\tWRITE_ONCE(rsclp->tails[j], rsclp->tails[i]);\n\t\trcu_segcblist_move_seglen(rsclp, i, j);\n\t\trsclp->gp_seq[j] = rsclp->gp_seq[i];\n\t}\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_move_seglen",
          "args": [
            "rsclp",
            "i",
            "j"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_move_seglen",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "122-135",
          "snippet": "static void rcu_segcblist_move_seglen(struct rcu_segcblist *rsclp, int from, int to)\n{\n\tlong len;\n\n\tif (from == to)\n\t\treturn;\n\n\tlen = rcu_segcblist_get_seglen(rsclp, from);\n\tif (!len)\n\t\treturn;\n\n\trcu_segcblist_add_seglen(rsclp, to, len);\n\trcu_segcblist_set_seglen(rsclp, from, 0);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_move_seglen(struct rcu_segcblist *rsclp, int from, int to)\n{\n\tlong len;\n\n\tif (from == to)\n\t\treturn;\n\n\tlen = rcu_segcblist_get_seglen(rsclp, from);\n\tif (!len)\n\t\treturn;\n\n\trcu_segcblist_add_seglen(rsclp, to, len);\n\trcu_segcblist_set_seglen(rsclp, from, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->tails[j]",
            "rsclp->tails[i]"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->tails[j]",
            "rsclp->tails[RCU_DONE_TAIL]"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->tails[RCU_DONE_TAIL]",
            "rsclp->tails[i]"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ULONG_CMP_LT",
          "args": [
            "seq",
            "rsclp->gp_seq[i]"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_restempty",
          "args": [
            "rsclp",
            "RCU_DONE_TAIL"
          ],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_restempty",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "110-113",
          "snippet": "static inline bool rcu_segcblist_restempty(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn !READ_ONCE(*READ_ONCE(rsclp->tails[seg]));\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_restempty(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn !READ_ONCE(*READ_ONCE(rsclp->tails[seg]));\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!rcu_segcblist_is_enabled(rsclp)"
          ],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_is_enabled",
          "args": [
            "rsclp"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_is_enabled",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "78-81",
          "snippet": "static inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_test_flags(rsclp, SEGCBLIST_ENABLED);\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_test_flags(rsclp, SEGCBLIST_ENABLED);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_advance(struct rcu_segcblist *rsclp, unsigned long seq)\n{\n\tint i, j;\n\n\tWARN_ON_ONCE(!rcu_segcblist_is_enabled(rsclp));\n\tif (rcu_segcblist_restempty(rsclp, RCU_DONE_TAIL))\n\t\treturn;\n\n\t/*\n\t * Find all callbacks whose ->gp_seq numbers indicate that they\n\t * are ready to invoke, and put them into the RCU_DONE_TAIL segment.\n\t */\n\tfor (i = RCU_WAIT_TAIL; i < RCU_NEXT_TAIL; i++) {\n\t\tif (ULONG_CMP_LT(seq, rsclp->gp_seq[i]))\n\t\t\tbreak;\n\t\tWRITE_ONCE(rsclp->tails[RCU_DONE_TAIL], rsclp->tails[i]);\n\t\trcu_segcblist_move_seglen(rsclp, i, RCU_DONE_TAIL);\n\t}\n\n\t/* If no callbacks moved, nothing more need be done. */\n\tif (i == RCU_WAIT_TAIL)\n\t\treturn;\n\n\t/* Clean up tail pointers that might have been misordered above. */\n\tfor (j = RCU_WAIT_TAIL; j < i; j++)\n\t\tWRITE_ONCE(rsclp->tails[j], rsclp->tails[RCU_DONE_TAIL]);\n\n\t/*\n\t * Callbacks moved, so clean up the misordered ->tails[] pointers\n\t * that now point into the middle of the list of ready-to-invoke\n\t * callbacks.  The overall effect is to copy down the later pointers\n\t * into the gap that was created by the now-ready segments.\n\t */\n\tfor (j = RCU_WAIT_TAIL; i < RCU_NEXT_TAIL; i++, j++) {\n\t\tif (rsclp->tails[j] == rsclp->tails[RCU_NEXT_TAIL])\n\t\t\tbreak;  /* No more callbacks. */\n\t\tWRITE_ONCE(rsclp->tails[j], rsclp->tails[i]);\n\t\trcu_segcblist_move_seglen(rsclp, i, j);\n\t\trsclp->gp_seq[j] = rsclp->gp_seq[i];\n\t}\n}"
  },
  {
    "function_name": "rcu_segcblist_insert_pend_cbs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "465-474",
    "snippet": "void rcu_segcblist_insert_pend_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t   struct rcu_cblist *rclp)\n{\n\tif (!rclp->head)\n\t\treturn; /* Nothing to do. */\n\n\trcu_segcblist_add_seglen(rsclp, RCU_NEXT_TAIL, rclp->len);\n\tWRITE_ONCE(*rsclp->tails[RCU_NEXT_TAIL], rclp->head);\n\tWRITE_ONCE(rsclp->tails[RCU_NEXT_TAIL], rclp->tail);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->tails[RCU_NEXT_TAIL]",
            "rclp->tail"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "*rsclp->tails[RCU_NEXT_TAIL]",
            "rclp->head"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_add_seglen",
          "args": [
            "rsclp",
            "RCU_NEXT_TAIL",
            "rclp->len"
          ],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_add_seglen",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "116-119",
          "snippet": "static void rcu_segcblist_add_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], rsclp->seglen[seg] + v);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_add_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], rsclp->seglen[seg] + v);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_insert_pend_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t   struct rcu_cblist *rclp)\n{\n\tif (!rclp->head)\n\t\treturn; /* Nothing to do. */\n\n\trcu_segcblist_add_seglen(rsclp, RCU_NEXT_TAIL, rclp->len);\n\tWRITE_ONCE(*rsclp->tails[RCU_NEXT_TAIL], rclp->head);\n\tWRITE_ONCE(rsclp->tails[RCU_NEXT_TAIL], rclp->tail);\n}"
  },
  {
    "function_name": "rcu_segcblist_insert_done_cbs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "442-459",
    "snippet": "void rcu_segcblist_insert_done_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t   struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rclp->head)\n\t\treturn; /* No callbacks to move. */\n\trcu_segcblist_add_seglen(rsclp, RCU_DONE_TAIL, rclp->len);\n\t*rclp->tail = rsclp->head;\n\tWRITE_ONCE(rsclp->head, rclp->head);\n\tfor (i = RCU_DONE_TAIL; i < RCU_CBLIST_NSEGS; i++)\n\t\tif (&rsclp->head == rsclp->tails[i])\n\t\t\tWRITE_ONCE(rsclp->tails[i], rclp->tail);\n\t\telse\n\t\t\tbreak;\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->tails[i]",
            "rclp->tail"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->head",
            "rclp->head"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_add_seglen",
          "args": [
            "rsclp",
            "RCU_DONE_TAIL",
            "rclp->len"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_add_seglen",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "116-119",
          "snippet": "static void rcu_segcblist_add_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], rsclp->seglen[seg] + v);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_add_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], rsclp->seglen[seg] + v);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_insert_done_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t   struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rclp->head)\n\t\treturn; /* No callbacks to move. */\n\trcu_segcblist_add_seglen(rsclp, RCU_DONE_TAIL, rclp->len);\n\t*rclp->tail = rsclp->head;\n\tWRITE_ONCE(rsclp->head, rclp->head);\n\tfor (i = RCU_DONE_TAIL; i < RCU_CBLIST_NSEGS; i++)\n\t\tif (&rsclp->head == rsclp->tails[i])\n\t\t\tWRITE_ONCE(rsclp->tails[i], rclp->tail);\n\t\telse\n\t\t\tbreak;\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n}"
  },
  {
    "function_name": "rcu_segcblist_insert_count",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "432-436",
    "snippet": "void rcu_segcblist_insert_count(struct rcu_segcblist *rsclp,\n\t\t\t\tstruct rcu_cblist *rclp)\n{\n\trcu_segcblist_add_len(rsclp, rclp->len);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_add_len",
          "args": [
            "rsclp",
            "rclp->len"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_add_len",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "210-221",
          "snippet": "void rcu_segcblist_add_len(struct rcu_segcblist *rsclp, long v)\n{\n#ifdef CONFIG_RCU_NOCB_CPU\n\tsmp_mb__before_atomic(); // Read header comment above.\n\tatomic_long_add(v, &rsclp->len);\n\tsmp_mb__after_atomic();  // Read header comment above.\n#else\n\tsmp_mb(); // Read header comment above.\n\tWRITE_ONCE(rsclp->len, rsclp->len + v);\n\tsmp_mb(); // Read header comment above.\n#endif\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_add_len(struct rcu_segcblist *rsclp, long v)\n{\n#ifdef CONFIG_RCU_NOCB_CPU\n\tsmp_mb__before_atomic(); // Read header comment above.\n\tatomic_long_add(v, &rsclp->len);\n\tsmp_mb__after_atomic();  // Read header comment above.\n#else\n\tsmp_mb(); // Read header comment above.\n\tWRITE_ONCE(rsclp->len, rsclp->len + v);\n\tsmp_mb(); // Read header comment above.\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_insert_count(struct rcu_segcblist *rsclp,\n\t\t\t\tstruct rcu_cblist *rclp)\n{\n\trcu_segcblist_add_len(rsclp, rclp->len);\n}"
  },
  {
    "function_name": "rcu_segcblist_extract_pend_cbs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "410-426",
    "snippet": "void rcu_segcblist_extract_pend_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t    struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rcu_segcblist_pend_cbs(rsclp))\n\t\treturn; /* Nothing to do. */\n\trclp->len = 0;\n\t*rclp->tail = *rsclp->tails[RCU_DONE_TAIL];\n\trclp->tail = rsclp->tails[RCU_NEXT_TAIL];\n\tWRITE_ONCE(*rsclp->tails[RCU_DONE_TAIL], NULL);\n\tfor (i = RCU_DONE_TAIL + 1; i < RCU_CBLIST_NSEGS; i++) {\n\t\trclp->len += rcu_segcblist_get_seglen(rsclp, i);\n\t\tWRITE_ONCE(rsclp->tails[i], rsclp->tails[RCU_DONE_TAIL]);\n\t\trcu_segcblist_set_seglen(rsclp, i, 0);\n\t}\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_set_seglen",
          "args": [
            "rsclp",
            "i",
            "0"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_set_seglen",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "110-113",
          "snippet": "static void rcu_segcblist_set_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], v);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_set_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->tails[i]",
            "rsclp->tails[RCU_DONE_TAIL]"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_get_seglen",
          "args": [
            "rsclp",
            "i"
          ],
          "line": 422
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_get_seglen",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "92-95",
          "snippet": "static long rcu_segcblist_get_seglen(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn READ_ONCE(rsclp->seglen[seg]);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic long rcu_segcblist_get_seglen(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn READ_ONCE(rsclp->seglen[seg]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "*rsclp->tails[RCU_DONE_TAIL]",
            "NULL"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_pend_cbs",
          "args": [
            "rsclp"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_pend_cbs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "288-292",
          "snippet": "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_is_enabled(rsclp) &&\n\t       !rcu_segcblist_restempty(rsclp, RCU_DONE_TAIL);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_is_enabled(rsclp) &&\n\t       !rcu_segcblist_restempty(rsclp, RCU_DONE_TAIL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_extract_pend_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t    struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rcu_segcblist_pend_cbs(rsclp))\n\t\treturn; /* Nothing to do. */\n\trclp->len = 0;\n\t*rclp->tail = *rsclp->tails[RCU_DONE_TAIL];\n\trclp->tail = rsclp->tails[RCU_NEXT_TAIL];\n\tWRITE_ONCE(*rsclp->tails[RCU_DONE_TAIL], NULL);\n\tfor (i = RCU_DONE_TAIL + 1; i < RCU_CBLIST_NSEGS; i++) {\n\t\trclp->len += rcu_segcblist_get_seglen(rsclp, i);\n\t\tWRITE_ONCE(rsclp->tails[i], rsclp->tails[RCU_DONE_TAIL]);\n\t\trcu_segcblist_set_seglen(rsclp, i, 0);\n\t}\n}"
  },
  {
    "function_name": "rcu_segcblist_extract_done_cbs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "385-401",
    "snippet": "void rcu_segcblist_extract_done_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t    struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rcu_segcblist_ready_cbs(rsclp))\n\t\treturn; /* Nothing to do. */\n\trclp->len = rcu_segcblist_get_seglen(rsclp, RCU_DONE_TAIL);\n\t*rclp->tail = rsclp->head;\n\tWRITE_ONCE(rsclp->head, *rsclp->tails[RCU_DONE_TAIL]);\n\tWRITE_ONCE(*rsclp->tails[RCU_DONE_TAIL], NULL);\n\trclp->tail = rsclp->tails[RCU_DONE_TAIL];\n\tfor (i = RCU_CBLIST_NSEGS - 1; i >= RCU_DONE_TAIL; i--)\n\t\tif (rsclp->tails[i] == rsclp->tails[RCU_DONE_TAIL])\n\t\t\tWRITE_ONCE(rsclp->tails[i], &rsclp->head);\n\trcu_segcblist_set_seglen(rsclp, RCU_DONE_TAIL, 0);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_set_seglen",
          "args": [
            "rsclp",
            "RCU_DONE_TAIL",
            "0"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_set_seglen",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "110-113",
          "snippet": "static void rcu_segcblist_set_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], v);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_set_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->tails[i]",
            "&rsclp->head"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "*rsclp->tails[RCU_DONE_TAIL]",
            "NULL"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->head",
            "*rsclp->tails[RCU_DONE_TAIL]"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_get_seglen",
          "args": [
            "rsclp",
            "RCU_DONE_TAIL"
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_get_seglen",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "92-95",
          "snippet": "static long rcu_segcblist_get_seglen(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn READ_ONCE(rsclp->seglen[seg]);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic long rcu_segcblist_get_seglen(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn READ_ONCE(rsclp->seglen[seg]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_ready_cbs",
          "args": [
            "rsclp"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_ready_cbs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "278-282",
          "snippet": "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_is_enabled(rsclp) &&\n\t       &rsclp->head != READ_ONCE(rsclp->tails[RCU_DONE_TAIL]);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_is_enabled(rsclp) &&\n\t       &rsclp->head != READ_ONCE(rsclp->tails[RCU_DONE_TAIL]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_extract_done_cbs(struct rcu_segcblist *rsclp,\n\t\t\t\t    struct rcu_cblist *rclp)\n{\n\tint i;\n\n\tif (!rcu_segcblist_ready_cbs(rsclp))\n\t\treturn; /* Nothing to do. */\n\trclp->len = rcu_segcblist_get_seglen(rsclp, RCU_DONE_TAIL);\n\t*rclp->tail = rsclp->head;\n\tWRITE_ONCE(rsclp->head, *rsclp->tails[RCU_DONE_TAIL]);\n\tWRITE_ONCE(*rsclp->tails[RCU_DONE_TAIL], NULL);\n\trclp->tail = rsclp->tails[RCU_DONE_TAIL];\n\tfor (i = RCU_CBLIST_NSEGS - 1; i >= RCU_DONE_TAIL; i--)\n\t\tif (rsclp->tails[i] == rsclp->tails[RCU_DONE_TAIL])\n\t\t\tWRITE_ONCE(rsclp->tails[i], &rsclp->head);\n\trcu_segcblist_set_seglen(rsclp, RCU_DONE_TAIL, 0);\n}"
  },
  {
    "function_name": "rcu_segcblist_entrain",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "360-378",
    "snippet": "bool rcu_segcblist_entrain(struct rcu_segcblist *rsclp,\n\t\t\t   struct rcu_head *rhp)\n{\n\tint i;\n\n\tif (rcu_segcblist_n_cbs(rsclp) == 0)\n\t\treturn false;\n\trcu_segcblist_inc_len(rsclp);\n\tsmp_mb(); /* Ensure counts are updated before callback is entrained. */\n\trhp->next = NULL;\n\tfor (i = RCU_NEXT_TAIL; i > RCU_DONE_TAIL; i--)\n\t\tif (rsclp->tails[i] != rsclp->tails[i - 1])\n\t\t\tbreak;\n\trcu_segcblist_inc_seglen(rsclp, i);\n\tWRITE_ONCE(*rsclp->tails[i], rhp);\n\tfor (; i <= RCU_NEXT_TAIL; i++)\n\t\tWRITE_ONCE(rsclp->tails[i], &rhp->next);\n\treturn true;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->tails[i]",
            "&rhp->next"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "*rsclp->tails[i]",
            "rhp"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_inc_seglen",
          "args": [
            "rsclp",
            "i"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_inc_seglen",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "138-141",
          "snippet": "static void rcu_segcblist_inc_seglen(struct rcu_segcblist *rsclp, int seg)\n{\n\trcu_segcblist_add_seglen(rsclp, seg, 1);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_inc_seglen(struct rcu_segcblist *rsclp, int seg)\n{\n\trcu_segcblist_add_seglen(rsclp, seg, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_mb",
          "args": [],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_inc_len",
          "args": [
            "rsclp"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_inc_len",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "229-232",
          "snippet": "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp)\n{\n\trcu_segcblist_add_len(rsclp, 1);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp)\n{\n\trcu_segcblist_add_len(rsclp, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_n_cbs",
          "args": [
            "rsclp"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_n_cbs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "47-54",
          "snippet": "static inline long rcu_segcblist_n_cbs(struct rcu_segcblist *rsclp)\n{\n#ifdef CONFIG_RCU_NOCB_CPU\n\treturn atomic_long_read(&rsclp->len);\n#else\n\treturn READ_ONCE(rsclp->len);\n#endif\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline long rcu_segcblist_n_cbs(struct rcu_segcblist *rsclp)\n{\n#ifdef CONFIG_RCU_NOCB_CPU\n\treturn atomic_long_read(&rsclp->len);\n#else\n\treturn READ_ONCE(rsclp->len);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nbool rcu_segcblist_entrain(struct rcu_segcblist *rsclp,\n\t\t\t   struct rcu_head *rhp)\n{\n\tint i;\n\n\tif (rcu_segcblist_n_cbs(rsclp) == 0)\n\t\treturn false;\n\trcu_segcblist_inc_len(rsclp);\n\tsmp_mb(); /* Ensure counts are updated before callback is entrained. */\n\trhp->next = NULL;\n\tfor (i = RCU_NEXT_TAIL; i > RCU_DONE_TAIL; i--)\n\t\tif (rsclp->tails[i] != rsclp->tails[i - 1])\n\t\t\tbreak;\n\trcu_segcblist_inc_seglen(rsclp, i);\n\tWRITE_ONCE(*rsclp->tails[i], rhp);\n\tfor (; i <= RCU_NEXT_TAIL; i++)\n\t\tWRITE_ONCE(rsclp->tails[i], &rhp->next);\n\treturn true;\n}"
  },
  {
    "function_name": "rcu_segcblist_enqueue",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "340-348",
    "snippet": "void rcu_segcblist_enqueue(struct rcu_segcblist *rsclp,\n\t\t\t   struct rcu_head *rhp)\n{\n\trcu_segcblist_inc_len(rsclp);\n\trcu_segcblist_inc_seglen(rsclp, RCU_NEXT_TAIL);\n\trhp->next = NULL;\n\tWRITE_ONCE(*rsclp->tails[RCU_NEXT_TAIL], rhp);\n\tWRITE_ONCE(rsclp->tails[RCU_NEXT_TAIL], &rhp->next);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->tails[RCU_NEXT_TAIL]",
            "&rhp->next"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "*rsclp->tails[RCU_NEXT_TAIL]",
            "rhp"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_inc_seglen",
          "args": [
            "rsclp",
            "RCU_NEXT_TAIL"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_inc_seglen",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "138-141",
          "snippet": "static void rcu_segcblist_inc_seglen(struct rcu_segcblist *rsclp, int seg)\n{\n\trcu_segcblist_add_seglen(rsclp, seg, 1);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_inc_seglen(struct rcu_segcblist *rsclp, int seg)\n{\n\trcu_segcblist_add_seglen(rsclp, seg, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_inc_len",
          "args": [
            "rsclp"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_inc_len",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "229-232",
          "snippet": "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp)\n{\n\trcu_segcblist_add_len(rsclp, 1);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp)\n{\n\trcu_segcblist_add_len(rsclp, 1);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_enqueue(struct rcu_segcblist *rsclp,\n\t\t\t   struct rcu_head *rhp)\n{\n\trcu_segcblist_inc_len(rsclp);\n\trcu_segcblist_inc_seglen(rsclp, RCU_NEXT_TAIL);\n\trhp->next = NULL;\n\tWRITE_ONCE(*rsclp->tails[RCU_NEXT_TAIL], rhp);\n\tWRITE_ONCE(rsclp->tails[RCU_NEXT_TAIL], &rhp->next);\n}"
  },
  {
    "function_name": "rcu_segcblist_nextgp",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "323-329",
    "snippet": "bool rcu_segcblist_nextgp(struct rcu_segcblist *rsclp, unsigned long *lp)\n{\n\tif (!rcu_segcblist_pend_cbs(rsclp))\n\t\treturn false;\n\t*lp = rsclp->gp_seq[RCU_WAIT_TAIL];\n\treturn true;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_pend_cbs",
          "args": [
            "rsclp"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_pend_cbs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "288-292",
          "snippet": "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_is_enabled(rsclp) &&\n\t       !rcu_segcblist_restempty(rsclp, RCU_DONE_TAIL);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_is_enabled(rsclp) &&\n\t       !rcu_segcblist_restempty(rsclp, RCU_DONE_TAIL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nbool rcu_segcblist_nextgp(struct rcu_segcblist *rsclp, unsigned long *lp)\n{\n\tif (!rcu_segcblist_pend_cbs(rsclp))\n\t\treturn false;\n\t*lp = rsclp->gp_seq[RCU_WAIT_TAIL];\n\treturn true;\n}"
  },
  {
    "function_name": "rcu_segcblist_first_pend_cb",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "312-317",
    "snippet": "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp)\n{\n\tif (rcu_segcblist_is_enabled(rsclp))\n\t\treturn *rsclp->tails[RCU_DONE_TAIL];\n\treturn NULL;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_is_enabled",
          "args": [
            "rsclp"
          ],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_is_enabled",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "78-81",
          "snippet": "static inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_test_flags(rsclp, SEGCBLIST_ENABLED);\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_test_flags(rsclp, SEGCBLIST_ENABLED);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp)\n{\n\tif (rcu_segcblist_is_enabled(rsclp))\n\t\treturn *rsclp->tails[RCU_DONE_TAIL];\n\treturn NULL;\n}"
  },
  {
    "function_name": "rcu_segcblist_first_cb",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "298-303",
    "snippet": "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp)\n{\n\tif (rcu_segcblist_is_enabled(rsclp))\n\t\treturn rsclp->head;\n\treturn NULL;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_is_enabled",
          "args": [
            "rsclp"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_is_enabled",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "78-81",
          "snippet": "static inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_test_flags(rsclp, SEGCBLIST_ENABLED);\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_test_flags(rsclp, SEGCBLIST_ENABLED);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp)\n{\n\tif (rcu_segcblist_is_enabled(rsclp))\n\t\treturn rsclp->head;\n\treturn NULL;\n}"
  },
  {
    "function_name": "rcu_segcblist_pend_cbs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "288-292",
    "snippet": "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_is_enabled(rsclp) &&\n\t       !rcu_segcblist_restempty(rsclp, RCU_DONE_TAIL);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_restempty",
          "args": [
            "rsclp",
            "RCU_DONE_TAIL"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_restempty",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "110-113",
          "snippet": "static inline bool rcu_segcblist_restempty(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn !READ_ONCE(*READ_ONCE(rsclp->tails[seg]));\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_restempty(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn !READ_ONCE(*READ_ONCE(rsclp->tails[seg]));\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_is_enabled",
          "args": [
            "rsclp"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_is_enabled",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "78-81",
          "snippet": "static inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_test_flags(rsclp, SEGCBLIST_ENABLED);\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_test_flags(rsclp, SEGCBLIST_ENABLED);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_is_enabled(rsclp) &&\n\t       !rcu_segcblist_restempty(rsclp, RCU_DONE_TAIL);\n}"
  },
  {
    "function_name": "rcu_segcblist_ready_cbs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "278-282",
    "snippet": "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_is_enabled(rsclp) &&\n\t       &rsclp->head != READ_ONCE(rsclp->tails[RCU_DONE_TAIL]);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "rsclp->tails[RCU_DONE_TAIL]"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_is_enabled",
          "args": [
            "rsclp"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_is_enabled",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "78-81",
          "snippet": "static inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_test_flags(rsclp, SEGCBLIST_ENABLED);\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_is_enabled(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_test_flags(rsclp, SEGCBLIST_ENABLED);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp)\n{\n\treturn rcu_segcblist_is_enabled(rsclp) &&\n\t       &rsclp->head != READ_ONCE(rsclp->tails[RCU_DONE_TAIL]);\n}"
  },
  {
    "function_name": "rcu_segcblist_offload",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "266-272",
    "snippet": "void rcu_segcblist_offload(struct rcu_segcblist *rsclp, bool offload)\n{\n\tif (offload)\n\t\trcu_segcblist_set_flags(rsclp, SEGCBLIST_LOCKING | SEGCBLIST_OFFLOADED);\n\telse\n\t\trcu_segcblist_clear_flags(rsclp, SEGCBLIST_OFFLOADED);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_clear_flags",
          "args": [
            "rsclp",
            "SEGCBLIST_OFFLOADED"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_clear_flags",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "62-66",
          "snippet": "static inline void rcu_segcblist_clear_flags(struct rcu_segcblist *rsclp,\n\t\t\t\t\t     int flags)\n{\n\trsclp->flags &= ~flags;\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline void rcu_segcblist_clear_flags(struct rcu_segcblist *rsclp,\n\t\t\t\t\t     int flags)\n{\n\trsclp->flags &= ~flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_set_flags",
          "args": [
            "rsclp",
            "SEGCBLIST_LOCKING | SEGCBLIST_OFFLOADED"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_set_flags",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "56-60",
          "snippet": "static inline void rcu_segcblist_set_flags(struct rcu_segcblist *rsclp,\n\t\t\t\t\t   int flags)\n{\n\trsclp->flags |= flags;\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline void rcu_segcblist_set_flags(struct rcu_segcblist *rsclp,\n\t\t\t\t\t   int flags)\n{\n\trsclp->flags |= flags;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_offload(struct rcu_segcblist *rsclp, bool offload)\n{\n\tif (offload)\n\t\trcu_segcblist_set_flags(rsclp, SEGCBLIST_LOCKING | SEGCBLIST_OFFLOADED);\n\telse\n\t\trcu_segcblist_clear_flags(rsclp, SEGCBLIST_OFFLOADED);\n}"
  },
  {
    "function_name": "rcu_segcblist_disable",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "256-261",
    "snippet": "void rcu_segcblist_disable(struct rcu_segcblist *rsclp)\n{\n\tWARN_ON_ONCE(!rcu_segcblist_empty(rsclp));\n\tWARN_ON_ONCE(rcu_segcblist_n_cbs(rsclp));\n\trcu_segcblist_clear_flags(rsclp, SEGCBLIST_ENABLED);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_clear_flags",
          "args": [
            "rsclp",
            "SEGCBLIST_ENABLED"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_clear_flags",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "62-66",
          "snippet": "static inline void rcu_segcblist_clear_flags(struct rcu_segcblist *rsclp,\n\t\t\t\t\t     int flags)\n{\n\trsclp->flags &= ~flags;\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline void rcu_segcblist_clear_flags(struct rcu_segcblist *rsclp,\n\t\t\t\t\t     int flags)\n{\n\trsclp->flags &= ~flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "rcu_segcblist_n_cbs(rsclp)"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_n_cbs",
          "args": [
            "rsclp"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_n_cbs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "47-54",
          "snippet": "static inline long rcu_segcblist_n_cbs(struct rcu_segcblist *rsclp)\n{\n#ifdef CONFIG_RCU_NOCB_CPU\n\treturn atomic_long_read(&rsclp->len);\n#else\n\treturn READ_ONCE(rsclp->len);\n#endif\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline long rcu_segcblist_n_cbs(struct rcu_segcblist *rsclp)\n{\n#ifdef CONFIG_RCU_NOCB_CPU\n\treturn atomic_long_read(&rsclp->len);\n#else\n\treturn READ_ONCE(rsclp->len);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!rcu_segcblist_empty(rsclp)"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_empty",
          "args": [
            "rsclp"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_empty",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "41-44",
          "snippet": "static inline bool rcu_segcblist_empty(struct rcu_segcblist *rsclp)\n{\n\treturn !READ_ONCE(rsclp->head);\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_empty(struct rcu_segcblist *rsclp)\n{\n\treturn !READ_ONCE(rsclp->head);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp)\n{\n\tWARN_ON_ONCE(!rcu_segcblist_empty(rsclp));\n\tWARN_ON_ONCE(rcu_segcblist_n_cbs(rsclp));\n\trcu_segcblist_clear_flags(rsclp, SEGCBLIST_ENABLED);\n}"
  },
  {
    "function_name": "rcu_segcblist_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "237-250",
    "snippet": "void rcu_segcblist_init(struct rcu_segcblist *rsclp)\n{\n\tint i;\n\n\tBUILD_BUG_ON(RCU_NEXT_TAIL + 1 != ARRAY_SIZE(rsclp->gp_seq));\n\tBUILD_BUG_ON(ARRAY_SIZE(rsclp->tails) != ARRAY_SIZE(rsclp->gp_seq));\n\trsclp->head = NULL;\n\tfor (i = 0; i < RCU_CBLIST_NSEGS; i++) {\n\t\trsclp->tails[i] = &rsclp->head;\n\t\trcu_segcblist_set_seglen(rsclp, i, 0);\n\t}\n\trcu_segcblist_set_len(rsclp, 0);\n\trcu_segcblist_set_flags(rsclp, SEGCBLIST_ENABLED);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_set_flags",
          "args": [
            "rsclp",
            "SEGCBLIST_ENABLED"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_set_flags",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "56-60",
          "snippet": "static inline void rcu_segcblist_set_flags(struct rcu_segcblist *rsclp,\n\t\t\t\t\t   int flags)\n{\n\trsclp->flags |= flags;\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline void rcu_segcblist_set_flags(struct rcu_segcblist *rsclp,\n\t\t\t\t\t   int flags)\n{\n\trsclp->flags |= flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_set_len",
          "args": [
            "rsclp",
            "0"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_set_len",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "82-89",
          "snippet": "static void rcu_segcblist_set_len(struct rcu_segcblist *rsclp, long v)\n{\n#ifdef CONFIG_RCU_NOCB_CPU\n\tatomic_long_set(&rsclp->len, v);\n#else\n\tWRITE_ONCE(rsclp->len, v);\n#endif\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_set_len(struct rcu_segcblist *rsclp, long v)\n{\n#ifdef CONFIG_RCU_NOCB_CPU\n\tatomic_long_set(&rsclp->len, v);\n#else\n\tWRITE_ONCE(rsclp->len, v);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_set_seglen",
          "args": [
            "rsclp",
            "i",
            "0"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_set_seglen",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "110-113",
          "snippet": "static void rcu_segcblist_set_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], v);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_set_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "ARRAY_SIZE(rsclp->tails) != ARRAY_SIZE(rsclp->gp_seq)"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "rsclp->gp_seq"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "rsclp->tails"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "RCU_NEXT_TAIL + 1 != ARRAY_SIZE(rsclp->gp_seq)"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "rsclp->gp_seq"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp)\n{\n\tint i;\n\n\tBUILD_BUG_ON(RCU_NEXT_TAIL + 1 != ARRAY_SIZE(rsclp->gp_seq));\n\tBUILD_BUG_ON(ARRAY_SIZE(rsclp->tails) != ARRAY_SIZE(rsclp->gp_seq));\n\trsclp->head = NULL;\n\tfor (i = 0; i < RCU_CBLIST_NSEGS; i++) {\n\t\trsclp->tails[i] = &rsclp->head;\n\t\trcu_segcblist_set_seglen(rsclp, i, 0);\n\t}\n\trcu_segcblist_set_len(rsclp, 0);\n\trcu_segcblist_set_flags(rsclp, SEGCBLIST_ENABLED);\n}"
  },
  {
    "function_name": "rcu_segcblist_inc_len",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "229-232",
    "snippet": "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp)\n{\n\trcu_segcblist_add_len(rsclp, 1);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_add_len",
          "args": [
            "rsclp",
            "1"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_add_len",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "210-221",
          "snippet": "void rcu_segcblist_add_len(struct rcu_segcblist *rsclp, long v)\n{\n#ifdef CONFIG_RCU_NOCB_CPU\n\tsmp_mb__before_atomic(); // Read header comment above.\n\tatomic_long_add(v, &rsclp->len);\n\tsmp_mb__after_atomic();  // Read header comment above.\n#else\n\tsmp_mb(); // Read header comment above.\n\tWRITE_ONCE(rsclp->len, rsclp->len + v);\n\tsmp_mb(); // Read header comment above.\n#endif\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_add_len(struct rcu_segcblist *rsclp, long v)\n{\n#ifdef CONFIG_RCU_NOCB_CPU\n\tsmp_mb__before_atomic(); // Read header comment above.\n\tatomic_long_add(v, &rsclp->len);\n\tsmp_mb__after_atomic();  // Read header comment above.\n#else\n\tsmp_mb(); // Read header comment above.\n\tWRITE_ONCE(rsclp->len, rsclp->len + v);\n\tsmp_mb(); // Read header comment above.\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp)\n{\n\trcu_segcblist_add_len(rsclp, 1);\n}"
  },
  {
    "function_name": "rcu_segcblist_add_len",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "210-221",
    "snippet": "void rcu_segcblist_add_len(struct rcu_segcblist *rsclp, long v)\n{\n#ifdef CONFIG_RCU_NOCB_CPU\n\tsmp_mb__before_atomic(); // Read header comment above.\n\tatomic_long_add(v, &rsclp->len);\n\tsmp_mb__after_atomic();  // Read header comment above.\n#else\n\tsmp_mb(); // Read header comment above.\n\tWRITE_ONCE(rsclp->len, rsclp->len + v);\n\tsmp_mb(); // Read header comment above.\n#endif\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_mb",
          "args": [],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->len",
            "rsclp->len + v"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_mb",
          "args": [],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_mb__after_atomic",
          "args": [],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_long_add",
          "args": [
            "v",
            "&rsclp->len"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_mb__before_atomic",
          "args": [],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_segcblist_add_len(struct rcu_segcblist *rsclp, long v)\n{\n#ifdef CONFIG_RCU_NOCB_CPU\n\tsmp_mb__before_atomic(); // Read header comment above.\n\tatomic_long_add(v, &rsclp->len);\n\tsmp_mb__after_atomic();  // Read header comment above.\n#else\n\tsmp_mb(); // Read header comment above.\n\tWRITE_ONCE(rsclp->len, rsclp->len + v);\n\tsmp_mb(); // Read header comment above.\n#endif\n}"
  },
  {
    "function_name": "rcu_segcblist_inc_seglen",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "138-141",
    "snippet": "static void rcu_segcblist_inc_seglen(struct rcu_segcblist *rsclp, int seg)\n{\n\trcu_segcblist_add_seglen(rsclp, seg, 1);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_add_seglen",
          "args": [
            "rsclp",
            "seg",
            "1"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_add_seglen",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "116-119",
          "snippet": "static void rcu_segcblist_add_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], rsclp->seglen[seg] + v);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_add_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], rsclp->seglen[seg] + v);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_inc_seglen(struct rcu_segcblist *rsclp, int seg)\n{\n\trcu_segcblist_add_seglen(rsclp, seg, 1);\n}"
  },
  {
    "function_name": "rcu_segcblist_move_seglen",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "122-135",
    "snippet": "static void rcu_segcblist_move_seglen(struct rcu_segcblist *rsclp, int from, int to)\n{\n\tlong len;\n\n\tif (from == to)\n\t\treturn;\n\n\tlen = rcu_segcblist_get_seglen(rsclp, from);\n\tif (!len)\n\t\treturn;\n\n\trcu_segcblist_add_seglen(rsclp, to, len);\n\trcu_segcblist_set_seglen(rsclp, from, 0);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_set_seglen",
          "args": [
            "rsclp",
            "from",
            "0"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_set_seglen",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "110-113",
          "snippet": "static void rcu_segcblist_set_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], v);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_set_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_add_seglen",
          "args": [
            "rsclp",
            "to",
            "len"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_add_seglen",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "116-119",
          "snippet": "static void rcu_segcblist_add_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], rsclp->seglen[seg] + v);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_add_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], rsclp->seglen[seg] + v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_segcblist_get_seglen",
          "args": [
            "rsclp",
            "from"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_get_seglen",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "92-95",
          "snippet": "static long rcu_segcblist_get_seglen(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn READ_ONCE(rsclp->seglen[seg]);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic long rcu_segcblist_get_seglen(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn READ_ONCE(rsclp->seglen[seg]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_move_seglen(struct rcu_segcblist *rsclp, int from, int to)\n{\n\tlong len;\n\n\tif (from == to)\n\t\treturn;\n\n\tlen = rcu_segcblist_get_seglen(rsclp, from);\n\tif (!len)\n\t\treturn;\n\n\trcu_segcblist_add_seglen(rsclp, to, len);\n\trcu_segcblist_set_seglen(rsclp, from, 0);\n}"
  },
  {
    "function_name": "rcu_segcblist_add_seglen",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "116-119",
    "snippet": "static void rcu_segcblist_add_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], rsclp->seglen[seg] + v);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->seglen[seg]",
            "rsclp->seglen[seg] + v"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_add_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], rsclp->seglen[seg] + v);\n}"
  },
  {
    "function_name": "rcu_segcblist_set_seglen",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "110-113",
    "snippet": "static void rcu_segcblist_set_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], v);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->seglen[seg]",
            "v"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_set_seglen(struct rcu_segcblist *rsclp, int seg, long v)\n{\n\tWRITE_ONCE(rsclp->seglen[seg], v);\n}"
  },
  {
    "function_name": "rcu_segcblist_n_segment_cbs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "98-107",
    "snippet": "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp)\n{\n\tlong len = 0;\n\tint i;\n\n\tfor (i = RCU_DONE_TAIL; i < RCU_CBLIST_NSEGS; i++)\n\t\tlen += rcu_segcblist_get_seglen(rsclp, i);\n\n\treturn len;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_segcblist_get_seglen",
          "args": [
            "rsclp",
            "i"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_get_seglen",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "92-95",
          "snippet": "static long rcu_segcblist_get_seglen(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn READ_ONCE(rsclp->seglen[seg]);\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic long rcu_segcblist_get_seglen(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn READ_ONCE(rsclp->seglen[seg]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp)\n{\n\tlong len = 0;\n\tint i;\n\n\tfor (i = RCU_DONE_TAIL; i < RCU_CBLIST_NSEGS; i++)\n\t\tlen += rcu_segcblist_get_seglen(rsclp, i);\n\n\treturn len;\n}"
  },
  {
    "function_name": "rcu_segcblist_get_seglen",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "92-95",
    "snippet": "static long rcu_segcblist_get_seglen(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn READ_ONCE(rsclp->seglen[seg]);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "rsclp->seglen[seg]"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic long rcu_segcblist_get_seglen(struct rcu_segcblist *rsclp, int seg)\n{\n\treturn READ_ONCE(rsclp->seglen[seg]);\n}"
  },
  {
    "function_name": "rcu_segcblist_set_len",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "82-89",
    "snippet": "static void rcu_segcblist_set_len(struct rcu_segcblist *rsclp, long v)\n{\n#ifdef CONFIG_RCU_NOCB_CPU\n\tatomic_long_set(&rsclp->len, v);\n#else\n\tWRITE_ONCE(rsclp->len, v);\n#endif\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rsclp->len",
            "v"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_long_set",
          "args": [
            "&rsclp->len",
            "v"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstatic void rcu_segcblist_set_len(struct rcu_segcblist *rsclp, long v)\n{\n#ifdef CONFIG_RCU_NOCB_CPU\n\tatomic_long_set(&rsclp->len, v);\n#else\n\tWRITE_ONCE(rsclp->len, v);\n#endif\n}"
  },
  {
    "function_name": "rcu_cblist_dequeue",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "67-79",
    "snippet": "struct rcu_head *rcu_cblist_dequeue(struct rcu_cblist *rclp)\n{\n\tstruct rcu_head *rhp;\n\n\trhp = rclp->head;\n\tif (!rhp)\n\t\treturn NULL;\n\trclp->len--;\n\trclp->head = rhp->next;\n\tif (!rclp->head)\n\t\trclp->tail = &rclp->head;\n\treturn rhp;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nstruct rcu_head *rcu_cblist_dequeue(struct rcu_cblist *rclp)\n{\n\tstruct rcu_head *rhp;\n\n\trhp = rclp->head;\n\tif (!rhp)\n\t\treturn NULL;\n\trclp->len--;\n\trclp->head = rhp->next;\n\tif (!rclp->head)\n\t\trclp->tail = &rclp->head;\n\treturn rhp;\n}"
  },
  {
    "function_name": "rcu_cblist_flush_enqueue",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "43-61",
    "snippet": "void rcu_cblist_flush_enqueue(struct rcu_cblist *drclp,\n\t\t\t      struct rcu_cblist *srclp,\n\t\t\t      struct rcu_head *rhp)\n{\n\tdrclp->head = srclp->head;\n\tif (drclp->head)\n\t\tdrclp->tail = srclp->tail;\n\telse\n\t\tdrclp->tail = &drclp->head;\n\tdrclp->len = srclp->len;\n\tif (!rhp) {\n\t\trcu_cblist_init(srclp);\n\t} else {\n\t\trhp->next = NULL;\n\t\tsrclp->head = rhp;\n\t\tsrclp->tail = &rhp->next;\n\t\tWRITE_ONCE(srclp->len, 1);\n\t}\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "srclp->len",
            "1"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_cblist_init",
          "args": [
            "srclp"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_cblist_init",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
          "lines": "18-23",
          "snippet": "void rcu_cblist_init(struct rcu_cblist *rclp)\n{\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n\trclp->len = 0;\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_cblist_init(struct rcu_cblist *rclp)\n{\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n\trclp->len = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_cblist_flush_enqueue(struct rcu_cblist *drclp,\n\t\t\t      struct rcu_cblist *srclp,\n\t\t\t      struct rcu_head *rhp)\n{\n\tdrclp->head = srclp->head;\n\tif (drclp->head)\n\t\tdrclp->tail = srclp->tail;\n\telse\n\t\tdrclp->tail = &drclp->head;\n\tdrclp->len = srclp->len;\n\tif (!rhp) {\n\t\trcu_cblist_init(srclp);\n\t} else {\n\t\trhp->next = NULL;\n\t\tsrclp->head = rhp;\n\t\tsrclp->tail = &rhp->next;\n\t\tWRITE_ONCE(srclp->len, 1);\n\t}\n}"
  },
  {
    "function_name": "rcu_cblist_enqueue",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "28-33",
    "snippet": "void rcu_cblist_enqueue(struct rcu_cblist *rclp, struct rcu_head *rhp)\n{\n\t*rclp->tail = rhp;\n\trclp->tail = &rhp->next;\n\tWRITE_ONCE(rclp->len, rclp->len + 1);\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rclp->len",
            "rclp->len + 1"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_cblist_enqueue(struct rcu_cblist *rclp, struct rcu_head *rhp)\n{\n\t*rclp->tail = rhp;\n\trclp->tail = &rhp->next;\n\tWRITE_ONCE(rclp->len, rclp->len + 1);\n}"
  },
  {
    "function_name": "rcu_cblist_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.c",
    "lines": "18-23",
    "snippet": "void rcu_cblist_init(struct rcu_cblist *rclp)\n{\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n\trclp->len = 0;\n}",
    "includes": [
      "#include \"rcu_segcblist.h\"",
      "#include <linux/types.h>",
      "#include <linux/kernel.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/cpu.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/interrupt.h>\n#include <linux/cpu.h>\n\nvoid rcu_cblist_init(struct rcu_cblist *rclp)\n{\n\trclp->head = NULL;\n\trclp->tail = &rclp->head;\n\trclp->len = 0;\n}"
  }
]