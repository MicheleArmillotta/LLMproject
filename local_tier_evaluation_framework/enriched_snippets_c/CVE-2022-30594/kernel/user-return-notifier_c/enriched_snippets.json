[
  {
    "function_name": "fire_user_return_notifiers",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/user-return-notifier.c",
    "lines": "35-45",
    "snippet": "void fire_user_return_notifiers(void)\n{\n\tstruct user_return_notifier *urn;\n\tstruct hlist_node *tmp2;\n\tstruct hlist_head *head;\n\n\thead = &get_cpu_var(return_notifier_list);\n\thlist_for_each_entry_safe(urn, tmp2, head, link)\n\t\turn->on_user_return(urn);\n\tput_cpu_var(return_notifier_list);\n}",
    "includes": [
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/percpu.h>",
      "#include <linux/user-return-notifier.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_PER_CPU(struct hlist_head, return_notifier_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_cpu_var",
          "args": [
            "return_notifier_list"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_for_each_entry_safe",
          "args": [
            "urn"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_for_each_entry_safe",
          "args": [
            "urn",
            "tmp2",
            "head",
            "link"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpu_var",
          "args": [
            "return_notifier_list"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/percpu.h>\n#include <linux/user-return-notifier.h>\n\nstatic DEFINE_PER_CPU(struct hlist_head, return_notifier_list);\n\nvoid fire_user_return_notifiers(void)\n{\n\tstruct user_return_notifier *urn;\n\tstruct hlist_node *tmp2;\n\tstruct hlist_head *head;\n\n\thead = &get_cpu_var(return_notifier_list);\n\thlist_for_each_entry_safe(urn, tmp2, head, link)\n\t\turn->on_user_return(urn);\n\tput_cpu_var(return_notifier_list);\n}"
  },
  {
    "function_name": "user_return_notifier_unregister",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/user-return-notifier.c",
    "lines": "26-31",
    "snippet": "void user_return_notifier_unregister(struct user_return_notifier *urn)\n{\n\thlist_del(&urn->link);\n\tif (hlist_empty(this_cpu_ptr(&return_notifier_list)))\n\t\tclear_tsk_thread_flag(current, TIF_USER_RETURN_NOTIFY);\n}",
    "includes": [
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/percpu.h>",
      "#include <linux/user-return-notifier.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_PER_CPU(struct hlist_head, return_notifier_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "clear_tsk_thread_flag",
          "args": [
            "current",
            "TIF_USER_RETURN_NOTIFY"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_empty",
          "args": [
            "this_cpu_ptr(&return_notifier_list)"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&return_notifier_list"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_del",
          "args": [
            "&urn->link"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/percpu.h>\n#include <linux/user-return-notifier.h>\n\nstatic DEFINE_PER_CPU(struct hlist_head, return_notifier_list);\n\nvoid user_return_notifier_unregister(struct user_return_notifier *urn)\n{\n\thlist_del(&urn->link);\n\tif (hlist_empty(this_cpu_ptr(&return_notifier_list)))\n\t\tclear_tsk_thread_flag(current, TIF_USER_RETURN_NOTIFY);\n}"
  },
  {
    "function_name": "user_return_notifier_register",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/user-return-notifier.c",
    "lines": "15-19",
    "snippet": "void user_return_notifier_register(struct user_return_notifier *urn)\n{\n\tset_tsk_thread_flag(current, TIF_USER_RETURN_NOTIFY);\n\thlist_add_head(&urn->link, this_cpu_ptr(&return_notifier_list));\n}",
    "includes": [
      "#include <linux/export.h>",
      "#include <linux/sched.h>",
      "#include <linux/percpu.h>",
      "#include <linux/user-return-notifier.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_PER_CPU(struct hlist_head, return_notifier_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_add_head",
          "args": [
            "&urn->link",
            "this_cpu_ptr(&return_notifier_list)"
          ],
          "line": 18
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&return_notifier_list"
          ],
          "line": 18
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_tsk_thread_flag",
          "args": [
            "current",
            "TIF_USER_RETURN_NOTIFY"
          ],
          "line": 17
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/percpu.h>\n#include <linux/user-return-notifier.h>\n\nstatic DEFINE_PER_CPU(struct hlist_head, return_notifier_list);\n\nvoid user_return_notifier_register(struct user_return_notifier *urn)\n{\n\tset_tsk_thread_flag(current, TIF_USER_RETURN_NOTIFY);\n\thlist_add_head(&urn->link, this_cpu_ptr(&return_notifier_list));\n}"
  }
]