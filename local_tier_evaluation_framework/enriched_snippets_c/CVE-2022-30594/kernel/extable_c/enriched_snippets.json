[
  {
    "function_name": "func_ptr_is_kernel_text",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/extable.c",
    "lines": "141-148",
    "snippet": "int func_ptr_is_kernel_text(void *ptr)\n{\n\tunsigned long addr;\n\taddr = (unsigned long) dereference_function_descriptor(ptr);\n\tif (core_kernel_text(addr))\n\t\treturn 1;\n\treturn is_module_text_address(addr);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include <asm/sections.h>",
      "#include <linux/filter.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/init.h>",
      "#include <linux/mutex.h>",
      "#include <linux/module.h>",
      "#include <linux/extable.h>",
      "#include <linux/memory.h>",
      "#include <linux/ftrace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "is_module_text_address",
          "args": [
            "addr"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "is_module_text_address",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/module.c",
          "lines": "4762-4771",
          "snippet": "bool is_module_text_address(unsigned long addr)\n{\n\tbool ret;\n\n\tpreempt_disable();\n\tret = __module_text_address(addr) != NULL;\n\tpreempt_enable();\n\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel_read_file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/buildid.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/module_signature.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel_read_file.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/buildid.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/module_signature.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nbool is_module_text_address(unsigned long addr)\n{\n\tbool ret;\n\n\tpreempt_disable();\n\tret = __module_text_address(addr) != NULL;\n\tpreempt_enable();\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "core_kernel_text",
          "args": [
            "addr"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "core_kernel_text",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/extable.c",
          "lines": "65-74",
          "snippet": "int notrace core_kernel_text(unsigned long addr)\n{\n\tif (is_kernel_text(addr))\n\t\treturn 1;\n\n\tif (system_state < SYSTEM_FREEING_INITMEM &&\n\t    is_kernel_inittext(addr))\n\t\treturn 1;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <asm/sections.h>",
            "#include <linux/filter.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/init.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/extable.h>",
            "#include <linux/memory.h>",
            "#include <linux/ftrace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <asm/sections.h>\n#include <linux/filter.h>\n#include <linux/kprobes.h>\n#include <linux/init.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/extable.h>\n#include <linux/memory.h>\n#include <linux/ftrace.h>\n\nint notrace core_kernel_text(unsigned long addr)\n{\n\tif (is_kernel_text(addr))\n\t\treturn 1;\n\n\tif (system_state < SYSTEM_FREEING_INITMEM &&\n\t    is_kernel_inittext(addr))\n\t\treturn 1;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dereference_function_descriptor",
          "args": [
            "ptr"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include <asm/sections.h>\n#include <linux/filter.h>\n#include <linux/kprobes.h>\n#include <linux/init.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/extable.h>\n#include <linux/memory.h>\n#include <linux/ftrace.h>\n\nint func_ptr_is_kernel_text(void *ptr)\n{\n\tunsigned long addr;\n\taddr = (unsigned long) dereference_function_descriptor(ptr);\n\tif (core_kernel_text(addr))\n\t\treturn 1;\n\treturn is_module_text_address(addr);\n}"
  },
  {
    "function_name": "kernel_text_address",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/extable.c",
    "lines": "93-132",
    "snippet": "int kernel_text_address(unsigned long addr)\n{\n\tbool no_rcu;\n\tint ret = 1;\n\n\tif (core_kernel_text(addr))\n\t\treturn 1;\n\n\t/*\n\t * If a stack dump happens while RCU is not watching, then\n\t * RCU needs to be notified that it requires to start\n\t * watching again. This can happen either by tracing that\n\t * triggers a stack trace, or a WARN() that happens during\n\t * coming back from idle, or cpu on or offlining.\n\t *\n\t * is_module_text_address() as well as the kprobe slots,\n\t * is_bpf_text_address() and is_bpf_image_address require\n\t * RCU to be watching.\n\t */\n\tno_rcu = !rcu_is_watching();\n\n\t/* Treat this like an NMI as it can happen anywhere */\n\tif (no_rcu)\n\t\trcu_nmi_enter();\n\n\tif (is_module_text_address(addr))\n\t\tgoto out;\n\tif (is_ftrace_trampoline(addr))\n\t\tgoto out;\n\tif (is_kprobe_optinsn_slot(addr) || is_kprobe_insn_slot(addr))\n\t\tgoto out;\n\tif (is_bpf_text_address(addr))\n\t\tgoto out;\n\tret = 0;\nout:\n\tif (no_rcu)\n\t\trcu_nmi_exit();\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include <asm/sections.h>",
      "#include <linux/filter.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/init.h>",
      "#include <linux/mutex.h>",
      "#include <linux/module.h>",
      "#include <linux/extable.h>",
      "#include <linux/memory.h>",
      "#include <linux/ftrace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_nmi_exit",
          "args": [],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_nmi_exit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tree.c",
          "lines": "740-780",
          "snippet": "noinstr void rcu_nmi_exit(void)\n{\n\tstruct rcu_data *rdp = this_cpu_ptr(&rcu_data);\n\n\tinstrumentation_begin();\n\t/*\n\t * Check for ->dynticks_nmi_nesting underflow and bad ->dynticks.\n\t * (We are exiting an NMI handler, so RCU better be paying attention\n\t * to us!)\n\t */\n\tWARN_ON_ONCE(rdp->dynticks_nmi_nesting <= 0);\n\tWARN_ON_ONCE(rcu_dynticks_curr_cpu_in_eqs());\n\n\t/*\n\t * If the nesting level is not 1, the CPU wasn't RCU-idle, so\n\t * leave it in non-RCU-idle state.\n\t */\n\tif (rdp->dynticks_nmi_nesting != 1) {\n\t\ttrace_rcu_dyntick(TPS(\"--=\"), rdp->dynticks_nmi_nesting, rdp->dynticks_nmi_nesting - 2,\n\t\t\t\t  atomic_read(&rdp->dynticks));\n\t\tWRITE_ONCE(rdp->dynticks_nmi_nesting, /* No store tearing. */\n\t\t\t   rdp->dynticks_nmi_nesting - 2);\n\t\tinstrumentation_end();\n\t\treturn;\n\t}\n\n\t/* This NMI interrupted an RCU-idle CPU, restore RCU-idleness. */\n\ttrace_rcu_dyntick(TPS(\"Startirq\"), rdp->dynticks_nmi_nesting, 0, atomic_read(&rdp->dynticks));\n\tWRITE_ONCE(rdp->dynticks_nmi_nesting, 0); /* Avoid store tearing. */\n\n\t// instrumentation for the noinstr rcu_dynticks_eqs_enter()\n\tinstrument_atomic_write(&rdp->dynticks, sizeof(rdp->dynticks));\n\tinstrumentation_end();\n\n\t// RCU is watching here ...\n\trcu_dynticks_eqs_enter();\n\t// ... but is no longer watching here.\n\n\tif (!in_nmi())\n\t\trcu_dynticks_task_enter();\n}",
          "includes": [
            "#include \"tree_plugin.h\"",
            "#include \"tree_nocb.h\"",
            "#include \"tree_exp.h\"",
            "#include \"tree_stall.h\"",
            "#include \"rcu.h\"",
            "#include \"tree.h\"",
            "#include \"../time/tick-internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/oom.h>",
            "#include <linux/gfp.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/tick.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/suspend.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/random.h>",
            "#include <linux/delay.h>",
            "#include <linux/prefetch.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/kthread.h>",
            "#include <linux/wait.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/time.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/panic_notifier.h>",
            "#include <linux/panic.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/completion.h>",
            "#include <linux/export.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/nmi.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_PER_CPU_SHARED_ALIGNED(struct rcu_data, rcu_data) = {\n\t.dynticks_nesting = 1,\n\t.dynticks_nmi_nesting = DYNTICK_IRQ_NONIDLE,\n\t.dynticks = ATOMIC_INIT(1),\n#ifdef CONFIG_RCU_NOCB_CPU\n\t.cblist.flags = SEGCBLIST_RCU_CORE,\n#endif\n};",
            "static void rcu_report_exp_rdp(struct rcu_data *rdp);",
            "static bool rcu_rdp_is_offloaded(struct rcu_data *rdp);",
            "static noinline noinstr",
            "static void force_qs_rnp(int (*f)(struct rcu_data *rdp));"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tree_plugin.h\"\n#include \"tree_nocb.h\"\n#include \"tree_exp.h\"\n#include \"tree_stall.h\"\n#include \"rcu.h\"\n#include \"tree.h\"\n#include \"../time/tick-internal.h\"\n#include <linux/kasan.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/isolation.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/smpboot.h>\n#include <linux/oom.h>\n#include <linux/gfp.h>\n#include <linux/kprobes.h>\n#include <linux/sysrq.h>\n#include <linux/tick.h>\n#include <linux/ftrace.h>\n#include <linux/suspend.h>\n#include <linux/trace_events.h>\n#include <linux/random.h>\n#include <linux/delay.h>\n#include <linux/prefetch.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/kthread.h>\n#include <linux/wait.h>\n#include <linux/kernel_stat.h>\n#include <linux/time.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/panic_notifier.h>\n#include <linux/panic.h>\n#include <linux/moduleparam.h>\n#include <linux/completion.h>\n#include <linux/export.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/nmi.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic DEFINE_PER_CPU_SHARED_ALIGNED(struct rcu_data, rcu_data) = {\n\t.dynticks_nesting = 1,\n\t.dynticks_nmi_nesting = DYNTICK_IRQ_NONIDLE,\n\t.dynticks = ATOMIC_INIT(1),\n#ifdef CONFIG_RCU_NOCB_CPU\n\t.cblist.flags = SEGCBLIST_RCU_CORE,\n#endif\n};\nstatic void rcu_report_exp_rdp(struct rcu_data *rdp);\nstatic bool rcu_rdp_is_offloaded(struct rcu_data *rdp);\nstatic noinline noinstr;\nstatic void force_qs_rnp(int (*f)(struct rcu_data *rdp));\n\nnoinstr void rcu_nmi_exit(void)\n{\n\tstruct rcu_data *rdp = this_cpu_ptr(&rcu_data);\n\n\tinstrumentation_begin();\n\t/*\n\t * Check for ->dynticks_nmi_nesting underflow and bad ->dynticks.\n\t * (We are exiting an NMI handler, so RCU better be paying attention\n\t * to us!)\n\t */\n\tWARN_ON_ONCE(rdp->dynticks_nmi_nesting <= 0);\n\tWARN_ON_ONCE(rcu_dynticks_curr_cpu_in_eqs());\n\n\t/*\n\t * If the nesting level is not 1, the CPU wasn't RCU-idle, so\n\t * leave it in non-RCU-idle state.\n\t */\n\tif (rdp->dynticks_nmi_nesting != 1) {\n\t\ttrace_rcu_dyntick(TPS(\"--=\"), rdp->dynticks_nmi_nesting, rdp->dynticks_nmi_nesting - 2,\n\t\t\t\t  atomic_read(&rdp->dynticks));\n\t\tWRITE_ONCE(rdp->dynticks_nmi_nesting, /* No store tearing. */\n\t\t\t   rdp->dynticks_nmi_nesting - 2);\n\t\tinstrumentation_end();\n\t\treturn;\n\t}\n\n\t/* This NMI interrupted an RCU-idle CPU, restore RCU-idleness. */\n\ttrace_rcu_dyntick(TPS(\"Startirq\"), rdp->dynticks_nmi_nesting, 0, atomic_read(&rdp->dynticks));\n\tWRITE_ONCE(rdp->dynticks_nmi_nesting, 0); /* Avoid store tearing. */\n\n\t// instrumentation for the noinstr rcu_dynticks_eqs_enter()\n\tinstrument_atomic_write(&rdp->dynticks, sizeof(rdp->dynticks));\n\tinstrumentation_end();\n\n\t// RCU is watching here ...\n\trcu_dynticks_eqs_enter();\n\t// ... but is no longer watching here.\n\n\tif (!in_nmi())\n\t\trcu_dynticks_task_enter();\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_bpf_text_address",
          "args": [
            "addr"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "is_bpf_text_address",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/core.c",
          "lines": "711-720",
          "snippet": "bool is_bpf_text_address(unsigned long addr)\n{\n\tbool ret;\n\n\trcu_read_lock();\n\tret = bpf_ksym_find(addr) != NULL;\n\trcu_read_unlock();\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <asm/unaligned.h>",
            "#include <asm/barrier.h>",
            "#include <linux/bpf_verifier.h>",
            "#include <linux/log2.h>",
            "#include <linux/extable.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/rbtree_latch.h>",
            "#include <linux/objtool.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/random.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/skbuff.h>",
            "#include <linux/filter.h>",
            "#include <uapi/linux/btf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <asm/unaligned.h>\n#include <asm/barrier.h>\n#include <linux/bpf_verifier.h>\n#include <linux/log2.h>\n#include <linux/extable.h>\n#include <linux/perf_event.h>\n#include <linux/rcupdate.h>\n#include <linux/kallsyms.h>\n#include <linux/rbtree_latch.h>\n#include <linux/objtool.h>\n#include <linux/btf.h>\n#include <linux/bpf.h>\n#include <linux/moduleloader.h>\n#include <linux/random.h>\n#include <linux/vmalloc.h>\n#include <linux/skbuff.h>\n#include <linux/filter.h>\n#include <uapi/linux/btf.h>\n\nbool is_bpf_text_address(unsigned long addr)\n{\n\tbool ret;\n\n\trcu_read_lock();\n\tret = bpf_ksym_find(addr) != NULL;\n\trcu_read_unlock();\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_kprobe_insn_slot",
          "args": [
            "addr"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_kprobe_optinsn_slot",
          "args": [
            "addr"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_ftrace_trampoline",
          "args": [
            "addr"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "is_ftrace_trampoline",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/ftrace.c",
          "lines": "1080-1083",
          "snippet": "bool is_ftrace_trampoline(unsigned long addr)\n{\n\treturn ftrace_ops_trampoline(addr) != NULL;\n}",
          "includes": [
            "#include \"trace_stat.h\"",
            "#include \"trace_output.h\"",
            "#include \"ftrace_internal.h\"",
            "#include <asm/setup.h>",
            "#include <asm/sections.h>",
            "#include <trace/events/sched.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/hash.h>",
            "#include <linux/list.h>",
            "#include <linux/sort.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/module.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/kthread.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/tracefs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/stop_machine.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_stat.h\"\n#include \"trace_output.h\"\n#include \"ftrace_internal.h\"\n#include <asm/setup.h>\n#include <asm/sections.h>\n#include <trace/events/sched.h>\n#include <linux/kprobes.h>\n#include <linux/rcupdate.h>\n#include <linux/hash.h>\n#include <linux/list.h>\n#include <linux/sort.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/sysctl.h>\n#include <linux/ftrace.h>\n#include <linux/module.h>\n#include <linux/bsearch.h>\n#include <linux/uaccess.h>\n#include <linux/kthread.h>\n#include <linux/hardirq.h>\n#include <linux/tracefs.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/kallsyms.h>\n#include <linux/sched/task.h>\n#include <linux/clocksource.h>\n#include <linux/stop_machine.h>\n\nbool is_ftrace_trampoline(unsigned long addr)\n{\n\treturn ftrace_ops_trampoline(addr) != NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_module_text_address",
          "args": [
            "addr"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "is_module_text_address",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/module.c",
          "lines": "4762-4771",
          "snippet": "bool is_module_text_address(unsigned long addr)\n{\n\tbool ret;\n\n\tpreempt_disable();\n\tret = __module_text_address(addr) != NULL;\n\tpreempt_enable();\n\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel_read_file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/buildid.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/module_signature.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel_read_file.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/buildid.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/module_signature.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nbool is_module_text_address(unsigned long addr)\n{\n\tbool ret;\n\n\tpreempt_disable();\n\tret = __module_text_address(addr) != NULL;\n\tpreempt_enable();\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_nmi_enter",
          "args": [],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_nmi_enter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tree.c",
          "lines": "987-1033",
          "snippet": "noinstr void rcu_nmi_enter(void)\n{\n\tlong incby = 2;\n\tstruct rcu_data *rdp = this_cpu_ptr(&rcu_data);\n\n\t/* Complain about underflow. */\n\tWARN_ON_ONCE(rdp->dynticks_nmi_nesting < 0);\n\n\t/*\n\t * If idle from RCU viewpoint, atomically increment ->dynticks\n\t * to mark non-idle and increment ->dynticks_nmi_nesting by one.\n\t * Otherwise, increment ->dynticks_nmi_nesting by two.  This means\n\t * if ->dynticks_nmi_nesting is equal to one, we are guaranteed\n\t * to be in the outermost NMI handler that interrupted an RCU-idle\n\t * period (observation due to Andy Lutomirski).\n\t */\n\tif (rcu_dynticks_curr_cpu_in_eqs()) {\n\n\t\tif (!in_nmi())\n\t\t\trcu_dynticks_task_exit();\n\n\t\t// RCU is not watching here ...\n\t\trcu_dynticks_eqs_exit();\n\t\t// ... but is watching here.\n\n\t\tinstrumentation_begin();\n\t\t// instrumentation for the noinstr rcu_dynticks_curr_cpu_in_eqs()\n\t\tinstrument_atomic_read(&rdp->dynticks, sizeof(rdp->dynticks));\n\t\t// instrumentation for the noinstr rcu_dynticks_eqs_exit()\n\t\tinstrument_atomic_write(&rdp->dynticks, sizeof(rdp->dynticks));\n\n\t\tincby = 1;\n\t} else if (!in_nmi()) {\n\t\tinstrumentation_begin();\n\t\trcu_irq_enter_check_tick();\n\t} else  {\n\t\tinstrumentation_begin();\n\t}\n\n\ttrace_rcu_dyntick(incby == 1 ? TPS(\"Endirq\") : TPS(\"++=\"),\n\t\t\t  rdp->dynticks_nmi_nesting,\n\t\t\t  rdp->dynticks_nmi_nesting + incby, atomic_read(&rdp->dynticks));\n\tinstrumentation_end();\n\tWRITE_ONCE(rdp->dynticks_nmi_nesting, /* Prevent store tearing. */\n\t\t   rdp->dynticks_nmi_nesting + incby);\n\tbarrier();\n}",
          "includes": [
            "#include \"tree_plugin.h\"",
            "#include \"tree_nocb.h\"",
            "#include \"tree_exp.h\"",
            "#include \"tree_stall.h\"",
            "#include \"rcu.h\"",
            "#include \"tree.h\"",
            "#include \"../time/tick-internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/oom.h>",
            "#include <linux/gfp.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/tick.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/suspend.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/random.h>",
            "#include <linux/delay.h>",
            "#include <linux/prefetch.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/kthread.h>",
            "#include <linux/wait.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/time.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/panic_notifier.h>",
            "#include <linux/panic.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/completion.h>",
            "#include <linux/export.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/nmi.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_PER_CPU_SHARED_ALIGNED(struct rcu_data, rcu_data) = {\n\t.dynticks_nesting = 1,\n\t.dynticks_nmi_nesting = DYNTICK_IRQ_NONIDLE,\n\t.dynticks = ATOMIC_INIT(1),\n#ifdef CONFIG_RCU_NOCB_CPU\n\t.cblist.flags = SEGCBLIST_RCU_CORE,\n#endif\n};",
            "static void rcu_report_exp_rdp(struct rcu_data *rdp);",
            "static bool rcu_rdp_is_offloaded(struct rcu_data *rdp);",
            "static noinline noinstr",
            "static void force_qs_rnp(int (*f)(struct rcu_data *rdp));"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tree_plugin.h\"\n#include \"tree_nocb.h\"\n#include \"tree_exp.h\"\n#include \"tree_stall.h\"\n#include \"rcu.h\"\n#include \"tree.h\"\n#include \"../time/tick-internal.h\"\n#include <linux/kasan.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/isolation.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/smpboot.h>\n#include <linux/oom.h>\n#include <linux/gfp.h>\n#include <linux/kprobes.h>\n#include <linux/sysrq.h>\n#include <linux/tick.h>\n#include <linux/ftrace.h>\n#include <linux/suspend.h>\n#include <linux/trace_events.h>\n#include <linux/random.h>\n#include <linux/delay.h>\n#include <linux/prefetch.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/kthread.h>\n#include <linux/wait.h>\n#include <linux/kernel_stat.h>\n#include <linux/time.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/panic_notifier.h>\n#include <linux/panic.h>\n#include <linux/moduleparam.h>\n#include <linux/completion.h>\n#include <linux/export.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/nmi.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic DEFINE_PER_CPU_SHARED_ALIGNED(struct rcu_data, rcu_data) = {\n\t.dynticks_nesting = 1,\n\t.dynticks_nmi_nesting = DYNTICK_IRQ_NONIDLE,\n\t.dynticks = ATOMIC_INIT(1),\n#ifdef CONFIG_RCU_NOCB_CPU\n\t.cblist.flags = SEGCBLIST_RCU_CORE,\n#endif\n};\nstatic void rcu_report_exp_rdp(struct rcu_data *rdp);\nstatic bool rcu_rdp_is_offloaded(struct rcu_data *rdp);\nstatic noinline noinstr;\nstatic void force_qs_rnp(int (*f)(struct rcu_data *rdp));\n\nnoinstr void rcu_nmi_enter(void)\n{\n\tlong incby = 2;\n\tstruct rcu_data *rdp = this_cpu_ptr(&rcu_data);\n\n\t/* Complain about underflow. */\n\tWARN_ON_ONCE(rdp->dynticks_nmi_nesting < 0);\n\n\t/*\n\t * If idle from RCU viewpoint, atomically increment ->dynticks\n\t * to mark non-idle and increment ->dynticks_nmi_nesting by one.\n\t * Otherwise, increment ->dynticks_nmi_nesting by two.  This means\n\t * if ->dynticks_nmi_nesting is equal to one, we are guaranteed\n\t * to be in the outermost NMI handler that interrupted an RCU-idle\n\t * period (observation due to Andy Lutomirski).\n\t */\n\tif (rcu_dynticks_curr_cpu_in_eqs()) {\n\n\t\tif (!in_nmi())\n\t\t\trcu_dynticks_task_exit();\n\n\t\t// RCU is not watching here ...\n\t\trcu_dynticks_eqs_exit();\n\t\t// ... but is watching here.\n\n\t\tinstrumentation_begin();\n\t\t// instrumentation for the noinstr rcu_dynticks_curr_cpu_in_eqs()\n\t\tinstrument_atomic_read(&rdp->dynticks, sizeof(rdp->dynticks));\n\t\t// instrumentation for the noinstr rcu_dynticks_eqs_exit()\n\t\tinstrument_atomic_write(&rdp->dynticks, sizeof(rdp->dynticks));\n\n\t\tincby = 1;\n\t} else if (!in_nmi()) {\n\t\tinstrumentation_begin();\n\t\trcu_irq_enter_check_tick();\n\t} else  {\n\t\tinstrumentation_begin();\n\t}\n\n\ttrace_rcu_dyntick(incby == 1 ? TPS(\"Endirq\") : TPS(\"++=\"),\n\t\t\t  rdp->dynticks_nmi_nesting,\n\t\t\t  rdp->dynticks_nmi_nesting + incby, atomic_read(&rdp->dynticks));\n\tinstrumentation_end();\n\tWRITE_ONCE(rdp->dynticks_nmi_nesting, /* Prevent store tearing. */\n\t\t   rdp->dynticks_nmi_nesting + incby);\n\tbarrier();\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_is_watching",
          "args": [],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_is_watching",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tree.c",
          "lines": "1123-1131",
          "snippet": "notrace bool rcu_is_watching(void)\n{\n\tbool ret;\n\n\tpreempt_disable_notrace();\n\tret = !rcu_dynticks_curr_cpu_in_eqs();\n\tpreempt_enable_notrace();\n\treturn ret;\n}",
          "includes": [
            "#include \"tree_plugin.h\"",
            "#include \"tree_nocb.h\"",
            "#include \"tree_exp.h\"",
            "#include \"tree_stall.h\"",
            "#include \"rcu.h\"",
            "#include \"tree.h\"",
            "#include \"../time/tick-internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/oom.h>",
            "#include <linux/gfp.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/tick.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/suspend.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/random.h>",
            "#include <linux/delay.h>",
            "#include <linux/prefetch.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/kthread.h>",
            "#include <linux/wait.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/time.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/panic_notifier.h>",
            "#include <linux/panic.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/completion.h>",
            "#include <linux/export.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/nmi.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tree_plugin.h\"\n#include \"tree_nocb.h\"\n#include \"tree_exp.h\"\n#include \"tree_stall.h\"\n#include \"rcu.h\"\n#include \"tree.h\"\n#include \"../time/tick-internal.h\"\n#include <linux/kasan.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/isolation.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/smpboot.h>\n#include <linux/oom.h>\n#include <linux/gfp.h>\n#include <linux/kprobes.h>\n#include <linux/sysrq.h>\n#include <linux/tick.h>\n#include <linux/ftrace.h>\n#include <linux/suspend.h>\n#include <linux/trace_events.h>\n#include <linux/random.h>\n#include <linux/delay.h>\n#include <linux/prefetch.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/kthread.h>\n#include <linux/wait.h>\n#include <linux/kernel_stat.h>\n#include <linux/time.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/panic_notifier.h>\n#include <linux/panic.h>\n#include <linux/moduleparam.h>\n#include <linux/completion.h>\n#include <linux/export.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/nmi.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nnotrace bool rcu_is_watching(void)\n{\n\tbool ret;\n\n\tpreempt_disable_notrace();\n\tret = !rcu_dynticks_curr_cpu_in_eqs();\n\tpreempt_enable_notrace();\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "core_kernel_text",
          "args": [
            "addr"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "core_kernel_text",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/extable.c",
          "lines": "65-74",
          "snippet": "int notrace core_kernel_text(unsigned long addr)\n{\n\tif (is_kernel_text(addr))\n\t\treturn 1;\n\n\tif (system_state < SYSTEM_FREEING_INITMEM &&\n\t    is_kernel_inittext(addr))\n\t\treturn 1;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <asm/sections.h>",
            "#include <linux/filter.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/init.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/extable.h>",
            "#include <linux/memory.h>",
            "#include <linux/ftrace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <asm/sections.h>\n#include <linux/filter.h>\n#include <linux/kprobes.h>\n#include <linux/init.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/extable.h>\n#include <linux/memory.h>\n#include <linux/ftrace.h>\n\nint notrace core_kernel_text(unsigned long addr)\n{\n\tif (is_kernel_text(addr))\n\t\treturn 1;\n\n\tif (system_state < SYSTEM_FREEING_INITMEM &&\n\t    is_kernel_inittext(addr))\n\t\treturn 1;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include <asm/sections.h>\n#include <linux/filter.h>\n#include <linux/kprobes.h>\n#include <linux/init.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/extable.h>\n#include <linux/memory.h>\n#include <linux/ftrace.h>\n\nint kernel_text_address(unsigned long addr)\n{\n\tbool no_rcu;\n\tint ret = 1;\n\n\tif (core_kernel_text(addr))\n\t\treturn 1;\n\n\t/*\n\t * If a stack dump happens while RCU is not watching, then\n\t * RCU needs to be notified that it requires to start\n\t * watching again. This can happen either by tracing that\n\t * triggers a stack trace, or a WARN() that happens during\n\t * coming back from idle, or cpu on or offlining.\n\t *\n\t * is_module_text_address() as well as the kprobe slots,\n\t * is_bpf_text_address() and is_bpf_image_address require\n\t * RCU to be watching.\n\t */\n\tno_rcu = !rcu_is_watching();\n\n\t/* Treat this like an NMI as it can happen anywhere */\n\tif (no_rcu)\n\t\trcu_nmi_enter();\n\n\tif (is_module_text_address(addr))\n\t\tgoto out;\n\tif (is_ftrace_trampoline(addr))\n\t\tgoto out;\n\tif (is_kprobe_optinsn_slot(addr) || is_kprobe_insn_slot(addr))\n\t\tgoto out;\n\tif (is_bpf_text_address(addr))\n\t\tgoto out;\n\tret = 0;\nout:\n\tif (no_rcu)\n\t\trcu_nmi_exit();\n\n\treturn ret;\n}"
  },
  {
    "function_name": "__kernel_text_address",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/extable.c",
    "lines": "76-91",
    "snippet": "int __kernel_text_address(unsigned long addr)\n{\n\tif (kernel_text_address(addr))\n\t\treturn 1;\n\t/*\n\t * There might be init symbols in saved stacktraces.\n\t * Give those symbols a chance to be printed in\n\t * backtraces (such as lockdep traces).\n\t *\n\t * Since we are after the module-symbols check, there's\n\t * no danger of address overlap:\n\t */\n\tif (is_kernel_inittext(addr))\n\t\treturn 1;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include <asm/sections.h>",
      "#include <linux/filter.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/init.h>",
      "#include <linux/mutex.h>",
      "#include <linux/module.h>",
      "#include <linux/extable.h>",
      "#include <linux/memory.h>",
      "#include <linux/ftrace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "is_kernel_inittext",
          "args": [
            "addr"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kernel_text_address",
          "args": [
            "addr"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "kernel_text_address",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/extable.c",
          "lines": "93-132",
          "snippet": "int kernel_text_address(unsigned long addr)\n{\n\tbool no_rcu;\n\tint ret = 1;\n\n\tif (core_kernel_text(addr))\n\t\treturn 1;\n\n\t/*\n\t * If a stack dump happens while RCU is not watching, then\n\t * RCU needs to be notified that it requires to start\n\t * watching again. This can happen either by tracing that\n\t * triggers a stack trace, or a WARN() that happens during\n\t * coming back from idle, or cpu on or offlining.\n\t *\n\t * is_module_text_address() as well as the kprobe slots,\n\t * is_bpf_text_address() and is_bpf_image_address require\n\t * RCU to be watching.\n\t */\n\tno_rcu = !rcu_is_watching();\n\n\t/* Treat this like an NMI as it can happen anywhere */\n\tif (no_rcu)\n\t\trcu_nmi_enter();\n\n\tif (is_module_text_address(addr))\n\t\tgoto out;\n\tif (is_ftrace_trampoline(addr))\n\t\tgoto out;\n\tif (is_kprobe_optinsn_slot(addr) || is_kprobe_insn_slot(addr))\n\t\tgoto out;\n\tif (is_bpf_text_address(addr))\n\t\tgoto out;\n\tret = 0;\nout:\n\tif (no_rcu)\n\t\trcu_nmi_exit();\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <asm/sections.h>",
            "#include <linux/filter.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/init.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/extable.h>",
            "#include <linux/memory.h>",
            "#include <linux/ftrace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <asm/sections.h>\n#include <linux/filter.h>\n#include <linux/kprobes.h>\n#include <linux/init.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/extable.h>\n#include <linux/memory.h>\n#include <linux/ftrace.h>\n\nint kernel_text_address(unsigned long addr)\n{\n\tbool no_rcu;\n\tint ret = 1;\n\n\tif (core_kernel_text(addr))\n\t\treturn 1;\n\n\t/*\n\t * If a stack dump happens while RCU is not watching, then\n\t * RCU needs to be notified that it requires to start\n\t * watching again. This can happen either by tracing that\n\t * triggers a stack trace, or a WARN() that happens during\n\t * coming back from idle, or cpu on or offlining.\n\t *\n\t * is_module_text_address() as well as the kprobe slots,\n\t * is_bpf_text_address() and is_bpf_image_address require\n\t * RCU to be watching.\n\t */\n\tno_rcu = !rcu_is_watching();\n\n\t/* Treat this like an NMI as it can happen anywhere */\n\tif (no_rcu)\n\t\trcu_nmi_enter();\n\n\tif (is_module_text_address(addr))\n\t\tgoto out;\n\tif (is_ftrace_trampoline(addr))\n\t\tgoto out;\n\tif (is_kprobe_optinsn_slot(addr) || is_kprobe_insn_slot(addr))\n\t\tgoto out;\n\tif (is_bpf_text_address(addr))\n\t\tgoto out;\n\tret = 0;\nout:\n\tif (no_rcu)\n\t\trcu_nmi_exit();\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include <asm/sections.h>\n#include <linux/filter.h>\n#include <linux/kprobes.h>\n#include <linux/init.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/extable.h>\n#include <linux/memory.h>\n#include <linux/ftrace.h>\n\nint __kernel_text_address(unsigned long addr)\n{\n\tif (kernel_text_address(addr))\n\t\treturn 1;\n\t/*\n\t * There might be init symbols in saved stacktraces.\n\t * Give those symbols a chance to be printed in\n\t * backtraces (such as lockdep traces).\n\t *\n\t * Since we are after the module-symbols check, there's\n\t * no danger of address overlap:\n\t */\n\tif (is_kernel_inittext(addr))\n\t\treturn 1;\n\treturn 0;\n}"
  },
  {
    "function_name": "core_kernel_text",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/extable.c",
    "lines": "65-74",
    "snippet": "int notrace core_kernel_text(unsigned long addr)\n{\n\tif (is_kernel_text(addr))\n\t\treturn 1;\n\n\tif (system_state < SYSTEM_FREEING_INITMEM &&\n\t    is_kernel_inittext(addr))\n\t\treturn 1;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include <asm/sections.h>",
      "#include <linux/filter.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/init.h>",
      "#include <linux/mutex.h>",
      "#include <linux/module.h>",
      "#include <linux/extable.h>",
      "#include <linux/memory.h>",
      "#include <linux/ftrace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "is_kernel_inittext",
          "args": [
            "addr"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_kernel_text",
          "args": [
            "addr"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "func_ptr_is_kernel_text",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/extable.c",
          "lines": "141-148",
          "snippet": "int func_ptr_is_kernel_text(void *ptr)\n{\n\tunsigned long addr;\n\taddr = (unsigned long) dereference_function_descriptor(ptr);\n\tif (core_kernel_text(addr))\n\t\treturn 1;\n\treturn is_module_text_address(addr);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <asm/sections.h>",
            "#include <linux/filter.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/init.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/extable.h>",
            "#include <linux/memory.h>",
            "#include <linux/ftrace.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <asm/sections.h>\n#include <linux/filter.h>\n#include <linux/kprobes.h>\n#include <linux/init.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/extable.h>\n#include <linux/memory.h>\n#include <linux/ftrace.h>\n\nint func_ptr_is_kernel_text(void *ptr)\n{\n\tunsigned long addr;\n\taddr = (unsigned long) dereference_function_descriptor(ptr);\n\tif (core_kernel_text(addr))\n\t\treturn 1;\n\treturn is_module_text_address(addr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include <asm/sections.h>\n#include <linux/filter.h>\n#include <linux/kprobes.h>\n#include <linux/init.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/extable.h>\n#include <linux/memory.h>\n#include <linux/ftrace.h>\n\nint notrace core_kernel_text(unsigned long addr)\n{\n\tif (is_kernel_text(addr))\n\t\treturn 1;\n\n\tif (system_state < SYSTEM_FREEING_INITMEM &&\n\t    is_kernel_inittext(addr))\n\t\treturn 1;\n\treturn 0;\n}"
  },
  {
    "function_name": "search_exception_tables",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/extable.c",
    "lines": "53-63",
    "snippet": "const struct exception_table_entry *search_exception_tables(unsigned long addr)\n{\n\tconst struct exception_table_entry *e;\n\n\te = search_kernel_exception_table(addr);\n\tif (!e)\n\t\te = search_module_extables(addr);\n\tif (!e)\n\t\te = search_bpf_extables(addr);\n\treturn e;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include <asm/sections.h>",
      "#include <linux/filter.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/init.h>",
      "#include <linux/mutex.h>",
      "#include <linux/module.h>",
      "#include <linux/extable.h>",
      "#include <linux/memory.h>",
      "#include <linux/ftrace.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "search_bpf_extables",
          "args": [
            "addr"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "search_bpf_extables",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/core.c",
          "lines": "731-747",
          "snippet": "const struct exception_table_entry *search_bpf_extables(unsigned long addr)\n{\n\tconst struct exception_table_entry *e = NULL;\n\tstruct bpf_prog *prog;\n\n\trcu_read_lock();\n\tprog = bpf_prog_ksym_find(addr);\n\tif (!prog)\n\t\tgoto out;\n\tif (!prog->aux->num_exentries)\n\t\tgoto out;\n\n\te = search_extable(prog->aux->extable, prog->aux->num_exentries, addr);\nout:\n\trcu_read_unlock();\n\treturn e;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <asm/unaligned.h>",
            "#include <asm/barrier.h>",
            "#include <linux/bpf_verifier.h>",
            "#include <linux/log2.h>",
            "#include <linux/extable.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/rbtree_latch.h>",
            "#include <linux/objtool.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/random.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/skbuff.h>",
            "#include <linux/filter.h>",
            "#include <uapi/linux/btf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <asm/unaligned.h>\n#include <asm/barrier.h>\n#include <linux/bpf_verifier.h>\n#include <linux/log2.h>\n#include <linux/extable.h>\n#include <linux/perf_event.h>\n#include <linux/rcupdate.h>\n#include <linux/kallsyms.h>\n#include <linux/rbtree_latch.h>\n#include <linux/objtool.h>\n#include <linux/btf.h>\n#include <linux/bpf.h>\n#include <linux/moduleloader.h>\n#include <linux/random.h>\n#include <linux/vmalloc.h>\n#include <linux/skbuff.h>\n#include <linux/filter.h>\n#include <uapi/linux/btf.h>\n\nconst struct exception_table_entry *search_bpf_extables(unsigned long addr)\n{\n\tconst struct exception_table_entry *e = NULL;\n\tstruct bpf_prog *prog;\n\n\trcu_read_lock();\n\tprog = bpf_prog_ksym_find(addr);\n\tif (!prog)\n\t\tgoto out;\n\tif (!prog->aux->num_exentries)\n\t\tgoto out;\n\n\te = search_extable(prog->aux->extable, prog->aux->num_exentries, addr);\nout:\n\trcu_read_unlock();\n\treturn e;\n}"
        }
      },
      {
        "call_info": {
          "callee": "search_module_extables",
          "args": [
            "addr"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "search_module_extables",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/module.c",
          "lines": "4685-4709",
          "snippet": "const struct exception_table_entry *search_module_extables(unsigned long addr)\n{\n\tconst struct exception_table_entry *e = NULL;\n\tstruct module *mod;\n\n\tpreempt_disable();\n\tmod = __module_address(addr);\n\tif (!mod)\n\t\tgoto out;\n\n\tif (!mod->num_exentries)\n\t\tgoto out;\n\n\te = search_extable(mod->extable,\n\t\t\t   mod->num_exentries,\n\t\t\t   addr);\nout:\n\tpreempt_enable();\n\n\t/*\n\t * Now, if we found one, we are running inside it now, hence\n\t * we cannot unload the module, hence no refcnt needed.\n\t */\n\treturn e;\n}",
          "includes": [
            "#include <trace/events/module.h>",
            "#include \"module-internal.h\"",
            "#include <uapi/linux/module.h>",
            "#include <linux/audit.h>",
            "#include <linux/dynamic_debug.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/pfn.h>",
            "#include <linux/jump_label.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/percpu.h>",
            "#include <linux/async.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/tracepoint.h>",
            "#include <asm/sections.h>",
            "#include <linux/license.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/set_memory.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/rculist.h>",
            "#include <linux/mutex.h>",
            "#include <linux/string.h>",
            "#include <linux/device.h>",
            "#include <linux/sched.h>",
            "#include <linux/notifier.h>",
            "#include <linux/vermagic.h>",
            "#include <linux/err.h>",
            "#include <linux/errno.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/elf.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel_read_file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/buildid.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/init.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/module_signature.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/extable.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void cfi_cleanup(struct module *mod);",
            "static void cfi_init(struct module *mod);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/module.h>\n#include \"module-internal.h\"\n#include <uapi/linux/module.h>\n#include <linux/audit.h>\n#include <linux/dynamic_debug.h>\n#include <linux/bsearch.h>\n#include <linux/pfn.h>\n#include <linux/jump_label.h>\n#include <linux/kmemleak.h>\n#include <linux/percpu.h>\n#include <linux/async.h>\n#include <linux/livepatch.h>\n#include <linux/ftrace.h>\n#include <linux/tracepoint.h>\n#include <asm/sections.h>\n#include <linux/license.h>\n#include <asm/mmu_context.h>\n#include <linux/set_memory.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/rculist.h>\n#include <linux/mutex.h>\n#include <linux/string.h>\n#include <linux/device.h>\n#include <linux/sched.h>\n#include <linux/notifier.h>\n#include <linux/vermagic.h>\n#include <linux/err.h>\n#include <linux/errno.h>\n#include <linux/moduleparam.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/rcupdate.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/elf.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/kernel_read_file.h>\n#include <linux/kernel.h>\n#include <linux/sysfs.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/buildid.h>\n#include <linux/kallsyms.h>\n#include <linux/init.h>\n#include <linux/trace_events.h>\n#include <linux/module_signature.h>\n#include <linux/moduleloader.h>\n#include <linux/extable.h>\n#include <linux/export.h>\n\nstatic void cfi_cleanup(struct module *mod);\nstatic void cfi_init(struct module *mod);\n\nconst struct exception_table_entry *search_module_extables(unsigned long addr)\n{\n\tconst struct exception_table_entry *e = NULL;\n\tstruct module *mod;\n\n\tpreempt_disable();\n\tmod = __module_address(addr);\n\tif (!mod)\n\t\tgoto out;\n\n\tif (!mod->num_exentries)\n\t\tgoto out;\n\n\te = search_extable(mod->extable,\n\t\t\t   mod->num_exentries,\n\t\t\t   addr);\nout:\n\tpreempt_enable();\n\n\t/*\n\t * Now, if we found one, we are running inside it now, hence\n\t * we cannot unload the module, hence no refcnt needed.\n\t */\n\treturn e;\n}"
        }
      },
      {
        "call_info": {
          "callee": "search_kernel_exception_table",
          "args": [
            "addr"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "search_kernel_exception_table",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/extable.c",
          "lines": "45-50",
          "snippet": "const\nstruct exception_table_entry *search_kernel_exception_table(unsigned long addr)\n{\n\treturn search_extable(__start___ex_table,\n\t\t\t      __stop___ex_table - __start___ex_table, addr);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <asm/sections.h>",
            "#include <linux/filter.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/init.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/extable.h>",
            "#include <linux/memory.h>",
            "#include <linux/ftrace.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern struct exception_table_entry __start___ex_table[];",
            "extern struct exception_table_entry __stop___ex_table[];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <asm/sections.h>\n#include <linux/filter.h>\n#include <linux/kprobes.h>\n#include <linux/init.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/extable.h>\n#include <linux/memory.h>\n#include <linux/ftrace.h>\n\nextern struct exception_table_entry __start___ex_table[];\nextern struct exception_table_entry __stop___ex_table[];\n\nconst\nstruct exception_table_entry *search_kernel_exception_table(unsigned long addr)\n{\n\treturn search_extable(__start___ex_table,\n\t\t\t      __stop___ex_table - __start___ex_table, addr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include <asm/sections.h>\n#include <linux/filter.h>\n#include <linux/kprobes.h>\n#include <linux/init.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/extable.h>\n#include <linux/memory.h>\n#include <linux/ftrace.h>\n\nconst struct exception_table_entry *search_exception_tables(unsigned long addr)\n{\n\tconst struct exception_table_entry *e;\n\n\te = search_kernel_exception_table(addr);\n\tif (!e)\n\t\te = search_module_extables(addr);\n\tif (!e)\n\t\te = search_bpf_extables(addr);\n\treturn e;\n}"
  },
  {
    "function_name": "search_kernel_exception_table",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/extable.c",
    "lines": "45-50",
    "snippet": "const\nstruct exception_table_entry *search_kernel_exception_table(unsigned long addr)\n{\n\treturn search_extable(__start___ex_table,\n\t\t\t      __stop___ex_table - __start___ex_table, addr);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include <asm/sections.h>",
      "#include <linux/filter.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/init.h>",
      "#include <linux/mutex.h>",
      "#include <linux/module.h>",
      "#include <linux/extable.h>",
      "#include <linux/memory.h>",
      "#include <linux/ftrace.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern struct exception_table_entry __start___ex_table[];",
      "extern struct exception_table_entry __stop___ex_table[];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "search_extable",
          "args": [
            "__start___ex_table",
            "__stop___ex_table - __start___ex_table",
            "addr"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include <asm/sections.h>\n#include <linux/filter.h>\n#include <linux/kprobes.h>\n#include <linux/init.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/extable.h>\n#include <linux/memory.h>\n#include <linux/ftrace.h>\n\nextern struct exception_table_entry __start___ex_table[];\nextern struct exception_table_entry __stop___ex_table[];\n\nconst\nstruct exception_table_entry *search_kernel_exception_table(unsigned long addr)\n{\n\treturn search_extable(__start___ex_table,\n\t\t\t      __stop___ex_table - __start___ex_table, addr);\n}"
  },
  {
    "function_name": "sort_main_extable",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/extable.c",
    "lines": "35-42",
    "snippet": "void __init sort_main_extable(void)\n{\n\tif (main_extable_sort_needed &&\n\t    &__stop___ex_table > &__start___ex_table) {\n\t\tpr_notice(\"Sorting __ex_table...\\n\");\n\t\tsort_extable(__start___ex_table, __stop___ex_table);\n\t}\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include <asm/sections.h>",
      "#include <linux/filter.h>",
      "#include <linux/kprobes.h>",
      "#include <linux/init.h>",
      "#include <linux/mutex.h>",
      "#include <linux/module.h>",
      "#include <linux/extable.h>",
      "#include <linux/memory.h>",
      "#include <linux/ftrace.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern struct exception_table_entry __start___ex_table[];",
      "extern struct exception_table_entry __stop___ex_table[];",
      "__visible main_extable_sort_needed = 1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sort_extable",
          "args": [
            "__start___ex_table",
            "__stop___ex_table"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_notice",
          "args": [
            "\"Sorting __ex_table...\\n\""
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include <asm/sections.h>\n#include <linux/filter.h>\n#include <linux/kprobes.h>\n#include <linux/init.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/extable.h>\n#include <linux/memory.h>\n#include <linux/ftrace.h>\n\nextern struct exception_table_entry __start___ex_table[];\nextern struct exception_table_entry __stop___ex_table[];\n__visible main_extable_sort_needed = 1;\n\nvoid __init sort_main_extable(void)\n{\n\tif (main_extable_sort_needed &&\n\t    &__stop___ex_table > &__start___ex_table) {\n\t\tpr_notice(\"Sorting __ex_table...\\n\");\n\t\tsort_extable(__start___ex_table, __stop___ex_table);\n\t}\n}"
  }
]