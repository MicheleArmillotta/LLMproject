[
  {
    "function_name": "housekeeping_isolcpus_setup",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/isolation.c",
    "lines": "148-197",
    "snippet": "static int __init housekeeping_isolcpus_setup(char *str)\n{\n\tunsigned int flags = 0;\n\tbool illegal = false;\n\tchar *par;\n\tint len;\n\n\twhile (isalpha(*str)) {\n\t\tif (!strncmp(str, \"nohz,\", 5)) {\n\t\t\tstr += 5;\n\t\t\tflags |= HK_FLAG_TICK;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!strncmp(str, \"domain,\", 7)) {\n\t\t\tstr += 7;\n\t\t\tflags |= HK_FLAG_DOMAIN;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!strncmp(str, \"managed_irq,\", 12)) {\n\t\t\tstr += 12;\n\t\t\tflags |= HK_FLAG_MANAGED_IRQ;\n\t\t\tcontinue;\n\t\t}\n\n\t\t/*\n\t\t * Skip unknown sub-parameter and validate that it is not\n\t\t * containing an invalid character.\n\t\t */\n\t\tfor (par = str, len = 0; *str && *str != ','; str++, len++) {\n\t\t\tif (!isalpha(*str) && *str != '_')\n\t\t\t\tillegal = true;\n\t\t}\n\n\t\tif (illegal) {\n\t\t\tpr_warn(\"isolcpus: Invalid flag %.*s\\n\", len, par);\n\t\t\treturn 0;\n\t\t}\n\n\t\tpr_info(\"isolcpus: Skipped unknown flag %.*s\\n\", len, par);\n\t\tstr++;\n\t}\n\n\t/* Default behaviour for isolcpus without flags */\n\tif (!flags)\n\t\tflags |= HK_FLAG_DOMAIN;\n\n\treturn housekeeping_setup(str, flags);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "housekeeping_setup",
          "args": [
            "str",
            "flags"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "housekeeping_setup",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/isolation.c",
          "lines": "80-135",
          "snippet": "static int __init housekeeping_setup(char *str, enum hk_flags flags)\n{\n\tcpumask_var_t non_housekeeping_mask;\n\tcpumask_var_t tmp;\n\n\talloc_bootmem_cpumask_var(&non_housekeeping_mask);\n\tif (cpulist_parse(str, non_housekeeping_mask) < 0) {\n\t\tpr_warn(\"Housekeeping: nohz_full= or isolcpus= incorrect CPU range\\n\");\n\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\treturn 0;\n\t}\n\n\talloc_bootmem_cpumask_var(&tmp);\n\tif (!housekeeping_flags) {\n\t\talloc_bootmem_cpumask_var(&housekeeping_mask);\n\t\tcpumask_andnot(housekeeping_mask,\n\t\t\t       cpu_possible_mask, non_housekeeping_mask);\n\n\t\tcpumask_andnot(tmp, cpu_present_mask, non_housekeeping_mask);\n\t\tif (cpumask_empty(tmp)) {\n\t\t\tpr_warn(\"Housekeeping: must include one present CPU, \"\n\t\t\t\t\"using boot CPU:%d\\n\", smp_processor_id());\n\t\t\t__cpumask_set_cpu(smp_processor_id(), housekeeping_mask);\n\t\t\t__cpumask_clear_cpu(smp_processor_id(), non_housekeeping_mask);\n\t\t}\n\t} else {\n\t\tcpumask_andnot(tmp, cpu_present_mask, non_housekeeping_mask);\n\t\tif (cpumask_empty(tmp))\n\t\t\t__cpumask_clear_cpu(smp_processor_id(), non_housekeeping_mask);\n\t\tcpumask_andnot(tmp, cpu_possible_mask, non_housekeeping_mask);\n\t\tif (!cpumask_equal(tmp, housekeeping_mask)) {\n\t\t\tpr_warn(\"Housekeeping: nohz_full= must match isolcpus=\\n\");\n\t\t\tfree_bootmem_cpumask_var(tmp);\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t}\n\tfree_bootmem_cpumask_var(tmp);\n\n\tif ((flags & HK_FLAG_TICK) && !(housekeeping_flags & HK_FLAG_TICK)) {\n\t\tif (IS_ENABLED(CONFIG_NO_HZ_FULL)) {\n\t\t\ttick_nohz_full_setup(non_housekeeping_mask);\n\t\t} else {\n\t\t\tpr_warn(\"Housekeeping: nohz unsupported.\"\n\t\t\t\t\" Build with CONFIG_NO_HZ_FULL\\n\");\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\thousekeeping_flags |= flags;\n\n\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\n\treturn 1;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static cpumask_var_t housekeeping_mask;",
            "static unsigned int housekeeping_flags;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic cpumask_var_t housekeeping_mask;\nstatic unsigned int housekeeping_flags;\n\nstatic int __init housekeeping_setup(char *str, enum hk_flags flags)\n{\n\tcpumask_var_t non_housekeeping_mask;\n\tcpumask_var_t tmp;\n\n\talloc_bootmem_cpumask_var(&non_housekeeping_mask);\n\tif (cpulist_parse(str, non_housekeeping_mask) < 0) {\n\t\tpr_warn(\"Housekeeping: nohz_full= or isolcpus= incorrect CPU range\\n\");\n\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\treturn 0;\n\t}\n\n\talloc_bootmem_cpumask_var(&tmp);\n\tif (!housekeeping_flags) {\n\t\talloc_bootmem_cpumask_var(&housekeeping_mask);\n\t\tcpumask_andnot(housekeeping_mask,\n\t\t\t       cpu_possible_mask, non_housekeeping_mask);\n\n\t\tcpumask_andnot(tmp, cpu_present_mask, non_housekeeping_mask);\n\t\tif (cpumask_empty(tmp)) {\n\t\t\tpr_warn(\"Housekeeping: must include one present CPU, \"\n\t\t\t\t\"using boot CPU:%d\\n\", smp_processor_id());\n\t\t\t__cpumask_set_cpu(smp_processor_id(), housekeeping_mask);\n\t\t\t__cpumask_clear_cpu(smp_processor_id(), non_housekeeping_mask);\n\t\t}\n\t} else {\n\t\tcpumask_andnot(tmp, cpu_present_mask, non_housekeeping_mask);\n\t\tif (cpumask_empty(tmp))\n\t\t\t__cpumask_clear_cpu(smp_processor_id(), non_housekeeping_mask);\n\t\tcpumask_andnot(tmp, cpu_possible_mask, non_housekeeping_mask);\n\t\tif (!cpumask_equal(tmp, housekeeping_mask)) {\n\t\t\tpr_warn(\"Housekeeping: nohz_full= must match isolcpus=\\n\");\n\t\t\tfree_bootmem_cpumask_var(tmp);\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t}\n\tfree_bootmem_cpumask_var(tmp);\n\n\tif ((flags & HK_FLAG_TICK) && !(housekeeping_flags & HK_FLAG_TICK)) {\n\t\tif (IS_ENABLED(CONFIG_NO_HZ_FULL)) {\n\t\t\ttick_nohz_full_setup(non_housekeeping_mask);\n\t\t} else {\n\t\t\tpr_warn(\"Housekeeping: nohz unsupported.\"\n\t\t\t\t\" Build with CONFIG_NO_HZ_FULL\\n\");\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\thousekeeping_flags |= flags;\n\n\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"isolcpus: Skipped unknown flag %.*s\\n\"",
            "len",
            "par"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"isolcpus: Invalid flag %.*s\\n\"",
            "len",
            "par"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalpha",
          "args": [
            "*str"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "str",
            "\"managed_irq,\"",
            "12"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "str",
            "\"domain,\"",
            "7"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "str",
            "\"nohz,\"",
            "5"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalpha",
          "args": [
            "*str"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic int __init housekeeping_isolcpus_setup(char *str)\n{\n\tunsigned int flags = 0;\n\tbool illegal = false;\n\tchar *par;\n\tint len;\n\n\twhile (isalpha(*str)) {\n\t\tif (!strncmp(str, \"nohz,\", 5)) {\n\t\t\tstr += 5;\n\t\t\tflags |= HK_FLAG_TICK;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!strncmp(str, \"domain,\", 7)) {\n\t\t\tstr += 7;\n\t\t\tflags |= HK_FLAG_DOMAIN;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!strncmp(str, \"managed_irq,\", 12)) {\n\t\t\tstr += 12;\n\t\t\tflags |= HK_FLAG_MANAGED_IRQ;\n\t\t\tcontinue;\n\t\t}\n\n\t\t/*\n\t\t * Skip unknown sub-parameter and validate that it is not\n\t\t * containing an invalid character.\n\t\t */\n\t\tfor (par = str, len = 0; *str && *str != ','; str++, len++) {\n\t\t\tif (!isalpha(*str) && *str != '_')\n\t\t\t\tillegal = true;\n\t\t}\n\n\t\tif (illegal) {\n\t\t\tpr_warn(\"isolcpus: Invalid flag %.*s\\n\", len, par);\n\t\t\treturn 0;\n\t\t}\n\n\t\tpr_info(\"isolcpus: Skipped unknown flag %.*s\\n\", len, par);\n\t\tstr++;\n\t}\n\n\t/* Default behaviour for isolcpus without flags */\n\tif (!flags)\n\t\tflags |= HK_FLAG_DOMAIN;\n\n\treturn housekeeping_setup(str, flags);\n}"
  },
  {
    "function_name": "housekeeping_nohz_full_setup",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/isolation.c",
    "lines": "137-145",
    "snippet": "static int __init housekeeping_nohz_full_setup(char *str)\n{\n\tunsigned int flags;\n\n\tflags = HK_FLAG_TICK | HK_FLAG_WQ | HK_FLAG_TIMER | HK_FLAG_RCU |\n\t\tHK_FLAG_MISC | HK_FLAG_KTHREAD;\n\n\treturn housekeeping_setup(str, flags);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "housekeeping_setup",
          "args": [
            "str",
            "flags"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "housekeeping_setup",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/isolation.c",
          "lines": "80-135",
          "snippet": "static int __init housekeeping_setup(char *str, enum hk_flags flags)\n{\n\tcpumask_var_t non_housekeeping_mask;\n\tcpumask_var_t tmp;\n\n\talloc_bootmem_cpumask_var(&non_housekeeping_mask);\n\tif (cpulist_parse(str, non_housekeeping_mask) < 0) {\n\t\tpr_warn(\"Housekeeping: nohz_full= or isolcpus= incorrect CPU range\\n\");\n\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\treturn 0;\n\t}\n\n\talloc_bootmem_cpumask_var(&tmp);\n\tif (!housekeeping_flags) {\n\t\talloc_bootmem_cpumask_var(&housekeeping_mask);\n\t\tcpumask_andnot(housekeeping_mask,\n\t\t\t       cpu_possible_mask, non_housekeeping_mask);\n\n\t\tcpumask_andnot(tmp, cpu_present_mask, non_housekeeping_mask);\n\t\tif (cpumask_empty(tmp)) {\n\t\t\tpr_warn(\"Housekeeping: must include one present CPU, \"\n\t\t\t\t\"using boot CPU:%d\\n\", smp_processor_id());\n\t\t\t__cpumask_set_cpu(smp_processor_id(), housekeeping_mask);\n\t\t\t__cpumask_clear_cpu(smp_processor_id(), non_housekeeping_mask);\n\t\t}\n\t} else {\n\t\tcpumask_andnot(tmp, cpu_present_mask, non_housekeeping_mask);\n\t\tif (cpumask_empty(tmp))\n\t\t\t__cpumask_clear_cpu(smp_processor_id(), non_housekeeping_mask);\n\t\tcpumask_andnot(tmp, cpu_possible_mask, non_housekeeping_mask);\n\t\tif (!cpumask_equal(tmp, housekeeping_mask)) {\n\t\t\tpr_warn(\"Housekeeping: nohz_full= must match isolcpus=\\n\");\n\t\t\tfree_bootmem_cpumask_var(tmp);\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t}\n\tfree_bootmem_cpumask_var(tmp);\n\n\tif ((flags & HK_FLAG_TICK) && !(housekeeping_flags & HK_FLAG_TICK)) {\n\t\tif (IS_ENABLED(CONFIG_NO_HZ_FULL)) {\n\t\t\ttick_nohz_full_setup(non_housekeeping_mask);\n\t\t} else {\n\t\t\tpr_warn(\"Housekeeping: nohz unsupported.\"\n\t\t\t\t\" Build with CONFIG_NO_HZ_FULL\\n\");\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\thousekeeping_flags |= flags;\n\n\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\n\treturn 1;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static cpumask_var_t housekeeping_mask;",
            "static unsigned int housekeeping_flags;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nstatic cpumask_var_t housekeeping_mask;\nstatic unsigned int housekeeping_flags;\n\nstatic int __init housekeeping_setup(char *str, enum hk_flags flags)\n{\n\tcpumask_var_t non_housekeeping_mask;\n\tcpumask_var_t tmp;\n\n\talloc_bootmem_cpumask_var(&non_housekeeping_mask);\n\tif (cpulist_parse(str, non_housekeeping_mask) < 0) {\n\t\tpr_warn(\"Housekeeping: nohz_full= or isolcpus= incorrect CPU range\\n\");\n\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\treturn 0;\n\t}\n\n\talloc_bootmem_cpumask_var(&tmp);\n\tif (!housekeeping_flags) {\n\t\talloc_bootmem_cpumask_var(&housekeeping_mask);\n\t\tcpumask_andnot(housekeeping_mask,\n\t\t\t       cpu_possible_mask, non_housekeeping_mask);\n\n\t\tcpumask_andnot(tmp, cpu_present_mask, non_housekeeping_mask);\n\t\tif (cpumask_empty(tmp)) {\n\t\t\tpr_warn(\"Housekeeping: must include one present CPU, \"\n\t\t\t\t\"using boot CPU:%d\\n\", smp_processor_id());\n\t\t\t__cpumask_set_cpu(smp_processor_id(), housekeeping_mask);\n\t\t\t__cpumask_clear_cpu(smp_processor_id(), non_housekeeping_mask);\n\t\t}\n\t} else {\n\t\tcpumask_andnot(tmp, cpu_present_mask, non_housekeeping_mask);\n\t\tif (cpumask_empty(tmp))\n\t\t\t__cpumask_clear_cpu(smp_processor_id(), non_housekeeping_mask);\n\t\tcpumask_andnot(tmp, cpu_possible_mask, non_housekeeping_mask);\n\t\tif (!cpumask_equal(tmp, housekeeping_mask)) {\n\t\t\tpr_warn(\"Housekeeping: nohz_full= must match isolcpus=\\n\");\n\t\t\tfree_bootmem_cpumask_var(tmp);\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t}\n\tfree_bootmem_cpumask_var(tmp);\n\n\tif ((flags & HK_FLAG_TICK) && !(housekeeping_flags & HK_FLAG_TICK)) {\n\t\tif (IS_ENABLED(CONFIG_NO_HZ_FULL)) {\n\t\t\ttick_nohz_full_setup(non_housekeeping_mask);\n\t\t} else {\n\t\t\tpr_warn(\"Housekeeping: nohz unsupported.\"\n\t\t\t\t\" Build with CONFIG_NO_HZ_FULL\\n\");\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\thousekeeping_flags |= flags;\n\n\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic int __init housekeeping_nohz_full_setup(char *str)\n{\n\tunsigned int flags;\n\n\tflags = HK_FLAG_TICK | HK_FLAG_WQ | HK_FLAG_TIMER | HK_FLAG_RCU |\n\t\tHK_FLAG_MISC | HK_FLAG_KTHREAD;\n\n\treturn housekeeping_setup(str, flags);\n}"
  },
  {
    "function_name": "housekeeping_setup",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/isolation.c",
    "lines": "80-135",
    "snippet": "static int __init housekeeping_setup(char *str, enum hk_flags flags)\n{\n\tcpumask_var_t non_housekeeping_mask;\n\tcpumask_var_t tmp;\n\n\talloc_bootmem_cpumask_var(&non_housekeeping_mask);\n\tif (cpulist_parse(str, non_housekeeping_mask) < 0) {\n\t\tpr_warn(\"Housekeeping: nohz_full= or isolcpus= incorrect CPU range\\n\");\n\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\treturn 0;\n\t}\n\n\talloc_bootmem_cpumask_var(&tmp);\n\tif (!housekeeping_flags) {\n\t\talloc_bootmem_cpumask_var(&housekeeping_mask);\n\t\tcpumask_andnot(housekeeping_mask,\n\t\t\t       cpu_possible_mask, non_housekeeping_mask);\n\n\t\tcpumask_andnot(tmp, cpu_present_mask, non_housekeeping_mask);\n\t\tif (cpumask_empty(tmp)) {\n\t\t\tpr_warn(\"Housekeeping: must include one present CPU, \"\n\t\t\t\t\"using boot CPU:%d\\n\", smp_processor_id());\n\t\t\t__cpumask_set_cpu(smp_processor_id(), housekeeping_mask);\n\t\t\t__cpumask_clear_cpu(smp_processor_id(), non_housekeeping_mask);\n\t\t}\n\t} else {\n\t\tcpumask_andnot(tmp, cpu_present_mask, non_housekeeping_mask);\n\t\tif (cpumask_empty(tmp))\n\t\t\t__cpumask_clear_cpu(smp_processor_id(), non_housekeeping_mask);\n\t\tcpumask_andnot(tmp, cpu_possible_mask, non_housekeeping_mask);\n\t\tif (!cpumask_equal(tmp, housekeeping_mask)) {\n\t\t\tpr_warn(\"Housekeeping: nohz_full= must match isolcpus=\\n\");\n\t\t\tfree_bootmem_cpumask_var(tmp);\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t}\n\tfree_bootmem_cpumask_var(tmp);\n\n\tif ((flags & HK_FLAG_TICK) && !(housekeeping_flags & HK_FLAG_TICK)) {\n\t\tif (IS_ENABLED(CONFIG_NO_HZ_FULL)) {\n\t\t\ttick_nohz_full_setup(non_housekeeping_mask);\n\t\t} else {\n\t\t\tpr_warn(\"Housekeeping: nohz unsupported.\"\n\t\t\t\t\" Build with CONFIG_NO_HZ_FULL\\n\");\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\thousekeeping_flags |= flags;\n\n\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\n\treturn 1;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static cpumask_var_t housekeeping_mask;",
      "static unsigned int housekeeping_flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_bootmem_cpumask_var",
          "args": [
            "non_housekeeping_mask"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_bootmem_cpumask_var",
          "args": [
            "non_housekeeping_mask"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"Housekeeping: nohz unsupported.\"\n\t\t\t\t\" Build with CONFIG_NO_HZ_FULL\\n\""
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tick_nohz_full_setup",
          "args": [
            "non_housekeeping_mask"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "tick_nohz_full_setup",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/tick-sched.c",
          "lines": "506-511",
          "snippet": "void __init tick_nohz_full_setup(cpumask_var_t cpumask)\n{\n\talloc_bootmem_cpumask_var(&tick_nohz_full_mask);\n\tcpumask_copy(tick_nohz_full_mask, cpumask);\n\ttick_nohz_full_running = true;\n}",
          "includes": [
            "#include <trace/events/timer.h>",
            "#include \"tick-internal.h\"",
            "#include <asm/irq_regs.h>",
            "#include <linux/mm.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/module.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched/nohz.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/profile.h>",
            "#include <linux/nmi.h>",
            "#include <linux/percpu.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/err.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/timer.h>\n#include \"tick-internal.h\"\n#include <asm/irq_regs.h>\n#include <linux/mm.h>\n#include <linux/context_tracking.h>\n#include <linux/posix-timers.h>\n#include <linux/irq_work.h>\n#include <linux/module.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/nohz.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/signal.h>\n#include <linux/profile.h>\n#include <linux/nmi.h>\n#include <linux/percpu.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/hrtimer.h>\n#include <linux/err.h>\n#include <linux/cpu.h>\n\nvoid __init tick_nohz_full_setup(cpumask_var_t cpumask)\n{\n\talloc_bootmem_cpumask_var(&tick_nohz_full_mask);\n\tcpumask_copy(tick_nohz_full_mask, cpumask);\n\ttick_nohz_full_running = true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_NO_HZ_FULL"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_bootmem_cpumask_var",
          "args": [
            "tmp"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_bootmem_cpumask_var",
          "args": [
            "non_housekeeping_mask"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_bootmem_cpumask_var",
          "args": [
            "tmp"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"Housekeeping: nohz_full= must match isolcpus=\\n\""
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_equal",
          "args": [
            "tmp",
            "housekeeping_mask"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_andnot",
          "args": [
            "tmp",
            "cpu_possible_mask",
            "non_housekeeping_mask"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__cpumask_clear_cpu",
          "args": [
            "smp_processor_id()",
            "non_housekeeping_mask"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_empty",
          "args": [
            "tmp"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_andnot",
          "args": [
            "tmp",
            "cpu_present_mask",
            "non_housekeeping_mask"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__cpumask_clear_cpu",
          "args": [
            "smp_processor_id()",
            "non_housekeeping_mask"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__cpumask_set_cpu",
          "args": [
            "smp_processor_id()",
            "housekeeping_mask"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"Housekeeping: must include one present CPU, \"\n\t\t\t\t\"using boot CPU:%d\\n\"",
            "smp_processor_id()"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_empty",
          "args": [
            "tmp"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_andnot",
          "args": [
            "tmp",
            "cpu_present_mask",
            "non_housekeeping_mask"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_andnot",
          "args": [
            "housekeeping_mask",
            "cpu_possible_mask",
            "non_housekeeping_mask"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_bootmem_cpumask_var",
          "args": [
            "&housekeeping_mask"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_bootmem_cpumask_var",
          "args": [
            "&tmp"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_bootmem_cpumask_var",
          "args": [
            "non_housekeeping_mask"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"Housekeeping: nohz_full= or isolcpus= incorrect CPU range\\n\""
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpulist_parse",
          "args": [
            "str",
            "non_housekeeping_mask"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_bootmem_cpumask_var",
          "args": [
            "&non_housekeeping_mask"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic cpumask_var_t housekeeping_mask;\nstatic unsigned int housekeeping_flags;\n\nstatic int __init housekeeping_setup(char *str, enum hk_flags flags)\n{\n\tcpumask_var_t non_housekeeping_mask;\n\tcpumask_var_t tmp;\n\n\talloc_bootmem_cpumask_var(&non_housekeeping_mask);\n\tif (cpulist_parse(str, non_housekeeping_mask) < 0) {\n\t\tpr_warn(\"Housekeeping: nohz_full= or isolcpus= incorrect CPU range\\n\");\n\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\treturn 0;\n\t}\n\n\talloc_bootmem_cpumask_var(&tmp);\n\tif (!housekeeping_flags) {\n\t\talloc_bootmem_cpumask_var(&housekeeping_mask);\n\t\tcpumask_andnot(housekeeping_mask,\n\t\t\t       cpu_possible_mask, non_housekeeping_mask);\n\n\t\tcpumask_andnot(tmp, cpu_present_mask, non_housekeeping_mask);\n\t\tif (cpumask_empty(tmp)) {\n\t\t\tpr_warn(\"Housekeeping: must include one present CPU, \"\n\t\t\t\t\"using boot CPU:%d\\n\", smp_processor_id());\n\t\t\t__cpumask_set_cpu(smp_processor_id(), housekeeping_mask);\n\t\t\t__cpumask_clear_cpu(smp_processor_id(), non_housekeeping_mask);\n\t\t}\n\t} else {\n\t\tcpumask_andnot(tmp, cpu_present_mask, non_housekeeping_mask);\n\t\tif (cpumask_empty(tmp))\n\t\t\t__cpumask_clear_cpu(smp_processor_id(), non_housekeeping_mask);\n\t\tcpumask_andnot(tmp, cpu_possible_mask, non_housekeeping_mask);\n\t\tif (!cpumask_equal(tmp, housekeeping_mask)) {\n\t\t\tpr_warn(\"Housekeeping: nohz_full= must match isolcpus=\\n\");\n\t\t\tfree_bootmem_cpumask_var(tmp);\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t}\n\tfree_bootmem_cpumask_var(tmp);\n\n\tif ((flags & HK_FLAG_TICK) && !(housekeeping_flags & HK_FLAG_TICK)) {\n\t\tif (IS_ENABLED(CONFIG_NO_HZ_FULL)) {\n\t\t\ttick_nohz_full_setup(non_housekeeping_mask);\n\t\t} else {\n\t\t\tpr_warn(\"Housekeeping: nohz unsupported.\"\n\t\t\t\t\" Build with CONFIG_NO_HZ_FULL\\n\");\n\t\t\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\thousekeeping_flags |= flags;\n\n\tfree_bootmem_cpumask_var(non_housekeeping_mask);\n\n\treturn 1;\n}"
  },
  {
    "function_name": "housekeeping_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/isolation.c",
    "lines": "66-78",
    "snippet": "void __init housekeeping_init(void)\n{\n\tif (!housekeeping_flags)\n\t\treturn;\n\n\tstatic_branch_enable(&housekeeping_overridden);\n\n\tif (housekeeping_flags & HK_FLAG_TICK)\n\t\tsched_tick_offload_init();\n\n\t/* We need at least one CPU to handle housekeeping work */\n\tWARN_ON_ONCE(cpumask_empty(housekeeping_mask));\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static cpumask_var_t housekeeping_mask;",
      "static unsigned int housekeeping_flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "cpumask_empty(housekeeping_mask)"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_empty",
          "args": [
            "housekeeping_mask"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sched_tick_offload_init",
          "args": [],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "sched_tick_offload_init",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "5407-5412",
          "snippet": "int __init sched_tick_offload_init(void)\n{\n\ttick_work_cpu = alloc_percpu(struct tick_work);\n\tBUG_ON(!tick_work_cpu);\n\treturn 0;\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic __always_inline struct;\n\nint __init sched_tick_offload_init(void)\n{\n\ttick_work_cpu = alloc_percpu(struct tick_work);\n\tBUG_ON(!tick_work_cpu);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_branch_enable",
          "args": [
            "&housekeeping_overridden"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic cpumask_var_t housekeeping_mask;\nstatic unsigned int housekeeping_flags;\n\nvoid __init housekeeping_init(void)\n{\n\tif (!housekeeping_flags)\n\t\treturn;\n\n\tstatic_branch_enable(&housekeeping_overridden);\n\n\tif (housekeeping_flags & HK_FLAG_TICK)\n\t\tsched_tick_offload_init();\n\n\t/* We need at least one CPU to handle housekeeping work */\n\tWARN_ON_ONCE(cpumask_empty(housekeeping_mask));\n}"
  },
  {
    "function_name": "housekeeping_test_cpu",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/isolation.c",
    "lines": "57-63",
    "snippet": "bool housekeeping_test_cpu(int cpu, enum hk_flags flags)\n{\n\tif (static_branch_unlikely(&housekeeping_overridden))\n\t\tif (housekeeping_flags & flags)\n\t\t\treturn cpumask_test_cpu(cpu, housekeeping_mask);\n\treturn true;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static cpumask_var_t housekeeping_mask;",
      "static unsigned int housekeeping_flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpumask_test_cpu",
          "args": [
            "cpu",
            "housekeeping_mask"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_branch_unlikely",
          "args": [
            "&housekeeping_overridden"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic cpumask_var_t housekeeping_mask;\nstatic unsigned int housekeeping_flags;\n\nbool housekeeping_test_cpu(int cpu, enum hk_flags flags)\n{\n\tif (static_branch_unlikely(&housekeeping_overridden))\n\t\tif (housekeeping_flags & flags)\n\t\t\treturn cpumask_test_cpu(cpu, housekeeping_mask);\n\treturn true;\n}"
  },
  {
    "function_name": "housekeeping_affine",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/isolation.c",
    "lines": "49-54",
    "snippet": "void housekeeping_affine(struct task_struct *t, enum hk_flags flags)\n{\n\tif (static_branch_unlikely(&housekeeping_overridden))\n\t\tif (housekeeping_flags & flags)\n\t\t\tset_cpus_allowed_ptr(t, housekeeping_mask);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static cpumask_var_t housekeeping_mask;",
      "static unsigned int housekeeping_flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_cpus_allowed_ptr",
          "args": [
            "t",
            "housekeeping_mask"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "set_cpus_allowed_ptr",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "2888-2891",
          "snippet": "int set_cpus_allowed_ptr(struct task_struct *p, const struct cpumask *new_mask)\n{\n\treturn __set_cpus_allowed_ptr(p, new_mask, 0);\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic __always_inline struct;\n\nint set_cpus_allowed_ptr(struct task_struct *p, const struct cpumask *new_mask)\n{\n\treturn __set_cpus_allowed_ptr(p, new_mask, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_branch_unlikely",
          "args": [
            "&housekeeping_overridden"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic cpumask_var_t housekeeping_mask;\nstatic unsigned int housekeeping_flags;\n\nvoid housekeeping_affine(struct task_struct *t, enum hk_flags flags)\n{\n\tif (static_branch_unlikely(&housekeeping_overridden))\n\t\tif (housekeeping_flags & flags)\n\t\t\tset_cpus_allowed_ptr(t, housekeeping_mask);\n}"
  },
  {
    "function_name": "housekeeping_cpumask",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/isolation.c",
    "lines": "40-46",
    "snippet": "const struct cpumask *housekeeping_cpumask(enum hk_flags flags)\n{\n\tif (static_branch_unlikely(&housekeeping_overridden))\n\t\tif (housekeeping_flags & flags)\n\t\t\treturn housekeeping_mask;\n\treturn cpu_possible_mask;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static cpumask_var_t housekeeping_mask;",
      "static unsigned int housekeeping_flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_branch_unlikely",
          "args": [
            "&housekeeping_overridden"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic cpumask_var_t housekeeping_mask;\nstatic unsigned int housekeeping_flags;\n\nconst struct cpumask *housekeeping_cpumask(enum hk_flags flags)\n{\n\tif (static_branch_unlikely(&housekeeping_overridden))\n\t\tif (housekeeping_flags & flags)\n\t\t\treturn housekeeping_mask;\n\treturn cpu_possible_mask;\n}"
  },
  {
    "function_name": "housekeeping_any_cpu",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/isolation.c",
    "lines": "23-37",
    "snippet": "int housekeeping_any_cpu(enum hk_flags flags)\n{\n\tint cpu;\n\n\tif (static_branch_unlikely(&housekeeping_overridden)) {\n\t\tif (housekeeping_flags & flags) {\n\t\t\tcpu = sched_numa_find_closest(housekeeping_mask, smp_processor_id());\n\t\t\tif (cpu < nr_cpu_ids)\n\t\t\t\treturn cpu;\n\n\t\t\treturn cpumask_any_and(housekeeping_mask, cpu_online_mask);\n\t\t}\n\t}\n\treturn smp_processor_id();\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static cpumask_var_t housekeeping_mask;",
      "static unsigned int housekeeping_flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpumask_any_and",
          "args": [
            "housekeeping_mask",
            "cpu_online_mask"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sched_numa_find_closest",
          "args": [
            "housekeeping_mask",
            "smp_processor_id()"
          ],
          "line": 29
        },
        "resolved": true,
        "details": {
          "function_name": "sched_numa_find_closest",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/topology.c",
          "lines": "2002-2012",
          "snippet": "int sched_numa_find_closest(const struct cpumask *cpus, int cpu)\n{\n\tint i, j = cpu_to_node(cpu);\n\n\tfor (i = 0; i < sched_domains_numa_levels; i++) {\n\t\tcpu = cpumask_any_and(cpus, sched_domains_numa_masks[i][j]);\n\t\tif (cpu < nr_cpu_ids)\n\t\t\treturn cpu;\n\t}\n\treturn nr_cpu_ids;\n}",
          "includes": [
            "#include <linux/sched/sd_flags.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched/sd_flags.h>\n#include \"sched.h\"\n\nint sched_numa_find_closest(const struct cpumask *cpus, int cpu)\n{\n\tint i, j = cpu_to_node(cpu);\n\n\tfor (i = 0; i < sched_domains_numa_levels; i++) {\n\t\tcpu = cpumask_any_and(cpus, sched_domains_numa_masks[i][j]);\n\t\tif (cpu < nr_cpu_ids)\n\t\t\treturn cpu;\n\t}\n\treturn nr_cpu_ids;\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_branch_unlikely",
          "args": [
            "&housekeeping_overridden"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic cpumask_var_t housekeeping_mask;\nstatic unsigned int housekeeping_flags;\n\nint housekeeping_any_cpu(enum hk_flags flags)\n{\n\tint cpu;\n\n\tif (static_branch_unlikely(&housekeeping_overridden)) {\n\t\tif (housekeeping_flags & flags) {\n\t\t\tcpu = sched_numa_find_closest(housekeeping_mask, smp_processor_id());\n\t\t\tif (cpu < nr_cpu_ids)\n\t\t\t\treturn cpu;\n\n\t\t\treturn cpumask_any_and(housekeeping_mask, cpu_online_mask);\n\t\t}\n\t}\n\treturn smp_processor_id();\n}"
  },
  {
    "function_name": "housekeeping_enabled",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/isolation.c",
    "lines": "17-20",
    "snippet": "bool housekeeping_enabled(enum hk_flags flags)\n{\n\treturn !!(housekeeping_flags & flags);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int housekeeping_flags;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic unsigned int housekeeping_flags;\n\nbool housekeeping_enabled(enum hk_flags flags)\n{\n\treturn !!(housekeeping_flags & flags);\n}"
  }
]