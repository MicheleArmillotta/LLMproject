[
  {
    "function_name": "pm_suspend",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "605-622",
    "snippet": "int pm_suspend(suspend_state_t state)\n{\n\tint error;\n\n\tif (state <= PM_SUSPEND_ON || state >= PM_SUSPEND_MAX)\n\t\treturn -EINVAL;\n\n\tpr_info(\"suspend entry (%s)\\n\", mem_sleep_labels[state]);\n\terror = enter_state(state);\n\tif (error) {\n\t\tsuspend_stats.fail++;\n\t\tdpm_save_failed_errno(error);\n\t} else {\n\t\tsuspend_stats.success++;\n\t}\n\tpr_info(\"suspend exit\\n\");\n\treturn error;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char * const mem_sleep_labels[] = {\n\t[PM_SUSPEND_TO_IDLE] = \"s2idle\",\n\t[PM_SUSPEND_STANDBY] = \"shallow\",\n\t[PM_SUSPEND_MEM] = \"deep\",\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"suspend exit\\n\""
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dpm_save_failed_errno",
          "args": [
            "error"
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "enter_state",
          "args": [
            "state"
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "enter_state",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "547-596",
          "snippet": "static int enter_state(suspend_state_t state)\n{\n\tint error;\n\n\ttrace_suspend_resume(TPS(\"suspend_enter\"), state, true);\n\tif (state == PM_SUSPEND_TO_IDLE) {\n#ifdef CONFIG_PM_DEBUG\n\t\tif (pm_test_level != TEST_NONE && pm_test_level <= TEST_CPUS) {\n\t\t\tpr_warn(\"Unsupported test mode for suspend to idle, please choose none/freezer/devices/platform.\\n\");\n\t\t\treturn -EAGAIN;\n\t\t}\n#endif\n\t} else if (!valid_state(state)) {\n\t\treturn -EINVAL;\n\t}\n\tif (!mutex_trylock(&system_transition_mutex))\n\t\treturn -EBUSY;\n\n\tif (state == PM_SUSPEND_TO_IDLE)\n\t\ts2idle_begin();\n\n\tif (sync_on_suspend_enabled) {\n\t\ttrace_suspend_resume(TPS(\"sync_filesystems\"), 0, true);\n\t\tksys_sync_helper();\n\t\ttrace_suspend_resume(TPS(\"sync_filesystems\"), 0, false);\n\t}\n\n\tpm_pr_dbg(\"Preparing system for sleep (%s)\\n\", mem_sleep_labels[state]);\n\tpm_suspend_clear_flags();\n\terror = suspend_prepare(state);\n\tif (error)\n\t\tgoto Unlock;\n\n\tif (suspend_test(TEST_FREEZER))\n\t\tgoto Finish;\n\n\ttrace_suspend_resume(TPS(\"suspend_enter\"), state, false);\n\tpm_pr_dbg(\"Suspending system (%s)\\n\", mem_sleep_labels[state]);\n\tpm_restrict_gfp_mask();\n\terror = suspend_devices_and_enter(state);\n\tpm_restore_gfp_mask();\n\n Finish:\n\tevents_check_enabled = false;\n\tpm_pr_dbg(\"Finishing wakeup.\\n\");\n\tsuspend_finish();\n Unlock:\n\tmutex_unlock(&system_transition_mutex);\n\treturn error;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const char * const mem_sleep_labels[] = {\n\t[PM_SUSPEND_TO_IDLE] = \"s2idle\",\n\t[PM_SUSPEND_STANDBY] = \"shallow\",\n\t[PM_SUSPEND_MEM] = \"deep\",\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const char * const mem_sleep_labels[] = {\n\t[PM_SUSPEND_TO_IDLE] = \"s2idle\",\n\t[PM_SUSPEND_STANDBY] = \"shallow\",\n\t[PM_SUSPEND_MEM] = \"deep\",\n};\n\nstatic int enter_state(suspend_state_t state)\n{\n\tint error;\n\n\ttrace_suspend_resume(TPS(\"suspend_enter\"), state, true);\n\tif (state == PM_SUSPEND_TO_IDLE) {\n#ifdef CONFIG_PM_DEBUG\n\t\tif (pm_test_level != TEST_NONE && pm_test_level <= TEST_CPUS) {\n\t\t\tpr_warn(\"Unsupported test mode for suspend to idle, please choose none/freezer/devices/platform.\\n\");\n\t\t\treturn -EAGAIN;\n\t\t}\n#endif\n\t} else if (!valid_state(state)) {\n\t\treturn -EINVAL;\n\t}\n\tif (!mutex_trylock(&system_transition_mutex))\n\t\treturn -EBUSY;\n\n\tif (state == PM_SUSPEND_TO_IDLE)\n\t\ts2idle_begin();\n\n\tif (sync_on_suspend_enabled) {\n\t\ttrace_suspend_resume(TPS(\"sync_filesystems\"), 0, true);\n\t\tksys_sync_helper();\n\t\ttrace_suspend_resume(TPS(\"sync_filesystems\"), 0, false);\n\t}\n\n\tpm_pr_dbg(\"Preparing system for sleep (%s)\\n\", mem_sleep_labels[state]);\n\tpm_suspend_clear_flags();\n\terror = suspend_prepare(state);\n\tif (error)\n\t\tgoto Unlock;\n\n\tif (suspend_test(TEST_FREEZER))\n\t\tgoto Finish;\n\n\ttrace_suspend_resume(TPS(\"suspend_enter\"), state, false);\n\tpm_pr_dbg(\"Suspending system (%s)\\n\", mem_sleep_labels[state]);\n\tpm_restrict_gfp_mask();\n\terror = suspend_devices_and_enter(state);\n\tpm_restore_gfp_mask();\n\n Finish:\n\tevents_check_enabled = false;\n\tpm_pr_dbg(\"Finishing wakeup.\\n\");\n\tsuspend_finish();\n Unlock:\n\tmutex_unlock(&system_transition_mutex);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"suspend entry (%s)\\n\"",
            "mem_sleep_labels[state]"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const char * const mem_sleep_labels[] = {\n\t[PM_SUSPEND_TO_IDLE] = \"s2idle\",\n\t[PM_SUSPEND_STANDBY] = \"shallow\",\n\t[PM_SUSPEND_MEM] = \"deep\",\n};\n\nint pm_suspend(suspend_state_t state)\n{\n\tint error;\n\n\tif (state <= PM_SUSPEND_ON || state >= PM_SUSPEND_MAX)\n\t\treturn -EINVAL;\n\n\tpr_info(\"suspend entry (%s)\\n\", mem_sleep_labels[state]);\n\terror = enter_state(state);\n\tif (error) {\n\t\tsuspend_stats.fail++;\n\t\tdpm_save_failed_errno(error);\n\t} else {\n\t\tsuspend_stats.success++;\n\t}\n\tpr_info(\"suspend exit\\n\");\n\treturn error;\n}"
  },
  {
    "function_name": "enter_state",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "547-596",
    "snippet": "static int enter_state(suspend_state_t state)\n{\n\tint error;\n\n\ttrace_suspend_resume(TPS(\"suspend_enter\"), state, true);\n\tif (state == PM_SUSPEND_TO_IDLE) {\n#ifdef CONFIG_PM_DEBUG\n\t\tif (pm_test_level != TEST_NONE && pm_test_level <= TEST_CPUS) {\n\t\t\tpr_warn(\"Unsupported test mode for suspend to idle, please choose none/freezer/devices/platform.\\n\");\n\t\t\treturn -EAGAIN;\n\t\t}\n#endif\n\t} else if (!valid_state(state)) {\n\t\treturn -EINVAL;\n\t}\n\tif (!mutex_trylock(&system_transition_mutex))\n\t\treturn -EBUSY;\n\n\tif (state == PM_SUSPEND_TO_IDLE)\n\t\ts2idle_begin();\n\n\tif (sync_on_suspend_enabled) {\n\t\ttrace_suspend_resume(TPS(\"sync_filesystems\"), 0, true);\n\t\tksys_sync_helper();\n\t\ttrace_suspend_resume(TPS(\"sync_filesystems\"), 0, false);\n\t}\n\n\tpm_pr_dbg(\"Preparing system for sleep (%s)\\n\", mem_sleep_labels[state]);\n\tpm_suspend_clear_flags();\n\terror = suspend_prepare(state);\n\tif (error)\n\t\tgoto Unlock;\n\n\tif (suspend_test(TEST_FREEZER))\n\t\tgoto Finish;\n\n\ttrace_suspend_resume(TPS(\"suspend_enter\"), state, false);\n\tpm_pr_dbg(\"Suspending system (%s)\\n\", mem_sleep_labels[state]);\n\tpm_restrict_gfp_mask();\n\terror = suspend_devices_and_enter(state);\n\tpm_restore_gfp_mask();\n\n Finish:\n\tevents_check_enabled = false;\n\tpm_pr_dbg(\"Finishing wakeup.\\n\");\n\tsuspend_finish();\n Unlock:\n\tmutex_unlock(&system_transition_mutex);\n\treturn error;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char * const mem_sleep_labels[] = {\n\t[PM_SUSPEND_TO_IDLE] = \"s2idle\",\n\t[PM_SUSPEND_STANDBY] = \"shallow\",\n\t[PM_SUSPEND_MEM] = \"deep\",\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&system_transition_mutex"
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "__rt_mutex_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex.c",
          "lines": "1350-1356",
          "snippet": "static __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}",
          "includes": [
            "# include \"ww_mutex.h\"",
            "#include \"rtmutex_common.h\"",
            "#include <linux/ww_mutex.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"ww_mutex.h\"\n#include \"rtmutex_common.h\"\n#include <linux/ww_mutex.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n\nstatic __always_inline struct;\n\nstatic __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "suspend_finish",
          "args": [],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "suspend_finish",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "532-537",
          "snippet": "static void suspend_finish(void)\n{\n\tsuspend_thaw_processes();\n\tpm_notifier_call_chain(PM_POST_SUSPEND);\n\tpm_restore_console();\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic void suspend_finish(void)\n{\n\tsuspend_thaw_processes();\n\tpm_notifier_call_chain(PM_POST_SUSPEND);\n\tpm_restore_console();\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_pr_dbg",
          "args": [
            "\"Finishing wakeup.\\n\""
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pm_restore_gfp_mask",
          "args": [],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "suspend_devices_and_enter",
          "args": [
            "state"
          ],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "suspend_devices_and_enter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "476-524",
          "snippet": "int suspend_devices_and_enter(suspend_state_t state)\n{\n\tint error;\n\tbool wakeup = false;\n\n\tif (!sleep_state_supported(state))\n\t\treturn -ENOSYS;\n\n\tpm_suspend_target_state = state;\n\n\tif (state == PM_SUSPEND_TO_IDLE)\n\t\tpm_set_suspend_no_platform();\n\n\terror = platform_suspend_begin(state);\n\tif (error)\n\t\tgoto Close;\n\n\tsuspend_console();\n\tsuspend_test_start();\n\terror = dpm_suspend_start(PMSG_SUSPEND);\n\tif (error) {\n\t\tpr_err(\"Some devices failed to suspend, or early wake event detected\\n\");\n\t\tgoto Recover_platform;\n\t}\n\tsuspend_test_finish(\"suspend devices\");\n\tif (suspend_test(TEST_DEVICES))\n\t\tgoto Recover_platform;\n\n\tdo {\n\t\terror = suspend_enter(state, &wakeup);\n\t} while (!error && !wakeup && platform_suspend_again(state));\n\n Resume_devices:\n\tsuspend_test_start();\n\tdpm_resume_end(PMSG_RESUME);\n\tsuspend_test_finish(\"resume devices\");\n\ttrace_suspend_resume(TPS(\"resume_console\"), state, true);\n\tresume_console();\n\ttrace_suspend_resume(TPS(\"resume_console\"), state, false);\n\n Close:\n\tplatform_resume_end(state);\n\tpm_suspend_target_state = PM_SUSPEND_ON;\n\treturn error;\n\n Recover_platform:\n\tplatform_recover(state);\n\tgoto Resume_devices;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "suspend_state_t pm_suspend_target_state;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nsuspend_state_t pm_suspend_target_state;\n\nint suspend_devices_and_enter(suspend_state_t state)\n{\n\tint error;\n\tbool wakeup = false;\n\n\tif (!sleep_state_supported(state))\n\t\treturn -ENOSYS;\n\n\tpm_suspend_target_state = state;\n\n\tif (state == PM_SUSPEND_TO_IDLE)\n\t\tpm_set_suspend_no_platform();\n\n\terror = platform_suspend_begin(state);\n\tif (error)\n\t\tgoto Close;\n\n\tsuspend_console();\n\tsuspend_test_start();\n\terror = dpm_suspend_start(PMSG_SUSPEND);\n\tif (error) {\n\t\tpr_err(\"Some devices failed to suspend, or early wake event detected\\n\");\n\t\tgoto Recover_platform;\n\t}\n\tsuspend_test_finish(\"suspend devices\");\n\tif (suspend_test(TEST_DEVICES))\n\t\tgoto Recover_platform;\n\n\tdo {\n\t\terror = suspend_enter(state, &wakeup);\n\t} while (!error && !wakeup && platform_suspend_again(state));\n\n Resume_devices:\n\tsuspend_test_start();\n\tdpm_resume_end(PMSG_RESUME);\n\tsuspend_test_finish(\"resume devices\");\n\ttrace_suspend_resume(TPS(\"resume_console\"), state, true);\n\tresume_console();\n\ttrace_suspend_resume(TPS(\"resume_console\"), state, false);\n\n Close:\n\tplatform_resume_end(state);\n\tpm_suspend_target_state = PM_SUSPEND_ON;\n\treturn error;\n\n Recover_platform:\n\tplatform_recover(state);\n\tgoto Resume_devices;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_restrict_gfp_mask",
          "args": [],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pm_pr_dbg",
          "args": [
            "\"Suspending system (%s)\\n\"",
            "mem_sleep_labels[state]"
          ],
          "line": 584
        },
        "resolved": true,
        "details": {
          "function_name": "__pm_pr_dbg",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/main.c",
          "lines": "553-572",
          "snippet": "void __pm_pr_dbg(bool defer, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tif (!pm_debug_messages_on)\n\t\treturn;\n\n\tva_start(args, fmt);\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tif (defer)\n\t\tprintk_deferred(KERN_DEBUG \"PM: %pV\", &vaf);\n\telse\n\t\tprintk(KERN_DEBUG \"PM: %pV\", &vaf);\n\n\tva_end(args);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/pm_runtime.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/suspend.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/pm-trace.h>",
            "#include <linux/string.h>",
            "#include <linux/kobject.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/pm_runtime.h>\n#include <linux/syscalls.h>\n#include <linux/suspend.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/workqueue.h>\n#include <linux/pm-trace.h>\n#include <linux/string.h>\n#include <linux/kobject.h>\n#include <linux/export.h>\n\nvoid __pm_pr_dbg(bool defer, const char *fmt, ...)\n{\n\tstruct va_format vaf;\n\tva_list args;\n\n\tif (!pm_debug_messages_on)\n\t\treturn;\n\n\tva_start(args, fmt);\n\n\tvaf.fmt = fmt;\n\tvaf.va = &args;\n\n\tif (defer)\n\t\tprintk_deferred(KERN_DEBUG \"PM: %pV\", &vaf);\n\telse\n\t\tprintk(KERN_DEBUG \"PM: %pV\", &vaf);\n\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_suspend_resume",
          "args": [
            "TPS(\"suspend_enter\")",
            "state",
            "false"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TPS",
          "args": [
            "\"suspend_enter\""
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "suspend_test",
          "args": [
            "TEST_FREEZER"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "suspend_test",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "324-335",
          "snippet": "static int suspend_test(int level)\n{\n#ifdef CONFIG_PM_DEBUG\n\tif (pm_test_level == level) {\n\t\tpr_info(\"suspend debug: Waiting for %d second(s).\\n\",\n\t\t\t\tpm_test_delay);\n\t\tmdelay(pm_test_delay * 1000);\n\t\treturn 1;\n\t}\n#endif /* !CONFIG_PM_DEBUG */\n\treturn 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic int suspend_test(int level)\n{\n#ifdef CONFIG_PM_DEBUG\n\tif (pm_test_level == level) {\n\t\tpr_info(\"suspend debug: Waiting for %d second(s).\\n\",\n\t\t\t\tpm_test_delay);\n\t\tmdelay(pm_test_delay * 1000);\n\t\treturn 1;\n\t}\n#endif /* !CONFIG_PM_DEBUG */\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "suspend_prepare",
          "args": [
            "state"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "suspend_prepare",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "345-370",
          "snippet": "static int suspend_prepare(suspend_state_t state)\n{\n\tint error;\n\n\tif (!sleep_state_supported(state))\n\t\treturn -EPERM;\n\n\tpm_prepare_console();\n\n\terror = pm_notifier_call_chain_robust(PM_SUSPEND_PREPARE, PM_POST_SUSPEND);\n\tif (error)\n\t\tgoto Restore;\n\n\ttrace_suspend_resume(TPS(\"freeze_processes\"), 0, true);\n\terror = suspend_freeze_processes();\n\ttrace_suspend_resume(TPS(\"freeze_processes\"), 0, false);\n\tif (!error)\n\t\treturn 0;\n\n\tsuspend_stats.failed_freeze++;\n\tdpm_save_failed_step(SUSPEND_FREEZE);\n\tpm_notifier_call_chain(PM_POST_SUSPEND);\n Restore:\n\tpm_restore_console();\n\treturn error;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic int suspend_prepare(suspend_state_t state)\n{\n\tint error;\n\n\tif (!sleep_state_supported(state))\n\t\treturn -EPERM;\n\n\tpm_prepare_console();\n\n\terror = pm_notifier_call_chain_robust(PM_SUSPEND_PREPARE, PM_POST_SUSPEND);\n\tif (error)\n\t\tgoto Restore;\n\n\ttrace_suspend_resume(TPS(\"freeze_processes\"), 0, true);\n\terror = suspend_freeze_processes();\n\ttrace_suspend_resume(TPS(\"freeze_processes\"), 0, false);\n\tif (!error)\n\t\treturn 0;\n\n\tsuspend_stats.failed_freeze++;\n\tdpm_save_failed_step(SUSPEND_FREEZE);\n\tpm_notifier_call_chain(PM_POST_SUSPEND);\n Restore:\n\tpm_restore_console();\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_suspend_clear_flags",
          "args": [],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_suspend_resume",
          "args": [
            "TPS(\"sync_filesystems\")",
            "0",
            "false"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TPS",
          "args": [
            "\"sync_filesystems\""
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ksys_sync_helper",
          "args": [],
          "line": 570
        },
        "resolved": true,
        "details": {
          "function_name": "ksys_sync_helper",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/main.c",
          "lines": "54-64",
          "snippet": "void ksys_sync_helper(void)\n{\n\tktime_t start;\n\tlong elapsed_msecs;\n\n\tstart = ktime_get();\n\tksys_sync();\n\telapsed_msecs = ktime_to_ms(ktime_sub(ktime_get(), start));\n\tpr_info(\"Filesystems sync: %ld.%03ld seconds\\n\",\n\t\telapsed_msecs / MSEC_PER_SEC, elapsed_msecs % MSEC_PER_SEC);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/pm_runtime.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/suspend.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/pm-trace.h>",
            "#include <linux/string.h>",
            "#include <linux/kobject.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/pm_runtime.h>\n#include <linux/syscalls.h>\n#include <linux/suspend.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/workqueue.h>\n#include <linux/pm-trace.h>\n#include <linux/string.h>\n#include <linux/kobject.h>\n#include <linux/export.h>\n\nvoid ksys_sync_helper(void)\n{\n\tktime_t start;\n\tlong elapsed_msecs;\n\n\tstart = ktime_get();\n\tksys_sync();\n\telapsed_msecs = ktime_to_ms(ktime_sub(ktime_get(), start));\n\tpr_info(\"Filesystems sync: %ld.%03ld seconds\\n\",\n\t\telapsed_msecs / MSEC_PER_SEC, elapsed_msecs % MSEC_PER_SEC);\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_suspend_resume",
          "args": [
            "TPS(\"sync_filesystems\")",
            "0",
            "true"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TPS",
          "args": [
            "\"sync_filesystems\""
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s2idle_begin",
          "args": [],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "s2idle_begin",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "83-86",
          "snippet": "static void s2idle_begin(void)\n{\n\ts2idle_state = S2IDLE_STATE_NONE;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic void s2idle_begin(void)\n{\n\ts2idle_state = S2IDLE_STATE_NONE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_trylock",
          "args": [
            "&system_transition_mutex"
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "__rt_mutex_trylock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex.c",
          "lines": "1278-1284",
          "snippet": "static __always_inline int __rt_mutex_trylock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_acquire(lock, NULL, current)))\n\t\treturn 1;\n\n\treturn rt_mutex_slowtrylock(lock);\n}",
          "includes": [
            "# include \"ww_mutex.h\"",
            "#include \"rtmutex_common.h\"",
            "#include <linux/ww_mutex.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"ww_mutex.h\"\n#include \"rtmutex_common.h\"\n#include <linux/ww_mutex.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n\nstatic __always_inline struct;\n\nstatic __always_inline int __rt_mutex_trylock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_acquire(lock, NULL, current)))\n\t\treturn 1;\n\n\treturn rt_mutex_slowtrylock(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "valid_state",
          "args": [
            "state"
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "valid_state",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "160-170",
          "snippet": "static bool valid_state(suspend_state_t state)\n{\n\t/*\n\t * The PM_SUSPEND_STANDBY and PM_SUSPEND_MEM states require low-level\n\t * support and need to be valid to the low-level implementation.\n\t *\n\t * No ->valid() or ->enter() callback implies that none are valid.\n\t */\n\treturn suspend_ops && suspend_ops->valid && suspend_ops->valid(state) &&\n\t\tsuspend_ops->enter;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct platform_suspend_ops *suspend_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\n\nstatic bool valid_state(suspend_state_t state)\n{\n\t/*\n\t * The PM_SUSPEND_STANDBY and PM_SUSPEND_MEM states require low-level\n\t * support and need to be valid to the low-level implementation.\n\t *\n\t * No ->valid() or ->enter() callback implies that none are valid.\n\t */\n\treturn suspend_ops && suspend_ops->valid && suspend_ops->valid(state) &&\n\t\tsuspend_ops->enter;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"Unsupported test mode for suspend to idle, please choose none/freezer/devices/platform.\\n\""
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_suspend_resume",
          "args": [
            "TPS(\"suspend_enter\")",
            "state",
            "true"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TPS",
          "args": [
            "\"suspend_enter\""
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const char * const mem_sleep_labels[] = {\n\t[PM_SUSPEND_TO_IDLE] = \"s2idle\",\n\t[PM_SUSPEND_STANDBY] = \"shallow\",\n\t[PM_SUSPEND_MEM] = \"deep\",\n};\n\nstatic int enter_state(suspend_state_t state)\n{\n\tint error;\n\n\ttrace_suspend_resume(TPS(\"suspend_enter\"), state, true);\n\tif (state == PM_SUSPEND_TO_IDLE) {\n#ifdef CONFIG_PM_DEBUG\n\t\tif (pm_test_level != TEST_NONE && pm_test_level <= TEST_CPUS) {\n\t\t\tpr_warn(\"Unsupported test mode for suspend to idle, please choose none/freezer/devices/platform.\\n\");\n\t\t\treturn -EAGAIN;\n\t\t}\n#endif\n\t} else if (!valid_state(state)) {\n\t\treturn -EINVAL;\n\t}\n\tif (!mutex_trylock(&system_transition_mutex))\n\t\treturn -EBUSY;\n\n\tif (state == PM_SUSPEND_TO_IDLE)\n\t\ts2idle_begin();\n\n\tif (sync_on_suspend_enabled) {\n\t\ttrace_suspend_resume(TPS(\"sync_filesystems\"), 0, true);\n\t\tksys_sync_helper();\n\t\ttrace_suspend_resume(TPS(\"sync_filesystems\"), 0, false);\n\t}\n\n\tpm_pr_dbg(\"Preparing system for sleep (%s)\\n\", mem_sleep_labels[state]);\n\tpm_suspend_clear_flags();\n\terror = suspend_prepare(state);\n\tif (error)\n\t\tgoto Unlock;\n\n\tif (suspend_test(TEST_FREEZER))\n\t\tgoto Finish;\n\n\ttrace_suspend_resume(TPS(\"suspend_enter\"), state, false);\n\tpm_pr_dbg(\"Suspending system (%s)\\n\", mem_sleep_labels[state]);\n\tpm_restrict_gfp_mask();\n\terror = suspend_devices_and_enter(state);\n\tpm_restore_gfp_mask();\n\n Finish:\n\tevents_check_enabled = false;\n\tpm_pr_dbg(\"Finishing wakeup.\\n\");\n\tsuspend_finish();\n Unlock:\n\tmutex_unlock(&system_transition_mutex);\n\treturn error;\n}"
  },
  {
    "function_name": "suspend_finish",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "532-537",
    "snippet": "static void suspend_finish(void)\n{\n\tsuspend_thaw_processes();\n\tpm_notifier_call_chain(PM_POST_SUSPEND);\n\tpm_restore_console();\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pm_restore_console",
          "args": [],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "pm_restore_console",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/console.c",
          "lines": "143-152",
          "snippet": "void pm_restore_console(void)\n{\n\tif (!pm_vt_switch())\n\t\treturn;\n\n\tif (orig_fgconsole >= 0) {\n\t\tvt_move_to_console(orig_fgconsole, 0);\n\t\tvt_kmsg_redirect(orig_kmsg);\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/vt.h>",
            "#include <linux/kbd_kern.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/console.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int orig_fgconsole, orig_kmsg;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/vt.h>\n#include <linux/kbd_kern.h>\n#include <linux/vt_kern.h>\n#include <linux/console.h>\n\nstatic int orig_fgconsole, orig_kmsg;\n\nvoid pm_restore_console(void)\n{\n\tif (!pm_vt_switch())\n\t\treturn;\n\n\tif (orig_fgconsole >= 0) {\n\t\tvt_move_to_console(orig_fgconsole, 0);\n\t\tvt_kmsg_redirect(orig_kmsg);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_notifier_call_chain",
          "args": [
            "PM_POST_SUSPEND"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "pm_notifier_call_chain",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/main.c",
          "lines": "92-95",
          "snippet": "int pm_notifier_call_chain(unsigned long val)\n{\n\treturn blocking_notifier_call_chain(&pm_chain_head, val, NULL);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/pm_runtime.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/suspend.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/pm-trace.h>",
            "#include <linux/string.h>",
            "#include <linux/kobject.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/pm_runtime.h>\n#include <linux/syscalls.h>\n#include <linux/suspend.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/workqueue.h>\n#include <linux/pm-trace.h>\n#include <linux/string.h>\n#include <linux/kobject.h>\n#include <linux/export.h>\n\nint pm_notifier_call_chain(unsigned long val)\n{\n\treturn blocking_notifier_call_chain(&pm_chain_head, val, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "suspend_thaw_processes",
          "args": [],
          "line": 534
        },
        "resolved": true,
        "details": {
          "function_name": "suspend_thaw_processes",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/power.h",
          "lines": "285-287",
          "snippet": "static inline void suspend_thaw_processes(void)\n{\n}",
          "includes": [
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/compiler.h>",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/suspend_ioctls.h>",
            "#include <linux/suspend.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/compiler.h>\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/suspend_ioctls.h>\n#include <linux/suspend.h>\n\nstatic inline void suspend_thaw_processes(void)\n{\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic void suspend_finish(void)\n{\n\tsuspend_thaw_processes();\n\tpm_notifier_call_chain(PM_POST_SUSPEND);\n\tpm_restore_console();\n}"
  },
  {
    "function_name": "suspend_devices_and_enter",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "476-524",
    "snippet": "int suspend_devices_and_enter(suspend_state_t state)\n{\n\tint error;\n\tbool wakeup = false;\n\n\tif (!sleep_state_supported(state))\n\t\treturn -ENOSYS;\n\n\tpm_suspend_target_state = state;\n\n\tif (state == PM_SUSPEND_TO_IDLE)\n\t\tpm_set_suspend_no_platform();\n\n\terror = platform_suspend_begin(state);\n\tif (error)\n\t\tgoto Close;\n\n\tsuspend_console();\n\tsuspend_test_start();\n\terror = dpm_suspend_start(PMSG_SUSPEND);\n\tif (error) {\n\t\tpr_err(\"Some devices failed to suspend, or early wake event detected\\n\");\n\t\tgoto Recover_platform;\n\t}\n\tsuspend_test_finish(\"suspend devices\");\n\tif (suspend_test(TEST_DEVICES))\n\t\tgoto Recover_platform;\n\n\tdo {\n\t\terror = suspend_enter(state, &wakeup);\n\t} while (!error && !wakeup && platform_suspend_again(state));\n\n Resume_devices:\n\tsuspend_test_start();\n\tdpm_resume_end(PMSG_RESUME);\n\tsuspend_test_finish(\"resume devices\");\n\ttrace_suspend_resume(TPS(\"resume_console\"), state, true);\n\tresume_console();\n\ttrace_suspend_resume(TPS(\"resume_console\"), state, false);\n\n Close:\n\tplatform_resume_end(state);\n\tpm_suspend_target_state = PM_SUSPEND_ON;\n\treturn error;\n\n Recover_platform:\n\tplatform_recover(state);\n\tgoto Resume_devices;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "suspend_state_t pm_suspend_target_state;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "platform_recover",
          "args": [
            "state"
          ],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "platform_recover",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "305-309",
          "snippet": "static void platform_recover(suspend_state_t state)\n{\n\tif (state != PM_SUSPEND_TO_IDLE && suspend_ops->recover)\n\t\tsuspend_ops->recover();\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct platform_suspend_ops *suspend_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\n\nstatic void platform_recover(suspend_state_t state)\n{\n\tif (state != PM_SUSPEND_TO_IDLE && suspend_ops->recover)\n\t\tsuspend_ops->recover();\n}"
        }
      },
      {
        "call_info": {
          "callee": "platform_resume_end",
          "args": [
            "state"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "platform_resume_end",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "297-303",
          "snippet": "static void platform_resume_end(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE && s2idle_ops && s2idle_ops->end)\n\t\ts2idle_ops->end();\n\telse if (suspend_ops && suspend_ops->end)\n\t\tsuspend_ops->end();\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct platform_suspend_ops *suspend_ops;",
            "static const struct platform_s2idle_ops *s2idle_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\nstatic const struct platform_s2idle_ops *s2idle_ops;\n\nstatic void platform_resume_end(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE && s2idle_ops && s2idle_ops->end)\n\t\ts2idle_ops->end();\n\telse if (suspend_ops && suspend_ops->end)\n\t\tsuspend_ops->end();\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_suspend_resume",
          "args": [
            "TPS(\"resume_console\")",
            "state",
            "false"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TPS",
          "args": [
            "\"resume_console\""
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "resume_console",
          "args": [],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "resume_console",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2484-2491",
          "snippet": "void resume_console(void)\n{\n\tif (!console_suspend_enabled)\n\t\treturn;\n\tdown_console_sem();\n\tconsole_suspended = 0;\n\tconsole_unlock();\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int console_locked, console_suspended;",
            "bool console_suspend_enabled = true;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_locked, console_suspended;\nbool console_suspend_enabled = true;\n\nvoid resume_console(void)\n{\n\tif (!console_suspend_enabled)\n\t\treturn;\n\tdown_console_sem();\n\tconsole_suspended = 0;\n\tconsole_unlock();\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_suspend_resume",
          "args": [
            "TPS(\"resume_console\")",
            "state",
            "true"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TPS",
          "args": [
            "\"resume_console\""
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "suspend_test_finish",
          "args": [
            "\"resume devices\""
          ],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "suspend_test_finish",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/power.h",
          "lines": "211-211",
          "snippet": "static inline void suspend_test_finish(const char *label) {}",
          "includes": [
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/compiler.h>",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/suspend_ioctls.h>",
            "#include <linux/suspend.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/compiler.h>\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/suspend_ioctls.h>\n#include <linux/suspend.h>\n\nstatic inline void suspend_test_finish(const char *label) {}"
        }
      },
      {
        "call_info": {
          "callee": "dpm_resume_end",
          "args": [
            "PMSG_RESUME"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "suspend_test_start",
          "args": [],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "suspend_test_start",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/power.h",
          "lines": "210-210",
          "snippet": "static inline void suspend_test_start(void) {}",
          "includes": [
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/compiler.h>",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/suspend_ioctls.h>",
            "#include <linux/suspend.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/compiler.h>\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/suspend_ioctls.h>\n#include <linux/suspend.h>\n\nstatic inline void suspend_test_start(void) {}"
        }
      },
      {
        "call_info": {
          "callee": "platform_suspend_again",
          "args": [
            "state"
          ],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "platform_suspend_again",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "311-315",
          "snippet": "static bool platform_suspend_again(suspend_state_t state)\n{\n\treturn state != PM_SUSPEND_TO_IDLE && suspend_ops->suspend_again ?\n\t\tsuspend_ops->suspend_again() : false;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct platform_suspend_ops *suspend_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\n\nstatic bool platform_suspend_again(suspend_state_t state)\n{\n\treturn state != PM_SUSPEND_TO_IDLE && suspend_ops->suspend_again ?\n\t\tsuspend_ops->suspend_again() : false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "suspend_enter",
          "args": [
            "state",
            "&wakeup"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "suspend_enter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "391-470",
          "snippet": "static int suspend_enter(suspend_state_t state, bool *wakeup)\n{\n\tint error;\n\n\terror = platform_suspend_prepare(state);\n\tif (error)\n\t\tgoto Platform_finish;\n\n\terror = dpm_suspend_late(PMSG_SUSPEND);\n\tif (error) {\n\t\tpr_err(\"late suspend of devices failed\\n\");\n\t\tgoto Platform_finish;\n\t}\n\terror = platform_suspend_prepare_late(state);\n\tif (error)\n\t\tgoto Devices_early_resume;\n\n\terror = dpm_suspend_noirq(PMSG_SUSPEND);\n\tif (error) {\n\t\tpr_err(\"noirq suspend of devices failed\\n\");\n\t\tgoto Platform_early_resume;\n\t}\n\terror = platform_suspend_prepare_noirq(state);\n\tif (error)\n\t\tgoto Platform_wake;\n\n\tif (suspend_test(TEST_PLATFORM))\n\t\tgoto Platform_wake;\n\n\tif (state == PM_SUSPEND_TO_IDLE) {\n\t\ts2idle_loop();\n\t\tgoto Platform_wake;\n\t}\n\n\terror = pm_sleep_disable_secondary_cpus();\n\tif (error || suspend_test(TEST_CPUS))\n\t\tgoto Enable_cpus;\n\n\tarch_suspend_disable_irqs();\n\tBUG_ON(!irqs_disabled());\n\n\tsystem_state = SYSTEM_SUSPEND;\n\n\terror = syscore_suspend();\n\tif (!error) {\n\t\t*wakeup = pm_wakeup_pending();\n\t\tif (!(suspend_test(TEST_CORE) || *wakeup)) {\n\t\t\ttrace_suspend_resume(TPS(\"machine_suspend\"),\n\t\t\t\tstate, true);\n\t\t\terror = suspend_ops->enter(state);\n\t\t\ttrace_suspend_resume(TPS(\"machine_suspend\"),\n\t\t\t\tstate, false);\n\t\t} else if (*wakeup) {\n\t\t\terror = -EBUSY;\n\t\t}\n\t\tsyscore_resume();\n\t}\n\n\tsystem_state = SYSTEM_RUNNING;\n\n\tarch_suspend_enable_irqs();\n\tBUG_ON(irqs_disabled());\n\n Enable_cpus:\n\tpm_sleep_enable_secondary_cpus();\n\n Platform_wake:\n\tplatform_resume_noirq(state);\n\tdpm_resume_noirq(PMSG_RESUME);\n\n Platform_early_resume:\n\tplatform_resume_early(state);\n\n Devices_early_resume:\n\tdpm_resume_early(PMSG_RESUME);\n\n Platform_finish:\n\tplatform_resume_finish(state);\n\treturn error;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct platform_suspend_ops *suspend_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\n\nstatic int suspend_enter(suspend_state_t state, bool *wakeup)\n{\n\tint error;\n\n\terror = platform_suspend_prepare(state);\n\tif (error)\n\t\tgoto Platform_finish;\n\n\terror = dpm_suspend_late(PMSG_SUSPEND);\n\tif (error) {\n\t\tpr_err(\"late suspend of devices failed\\n\");\n\t\tgoto Platform_finish;\n\t}\n\terror = platform_suspend_prepare_late(state);\n\tif (error)\n\t\tgoto Devices_early_resume;\n\n\terror = dpm_suspend_noirq(PMSG_SUSPEND);\n\tif (error) {\n\t\tpr_err(\"noirq suspend of devices failed\\n\");\n\t\tgoto Platform_early_resume;\n\t}\n\terror = platform_suspend_prepare_noirq(state);\n\tif (error)\n\t\tgoto Platform_wake;\n\n\tif (suspend_test(TEST_PLATFORM))\n\t\tgoto Platform_wake;\n\n\tif (state == PM_SUSPEND_TO_IDLE) {\n\t\ts2idle_loop();\n\t\tgoto Platform_wake;\n\t}\n\n\terror = pm_sleep_disable_secondary_cpus();\n\tif (error || suspend_test(TEST_CPUS))\n\t\tgoto Enable_cpus;\n\n\tarch_suspend_disable_irqs();\n\tBUG_ON(!irqs_disabled());\n\n\tsystem_state = SYSTEM_SUSPEND;\n\n\terror = syscore_suspend();\n\tif (!error) {\n\t\t*wakeup = pm_wakeup_pending();\n\t\tif (!(suspend_test(TEST_CORE) || *wakeup)) {\n\t\t\ttrace_suspend_resume(TPS(\"machine_suspend\"),\n\t\t\t\tstate, true);\n\t\t\terror = suspend_ops->enter(state);\n\t\t\ttrace_suspend_resume(TPS(\"machine_suspend\"),\n\t\t\t\tstate, false);\n\t\t} else if (*wakeup) {\n\t\t\terror = -EBUSY;\n\t\t}\n\t\tsyscore_resume();\n\t}\n\n\tsystem_state = SYSTEM_RUNNING;\n\n\tarch_suspend_enable_irqs();\n\tBUG_ON(irqs_disabled());\n\n Enable_cpus:\n\tpm_sleep_enable_secondary_cpus();\n\n Platform_wake:\n\tplatform_resume_noirq(state);\n\tdpm_resume_noirq(PMSG_RESUME);\n\n Platform_early_resume:\n\tplatform_resume_early(state);\n\n Devices_early_resume:\n\tdpm_resume_early(PMSG_RESUME);\n\n Platform_finish:\n\tplatform_resume_finish(state);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "suspend_test",
          "args": [
            "TEST_DEVICES"
          ],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "suspend_test",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "324-335",
          "snippet": "static int suspend_test(int level)\n{\n#ifdef CONFIG_PM_DEBUG\n\tif (pm_test_level == level) {\n\t\tpr_info(\"suspend debug: Waiting for %d second(s).\\n\",\n\t\t\t\tpm_test_delay);\n\t\tmdelay(pm_test_delay * 1000);\n\t\treturn 1;\n\t}\n#endif /* !CONFIG_PM_DEBUG */\n\treturn 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic int suspend_test(int level)\n{\n#ifdef CONFIG_PM_DEBUG\n\tif (pm_test_level == level) {\n\t\tpr_info(\"suspend debug: Waiting for %d second(s).\\n\",\n\t\t\t\tpm_test_delay);\n\t\tmdelay(pm_test_delay * 1000);\n\t\treturn 1;\n\t}\n#endif /* !CONFIG_PM_DEBUG */\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Some devices failed to suspend, or early wake event detected\\n\""
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dpm_suspend_start",
          "args": [
            "PMSG_SUSPEND"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "suspend_console",
          "args": [],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "suspend_console",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2474-2482",
          "snippet": "void suspend_console(void)\n{\n\tif (!console_suspend_enabled)\n\t\treturn;\n\tpr_info(\"Suspending console(s) (use no_console_suspend to debug)\\n\");\n\tconsole_lock();\n\tconsole_suspended = 1;\n\tup_console_sem();\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int console_locked, console_suspended;",
            "bool console_suspend_enabled = true;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_locked, console_suspended;\nbool console_suspend_enabled = true;\n\nvoid suspend_console(void)\n{\n\tif (!console_suspend_enabled)\n\t\treturn;\n\tpr_info(\"Suspending console(s) (use no_console_suspend to debug)\\n\");\n\tconsole_lock();\n\tconsole_suspended = 1;\n\tup_console_sem();\n}"
        }
      },
      {
        "call_info": {
          "callee": "platform_suspend_begin",
          "args": [
            "state"
          ],
          "line": 489
        },
        "resolved": true,
        "details": {
          "function_name": "platform_suspend_begin",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "287-295",
          "snippet": "static int platform_suspend_begin(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE && s2idle_ops && s2idle_ops->begin)\n\t\treturn s2idle_ops->begin();\n\telse if (suspend_ops && suspend_ops->begin)\n\t\treturn suspend_ops->begin(state);\n\telse\n\t\treturn 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct platform_suspend_ops *suspend_ops;",
            "static const struct platform_s2idle_ops *s2idle_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\nstatic const struct platform_s2idle_ops *s2idle_ops;\n\nstatic int platform_suspend_begin(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE && s2idle_ops && s2idle_ops->begin)\n\t\treturn s2idle_ops->begin();\n\telse if (suspend_ops && suspend_ops->begin)\n\t\treturn suspend_ops->begin(state);\n\telse\n\t\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_set_suspend_no_platform",
          "args": [],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sleep_state_supported",
          "args": [
            "state"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "sleep_state_supported",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "239-242",
          "snippet": "static bool sleep_state_supported(suspend_state_t state)\n{\n\treturn state == PM_SUSPEND_TO_IDLE || valid_state(state);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic bool sleep_state_supported(suspend_state_t state)\n{\n\treturn state == PM_SUSPEND_TO_IDLE || valid_state(state);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nsuspend_state_t pm_suspend_target_state;\n\nint suspend_devices_and_enter(suspend_state_t state)\n{\n\tint error;\n\tbool wakeup = false;\n\n\tif (!sleep_state_supported(state))\n\t\treturn -ENOSYS;\n\n\tpm_suspend_target_state = state;\n\n\tif (state == PM_SUSPEND_TO_IDLE)\n\t\tpm_set_suspend_no_platform();\n\n\terror = platform_suspend_begin(state);\n\tif (error)\n\t\tgoto Close;\n\n\tsuspend_console();\n\tsuspend_test_start();\n\terror = dpm_suspend_start(PMSG_SUSPEND);\n\tif (error) {\n\t\tpr_err(\"Some devices failed to suspend, or early wake event detected\\n\");\n\t\tgoto Recover_platform;\n\t}\n\tsuspend_test_finish(\"suspend devices\");\n\tif (suspend_test(TEST_DEVICES))\n\t\tgoto Recover_platform;\n\n\tdo {\n\t\terror = suspend_enter(state, &wakeup);\n\t} while (!error && !wakeup && platform_suspend_again(state));\n\n Resume_devices:\n\tsuspend_test_start();\n\tdpm_resume_end(PMSG_RESUME);\n\tsuspend_test_finish(\"resume devices\");\n\ttrace_suspend_resume(TPS(\"resume_console\"), state, true);\n\tresume_console();\n\ttrace_suspend_resume(TPS(\"resume_console\"), state, false);\n\n Close:\n\tplatform_resume_end(state);\n\tpm_suspend_target_state = PM_SUSPEND_ON;\n\treturn error;\n\n Recover_platform:\n\tplatform_recover(state);\n\tgoto Resume_devices;\n}"
  },
  {
    "function_name": "suspend_enter",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "391-470",
    "snippet": "static int suspend_enter(suspend_state_t state, bool *wakeup)\n{\n\tint error;\n\n\terror = platform_suspend_prepare(state);\n\tif (error)\n\t\tgoto Platform_finish;\n\n\terror = dpm_suspend_late(PMSG_SUSPEND);\n\tif (error) {\n\t\tpr_err(\"late suspend of devices failed\\n\");\n\t\tgoto Platform_finish;\n\t}\n\terror = platform_suspend_prepare_late(state);\n\tif (error)\n\t\tgoto Devices_early_resume;\n\n\terror = dpm_suspend_noirq(PMSG_SUSPEND);\n\tif (error) {\n\t\tpr_err(\"noirq suspend of devices failed\\n\");\n\t\tgoto Platform_early_resume;\n\t}\n\terror = platform_suspend_prepare_noirq(state);\n\tif (error)\n\t\tgoto Platform_wake;\n\n\tif (suspend_test(TEST_PLATFORM))\n\t\tgoto Platform_wake;\n\n\tif (state == PM_SUSPEND_TO_IDLE) {\n\t\ts2idle_loop();\n\t\tgoto Platform_wake;\n\t}\n\n\terror = pm_sleep_disable_secondary_cpus();\n\tif (error || suspend_test(TEST_CPUS))\n\t\tgoto Enable_cpus;\n\n\tarch_suspend_disable_irqs();\n\tBUG_ON(!irqs_disabled());\n\n\tsystem_state = SYSTEM_SUSPEND;\n\n\terror = syscore_suspend();\n\tif (!error) {\n\t\t*wakeup = pm_wakeup_pending();\n\t\tif (!(suspend_test(TEST_CORE) || *wakeup)) {\n\t\t\ttrace_suspend_resume(TPS(\"machine_suspend\"),\n\t\t\t\tstate, true);\n\t\t\terror = suspend_ops->enter(state);\n\t\t\ttrace_suspend_resume(TPS(\"machine_suspend\"),\n\t\t\t\tstate, false);\n\t\t} else if (*wakeup) {\n\t\t\terror = -EBUSY;\n\t\t}\n\t\tsyscore_resume();\n\t}\n\n\tsystem_state = SYSTEM_RUNNING;\n\n\tarch_suspend_enable_irqs();\n\tBUG_ON(irqs_disabled());\n\n Enable_cpus:\n\tpm_sleep_enable_secondary_cpus();\n\n Platform_wake:\n\tplatform_resume_noirq(state);\n\tdpm_resume_noirq(PMSG_RESUME);\n\n Platform_early_resume:\n\tplatform_resume_early(state);\n\n Devices_early_resume:\n\tdpm_resume_early(PMSG_RESUME);\n\n Platform_finish:\n\tplatform_resume_finish(state);\n\treturn error;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct platform_suspend_ops *suspend_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "platform_resume_finish",
          "args": [
            "state"
          ],
          "line": 468
        },
        "resolved": true,
        "details": {
          "function_name": "platform_resume_finish",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "281-285",
          "snippet": "static void platform_resume_finish(suspend_state_t state)\n{\n\tif (state != PM_SUSPEND_TO_IDLE && suspend_ops->finish)\n\t\tsuspend_ops->finish();\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct platform_suspend_ops *suspend_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\n\nstatic void platform_resume_finish(suspend_state_t state)\n{\n\tif (state != PM_SUSPEND_TO_IDLE && suspend_ops->finish)\n\t\tsuspend_ops->finish();\n}"
        }
      },
      {
        "call_info": {
          "callee": "dpm_resume_early",
          "args": [
            "PMSG_RESUME"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "platform_resume_early",
          "args": [
            "state"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "platform_resume_early",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "275-279",
          "snippet": "static void platform_resume_early(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE && s2idle_ops && s2idle_ops->restore)\n\t\ts2idle_ops->restore();\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct platform_s2idle_ops *s2idle_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_s2idle_ops *s2idle_ops;\n\nstatic void platform_resume_early(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE && s2idle_ops && s2idle_ops->restore)\n\t\ts2idle_ops->restore();\n}"
        }
      },
      {
        "call_info": {
          "callee": "dpm_resume_noirq",
          "args": [
            "PMSG_RESUME"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "platform_resume_noirq",
          "args": [
            "state"
          ],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "platform_resume_noirq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "265-273",
          "snippet": "static void platform_resume_noirq(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE) {\n\t\tif (s2idle_ops && s2idle_ops->restore_early)\n\t\t\ts2idle_ops->restore_early();\n\t} else if (suspend_ops->wake) {\n\t\tsuspend_ops->wake();\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct platform_suspend_ops *suspend_ops;",
            "static const struct platform_s2idle_ops *s2idle_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\nstatic const struct platform_s2idle_ops *s2idle_ops;\n\nstatic void platform_resume_noirq(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE) {\n\t\tif (s2idle_ops && s2idle_ops->restore_early)\n\t\t\ts2idle_ops->restore_early();\n\t} else if (suspend_ops->wake) {\n\t\tsuspend_ops->wake();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_sleep_enable_secondary_cpus",
          "args": [],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "pm_sleep_enable_secondary_cpus",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/power.h",
          "lines": "323-327",
          "snippet": "static inline void pm_sleep_enable_secondary_cpus(void)\n{\n\tsuspend_enable_secondary_cpus();\n\tcpuidle_resume();\n}",
          "includes": [
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/compiler.h>",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/suspend_ioctls.h>",
            "#include <linux/suspend.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/compiler.h>\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/suspend_ioctls.h>\n#include <linux/suspend.h>\n\nstatic inline void pm_sleep_enable_secondary_cpus(void)\n{\n\tsuspend_enable_secondary_cpus();\n\tcpuidle_resume();\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "irqs_disabled()"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irqs_disabled",
          "args": [],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arch_suspend_enable_irqs",
          "args": [],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "arch_suspend_enable_irqs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "379-382",
          "snippet": "void __weak arch_suspend_enable_irqs(void)\n{\n\tlocal_irq_enable();\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nvoid __weak arch_suspend_enable_irqs(void)\n{\n\tlocal_irq_enable();\n}"
        }
      },
      {
        "call_info": {
          "callee": "syscore_resume",
          "args": [],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "irq_pm_syscore_resume",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/pm.c",
          "lines": "234-237",
          "snippet": "static void irq_pm_syscore_resume(void)\n{\n\tresume_irqs(true);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/irq.h>\n\nstatic void irq_pm_syscore_resume(void)\n{\n\tresume_irqs(true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_suspend_resume",
          "args": [
            "TPS(\"machine_suspend\")",
            "state",
            "false"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TPS",
          "args": [
            "\"machine_suspend\""
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "suspend_ops->enter",
          "args": [
            "state"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_suspend_resume",
          "args": [
            "TPS(\"machine_suspend\")",
            "state",
            "true"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TPS",
          "args": [
            "\"machine_suspend\""
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "suspend_test",
          "args": [
            "TEST_CORE"
          ],
          "line": 437
        },
        "resolved": true,
        "details": {
          "function_name": "suspend_test",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "324-335",
          "snippet": "static int suspend_test(int level)\n{\n#ifdef CONFIG_PM_DEBUG\n\tif (pm_test_level == level) {\n\t\tpr_info(\"suspend debug: Waiting for %d second(s).\\n\",\n\t\t\t\tpm_test_delay);\n\t\tmdelay(pm_test_delay * 1000);\n\t\treturn 1;\n\t}\n#endif /* !CONFIG_PM_DEBUG */\n\treturn 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic int suspend_test(int level)\n{\n#ifdef CONFIG_PM_DEBUG\n\tif (pm_test_level == level) {\n\t\tpr_info(\"suspend debug: Waiting for %d second(s).\\n\",\n\t\t\t\tpm_test_delay);\n\t\tmdelay(pm_test_delay * 1000);\n\t\treturn 1;\n\t}\n#endif /* !CONFIG_PM_DEBUG */\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_wakeup_pending",
          "args": [],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "syscore_suspend",
          "args": [],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!irqs_disabled()"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irqs_disabled",
          "args": [],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arch_suspend_disable_irqs",
          "args": [],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "arch_suspend_disable_irqs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "373-376",
          "snippet": "void __weak arch_suspend_disable_irqs(void)\n{\n\tlocal_irq_disable();\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nvoid __weak arch_suspend_disable_irqs(void)\n{\n\tlocal_irq_disable();\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_sleep_disable_secondary_cpus",
          "args": [],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "pm_sleep_disable_secondary_cpus",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/power.h",
          "lines": "317-321",
          "snippet": "static inline int pm_sleep_disable_secondary_cpus(void)\n{\n\tcpuidle_pause();\n\treturn suspend_disable_secondary_cpus();\n}",
          "includes": [
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/compiler.h>",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/suspend_ioctls.h>",
            "#include <linux/suspend.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/compiler.h>\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/suspend_ioctls.h>\n#include <linux/suspend.h>\n\nstatic inline int pm_sleep_disable_secondary_cpus(void)\n{\n\tcpuidle_pause();\n\treturn suspend_disable_secondary_cpus();\n}"
        }
      },
      {
        "call_info": {
          "callee": "s2idle_loop",
          "args": [],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "s2idle_loop",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "118-145",
          "snippet": "static void s2idle_loop(void)\n{\n\tpm_pr_dbg(\"suspend-to-idle\\n\");\n\n\t/*\n\t * Suspend-to-idle equals:\n\t * frozen processes + suspended devices + idle processors.\n\t * Thus s2idle_enter() should be called right after all devices have\n\t * been suspended.\n\t *\n\t * Wakeups during the noirq suspend of devices may be spurious, so try\n\t * to avoid them upfront.\n\t */\n\tfor (;;) {\n\t\tif (s2idle_ops && s2idle_ops->wake) {\n\t\t\tif (s2idle_ops->wake())\n\t\t\t\tbreak;\n\t\t} else if (pm_wakeup_pending()) {\n\t\t\tbreak;\n\t\t}\n\n\t\tpm_wakeup_clear(false);\n\n\t\ts2idle_enter();\n\t}\n\n\tpm_pr_dbg(\"resume from suspend-to-idle\\n\");\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct platform_s2idle_ops *s2idle_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_s2idle_ops *s2idle_ops;\n\nstatic void s2idle_loop(void)\n{\n\tpm_pr_dbg(\"suspend-to-idle\\n\");\n\n\t/*\n\t * Suspend-to-idle equals:\n\t * frozen processes + suspended devices + idle processors.\n\t * Thus s2idle_enter() should be called right after all devices have\n\t * been suspended.\n\t *\n\t * Wakeups during the noirq suspend of devices may be spurious, so try\n\t * to avoid them upfront.\n\t */\n\tfor (;;) {\n\t\tif (s2idle_ops && s2idle_ops->wake) {\n\t\t\tif (s2idle_ops->wake())\n\t\t\t\tbreak;\n\t\t} else if (pm_wakeup_pending()) {\n\t\t\tbreak;\n\t\t}\n\n\t\tpm_wakeup_clear(false);\n\n\t\ts2idle_enter();\n\t}\n\n\tpm_pr_dbg(\"resume from suspend-to-idle\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "platform_suspend_prepare_noirq",
          "args": [
            "state"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "platform_suspend_prepare_noirq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "256-263",
          "snippet": "static int platform_suspend_prepare_noirq(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE)\n\t\treturn s2idle_ops && s2idle_ops->prepare_late ?\n\t\t\ts2idle_ops->prepare_late() : 0;\n\n\treturn suspend_ops->prepare_late ? suspend_ops->prepare_late() : 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct platform_suspend_ops *suspend_ops;",
            "static const struct platform_s2idle_ops *s2idle_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\nstatic const struct platform_s2idle_ops *s2idle_ops;\n\nstatic int platform_suspend_prepare_noirq(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE)\n\t\treturn s2idle_ops && s2idle_ops->prepare_late ?\n\t\t\ts2idle_ops->prepare_late() : 0;\n\n\treturn suspend_ops->prepare_late ? suspend_ops->prepare_late() : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"noirq suspend of devices failed\\n\""
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dpm_suspend_noirq",
          "args": [
            "PMSG_SUSPEND"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "platform_suspend_prepare_late",
          "args": [
            "state"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "platform_suspend_prepare_late",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "250-254",
          "snippet": "static int platform_suspend_prepare_late(suspend_state_t state)\n{\n\treturn state == PM_SUSPEND_TO_IDLE && s2idle_ops && s2idle_ops->prepare ?\n\t\ts2idle_ops->prepare() : 0;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct platform_s2idle_ops *s2idle_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_s2idle_ops *s2idle_ops;\n\nstatic int platform_suspend_prepare_late(suspend_state_t state)\n{\n\treturn state == PM_SUSPEND_TO_IDLE && s2idle_ops && s2idle_ops->prepare ?\n\t\ts2idle_ops->prepare() : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"late suspend of devices failed\\n\""
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dpm_suspend_late",
          "args": [
            "PMSG_SUSPEND"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\n\nstatic int suspend_enter(suspend_state_t state, bool *wakeup)\n{\n\tint error;\n\n\terror = platform_suspend_prepare(state);\n\tif (error)\n\t\tgoto Platform_finish;\n\n\terror = dpm_suspend_late(PMSG_SUSPEND);\n\tif (error) {\n\t\tpr_err(\"late suspend of devices failed\\n\");\n\t\tgoto Platform_finish;\n\t}\n\terror = platform_suspend_prepare_late(state);\n\tif (error)\n\t\tgoto Devices_early_resume;\n\n\terror = dpm_suspend_noirq(PMSG_SUSPEND);\n\tif (error) {\n\t\tpr_err(\"noirq suspend of devices failed\\n\");\n\t\tgoto Platform_early_resume;\n\t}\n\terror = platform_suspend_prepare_noirq(state);\n\tif (error)\n\t\tgoto Platform_wake;\n\n\tif (suspend_test(TEST_PLATFORM))\n\t\tgoto Platform_wake;\n\n\tif (state == PM_SUSPEND_TO_IDLE) {\n\t\ts2idle_loop();\n\t\tgoto Platform_wake;\n\t}\n\n\terror = pm_sleep_disable_secondary_cpus();\n\tif (error || suspend_test(TEST_CPUS))\n\t\tgoto Enable_cpus;\n\n\tarch_suspend_disable_irqs();\n\tBUG_ON(!irqs_disabled());\n\n\tsystem_state = SYSTEM_SUSPEND;\n\n\terror = syscore_suspend();\n\tif (!error) {\n\t\t*wakeup = pm_wakeup_pending();\n\t\tif (!(suspend_test(TEST_CORE) || *wakeup)) {\n\t\t\ttrace_suspend_resume(TPS(\"machine_suspend\"),\n\t\t\t\tstate, true);\n\t\t\terror = suspend_ops->enter(state);\n\t\t\ttrace_suspend_resume(TPS(\"machine_suspend\"),\n\t\t\t\tstate, false);\n\t\t} else if (*wakeup) {\n\t\t\terror = -EBUSY;\n\t\t}\n\t\tsyscore_resume();\n\t}\n\n\tsystem_state = SYSTEM_RUNNING;\n\n\tarch_suspend_enable_irqs();\n\tBUG_ON(irqs_disabled());\n\n Enable_cpus:\n\tpm_sleep_enable_secondary_cpus();\n\n Platform_wake:\n\tplatform_resume_noirq(state);\n\tdpm_resume_noirq(PMSG_RESUME);\n\n Platform_early_resume:\n\tplatform_resume_early(state);\n\n Devices_early_resume:\n\tdpm_resume_early(PMSG_RESUME);\n\n Platform_finish:\n\tplatform_resume_finish(state);\n\treturn error;\n}"
  },
  {
    "function_name": "arch_suspend_enable_irqs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "379-382",
    "snippet": "void __weak arch_suspend_enable_irqs(void)\n{\n\tlocal_irq_enable();\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_irq_enable",
          "args": [],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nvoid __weak arch_suspend_enable_irqs(void)\n{\n\tlocal_irq_enable();\n}"
  },
  {
    "function_name": "arch_suspend_disable_irqs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "373-376",
    "snippet": "void __weak arch_suspend_disable_irqs(void)\n{\n\tlocal_irq_disable();\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_irq_disable",
          "args": [],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nvoid __weak arch_suspend_disable_irqs(void)\n{\n\tlocal_irq_disable();\n}"
  },
  {
    "function_name": "suspend_prepare",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "345-370",
    "snippet": "static int suspend_prepare(suspend_state_t state)\n{\n\tint error;\n\n\tif (!sleep_state_supported(state))\n\t\treturn -EPERM;\n\n\tpm_prepare_console();\n\n\terror = pm_notifier_call_chain_robust(PM_SUSPEND_PREPARE, PM_POST_SUSPEND);\n\tif (error)\n\t\tgoto Restore;\n\n\ttrace_suspend_resume(TPS(\"freeze_processes\"), 0, true);\n\terror = suspend_freeze_processes();\n\ttrace_suspend_resume(TPS(\"freeze_processes\"), 0, false);\n\tif (!error)\n\t\treturn 0;\n\n\tsuspend_stats.failed_freeze++;\n\tdpm_save_failed_step(SUSPEND_FREEZE);\n\tpm_notifier_call_chain(PM_POST_SUSPEND);\n Restore:\n\tpm_restore_console();\n\treturn error;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pm_restore_console",
          "args": [],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "pm_restore_console",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/console.c",
          "lines": "143-152",
          "snippet": "void pm_restore_console(void)\n{\n\tif (!pm_vt_switch())\n\t\treturn;\n\n\tif (orig_fgconsole >= 0) {\n\t\tvt_move_to_console(orig_fgconsole, 0);\n\t\tvt_kmsg_redirect(orig_kmsg);\n\t}\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/vt.h>",
            "#include <linux/kbd_kern.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/console.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int orig_fgconsole, orig_kmsg;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/vt.h>\n#include <linux/kbd_kern.h>\n#include <linux/vt_kern.h>\n#include <linux/console.h>\n\nstatic int orig_fgconsole, orig_kmsg;\n\nvoid pm_restore_console(void)\n{\n\tif (!pm_vt_switch())\n\t\treturn;\n\n\tif (orig_fgconsole >= 0) {\n\t\tvt_move_to_console(orig_fgconsole, 0);\n\t\tvt_kmsg_redirect(orig_kmsg);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_notifier_call_chain",
          "args": [
            "PM_POST_SUSPEND"
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "pm_notifier_call_chain",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/main.c",
          "lines": "92-95",
          "snippet": "int pm_notifier_call_chain(unsigned long val)\n{\n\treturn blocking_notifier_call_chain(&pm_chain_head, val, NULL);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/pm_runtime.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/suspend.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/pm-trace.h>",
            "#include <linux/string.h>",
            "#include <linux/kobject.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/pm_runtime.h>\n#include <linux/syscalls.h>\n#include <linux/suspend.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/workqueue.h>\n#include <linux/pm-trace.h>\n#include <linux/string.h>\n#include <linux/kobject.h>\n#include <linux/export.h>\n\nint pm_notifier_call_chain(unsigned long val)\n{\n\treturn blocking_notifier_call_chain(&pm_chain_head, val, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dpm_save_failed_step",
          "args": [
            "SUSPEND_FREEZE"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_suspend_resume",
          "args": [
            "TPS(\"freeze_processes\")",
            "0",
            "false"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TPS",
          "args": [
            "\"freeze_processes\""
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "suspend_freeze_processes",
          "args": [],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "suspend_freeze_processes",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/power.h",
          "lines": "280-283",
          "snippet": "static inline int suspend_freeze_processes(void)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/compiler.h>",
            "#include <linux/freezer.h>",
            "#include <linux/utsname.h>",
            "#include <linux/suspend_ioctls.h>",
            "#include <linux/suspend.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/compiler.h>\n#include <linux/freezer.h>\n#include <linux/utsname.h>\n#include <linux/suspend_ioctls.h>\n#include <linux/suspend.h>\n\nstatic inline int suspend_freeze_processes(void)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_suspend_resume",
          "args": [
            "TPS(\"freeze_processes\")",
            "0",
            "true"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TPS",
          "args": [
            "\"freeze_processes\""
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pm_notifier_call_chain_robust",
          "args": [
            "PM_SUSPEND_PREPARE",
            "PM_POST_SUSPEND"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "pm_notifier_call_chain_robust",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/main.c",
          "lines": "83-90",
          "snippet": "int pm_notifier_call_chain_robust(unsigned long val_up, unsigned long val_down)\n{\n\tint ret;\n\n\tret = blocking_notifier_call_chain_robust(&pm_chain_head, val_up, val_down, NULL);\n\n\treturn notifier_to_errno(ret);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/pm_runtime.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/suspend.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/pm-trace.h>",
            "#include <linux/string.h>",
            "#include <linux/kobject.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/pm_runtime.h>\n#include <linux/syscalls.h>\n#include <linux/suspend.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/workqueue.h>\n#include <linux/pm-trace.h>\n#include <linux/string.h>\n#include <linux/kobject.h>\n#include <linux/export.h>\n\nint pm_notifier_call_chain_robust(unsigned long val_up, unsigned long val_down)\n{\n\tint ret;\n\n\tret = blocking_notifier_call_chain_robust(&pm_chain_head, val_up, val_down, NULL);\n\n\treturn notifier_to_errno(ret);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_prepare_console",
          "args": [],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "pm_prepare_console",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/console.c",
          "lines": "130-141",
          "snippet": "void pm_prepare_console(void)\n{\n\tif (!pm_vt_switch())\n\t\treturn;\n\n\torig_fgconsole = vt_move_to_console(SUSPEND_CONSOLE, 1);\n\tif (orig_fgconsole < 0)\n\t\treturn;\n\n\torig_kmsg = vt_kmsg_redirect(SUSPEND_CONSOLE);\n\treturn;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/vt.h>",
            "#include <linux/kbd_kern.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/console.h>"
          ],
          "macros_used": [
            "#define SUSPEND_CONSOLE\t(MAX_NR_CONSOLES-1)"
          ],
          "globals_used": [
            "static int orig_fgconsole, orig_kmsg;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/vt.h>\n#include <linux/kbd_kern.h>\n#include <linux/vt_kern.h>\n#include <linux/console.h>\n\n#define SUSPEND_CONSOLE\t(MAX_NR_CONSOLES-1)\n\nstatic int orig_fgconsole, orig_kmsg;\n\nvoid pm_prepare_console(void)\n{\n\tif (!pm_vt_switch())\n\t\treturn;\n\n\torig_fgconsole = vt_move_to_console(SUSPEND_CONSOLE, 1);\n\tif (orig_fgconsole < 0)\n\t\treturn;\n\n\torig_kmsg = vt_kmsg_redirect(SUSPEND_CONSOLE);\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sleep_state_supported",
          "args": [
            "state"
          ],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "sleep_state_supported",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "239-242",
          "snippet": "static bool sleep_state_supported(suspend_state_t state)\n{\n\treturn state == PM_SUSPEND_TO_IDLE || valid_state(state);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic bool sleep_state_supported(suspend_state_t state)\n{\n\treturn state == PM_SUSPEND_TO_IDLE || valid_state(state);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic int suspend_prepare(suspend_state_t state)\n{\n\tint error;\n\n\tif (!sleep_state_supported(state))\n\t\treturn -EPERM;\n\n\tpm_prepare_console();\n\n\terror = pm_notifier_call_chain_robust(PM_SUSPEND_PREPARE, PM_POST_SUSPEND);\n\tif (error)\n\t\tgoto Restore;\n\n\ttrace_suspend_resume(TPS(\"freeze_processes\"), 0, true);\n\terror = suspend_freeze_processes();\n\ttrace_suspend_resume(TPS(\"freeze_processes\"), 0, false);\n\tif (!error)\n\t\treturn 0;\n\n\tsuspend_stats.failed_freeze++;\n\tdpm_save_failed_step(SUSPEND_FREEZE);\n\tpm_notifier_call_chain(PM_POST_SUSPEND);\n Restore:\n\tpm_restore_console();\n\treturn error;\n}"
  },
  {
    "function_name": "suspend_test",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "324-335",
    "snippet": "static int suspend_test(int level)\n{\n#ifdef CONFIG_PM_DEBUG\n\tif (pm_test_level == level) {\n\t\tpr_info(\"suspend debug: Waiting for %d second(s).\\n\",\n\t\t\t\tpm_test_delay);\n\t\tmdelay(pm_test_delay * 1000);\n\t\treturn 1;\n\t}\n#endif /* !CONFIG_PM_DEBUG */\n\treturn 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mdelay",
          "args": [
            "pm_test_delay * 1000"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"suspend debug: Waiting for %d second(s).\\n\"",
            "pm_test_delay"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic int suspend_test(int level)\n{\n#ifdef CONFIG_PM_DEBUG\n\tif (pm_test_level == level) {\n\t\tpr_info(\"suspend debug: Waiting for %d second(s).\\n\",\n\t\t\t\tpm_test_delay);\n\t\tmdelay(pm_test_delay * 1000);\n\t\treturn 1;\n\t}\n#endif /* !CONFIG_PM_DEBUG */\n\treturn 0;\n}"
  },
  {
    "function_name": "platform_suspend_again",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "311-315",
    "snippet": "static bool platform_suspend_again(suspend_state_t state)\n{\n\treturn state != PM_SUSPEND_TO_IDLE && suspend_ops->suspend_again ?\n\t\tsuspend_ops->suspend_again() : false;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct platform_suspend_ops *suspend_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "suspend_ops->suspend_again",
          "args": [],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\n\nstatic bool platform_suspend_again(suspend_state_t state)\n{\n\treturn state != PM_SUSPEND_TO_IDLE && suspend_ops->suspend_again ?\n\t\tsuspend_ops->suspend_again() : false;\n}"
  },
  {
    "function_name": "platform_recover",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "305-309",
    "snippet": "static void platform_recover(suspend_state_t state)\n{\n\tif (state != PM_SUSPEND_TO_IDLE && suspend_ops->recover)\n\t\tsuspend_ops->recover();\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct platform_suspend_ops *suspend_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "suspend_ops->recover",
          "args": [],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\n\nstatic void platform_recover(suspend_state_t state)\n{\n\tif (state != PM_SUSPEND_TO_IDLE && suspend_ops->recover)\n\t\tsuspend_ops->recover();\n}"
  },
  {
    "function_name": "platform_resume_end",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "297-303",
    "snippet": "static void platform_resume_end(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE && s2idle_ops && s2idle_ops->end)\n\t\ts2idle_ops->end();\n\telse if (suspend_ops && suspend_ops->end)\n\t\tsuspend_ops->end();\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct platform_suspend_ops *suspend_ops;",
      "static const struct platform_s2idle_ops *s2idle_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "suspend_ops->end",
          "args": [],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s2idle_ops->end",
          "args": [],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\nstatic const struct platform_s2idle_ops *s2idle_ops;\n\nstatic void platform_resume_end(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE && s2idle_ops && s2idle_ops->end)\n\t\ts2idle_ops->end();\n\telse if (suspend_ops && suspend_ops->end)\n\t\tsuspend_ops->end();\n}"
  },
  {
    "function_name": "platform_suspend_begin",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "287-295",
    "snippet": "static int platform_suspend_begin(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE && s2idle_ops && s2idle_ops->begin)\n\t\treturn s2idle_ops->begin();\n\telse if (suspend_ops && suspend_ops->begin)\n\t\treturn suspend_ops->begin(state);\n\telse\n\t\treturn 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct platform_suspend_ops *suspend_ops;",
      "static const struct platform_s2idle_ops *s2idle_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "suspend_ops->begin",
          "args": [
            "state"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s2idle_ops->begin",
          "args": [],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\nstatic const struct platform_s2idle_ops *s2idle_ops;\n\nstatic int platform_suspend_begin(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE && s2idle_ops && s2idle_ops->begin)\n\t\treturn s2idle_ops->begin();\n\telse if (suspend_ops && suspend_ops->begin)\n\t\treturn suspend_ops->begin(state);\n\telse\n\t\treturn 0;\n}"
  },
  {
    "function_name": "platform_resume_finish",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "281-285",
    "snippet": "static void platform_resume_finish(suspend_state_t state)\n{\n\tif (state != PM_SUSPEND_TO_IDLE && suspend_ops->finish)\n\t\tsuspend_ops->finish();\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct platform_suspend_ops *suspend_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "suspend_ops->finish",
          "args": [],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "finish",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/preload/bpf_preload_kern.c",
          "lines": "51-70",
          "snippet": "static int finish(void)\n{\n\tint magic = BPF_PRELOAD_END;\n\tstruct pid *tgid;\n\tloff_t pos = 0;\n\tssize_t n;\n\n\t/* send the last magic to UMD. It will do a normal exit. */\n\tn = kernel_write(umd_ops.info.pipe_to_umh,\n\t\t\t &magic, sizeof(magic), &pos);\n\tif (n != sizeof(magic))\n\t\treturn -EPIPE;\n\n\ttgid = umd_ops.info.tgid;\n\tif (tgid) {\n\t\twait_event(tgid->wait_pidfd, thread_group_exited(tgid));\n\t\tumd_cleanup_helper(&umd_ops.info);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"bpf_preload.h\"",
            "#include <linux/sched/signal.h>",
            "#include <linux/fs.h>",
            "#include <linux/pid.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int finish(void);",
            "static struct bpf_preload_ops umd_ops = {\n\t.info.driver_name = \"bpf_preload\",\n\t.preload = preload,\n\t.finish = finish,\n\t.owner = THIS_MODULE,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"bpf_preload.h\"\n#include <linux/sched/signal.h>\n#include <linux/fs.h>\n#include <linux/pid.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic int finish(void);\nstatic struct bpf_preload_ops umd_ops = {\n\t.info.driver_name = \"bpf_preload\",\n\t.preload = preload,\n\t.finish = finish,\n\t.owner = THIS_MODULE,\n};\n\nstatic int finish(void)\n{\n\tint magic = BPF_PRELOAD_END;\n\tstruct pid *tgid;\n\tloff_t pos = 0;\n\tssize_t n;\n\n\t/* send the last magic to UMD. It will do a normal exit. */\n\tn = kernel_write(umd_ops.info.pipe_to_umh,\n\t\t\t &magic, sizeof(magic), &pos);\n\tif (n != sizeof(magic))\n\t\treturn -EPIPE;\n\n\ttgid = umd_ops.info.tgid;\n\tif (tgid) {\n\t\twait_event(tgid->wait_pidfd, thread_group_exited(tgid));\n\t\tumd_cleanup_helper(&umd_ops.info);\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\n\nstatic void platform_resume_finish(suspend_state_t state)\n{\n\tif (state != PM_SUSPEND_TO_IDLE && suspend_ops->finish)\n\t\tsuspend_ops->finish();\n}"
  },
  {
    "function_name": "platform_resume_early",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "275-279",
    "snippet": "static void platform_resume_early(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE && s2idle_ops && s2idle_ops->restore)\n\t\ts2idle_ops->restore();\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct platform_s2idle_ops *s2idle_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "s2idle_ops->restore",
          "args": [],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_s2idle_ops *s2idle_ops;\n\nstatic void platform_resume_early(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE && s2idle_ops && s2idle_ops->restore)\n\t\ts2idle_ops->restore();\n}"
  },
  {
    "function_name": "platform_resume_noirq",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "265-273",
    "snippet": "static void platform_resume_noirq(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE) {\n\t\tif (s2idle_ops && s2idle_ops->restore_early)\n\t\t\ts2idle_ops->restore_early();\n\t} else if (suspend_ops->wake) {\n\t\tsuspend_ops->wake();\n\t}\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct platform_suspend_ops *suspend_ops;",
      "static const struct platform_s2idle_ops *s2idle_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "suspend_ops->wake",
          "args": [],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s2idle_ops->restore_early",
          "args": [],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\nstatic const struct platform_s2idle_ops *s2idle_ops;\n\nstatic void platform_resume_noirq(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE) {\n\t\tif (s2idle_ops && s2idle_ops->restore_early)\n\t\t\ts2idle_ops->restore_early();\n\t} else if (suspend_ops->wake) {\n\t\tsuspend_ops->wake();\n\t}\n}"
  },
  {
    "function_name": "platform_suspend_prepare_noirq",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "256-263",
    "snippet": "static int platform_suspend_prepare_noirq(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE)\n\t\treturn s2idle_ops && s2idle_ops->prepare_late ?\n\t\t\ts2idle_ops->prepare_late() : 0;\n\n\treturn suspend_ops->prepare_late ? suspend_ops->prepare_late() : 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct platform_suspend_ops *suspend_ops;",
      "static const struct platform_s2idle_ops *s2idle_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "suspend_ops->prepare_late",
          "args": [],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s2idle_ops->prepare_late",
          "args": [],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\nstatic const struct platform_s2idle_ops *s2idle_ops;\n\nstatic int platform_suspend_prepare_noirq(suspend_state_t state)\n{\n\tif (state == PM_SUSPEND_TO_IDLE)\n\t\treturn s2idle_ops && s2idle_ops->prepare_late ?\n\t\t\ts2idle_ops->prepare_late() : 0;\n\n\treturn suspend_ops->prepare_late ? suspend_ops->prepare_late() : 0;\n}"
  },
  {
    "function_name": "platform_suspend_prepare_late",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "250-254",
    "snippet": "static int platform_suspend_prepare_late(suspend_state_t state)\n{\n\treturn state == PM_SUSPEND_TO_IDLE && s2idle_ops && s2idle_ops->prepare ?\n\t\ts2idle_ops->prepare() : 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct platform_s2idle_ops *s2idle_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "s2idle_ops->prepare",
          "args": [],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_s2idle_ops *s2idle_ops;\n\nstatic int platform_suspend_prepare_late(suspend_state_t state)\n{\n\treturn state == PM_SUSPEND_TO_IDLE && s2idle_ops && s2idle_ops->prepare ?\n\t\ts2idle_ops->prepare() : 0;\n}"
  },
  {
    "function_name": "platform_suspend_prepare",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "244-248",
    "snippet": "static int platform_suspend_prepare(suspend_state_t state)\n{\n\treturn state != PM_SUSPEND_TO_IDLE && suspend_ops->prepare ?\n\t\tsuspend_ops->prepare() : 0;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct platform_suspend_ops *suspend_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "suspend_ops->prepare",
          "args": [],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\n\nstatic int platform_suspend_prepare(suspend_state_t state)\n{\n\treturn state != PM_SUSPEND_TO_IDLE && suspend_ops->prepare ?\n\t\tsuspend_ops->prepare() : 0;\n}"
  },
  {
    "function_name": "sleep_state_supported",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "239-242",
    "snippet": "static bool sleep_state_supported(suspend_state_t state)\n{\n\treturn state == PM_SUSPEND_TO_IDLE || valid_state(state);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "valid_state",
          "args": [
            "state"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "valid_state",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "160-170",
          "snippet": "static bool valid_state(suspend_state_t state)\n{\n\t/*\n\t * The PM_SUSPEND_STANDBY and PM_SUSPEND_MEM states require low-level\n\t * support and need to be valid to the low-level implementation.\n\t *\n\t * No ->valid() or ->enter() callback implies that none are valid.\n\t */\n\treturn suspend_ops && suspend_ops->valid && suspend_ops->valid(state) &&\n\t\tsuspend_ops->enter;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct platform_suspend_ops *suspend_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\n\nstatic bool valid_state(suspend_state_t state)\n{\n\t/*\n\t * The PM_SUSPEND_STANDBY and PM_SUSPEND_MEM states require low-level\n\t * support and need to be valid to the low-level implementation.\n\t *\n\t * No ->valid() or ->enter() callback implies that none are valid.\n\t */\n\treturn suspend_ops && suspend_ops->valid && suspend_ops->valid(state) &&\n\t\tsuspend_ops->enter;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic bool sleep_state_supported(suspend_state_t state)\n{\n\treturn state == PM_SUSPEND_TO_IDLE || valid_state(state);\n}"
  },
  {
    "function_name": "suspend_valid_only_mem",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "233-236",
    "snippet": "int suspend_valid_only_mem(suspend_state_t state)\n{\n\treturn state == PM_SUSPEND_MEM;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nint suspend_valid_only_mem(suspend_state_t state)\n{\n\treturn state == PM_SUSPEND_MEM;\n}"
  },
  {
    "function_name": "suspend_set_ops",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "203-222",
    "snippet": "void suspend_set_ops(const struct platform_suspend_ops *ops)\n{\n\tlock_system_sleep();\n\n\tsuspend_ops = ops;\n\n\tif (valid_state(PM_SUSPEND_STANDBY)) {\n\t\tmem_sleep_states[PM_SUSPEND_STANDBY] = mem_sleep_labels[PM_SUSPEND_STANDBY];\n\t\tpm_states[PM_SUSPEND_STANDBY] = pm_labels[PM_SUSPEND_STANDBY];\n\t\tif (mem_sleep_default == PM_SUSPEND_STANDBY)\n\t\t\tmem_sleep_current = PM_SUSPEND_STANDBY;\n\t}\n\tif (valid_state(PM_SUSPEND_MEM)) {\n\t\tmem_sleep_states[PM_SUSPEND_MEM] = mem_sleep_labels[PM_SUSPEND_MEM];\n\t\tif (mem_sleep_default >= PM_SUSPEND_MEM)\n\t\t\tmem_sleep_current = PM_SUSPEND_MEM;\n\t}\n\n\tunlock_system_sleep();\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "const char * const pm_labels[] = {\n\t[PM_SUSPEND_TO_IDLE] = \"freeze\",\n\t[PM_SUSPEND_STANDBY] = \"standby\",\n\t[PM_SUSPEND_MEM] = \"mem\",\n};",
      "const char *pm_states[PM_SUSPEND_MAX];",
      "static const char * const mem_sleep_labels[] = {\n\t[PM_SUSPEND_TO_IDLE] = \"s2idle\",\n\t[PM_SUSPEND_STANDBY] = \"shallow\",\n\t[PM_SUSPEND_MEM] = \"deep\",\n};",
      "const char *mem_sleep_states[PM_SUSPEND_MAX];",
      "suspend_state_t mem_sleep_current = PM_SUSPEND_TO_IDLE;",
      "suspend_state_t mem_sleep_default = PM_SUSPEND_MAX;",
      "static const struct platform_suspend_ops *suspend_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlock_system_sleep",
          "args": [],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_system_sleep",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/main.c",
          "lines": "31-51",
          "snippet": "void unlock_system_sleep(void)\n{\n\t/*\n\t * Don't use freezer_count() because we don't want the call to\n\t * try_to_freeze() here.\n\t *\n\t * Reason:\n\t * Fundamentally, we just don't need it, because freezing condition\n\t * doesn't come into effect until we release the\n\t * system_transition_mutex lock, since the freezer always works with\n\t * system_transition_mutex held.\n\t *\n\t * More importantly, in the case of hibernation,\n\t * unlock_system_sleep() gets called in snapshot_read() and\n\t * snapshot_write() when the freezing condition is still in effect.\n\t * Which means, if we use try_to_freeze() here, it would make them\n\t * enter the refrigerator, thus causing hibernation to lockup.\n\t */\n\tcurrent->flags &= ~PF_FREEZER_SKIP;\n\tmutex_unlock(&system_transition_mutex);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/pm_runtime.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/suspend.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/pm-trace.h>",
            "#include <linux/string.h>",
            "#include <linux/kobject.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/pm_runtime.h>\n#include <linux/syscalls.h>\n#include <linux/suspend.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/workqueue.h>\n#include <linux/pm-trace.h>\n#include <linux/string.h>\n#include <linux/kobject.h>\n#include <linux/export.h>\n\nvoid unlock_system_sleep(void)\n{\n\t/*\n\t * Don't use freezer_count() because we don't want the call to\n\t * try_to_freeze() here.\n\t *\n\t * Reason:\n\t * Fundamentally, we just don't need it, because freezing condition\n\t * doesn't come into effect until we release the\n\t * system_transition_mutex lock, since the freezer always works with\n\t * system_transition_mutex held.\n\t *\n\t * More importantly, in the case of hibernation,\n\t * unlock_system_sleep() gets called in snapshot_read() and\n\t * snapshot_write() when the freezing condition is still in effect.\n\t * Which means, if we use try_to_freeze() here, it would make them\n\t * enter the refrigerator, thus causing hibernation to lockup.\n\t */\n\tcurrent->flags &= ~PF_FREEZER_SKIP;\n\tmutex_unlock(&system_transition_mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "valid_state",
          "args": [
            "PM_SUSPEND_MEM"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "valid_state",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "160-170",
          "snippet": "static bool valid_state(suspend_state_t state)\n{\n\t/*\n\t * The PM_SUSPEND_STANDBY and PM_SUSPEND_MEM states require low-level\n\t * support and need to be valid to the low-level implementation.\n\t *\n\t * No ->valid() or ->enter() callback implies that none are valid.\n\t */\n\treturn suspend_ops && suspend_ops->valid && suspend_ops->valid(state) &&\n\t\tsuspend_ops->enter;\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct platform_suspend_ops *suspend_ops;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\n\nstatic bool valid_state(suspend_state_t state)\n{\n\t/*\n\t * The PM_SUSPEND_STANDBY and PM_SUSPEND_MEM states require low-level\n\t * support and need to be valid to the low-level implementation.\n\t *\n\t * No ->valid() or ->enter() callback implies that none are valid.\n\t */\n\treturn suspend_ops && suspend_ops->valid && suspend_ops->valid(state) &&\n\t\tsuspend_ops->enter;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nconst char * const pm_labels[] = {\n\t[PM_SUSPEND_TO_IDLE] = \"freeze\",\n\t[PM_SUSPEND_STANDBY] = \"standby\",\n\t[PM_SUSPEND_MEM] = \"mem\",\n};\nconst char *pm_states[PM_SUSPEND_MAX];\nstatic const char * const mem_sleep_labels[] = {\n\t[PM_SUSPEND_TO_IDLE] = \"s2idle\",\n\t[PM_SUSPEND_STANDBY] = \"shallow\",\n\t[PM_SUSPEND_MEM] = \"deep\",\n};\nconst char *mem_sleep_states[PM_SUSPEND_MAX];\nsuspend_state_t mem_sleep_current = PM_SUSPEND_TO_IDLE;\nsuspend_state_t mem_sleep_default = PM_SUSPEND_MAX;\nstatic const struct platform_suspend_ops *suspend_ops;\n\nvoid suspend_set_ops(const struct platform_suspend_ops *ops)\n{\n\tlock_system_sleep();\n\n\tsuspend_ops = ops;\n\n\tif (valid_state(PM_SUSPEND_STANDBY)) {\n\t\tmem_sleep_states[PM_SUSPEND_STANDBY] = mem_sleep_labels[PM_SUSPEND_STANDBY];\n\t\tpm_states[PM_SUSPEND_STANDBY] = pm_labels[PM_SUSPEND_STANDBY];\n\t\tif (mem_sleep_default == PM_SUSPEND_STANDBY)\n\t\t\tmem_sleep_current = PM_SUSPEND_STANDBY;\n\t}\n\tif (valid_state(PM_SUSPEND_MEM)) {\n\t\tmem_sleep_states[PM_SUSPEND_MEM] = mem_sleep_labels[PM_SUSPEND_MEM];\n\t\tif (mem_sleep_default >= PM_SUSPEND_MEM)\n\t\t\tmem_sleep_current = PM_SUSPEND_MEM;\n\t}\n\n\tunlock_system_sleep();\n}"
  },
  {
    "function_name": "mem_sleep_default_setup",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "184-196",
    "snippet": "static int __init mem_sleep_default_setup(char *str)\n{\n\tsuspend_state_t state;\n\n\tfor (state = PM_SUSPEND_TO_IDLE; state <= PM_SUSPEND_MEM; state++)\n\t\tif (mem_sleep_labels[state] &&\n\t\t    !strcmp(str, mem_sleep_labels[state])) {\n\t\t\tmem_sleep_default = state;\n\t\t\tbreak;\n\t\t}\n\n\treturn 1;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const char * const mem_sleep_labels[] = {\n\t[PM_SUSPEND_TO_IDLE] = \"s2idle\",\n\t[PM_SUSPEND_STANDBY] = \"shallow\",\n\t[PM_SUSPEND_MEM] = \"deep\",\n};",
      "suspend_state_t mem_sleep_default = PM_SUSPEND_MAX;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "str",
            "mem_sleep_labels[state]"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "sym_strcmp",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/kcsan/report.c",
          "lines": "356-365",
          "snippet": "static int sym_strcmp(void *addr1, void *addr2)\n{\n\tchar buf1[64];\n\tchar buf2[64];\n\n\tsnprintf(buf1, sizeof(buf1), \"%pS\", addr1);\n\tsnprintf(buf2, sizeof(buf2), \"%pS\", addr2);\n\n\treturn strncmp(buf1, buf2, sizeof(buf1));\n}",
          "includes": [
            "#include \"encoding.h\"",
            "#include \"kcsan.h\"",
            "#include <linux/stacktrace.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/preempt.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/delay.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"encoding.h\"\n#include \"kcsan.h\"\n#include <linux/stacktrace.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/preempt.h>\n#include <linux/lockdep.h>\n#include <linux/kernel.h>\n#include <linux/kallsyms.h>\n#include <linux/jiffies.h>\n#include <linux/delay.h>\n#include <linux/debug_locks.h>\n\nstatic int sym_strcmp(void *addr1, void *addr2)\n{\n\tchar buf1[64];\n\tchar buf2[64];\n\n\tsnprintf(buf1, sizeof(buf1), \"%pS\", addr1);\n\tsnprintf(buf2, sizeof(buf2), \"%pS\", addr2);\n\n\treturn strncmp(buf1, buf2, sizeof(buf1));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const char * const mem_sleep_labels[] = {\n\t[PM_SUSPEND_TO_IDLE] = \"s2idle\",\n\t[PM_SUSPEND_STANDBY] = \"shallow\",\n\t[PM_SUSPEND_MEM] = \"deep\",\n};\nsuspend_state_t mem_sleep_default = PM_SUSPEND_MAX;\n\nstatic int __init mem_sleep_default_setup(char *str)\n{\n\tsuspend_state_t state;\n\n\tfor (state = PM_SUSPEND_TO_IDLE; state <= PM_SUSPEND_MEM; state++)\n\t\tif (mem_sleep_labels[state] &&\n\t\t    !strcmp(str, mem_sleep_labels[state])) {\n\t\t\tmem_sleep_default = state;\n\t\t\tbreak;\n\t\t}\n\n\treturn 1;\n}"
  },
  {
    "function_name": "pm_states_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "172-182",
    "snippet": "void __init pm_states_init(void)\n{\n\t/* \"mem\" and \"freeze\" are always present in /sys/power/state. */\n\tpm_states[PM_SUSPEND_MEM] = pm_labels[PM_SUSPEND_MEM];\n\tpm_states[PM_SUSPEND_TO_IDLE] = pm_labels[PM_SUSPEND_TO_IDLE];\n\t/*\n\t * Suspend-to-idle should be supported even without any suspend_ops,\n\t * initialize mem_sleep_states[] accordingly here.\n\t */\n\tmem_sleep_states[PM_SUSPEND_TO_IDLE] = mem_sleep_labels[PM_SUSPEND_TO_IDLE];\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "const char * const pm_labels[] = {\n\t[PM_SUSPEND_TO_IDLE] = \"freeze\",\n\t[PM_SUSPEND_STANDBY] = \"standby\",\n\t[PM_SUSPEND_MEM] = \"mem\",\n};",
      "const char *pm_states[PM_SUSPEND_MAX];",
      "static const char * const mem_sleep_labels[] = {\n\t[PM_SUSPEND_TO_IDLE] = \"s2idle\",\n\t[PM_SUSPEND_STANDBY] = \"shallow\",\n\t[PM_SUSPEND_MEM] = \"deep\",\n};",
      "const char *mem_sleep_states[PM_SUSPEND_MAX];",
      "static const struct platform_suspend_ops *suspend_ops;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nconst char * const pm_labels[] = {\n\t[PM_SUSPEND_TO_IDLE] = \"freeze\",\n\t[PM_SUSPEND_STANDBY] = \"standby\",\n\t[PM_SUSPEND_MEM] = \"mem\",\n};\nconst char *pm_states[PM_SUSPEND_MAX];\nstatic const char * const mem_sleep_labels[] = {\n\t[PM_SUSPEND_TO_IDLE] = \"s2idle\",\n\t[PM_SUSPEND_STANDBY] = \"shallow\",\n\t[PM_SUSPEND_MEM] = \"deep\",\n};\nconst char *mem_sleep_states[PM_SUSPEND_MAX];\nstatic const struct platform_suspend_ops *suspend_ops;\n\nvoid __init pm_states_init(void)\n{\n\t/* \"mem\" and \"freeze\" are always present in /sys/power/state. */\n\tpm_states[PM_SUSPEND_MEM] = pm_labels[PM_SUSPEND_MEM];\n\tpm_states[PM_SUSPEND_TO_IDLE] = pm_labels[PM_SUSPEND_TO_IDLE];\n\t/*\n\t * Suspend-to-idle should be supported even without any suspend_ops,\n\t * initialize mem_sleep_states[] accordingly here.\n\t */\n\tmem_sleep_states[PM_SUSPEND_TO_IDLE] = mem_sleep_labels[PM_SUSPEND_TO_IDLE];\n}"
  },
  {
    "function_name": "valid_state",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "160-170",
    "snippet": "static bool valid_state(suspend_state_t state)\n{\n\t/*\n\t * The PM_SUSPEND_STANDBY and PM_SUSPEND_MEM states require low-level\n\t * support and need to be valid to the low-level implementation.\n\t *\n\t * No ->valid() or ->enter() callback implies that none are valid.\n\t */\n\treturn suspend_ops && suspend_ops->valid && suspend_ops->valid(state) &&\n\t\tsuspend_ops->enter;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct platform_suspend_ops *suspend_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "suspend_ops->valid",
          "args": [
            "state"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_suspend_ops *suspend_ops;\n\nstatic bool valid_state(suspend_state_t state)\n{\n\t/*\n\t * The PM_SUSPEND_STANDBY and PM_SUSPEND_MEM states require low-level\n\t * support and need to be valid to the low-level implementation.\n\t *\n\t * No ->valid() or ->enter() callback implies that none are valid.\n\t */\n\treturn suspend_ops && suspend_ops->valid && suspend_ops->valid(state) &&\n\t\tsuspend_ops->enter;\n}"
  },
  {
    "function_name": "s2idle_wake",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "147-157",
    "snippet": "void s2idle_wake(void)\n{\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&s2idle_lock, flags);\n\tif (s2idle_state > S2IDLE_STATE_NONE) {\n\t\ts2idle_state = S2IDLE_STATE_WAKE;\n\t\tswake_up_one(&s2idle_wait_head);\n\t}\n\traw_spin_unlock_irqrestore(&s2idle_lock, flags);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DECLARE_SWAIT_QUEUE_HEAD(s2idle_wait_head);",
      "static DEFINE_RAW_SPINLOCK(s2idle_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&s2idle_lock",
            "flags"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "swake_up_one",
          "args": [
            "&s2idle_wait_head"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "swake_up_one",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/swait.c",
          "lines": "48-55",
          "snippet": "void swake_up_one(struct swait_queue_head *q)\n{\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&q->lock, flags);\n\tswake_up_locked(q);\n\traw_spin_unlock_irqrestore(&q->lock, flags);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nvoid swake_up_one(struct swait_queue_head *q)\n{\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&q->lock, flags);\n\tswake_up_locked(q);\n\traw_spin_unlock_irqrestore(&q->lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&s2idle_lock",
            "flags"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic DECLARE_SWAIT_QUEUE_HEAD(s2idle_wait_head);\nstatic DEFINE_RAW_SPINLOCK(s2idle_lock);\n\nvoid s2idle_wake(void)\n{\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&s2idle_lock, flags);\n\tif (s2idle_state > S2IDLE_STATE_NONE) {\n\t\ts2idle_state = S2IDLE_STATE_WAKE;\n\t\tswake_up_one(&s2idle_wait_head);\n\t}\n\traw_spin_unlock_irqrestore(&s2idle_lock, flags);\n}"
  },
  {
    "function_name": "s2idle_loop",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "118-145",
    "snippet": "static void s2idle_loop(void)\n{\n\tpm_pr_dbg(\"suspend-to-idle\\n\");\n\n\t/*\n\t * Suspend-to-idle equals:\n\t * frozen processes + suspended devices + idle processors.\n\t * Thus s2idle_enter() should be called right after all devices have\n\t * been suspended.\n\t *\n\t * Wakeups during the noirq suspend of devices may be spurious, so try\n\t * to avoid them upfront.\n\t */\n\tfor (;;) {\n\t\tif (s2idle_ops && s2idle_ops->wake) {\n\t\t\tif (s2idle_ops->wake())\n\t\t\t\tbreak;\n\t\t} else if (pm_wakeup_pending()) {\n\t\t\tbreak;\n\t\t}\n\n\t\tpm_wakeup_clear(false);\n\n\t\ts2idle_enter();\n\t}\n\n\tpm_pr_dbg(\"resume from suspend-to-idle\\n\");\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct platform_s2idle_ops *s2idle_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pm_pr_dbg",
          "args": [
            "\"resume from suspend-to-idle\\n\""
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s2idle_enter",
          "args": [],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "s2idle_enter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
          "lines": "88-116",
          "snippet": "static void s2idle_enter(void)\n{\n\ttrace_suspend_resume(TPS(\"machine_suspend\"), PM_SUSPEND_TO_IDLE, true);\n\n\traw_spin_lock_irq(&s2idle_lock);\n\tif (pm_wakeup_pending())\n\t\tgoto out;\n\n\ts2idle_state = S2IDLE_STATE_ENTER;\n\traw_spin_unlock_irq(&s2idle_lock);\n\n\tcpus_read_lock();\n\n\t/* Push all the CPUs into the idle loop. */\n\twake_up_all_idle_cpus();\n\t/* Make the current CPU wait so it can enter the idle loop too. */\n\tswait_event_exclusive(s2idle_wait_head,\n\t\t    s2idle_state == S2IDLE_STATE_WAKE);\n\n\tcpus_read_unlock();\n\n\traw_spin_lock_irq(&s2idle_lock);\n\n out:\n\ts2idle_state = S2IDLE_STATE_NONE;\n\traw_spin_unlock_irq(&s2idle_lock);\n\n\ttrace_suspend_resume(TPS(\"machine_suspend\"), PM_SUSPEND_TO_IDLE, false);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/moduleparam.h>",
            "#include <linux/compiler.h>",
            "#include <trace/events/power.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/swait.h>",
            "#include <linux/syscore_ops.h>",
            "#include <linux/suspend.h>",
            "#include <linux/export.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/io.h>",
            "#include <linux/gfp.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpu.h>",
            "#include <linux/console.h>",
            "#include <linux/init.h>",
            "#include <linux/errno.h>",
            "#include <linux/delay.h>",
            "#include <linux/string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DECLARE_SWAIT_QUEUE_HEAD(s2idle_wait_head);",
            "static DEFINE_RAW_SPINLOCK(s2idle_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic DECLARE_SWAIT_QUEUE_HEAD(s2idle_wait_head);\nstatic DEFINE_RAW_SPINLOCK(s2idle_lock);\n\nstatic void s2idle_enter(void)\n{\n\ttrace_suspend_resume(TPS(\"machine_suspend\"), PM_SUSPEND_TO_IDLE, true);\n\n\traw_spin_lock_irq(&s2idle_lock);\n\tif (pm_wakeup_pending())\n\t\tgoto out;\n\n\ts2idle_state = S2IDLE_STATE_ENTER;\n\traw_spin_unlock_irq(&s2idle_lock);\n\n\tcpus_read_lock();\n\n\t/* Push all the CPUs into the idle loop. */\n\twake_up_all_idle_cpus();\n\t/* Make the current CPU wait so it can enter the idle loop too. */\n\tswait_event_exclusive(s2idle_wait_head,\n\t\t    s2idle_state == S2IDLE_STATE_WAKE);\n\n\tcpus_read_unlock();\n\n\traw_spin_lock_irq(&s2idle_lock);\n\n out:\n\ts2idle_state = S2IDLE_STATE_NONE;\n\traw_spin_unlock_irq(&s2idle_lock);\n\n\ttrace_suspend_resume(TPS(\"machine_suspend\"), PM_SUSPEND_TO_IDLE, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_wakeup_clear",
          "args": [
            "false"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pm_wakeup_pending",
          "args": [],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s2idle_ops->wake",
          "args": [],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pm_pr_dbg",
          "args": [
            "\"suspend-to-idle\\n\""
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_s2idle_ops *s2idle_ops;\n\nstatic void s2idle_loop(void)\n{\n\tpm_pr_dbg(\"suspend-to-idle\\n\");\n\n\t/*\n\t * Suspend-to-idle equals:\n\t * frozen processes + suspended devices + idle processors.\n\t * Thus s2idle_enter() should be called right after all devices have\n\t * been suspended.\n\t *\n\t * Wakeups during the noirq suspend of devices may be spurious, so try\n\t * to avoid them upfront.\n\t */\n\tfor (;;) {\n\t\tif (s2idle_ops && s2idle_ops->wake) {\n\t\t\tif (s2idle_ops->wake())\n\t\t\t\tbreak;\n\t\t} else if (pm_wakeup_pending()) {\n\t\t\tbreak;\n\t\t}\n\n\t\tpm_wakeup_clear(false);\n\n\t\ts2idle_enter();\n\t}\n\n\tpm_pr_dbg(\"resume from suspend-to-idle\\n\");\n}"
  },
  {
    "function_name": "s2idle_enter",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "88-116",
    "snippet": "static void s2idle_enter(void)\n{\n\ttrace_suspend_resume(TPS(\"machine_suspend\"), PM_SUSPEND_TO_IDLE, true);\n\n\traw_spin_lock_irq(&s2idle_lock);\n\tif (pm_wakeup_pending())\n\t\tgoto out;\n\n\ts2idle_state = S2IDLE_STATE_ENTER;\n\traw_spin_unlock_irq(&s2idle_lock);\n\n\tcpus_read_lock();\n\n\t/* Push all the CPUs into the idle loop. */\n\twake_up_all_idle_cpus();\n\t/* Make the current CPU wait so it can enter the idle loop too. */\n\tswait_event_exclusive(s2idle_wait_head,\n\t\t    s2idle_state == S2IDLE_STATE_WAKE);\n\n\tcpus_read_unlock();\n\n\traw_spin_lock_irq(&s2idle_lock);\n\n out:\n\ts2idle_state = S2IDLE_STATE_NONE;\n\traw_spin_unlock_irq(&s2idle_lock);\n\n\ttrace_suspend_resume(TPS(\"machine_suspend\"), PM_SUSPEND_TO_IDLE, false);\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DECLARE_SWAIT_QUEUE_HEAD(s2idle_wait_head);",
      "static DEFINE_RAW_SPINLOCK(s2idle_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_suspend_resume",
          "args": [
            "TPS(\"machine_suspend\")",
            "PM_SUSPEND_TO_IDLE",
            "false"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TPS",
          "args": [
            "\"machine_suspend\""
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_unlock_irq",
          "args": [
            "&s2idle_lock"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "200-203",
          "snippet": "void __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irq",
          "args": [
            "&s2idle_lock"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "168-171",
          "snippet": "void __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpus_read_unlock",
          "args": [],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "cpus_read_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu.c",
          "lines": "319-322",
          "snippet": "void cpus_read_unlock(void)\n{\n\tpercpu_up_read(&cpu_hotplug_lock);\n}",
          "includes": [
            "#include \"smpboot.h\"",
            "#include <trace/events/cpuhp.h>",
            "#include <trace/events/power.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/percpu-rwsem.h>",
            "#include <linux/scs.h>",
            "#include <linux/slab.h>",
            "#include <linux/relay.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/nmi.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/suspend.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mutex.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/kthread.h>",
            "#include <linux/bug.h>",
            "#include <linux/export.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/unistd.h>",
            "#include <linux/sched/smt.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/notifier.h>",
            "#include <linux/init.h>",
            "#include <linux/smp.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/sched/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"smpboot.h\"\n#include <trace/events/cpuhp.h>\n#include <trace/events/power.h>\n#include <linux/cpuset.h>\n#include <linux/percpu-rwsem.h>\n#include <linux/scs.h>\n#include <linux/slab.h>\n#include <linux/relay.h>\n#include <linux/smpboot.h>\n#include <linux/nmi.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/lockdep.h>\n#include <linux/suspend.h>\n#include <linux/gfp.h>\n#include <linux/mutex.h>\n#include <linux/stop_machine.h>\n#include <linux/kthread.h>\n#include <linux/bug.h>\n#include <linux/export.h>\n#include <linux/rcupdate.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/unistd.h>\n#include <linux/sched/smt.h>\n#include <linux/sched/task.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/signal.h>\n#include <linux/notifier.h>\n#include <linux/init.h>\n#include <linux/smp.h>\n#include <linux/proc_fs.h>\n#include <linux/sched/mm.h>\n\nvoid cpus_read_unlock(void)\n{\n\tpercpu_up_read(&cpu_hotplug_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "swait_event_exclusive",
          "args": [
            "s2idle_wait_head",
            "s2idle_state == S2IDLE_STATE_WAKE"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wake_up_all_idle_cpus",
          "args": [],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "wake_up_all_idle_cpus",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/smp.c",
          "lines": "1169-1179",
          "snippet": "void wake_up_all_idle_cpus(void)\n{\n\tint cpu;\n\n\tfor_each_possible_cpu(cpu) {\n\t\tpreempt_disable();\n\t\tif (cpu != smp_processor_id() && cpu_online(cpu))\n\t\t\twake_up_if_idle(cpu);\n\t\tpreempt_enable();\n\t}\n}",
          "includes": [
            "#include \"sched/smp.h\"",
            "#include \"smpboot.h\"",
            "#include <linux/jump_label.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/nmi.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/hypervisor.h>",
            "#include <linux/sched/idle.h>",
            "#include <linux/sched.h>",
            "#include <linux/cpu.h>",
            "#include <linux/smp.h>",
            "#include <linux/gfp.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/init.h>",
            "#include <linux/percpu.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/rculist.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/irq_work.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sched/smp.h\"\n#include \"smpboot.h\"\n#include <linux/jump_label.h>\n#include <linux/sched/debug.h>\n#include <linux/nmi.h>\n#include <linux/sched/clock.h>\n#include <linux/hypervisor.h>\n#include <linux/sched/idle.h>\n#include <linux/sched.h>\n#include <linux/cpu.h>\n#include <linux/smp.h>\n#include <linux/gfp.h>\n#include <linux/interrupt.h>\n#include <linux/init.h>\n#include <linux/percpu.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rculist.h>\n#include <linux/rcupdate.h>\n#include <linux/irq_work.h>\n\nvoid wake_up_all_idle_cpus(void)\n{\n\tint cpu;\n\n\tfor_each_possible_cpu(cpu) {\n\t\tpreempt_disable();\n\t\tif (cpu != smp_processor_id() && cpu_online(cpu))\n\t\t\twake_up_if_idle(cpu);\n\t\tpreempt_enable();\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpus_read_lock",
          "args": [],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "cpus_read_lock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu.c",
          "lines": "307-310",
          "snippet": "void cpus_read_lock(void)\n{\n\tpercpu_down_read(&cpu_hotplug_lock);\n}",
          "includes": [
            "#include \"smpboot.h\"",
            "#include <trace/events/cpuhp.h>",
            "#include <trace/events/power.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/percpu-rwsem.h>",
            "#include <linux/scs.h>",
            "#include <linux/slab.h>",
            "#include <linux/relay.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/nmi.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/suspend.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mutex.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/kthread.h>",
            "#include <linux/bug.h>",
            "#include <linux/export.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/unistd.h>",
            "#include <linux/sched/smt.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/notifier.h>",
            "#include <linux/init.h>",
            "#include <linux/smp.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/sched/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"smpboot.h\"\n#include <trace/events/cpuhp.h>\n#include <trace/events/power.h>\n#include <linux/cpuset.h>\n#include <linux/percpu-rwsem.h>\n#include <linux/scs.h>\n#include <linux/slab.h>\n#include <linux/relay.h>\n#include <linux/smpboot.h>\n#include <linux/nmi.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/lockdep.h>\n#include <linux/suspend.h>\n#include <linux/gfp.h>\n#include <linux/mutex.h>\n#include <linux/stop_machine.h>\n#include <linux/kthread.h>\n#include <linux/bug.h>\n#include <linux/export.h>\n#include <linux/rcupdate.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/unistd.h>\n#include <linux/sched/smt.h>\n#include <linux/sched/task.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/signal.h>\n#include <linux/notifier.h>\n#include <linux/init.h>\n#include <linux/smp.h>\n#include <linux/proc_fs.h>\n#include <linux/sched/mm.h>\n\nvoid cpus_read_lock(void)\n{\n\tpercpu_down_read(&cpu_hotplug_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pm_wakeup_pending",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_suspend_resume",
          "args": [
            "TPS(\"machine_suspend\")",
            "PM_SUSPEND_TO_IDLE",
            "true"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TPS",
          "args": [
            "\"machine_suspend\""
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic DECLARE_SWAIT_QUEUE_HEAD(s2idle_wait_head);\nstatic DEFINE_RAW_SPINLOCK(s2idle_lock);\n\nstatic void s2idle_enter(void)\n{\n\ttrace_suspend_resume(TPS(\"machine_suspend\"), PM_SUSPEND_TO_IDLE, true);\n\n\traw_spin_lock_irq(&s2idle_lock);\n\tif (pm_wakeup_pending())\n\t\tgoto out;\n\n\ts2idle_state = S2IDLE_STATE_ENTER;\n\traw_spin_unlock_irq(&s2idle_lock);\n\n\tcpus_read_lock();\n\n\t/* Push all the CPUs into the idle loop. */\n\twake_up_all_idle_cpus();\n\t/* Make the current CPU wait so it can enter the idle loop too. */\n\tswait_event_exclusive(s2idle_wait_head,\n\t\t    s2idle_state == S2IDLE_STATE_WAKE);\n\n\tcpus_read_unlock();\n\n\traw_spin_lock_irq(&s2idle_lock);\n\n out:\n\ts2idle_state = S2IDLE_STATE_NONE;\n\traw_spin_unlock_irq(&s2idle_lock);\n\n\ttrace_suspend_resume(TPS(\"machine_suspend\"), PM_SUSPEND_TO_IDLE, false);\n}"
  },
  {
    "function_name": "s2idle_begin",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "83-86",
    "snippet": "static void s2idle_begin(void)\n{\n\ts2idle_state = S2IDLE_STATE_NONE;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic void s2idle_begin(void)\n{\n\ts2idle_state = S2IDLE_STATE_NONE;\n}"
  },
  {
    "function_name": "s2idle_set_ops",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "76-81",
    "snippet": "void s2idle_set_ops(const struct platform_s2idle_ops *ops)\n{\n\tlock_system_sleep();\n\ts2idle_ops = ops;\n\tunlock_system_sleep();\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct platform_s2idle_ops *s2idle_ops;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlock_system_sleep",
          "args": [],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_system_sleep",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/main.c",
          "lines": "31-51",
          "snippet": "void unlock_system_sleep(void)\n{\n\t/*\n\t * Don't use freezer_count() because we don't want the call to\n\t * try_to_freeze() here.\n\t *\n\t * Reason:\n\t * Fundamentally, we just don't need it, because freezing condition\n\t * doesn't come into effect until we release the\n\t * system_transition_mutex lock, since the freezer always works with\n\t * system_transition_mutex held.\n\t *\n\t * More importantly, in the case of hibernation,\n\t * unlock_system_sleep() gets called in snapshot_read() and\n\t * snapshot_write() when the freezing condition is still in effect.\n\t * Which means, if we use try_to_freeze() here, it would make them\n\t * enter the refrigerator, thus causing hibernation to lockup.\n\t */\n\tcurrent->flags &= ~PF_FREEZER_SKIP;\n\tmutex_unlock(&system_transition_mutex);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <linux/pm_runtime.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/suspend.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/pm-trace.h>",
            "#include <linux/string.h>",
            "#include <linux/kobject.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <linux/pm_runtime.h>\n#include <linux/syscalls.h>\n#include <linux/suspend.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/workqueue.h>\n#include <linux/pm-trace.h>\n#include <linux/string.h>\n#include <linux/kobject.h>\n#include <linux/export.h>\n\nvoid unlock_system_sleep(void)\n{\n\t/*\n\t * Don't use freezer_count() because we don't want the call to\n\t * try_to_freeze() here.\n\t *\n\t * Reason:\n\t * Fundamentally, we just don't need it, because freezing condition\n\t * doesn't come into effect until we release the\n\t * system_transition_mutex lock, since the freezer always works with\n\t * system_transition_mutex held.\n\t *\n\t * More importantly, in the case of hibernation,\n\t * unlock_system_sleep() gets called in snapshot_read() and\n\t * snapshot_write() when the freezing condition is still in effect.\n\t * Which means, if we use try_to_freeze() here, it would make them\n\t * enter the refrigerator, thus causing hibernation to lockup.\n\t */\n\tcurrent->flags &= ~PF_FREEZER_SKIP;\n\tmutex_unlock(&system_transition_mutex);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nstatic const struct platform_s2idle_ops *s2idle_ops;\n\nvoid s2idle_set_ops(const struct platform_s2idle_ops *ops)\n{\n\tlock_system_sleep();\n\ts2idle_ops = ops;\n\tunlock_system_sleep();\n}"
  },
  {
    "function_name": "pm_suspend_default_s2idle",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/suspend.c",
    "lines": "70-73",
    "snippet": "bool pm_suspend_default_s2idle(void)\n{\n\treturn mem_sleep_current == PM_SUSPEND_TO_IDLE;\n}",
    "includes": [
      "#include \"power.h\"",
      "#include <linux/moduleparam.h>",
      "#include <linux/compiler.h>",
      "#include <trace/events/power.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/swait.h>",
      "#include <linux/syscore_ops.h>",
      "#include <linux/suspend.h>",
      "#include <linux/export.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>",
      "#include <linux/io.h>",
      "#include <linux/gfp.h>",
      "#include <linux/cpuidle.h>",
      "#include <linux/cpu.h>",
      "#include <linux/console.h>",
      "#include <linux/init.h>",
      "#include <linux/errno.h>",
      "#include <linux/delay.h>",
      "#include <linux/string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "suspend_state_t mem_sleep_current = PM_SUSPEND_TO_IDLE;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"power.h\"\n#include <linux/moduleparam.h>\n#include <linux/compiler.h>\n#include <trace/events/power.h>\n#include <linux/ftrace.h>\n#include <linux/swait.h>\n#include <linux/syscore_ops.h>\n#include <linux/suspend.h>\n#include <linux/export.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/io.h>\n#include <linux/gfp.h>\n#include <linux/cpuidle.h>\n#include <linux/cpu.h>\n#include <linux/console.h>\n#include <linux/init.h>\n#include <linux/errno.h>\n#include <linux/delay.h>\n#include <linux/string.h>\n\nsuspend_state_t mem_sleep_current = PM_SUSPEND_TO_IDLE;\n\nbool pm_suspend_default_s2idle(void)\n{\n\treturn mem_sleep_current == PM_SUSPEND_TO_IDLE;\n}"
  }
]