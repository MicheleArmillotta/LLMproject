[
  {
    "function_name": "lxc_unfreeze",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/freezer.c",
    "lines": "84-87",
    "snippet": "int lxc_unfreeze(const char *name, const char *lxcpath)\n{\n\treturn do_freeze_thaw(0, name, lxcpath);\n}",
    "includes": [
      "#include \"lxc.h\"",
      "#include \"log.h\"",
      "#include \"monitor.h\"",
      "#include \"state.h\"",
      "#include \"error.h\"",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_freeze_thaw",
          "args": [
            "0",
            "name",
            "lxcpath"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "do_freeze_thaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/freezer.c",
          "lines": "53-76",
          "snippet": "static int do_freeze_thaw(int freeze, const char *name, const char *lxcpath)\n{\n\tchar v[100];\n\tconst char *state = freeze ? \"FROZEN\" : \"THAWED\";\n\n\tif (lxc_cgroup_set(\"freezer.state\", state, name, lxcpath) < 0) {\n\t\tERROR(\"Failed to freeze %s:%s\", lxcpath, name);\n\t\treturn -1;\n\t}\n\twhile (1) {\n\t\tif (lxc_cgroup_get(\"freezer.state\", v, 100, name, lxcpath) < 0) {\n\t\t\tERROR(\"Failed to get new freezer state for %s:%s\", lxcpath, name);\n\t\t\treturn -1;\n\t\t}\n\t\tif (v[strlen(v)-1] == '\\n')\n\t\t\tv[strlen(v)-1] = '\\0';\n\t\tif (strncmp(v, state, strlen(state)) == 0) {\n\t\t\tif (name)\n\t\t\t\tlxc_monitor_send_state(name, freeze ? FROZEN : THAWED, lxcpath);\n\t\t\treturn 0;\n\t\t}\n\t\tsleep(1);\n\t}\n}",
          "includes": [
            "#include \"lxc.h\"",
            "#include \"log.h\"",
            "#include \"monitor.h\"",
            "#include \"state.h\"",
            "#include \"error.h\"",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxc.h\"\n#include \"log.h\"\n#include \"monitor.h\"\n#include \"state.h\"\n#include \"error.h\"\n#include <sys/param.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <string.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic int do_freeze_thaw(int freeze, const char *name, const char *lxcpath)\n{\n\tchar v[100];\n\tconst char *state = freeze ? \"FROZEN\" : \"THAWED\";\n\n\tif (lxc_cgroup_set(\"freezer.state\", state, name, lxcpath) < 0) {\n\t\tERROR(\"Failed to freeze %s:%s\", lxcpath, name);\n\t\treturn -1;\n\t}\n\twhile (1) {\n\t\tif (lxc_cgroup_get(\"freezer.state\", v, 100, name, lxcpath) < 0) {\n\t\t\tERROR(\"Failed to get new freezer state for %s:%s\", lxcpath, name);\n\t\t\treturn -1;\n\t\t}\n\t\tif (v[strlen(v)-1] == '\\n')\n\t\t\tv[strlen(v)-1] = '\\0';\n\t\tif (strncmp(v, state, strlen(state)) == 0) {\n\t\t\tif (name)\n\t\t\t\tlxc_monitor_send_state(name, freeze ? FROZEN : THAWED, lxcpath);\n\t\t\treturn 0;\n\t\t}\n\t\tsleep(1);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lxc.h\"\n#include \"log.h\"\n#include \"monitor.h\"\n#include \"state.h\"\n#include \"error.h\"\n#include <sys/param.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <string.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint lxc_unfreeze(const char *name, const char *lxcpath)\n{\n\treturn do_freeze_thaw(0, name, lxcpath);\n}"
  },
  {
    "function_name": "lxc_freeze",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/freezer.c",
    "lines": "78-82",
    "snippet": "int lxc_freeze(const char *name, const char *lxcpath)\n{\n\tlxc_monitor_send_state(name, FREEZING, lxcpath);\n\treturn do_freeze_thaw(1, name, lxcpath);\n}",
    "includes": [
      "#include \"lxc.h\"",
      "#include \"log.h\"",
      "#include \"monitor.h\"",
      "#include \"state.h\"",
      "#include \"error.h\"",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_freeze_thaw",
          "args": [
            "1",
            "name",
            "lxcpath"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "do_freeze_thaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/freezer.c",
          "lines": "53-76",
          "snippet": "static int do_freeze_thaw(int freeze, const char *name, const char *lxcpath)\n{\n\tchar v[100];\n\tconst char *state = freeze ? \"FROZEN\" : \"THAWED\";\n\n\tif (lxc_cgroup_set(\"freezer.state\", state, name, lxcpath) < 0) {\n\t\tERROR(\"Failed to freeze %s:%s\", lxcpath, name);\n\t\treturn -1;\n\t}\n\twhile (1) {\n\t\tif (lxc_cgroup_get(\"freezer.state\", v, 100, name, lxcpath) < 0) {\n\t\t\tERROR(\"Failed to get new freezer state for %s:%s\", lxcpath, name);\n\t\t\treturn -1;\n\t\t}\n\t\tif (v[strlen(v)-1] == '\\n')\n\t\t\tv[strlen(v)-1] = '\\0';\n\t\tif (strncmp(v, state, strlen(state)) == 0) {\n\t\t\tif (name)\n\t\t\t\tlxc_monitor_send_state(name, freeze ? FROZEN : THAWED, lxcpath);\n\t\t\treturn 0;\n\t\t}\n\t\tsleep(1);\n\t}\n}",
          "includes": [
            "#include \"lxc.h\"",
            "#include \"log.h\"",
            "#include \"monitor.h\"",
            "#include \"state.h\"",
            "#include \"error.h\"",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxc.h\"\n#include \"log.h\"\n#include \"monitor.h\"\n#include \"state.h\"\n#include \"error.h\"\n#include <sys/param.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <string.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic int do_freeze_thaw(int freeze, const char *name, const char *lxcpath)\n{\n\tchar v[100];\n\tconst char *state = freeze ? \"FROZEN\" : \"THAWED\";\n\n\tif (lxc_cgroup_set(\"freezer.state\", state, name, lxcpath) < 0) {\n\t\tERROR(\"Failed to freeze %s:%s\", lxcpath, name);\n\t\treturn -1;\n\t}\n\twhile (1) {\n\t\tif (lxc_cgroup_get(\"freezer.state\", v, 100, name, lxcpath) < 0) {\n\t\t\tERROR(\"Failed to get new freezer state for %s:%s\", lxcpath, name);\n\t\t\treturn -1;\n\t\t}\n\t\tif (v[strlen(v)-1] == '\\n')\n\t\t\tv[strlen(v)-1] = '\\0';\n\t\tif (strncmp(v, state, strlen(state)) == 0) {\n\t\t\tif (name)\n\t\t\t\tlxc_monitor_send_state(name, freeze ? FROZEN : THAWED, lxcpath);\n\t\t\treturn 0;\n\t\t}\n\t\tsleep(1);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_monitor_send_state",
          "args": [
            "name",
            "FREEZING",
            "lxcpath"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_monitor_send_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/monitor.c",
          "lines": "130-138",
          "snippet": "void lxc_monitor_send_state(const char *name, lxc_state_t state,\n\t\t\t    const char *lxcpath)\n{\n\tstruct lxc_msg msg = {.type = lxc_msg_state, .value = state};\n\tstrncpy(msg.name, name, sizeof(msg.name));\n\tmsg.name[sizeof(msg.name) - 1] = 0;\n\n\tlxc_monitor_fifo_send(&msg, lxcpath);\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include \"state.h\"",
            "#include \"monitor.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"af_unix.h\"",
            "#include \"config.h\"",
            "#include <sys/wait.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/param.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stddef.h>",
            "#include <poll.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include \"state.h\"\n#include \"monitor.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"af_unix.h\"\n#include \"config.h\"\n#include <sys/wait.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/param.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stddef.h>\n#include <poll.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <errno.h>\n\nvoid lxc_monitor_send_state(const char *name, lxc_state_t state,\n\t\t\t    const char *lxcpath)\n{\n\tstruct lxc_msg msg = {.type = lxc_msg_state, .value = state};\n\tstrncpy(msg.name, name, sizeof(msg.name));\n\tmsg.name[sizeof(msg.name) - 1] = 0;\n\n\tlxc_monitor_fifo_send(&msg, lxcpath);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lxc.h\"\n#include \"log.h\"\n#include \"monitor.h\"\n#include \"state.h\"\n#include \"error.h\"\n#include <sys/param.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <string.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint lxc_freeze(const char *name, const char *lxcpath)\n{\n\tlxc_monitor_send_state(name, FREEZING, lxcpath);\n\treturn do_freeze_thaw(1, name, lxcpath);\n}"
  },
  {
    "function_name": "do_freeze_thaw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/freezer.c",
    "lines": "53-76",
    "snippet": "static int do_freeze_thaw(int freeze, const char *name, const char *lxcpath)\n{\n\tchar v[100];\n\tconst char *state = freeze ? \"FROZEN\" : \"THAWED\";\n\n\tif (lxc_cgroup_set(\"freezer.state\", state, name, lxcpath) < 0) {\n\t\tERROR(\"Failed to freeze %s:%s\", lxcpath, name);\n\t\treturn -1;\n\t}\n\twhile (1) {\n\t\tif (lxc_cgroup_get(\"freezer.state\", v, 100, name, lxcpath) < 0) {\n\t\t\tERROR(\"Failed to get new freezer state for %s:%s\", lxcpath, name);\n\t\t\treturn -1;\n\t\t}\n\t\tif (v[strlen(v)-1] == '\\n')\n\t\t\tv[strlen(v)-1] = '\\0';\n\t\tif (strncmp(v, state, strlen(state)) == 0) {\n\t\t\tif (name)\n\t\t\t\tlxc_monitor_send_state(name, freeze ? FROZEN : THAWED, lxcpath);\n\t\t\treturn 0;\n\t\t}\n\t\tsleep(1);\n\t}\n}",
    "includes": [
      "#include \"lxc.h\"",
      "#include \"log.h\"",
      "#include \"monitor.h\"",
      "#include \"state.h\"",
      "#include \"error.h\"",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sleep",
          "args": [
            "1"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_util_usleep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
          "lines": "564-567",
          "snippet": "static int lxc_util_usleep(lua_State *L) {\n    usleep((useconds_t)luaL_checkunsigned(L, 1));\n    return 0;\n}",
          "includes": [
            "#include \"lxc/commands.h\"",
            "#include <lxc/lxccontainer.h>",
            "#include <libgen.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <assert.h>",
            "#include <lauxlib.h>",
            "#include <lua.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\nstatic int lxc_util_usleep(lua_State *L) {\n    usleep((useconds_t)luaL_checkunsigned(L, 1));\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_monitor_send_state",
          "args": [
            "name",
            "freeze ? FROZEN : THAWED",
            "lxcpath"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_monitor_send_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/monitor.c",
          "lines": "130-138",
          "snippet": "void lxc_monitor_send_state(const char *name, lxc_state_t state,\n\t\t\t    const char *lxcpath)\n{\n\tstruct lxc_msg msg = {.type = lxc_msg_state, .value = state};\n\tstrncpy(msg.name, name, sizeof(msg.name));\n\tmsg.name[sizeof(msg.name) - 1] = 0;\n\n\tlxc_monitor_fifo_send(&msg, lxcpath);\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include \"state.h\"",
            "#include \"monitor.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"af_unix.h\"",
            "#include \"config.h\"",
            "#include <sys/wait.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/param.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stddef.h>",
            "#include <poll.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include \"state.h\"\n#include \"monitor.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"af_unix.h\"\n#include \"config.h\"\n#include <sys/wait.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/param.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stddef.h>\n#include <poll.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <errno.h>\n\nvoid lxc_monitor_send_state(const char *name, lxc_state_t state,\n\t\t\t    const char *lxcpath)\n{\n\tstruct lxc_msg msg = {.type = lxc_msg_state, .value = state};\n\tstrncpy(msg.name, name, sizeof(msg.name));\n\tmsg.name[sizeof(msg.name) - 1] = 0;\n\n\tlxc_monitor_fifo_send(&msg, lxcpath);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "v",
            "state",
            "strlen(state)"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "state"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "v"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "v"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Failed to get new freezer state for %s:%s\"",
            "lxcpath",
            "name"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_cgroup_get",
          "args": [
            "\"freezer.state\"",
            "v",
            "100",
            "name",
            "lxcpath"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_cgroup_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/cgroups/cgroup.c",
          "lines": "193-198",
          "snippet": "int lxc_cgroup_get(const char *filename, char *value, size_t len, const char *name, const char *lxcpath)\n{\n\tif (ops)\n\t\treturn ops->get(filename, value, len, name, lxcpath);\n\treturn -1;\n}",
          "includes": [
            "#include \"start.h\"",
            "#include \"log.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include <sys/types.h>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct cgroup_ops *ops = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"start.h\"\n#include \"log.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include <sys/types.h>\n#include <unistd.h>\n\nstatic struct cgroup_ops *ops = NULL;\n\nint lxc_cgroup_get(const char *filename, char *value, size_t len, const char *name, const char *lxcpath)\n{\n\tif (ops)\n\t\treturn ops->get(filename, value, len, name, lxcpath);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Failed to freeze %s:%s\"",
            "lxcpath",
            "name"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_cgroup_set",
          "args": [
            "\"freezer.state\"",
            "state",
            "name",
            "lxcpath"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_cgroup_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/cgroups/cgroup.c",
          "lines": "186-191",
          "snippet": "int lxc_cgroup_set(const char *filename, const char *value, const char *name, const char *lxcpath)\n{\n\tif (ops)\n\t\treturn ops->set(filename, value, name, lxcpath);\n\treturn -1;\n}",
          "includes": [
            "#include \"start.h\"",
            "#include \"log.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include <sys/types.h>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct cgroup_ops *ops = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"start.h\"\n#include \"log.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include <sys/types.h>\n#include <unistd.h>\n\nstatic struct cgroup_ops *ops = NULL;\n\nint lxc_cgroup_set(const char *filename, const char *value, const char *name, const char *lxcpath)\n{\n\tif (ops)\n\t\treturn ops->set(filename, value, name, lxcpath);\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lxc.h\"\n#include \"log.h\"\n#include \"monitor.h\"\n#include \"state.h\"\n#include \"error.h\"\n#include <sys/param.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <string.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic int do_freeze_thaw(int freeze, const char *name, const char *lxcpath)\n{\n\tchar v[100];\n\tconst char *state = freeze ? \"FROZEN\" : \"THAWED\";\n\n\tif (lxc_cgroup_set(\"freezer.state\", state, name, lxcpath) < 0) {\n\t\tERROR(\"Failed to freeze %s:%s\", lxcpath, name);\n\t\treturn -1;\n\t}\n\twhile (1) {\n\t\tif (lxc_cgroup_get(\"freezer.state\", v, 100, name, lxcpath) < 0) {\n\t\t\tERROR(\"Failed to get new freezer state for %s:%s\", lxcpath, name);\n\t\t\treturn -1;\n\t\t}\n\t\tif (v[strlen(v)-1] == '\\n')\n\t\t\tv[strlen(v)-1] = '\\0';\n\t\tif (strncmp(v, state, strlen(state)) == 0) {\n\t\t\tif (name)\n\t\t\t\tlxc_monitor_send_state(name, freeze ? FROZEN : THAWED, lxcpath);\n\t\t\treturn 0;\n\t\t}\n\t\tsleep(1);\n\t}\n}"
  },
  {
    "function_name": "freezer_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/freezer.c",
    "lines": "42-51",
    "snippet": "lxc_state_t freezer_state(const char *name, const char *lxcpath)\n{\n\tchar v[100];\n\tif (lxc_cgroup_get(\"freezer.state\", v, 100, name, lxcpath) < 0)\n\t\treturn -1;\n\n\tif (v[strlen(v)-1] == '\\n')\n\t\tv[strlen(v)-1] = '\\0';\n\treturn lxc_str2state(v);\n}",
    "includes": [
      "#include \"lxc.h\"",
      "#include \"log.h\"",
      "#include \"monitor.h\"",
      "#include \"state.h\"",
      "#include \"error.h\"",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <errno.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_str2state",
          "args": [
            "v"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_str2state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/state.c",
          "lines": "59-70",
          "snippet": "lxc_state_t lxc_str2state(const char *state)\n{\n\tsize_t len;\n\tlxc_state_t i;\n\tlen = sizeof(strstate)/sizeof(strstate[0]);\n\tfor (i = 0; i < len; i++)\n\t\tif (!strcmp(strstate[i], state))\n\t\t\treturn i;\n\n\tERROR(\"invalid state '%s'\", state);\n\treturn -1;\n}",
          "includes": [
            "#include \"start.h\"",
            "#include \"monitor.h\"",
            "#include \"lxc.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include \"commands.h\"",
            "#include \"cgroup.h\"",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/param.h>",
            "#include <sys/file.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const char * const strstate[] = {\n\t\"STOPPED\", \"STARTING\", \"RUNNING\", \"STOPPING\",\n\t\"ABORTING\", \"FREEZING\", \"FROZEN\", \"THAWED\",\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"start.h\"\n#include \"monitor.h\"\n#include \"lxc.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include \"commands.h\"\n#include \"cgroup.h\"\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/param.h>\n#include <sys/file.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n\nstatic const char * const strstate[] = {\n\t\"STOPPED\", \"STARTING\", \"RUNNING\", \"STOPPING\",\n\t\"ABORTING\", \"FREEZING\", \"FROZEN\", \"THAWED\",\n};\n\nlxc_state_t lxc_str2state(const char *state)\n{\n\tsize_t len;\n\tlxc_state_t i;\n\tlen = sizeof(strstate)/sizeof(strstate[0]);\n\tfor (i = 0; i < len; i++)\n\t\tif (!strcmp(strstate[i], state))\n\t\t\treturn i;\n\n\tERROR(\"invalid state '%s'\", state);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "v"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "v"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_cgroup_get",
          "args": [
            "\"freezer.state\"",
            "v",
            "100",
            "name",
            "lxcpath"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_cgroup_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/cgroups/cgroup.c",
          "lines": "193-198",
          "snippet": "int lxc_cgroup_get(const char *filename, char *value, size_t len, const char *name, const char *lxcpath)\n{\n\tif (ops)\n\t\treturn ops->get(filename, value, len, name, lxcpath);\n\treturn -1;\n}",
          "includes": [
            "#include \"start.h\"",
            "#include \"log.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include <sys/types.h>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct cgroup_ops *ops = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"start.h\"\n#include \"log.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include <sys/types.h>\n#include <unistd.h>\n\nstatic struct cgroup_ops *ops = NULL;\n\nint lxc_cgroup_get(const char *filename, char *value, size_t len, const char *name, const char *lxcpath)\n{\n\tif (ops)\n\t\treturn ops->get(filename, value, len, name, lxcpath);\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lxc.h\"\n#include \"log.h\"\n#include \"monitor.h\"\n#include \"state.h\"\n#include \"error.h\"\n#include <sys/param.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <string.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nlxc_state_t freezer_state(const char *name, const char *lxcpath)\n{\n\tchar v[100];\n\tif (lxc_cgroup_get(\"freezer.state\", v, 100, name, lxcpath) < 0)\n\t\treturn -1;\n\n\tif (v[strlen(v)-1] == '\\n')\n\t\tv[strlen(v)-1] = '\\0';\n\treturn lxc_str2state(v);\n}"
  }
]