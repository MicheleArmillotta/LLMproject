[
  {
    "function_name": "config_no_new_privs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "3084-3100",
    "snippet": "static int config_no_new_privs(const char *key, const char *value,\n\t\t\t\t    struct lxc_conf *lxc_conf)\n{\n\tunsigned int v;\n\n\tif (lxc_safe_uint(value, &v) < 0)\n\t\treturn -1;\n\n\tif (v > 1) {\n\t\tERROR(\"Wrong value for lxc.no_new_privs. Can only be set to 0 or 1\");\n\t\treturn -1;\n\t}\n\n\tlxc_conf->no_new_privs = v ? true : false;\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Wrong value for lxc.no_new_privs. Can only be set to 0 or 1\""
          ],
          "line": 3093
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_safe_uint",
          "args": [
            "value",
            "&v"
          ],
          "line": 3089
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_safe_uint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "1985-2003",
          "snippet": "int lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_no_new_privs(const char *key, const char *value,\n\t\t\t\t    struct lxc_conf *lxc_conf)\n{\n\tunsigned int v;\n\n\tif (lxc_safe_uint(value, &v) < 0)\n\t\treturn -1;\n\n\tif (v > 1) {\n\t\tERROR(\"Wrong value for lxc.no_new_privs. Can only be set to 0 or 1\");\n\t\treturn -1;\n\t}\n\n\tlxc_conf->no_new_privs = v ? true : false;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "config_syslog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "3070-3082",
    "snippet": "static int config_syslog(const char *key, const char *value,\n\t\t\t struct lxc_conf *lxc_conf)\n{\n\tint facility;\n\tfacility = lxc_syslog_priority_to_int(value);\n\tif (facility == -EINVAL) {\n\t\tERROR(\"Wrong value for lxc.syslog.\");\n\t\treturn -1;\n\t}\n\n\tlxc_log_syslog(facility);\n\treturn config_string_item(&lxc_conf->syslog, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_string_item",
          "args": [
            "&lxc_conf->syslog",
            "value"
          ],
          "line": 3081
        },
        "resolved": true,
        "details": {
          "function_name": "config_string_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "327-346",
          "snippet": "static int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_log_syslog",
          "args": [
            "facility"
          ],
          "line": 3080
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_log_syslog",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/log.c",
          "lines": "519-534",
          "snippet": "extern int lxc_log_syslog(int facility)\n{\n\tstruct lxc_log_appender *appender;\n\n\topenlog(log_prefix, LOG_PID, facility);\n\tif (!lxc_log_category_lxc.appender) {\n\t\tlxc_log_category_lxc.appender = &log_appender_syslog;\n\t\treturn 0;\n\t}\n\tappender = lxc_log_category_lxc.appender;\n\twhile (appender->next != NULL)\n\t\tappender = appender->next;\n\tappender->next = &log_appender_syslog;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include \"caps.h\"",
            "#include \"log.h\"",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <stdio.h>",
            "#include <syslog.h>",
            "#include <time.h>",
            "#include <pthread.h>",
            "#include <string.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <limits.h>",
            "#include <inttypes.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char log_prefix[LXC_LOG_PREFIX_SIZE] = \"lxc\";",
            "static struct lxc_log_appender log_appender_syslog = {\n\t.name\t\t= \"syslog\",\n\t.append\t\t= log_append_syslog,\n\t.next\t\t= NULL,\n};",
            "struct lxc_log_category lxc_log_category_lxc = {\n\t.name\t\t= \"lxc\",\n\t.priority\t= LXC_LOG_PRIORITY_ERROR,\n\t.appender\t= &log_appender_logfile,\n\t.parent\t\t= &log_root\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include \"caps.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <fcntl.h>\n#include <stdio.h>\n#include <syslog.h>\n#include <time.h>\n#include <pthread.h>\n#include <string.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <limits.h>\n#include <inttypes.h>\n#include <errno.h>\n#include <stdio.h>\n#include <stdint.h>\n\nstatic char log_prefix[LXC_LOG_PREFIX_SIZE] = \"lxc\";\nstatic struct lxc_log_appender log_appender_syslog = {\n\t.name\t\t= \"syslog\",\n\t.append\t\t= log_append_syslog,\n\t.next\t\t= NULL,\n};\nstruct lxc_log_category lxc_log_category_lxc = {\n\t.name\t\t= \"lxc\",\n\t.priority\t= LXC_LOG_PRIORITY_ERROR,\n\t.appender\t= &log_appender_logfile,\n\t.parent\t\t= &log_root\n};\n\nextern int lxc_log_syslog(int facility)\n{\n\tstruct lxc_log_appender *appender;\n\n\topenlog(log_prefix, LOG_PID, facility);\n\tif (!lxc_log_category_lxc.appender) {\n\t\tlxc_log_category_lxc.appender = &log_appender_syslog;\n\t\treturn 0;\n\t}\n\tappender = lxc_log_category_lxc.appender;\n\twhile (appender->next != NULL)\n\t\tappender = appender->next;\n\tappender->next = &log_appender_syslog;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Wrong value for lxc.syslog.\""
          ],
          "line": 3076
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_syslog_priority_to_int",
          "args": [
            "value"
          ],
          "line": 3074
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_syslog_priority_to_int",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/log.h",
          "lines": "193-206",
          "snippet": "static inline int lxc_syslog_priority_to_int(const char* name)\n{\n\tif (!strcasecmp(\"daemon\", name)) return LOG_DAEMON;\n\tif (!strcasecmp(\"local0\", name)) return LOG_LOCAL0;\n\tif (!strcasecmp(\"local1\", name)) return LOG_LOCAL1;\n\tif (!strcasecmp(\"local2\", name)) return LOG_LOCAL2;\n\tif (!strcasecmp(\"local3\", name)) return LOG_LOCAL3;\n\tif (!strcasecmp(\"local4\", name)) return LOG_LOCAL4;\n\tif (!strcasecmp(\"local5\", name)) return LOG_LOCAL5;\n\tif (!strcasecmp(\"local6\", name)) return LOG_LOCAL6;\n\tif (!strcasecmp(\"local7\", name)) return LOG_LOCAL7;\n\n\treturn -EINVAL;\n}",
          "includes": [
            "#include \"conf.h\"",
            "#include <time.h>",
            "#include <syslog.h>",
            "#include <stdbool.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <sys/time.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"conf.h\"\n#include <time.h>\n#include <syslog.h>\n#include <stdbool.h>\n#include <strings.h>\n#include <string.h>\n#include <sys/time.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"config.h\"\n\nstatic inline int lxc_syslog_priority_to_int(const char* name)\n{\n\tif (!strcasecmp(\"daemon\", name)) return LOG_DAEMON;\n\tif (!strcasecmp(\"local0\", name)) return LOG_LOCAL0;\n\tif (!strcasecmp(\"local1\", name)) return LOG_LOCAL1;\n\tif (!strcasecmp(\"local2\", name)) return LOG_LOCAL2;\n\tif (!strcasecmp(\"local3\", name)) return LOG_LOCAL3;\n\tif (!strcasecmp(\"local4\", name)) return LOG_LOCAL4;\n\tif (!strcasecmp(\"local5\", name)) return LOG_LOCAL5;\n\tif (!strcasecmp(\"local6\", name)) return LOG_LOCAL6;\n\tif (!strcasecmp(\"local7\", name)) return LOG_LOCAL7;\n\n\treturn -EINVAL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_syslog(const char *key, const char *value,\n\t\t\t struct lxc_conf *lxc_conf)\n{\n\tint facility;\n\tfacility = lxc_syslog_priority_to_int(value);\n\tif (facility == -EINVAL) {\n\t\tERROR(\"Wrong value for lxc.syslog.\");\n\t\treturn -1;\n\t}\n\n\tlxc_log_syslog(facility);\n\treturn config_string_item(&lxc_conf->syslog, value);\n}"
  },
  {
    "function_name": "config_ephemeral",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "3056-3068",
    "snippet": "static int config_ephemeral(const char *key, const char *value,\n\t\t\t    struct lxc_conf *lxc_conf)\n{\n\tif (lxc_safe_uint(value, &lxc_conf->ephemeral) < 0)\n\t\treturn -1;\n\n\tif (lxc_conf->ephemeral > 1) {\n\t\tERROR(\"Wrong value for lxc.ephemeral. Can only be set to 0 or 1\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Wrong value for lxc.ephemeral. Can only be set to 0 or 1\""
          ],
          "line": 3063
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_safe_uint",
          "args": [
            "value",
            "&lxc_conf->ephemeral"
          ],
          "line": 3059
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_safe_uint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "1985-2003",
          "snippet": "int lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_ephemeral(const char *key, const char *value,\n\t\t\t    struct lxc_conf *lxc_conf)\n{\n\tif (lxc_safe_uint(value, &lxc_conf->ephemeral) < 0)\n\t\treturn -1;\n\n\tif (lxc_conf->ephemeral > 1) {\n\t\tERROR(\"Wrong value for lxc.ephemeral. Can only be set to 0 or 1\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "network_new_hwaddrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2993-3054",
    "snippet": "bool network_new_hwaddrs(struct lxc_conf *conf)\n{\n\tstruct lxc_list *it;\n\n\tconst char *key = \"lxc.network.hwaddr\";\n\tchar *lstart = conf->unexpanded_config, *lend, *p, *p2;\n\n\tif (!conf->unexpanded_config)\n\t\treturn true;\n\n\twhile (*lstart) {\n\t\tchar newhwaddr[18], oldhwaddr[17];\n\n\t\tlend = strchr(lstart, '\\n');\n\t\tif (!lend)\n\t\t\tlend = lstart + strlen(lstart);\n\t\telse\n\t\t\tlend++;\n\n\t\tif (strncmp(lstart, key, strlen(key)) != 0) {\n\t\t\tlstart = lend;\n\t\t\tcontinue;\n\t\t}\n\n\t\tp = strchr(lstart+strlen(key), '=');\n\t\tif (!p) {\n\t\t\tlstart = lend;\n\t\t\tcontinue;\n\t\t}\n\n\t\tp++;\n\t\twhile (isblank(*p))\n\t\t\tp++;\n\t\tif (!*p)\n\t\t\treturn true;\n\n\t\tp2 = p;\n\t\twhile (*p2 && !isblank(*p2) && *p2 != '\\n')\n\t\t\tp2++;\n\t\tif (p2-p != 17) {\n\t\t\tWARN(\"Bad hwaddr entry\");\n\t\t\tlstart = lend;\n\t\t\tcontinue;\n\t\t}\n\n\t\tmemcpy(oldhwaddr, p, 17);\n\n\t\tif (!new_hwaddr(newhwaddr))\n\t\t\treturn false;\n\n\t\tmemcpy(p, newhwaddr, 17);\n\t\tlxc_list_for_each(it, &conf->network) {\n\t\t\tstruct lxc_netdev *n = it->elem;\n\t\t\tif (n->hwaddr && memcmp(oldhwaddr, n->hwaddr, 17) == 0)\n\t\t\t\tmemcpy(n->hwaddr, newhwaddr, 17);\n\t\t}\n\n\t\tlstart = lend;\n\t}\n\n\treturn true;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "n->hwaddr",
            "newhwaddr",
            "17"
          ],
          "line": 3047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "oldhwaddr",
            "n->hwaddr",
            "17"
          ],
          "line": 3046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_list_for_each",
          "args": [
            "it",
            "&conf->network"
          ],
          "line": 3044
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "p",
            "newhwaddr",
            "17"
          ],
          "line": 3043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new_hwaddr",
          "args": [
            "newhwaddr"
          ],
          "line": 3040
        },
        "resolved": true,
        "details": {
          "function_name": "network_new_hwaddrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2993-3054",
          "snippet": "bool network_new_hwaddrs(struct lxc_conf *conf)\n{\n\tstruct lxc_list *it;\n\n\tconst char *key = \"lxc.network.hwaddr\";\n\tchar *lstart = conf->unexpanded_config, *lend, *p, *p2;\n\n\tif (!conf->unexpanded_config)\n\t\treturn true;\n\n\twhile (*lstart) {\n\t\tchar newhwaddr[18], oldhwaddr[17];\n\n\t\tlend = strchr(lstart, '\\n');\n\t\tif (!lend)\n\t\t\tlend = lstart + strlen(lstart);\n\t\telse\n\t\t\tlend++;\n\n\t\tif (strncmp(lstart, key, strlen(key)) != 0) {\n\t\t\tlstart = lend;\n\t\t\tcontinue;\n\t\t}\n\n\t\tp = strchr(lstart+strlen(key), '=');\n\t\tif (!p) {\n\t\t\tlstart = lend;\n\t\t\tcontinue;\n\t\t}\n\n\t\tp++;\n\t\twhile (isblank(*p))\n\t\t\tp++;\n\t\tif (!*p)\n\t\t\treturn true;\n\n\t\tp2 = p;\n\t\twhile (*p2 && !isblank(*p2) && *p2 != '\\n')\n\t\t\tp2++;\n\t\tif (p2-p != 17) {\n\t\t\tWARN(\"Bad hwaddr entry\");\n\t\t\tlstart = lend;\n\t\t\tcontinue;\n\t\t}\n\n\t\tmemcpy(oldhwaddr, p, 17);\n\n\t\tif (!new_hwaddr(newhwaddr))\n\t\t\treturn false;\n\n\t\tmemcpy(p, newhwaddr, 17);\n\t\tlxc_list_for_each(it, &conf->network) {\n\t\t\tstruct lxc_netdev *n = it->elem;\n\t\t\tif (n->hwaddr && memcmp(oldhwaddr, n->hwaddr, 17) == 0)\n\t\t\t\tmemcpy(n->hwaddr, newhwaddr, 17);\n\t\t}\n\n\t\tlstart = lend;\n\t}\n\n\treturn true;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "oldhwaddr",
            "p",
            "17"
          ],
          "line": 3038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "\"Bad hwaddr entry\""
          ],
          "line": 3033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isblank",
          "args": [
            "*p2"
          ],
          "line": 3030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isblank",
          "args": [
            "*p"
          ],
          "line": 3024
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "lstart+strlen(key)",
            "'='"
          ],
          "line": 3017
        },
        "resolved": true,
        "details": {
          "function_name": "strchrnul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/include/getsubopt.c",
          "lines": "28-40",
          "snippet": "char *strchrnul(const char *s, int c)\n{\n    char *result;\n\n    result = strchr( s, c );\n\n    if( !result )\n    {\n        result = (char *)s + strlen( s );\n    }\n\n    return( result );\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n\nchar *strchrnul(const char *s, int c)\n{\n    char *result;\n\n    result = strchr( s, c );\n\n    if( !result )\n    {\n        result = (char *)s + strlen( s );\n    }\n\n    return( result );\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "key"
          ],
          "line": 3017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "lstart",
            "key",
            "strlen(key)"
          ],
          "line": 3012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "key"
          ],
          "line": 3012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "lstart"
          ],
          "line": 3008
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nbool network_new_hwaddrs(struct lxc_conf *conf)\n{\n\tstruct lxc_list *it;\n\n\tconst char *key = \"lxc.network.hwaddr\";\n\tchar *lstart = conf->unexpanded_config, *lend, *p, *p2;\n\n\tif (!conf->unexpanded_config)\n\t\treturn true;\n\n\twhile (*lstart) {\n\t\tchar newhwaddr[18], oldhwaddr[17];\n\n\t\tlend = strchr(lstart, '\\n');\n\t\tif (!lend)\n\t\t\tlend = lstart + strlen(lstart);\n\t\telse\n\t\t\tlend++;\n\n\t\tif (strncmp(lstart, key, strlen(key)) != 0) {\n\t\t\tlstart = lend;\n\t\t\tcontinue;\n\t\t}\n\n\t\tp = strchr(lstart+strlen(key), '=');\n\t\tif (!p) {\n\t\t\tlstart = lend;\n\t\t\tcontinue;\n\t\t}\n\n\t\tp++;\n\t\twhile (isblank(*p))\n\t\t\tp++;\n\t\tif (!*p)\n\t\t\treturn true;\n\n\t\tp2 = p;\n\t\twhile (*p2 && !isblank(*p2) && *p2 != '\\n')\n\t\t\tp2++;\n\t\tif (p2-p != 17) {\n\t\t\tWARN(\"Bad hwaddr entry\");\n\t\t\tlstart = lend;\n\t\t\tcontinue;\n\t\t}\n\n\t\tmemcpy(oldhwaddr, p, 17);\n\n\t\tif (!new_hwaddr(newhwaddr))\n\t\t\treturn false;\n\n\t\tmemcpy(p, newhwaddr, 17);\n\t\tlxc_list_for_each(it, &conf->network) {\n\t\t\tstruct lxc_netdev *n = it->elem;\n\t\t\tif (n->hwaddr && memcmp(oldhwaddr, n->hwaddr, 17) == 0)\n\t\t\t\tmemcpy(n->hwaddr, newhwaddr, 17);\n\t\t}\n\n\t\tlstart = lend;\n\t}\n\n\treturn true;\n}"
  },
  {
    "function_name": "new_hwaddr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2966-2981",
    "snippet": "static bool new_hwaddr(char *hwaddr)\n{\n\tint ret;\n\n\t/* COMMENT(brauner): Initialize random number generator. */\n\t(void)randseed(true);\n\n\tret = snprintf(hwaddr, 18, \"00:16:3e:%02x:%02x:%02x\", rand() % 255,\n\t\t       rand() % 255, rand() % 255);\n\tif (ret < 0 || ret >= 18) {\n\t\tSYSERROR(\"Failed to call snprintf().\");\n\t\treturn false;\n\t}\n\n\treturn true;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"Failed to call snprintf().\""
          ],
          "line": 2976
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "hwaddr",
            "18",
            "\"00:16:3e:%02x:%02x:%02x\"",
            "rand() % 255",
            "rand() % 255",
            "rand() % 255"
          ],
          "line": 2973
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rand",
          "args": [],
          "line": 2974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rand",
          "args": [],
          "line": 2974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rand",
          "args": [],
          "line": 2973
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "randseed",
          "args": [
            "true"
          ],
          "line": 2971
        },
        "resolved": true,
        "details": {
          "function_name": "randseed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "1012-1032",
          "snippet": "int randseed(bool srand_it)\n{\n\t/*\n\t   srand pre-seed function based on /dev/urandom\n\t   */\n\tunsigned int seed = time(NULL) + getpid();\n\n\tFILE *f;\n\tf = fopen(\"/dev/urandom\", \"r\");\n\tif (f) {\n\t\tint ret = fread(&seed, sizeof(seed), 1, f);\n\t\tif (ret != 1)\n\t\t\tDEBUG(\"unable to fread /dev/urandom, %s, fallback to time+pid rand seed\", strerror(errno));\n\t\tfclose(f);\n\t}\n\n\tif (srand_it)\n\t\tsrand(seed);\n\n\treturn seed;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint randseed(bool srand_it)\n{\n\t/*\n\t   srand pre-seed function based on /dev/urandom\n\t   */\n\tunsigned int seed = time(NULL) + getpid();\n\n\tFILE *f;\n\tf = fopen(\"/dev/urandom\", \"r\");\n\tif (f) {\n\t\tint ret = fread(&seed, sizeof(seed), 1, f);\n\t\tif (ret != 1)\n\t\t\tDEBUG(\"unable to fread /dev/urandom, %s, fallback to time+pid rand seed\", strerror(errno));\n\t\tfclose(f);\n\t}\n\n\tif (srand_it)\n\t\tsrand(seed);\n\n\treturn seed;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic bool new_hwaddr(char *hwaddr)\n{\n\tint ret;\n\n\t/* COMMENT(brauner): Initialize random number generator. */\n\t(void)randseed(true);\n\n\tret = snprintf(hwaddr, 18, \"00:16:3e:%02x:%02x:%02x\", rand() % 255,\n\t\t       rand() % 255, rand() % 255);\n\tif (ret < 0 || ret >= 18) {\n\t\tSYSERROR(\"Failed to call snprintf().\");\n\t\treturn false;\n\t}\n\n\treturn true;\n}"
  },
  {
    "function_name": "clone_update_unexp_hooks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2878-2957",
    "snippet": "bool clone_update_unexp_hooks(struct lxc_conf *conf, const char *oldpath,\n\t\t\t      const char *newpath, const char *oldname,\n\t\t\t      const char *newname)\n{\n\tconst char *key = \"lxc.hook\";\n\tint ret;\n\tchar *lstart = conf->unexpanded_config, *lend, *p;\n\tsize_t newdirlen = strlen(newpath) + strlen(newname) + 1;\n\tsize_t olddirlen = strlen(oldpath) + strlen(oldname) + 1;\n\tchar *olddir = alloca(olddirlen + 1);\n\tchar *newdir = alloca(newdirlen + 1);\n\n\tret = snprintf(olddir, olddirlen + 1, \"%s/%s\", oldpath, oldname);\n\tif (ret < 0 || ret >= olddirlen + 1) {\n\t\tERROR(\"Bug in %s\", __func__);\n\t\treturn false;\n\t}\n\tret = snprintf(newdir, newdirlen + 1, \"%s/%s\", newpath, newname);\n\tif (ret < 0 || ret >= newdirlen + 1) {\n\t\tERROR(\"Bug in %s\", __func__);\n\t\treturn false;\n\t}\n\tif (!conf->unexpanded_config)\n\t\treturn true;\n\twhile (*lstart) {\n\t\tlend = strchr(lstart, '\\n');\n\t\tif (!lend)\n\t\t\tlend = lstart + strlen(lstart);\n\t\telse\n\t\t\tlend++;\n\t\tif (strncmp(lstart, key, strlen(key)) != 0)\n                        goto next;\n\t\tp = strchr(lstart + strlen(key), '=');\n\t\tif (!p)\n                        goto next;\n\t\tp++;\n\t\twhile (isblank(*p))\n\t\t\tp++;\n                if (p >= lend)\n                        goto next;\n\t\tif (strncmp(p, olddir, strlen(olddir)) != 0)\n                        goto next;\n\t\t/* replace the olddir with newdir */\n\t\tif (olddirlen >= newdirlen) {\n\t\t\tsize_t diff = olddirlen - newdirlen;\n\t\t\tmemcpy(p, newdir, newdirlen);\n\t\t\tif (olddirlen != newdirlen) {\n\t\t\t\tmemmove(p + newdirlen, p + newdirlen + diff,\n\t\t\t\t\tstrlen(p) - newdirlen - diff + 1);\n\t\t\t\tlend -= diff;\n\t\t\t\tconf->unexpanded_len -= diff;\n\t\t\t}\n\t\t} else {\n\t\t\tchar *new;\n\t\t\tsize_t diff = newdirlen - olddirlen;\n\t\t\tsize_t oldlen = conf->unexpanded_len;\n\t\t\tsize_t newlen = oldlen + diff;\n\t\t\tsize_t poffset = p - conf->unexpanded_config;\n\t\t\tnew = realloc(conf->unexpanded_config, newlen + 1);\n\t\t\tif (!new) {\n\t\t\t\tERROR(\"Out of memory\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconf->unexpanded_len = newlen;\n\t\t\tconf->unexpanded_alloced = newlen + 1;\n\t\t\tnew[newlen - 1] = '\\0';\n\t\t\tlend = new + (lend - conf->unexpanded_config);\n\t\t\t/* move over the remainder to make room for the newdir */\n\t\t\tmemmove(new + poffset + newdirlen,\n\t\t\t\tnew + poffset + olddirlen,\n\t\t\t\toldlen - poffset - olddirlen + 1);\n\t\t\tconf->unexpanded_config = new;\n\t\t\tmemcpy(new + poffset, newdir, newdirlen);\n\t\t\tlend += diff;\n\t\t}\nnext:\n\t\t\tlstart = lend;\n\t}\n\treturn true;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "new + poffset",
            "newdir",
            "newdirlen"
          ],
          "line": 2950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "new + poffset + newdirlen",
            "new + poffset + olddirlen",
            "oldlen - poffset - olddirlen + 1"
          ],
          "line": 2946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Out of memory\""
          ],
          "line": 2938
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "realloc",
          "args": [
            "conf->unexpanded_config",
            "newlen + 1"
          ],
          "line": 2936
        },
        "resolved": true,
        "details": {
          "function_name": "must_realloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/cgroups/cgfsng.c",
          "lines": "116-124",
          "snippet": "static void *must_realloc(void *orig, size_t sz)\n{\n\tvoid *ret;\n\n\tdo {\n\t\tret = realloc(orig, sz);\n\t} while (!ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include \"log.h\"",
            "#include \"commands.h\"",
            "#include \"cgroup.h\"",
            "#include \"bdev.h\"",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <grp.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include \"log.h\"\n#include \"commands.h\"\n#include \"cgroup.h\"\n#include \"bdev.h\"\n#include <sys/types.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <grp.h>\n#include <errno.h>\n#include <dirent.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic void *must_realloc(void *orig, size_t sz)\n{\n\tvoid *ret;\n\n\tdo {\n\t\tret = realloc(orig, sz);\n\t} while (!ret);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "p + newdirlen",
            "p + newdirlen + diff",
            "strlen(p) - newdirlen - diff + 1"
          ],
          "line": 2925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "p"
          ],
          "line": 2926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "p",
            "newdir",
            "newdirlen"
          ],
          "line": 2923
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "p",
            "olddir",
            "strlen(olddir)"
          ],
          "line": 2918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "olddir"
          ],
          "line": 2918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isblank",
          "args": [
            "*p"
          ],
          "line": 2914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "lstart + strlen(key)",
            "'='"
          ],
          "line": 2910
        },
        "resolved": true,
        "details": {
          "function_name": "strchrnul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/include/getsubopt.c",
          "lines": "28-40",
          "snippet": "char *strchrnul(const char *s, int c)\n{\n    char *result;\n\n    result = strchr( s, c );\n\n    if( !result )\n    {\n        result = (char *)s + strlen( s );\n    }\n\n    return( result );\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n\nchar *strchrnul(const char *s, int c)\n{\n    char *result;\n\n    result = strchr( s, c );\n\n    if( !result )\n    {\n        result = (char *)s + strlen( s );\n    }\n\n    return( result );\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "key"
          ],
          "line": 2910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "lstart",
            "key",
            "strlen(key)"
          ],
          "line": 2908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "key"
          ],
          "line": 2908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "lstart"
          ],
          "line": 2905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Bug in %s\"",
            "__func__"
          ],
          "line": 2897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "newdir",
            "newdirlen + 1",
            "\"%s/%s\"",
            "newpath",
            "newname"
          ],
          "line": 2895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Bug in %s\"",
            "__func__"
          ],
          "line": 2892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "olddir",
            "olddirlen + 1",
            "\"%s/%s\"",
            "oldpath",
            "oldname"
          ],
          "line": 2890
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloca",
          "args": [
            "newdirlen + 1"
          ],
          "line": 2888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloca",
          "args": [
            "olddirlen + 1"
          ],
          "line": 2887
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "oldname"
          ],
          "line": 2886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "oldpath"
          ],
          "line": 2886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "newname"
          ],
          "line": 2885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "newpath"
          ],
          "line": 2885
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nbool clone_update_unexp_hooks(struct lxc_conf *conf, const char *oldpath,\n\t\t\t      const char *newpath, const char *oldname,\n\t\t\t      const char *newname)\n{\n\tconst char *key = \"lxc.hook\";\n\tint ret;\n\tchar *lstart = conf->unexpanded_config, *lend, *p;\n\tsize_t newdirlen = strlen(newpath) + strlen(newname) + 1;\n\tsize_t olddirlen = strlen(oldpath) + strlen(oldname) + 1;\n\tchar *olddir = alloca(olddirlen + 1);\n\tchar *newdir = alloca(newdirlen + 1);\n\n\tret = snprintf(olddir, olddirlen + 1, \"%s/%s\", oldpath, oldname);\n\tif (ret < 0 || ret >= olddirlen + 1) {\n\t\tERROR(\"Bug in %s\", __func__);\n\t\treturn false;\n\t}\n\tret = snprintf(newdir, newdirlen + 1, \"%s/%s\", newpath, newname);\n\tif (ret < 0 || ret >= newdirlen + 1) {\n\t\tERROR(\"Bug in %s\", __func__);\n\t\treturn false;\n\t}\n\tif (!conf->unexpanded_config)\n\t\treturn true;\n\twhile (*lstart) {\n\t\tlend = strchr(lstart, '\\n');\n\t\tif (!lend)\n\t\t\tlend = lstart + strlen(lstart);\n\t\telse\n\t\t\tlend++;\n\t\tif (strncmp(lstart, key, strlen(key)) != 0)\n                        goto next;\n\t\tp = strchr(lstart + strlen(key), '=');\n\t\tif (!p)\n                        goto next;\n\t\tp++;\n\t\twhile (isblank(*p))\n\t\t\tp++;\n                if (p >= lend)\n                        goto next;\n\t\tif (strncmp(p, olddir, strlen(olddir)) != 0)\n                        goto next;\n\t\t/* replace the olddir with newdir */\n\t\tif (olddirlen >= newdirlen) {\n\t\t\tsize_t diff = olddirlen - newdirlen;\n\t\t\tmemcpy(p, newdir, newdirlen);\n\t\t\tif (olddirlen != newdirlen) {\n\t\t\t\tmemmove(p + newdirlen, p + newdirlen + diff,\n\t\t\t\t\tstrlen(p) - newdirlen - diff + 1);\n\t\t\t\tlend -= diff;\n\t\t\t\tconf->unexpanded_len -= diff;\n\t\t\t}\n\t\t} else {\n\t\t\tchar *new;\n\t\t\tsize_t diff = newdirlen - olddirlen;\n\t\t\tsize_t oldlen = conf->unexpanded_len;\n\t\t\tsize_t newlen = oldlen + diff;\n\t\t\tsize_t poffset = p - conf->unexpanded_config;\n\t\t\tnew = realloc(conf->unexpanded_config, newlen + 1);\n\t\t\tif (!new) {\n\t\t\t\tERROR(\"Out of memory\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconf->unexpanded_len = newlen;\n\t\t\tconf->unexpanded_alloced = newlen + 1;\n\t\t\tnew[newlen - 1] = '\\0';\n\t\t\tlend = new + (lend - conf->unexpanded_config);\n\t\t\t/* move over the remainder to make room for the newdir */\n\t\t\tmemmove(new + poffset + newdirlen,\n\t\t\t\tnew + poffset + olddirlen,\n\t\t\t\toldlen - poffset - olddirlen + 1);\n\t\t\tconf->unexpanded_config = new;\n\t\t\tmemcpy(new + poffset, newdir, newdirlen);\n\t\t\tlend += diff;\n\t\t}\nnext:\n\t\t\tlstart = lend;\n\t}\n\treturn true;\n}"
  },
  {
    "function_name": "clone_update_unexp_ovl_paths",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2782-2876",
    "snippet": "bool clone_update_unexp_ovl_paths(struct lxc_conf *conf, const char *oldpath,\n\t\t\t\t  const char *newpath, const char *oldname,\n\t\t\t\t  const char *newname, const char *ovldir)\n{\n\tconst char *key = \"lxc.mount.entry\";\n\tint ret;\n\tchar *lstart = conf->unexpanded_config;\n\tchar *lend;\n\tchar *p;\n\tchar *q;\n\tsize_t newdirlen = strlen(ovldir) + strlen(newpath) + strlen(newname) + 2;\n\tsize_t olddirlen = strlen(ovldir) + strlen(oldpath) + strlen(oldname) + 2;\n\tchar *olddir = alloca(olddirlen + 1);\n\tchar *newdir = alloca(newdirlen + 1);\n\n\tret = snprintf(olddir, olddirlen + 1, \"%s=%s/%s\", ovldir, oldpath, oldname);\n\tif (ret < 0 || ret >= olddirlen + 1) {\n\t\tERROR(\"Bug in %s\", __func__);\n\t\treturn false;\n\t}\n\tret = snprintf(newdir, newdirlen + 1, \"%s=%s/%s\", ovldir, newpath, newname);\n\tif (ret < 0 || ret >= newdirlen + 1) {\n\t\tERROR(\"Bug in %s\", __func__);\n\t\treturn false;\n\t}\n\tif (!conf->unexpanded_config)\n\t\treturn true;\n\twhile (*lstart) {\n\t\tlend = strchr(lstart, '\\n');\n\t\tif (!lend)\n\t\t\tlend = lstart + strlen(lstart);\n\t\telse\n\t\t\tlend++;\n\t\tif (strncmp(lstart, key, strlen(key)) != 0)\n                        goto next;\n\t\tp = strchr(lstart + strlen(key), '=');\n\t\tif (!p)\n                        goto next;\n\t\tp++;\n\t\twhile (isblank(*p))\n\t\t\tp++;\n\t\tif (p >= lend)\n                        goto next;\n                /* Whenever an lxc.mount.entry entry is found in a line we check\n                *  if the substring \" overlay\" or the substring \" aufs\" is\n                *  present before doing any further work. We check for \"\n                *  overlay\" and \" aufs\" since both substrings need to have at\n                *  least one space before them in a valid overlay\n                *  lxc.mount.entry (/A B overlay).  When the space before is\n                *  missing it is very likely that these substrings are part of a\n                *  path or something else. (Checking q >= lend ensures that we\n                *  only count matches in the current line.) */\n\t\tif ((!(q = strstr(p, \" overlay\")) || q >= lend) && (!(q = strstr(p, \" aufs\")) || q >= lend))\n                        goto next;\n\t\tif (!(q = strstr(p, olddir)) || (q >= lend))\n                        goto next;\n\n\t\t/* replace the olddir with newdir */\n\t\tif (olddirlen >= newdirlen) {\n\t\t\tsize_t diff = olddirlen - newdirlen;\n\t\t\tmemcpy(q, newdir, newdirlen);\n\t\t\tif (olddirlen != newdirlen) {\n\t\t\t\tmemmove(q + newdirlen, q + newdirlen + diff,\n\t\t\t\t\tstrlen(q) - newdirlen - diff + 1);\n\t\t\t\tlend -= diff;\n\t\t\t\tconf->unexpanded_len -= diff;\n\t\t\t}\n\t\t} else {\n\t\t\tchar *new;\n\t\t\tsize_t diff = newdirlen - olddirlen;\n\t\t\tsize_t oldlen = conf->unexpanded_len;\n\t\t\tsize_t newlen = oldlen + diff;\n\t\t\tsize_t poffset = q - conf->unexpanded_config;\n\t\t\tnew = realloc(conf->unexpanded_config, newlen + 1);\n\t\t\tif (!new) {\n\t\t\t\tERROR(\"Out of memory\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconf->unexpanded_len = newlen;\n\t\t\tconf->unexpanded_alloced = newlen + 1;\n\t\t\tnew[newlen - 1] = '\\0';\n\t\t\tlend = new + (lend - conf->unexpanded_config);\n\t\t\t/* move over the remainder to make room for the newdir */\n\t\t\tmemmove(new + poffset + newdirlen,\n\t\t\t\tnew + poffset + olddirlen,\n\t\t\t\toldlen - poffset - olddirlen + 1);\n\t\t\tconf->unexpanded_config = new;\n\t\t\tmemcpy(new + poffset, newdir, newdirlen);\n\t\t\tlend += diff;\n\t\t}\nnext:\n\t\t\tlstart = lend;\n\t}\n\treturn true;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "new + poffset",
            "newdir",
            "newdirlen"
          ],
          "line": 2869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "new + poffset + newdirlen",
            "new + poffset + olddirlen",
            "oldlen - poffset - olddirlen + 1"
          ],
          "line": 2865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Out of memory\""
          ],
          "line": 2857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "realloc",
          "args": [
            "conf->unexpanded_config",
            "newlen + 1"
          ],
          "line": 2855
        },
        "resolved": true,
        "details": {
          "function_name": "must_realloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/cgroups/cgfsng.c",
          "lines": "116-124",
          "snippet": "static void *must_realloc(void *orig, size_t sz)\n{\n\tvoid *ret;\n\n\tdo {\n\t\tret = realloc(orig, sz);\n\t} while (!ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include \"log.h\"",
            "#include \"commands.h\"",
            "#include \"cgroup.h\"",
            "#include \"bdev.h\"",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <grp.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include \"log.h\"\n#include \"commands.h\"\n#include \"cgroup.h\"\n#include \"bdev.h\"\n#include <sys/types.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <grp.h>\n#include <errno.h>\n#include <dirent.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic void *must_realloc(void *orig, size_t sz)\n{\n\tvoid *ret;\n\n\tdo {\n\t\tret = realloc(orig, sz);\n\t} while (!ret);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "q + newdirlen",
            "q + newdirlen + diff",
            "strlen(q) - newdirlen - diff + 1"
          ],
          "line": 2844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "q"
          ],
          "line": 2845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "q",
            "newdir",
            "newdirlen"
          ],
          "line": 2842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "p",
            "olddir"
          ],
          "line": 2836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "p",
            "\" aufs\""
          ],
          "line": 2834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "p",
            "\" overlay\""
          ],
          "line": 2834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isblank",
          "args": [
            "*p"
          ],
          "line": 2821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "lstart + strlen(key)",
            "'='"
          ],
          "line": 2817
        },
        "resolved": true,
        "details": {
          "function_name": "strchrnul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/include/getsubopt.c",
          "lines": "28-40",
          "snippet": "char *strchrnul(const char *s, int c)\n{\n    char *result;\n\n    result = strchr( s, c );\n\n    if( !result )\n    {\n        result = (char *)s + strlen( s );\n    }\n\n    return( result );\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n\nchar *strchrnul(const char *s, int c)\n{\n    char *result;\n\n    result = strchr( s, c );\n\n    if( !result )\n    {\n        result = (char *)s + strlen( s );\n    }\n\n    return( result );\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "key"
          ],
          "line": 2817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "lstart",
            "key",
            "strlen(key)"
          ],
          "line": 2815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "key"
          ],
          "line": 2815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "lstart"
          ],
          "line": 2812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Bug in %s\"",
            "__func__"
          ],
          "line": 2804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "newdir",
            "newdirlen + 1",
            "\"%s=%s/%s\"",
            "ovldir",
            "newpath",
            "newname"
          ],
          "line": 2802
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Bug in %s\"",
            "__func__"
          ],
          "line": 2799
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "olddir",
            "olddirlen + 1",
            "\"%s=%s/%s\"",
            "ovldir",
            "oldpath",
            "oldname"
          ],
          "line": 2797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloca",
          "args": [
            "newdirlen + 1"
          ],
          "line": 2795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloca",
          "args": [
            "olddirlen + 1"
          ],
          "line": 2794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "oldname"
          ],
          "line": 2793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "oldpath"
          ],
          "line": 2793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "ovldir"
          ],
          "line": 2793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "newname"
          ],
          "line": 2792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "newpath"
          ],
          "line": 2792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "ovldir"
          ],
          "line": 2792
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nbool clone_update_unexp_ovl_paths(struct lxc_conf *conf, const char *oldpath,\n\t\t\t\t  const char *newpath, const char *oldname,\n\t\t\t\t  const char *newname, const char *ovldir)\n{\n\tconst char *key = \"lxc.mount.entry\";\n\tint ret;\n\tchar *lstart = conf->unexpanded_config;\n\tchar *lend;\n\tchar *p;\n\tchar *q;\n\tsize_t newdirlen = strlen(ovldir) + strlen(newpath) + strlen(newname) + 2;\n\tsize_t olddirlen = strlen(ovldir) + strlen(oldpath) + strlen(oldname) + 2;\n\tchar *olddir = alloca(olddirlen + 1);\n\tchar *newdir = alloca(newdirlen + 1);\n\n\tret = snprintf(olddir, olddirlen + 1, \"%s=%s/%s\", ovldir, oldpath, oldname);\n\tif (ret < 0 || ret >= olddirlen + 1) {\n\t\tERROR(\"Bug in %s\", __func__);\n\t\treturn false;\n\t}\n\tret = snprintf(newdir, newdirlen + 1, \"%s=%s/%s\", ovldir, newpath, newname);\n\tif (ret < 0 || ret >= newdirlen + 1) {\n\t\tERROR(\"Bug in %s\", __func__);\n\t\treturn false;\n\t}\n\tif (!conf->unexpanded_config)\n\t\treturn true;\n\twhile (*lstart) {\n\t\tlend = strchr(lstart, '\\n');\n\t\tif (!lend)\n\t\t\tlend = lstart + strlen(lstart);\n\t\telse\n\t\t\tlend++;\n\t\tif (strncmp(lstart, key, strlen(key)) != 0)\n                        goto next;\n\t\tp = strchr(lstart + strlen(key), '=');\n\t\tif (!p)\n                        goto next;\n\t\tp++;\n\t\twhile (isblank(*p))\n\t\t\tp++;\n\t\tif (p >= lend)\n                        goto next;\n                /* Whenever an lxc.mount.entry entry is found in a line we check\n                *  if the substring \" overlay\" or the substring \" aufs\" is\n                *  present before doing any further work. We check for \"\n                *  overlay\" and \" aufs\" since both substrings need to have at\n                *  least one space before them in a valid overlay\n                *  lxc.mount.entry (/A B overlay).  When the space before is\n                *  missing it is very likely that these substrings are part of a\n                *  path or something else. (Checking q >= lend ensures that we\n                *  only count matches in the current line.) */\n\t\tif ((!(q = strstr(p, \" overlay\")) || q >= lend) && (!(q = strstr(p, \" aufs\")) || q >= lend))\n                        goto next;\n\t\tif (!(q = strstr(p, olddir)) || (q >= lend))\n                        goto next;\n\n\t\t/* replace the olddir with newdir */\n\t\tif (olddirlen >= newdirlen) {\n\t\t\tsize_t diff = olddirlen - newdirlen;\n\t\t\tmemcpy(q, newdir, newdirlen);\n\t\t\tif (olddirlen != newdirlen) {\n\t\t\t\tmemmove(q + newdirlen, q + newdirlen + diff,\n\t\t\t\t\tstrlen(q) - newdirlen - diff + 1);\n\t\t\t\tlend -= diff;\n\t\t\t\tconf->unexpanded_len -= diff;\n\t\t\t}\n\t\t} else {\n\t\t\tchar *new;\n\t\t\tsize_t diff = newdirlen - olddirlen;\n\t\t\tsize_t oldlen = conf->unexpanded_len;\n\t\t\tsize_t newlen = oldlen + diff;\n\t\t\tsize_t poffset = q - conf->unexpanded_config;\n\t\t\tnew = realloc(conf->unexpanded_config, newlen + 1);\n\t\t\tif (!new) {\n\t\t\t\tERROR(\"Out of memory\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconf->unexpanded_len = newlen;\n\t\t\tconf->unexpanded_alloced = newlen + 1;\n\t\t\tnew[newlen - 1] = '\\0';\n\t\t\tlend = new + (lend - conf->unexpanded_config);\n\t\t\t/* move over the remainder to make room for the newdir */\n\t\t\tmemmove(new + poffset + newdirlen,\n\t\t\t\tnew + poffset + olddirlen,\n\t\t\t\toldlen - poffset - olddirlen + 1);\n\t\t\tconf->unexpanded_config = new;\n\t\t\tmemcpy(new + poffset, newdir, newdirlen);\n\t\t\tlend += diff;\n\t\t}\nnext:\n\t\t\tlstart = lend;\n\t}\n\treturn true;\n}"
  },
  {
    "function_name": "clear_unexp_config_line",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2749-2780",
    "snippet": "void clear_unexp_config_line(struct lxc_conf *conf, const char *key, bool rm_subkeys)\n{\n\tchar *lstart = conf->unexpanded_config, *lend;\n\n\tif (!conf->unexpanded_config)\n\t\treturn;\n\twhile (*lstart) {\n\t\tlend = strchr(lstart, '\\n');\n\t\tchar v;\n\t\tif (!lend)\n\t\t\tlend = lstart + strlen(lstart);\n\t\telse\n\t\t\tlend++;\n\t\tif (strncmp(lstart, key, strlen(key)) != 0) {\n\t\t\tlstart = lend;\n\t\t\tcontinue;\n\t\t}\n\t\tif (!rm_subkeys) {\n\t\t\tv = lstart[strlen(key)];\n\t\t\tif (!isspace(v) && v != '=') {\n\t\t\t\tlstart = lend;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tconf->unexpanded_len -= (lend - lstart);\n\t\tif (*lend == '\\0') {\n\t\t\t*lstart = '\\0';\n\t\t\treturn;\n\t\t}\n\t\tmemmove(lstart, lend, strlen(lend)+1);\n\t}\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "lstart",
            "lend",
            "strlen(lend)+1"
          ],
          "line": 2778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "lend"
          ],
          "line": 2778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "v"
          ],
          "line": 2768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "key"
          ],
          "line": 2767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "lstart",
            "key",
            "strlen(key)"
          ],
          "line": 2762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "key"
          ],
          "line": 2762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "lstart"
          ],
          "line": 2759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "lstart",
            "'\\n'"
          ],
          "line": 2756
        },
        "resolved": true,
        "details": {
          "function_name": "strchrnul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/include/getsubopt.c",
          "lines": "28-40",
          "snippet": "char *strchrnul(const char *s, int c)\n{\n    char *result;\n\n    result = strchr( s, c );\n\n    if( !result )\n    {\n        result = (char *)s + strlen( s );\n    }\n\n    return( result );\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n\nchar *strchrnul(const char *s, int c)\n{\n    char *result;\n\n    result = strchr( s, c );\n\n    if( !result )\n    {\n        result = (char *)s + strlen( s );\n    }\n\n    return( result );\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nvoid clear_unexp_config_line(struct lxc_conf *conf, const char *key, bool rm_subkeys)\n{\n\tchar *lstart = conf->unexpanded_config, *lend;\n\n\tif (!conf->unexpanded_config)\n\t\treturn;\n\twhile (*lstart) {\n\t\tlend = strchr(lstart, '\\n');\n\t\tchar v;\n\t\tif (!lend)\n\t\t\tlend = lstart + strlen(lstart);\n\t\telse\n\t\t\tlend++;\n\t\tif (strncmp(lstart, key, strlen(key)) != 0) {\n\t\t\tlstart = lend;\n\t\t\tcontinue;\n\t\t}\n\t\tif (!rm_subkeys) {\n\t\t\tv = lstart[strlen(key)];\n\t\t\tif (!isspace(v) && v != '=') {\n\t\t\t\tlstart = lend;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tconf->unexpanded_len -= (lend - lstart);\n\t\tif (*lend == '\\0') {\n\t\t\t*lstart = '\\0';\n\t\t\treturn;\n\t\t}\n\t\tmemmove(lstart, lend, strlen(lend)+1);\n\t}\n}"
  },
  {
    "function_name": "do_append_unexp_config_line",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2732-2747",
    "snippet": "bool do_append_unexp_config_line(struct lxc_conf *conf, const char *key, const char *v)\n{\n\tint ret;\n\tsize_t len = strlen(key) + strlen(v) + 4;\n\tchar *tmp = alloca(len);\n\n\tret = snprintf(tmp, len, \"%s = %s\", key, v);\n\tif (ret < 0 || ret >= len)\n\t\treturn false;\n\n\t/* Save the line verbatim into unexpanded_conf */\n\tif (append_unexp_config_line(tmp, conf))\n\t\treturn false;\n\n\treturn true;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "append_unexp_config_line",
          "args": [
            "tmp",
            "conf"
          ],
          "line": 2743
        },
        "resolved": true,
        "details": {
          "function_name": "append_unexp_config_line",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "1879-1901",
          "snippet": "int append_unexp_config_line(const char *line, struct lxc_conf *conf)\n{\n\tsize_t len = conf->unexpanded_len, linelen = strlen(line);\n\n\tupdate_hwaddr(line);\n\n\twhile (conf->unexpanded_alloced <= len + linelen + 2) {\n\t\tchar *tmp = realloc(conf->unexpanded_config, conf->unexpanded_alloced + 1024);\n\t\tif (!tmp)\n\t\t\treturn -1;\n\t\tif (!conf->unexpanded_config)\n\t\t\t*tmp = '\\0';\n\t\tconf->unexpanded_config = tmp;\n\t\tconf->unexpanded_alloced += 1024;\n\t}\n\tstrcat(conf->unexpanded_config, line);\n\tconf->unexpanded_len += linelen;\n\tif (line[linelen-1] != '\\n') {\n\t\tstrcat(conf->unexpanded_config, \"\\n\");\n\t\tconf->unexpanded_len++;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nint append_unexp_config_line(const char *line, struct lxc_conf *conf)\n{\n\tsize_t len = conf->unexpanded_len, linelen = strlen(line);\n\n\tupdate_hwaddr(line);\n\n\twhile (conf->unexpanded_alloced <= len + linelen + 2) {\n\t\tchar *tmp = realloc(conf->unexpanded_config, conf->unexpanded_alloced + 1024);\n\t\tif (!tmp)\n\t\t\treturn -1;\n\t\tif (!conf->unexpanded_config)\n\t\t\t*tmp = '\\0';\n\t\tconf->unexpanded_config = tmp;\n\t\tconf->unexpanded_alloced += 1024;\n\t}\n\tstrcat(conf->unexpanded_config, line);\n\tconf->unexpanded_len += linelen;\n\tif (line[linelen-1] != '\\n') {\n\t\tstrcat(conf->unexpanded_config, \"\\n\");\n\t\tconf->unexpanded_len++;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "tmp",
            "len",
            "\"%s = %s\"",
            "key",
            "v"
          ],
          "line": 2738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloca",
          "args": [
            "len"
          ],
          "line": 2736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "v"
          ],
          "line": 2735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "key"
          ],
          "line": 2735
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nbool do_append_unexp_config_line(struct lxc_conf *conf, const char *key, const char *v)\n{\n\tint ret;\n\tsize_t len = strlen(key) + strlen(v) + 4;\n\tchar *tmp = alloca(len);\n\n\tret = snprintf(tmp, len, \"%s = %s\", key, v);\n\tif (ret < 0 || ret >= len)\n\t\treturn false;\n\n\t/* Save the line verbatim into unexpanded_conf */\n\tif (append_unexp_config_line(tmp, conf))\n\t\treturn false;\n\n\treturn true;\n}"
  },
  {
    "function_name": "write_config",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2720-2730",
    "snippet": "void write_config(FILE *fout, struct lxc_conf *c)\n{\n\tsize_t len = c->unexpanded_len;\n\tint ret;\n\n\tif (!len)\n\t\treturn;\n\tret = fwrite(c->unexpanded_config, 1, len, fout);\n\tif (ret != len)\n\t\tSYSERROR(\"Error writing configuration file\");\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"Error writing configuration file\""
          ],
          "line": 2729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fwrite",
          "args": [
            "c->unexpanded_config",
            "1",
            "len",
            "fout"
          ],
          "line": 2727
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nvoid write_config(FILE *fout, struct lxc_conf *c)\n{\n\tsize_t len = c->unexpanded_len;\n\tint ret;\n\n\tif (!len)\n\t\treturn;\n\tret = fwrite(c->unexpanded_config, 1, len, fout);\n\tif (ret != len)\n\t\tSYSERROR(\"Error writing configuration file\");\n}"
  },
  {
    "function_name": "lxc_clear_config_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2690-2715",
    "snippet": "int lxc_clear_config_item(struct lxc_conf *c, const char *key)\n{\n\tif (strcmp(key, \"lxc.network\") == 0)\n\t\treturn lxc_clear_config_network(c);\n\telse if (strncmp(key, \"lxc.network.\", 12) == 0)\n\t\treturn lxc_clear_nic(c, key + 12);\n\telse if (strcmp(key, \"lxc.cap.drop\") == 0)\n\t\treturn lxc_clear_config_caps(c);\n\telse if (strcmp(key, \"lxc.cap.keep\") == 0)\n\t\treturn lxc_clear_config_keepcaps(c);\n\telse if (strncmp(key, \"lxc.cgroup\", 10) == 0)\n\t\treturn lxc_clear_cgroups(c, key);\n\telse if (strcmp(key, \"lxc.mount.entry\") == 0)\n\t\treturn lxc_clear_mount_entries(c);\n\telse if (strcmp(key, \"lxc.mount.auto\") == 0)\n\t\treturn lxc_clear_automounts(c);\n\telse if (strncmp(key, \"lxc.hook\", 8) == 0)\n\t\treturn lxc_clear_hooks(c, key);\n\telse if (strncmp(key, \"lxc.group\", 9) == 0)\n\t\treturn lxc_clear_groups(c);\n\telse if (strncmp(key, \"lxc.environment\", 15) == 0)\n\t\treturn lxc_clear_environment(c);\n\telse if (strncmp(key, \"lxc.id_map\", 10) == 0)\n\t\treturn lxc_clear_idmaps(c);\n\treturn -1;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_clear_idmaps",
          "args": [
            "c"
          ],
          "line": 2713
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_idmaps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4146-4149",
          "snippet": "int lxc_clear_idmaps(struct lxc_conf *c)\n{\n\treturn lxc_free_idmap(&c->id_map);\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_clear_idmaps(struct lxc_conf *c)\n{\n\treturn lxc_free_idmap(&c->id_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "key",
            "\"lxc.id_map\"",
            "10"
          ],
          "line": 2712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_environment",
          "args": [
            "c"
          ],
          "line": 2711
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_environment",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4197-4207",
          "snippet": "int lxc_clear_environment(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->environment, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_clear_environment(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->environment, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "key",
            "\"lxc.environment\"",
            "15"
          ],
          "line": 2710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_groups",
          "args": [
            "c"
          ],
          "line": 2709
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_groups",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4185-4195",
          "snippet": "int lxc_clear_groups(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->groups, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_clear_groups(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->groups, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "key",
            "\"lxc.group\"",
            "9"
          ],
          "line": 2708
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_hooks",
          "args": [
            "c",
            "key"
          ],
          "line": 2707
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_hooks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4228-4254",
          "snippet": "int lxc_clear_hooks(struct lxc_conf *c, const char *key)\n{\n\tstruct lxc_list *it,*next;\n\tbool all = false, done = false;\n\tconst char *k = key + 9;\n\tint i;\n\n\tif (strcmp(key, \"lxc.hook\") == 0)\n\t\tall = true;\n\n\tfor (i=0; i<NUM_LXC_HOOKS; i++) {\n\t\tif (all || strcmp(k, lxchook_names[i]) == 0) {\n\t\t\tlxc_list_for_each_safe(it, &c->hooks[i], next) {\n\t\t\t\tlxc_list_del(it);\n\t\t\t\tfree(it->elem);\n\t\t\t\tfree(it);\n\t\t\t}\n\t\t\tdone = true;\n\t\t}\n\t}\n\n\tif (!done) {\n\t\tERROR(\"Invalid hook key: %s\", key);\n\t\treturn -1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char *lxchook_names[NUM_LXC_HOOKS] = {\n\t\"pre-start\", \"pre-mount\", \"mount\", \"autodev\", \"start\", \"stop\", \"post-stop\", \"clone\", \"destroy\" };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nchar *lxchook_names[NUM_LXC_HOOKS] = {\n\t\"pre-start\", \"pre-mount\", \"mount\", \"autodev\", \"start\", \"stop\", \"post-stop\", \"clone\", \"destroy\" };\n\nint lxc_clear_hooks(struct lxc_conf *c, const char *key)\n{\n\tstruct lxc_list *it,*next;\n\tbool all = false, done = false;\n\tconst char *k = key + 9;\n\tint i;\n\n\tif (strcmp(key, \"lxc.hook\") == 0)\n\t\tall = true;\n\n\tfor (i=0; i<NUM_LXC_HOOKS; i++) {\n\t\tif (all || strcmp(k, lxchook_names[i]) == 0) {\n\t\t\tlxc_list_for_each_safe(it, &c->hooks[i], next) {\n\t\t\t\tlxc_list_del(it);\n\t\t\t\tfree(it->elem);\n\t\t\t\tfree(it);\n\t\t\t}\n\t\t\tdone = true;\n\t\t}\n\t}\n\n\tif (!done) {\n\t\tERROR(\"Invalid hook key: %s\", key);\n\t\treturn -1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "key",
            "\"lxc.hook\"",
            "8"
          ],
          "line": 2706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_automounts",
          "args": [
            "c"
          ],
          "line": 2705
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_automounts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4222-4226",
          "snippet": "int lxc_clear_automounts(struct lxc_conf *c)\n{\n\tc->auto_mounts = 0;\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_clear_automounts(struct lxc_conf *c)\n{\n\tc->auto_mounts = 0;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.mount.auto\""
          ],
          "line": 2704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_mount_entries",
          "args": [
            "c"
          ],
          "line": 2703
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_mount_entries",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4210-4220",
          "snippet": "int lxc_clear_mount_entries(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->mount_list, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_clear_mount_entries(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->mount_list, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.mount.entry\""
          ],
          "line": 2702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_cgroups",
          "args": [
            "c",
            "key"
          ],
          "line": 2701
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_cgroups",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4163-4183",
          "snippet": "int lxc_clear_cgroups(struct lxc_conf *c, const char *key)\n{\n\tstruct lxc_list *it,*next;\n\tbool all = false;\n\tconst char *k = key + 11;\n\n\tif (strcmp(key, \"lxc.cgroup\") == 0)\n\t\tall = true;\n\n\tlxc_list_for_each_safe(it, &c->cgroup, next) {\n\t\tstruct lxc_cgroup *cg = it->elem;\n\t\tif (!all && strcmp(cg->subsystem, k) != 0)\n\t\t\tcontinue;\n\t\tlxc_list_del(it);\n\t\tfree(cg->subsystem);\n\t\tfree(cg->value);\n\t\tfree(cg);\n\t\tfree(it);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_clear_cgroups(struct lxc_conf *c, const char *key)\n{\n\tstruct lxc_list *it,*next;\n\tbool all = false;\n\tconst char *k = key + 11;\n\n\tif (strcmp(key, \"lxc.cgroup\") == 0)\n\t\tall = true;\n\n\tlxc_list_for_each_safe(it, &c->cgroup, next) {\n\t\tstruct lxc_cgroup *cg = it->elem;\n\t\tif (!all && strcmp(cg->subsystem, k) != 0)\n\t\t\tcontinue;\n\t\tlxc_list_del(it);\n\t\tfree(cg->subsystem);\n\t\tfree(cg->value);\n\t\tfree(cg);\n\t\tfree(it);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "key",
            "\"lxc.cgroup\"",
            "10"
          ],
          "line": 2700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_config_keepcaps",
          "args": [
            "c"
          ],
          "line": 2699
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_config_keepcaps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4151-4161",
          "snippet": "int lxc_clear_config_keepcaps(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->keepcaps, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_clear_config_keepcaps(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->keepcaps, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.cap.keep\""
          ],
          "line": 2698
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_config_caps",
          "args": [
            "c"
          ],
          "line": 2697
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_config_caps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4123-4133",
          "snippet": "int lxc_clear_config_caps(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->caps, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int in_caplist(int cap, struct lxc_list *caps);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nstatic int in_caplist(int cap, struct lxc_list *caps);\n\nint lxc_clear_config_caps(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->caps, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.cap.drop\""
          ],
          "line": 2696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_nic",
          "args": [
            "c",
            "key + 12"
          ],
          "line": 2695
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_nic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4062-4112",
          "snippet": "int lxc_clear_nic(struct lxc_conf *c, const char *key)\n{\n\tchar *p1;\n\tint ret, idx, i;\n\tstruct lxc_list *it;\n\tstruct lxc_netdev *netdev;\n\n\tp1 = strchr(key, '.');\n\tif (!p1 || *(p1+1) == '\\0')\n\t\tp1 = NULL;\n\n\tret = sscanf(key, \"%d\", &idx);\n\tif (ret != 1) return -1;\n\tif (idx < 0)\n\t\treturn -1;\n\n\ti = 0;\n\tlxc_list_for_each(it, &c->network) {\n\t\tif (i == idx)\n\t\t\tbreak;\n\t\ti++;\n\t}\n\tif (i < idx)  // we don't have that many nics defined\n\t\treturn -1;\n\n\tif (!it || !it->elem)\n\t\treturn -1;\n\n\tnetdev = it->elem;\n\n\tif (!p1) {\n\t\tlxc_remove_nic(it);\n\t} else if (strcmp(p1, \".ipv4\") == 0) {\n\t\tstruct lxc_list *it2,*next;\n\t\tlxc_list_for_each_safe(it2, &netdev->ipv4, next) {\n\t\t\tlxc_list_del(it2);\n\t\t\tfree(it2->elem);\n\t\t\tfree(it2);\n\t\t}\n\t} else if (strcmp(p1, \".ipv6\") == 0) {\n\t\tstruct lxc_list *it2,*next;\n\t\tlxc_list_for_each_safe(it2, &netdev->ipv6, next) {\n\t\t\tlxc_list_del(it2);\n\t\t\tfree(it2->elem);\n\t\t\tfree(it2);\n\t\t}\n\t}\n\t\telse return -1;\n\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int instantiate_veth(struct lxc_handler *, struct lxc_netdev *);",
            "static int instantiate_macvlan(struct lxc_handler *, struct lxc_netdev *);",
            "static int instantiate_vlan(struct lxc_handler *, struct lxc_netdev *);",
            "static int instantiate_phys(struct lxc_handler *, struct lxc_netdev *);",
            "static int instantiate_empty(struct lxc_handler *, struct lxc_netdev *);",
            "static int instantiate_none(struct lxc_handler *, struct lxc_netdev *);",
            "static int shutdown_veth(struct lxc_handler *, struct lxc_netdev *);",
            "static int shutdown_macvlan(struct lxc_handler *, struct lxc_netdev *);",
            "static int shutdown_vlan(struct lxc_handler *, struct lxc_netdev *);",
            "static int shutdown_phys(struct lxc_handler *, struct lxc_netdev *);",
            "static int shutdown_empty(struct lxc_handler *, struct lxc_netdev *);",
            "static int shutdown_none(struct lxc_handler *, struct lxc_netdev *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nstatic int instantiate_veth(struct lxc_handler *, struct lxc_netdev *);\nstatic int instantiate_macvlan(struct lxc_handler *, struct lxc_netdev *);\nstatic int instantiate_vlan(struct lxc_handler *, struct lxc_netdev *);\nstatic int instantiate_phys(struct lxc_handler *, struct lxc_netdev *);\nstatic int instantiate_empty(struct lxc_handler *, struct lxc_netdev *);\nstatic int instantiate_none(struct lxc_handler *, struct lxc_netdev *);\nstatic int shutdown_veth(struct lxc_handler *, struct lxc_netdev *);\nstatic int shutdown_macvlan(struct lxc_handler *, struct lxc_netdev *);\nstatic int shutdown_vlan(struct lxc_handler *, struct lxc_netdev *);\nstatic int shutdown_phys(struct lxc_handler *, struct lxc_netdev *);\nstatic int shutdown_empty(struct lxc_handler *, struct lxc_netdev *);\nstatic int shutdown_none(struct lxc_handler *, struct lxc_netdev *);\n\nint lxc_clear_nic(struct lxc_conf *c, const char *key)\n{\n\tchar *p1;\n\tint ret, idx, i;\n\tstruct lxc_list *it;\n\tstruct lxc_netdev *netdev;\n\n\tp1 = strchr(key, '.');\n\tif (!p1 || *(p1+1) == '\\0')\n\t\tp1 = NULL;\n\n\tret = sscanf(key, \"%d\", &idx);\n\tif (ret != 1) return -1;\n\tif (idx < 0)\n\t\treturn -1;\n\n\ti = 0;\n\tlxc_list_for_each(it, &c->network) {\n\t\tif (i == idx)\n\t\t\tbreak;\n\t\ti++;\n\t}\n\tif (i < idx)  // we don't have that many nics defined\n\t\treturn -1;\n\n\tif (!it || !it->elem)\n\t\treturn -1;\n\n\tnetdev = it->elem;\n\n\tif (!p1) {\n\t\tlxc_remove_nic(it);\n\t} else if (strcmp(p1, \".ipv4\") == 0) {\n\t\tstruct lxc_list *it2,*next;\n\t\tlxc_list_for_each_safe(it2, &netdev->ipv4, next) {\n\t\t\tlxc_list_del(it2);\n\t\t\tfree(it2->elem);\n\t\t\tfree(it2);\n\t\t}\n\t} else if (strcmp(p1, \".ipv6\") == 0) {\n\t\tstruct lxc_list *it2,*next;\n\t\tlxc_list_for_each_safe(it2, &netdev->ipv6, next) {\n\t\t\tlxc_list_del(it2);\n\t\t\tfree(it2->elem);\n\t\t\tfree(it2);\n\t\t}\n\t}\n\t\telse return -1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "key",
            "\"lxc.network.\"",
            "12"
          ],
          "line": 2694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_config_network",
          "args": [
            "c"
          ],
          "line": 2693
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_config_network",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4114-4121",
          "snippet": "int lxc_clear_config_network(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\tlxc_list_for_each_safe(it, &c->network, next) {\n\t\tlxc_remove_nic(it);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_clear_config_network(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\tlxc_list_for_each_safe(it, &c->network, next) {\n\t\tlxc_remove_nic(it);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.network\""
          ],
          "line": 2692
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nint lxc_clear_config_item(struct lxc_conf *c, const char *key)\n{\n\tif (strcmp(key, \"lxc.network\") == 0)\n\t\treturn lxc_clear_config_network(c);\n\telse if (strncmp(key, \"lxc.network.\", 12) == 0)\n\t\treturn lxc_clear_nic(c, key + 12);\n\telse if (strcmp(key, \"lxc.cap.drop\") == 0)\n\t\treturn lxc_clear_config_caps(c);\n\telse if (strcmp(key, \"lxc.cap.keep\") == 0)\n\t\treturn lxc_clear_config_keepcaps(c);\n\telse if (strncmp(key, \"lxc.cgroup\", 10) == 0)\n\t\treturn lxc_clear_cgroups(c, key);\n\telse if (strcmp(key, \"lxc.mount.entry\") == 0)\n\t\treturn lxc_clear_mount_entries(c);\n\telse if (strcmp(key, \"lxc.mount.auto\") == 0)\n\t\treturn lxc_clear_automounts(c);\n\telse if (strncmp(key, \"lxc.hook\", 8) == 0)\n\t\treturn lxc_clear_hooks(c, key);\n\telse if (strncmp(key, \"lxc.group\", 9) == 0)\n\t\treturn lxc_clear_groups(c);\n\telse if (strncmp(key, \"lxc.environment\", 15) == 0)\n\t\treturn lxc_clear_environment(c);\n\telse if (strncmp(key, \"lxc.id_map\", 10) == 0)\n\t\treturn lxc_clear_idmaps(c);\n\treturn -1;\n}"
  },
  {
    "function_name": "lxc_get_config_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2598-2688",
    "snippet": "int lxc_get_config_item(struct lxc_conf *c, const char *key, char *retv,\n\t\t\tint inlen)\n{\n\tconst char *v = NULL;\n\n\tif (strcmp(key, \"lxc.mount.entry\") == 0)\n\t\treturn lxc_get_mount_entries(c, retv, inlen);\n\telse if (strcmp(key, \"lxc.mount.auto\") == 0)\n\t\treturn lxc_get_auto_mounts(c, retv, inlen);\n\telse if (strcmp(key, \"lxc.mount\") == 0)\n\t\tv = c->fstab;\n\telse if (strcmp(key, \"lxc.tty\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->tty);\n\telse if (strcmp(key, \"lxc.pts\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->pts);\n\telse if (strcmp(key, \"lxc.devttydir\") == 0)\n\t\tv = c->ttydir;\n\telse if (strcmp(key, \"lxc.arch\") == 0)\n\t\treturn lxc_get_arch_entry(c, retv, inlen);\n\telse if (strcmp(key, \"lxc.aa_profile\") == 0)\n\t\tv = c->lsm_aa_profile;\n\telse if (strcmp(key, \"lxc.aa_allow_incomplete\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->lsm_aa_allow_incomplete);\n\telse if (strcmp(key, \"lxc.se_context\") == 0)\n\t\tv = c->lsm_se_context;\n\telse if (strcmp(key, \"lxc.logfile\") == 0)\n\t\tv = c->logfile;\n\telse if (strcmp(key, \"lxc.loglevel\") == 0)\n\t\tv = lxc_log_priority_to_string(c->loglevel);\n\telse if (strcmp(key, \"lxc.cgroup\") == 0) // all cgroup info\n\t\treturn lxc_get_cgroup_entry(c, retv, inlen, \"all\");\n\telse if (strncmp(key, \"lxc.cgroup.\", 11) == 0) // specific cgroup info\n\t\treturn lxc_get_cgroup_entry(c, retv, inlen, key + 11);\n\telse if (strcmp(key, \"lxc.utsname\") == 0)\n\t\tv = c->utsname ? c->utsname->nodename : NULL;\n\telse if (strcmp(key, \"lxc.console.logfile\") == 0)\n\t\tv = c->console.log_path;\n\telse if (strcmp(key, \"lxc.console\") == 0)\n\t\tv = c->console.path;\n\telse if (strcmp(key, \"lxc.rootfs.mount\") == 0)\n\t\tv = c->rootfs.mount;\n\telse if (strcmp(key, \"lxc.rootfs.backend\") == 0)\n\t\tv = c->rootfs.bdev_type;\n\telse if (strcmp(key, \"lxc.rootfs.options\") == 0)\n\t\tv = c->rootfs.options;\n\telse if (strcmp(key, \"lxc.rootfs\") == 0)\n\t\tv = c->rootfs.path;\n\telse if (strcmp(key, \"lxc.cap.drop\") == 0)\n\t\treturn lxc_get_item_cap_drop(c, retv, inlen);\n\telse if (strcmp(key, \"lxc.cap.keep\") == 0)\n\t\treturn lxc_get_item_cap_keep(c, retv, inlen);\n\telse if (strncmp(key, \"lxc.hook\", 8) == 0)\n\t\treturn lxc_get_item_hooks(c, retv, inlen, key);\n\telse if (strcmp(key, \"lxc.network\") == 0)\n\t\treturn lxc_get_item_network(c, retv, inlen);\n\telse if (strncmp(key, \"lxc.network.\", 12) == 0)\n\t\treturn lxc_get_item_nic(c, retv, inlen, key + 12);\n\telse if (strcmp(key, \"lxc.start.auto\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->start_auto);\n\telse if (strcmp(key, \"lxc.start.delay\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->start_delay);\n\telse if (strcmp(key, \"lxc.start.order\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->start_order);\n\telse if (strcmp(key, \"lxc.monitor.unshare\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->monitor_unshare);\n\telse if (strcmp(key, \"lxc.group\") == 0)\n\t\treturn lxc_get_item_groups(c, retv, inlen);\n\telse if (strcmp(key, \"lxc.seccomp\") == 0)\n\t\tv = c->seccomp;\n\telse if (strcmp(key, \"lxc.environment\") == 0)\n\t\treturn lxc_get_item_environment(c, retv, inlen);\n\telse if (strcmp(key, \"lxc.init_cmd\") == 0)\n\t\tv = c->init_cmd;\n\telse if (strcmp(key, \"lxc.init_uid\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->init_uid);\n\telse if (strcmp(key, \"lxc.init_gid\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->init_gid);\n\telse if (strcmp(key, \"lxc.ephemeral\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->ephemeral);\n\telse if (strcmp(key, \"lxc.syslog\") == 0)\n\t\tv = c->syslog;\n\telse if (strcmp(key, \"lxc.no_new_privs\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->no_new_privs);\n\telse return -1;\n\n\tif (!v)\n\t\treturn 0;\n\tif (retv && inlen >= strlen(v) + 1)\n\t\tstrncpy(retv, v, strlen(v)+1);\n\treturn strlen(v);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "v"
          ],
          "line": 2687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "retv",
            "v",
            "strlen(v)+1"
          ],
          "line": 2686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "v"
          ],
          "line": 2686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "v"
          ],
          "line": 2685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_get_conf_int",
          "args": [
            "c",
            "retv",
            "inlen",
            "c->no_new_privs"
          ],
          "line": 2680
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_get_conf_int",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2250-2257",
          "snippet": "static int lxc_get_conf_int(struct lxc_conf *c, char *retv, int inlen, int v)\n{\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\treturn snprintf(retv, inlen, \"%d\", v);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_conf_int(struct lxc_conf *c, char *retv, int inlen, int v)\n{\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\treturn snprintf(retv, inlen, \"%d\", v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.no_new_privs\""
          ],
          "line": 2679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.syslog\""
          ],
          "line": 2677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.ephemeral\""
          ],
          "line": 2675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.init_gid\""
          ],
          "line": 2673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.init_uid\""
          ],
          "line": 2671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.init_cmd\""
          ],
          "line": 2669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_get_item_environment",
          "args": [
            "c",
            "retv",
            "inlen"
          ],
          "line": 2668
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_get_item_environment",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2368-2382",
          "snippet": "static int lxc_get_item_environment(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->environment) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_item_environment(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->environment) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.environment\""
          ],
          "line": 2667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.seccomp\""
          ],
          "line": 2665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_get_item_groups",
          "args": [
            "c",
            "retv",
            "inlen"
          ],
          "line": 2664
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_get_item_groups",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2352-2366",
          "snippet": "static int lxc_get_item_groups(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->groups) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_item_groups(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->groups) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.group\""
          ],
          "line": 2663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.monitor.unshare\""
          ],
          "line": 2661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.start.order\""
          ],
          "line": 2659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.start.delay\""
          ],
          "line": 2657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.start.auto\""
          ],
          "line": 2655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_get_item_nic",
          "args": [
            "c",
            "retv",
            "inlen",
            "key + 12"
          ],
          "line": 2654
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_get_item_nic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2479-2578",
          "snippet": "static int lxc_get_item_nic(struct lxc_conf *c, char *retv, int inlen,\n\t\t\t    const char *key)\n{\n\tchar *p1;\n\tint len, fulllen = 0;\n\tstruct lxc_netdev *netdev;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tp1 = strchr(key, '.');\n\tif (!p1 || *(p1+1) == '\\0') return -1;\n\tp1++;\n\n\tnetdev = get_netdev_from_key(key, &c->network);\n\tif (!netdev)\n\t\treturn -1;\n\tif (strcmp(p1, \"name\") == 0) {\n\t\tif (netdev->name)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->name);\n\t} else if (strcmp(p1, \"type\") == 0) {\n\t\tstrprint(retv, inlen, \"%s\", lxc_net_type_to_str(netdev->type));\n\t} else if (strcmp(p1, \"link\") == 0) {\n\t\tif (netdev->link)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->link);\n\t} else if (strcmp(p1, \"flags\") == 0) {\n\t\tif (netdev->flags & IFF_UP)\n\t\t\tstrprint(retv, inlen, \"up\");\n\t} else if (strcmp(p1, \"script.up\") == 0) {\n\t\tif (netdev->upscript)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->upscript);\n\t} else if (strcmp(p1, \"script.down\") == 0) {\n\t\tif (netdev->downscript)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->downscript);\n\t} else if (strcmp(p1, \"hwaddr\") == 0) {\n\t\tif (netdev->hwaddr)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->hwaddr);\n\t} else if (strcmp(p1, \"mtu\") == 0) {\n\t\tif (netdev->mtu)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->mtu);\n\t} else if (strcmp(p1, \"macvlan.mode\") == 0) {\n\t\tif (netdev->type == LXC_NET_MACVLAN) {\n\t\t\tconst char *mode;\n\t\t\tswitch (netdev->priv.macvlan_attr.mode) {\n\t\t\tcase MACVLAN_MODE_PRIVATE: mode = \"private\"; break;\n\t\t\tcase MACVLAN_MODE_VEPA: mode = \"vepa\"; break;\n\t\t\tcase MACVLAN_MODE_BRIDGE: mode = \"bridge\"; break;\n\t\t\tcase MACVLAN_MODE_PASSTHRU: mode = \"passthru\"; break;\n\t\t\tdefault: mode = \"(invalid)\"; break;\n\t\t\t}\n\t\t\tstrprint(retv, inlen, \"%s\", mode);\n\t\t}\n\t} else if (strcmp(p1, \"veth.pair\") == 0) {\n\t\tif (netdev->type == LXC_NET_VETH) {\n\t\t\tstrprint(retv, inlen, \"%s\",\n\t\t\t\t netdev->priv.veth_attr.pair ?\n\t\t\t\t  netdev->priv.veth_attr.pair :\n\t\t\t\t  netdev->priv.veth_attr.veth1);\n\t\t}\n\t} else if (strcmp(p1, \"vlan\") == 0) {\n\t\tif (netdev->type == LXC_NET_VLAN) {\n\t\t\tstrprint(retv, inlen, \"%d\", netdev->priv.vlan_attr.vid);\n\t\t}\n\t} else if (strcmp(p1, \"ipv4.gateway\") == 0) {\n\t\tif (netdev->ipv4_gateway_auto) {\n\t\t\tstrprint(retv, inlen, \"auto\");\n\t\t} else if (netdev->ipv4_gateway) {\n\t\t\tchar buf[INET_ADDRSTRLEN];\n\t\t\tinet_ntop(AF_INET, netdev->ipv4_gateway, buf, sizeof(buf));\n\t\t\tstrprint(retv, inlen, \"%s\", buf);\n\t\t}\n\t} else if (strcmp(p1, \"ipv4\") == 0) {\n\t\tstruct lxc_list *it2;\n\t\tlxc_list_for_each(it2, &netdev->ipv4) {\n\t\t\tstruct lxc_inetdev *i = it2->elem;\n\t\t\tchar buf[INET_ADDRSTRLEN];\n\t\t\tinet_ntop(AF_INET, &i->addr, buf, sizeof(buf));\n\t\t\tstrprint(retv, inlen, \"%s/%d\\n\", buf, i->prefix);\n\t\t}\n\t} else if (strcmp(p1, \"ipv6.gateway\") == 0) {\n\t\tif (netdev->ipv6_gateway_auto) {\n\t\t\tstrprint(retv, inlen, \"auto\");\n\t\t} else if (netdev->ipv6_gateway) {\n\t\t\tchar buf[INET6_ADDRSTRLEN];\n\t\t\tinet_ntop(AF_INET6, netdev->ipv6_gateway, buf, sizeof(buf));\n\t\t\tstrprint(retv, inlen, \"%s\", buf);\n\t\t}\n\t} else if (strcmp(p1, \"ipv6\") == 0) {\n\t\tstruct lxc_list *it2;\n\t\tlxc_list_for_each(it2, &netdev->ipv6) {\n\t\t\tstruct lxc_inet6dev *i = it2->elem;\n\t\t\tchar buf[INET6_ADDRSTRLEN];\n\t\t\tinet_ntop(AF_INET6, &i->addr, buf, sizeof(buf));\n\t\t\tstrprint(retv, inlen, \"%s/%d\\n\", buf, i->prefix);\n\t\t}\n\t}\n\treturn fulllen;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_item_nic(struct lxc_conf *c, char *retv, int inlen,\n\t\t\t    const char *key)\n{\n\tchar *p1;\n\tint len, fulllen = 0;\n\tstruct lxc_netdev *netdev;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tp1 = strchr(key, '.');\n\tif (!p1 || *(p1+1) == '\\0') return -1;\n\tp1++;\n\n\tnetdev = get_netdev_from_key(key, &c->network);\n\tif (!netdev)\n\t\treturn -1;\n\tif (strcmp(p1, \"name\") == 0) {\n\t\tif (netdev->name)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->name);\n\t} else if (strcmp(p1, \"type\") == 0) {\n\t\tstrprint(retv, inlen, \"%s\", lxc_net_type_to_str(netdev->type));\n\t} else if (strcmp(p1, \"link\") == 0) {\n\t\tif (netdev->link)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->link);\n\t} else if (strcmp(p1, \"flags\") == 0) {\n\t\tif (netdev->flags & IFF_UP)\n\t\t\tstrprint(retv, inlen, \"up\");\n\t} else if (strcmp(p1, \"script.up\") == 0) {\n\t\tif (netdev->upscript)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->upscript);\n\t} else if (strcmp(p1, \"script.down\") == 0) {\n\t\tif (netdev->downscript)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->downscript);\n\t} else if (strcmp(p1, \"hwaddr\") == 0) {\n\t\tif (netdev->hwaddr)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->hwaddr);\n\t} else if (strcmp(p1, \"mtu\") == 0) {\n\t\tif (netdev->mtu)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->mtu);\n\t} else if (strcmp(p1, \"macvlan.mode\") == 0) {\n\t\tif (netdev->type == LXC_NET_MACVLAN) {\n\t\t\tconst char *mode;\n\t\t\tswitch (netdev->priv.macvlan_attr.mode) {\n\t\t\tcase MACVLAN_MODE_PRIVATE: mode = \"private\"; break;\n\t\t\tcase MACVLAN_MODE_VEPA: mode = \"vepa\"; break;\n\t\t\tcase MACVLAN_MODE_BRIDGE: mode = \"bridge\"; break;\n\t\t\tcase MACVLAN_MODE_PASSTHRU: mode = \"passthru\"; break;\n\t\t\tdefault: mode = \"(invalid)\"; break;\n\t\t\t}\n\t\t\tstrprint(retv, inlen, \"%s\", mode);\n\t\t}\n\t} else if (strcmp(p1, \"veth.pair\") == 0) {\n\t\tif (netdev->type == LXC_NET_VETH) {\n\t\t\tstrprint(retv, inlen, \"%s\",\n\t\t\t\t netdev->priv.veth_attr.pair ?\n\t\t\t\t  netdev->priv.veth_attr.pair :\n\t\t\t\t  netdev->priv.veth_attr.veth1);\n\t\t}\n\t} else if (strcmp(p1, \"vlan\") == 0) {\n\t\tif (netdev->type == LXC_NET_VLAN) {\n\t\t\tstrprint(retv, inlen, \"%d\", netdev->priv.vlan_attr.vid);\n\t\t}\n\t} else if (strcmp(p1, \"ipv4.gateway\") == 0) {\n\t\tif (netdev->ipv4_gateway_auto) {\n\t\t\tstrprint(retv, inlen, \"auto\");\n\t\t} else if (netdev->ipv4_gateway) {\n\t\t\tchar buf[INET_ADDRSTRLEN];\n\t\t\tinet_ntop(AF_INET, netdev->ipv4_gateway, buf, sizeof(buf));\n\t\t\tstrprint(retv, inlen, \"%s\", buf);\n\t\t}\n\t} else if (strcmp(p1, \"ipv4\") == 0) {\n\t\tstruct lxc_list *it2;\n\t\tlxc_list_for_each(it2, &netdev->ipv4) {\n\t\t\tstruct lxc_inetdev *i = it2->elem;\n\t\t\tchar buf[INET_ADDRSTRLEN];\n\t\t\tinet_ntop(AF_INET, &i->addr, buf, sizeof(buf));\n\t\t\tstrprint(retv, inlen, \"%s/%d\\n\", buf, i->prefix);\n\t\t}\n\t} else if (strcmp(p1, \"ipv6.gateway\") == 0) {\n\t\tif (netdev->ipv6_gateway_auto) {\n\t\t\tstrprint(retv, inlen, \"auto\");\n\t\t} else if (netdev->ipv6_gateway) {\n\t\t\tchar buf[INET6_ADDRSTRLEN];\n\t\t\tinet_ntop(AF_INET6, netdev->ipv6_gateway, buf, sizeof(buf));\n\t\t\tstrprint(retv, inlen, \"%s\", buf);\n\t\t}\n\t} else if (strcmp(p1, \"ipv6\") == 0) {\n\t\tstruct lxc_list *it2;\n\t\tlxc_list_for_each(it2, &netdev->ipv6) {\n\t\t\tstruct lxc_inet6dev *i = it2->elem;\n\t\t\tchar buf[INET6_ADDRSTRLEN];\n\t\t\tinet_ntop(AF_INET6, &i->addr, buf, sizeof(buf));\n\t\t\tstrprint(retv, inlen, \"%s/%d\\n\", buf, i->prefix);\n\t\t}\n\t}\n\treturn fulllen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "key",
            "\"lxc.network.\"",
            "12"
          ],
          "line": 2653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_get_item_network",
          "args": [
            "c",
            "retv",
            "inlen"
          ],
          "line": 2652
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_get_item_network",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2580-2596",
          "snippet": "static int lxc_get_item_network(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->network) {\n\t\tstruct lxc_netdev *n = it->elem;\n\t\tconst char *t = lxc_net_type_to_str(n->type);\n\t\tstrprint(retv, inlen, \"%s\\n\", t ? t : \"(invalid)\");\n\t}\n\treturn fulllen;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_item_network(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->network) {\n\t\tstruct lxc_netdev *n = it->elem;\n\t\tconst char *t = lxc_net_type_to_str(n->type);\n\t\tstrprint(retv, inlen, \"%s\\n\", t ? t : \"(invalid)\");\n\t}\n\treturn fulllen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.network\""
          ],
          "line": 2651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_get_item_hooks",
          "args": [
            "c",
            "retv",
            "inlen",
            "key"
          ],
          "line": 2650
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_get_item_hooks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2316-2350",
          "snippet": "static int lxc_get_item_hooks(struct lxc_conf *c, char *retv, int inlen,\n\t\t\t      const char *key)\n{\n\tchar *subkey;\n\tint len, fulllen = 0, found = -1;\n\tstruct lxc_list *it;\n\tint i;\n\n\t/* \"lxc.hook.mount\" */\n\tsubkey = strchr(key, '.');\n\tif (subkey) subkey = strchr(subkey+1, '.');\n\tif (!subkey)\n\t\treturn -1;\n\tsubkey++;\n\tif (!*subkey)\n\t\treturn -1;\n\tfor (i=0; i<NUM_LXC_HOOKS; i++) {\n\t\tif (strcmp(lxchook_names[i], subkey) == 0) {\n\t\t\tfound=i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (found == -1)\n\t\treturn -1;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->hooks[found]) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_item_hooks(struct lxc_conf *c, char *retv, int inlen,\n\t\t\t      const char *key)\n{\n\tchar *subkey;\n\tint len, fulllen = 0, found = -1;\n\tstruct lxc_list *it;\n\tint i;\n\n\t/* \"lxc.hook.mount\" */\n\tsubkey = strchr(key, '.');\n\tif (subkey) subkey = strchr(subkey+1, '.');\n\tif (!subkey)\n\t\treturn -1;\n\tsubkey++;\n\tif (!*subkey)\n\t\treturn -1;\n\tfor (i=0; i<NUM_LXC_HOOKS; i++) {\n\t\tif (strcmp(lxchook_names[i], subkey) == 0) {\n\t\t\tfound=i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (found == -1)\n\t\treturn -1;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->hooks[found]) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "key",
            "\"lxc.hook\"",
            "8"
          ],
          "line": 2649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_get_item_cap_keep",
          "args": [
            "c",
            "retv",
            "inlen"
          ],
          "line": 2648
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_get_item_cap_keep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2400-2414",
          "snippet": "static int lxc_get_item_cap_keep(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->keepcaps) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_item_cap_keep(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->keepcaps) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.cap.keep\""
          ],
          "line": 2647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_get_item_cap_drop",
          "args": [
            "c",
            "retv",
            "inlen"
          ],
          "line": 2646
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_get_item_cap_drop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2384-2398",
          "snippet": "static int lxc_get_item_cap_drop(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->caps) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_item_cap_drop(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->caps) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.cap.drop\""
          ],
          "line": 2645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.rootfs\""
          ],
          "line": 2643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.rootfs.options\""
          ],
          "line": 2641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.rootfs.backend\""
          ],
          "line": 2639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.rootfs.mount\""
          ],
          "line": 2637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.console\""
          ],
          "line": 2635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.console.logfile\""
          ],
          "line": 2633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.utsname\""
          ],
          "line": 2631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_get_cgroup_entry",
          "args": [
            "c",
            "retv",
            "inlen",
            "key + 11"
          ],
          "line": 2630
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_get_cgroup_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2290-2314",
          "snippet": "static int lxc_get_cgroup_entry(struct lxc_conf *c, char *retv, int inlen,\n\t\t\t\tconst char *key)\n{\n\tint fulllen = 0, len;\n\tint all = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tif (strcmp(key, \"all\") == 0)\n\t\tall = 1;\n\n\tlxc_list_for_each(it, &c->cgroup) {\n\t\tstruct lxc_cgroup *cg = it->elem;\n\t\tif (all) {\n\t\t\tstrprint(retv, inlen, \"lxc.cgroup.%s = %s\\n\", cg->subsystem, cg->value);\n\t\t} else if (strcmp(cg->subsystem, key) == 0) {\n\t\t\tstrprint(retv, inlen, \"%s\\n\", cg->value);\n\t\t}\n\t}\n\treturn fulllen;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int lxc_get_cgroup_entry(struct lxc_conf *c, char *retv, int inlen,\n\t\t\t\tconst char *key)\n{\n\tint fulllen = 0, len;\n\tint all = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tif (strcmp(key, \"all\") == 0)\n\t\tall = 1;\n\n\tlxc_list_for_each(it, &c->cgroup) {\n\t\tstruct lxc_cgroup *cg = it->elem;\n\t\tif (all) {\n\t\t\tstrprint(retv, inlen, \"lxc.cgroup.%s = %s\\n\", cg->subsystem, cg->value);\n\t\t} else if (strcmp(cg->subsystem, key) == 0) {\n\t\t\tstrprint(retv, inlen, \"%s\\n\", cg->value);\n\t\t}\n\t}\n\treturn fulllen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "key",
            "\"lxc.cgroup.\"",
            "11"
          ],
          "line": 2629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.cgroup\""
          ],
          "line": 2627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_log_priority_to_string",
          "args": [
            "c->loglevel"
          ],
          "line": 2626
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_log_priority_to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/log.h",
          "lines": "141-156",
          "snippet": "static inline const char* lxc_log_priority_to_string(int priority)\n{\n\tswitch (priority) {\n\tcase LXC_LOG_PRIORITY_TRACE:\treturn \"TRACE\";\n\tcase LXC_LOG_PRIORITY_DEBUG:\treturn \"DEBUG\";\n\tcase LXC_LOG_PRIORITY_INFO:\treturn \"INFO\";\n\tcase LXC_LOG_PRIORITY_NOTICE:\treturn \"NOTICE\";\n\tcase LXC_LOG_PRIORITY_WARN:\treturn \"WARN\";\n\tcase LXC_LOG_PRIORITY_ERROR:\treturn \"ERROR\";\n\tcase LXC_LOG_PRIORITY_CRIT:\treturn \"CRIT\";\n\tcase LXC_LOG_PRIORITY_ALERT:\treturn \"ALERT\";\n\tcase LXC_LOG_PRIORITY_FATAL:\treturn \"FATAL\";\n\tdefault:\n\t\treturn \"NOTSET\";\n\t}\n}",
          "includes": [
            "#include \"conf.h\"",
            "#include <time.h>",
            "#include <syslog.h>",
            "#include <stdbool.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <sys/time.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"conf.h\"\n#include <time.h>\n#include <syslog.h>\n#include <stdbool.h>\n#include <strings.h>\n#include <string.h>\n#include <sys/time.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"config.h\"\n\nstatic inline const char* lxc_log_priority_to_string(int priority)\n{\n\tswitch (priority) {\n\tcase LXC_LOG_PRIORITY_TRACE:\treturn \"TRACE\";\n\tcase LXC_LOG_PRIORITY_DEBUG:\treturn \"DEBUG\";\n\tcase LXC_LOG_PRIORITY_INFO:\treturn \"INFO\";\n\tcase LXC_LOG_PRIORITY_NOTICE:\treturn \"NOTICE\";\n\tcase LXC_LOG_PRIORITY_WARN:\treturn \"WARN\";\n\tcase LXC_LOG_PRIORITY_ERROR:\treturn \"ERROR\";\n\tcase LXC_LOG_PRIORITY_CRIT:\treturn \"CRIT\";\n\tcase LXC_LOG_PRIORITY_ALERT:\treturn \"ALERT\";\n\tcase LXC_LOG_PRIORITY_FATAL:\treturn \"FATAL\";\n\tdefault:\n\t\treturn \"NOTSET\";\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.loglevel\""
          ],
          "line": 2625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.logfile\""
          ],
          "line": 2623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.se_context\""
          ],
          "line": 2621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.aa_allow_incomplete\""
          ],
          "line": 2619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.aa_profile\""
          ],
          "line": 2617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_get_arch_entry",
          "args": [
            "c",
            "retv",
            "inlen"
          ],
          "line": 2616
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_get_arch_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2259-2279",
          "snippet": "static int lxc_get_arch_entry(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint fulllen = 0;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\t#if HAVE_SYS_PERSONALITY_H\n\tint len = 0;\n\n\tswitch(c->personality) {\n\tcase PER_LINUX32: strprint(retv, inlen, \"i686\"); break;\n\tcase PER_LINUX: strprint(retv, inlen, \"x86_64\"); break;\n\tdefault: break;\n\t}\n\t#endif\n\n\treturn fulllen;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_arch_entry(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint fulllen = 0;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\t#if HAVE_SYS_PERSONALITY_H\n\tint len = 0;\n\n\tswitch(c->personality) {\n\tcase PER_LINUX32: strprint(retv, inlen, \"i686\"); break;\n\tcase PER_LINUX: strprint(retv, inlen, \"x86_64\"); break;\n\tdefault: break;\n\t}\n\t#endif\n\n\treturn fulllen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.arch\""
          ],
          "line": 2615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.devttydir\""
          ],
          "line": 2613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.pts\""
          ],
          "line": 2611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.tty\""
          ],
          "line": 2609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.mount\""
          ],
          "line": 2607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_get_auto_mounts",
          "args": [
            "c",
            "retv",
            "inlen"
          ],
          "line": 2606
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_get_auto_mounts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2432-2469",
          "snippet": "static int lxc_get_auto_mounts(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tconst char *sep = \"\";\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tif (!(c->auto_mounts & LXC_AUTO_ALL_MASK))\n\t\treturn 0;\n\n\tswitch (c->auto_mounts & LXC_AUTO_PROC_MASK) {\n\t\tcase LXC_AUTO_PROC_MIXED:         strprint(retv, inlen, \"%sproc:mixed\", sep);        sep = \" \"; break;\n\t\tcase LXC_AUTO_PROC_RW:            strprint(retv, inlen, \"%sproc:rw\", sep);           sep = \" \"; break;\n\t\tdefault: break;\n\t}\n\tswitch (c->auto_mounts & LXC_AUTO_SYS_MASK) {\n\t\tcase LXC_AUTO_SYS_RO:             strprint(retv, inlen, \"%ssys:ro\", sep);            sep = \" \"; break;\n\t\tcase LXC_AUTO_SYS_RW:             strprint(retv, inlen, \"%ssys:rw\", sep);            sep = \" \"; break;\n\t\tcase LXC_AUTO_SYS_MIXED:          strprint(retv, inlen, \"%ssys:mixed\", sep);         sep = \" \"; break;\n\t\tdefault: break;\n\t}\n\tswitch (c->auto_mounts & LXC_AUTO_CGROUP_MASK) {\n\t\tcase LXC_AUTO_CGROUP_NOSPEC:      strprint(retv, inlen, \"%scgroup\", sep);            sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_MIXED:       strprint(retv, inlen, \"%scgroup:mixed\", sep);      sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_RO:          strprint(retv, inlen, \"%scgroup:ro\", sep);         sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_RW:          strprint(retv, inlen, \"%scgroup:rw\", sep);         sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_FULL_NOSPEC: strprint(retv, inlen, \"%scgroup-full\", sep);       sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_FULL_MIXED:  strprint(retv, inlen, \"%scgroup-full:mixed\", sep); sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_FULL_RO:     strprint(retv, inlen, \"%scgroup-full:ro\", sep);    sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_FULL_RW:     strprint(retv, inlen, \"%scgroup-full:rw\", sep);    sep = \" \"; break;\n\t\tdefault: break;\n\t}\n\n\treturn fulllen;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_auto_mounts(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tconst char *sep = \"\";\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tif (!(c->auto_mounts & LXC_AUTO_ALL_MASK))\n\t\treturn 0;\n\n\tswitch (c->auto_mounts & LXC_AUTO_PROC_MASK) {\n\t\tcase LXC_AUTO_PROC_MIXED:         strprint(retv, inlen, \"%sproc:mixed\", sep);        sep = \" \"; break;\n\t\tcase LXC_AUTO_PROC_RW:            strprint(retv, inlen, \"%sproc:rw\", sep);           sep = \" \"; break;\n\t\tdefault: break;\n\t}\n\tswitch (c->auto_mounts & LXC_AUTO_SYS_MASK) {\n\t\tcase LXC_AUTO_SYS_RO:             strprint(retv, inlen, \"%ssys:ro\", sep);            sep = \" \"; break;\n\t\tcase LXC_AUTO_SYS_RW:             strprint(retv, inlen, \"%ssys:rw\", sep);            sep = \" \"; break;\n\t\tcase LXC_AUTO_SYS_MIXED:          strprint(retv, inlen, \"%ssys:mixed\", sep);         sep = \" \"; break;\n\t\tdefault: break;\n\t}\n\tswitch (c->auto_mounts & LXC_AUTO_CGROUP_MASK) {\n\t\tcase LXC_AUTO_CGROUP_NOSPEC:      strprint(retv, inlen, \"%scgroup\", sep);            sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_MIXED:       strprint(retv, inlen, \"%scgroup:mixed\", sep);      sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_RO:          strprint(retv, inlen, \"%scgroup:ro\", sep);         sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_RW:          strprint(retv, inlen, \"%scgroup:rw\", sep);         sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_FULL_NOSPEC: strprint(retv, inlen, \"%scgroup-full\", sep);       sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_FULL_MIXED:  strprint(retv, inlen, \"%scgroup-full:mixed\", sep); sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_FULL_RO:     strprint(retv, inlen, \"%scgroup-full:ro\", sep);    sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_FULL_RW:     strprint(retv, inlen, \"%scgroup-full:rw\", sep);    sep = \" \"; break;\n\t\tdefault: break;\n\t}\n\n\treturn fulllen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.mount.auto\""
          ],
          "line": 2605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_get_mount_entries",
          "args": [
            "c",
            "retv",
            "inlen"
          ],
          "line": 2604
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_get_mount_entries",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2416-2430",
          "snippet": "static int lxc_get_mount_entries(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->mount_list) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_mount_entries(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->mount_list) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.mount.entry\""
          ],
          "line": 2603
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nint lxc_get_config_item(struct lxc_conf *c, const char *key, char *retv,\n\t\t\tint inlen)\n{\n\tconst char *v = NULL;\n\n\tif (strcmp(key, \"lxc.mount.entry\") == 0)\n\t\treturn lxc_get_mount_entries(c, retv, inlen);\n\telse if (strcmp(key, \"lxc.mount.auto\") == 0)\n\t\treturn lxc_get_auto_mounts(c, retv, inlen);\n\telse if (strcmp(key, \"lxc.mount\") == 0)\n\t\tv = c->fstab;\n\telse if (strcmp(key, \"lxc.tty\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->tty);\n\telse if (strcmp(key, \"lxc.pts\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->pts);\n\telse if (strcmp(key, \"lxc.devttydir\") == 0)\n\t\tv = c->ttydir;\n\telse if (strcmp(key, \"lxc.arch\") == 0)\n\t\treturn lxc_get_arch_entry(c, retv, inlen);\n\telse if (strcmp(key, \"lxc.aa_profile\") == 0)\n\t\tv = c->lsm_aa_profile;\n\telse if (strcmp(key, \"lxc.aa_allow_incomplete\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->lsm_aa_allow_incomplete);\n\telse if (strcmp(key, \"lxc.se_context\") == 0)\n\t\tv = c->lsm_se_context;\n\telse if (strcmp(key, \"lxc.logfile\") == 0)\n\t\tv = c->logfile;\n\telse if (strcmp(key, \"lxc.loglevel\") == 0)\n\t\tv = lxc_log_priority_to_string(c->loglevel);\n\telse if (strcmp(key, \"lxc.cgroup\") == 0) // all cgroup info\n\t\treturn lxc_get_cgroup_entry(c, retv, inlen, \"all\");\n\telse if (strncmp(key, \"lxc.cgroup.\", 11) == 0) // specific cgroup info\n\t\treturn lxc_get_cgroup_entry(c, retv, inlen, key + 11);\n\telse if (strcmp(key, \"lxc.utsname\") == 0)\n\t\tv = c->utsname ? c->utsname->nodename : NULL;\n\telse if (strcmp(key, \"lxc.console.logfile\") == 0)\n\t\tv = c->console.log_path;\n\telse if (strcmp(key, \"lxc.console\") == 0)\n\t\tv = c->console.path;\n\telse if (strcmp(key, \"lxc.rootfs.mount\") == 0)\n\t\tv = c->rootfs.mount;\n\telse if (strcmp(key, \"lxc.rootfs.backend\") == 0)\n\t\tv = c->rootfs.bdev_type;\n\telse if (strcmp(key, \"lxc.rootfs.options\") == 0)\n\t\tv = c->rootfs.options;\n\telse if (strcmp(key, \"lxc.rootfs\") == 0)\n\t\tv = c->rootfs.path;\n\telse if (strcmp(key, \"lxc.cap.drop\") == 0)\n\t\treturn lxc_get_item_cap_drop(c, retv, inlen);\n\telse if (strcmp(key, \"lxc.cap.keep\") == 0)\n\t\treturn lxc_get_item_cap_keep(c, retv, inlen);\n\telse if (strncmp(key, \"lxc.hook\", 8) == 0)\n\t\treturn lxc_get_item_hooks(c, retv, inlen, key);\n\telse if (strcmp(key, \"lxc.network\") == 0)\n\t\treturn lxc_get_item_network(c, retv, inlen);\n\telse if (strncmp(key, \"lxc.network.\", 12) == 0)\n\t\treturn lxc_get_item_nic(c, retv, inlen, key + 12);\n\telse if (strcmp(key, \"lxc.start.auto\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->start_auto);\n\telse if (strcmp(key, \"lxc.start.delay\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->start_delay);\n\telse if (strcmp(key, \"lxc.start.order\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->start_order);\n\telse if (strcmp(key, \"lxc.monitor.unshare\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->monitor_unshare);\n\telse if (strcmp(key, \"lxc.group\") == 0)\n\t\treturn lxc_get_item_groups(c, retv, inlen);\n\telse if (strcmp(key, \"lxc.seccomp\") == 0)\n\t\tv = c->seccomp;\n\telse if (strcmp(key, \"lxc.environment\") == 0)\n\t\treturn lxc_get_item_environment(c, retv, inlen);\n\telse if (strcmp(key, \"lxc.init_cmd\") == 0)\n\t\tv = c->init_cmd;\n\telse if (strcmp(key, \"lxc.init_uid\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->init_uid);\n\telse if (strcmp(key, \"lxc.init_gid\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->init_gid);\n\telse if (strcmp(key, \"lxc.ephemeral\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->ephemeral);\n\telse if (strcmp(key, \"lxc.syslog\") == 0)\n\t\tv = c->syslog;\n\telse if (strcmp(key, \"lxc.no_new_privs\") == 0)\n\t\treturn lxc_get_conf_int(c, retv, inlen, c->no_new_privs);\n\telse return -1;\n\n\tif (!v)\n\t\treturn 0;\n\tif (retv && inlen >= strlen(v) + 1)\n\t\tstrncpy(retv, v, strlen(v)+1);\n\treturn strlen(v);\n}"
  },
  {
    "function_name": "lxc_get_item_network",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2580-2596",
    "snippet": "static int lxc_get_item_network(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->network) {\n\t\tstruct lxc_netdev *n = it->elem;\n\t\tconst char *t = lxc_net_type_to_str(n->type);\n\t\tstrprint(retv, inlen, \"%s\\n\", t ? t : \"(invalid)\");\n\t}\n\treturn fulllen;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\\n\"",
            "t ? t : \"(invalid)\""
          ],
          "line": 2593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_net_type_to_str",
          "args": [
            "n->type"
          ],
          "line": 2592
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_net_type_to_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/network.c",
          "lines": "1497-1502",
          "snippet": "const char *lxc_net_type_to_str(int type)\n{\n\tif (type < 0 || type > LXC_NET_MAXCONFTYPE)\n\t\treturn NULL;\n\treturn lxc_network_types[type];\n}",
          "includes": [
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"utils.h\"",
            "#include \"conf.h\"",
            "#include \"network.h\"",
            "#include \"nl.h\"",
            "#include <linux/sockios.h>",
            "#include <linux/rtnetlink.h>",
            "#include <linux/netlink.h>",
            "#include <netinet/in.h>",
            "#include <net/ethernet.h>",
            "#include <net/if_arp.h>",
            "#include <net/if.h>",
            "#include <arpa/inet.h>",
            "#include <sys/inotify.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <time.h>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const char* const lxc_network_types[LXC_NET_MAXCONFTYPE + 1] = {\n\t[LXC_NET_EMPTY]   = \"empty\",\n\t[LXC_NET_VETH]    = \"veth\",\n\t[LXC_NET_MACVLAN] = \"macvlan\",\n\t[LXC_NET_PHYS]    = \"phys\",\n\t[LXC_NET_VLAN]    = \"vlan\",\n\t[LXC_NET_NONE]    = \"none\",\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"utils.h\"\n#include \"conf.h\"\n#include \"network.h\"\n#include \"nl.h\"\n#include <linux/sockios.h>\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <netinet/in.h>\n#include <net/ethernet.h>\n#include <net/if_arp.h>\n#include <net/if.h>\n#include <arpa/inet.h>\n#include <sys/inotify.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <time.h>\n#include <ctype.h>\n#include <stdio.h>\n#include <string.h>\n#include <errno.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic const char* const lxc_network_types[LXC_NET_MAXCONFTYPE + 1] = {\n\t[LXC_NET_EMPTY]   = \"empty\",\n\t[LXC_NET_VETH]    = \"veth\",\n\t[LXC_NET_MACVLAN] = \"macvlan\",\n\t[LXC_NET_PHYS]    = \"phys\",\n\t[LXC_NET_VLAN]    = \"vlan\",\n\t[LXC_NET_NONE]    = \"none\",\n};\n\nconst char *lxc_net_type_to_str(int type)\n{\n\tif (type < 0 || type > LXC_NET_MAXCONFTYPE)\n\t\treturn NULL;\n\treturn lxc_network_types[type];\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_list_for_each",
          "args": [
            "it",
            "&c->network"
          ],
          "line": 2590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "retv",
            "0",
            "inlen"
          ],
          "line": 2588
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_item_network(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->network) {\n\t\tstruct lxc_netdev *n = it->elem;\n\t\tconst char *t = lxc_net_type_to_str(n->type);\n\t\tstrprint(retv, inlen, \"%s\\n\", t ? t : \"(invalid)\");\n\t}\n\treturn fulllen;\n}"
  },
  {
    "function_name": "lxc_get_item_nic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2479-2578",
    "snippet": "static int lxc_get_item_nic(struct lxc_conf *c, char *retv, int inlen,\n\t\t\t    const char *key)\n{\n\tchar *p1;\n\tint len, fulllen = 0;\n\tstruct lxc_netdev *netdev;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tp1 = strchr(key, '.');\n\tif (!p1 || *(p1+1) == '\\0') return -1;\n\tp1++;\n\n\tnetdev = get_netdev_from_key(key, &c->network);\n\tif (!netdev)\n\t\treturn -1;\n\tif (strcmp(p1, \"name\") == 0) {\n\t\tif (netdev->name)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->name);\n\t} else if (strcmp(p1, \"type\") == 0) {\n\t\tstrprint(retv, inlen, \"%s\", lxc_net_type_to_str(netdev->type));\n\t} else if (strcmp(p1, \"link\") == 0) {\n\t\tif (netdev->link)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->link);\n\t} else if (strcmp(p1, \"flags\") == 0) {\n\t\tif (netdev->flags & IFF_UP)\n\t\t\tstrprint(retv, inlen, \"up\");\n\t} else if (strcmp(p1, \"script.up\") == 0) {\n\t\tif (netdev->upscript)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->upscript);\n\t} else if (strcmp(p1, \"script.down\") == 0) {\n\t\tif (netdev->downscript)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->downscript);\n\t} else if (strcmp(p1, \"hwaddr\") == 0) {\n\t\tif (netdev->hwaddr)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->hwaddr);\n\t} else if (strcmp(p1, \"mtu\") == 0) {\n\t\tif (netdev->mtu)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->mtu);\n\t} else if (strcmp(p1, \"macvlan.mode\") == 0) {\n\t\tif (netdev->type == LXC_NET_MACVLAN) {\n\t\t\tconst char *mode;\n\t\t\tswitch (netdev->priv.macvlan_attr.mode) {\n\t\t\tcase MACVLAN_MODE_PRIVATE: mode = \"private\"; break;\n\t\t\tcase MACVLAN_MODE_VEPA: mode = \"vepa\"; break;\n\t\t\tcase MACVLAN_MODE_BRIDGE: mode = \"bridge\"; break;\n\t\t\tcase MACVLAN_MODE_PASSTHRU: mode = \"passthru\"; break;\n\t\t\tdefault: mode = \"(invalid)\"; break;\n\t\t\t}\n\t\t\tstrprint(retv, inlen, \"%s\", mode);\n\t\t}\n\t} else if (strcmp(p1, \"veth.pair\") == 0) {\n\t\tif (netdev->type == LXC_NET_VETH) {\n\t\t\tstrprint(retv, inlen, \"%s\",\n\t\t\t\t netdev->priv.veth_attr.pair ?\n\t\t\t\t  netdev->priv.veth_attr.pair :\n\t\t\t\t  netdev->priv.veth_attr.veth1);\n\t\t}\n\t} else if (strcmp(p1, \"vlan\") == 0) {\n\t\tif (netdev->type == LXC_NET_VLAN) {\n\t\t\tstrprint(retv, inlen, \"%d\", netdev->priv.vlan_attr.vid);\n\t\t}\n\t} else if (strcmp(p1, \"ipv4.gateway\") == 0) {\n\t\tif (netdev->ipv4_gateway_auto) {\n\t\t\tstrprint(retv, inlen, \"auto\");\n\t\t} else if (netdev->ipv4_gateway) {\n\t\t\tchar buf[INET_ADDRSTRLEN];\n\t\t\tinet_ntop(AF_INET, netdev->ipv4_gateway, buf, sizeof(buf));\n\t\t\tstrprint(retv, inlen, \"%s\", buf);\n\t\t}\n\t} else if (strcmp(p1, \"ipv4\") == 0) {\n\t\tstruct lxc_list *it2;\n\t\tlxc_list_for_each(it2, &netdev->ipv4) {\n\t\t\tstruct lxc_inetdev *i = it2->elem;\n\t\t\tchar buf[INET_ADDRSTRLEN];\n\t\t\tinet_ntop(AF_INET, &i->addr, buf, sizeof(buf));\n\t\t\tstrprint(retv, inlen, \"%s/%d\\n\", buf, i->prefix);\n\t\t}\n\t} else if (strcmp(p1, \"ipv6.gateway\") == 0) {\n\t\tif (netdev->ipv6_gateway_auto) {\n\t\t\tstrprint(retv, inlen, \"auto\");\n\t\t} else if (netdev->ipv6_gateway) {\n\t\t\tchar buf[INET6_ADDRSTRLEN];\n\t\t\tinet_ntop(AF_INET6, netdev->ipv6_gateway, buf, sizeof(buf));\n\t\t\tstrprint(retv, inlen, \"%s\", buf);\n\t\t}\n\t} else if (strcmp(p1, \"ipv6\") == 0) {\n\t\tstruct lxc_list *it2;\n\t\tlxc_list_for_each(it2, &netdev->ipv6) {\n\t\t\tstruct lxc_inet6dev *i = it2->elem;\n\t\t\tchar buf[INET6_ADDRSTRLEN];\n\t\t\tinet_ntop(AF_INET6, &i->addr, buf, sizeof(buf));\n\t\t\tstrprint(retv, inlen, \"%s/%d\\n\", buf, i->prefix);\n\t\t}\n\t}\n\treturn fulllen;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s/%d\\n\"",
            "buf",
            "i->prefix"
          ],
          "line": 2574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inet_ntop",
          "args": [
            "AF_INET6",
            "&i->addr",
            "buf",
            "sizeof(buf)"
          ],
          "line": 2573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_list_for_each",
          "args": [
            "it2",
            "&netdev->ipv6"
          ],
          "line": 2570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "p1",
            "\"ipv6\""
          ],
          "line": 2568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\"",
            "buf"
          ],
          "line": 2566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inet_ntop",
          "args": [
            "AF_INET6",
            "netdev->ipv6_gateway",
            "buf",
            "sizeof(buf)"
          ],
          "line": 2565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"auto\""
          ],
          "line": 2562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "p1",
            "\"ipv6.gateway\""
          ],
          "line": 2560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s/%d\\n\"",
            "buf",
            "i->prefix"
          ],
          "line": 2558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inet_ntop",
          "args": [
            "AF_INET",
            "&i->addr",
            "buf",
            "sizeof(buf)"
          ],
          "line": 2557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_list_for_each",
          "args": [
            "it2",
            "&netdev->ipv4"
          ],
          "line": 2554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "p1",
            "\"ipv4\""
          ],
          "line": 2552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\"",
            "buf"
          ],
          "line": 2550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inet_ntop",
          "args": [
            "AF_INET",
            "netdev->ipv4_gateway",
            "buf",
            "sizeof(buf)"
          ],
          "line": 2549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"auto\""
          ],
          "line": 2546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "p1",
            "\"ipv4.gateway\""
          ],
          "line": 2544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%d\"",
            "netdev->priv.vlan_attr.vid"
          ],
          "line": 2542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "p1",
            "\"vlan\""
          ],
          "line": 2540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\"",
            "netdev->priv.veth_attr.pair ?\n\t\t\t\t  netdev->priv.veth_attr.pair :\n\t\t\t\t  netdev->priv.veth_attr.veth1"
          ],
          "line": 2535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "p1",
            "\"veth.pair\""
          ],
          "line": 2533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\"",
            "mode"
          ],
          "line": 2531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "p1",
            "\"macvlan.mode\""
          ],
          "line": 2521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\"",
            "netdev->mtu"
          ],
          "line": 2520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "p1",
            "\"mtu\""
          ],
          "line": 2518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\"",
            "netdev->hwaddr"
          ],
          "line": 2517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "p1",
            "\"hwaddr\""
          ],
          "line": 2515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\"",
            "netdev->downscript"
          ],
          "line": 2514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "p1",
            "\"script.down\""
          ],
          "line": 2512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\"",
            "netdev->upscript"
          ],
          "line": 2511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "p1",
            "\"script.up\""
          ],
          "line": 2509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"up\""
          ],
          "line": 2508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "p1",
            "\"flags\""
          ],
          "line": 2506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\"",
            "netdev->link"
          ],
          "line": 2505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "p1",
            "\"link\""
          ],
          "line": 2503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\"",
            "lxc_net_type_to_str(netdev->type)"
          ],
          "line": 2502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_net_type_to_str",
          "args": [
            "netdev->type"
          ],
          "line": 2502
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_net_type_to_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/network.c",
          "lines": "1497-1502",
          "snippet": "const char *lxc_net_type_to_str(int type)\n{\n\tif (type < 0 || type > LXC_NET_MAXCONFTYPE)\n\t\treturn NULL;\n\treturn lxc_network_types[type];\n}",
          "includes": [
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"utils.h\"",
            "#include \"conf.h\"",
            "#include \"network.h\"",
            "#include \"nl.h\"",
            "#include <linux/sockios.h>",
            "#include <linux/rtnetlink.h>",
            "#include <linux/netlink.h>",
            "#include <netinet/in.h>",
            "#include <net/ethernet.h>",
            "#include <net/if_arp.h>",
            "#include <net/if.h>",
            "#include <arpa/inet.h>",
            "#include <sys/inotify.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <time.h>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const char* const lxc_network_types[LXC_NET_MAXCONFTYPE + 1] = {\n\t[LXC_NET_EMPTY]   = \"empty\",\n\t[LXC_NET_VETH]    = \"veth\",\n\t[LXC_NET_MACVLAN] = \"macvlan\",\n\t[LXC_NET_PHYS]    = \"phys\",\n\t[LXC_NET_VLAN]    = \"vlan\",\n\t[LXC_NET_NONE]    = \"none\",\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"utils.h\"\n#include \"conf.h\"\n#include \"network.h\"\n#include \"nl.h\"\n#include <linux/sockios.h>\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <netinet/in.h>\n#include <net/ethernet.h>\n#include <net/if_arp.h>\n#include <net/if.h>\n#include <arpa/inet.h>\n#include <sys/inotify.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <time.h>\n#include <ctype.h>\n#include <stdio.h>\n#include <string.h>\n#include <errno.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic const char* const lxc_network_types[LXC_NET_MAXCONFTYPE + 1] = {\n\t[LXC_NET_EMPTY]   = \"empty\",\n\t[LXC_NET_VETH]    = \"veth\",\n\t[LXC_NET_MACVLAN] = \"macvlan\",\n\t[LXC_NET_PHYS]    = \"phys\",\n\t[LXC_NET_VLAN]    = \"vlan\",\n\t[LXC_NET_NONE]    = \"none\",\n};\n\nconst char *lxc_net_type_to_str(int type)\n{\n\tif (type < 0 || type > LXC_NET_MAXCONFTYPE)\n\t\treturn NULL;\n\treturn lxc_network_types[type];\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "p1",
            "\"type\""
          ],
          "line": 2501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\"",
            "netdev->name"
          ],
          "line": 2500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "p1",
            "\"name\""
          ],
          "line": 2498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_netdev_from_key",
          "args": [
            "key",
            "&c->network"
          ],
          "line": 2495
        },
        "resolved": true,
        "details": {
          "function_name": "get_netdev_from_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "503-518",
          "snippet": "static struct lxc_netdev *get_netdev_from_key(const char *key,\n\t\t\t\t\t      struct lxc_list *network)\n{\n\tint i = 0, idx = get_network_netdev_idx(key);\n\tstruct lxc_netdev *netdev = NULL;\n\tstruct lxc_list *it;\n\tif (idx == -1)\n\t\treturn NULL;\n\tlxc_list_for_each(it, network) {\n\t\tif (idx == i++) {\n\t\t\tnetdev = it->elem;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn netdev;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct lxc_netdev *get_netdev_from_key(const char *key,\n\t\t\t\t\t      struct lxc_list *network)\n{\n\tint i = 0, idx = get_network_netdev_idx(key);\n\tstruct lxc_netdev *netdev = NULL;\n\tstruct lxc_list *it;\n\tif (idx == -1)\n\t\treturn NULL;\n\tlxc_list_for_each(it, network) {\n\t\tif (idx == i++) {\n\t\t\tnetdev = it->elem;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn netdev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "key",
            "'.'"
          ],
          "line": 2491
        },
        "resolved": true,
        "details": {
          "function_name": "strchrnul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/include/getsubopt.c",
          "lines": "28-40",
          "snippet": "char *strchrnul(const char *s, int c)\n{\n    char *result;\n\n    result = strchr( s, c );\n\n    if( !result )\n    {\n        result = (char *)s + strlen( s );\n    }\n\n    return( result );\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n\nchar *strchrnul(const char *s, int c)\n{\n    char *result;\n\n    result = strchr( s, c );\n\n    if( !result )\n    {\n        result = (char *)s + strlen( s );\n    }\n\n    return( result );\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "retv",
            "0",
            "inlen"
          ],
          "line": 2489
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_item_nic(struct lxc_conf *c, char *retv, int inlen,\n\t\t\t    const char *key)\n{\n\tchar *p1;\n\tint len, fulllen = 0;\n\tstruct lxc_netdev *netdev;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tp1 = strchr(key, '.');\n\tif (!p1 || *(p1+1) == '\\0') return -1;\n\tp1++;\n\n\tnetdev = get_netdev_from_key(key, &c->network);\n\tif (!netdev)\n\t\treturn -1;\n\tif (strcmp(p1, \"name\") == 0) {\n\t\tif (netdev->name)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->name);\n\t} else if (strcmp(p1, \"type\") == 0) {\n\t\tstrprint(retv, inlen, \"%s\", lxc_net_type_to_str(netdev->type));\n\t} else if (strcmp(p1, \"link\") == 0) {\n\t\tif (netdev->link)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->link);\n\t} else if (strcmp(p1, \"flags\") == 0) {\n\t\tif (netdev->flags & IFF_UP)\n\t\t\tstrprint(retv, inlen, \"up\");\n\t} else if (strcmp(p1, \"script.up\") == 0) {\n\t\tif (netdev->upscript)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->upscript);\n\t} else if (strcmp(p1, \"script.down\") == 0) {\n\t\tif (netdev->downscript)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->downscript);\n\t} else if (strcmp(p1, \"hwaddr\") == 0) {\n\t\tif (netdev->hwaddr)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->hwaddr);\n\t} else if (strcmp(p1, \"mtu\") == 0) {\n\t\tif (netdev->mtu)\n\t\t\tstrprint(retv, inlen, \"%s\", netdev->mtu);\n\t} else if (strcmp(p1, \"macvlan.mode\") == 0) {\n\t\tif (netdev->type == LXC_NET_MACVLAN) {\n\t\t\tconst char *mode;\n\t\t\tswitch (netdev->priv.macvlan_attr.mode) {\n\t\t\tcase MACVLAN_MODE_PRIVATE: mode = \"private\"; break;\n\t\t\tcase MACVLAN_MODE_VEPA: mode = \"vepa\"; break;\n\t\t\tcase MACVLAN_MODE_BRIDGE: mode = \"bridge\"; break;\n\t\t\tcase MACVLAN_MODE_PASSTHRU: mode = \"passthru\"; break;\n\t\t\tdefault: mode = \"(invalid)\"; break;\n\t\t\t}\n\t\t\tstrprint(retv, inlen, \"%s\", mode);\n\t\t}\n\t} else if (strcmp(p1, \"veth.pair\") == 0) {\n\t\tif (netdev->type == LXC_NET_VETH) {\n\t\t\tstrprint(retv, inlen, \"%s\",\n\t\t\t\t netdev->priv.veth_attr.pair ?\n\t\t\t\t  netdev->priv.veth_attr.pair :\n\t\t\t\t  netdev->priv.veth_attr.veth1);\n\t\t}\n\t} else if (strcmp(p1, \"vlan\") == 0) {\n\t\tif (netdev->type == LXC_NET_VLAN) {\n\t\t\tstrprint(retv, inlen, \"%d\", netdev->priv.vlan_attr.vid);\n\t\t}\n\t} else if (strcmp(p1, \"ipv4.gateway\") == 0) {\n\t\tif (netdev->ipv4_gateway_auto) {\n\t\t\tstrprint(retv, inlen, \"auto\");\n\t\t} else if (netdev->ipv4_gateway) {\n\t\t\tchar buf[INET_ADDRSTRLEN];\n\t\t\tinet_ntop(AF_INET, netdev->ipv4_gateway, buf, sizeof(buf));\n\t\t\tstrprint(retv, inlen, \"%s\", buf);\n\t\t}\n\t} else if (strcmp(p1, \"ipv4\") == 0) {\n\t\tstruct lxc_list *it2;\n\t\tlxc_list_for_each(it2, &netdev->ipv4) {\n\t\t\tstruct lxc_inetdev *i = it2->elem;\n\t\t\tchar buf[INET_ADDRSTRLEN];\n\t\t\tinet_ntop(AF_INET, &i->addr, buf, sizeof(buf));\n\t\t\tstrprint(retv, inlen, \"%s/%d\\n\", buf, i->prefix);\n\t\t}\n\t} else if (strcmp(p1, \"ipv6.gateway\") == 0) {\n\t\tif (netdev->ipv6_gateway_auto) {\n\t\t\tstrprint(retv, inlen, \"auto\");\n\t\t} else if (netdev->ipv6_gateway) {\n\t\t\tchar buf[INET6_ADDRSTRLEN];\n\t\t\tinet_ntop(AF_INET6, netdev->ipv6_gateway, buf, sizeof(buf));\n\t\t\tstrprint(retv, inlen, \"%s\", buf);\n\t\t}\n\t} else if (strcmp(p1, \"ipv6\") == 0) {\n\t\tstruct lxc_list *it2;\n\t\tlxc_list_for_each(it2, &netdev->ipv6) {\n\t\t\tstruct lxc_inet6dev *i = it2->elem;\n\t\t\tchar buf[INET6_ADDRSTRLEN];\n\t\t\tinet_ntop(AF_INET6, &i->addr, buf, sizeof(buf));\n\t\t\tstrprint(retv, inlen, \"%s/%d\\n\", buf, i->prefix);\n\t\t}\n\t}\n\treturn fulllen;\n}"
  },
  {
    "function_name": "lxc_get_auto_mounts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2432-2469",
    "snippet": "static int lxc_get_auto_mounts(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tconst char *sep = \"\";\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tif (!(c->auto_mounts & LXC_AUTO_ALL_MASK))\n\t\treturn 0;\n\n\tswitch (c->auto_mounts & LXC_AUTO_PROC_MASK) {\n\t\tcase LXC_AUTO_PROC_MIXED:         strprint(retv, inlen, \"%sproc:mixed\", sep);        sep = \" \"; break;\n\t\tcase LXC_AUTO_PROC_RW:            strprint(retv, inlen, \"%sproc:rw\", sep);           sep = \" \"; break;\n\t\tdefault: break;\n\t}\n\tswitch (c->auto_mounts & LXC_AUTO_SYS_MASK) {\n\t\tcase LXC_AUTO_SYS_RO:             strprint(retv, inlen, \"%ssys:ro\", sep);            sep = \" \"; break;\n\t\tcase LXC_AUTO_SYS_RW:             strprint(retv, inlen, \"%ssys:rw\", sep);            sep = \" \"; break;\n\t\tcase LXC_AUTO_SYS_MIXED:          strprint(retv, inlen, \"%ssys:mixed\", sep);         sep = \" \"; break;\n\t\tdefault: break;\n\t}\n\tswitch (c->auto_mounts & LXC_AUTO_CGROUP_MASK) {\n\t\tcase LXC_AUTO_CGROUP_NOSPEC:      strprint(retv, inlen, \"%scgroup\", sep);            sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_MIXED:       strprint(retv, inlen, \"%scgroup:mixed\", sep);      sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_RO:          strprint(retv, inlen, \"%scgroup:ro\", sep);         sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_RW:          strprint(retv, inlen, \"%scgroup:rw\", sep);         sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_FULL_NOSPEC: strprint(retv, inlen, \"%scgroup-full\", sep);       sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_FULL_MIXED:  strprint(retv, inlen, \"%scgroup-full:mixed\", sep); sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_FULL_RO:     strprint(retv, inlen, \"%scgroup-full:ro\", sep);    sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_FULL_RW:     strprint(retv, inlen, \"%scgroup-full:rw\", sep);    sep = \" \"; break;\n\t\tdefault: break;\n\t}\n\n\treturn fulllen;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%scgroup-full:rw\"",
            "sep"
          ],
          "line": 2464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%scgroup-full:ro\"",
            "sep"
          ],
          "line": 2463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%scgroup-full:mixed\"",
            "sep"
          ],
          "line": 2462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%scgroup-full\"",
            "sep"
          ],
          "line": 2461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%scgroup:rw\"",
            "sep"
          ],
          "line": 2460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%scgroup:ro\"",
            "sep"
          ],
          "line": 2459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%scgroup:mixed\"",
            "sep"
          ],
          "line": 2458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%scgroup\"",
            "sep"
          ],
          "line": 2457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%ssys:mixed\"",
            "sep"
          ],
          "line": 2453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%ssys:rw\"",
            "sep"
          ],
          "line": 2452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%ssys:ro\"",
            "sep"
          ],
          "line": 2451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%sproc:rw\"",
            "sep"
          ],
          "line": 2447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%sproc:mixed\"",
            "sep"
          ],
          "line": 2446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "retv",
            "0",
            "inlen"
          ],
          "line": 2440
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_auto_mounts(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tconst char *sep = \"\";\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tif (!(c->auto_mounts & LXC_AUTO_ALL_MASK))\n\t\treturn 0;\n\n\tswitch (c->auto_mounts & LXC_AUTO_PROC_MASK) {\n\t\tcase LXC_AUTO_PROC_MIXED:         strprint(retv, inlen, \"%sproc:mixed\", sep);        sep = \" \"; break;\n\t\tcase LXC_AUTO_PROC_RW:            strprint(retv, inlen, \"%sproc:rw\", sep);           sep = \" \"; break;\n\t\tdefault: break;\n\t}\n\tswitch (c->auto_mounts & LXC_AUTO_SYS_MASK) {\n\t\tcase LXC_AUTO_SYS_RO:             strprint(retv, inlen, \"%ssys:ro\", sep);            sep = \" \"; break;\n\t\tcase LXC_AUTO_SYS_RW:             strprint(retv, inlen, \"%ssys:rw\", sep);            sep = \" \"; break;\n\t\tcase LXC_AUTO_SYS_MIXED:          strprint(retv, inlen, \"%ssys:mixed\", sep);         sep = \" \"; break;\n\t\tdefault: break;\n\t}\n\tswitch (c->auto_mounts & LXC_AUTO_CGROUP_MASK) {\n\t\tcase LXC_AUTO_CGROUP_NOSPEC:      strprint(retv, inlen, \"%scgroup\", sep);            sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_MIXED:       strprint(retv, inlen, \"%scgroup:mixed\", sep);      sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_RO:          strprint(retv, inlen, \"%scgroup:ro\", sep);         sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_RW:          strprint(retv, inlen, \"%scgroup:rw\", sep);         sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_FULL_NOSPEC: strprint(retv, inlen, \"%scgroup-full\", sep);       sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_FULL_MIXED:  strprint(retv, inlen, \"%scgroup-full:mixed\", sep); sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_FULL_RO:     strprint(retv, inlen, \"%scgroup-full:ro\", sep);    sep = \" \"; break;\n\t\tcase LXC_AUTO_CGROUP_FULL_RW:     strprint(retv, inlen, \"%scgroup-full:rw\", sep);    sep = \" \"; break;\n\t\tdefault: break;\n\t}\n\n\treturn fulllen;\n}"
  },
  {
    "function_name": "lxc_get_mount_entries",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2416-2430",
    "snippet": "static int lxc_get_mount_entries(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->mount_list) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\\n\"",
            "(char *)it->elem"
          ],
          "line": 2427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_list_for_each",
          "args": [
            "it",
            "&c->mount_list"
          ],
          "line": 2426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "retv",
            "0",
            "inlen"
          ],
          "line": 2424
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_mount_entries(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->mount_list) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}"
  },
  {
    "function_name": "lxc_get_item_cap_keep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2400-2414",
    "snippet": "static int lxc_get_item_cap_keep(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->keepcaps) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\\n\"",
            "(char *)it->elem"
          ],
          "line": 2411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_list_for_each",
          "args": [
            "it",
            "&c->keepcaps"
          ],
          "line": 2410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "retv",
            "0",
            "inlen"
          ],
          "line": 2408
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_item_cap_keep(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->keepcaps) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}"
  },
  {
    "function_name": "lxc_get_item_cap_drop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2384-2398",
    "snippet": "static int lxc_get_item_cap_drop(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->caps) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\\n\"",
            "(char *)it->elem"
          ],
          "line": 2395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_list_for_each",
          "args": [
            "it",
            "&c->caps"
          ],
          "line": 2394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "retv",
            "0",
            "inlen"
          ],
          "line": 2392
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_item_cap_drop(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->caps) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}"
  },
  {
    "function_name": "lxc_get_item_environment",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2368-2382",
    "snippet": "static int lxc_get_item_environment(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->environment) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\\n\"",
            "(char *)it->elem"
          ],
          "line": 2379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_list_for_each",
          "args": [
            "it",
            "&c->environment"
          ],
          "line": 2378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "retv",
            "0",
            "inlen"
          ],
          "line": 2376
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_item_environment(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->environment) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}"
  },
  {
    "function_name": "lxc_get_item_groups",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2352-2366",
    "snippet": "static int lxc_get_item_groups(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->groups) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\\n\"",
            "(char *)it->elem"
          ],
          "line": 2363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_list_for_each",
          "args": [
            "it",
            "&c->groups"
          ],
          "line": 2362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "retv",
            "0",
            "inlen"
          ],
          "line": 2360
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_item_groups(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint len, fulllen = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->groups) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}"
  },
  {
    "function_name": "lxc_get_item_hooks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2316-2350",
    "snippet": "static int lxc_get_item_hooks(struct lxc_conf *c, char *retv, int inlen,\n\t\t\t      const char *key)\n{\n\tchar *subkey;\n\tint len, fulllen = 0, found = -1;\n\tstruct lxc_list *it;\n\tint i;\n\n\t/* \"lxc.hook.mount\" */\n\tsubkey = strchr(key, '.');\n\tif (subkey) subkey = strchr(subkey+1, '.');\n\tif (!subkey)\n\t\treturn -1;\n\tsubkey++;\n\tif (!*subkey)\n\t\treturn -1;\n\tfor (i=0; i<NUM_LXC_HOOKS; i++) {\n\t\tif (strcmp(lxchook_names[i], subkey) == 0) {\n\t\t\tfound=i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (found == -1)\n\t\treturn -1;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->hooks[found]) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\\n\"",
            "(char *)it->elem"
          ],
          "line": 2347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_list_for_each",
          "args": [
            "it",
            "&c->hooks[found]"
          ],
          "line": 2346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "retv",
            "0",
            "inlen"
          ],
          "line": 2344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "lxchook_names[i]",
            "subkey"
          ],
          "line": 2333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "subkey+1",
            "'.'"
          ],
          "line": 2326
        },
        "resolved": true,
        "details": {
          "function_name": "strchrnul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/include/getsubopt.c",
          "lines": "28-40",
          "snippet": "char *strchrnul(const char *s, int c)\n{\n    char *result;\n\n    result = strchr( s, c );\n\n    if( !result )\n    {\n        result = (char *)s + strlen( s );\n    }\n\n    return( result );\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n\nchar *strchrnul(const char *s, int c)\n{\n    char *result;\n\n    result = strchr( s, c );\n\n    if( !result )\n    {\n        result = (char *)s + strlen( s );\n    }\n\n    return( result );\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_item_hooks(struct lxc_conf *c, char *retv, int inlen,\n\t\t\t      const char *key)\n{\n\tchar *subkey;\n\tint len, fulllen = 0, found = -1;\n\tstruct lxc_list *it;\n\tint i;\n\n\t/* \"lxc.hook.mount\" */\n\tsubkey = strchr(key, '.');\n\tif (subkey) subkey = strchr(subkey+1, '.');\n\tif (!subkey)\n\t\treturn -1;\n\tsubkey++;\n\tif (!*subkey)\n\t\treturn -1;\n\tfor (i=0; i<NUM_LXC_HOOKS; i++) {\n\t\tif (strcmp(lxchook_names[i], subkey) == 0) {\n\t\t\tfound=i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (found == -1)\n\t\treturn -1;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tlxc_list_for_each(it, &c->hooks[found]) {\n\t\tstrprint(retv, inlen, \"%s\\n\", (char *)it->elem);\n\t}\n\treturn fulllen;\n}"
  },
  {
    "function_name": "lxc_get_cgroup_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2290-2314",
    "snippet": "static int lxc_get_cgroup_entry(struct lxc_conf *c, char *retv, int inlen,\n\t\t\t\tconst char *key)\n{\n\tint fulllen = 0, len;\n\tint all = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tif (strcmp(key, \"all\") == 0)\n\t\tall = 1;\n\n\tlxc_list_for_each(it, &c->cgroup) {\n\t\tstruct lxc_cgroup *cg = it->elem;\n\t\tif (all) {\n\t\t\tstrprint(retv, inlen, \"lxc.cgroup.%s = %s\\n\", cg->subsystem, cg->value);\n\t\t} else if (strcmp(cg->subsystem, key) == 0) {\n\t\t\tstrprint(retv, inlen, \"%s\\n\", cg->value);\n\t\t}\n\t}\n\treturn fulllen;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\\n\"",
            "cg->value"
          ],
          "line": 2310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "cg->subsystem",
            "key"
          ],
          "line": 2309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"lxc.cgroup.%s = %s\\n\"",
            "cg->subsystem",
            "cg->value"
          ],
          "line": 2308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_list_for_each",
          "args": [
            "it",
            "&c->cgroup"
          ],
          "line": 2305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"all\""
          ],
          "line": 2302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "retv",
            "0",
            "inlen"
          ],
          "line": 2300
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int lxc_get_cgroup_entry(struct lxc_conf *c, char *retv, int inlen,\n\t\t\t\tconst char *key)\n{\n\tint fulllen = 0, len;\n\tint all = 0;\n\tstruct lxc_list *it;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tif (strcmp(key, \"all\") == 0)\n\t\tall = 1;\n\n\tlxc_list_for_each(it, &c->cgroup) {\n\t\tstruct lxc_cgroup *cg = it->elem;\n\t\tif (all) {\n\t\t\tstrprint(retv, inlen, \"lxc.cgroup.%s = %s\\n\", cg->subsystem, cg->value);\n\t\t} else if (strcmp(cg->subsystem, key) == 0) {\n\t\t\tstrprint(retv, inlen, \"%s\\n\", cg->value);\n\t\t}\n\t}\n\treturn fulllen;\n}"
  },
  {
    "function_name": "lxc_get_arch_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2259-2279",
    "snippet": "static int lxc_get_arch_entry(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint fulllen = 0;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\t#if HAVE_SYS_PERSONALITY_H\n\tint len = 0;\n\n\tswitch(c->personality) {\n\tcase PER_LINUX32: strprint(retv, inlen, \"i686\"); break;\n\tcase PER_LINUX: strprint(retv, inlen, \"x86_64\"); break;\n\tdefault: break;\n\t}\n\t#endif\n\n\treturn fulllen;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"x86_64\""
          ],
          "line": 2273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"i686\""
          ],
          "line": 2272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "retv",
            "0",
            "inlen"
          ],
          "line": 2266
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_arch_entry(struct lxc_conf *c, char *retv, int inlen)\n{\n\tint fulllen = 0;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\t#if HAVE_SYS_PERSONALITY_H\n\tint len = 0;\n\n\tswitch(c->personality) {\n\tcase PER_LINUX32: strprint(retv, inlen, \"i686\"); break;\n\tcase PER_LINUX: strprint(retv, inlen, \"x86_64\"); break;\n\tdefault: break;\n\t}\n\t#endif\n\n\treturn fulllen;\n}"
  },
  {
    "function_name": "lxc_get_conf_int",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2250-2257",
    "snippet": "static int lxc_get_conf_int(struct lxc_conf *c, char *retv, int inlen, int v)\n{\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\treturn snprintf(retv, inlen, \"%d\", v);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "retv",
            "inlen",
            "\"%d\"",
            "v"
          ],
          "line": 2256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "retv",
            "0",
            "inlen"
          ],
          "line": 2255
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_get_conf_int(struct lxc_conf *c, char *retv, int inlen, int v)\n{\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\treturn snprintf(retv, inlen, \"%d\", v);\n}"
  },
  {
    "function_name": "lxc_fill_elevated_privileges",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2213-2248",
    "snippet": "int lxc_fill_elevated_privileges(char *flaglist, int *flags)\n{\n\tchar *token, *saveptr = NULL;\n\tint i, aflag;\n\tstruct { const char *token; int flag; } all_privs[] = {\n\t\t{ \"CGROUP\",\t\tLXC_ATTACH_MOVE_TO_CGROUP \t},\n\t\t{ \"CAP\",\t\tLXC_ATTACH_DROP_CAPABILITIES \t},\n\t\t{ \"LSM\",\t\tLXC_ATTACH_LSM_EXEC \t\t},\n\t\t{ NULL, 0 }\n\t};\n\n\tif (!flaglist) {\n\t\t/* for the sake of backward compatibility, drop all privileges\n\t\t   if none is specified */\n\t\tfor (i = 0; all_privs[i].token; i++) {\n\t\t\t*flags |= all_privs[i].flag;\n\t\t}\n\t\treturn 0;\n\t}\n\n\ttoken = strtok_r(flaglist, \"|\", &saveptr);\n\twhile (token) {\n\t\taflag = -1;\n\t\tfor (i = 0; all_privs[i].token; i++) {\n\t\t\tif (!strcmp(all_privs[i].token, token))\n\t\t\t\taflag = all_privs[i].flag;\n\t\t}\n\t\tif (aflag < 0)\n\t\t\treturn -1;\n\n\t\t*flags |= aflag;\n\n\t\ttoken = strtok_r(NULL, \"|\", &saveptr);\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "NULL",
            "\"|\"",
            "&saveptr"
          ],
          "line": 2245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "all_privs[i].token",
            "token"
          ],
          "line": 2237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "flaglist",
            "\"|\"",
            "&saveptr"
          ],
          "line": 2233
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nint lxc_fill_elevated_privileges(char *flaglist, int *flags)\n{\n\tchar *token, *saveptr = NULL;\n\tint i, aflag;\n\tstruct { const char *token; int flag; } all_privs[] = {\n\t\t{ \"CGROUP\",\t\tLXC_ATTACH_MOVE_TO_CGROUP \t},\n\t\t{ \"CAP\",\t\tLXC_ATTACH_DROP_CAPABILITIES \t},\n\t\t{ \"LSM\",\t\tLXC_ATTACH_LSM_EXEC \t\t},\n\t\t{ NULL, 0 }\n\t};\n\n\tif (!flaglist) {\n\t\t/* for the sake of backward compatibility, drop all privileges\n\t\t   if none is specified */\n\t\tfor (i = 0; all_privs[i].token; i++) {\n\t\t\t*flags |= all_privs[i].flag;\n\t\t}\n\t\treturn 0;\n\t}\n\n\ttoken = strtok_r(flaglist, \"|\", &saveptr);\n\twhile (token) {\n\t\taflag = -1;\n\t\tfor (i = 0; all_privs[i].token; i++) {\n\t\t\tif (!strcmp(all_privs[i].token, token))\n\t\t\t\taflag = all_privs[i].flag;\n\t\t}\n\t\tif (aflag < 0)\n\t\t\treturn -1;\n\n\t\t*flags |= aflag;\n\n\t\ttoken = strtok_r(NULL, \"|\", &saveptr);\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "lxc_config_parse_arch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2165-2211",
    "snippet": "signed long lxc_config_parse_arch(const char *arch)\n{\n\t#if HAVE_SYS_PERSONALITY_H\n\tstruct per_name {\n\t\tchar *name;\n\t\tunsigned long per;\n\t} pername[] = {\n\t\t{ \"x86\", PER_LINUX32 },\n\t\t{ \"linux32\", PER_LINUX32 },\n\t\t{ \"i386\", PER_LINUX32 },\n\t\t{ \"i486\", PER_LINUX32 },\n\t\t{ \"i586\", PER_LINUX32 },\n\t\t{ \"i686\", PER_LINUX32 },\n\t\t{ \"athlon\", PER_LINUX32 },\n\t\t{ \"mips\", PER_LINUX32 },\n\t\t{ \"mipsel\", PER_LINUX32 },\n\t\t{ \"ppc\", PER_LINUX32 },\n\t\t{ \"arm\", PER_LINUX32 },\n\t\t{ \"armv7l\", PER_LINUX32 },\n\t\t{ \"armhf\", PER_LINUX32 },\n\t\t{ \"armel\", PER_LINUX32 },\n\t\t{ \"powerpc\", PER_LINUX32 },\n\t\t{ \"linux64\", PER_LINUX },\n\t\t{ \"x86_64\", PER_LINUX },\n\t\t{ \"amd64\", PER_LINUX },\n\t\t{ \"mips64\", PER_LINUX },\n\t\t{ \"mips64el\", PER_LINUX },\n\t\t{ \"ppc64\", PER_LINUX },\n\t\t{ \"ppc64le\", PER_LINUX },\n\t\t{ \"ppc64el\", PER_LINUX },\n\t\t{ \"powerpc64\", PER_LINUX },\n\t\t{ \"s390x\", PER_LINUX },\n\t\t{ \"aarch64\", PER_LINUX },\n\t\t{ \"arm64\", PER_LINUX },\n\t};\n\tsize_t len = sizeof(pername) / sizeof(pername[0]);\n\n\tsize_t i;\n\n\tfor (i = 0; i < len; i++) {\n\t\tif (!strcmp(pername[i].name, arch))\n\t\t    return pername[i].per;\n\t}\n\t#endif\n\n\treturn -1;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "pername[i].name",
            "arch"
          ],
          "line": 2205
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nsigned long lxc_config_parse_arch(const char *arch)\n{\n\t#if HAVE_SYS_PERSONALITY_H\n\tstruct per_name {\n\t\tchar *name;\n\t\tunsigned long per;\n\t} pername[] = {\n\t\t{ \"x86\", PER_LINUX32 },\n\t\t{ \"linux32\", PER_LINUX32 },\n\t\t{ \"i386\", PER_LINUX32 },\n\t\t{ \"i486\", PER_LINUX32 },\n\t\t{ \"i586\", PER_LINUX32 },\n\t\t{ \"i686\", PER_LINUX32 },\n\t\t{ \"athlon\", PER_LINUX32 },\n\t\t{ \"mips\", PER_LINUX32 },\n\t\t{ \"mipsel\", PER_LINUX32 },\n\t\t{ \"ppc\", PER_LINUX32 },\n\t\t{ \"arm\", PER_LINUX32 },\n\t\t{ \"armv7l\", PER_LINUX32 },\n\t\t{ \"armhf\", PER_LINUX32 },\n\t\t{ \"armel\", PER_LINUX32 },\n\t\t{ \"powerpc\", PER_LINUX32 },\n\t\t{ \"linux64\", PER_LINUX },\n\t\t{ \"x86_64\", PER_LINUX },\n\t\t{ \"amd64\", PER_LINUX },\n\t\t{ \"mips64\", PER_LINUX },\n\t\t{ \"mips64el\", PER_LINUX },\n\t\t{ \"ppc64\", PER_LINUX },\n\t\t{ \"ppc64le\", PER_LINUX },\n\t\t{ \"ppc64el\", PER_LINUX },\n\t\t{ \"powerpc64\", PER_LINUX },\n\t\t{ \"s390x\", PER_LINUX },\n\t\t{ \"aarch64\", PER_LINUX },\n\t\t{ \"arm64\", PER_LINUX },\n\t};\n\tsize_t len = sizeof(pername) / sizeof(pername[0]);\n\n\tsize_t i;\n\n\tfor (i = 0; i < len; i++) {\n\t\tif (!strcmp(pername[i].name, arch))\n\t\t    return pername[i].per;\n\t}\n\t#endif\n\n\treturn -1;\n}"
  },
  {
    "function_name": "lxc_config_define_load",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2146-2163",
    "snippet": "int lxc_config_define_load(struct lxc_list *defines, struct lxc_conf *conf)\n{\n\tstruct lxc_list *it,*next;\n\tint ret = 0;\n\n\tlxc_list_for_each(it, defines) {\n\t\tret = lxc_config_readline(it->elem, conf);\n\t\tif (ret)\n\t\t\tbreak;\n\t}\n\n\tlxc_list_for_each_safe(it, defines, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "it"
          ],
          "line": 2159
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_list_del",
          "args": [
            "it"
          ],
          "line": 2158
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "148-156",
          "snippet": "static inline void lxc_list_del(struct lxc_list *list)\n{\n\tstruct lxc_list *next, *prev;\n\n\tnext = list->next;\n\tprev = list->prev;\n\tnext->prev = prev;\n\tprev->next = next;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void lxc_list_del(struct lxc_list *list)\n{\n\tstruct lxc_list *next, *prev;\n\n\tnext = list->next;\n\tprev = list->prev;\n\tnext->prev = prev;\n\tprev->next = next;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_list_for_each_safe",
          "args": [
            "it",
            "defines",
            "next"
          ],
          "line": 2157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_config_readline",
          "args": [
            "it->elem",
            "conf"
          ],
          "line": 2152
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_config_readline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2105-2113",
          "snippet": "static int lxc_config_readline(char *buffer, struct lxc_conf *conf)\n{\n\tstruct parse_line_conf c;\n\n\tc.conf = conf;\n\tc.from_include = false;\n\n\treturn parse_line(buffer, &c);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_config_readline(char *buffer, struct lxc_conf *conf)\n{\n\tstruct parse_line_conf c;\n\n\tc.conf = conf;\n\tc.from_include = false;\n\n\treturn parse_line(buffer, &c);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_list_for_each",
          "args": [
            "it",
            "defines"
          ],
          "line": 2151
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nint lxc_config_define_load(struct lxc_list *defines, struct lxc_conf *conf)\n{\n\tstruct lxc_list *it,*next;\n\tint ret = 0;\n\n\tlxc_list_for_each(it, defines) {\n\t\tret = lxc_config_readline(it->elem, conf);\n\t\tif (ret)\n\t\t\tbreak;\n\t}\n\n\tlxc_list_for_each_safe(it, defines, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "lxc_config_define_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2133-2144",
    "snippet": "int lxc_config_define_add(struct lxc_list *defines, char* arg)\n{\n\tstruct lxc_list *dent;\n\n\tdent = malloc(sizeof(struct lxc_list));\n\tif (!dent)\n\t\treturn -1;\n\n\tdent->elem = arg;\n\tlxc_list_add_tail(defines, dent);\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_list_add_tail",
          "args": [
            "defines",
            "dent"
          ],
          "line": 2142
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_add_tail",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "133-137",
          "snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(struct lxc_list)"
          ],
          "line": 2137
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nint lxc_config_define_add(struct lxc_list *defines, char* arg)\n{\n\tstruct lxc_list *dent;\n\n\tdent = malloc(sizeof(struct lxc_list));\n\tif (!dent)\n\t\treturn -1;\n\n\tdent->elem = arg;\n\tlxc_list_add_tail(defines, dent);\n\treturn 0;\n}"
  },
  {
    "function_name": "lxc_config_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2115-2131",
    "snippet": "int lxc_config_read(const char *file, struct lxc_conf *conf, bool from_include)\n{\n\tstruct parse_line_conf c;\n\n\tc.conf = conf;\n\tc.from_include = from_include;\n\n\tif( access(file, R_OK) == -1 ) {\n\t\treturn -1;\n\t}\n\n\t/* Catch only the top level config file name in the structure */\n\tif(!conf->rcfile)\n\t\tconf->rcfile = strdup(file);\n\n\treturn lxc_file_for_each_line(file, parse_line, &c);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_file_for_each_line",
          "args": [
            "file",
            "parse_line",
            "&c"
          ],
          "line": 2130
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_file_for_each_line",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/parse.c",
          "lines": "38-65",
          "snippet": "int lxc_file_for_each_line(const char *file, lxc_file_cb callback, void *data)\n{\n\tFILE *f;\n\tint err = 0;\n\tchar *line = NULL;\n\tsize_t len = 0;\n\n\tf = fopen(file, \"r\");\n\tif (!f) {\n\t\tSYSERROR(\"failed to open %s\", file);\n\t\treturn -1;\n\t}\n\n\twhile (getline(&line, &len, f) != -1) {\n\t\terr = callback(line, data);\n\t\tif (err) {\n\t\t\t// callback rv > 0 means stop here\n\t\t\t// callback rv < 0 means error\n\t\t\tif (err < 0)\n\t\t\t\tERROR(\"Failed to parse config: %s\", line);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tfree(line);\n\tfclose(f);\n\treturn err;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include <dirent.h>",
            "#include <errno.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"utils.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include <dirent.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdio.h>\n\nint lxc_file_for_each_line(const char *file, lxc_file_cb callback, void *data)\n{\n\tFILE *f;\n\tint err = 0;\n\tchar *line = NULL;\n\tsize_t len = 0;\n\n\tf = fopen(file, \"r\");\n\tif (!f) {\n\t\tSYSERROR(\"failed to open %s\", file);\n\t\treturn -1;\n\t}\n\n\twhile (getline(&line, &len, f) != -1) {\n\t\terr = callback(line, data);\n\t\tif (err) {\n\t\t\t// callback rv > 0 means stop here\n\t\t\t// callback rv < 0 means error\n\t\t\tif (err < 0)\n\t\t\t\tERROR(\"Failed to parse config: %s\", line);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tfree(line);\n\tfclose(f);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "file"
          ],
          "line": 2128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "file",
            "R_OK"
          ],
          "line": 2122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};\n\nint lxc_config_read(const char *file, struct lxc_conf *conf, bool from_include)\n{\n\tstruct parse_line_conf c;\n\n\tc.conf = conf;\n\tc.from_include = from_include;\n\n\tif( access(file, R_OK) == -1 ) {\n\t\treturn -1;\n\t}\n\n\t/* Catch only the top level config file name in the structure */\n\tif(!conf->rcfile)\n\t\tconf->rcfile = strdup(file);\n\n\treturn lxc_file_for_each_line(file, parse_line, &c);\n}"
  },
  {
    "function_name": "lxc_config_readline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2105-2113",
    "snippet": "static int lxc_config_readline(char *buffer, struct lxc_conf *conf)\n{\n\tstruct parse_line_conf c;\n\n\tc.conf = conf;\n\tc.from_include = false;\n\n\treturn parse_line(buffer, &c);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "parse_line",
          "args": [
            "buffer",
            "&c"
          ],
          "line": 2112
        },
        "resolved": true,
        "details": {
          "function_name": "parse_line",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2030-2103",
          "snippet": "static int parse_line(char *buffer, void *data)\n{\n\tstruct lxc_config_t *config;\n\tchar *line, *linep;\n\tchar *dot;\n\tchar *key;\n\tchar *value;\n\tint ret = 0;\n\tstruct parse_line_conf *plc = data;\n\n\tif (lxc_is_line_empty(buffer))\n\t\treturn 0;\n\n\t/* we have to dup the buffer otherwise, at the re-exec for\n\t * reboot we modified the original string on the stack by\n\t * replacing '=' by '\\0' below\n\t */\n\tlinep = line = strdup(buffer);\n\tif (!line) {\n\t\tSYSERROR(\"failed to allocate memory for '%s'\", buffer);\n\t\treturn -1;\n\t}\n\n\tif (!plc->from_include)\n\t\tif ((ret = append_unexp_config_line(line, plc->conf)))\n\t\t\tgoto out;\n\n\tline += lxc_char_left_gc(line, strlen(line));\n\n\t/* ignore comments */\n\tif (line[0] == '#')\n\t\tgoto out;\n\n\t/* martian option - don't add it to the config itself */\n\tif (strncmp(line, \"lxc.\", 4))\n\t\tgoto out;\n\n\tret = -1;\n\n\tdot = strstr(line, \"=\");\n\tif (!dot) {\n\t\tERROR(\"invalid configuration line: %s\", line);\n\t\tgoto out;\n\t}\n\n\t*dot = '\\0';\n\tvalue = dot + 1;\n\n\tkey = line;\n\tkey[lxc_char_right_gc(key, strlen(key))] = '\\0';\n\n\tvalue += lxc_char_left_gc(value, strlen(value));\n\tvalue[lxc_char_right_gc(value, strlen(value))] = '\\0';\n\n\tif (*value == '\\'' || *value == '\\\"') {\n\t\tsize_t len = strlen(value);\n\t\tif (len > 1 && value[len-1] == *value) {\n\t\t\tvalue[len-1] = '\\0';\n\t\t\tvalue++;\n\t\t}\n\t}\n\n\tconfig = lxc_getconfig(key);\n\tif (!config) {\n\t\tERROR(\"unknown key %s\", key);\n\t\tgoto out;\n\t}\n\n\tret = config->cb(key, value, plc->conf);\n\nout:\n\tfree(linep);\n\treturn ret;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};",
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int parse_line(char *buffer, void *data)\n{\n\tstruct lxc_config_t *config;\n\tchar *line, *linep;\n\tchar *dot;\n\tchar *key;\n\tchar *value;\n\tint ret = 0;\n\tstruct parse_line_conf *plc = data;\n\n\tif (lxc_is_line_empty(buffer))\n\t\treturn 0;\n\n\t/* we have to dup the buffer otherwise, at the re-exec for\n\t * reboot we modified the original string on the stack by\n\t * replacing '=' by '\\0' below\n\t */\n\tlinep = line = strdup(buffer);\n\tif (!line) {\n\t\tSYSERROR(\"failed to allocate memory for '%s'\", buffer);\n\t\treturn -1;\n\t}\n\n\tif (!plc->from_include)\n\t\tif ((ret = append_unexp_config_line(line, plc->conf)))\n\t\t\tgoto out;\n\n\tline += lxc_char_left_gc(line, strlen(line));\n\n\t/* ignore comments */\n\tif (line[0] == '#')\n\t\tgoto out;\n\n\t/* martian option - don't add it to the config itself */\n\tif (strncmp(line, \"lxc.\", 4))\n\t\tgoto out;\n\n\tret = -1;\n\n\tdot = strstr(line, \"=\");\n\tif (!dot) {\n\t\tERROR(\"invalid configuration line: %s\", line);\n\t\tgoto out;\n\t}\n\n\t*dot = '\\0';\n\tvalue = dot + 1;\n\n\tkey = line;\n\tkey[lxc_char_right_gc(key, strlen(key))] = '\\0';\n\n\tvalue += lxc_char_left_gc(value, strlen(value));\n\tvalue[lxc_char_right_gc(value, strlen(value))] = '\\0';\n\n\tif (*value == '\\'' || *value == '\\\"') {\n\t\tsize_t len = strlen(value);\n\t\tif (len > 1 && value[len-1] == *value) {\n\t\t\tvalue[len-1] = '\\0';\n\t\t\tvalue++;\n\t\t}\n\t}\n\n\tconfig = lxc_getconfig(key);\n\tif (!config) {\n\t\tERROR(\"unknown key %s\", key);\n\t\tgoto out;\n\t}\n\n\tret = config->cb(key, value, plc->conf);\n\nout:\n\tfree(linep);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int lxc_config_readline(char *buffer, struct lxc_conf *conf)\n{\n\tstruct parse_line_conf c;\n\n\tc.conf = conf;\n\tc.from_include = false;\n\n\treturn parse_line(buffer, &c);\n}"
  },
  {
    "function_name": "parse_line",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2030-2103",
    "snippet": "static int parse_line(char *buffer, void *data)\n{\n\tstruct lxc_config_t *config;\n\tchar *line, *linep;\n\tchar *dot;\n\tchar *key;\n\tchar *value;\n\tint ret = 0;\n\tstruct parse_line_conf *plc = data;\n\n\tif (lxc_is_line_empty(buffer))\n\t\treturn 0;\n\n\t/* we have to dup the buffer otherwise, at the re-exec for\n\t * reboot we modified the original string on the stack by\n\t * replacing '=' by '\\0' below\n\t */\n\tlinep = line = strdup(buffer);\n\tif (!line) {\n\t\tSYSERROR(\"failed to allocate memory for '%s'\", buffer);\n\t\treturn -1;\n\t}\n\n\tif (!plc->from_include)\n\t\tif ((ret = append_unexp_config_line(line, plc->conf)))\n\t\t\tgoto out;\n\n\tline += lxc_char_left_gc(line, strlen(line));\n\n\t/* ignore comments */\n\tif (line[0] == '#')\n\t\tgoto out;\n\n\t/* martian option - don't add it to the config itself */\n\tif (strncmp(line, \"lxc.\", 4))\n\t\tgoto out;\n\n\tret = -1;\n\n\tdot = strstr(line, \"=\");\n\tif (!dot) {\n\t\tERROR(\"invalid configuration line: %s\", line);\n\t\tgoto out;\n\t}\n\n\t*dot = '\\0';\n\tvalue = dot + 1;\n\n\tkey = line;\n\tkey[lxc_char_right_gc(key, strlen(key))] = '\\0';\n\n\tvalue += lxc_char_left_gc(value, strlen(value));\n\tvalue[lxc_char_right_gc(value, strlen(value))] = '\\0';\n\n\tif (*value == '\\'' || *value == '\\\"') {\n\t\tsize_t len = strlen(value);\n\t\tif (len > 1 && value[len-1] == *value) {\n\t\t\tvalue[len-1] = '\\0';\n\t\t\tvalue++;\n\t\t}\n\t}\n\n\tconfig = lxc_getconfig(key);\n\tif (!config) {\n\t\tERROR(\"unknown key %s\", key);\n\t\tgoto out;\n\t}\n\n\tret = config->cb(key, value, plc->conf);\n\nout:\n\tfree(linep);\n\treturn ret;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "linep"
          ],
          "line": 2101
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "config->cb",
          "args": [
            "key",
            "value",
            "plc->conf"
          ],
          "line": 2098
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"unknown key %s\"",
            "key"
          ],
          "line": 2094
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_getconfig",
          "args": [
            "key"
          ],
          "line": 2092
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_getconfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "286-295",
          "snippet": "extern struct lxc_config_t *lxc_getconfig(const char *key)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < config_size; i++)\n\t\tif (!strncmp(config[i].name, key,\n\t\t\t     strlen(config[i].name)))\n\t\t\treturn &config[i];\n\treturn NULL;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};",
            "static const size_t config_size = sizeof(config)/sizeof(struct lxc_config_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};\nstatic const size_t config_size = sizeof(config)/sizeof(struct lxc_config_t);\n\nextern struct lxc_config_t *lxc_getconfig(const char *key)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < config_size; i++)\n\t\tif (!strncmp(config[i].name, key,\n\t\t\t     strlen(config[i].name)))\n\t\t\treturn &config[i];\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 2085
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_char_right_gc",
          "args": [
            "value",
            "strlen(value)"
          ],
          "line": 2082
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_char_right_gc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/parse.c",
          "lines": "79-91",
          "snippet": "int lxc_char_right_gc(const char *buffer, size_t len)\n{\n\tint i;\n\tfor (i = len - 1; i >= 0; i--) {\n\t\tif (buffer[i] == ' '  ||\n\t\t    buffer[i] == '\\t' ||\n\t\t    buffer[i] == '\\n' ||\n\t\t    buffer[i] == '\\0')\n\t\t\tcontinue;\n\t\treturn i + 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include <dirent.h>",
            "#include <errno.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"utils.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include <dirent.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdio.h>\n\nint lxc_char_right_gc(const char *buffer, size_t len)\n{\n\tint i;\n\tfor (i = len - 1; i >= 0; i--) {\n\t\tif (buffer[i] == ' '  ||\n\t\t    buffer[i] == '\\t' ||\n\t\t    buffer[i] == '\\n' ||\n\t\t    buffer[i] == '\\0')\n\t\t\tcontinue;\n\t\treturn i + 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 2082
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_char_left_gc",
          "args": [
            "value",
            "strlen(value)"
          ],
          "line": 2081
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_char_left_gc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/parse.c",
          "lines": "67-77",
          "snippet": "int lxc_char_left_gc(const char *buffer, size_t len)\n{\n\tsize_t i;\n\tfor (i = 0; i < len; i++) {\n\t\tif (buffer[i] == ' ' ||\n\t\t    buffer[i] == '\\t')\n\t\t\tcontinue;\n\t\treturn i;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include <dirent.h>",
            "#include <errno.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"utils.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include <dirent.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdio.h>\n\nint lxc_char_left_gc(const char *buffer, size_t len)\n{\n\tsize_t i;\n\tfor (i = 0; i < len; i++) {\n\t\tif (buffer[i] == ' ' ||\n\t\t    buffer[i] == '\\t')\n\t\t\tcontinue;\n\t\treturn i;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 2081
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "key"
          ],
          "line": 2079
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"invalid configuration line: %s\"",
            "line"
          ],
          "line": 2071
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "line",
            "\"=\""
          ],
          "line": 2069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "line",
            "\"lxc.\"",
            "4"
          ],
          "line": 2064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "line"
          ],
          "line": 2057
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "append_unexp_config_line",
          "args": [
            "line",
            "plc->conf"
          ],
          "line": 2054
        },
        "resolved": true,
        "details": {
          "function_name": "append_unexp_config_line",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "1879-1901",
          "snippet": "int append_unexp_config_line(const char *line, struct lxc_conf *conf)\n{\n\tsize_t len = conf->unexpanded_len, linelen = strlen(line);\n\n\tupdate_hwaddr(line);\n\n\twhile (conf->unexpanded_alloced <= len + linelen + 2) {\n\t\tchar *tmp = realloc(conf->unexpanded_config, conf->unexpanded_alloced + 1024);\n\t\tif (!tmp)\n\t\t\treturn -1;\n\t\tif (!conf->unexpanded_config)\n\t\t\t*tmp = '\\0';\n\t\tconf->unexpanded_config = tmp;\n\t\tconf->unexpanded_alloced += 1024;\n\t}\n\tstrcat(conf->unexpanded_config, line);\n\tconf->unexpanded_len += linelen;\n\tif (line[linelen-1] != '\\n') {\n\t\tstrcat(conf->unexpanded_config, \"\\n\");\n\t\tconf->unexpanded_len++;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nint append_unexp_config_line(const char *line, struct lxc_conf *conf)\n{\n\tsize_t len = conf->unexpanded_len, linelen = strlen(line);\n\n\tupdate_hwaddr(line);\n\n\twhile (conf->unexpanded_alloced <= len + linelen + 2) {\n\t\tchar *tmp = realloc(conf->unexpanded_config, conf->unexpanded_alloced + 1024);\n\t\tif (!tmp)\n\t\t\treturn -1;\n\t\tif (!conf->unexpanded_config)\n\t\t\t*tmp = '\\0';\n\t\tconf->unexpanded_config = tmp;\n\t\tconf->unexpanded_alloced += 1024;\n\t}\n\tstrcat(conf->unexpanded_config, line);\n\tconf->unexpanded_len += linelen;\n\tif (line[linelen-1] != '\\n') {\n\t\tstrcat(conf->unexpanded_config, \"\\n\");\n\t\tconf->unexpanded_len++;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to allocate memory for '%s'\"",
            "buffer"
          ],
          "line": 2049
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "buffer"
          ],
          "line": 2047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_is_line_empty",
          "args": [
            "buffer"
          ],
          "line": 2040
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_is_line_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/parse.c",
          "lines": "93-104",
          "snippet": "int lxc_is_line_empty(const char *line)\n{\n\tint i;\n\tsize_t len = strlen(line);\n\n\tfor (i = 0; i < len; i++)\n\t\tif (line[i] != ' ' && line[i] != '\\t' &&\n\t\t    line[i] != '\\n' && line[i] != '\\r' &&\n\t\t    line[i] != '\\f' && line[i] != '\\0')\n\t\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include <dirent.h>",
            "#include <errno.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"utils.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include <dirent.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdio.h>\n\nint lxc_is_line_empty(const char *line)\n{\n\tint i;\n\tsize_t len = strlen(line);\n\n\tfor (i = 0; i < len; i++)\n\t\tif (line[i] != ' ' && line[i] != '\\t' &&\n\t\t    line[i] != '\\n' && line[i] != '\\r' &&\n\t\t    line[i] != '\\f' && line[i] != '\\0')\n\t\t\treturn 0;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int parse_line(char *buffer, void *data)\n{\n\tstruct lxc_config_t *config;\n\tchar *line, *linep;\n\tchar *dot;\n\tchar *key;\n\tchar *value;\n\tint ret = 0;\n\tstruct parse_line_conf *plc = data;\n\n\tif (lxc_is_line_empty(buffer))\n\t\treturn 0;\n\n\t/* we have to dup the buffer otherwise, at the re-exec for\n\t * reboot we modified the original string on the stack by\n\t * replacing '=' by '\\0' below\n\t */\n\tlinep = line = strdup(buffer);\n\tif (!line) {\n\t\tSYSERROR(\"failed to allocate memory for '%s'\", buffer);\n\t\treturn -1;\n\t}\n\n\tif (!plc->from_include)\n\t\tif ((ret = append_unexp_config_line(line, plc->conf)))\n\t\t\tgoto out;\n\n\tline += lxc_char_left_gc(line, strlen(line));\n\n\t/* ignore comments */\n\tif (line[0] == '#')\n\t\tgoto out;\n\n\t/* martian option - don't add it to the config itself */\n\tif (strncmp(line, \"lxc.\", 4))\n\t\tgoto out;\n\n\tret = -1;\n\n\tdot = strstr(line, \"=\");\n\tif (!dot) {\n\t\tERROR(\"invalid configuration line: %s\", line);\n\t\tgoto out;\n\t}\n\n\t*dot = '\\0';\n\tvalue = dot + 1;\n\n\tkey = line;\n\tkey[lxc_char_right_gc(key, strlen(key))] = '\\0';\n\n\tvalue += lxc_char_left_gc(value, strlen(value));\n\tvalue[lxc_char_right_gc(value, strlen(value))] = '\\0';\n\n\tif (*value == '\\'' || *value == '\\\"') {\n\t\tsize_t len = strlen(value);\n\t\tif (len > 1 && value[len-1] == *value) {\n\t\t\tvalue[len-1] = '\\0';\n\t\t\tvalue++;\n\t\t}\n\t}\n\n\tconfig = lxc_getconfig(key);\n\tif (!config) {\n\t\tERROR(\"unknown key %s\", key);\n\t\tgoto out;\n\t}\n\n\tret = config->cb(key, value, plc->conf);\n\nout:\n\tfree(linep);\n\treturn ret;\n}"
  },
  {
    "function_name": "config_utsname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "2000-2023",
    "snippet": "static int config_utsname(const char *key, const char *value,\n\t\t\t  struct lxc_conf *lxc_conf)\n{\n\tstruct utsname *utsname;\n\n\tutsname = malloc(sizeof(*utsname));\n\tif (!utsname) {\n\t\tSYSERROR(\"failed to allocate memory\");\n\t\treturn -1;\n\t}\n\n\tif (strlen(value) >= sizeof(utsname->nodename)) {\n\t\tERROR(\"node name '%s' is too long\",\n\t\t\t      value);\n\t\tfree(utsname);\n\t\treturn -1;\n\t}\n\n\tstrcpy(utsname->nodename, value);\n\tfree(lxc_conf->utsname);\n\tlxc_conf->utsname = utsname;\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "lxc_conf->utsname"
          ],
          "line": 2019
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "utsname->nodename",
            "value"
          ],
          "line": 2018
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"node name '%s' is too long\"",
            "value"
          ],
          "line": 2012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 2011
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to allocate memory\""
          ],
          "line": 2007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*utsname)"
          ],
          "line": 2005
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_utsname(const char *key, const char *value,\n\t\t\t  struct lxc_conf *lxc_conf)\n{\n\tstruct utsname *utsname;\n\n\tutsname = malloc(sizeof(*utsname));\n\tif (!utsname) {\n\t\tSYSERROR(\"failed to allocate memory\");\n\t\treturn -1;\n\t}\n\n\tif (strlen(value) >= sizeof(utsname->nodename)) {\n\t\tERROR(\"node name '%s' is too long\",\n\t\t\t      value);\n\t\tfree(utsname);\n\t\treturn -1;\n\t}\n\n\tstrcpy(utsname->nodename, value);\n\tfree(lxc_conf->utsname);\n\tlxc_conf->utsname = utsname;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "config_pivotdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1993-1998",
    "snippet": "static int config_pivotdir(const char *key, const char *value,\n\t\t\t   struct lxc_conf *lxc_conf)\n{\n\tWARN(\"lxc.pivotdir is ignored.  It will soon become an error.\");\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "\"lxc.pivotdir is ignored.  It will soon become an error.\""
          ],
          "line": 1996
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_pivotdir(const char *key, const char *value,\n\t\t\t   struct lxc_conf *lxc_conf)\n{\n\tWARN(\"lxc.pivotdir is ignored.  It will soon become an error.\");\n\treturn 0;\n}"
  },
  {
    "function_name": "config_rootfs_backend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1978-1991",
    "snippet": "static int config_rootfs_backend(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tif (strlen(value) == 0) {\n\t\tfree(lxc_conf->rootfs.bdev_type);\n\t\tlxc_conf->rootfs.bdev_type = NULL;\n\t}\n\tif (!is_valid_bdev_type(value)) {\n\t\tERROR(\"Bad rootfs.backend: '%s'\", value);\n\t\treturn -1;\n\t}\n\n\treturn config_string_item(&lxc_conf->rootfs.bdev_type, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_string_item",
          "args": [
            "&lxc_conf->rootfs.bdev_type",
            "value"
          ],
          "line": 1990
        },
        "resolved": true,
        "details": {
          "function_name": "config_string_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "327-346",
          "snippet": "static int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Bad rootfs.backend: '%s'\"",
            "value"
          ],
          "line": 1986
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_valid_bdev_type",
          "args": [
            "value"
          ],
          "line": 1985
        },
        "resolved": true,
        "details": {
          "function_name": "is_valid_bdev_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/bdev/bdev.c",
          "lines": "975-988",
          "snippet": "bool is_valid_bdev_type(const char *type)\n{\n\tif (strcmp(type, \"dir\") == 0 ||\n\t\t\tstrcmp(type, \"btrfs\") == 0 ||\n\t\t\tstrcmp(type, \"aufs\") == 0 ||\n\t\t\tstrcmp(type, \"loop\") == 0 ||\n\t\t\tstrcmp(type, \"lvm\") == 0 ||\n\t\t\tstrcmp(type, \"nbd\") == 0 ||\n\t\t\tstrcmp(type, \"overlayfs\") == 0 ||\n\t\t\tstrcmp(type, \"rbd\") == 0 ||\n\t\t\tstrcmp(type, \"zfs\") == 0)\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"namespace.h\"",
            "#include \"lxczfs.h\"",
            "#include \"lxcrsync.h\"",
            "#include \"lxcrbd.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxcnbd.h\"",
            "#include \"lxcloop.h\"",
            "#include \"lxclvm.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcdir.h\"",
            "#include \"lxcbtrfs.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"lxc.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"config.h\"",
            "#include \"conf.h\"",
            "#include \"bdev.h\"",
            "#include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <sys/prctl.h>",
            "#include <sys/mount.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <sched.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct bdev *bdev_get(const char *type);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include \"parse.h\"\n#include \"namespace.h\"\n#include \"lxczfs.h\"\n#include \"lxcrsync.h\"\n#include \"lxcrbd.h\"\n#include \"lxcoverlay.h\"\n#include \"lxcnbd.h\"\n#include \"lxcloop.h\"\n#include \"lxclvm.h\"\n#include \"lxclock.h\"\n#include \"lxcdir.h\"\n#include \"lxcbtrfs.h\"\n#include \"lxcaufs.h\"\n#include \"lxc.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"config.h\"\n#include \"conf.h\"\n#include \"bdev.h\"\n#include <sys/wait.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <sys/prctl.h>\n#include <sys/mount.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <sched.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n\nstatic struct bdev *bdev_get(const char *type);\n\nbool is_valid_bdev_type(const char *type)\n{\n\tif (strcmp(type, \"dir\") == 0 ||\n\t\t\tstrcmp(type, \"btrfs\") == 0 ||\n\t\t\tstrcmp(type, \"aufs\") == 0 ||\n\t\t\tstrcmp(type, \"loop\") == 0 ||\n\t\t\tstrcmp(type, \"lvm\") == 0 ||\n\t\t\tstrcmp(type, \"nbd\") == 0 ||\n\t\t\tstrcmp(type, \"overlayfs\") == 0 ||\n\t\t\tstrcmp(type, \"rbd\") == 0 ||\n\t\t\tstrcmp(type, \"zfs\") == 0)\n\t\treturn true;\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "lxc_conf->rootfs.bdev_type"
          ],
          "line": 1982
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 1981
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_rootfs_backend(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tif (strlen(value) == 0) {\n\t\tfree(lxc_conf->rootfs.bdev_type);\n\t\tlxc_conf->rootfs.bdev_type = NULL;\n\t}\n\tif (!is_valid_bdev_type(value)) {\n\t\tERROR(\"Bad rootfs.backend: '%s'\", value);\n\t\treturn -1;\n\t}\n\n\treturn config_string_item(&lxc_conf->rootfs.bdev_type, value);\n}"
  },
  {
    "function_name": "config_rootfs_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1972-1976",
    "snippet": "static int config_rootfs_options(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\treturn config_string_item(&lxc_conf->rootfs.options, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_string_item",
          "args": [
            "&lxc_conf->rootfs.options",
            "value"
          ],
          "line": 1975
        },
        "resolved": true,
        "details": {
          "function_name": "config_string_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "327-346",
          "snippet": "static int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_rootfs_options(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\treturn config_string_item(&lxc_conf->rootfs.options, value);\n}"
  },
  {
    "function_name": "config_rootfs_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1966-1970",
    "snippet": "static int config_rootfs_mount(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\treturn config_path_item(&lxc_conf->rootfs.mount, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_path_item",
          "args": [
            "&lxc_conf->rootfs.mount",
            "value"
          ],
          "line": 1969
        },
        "resolved": true,
        "details": {
          "function_name": "config_path_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "359-362",
          "snippet": "static int config_path_item(char **conf_item, const char *value)\n{\n\treturn config_string_item_max(conf_item, value, PATH_MAX);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_path_item(char **conf_item, const char *value)\n{\n\treturn config_string_item_max(conf_item, value, PATH_MAX);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_rootfs_mount(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\treturn config_path_item(&lxc_conf->rootfs.mount, value);\n}"
  },
  {
    "function_name": "config_rootfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1960-1964",
    "snippet": "static int config_rootfs(const char *key, const char *value,\n\t\t\t struct lxc_conf *lxc_conf)\n{\n\treturn config_path_item(&lxc_conf->rootfs.path, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_path_item",
          "args": [
            "&lxc_conf->rootfs.path",
            "value"
          ],
          "line": 1963
        },
        "resolved": true,
        "details": {
          "function_name": "config_path_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "359-362",
          "snippet": "static int config_path_item(char **conf_item, const char *value)\n{\n\treturn config_string_item_max(conf_item, value, PATH_MAX);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_path_item(char **conf_item, const char *value)\n{\n\treturn config_string_item_max(conf_item, value, PATH_MAX);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_rootfs(const char *key, const char *value,\n\t\t\t struct lxc_conf *lxc_conf)\n{\n\treturn config_path_item(&lxc_conf->rootfs.path, value);\n}"
  },
  {
    "function_name": "config_includefile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1951-1958",
    "snippet": "static int config_includefile(const char *key, const char *value,\n\t\t\t  struct lxc_conf *lxc_conf)\n{\n\tif (is_dir(value))\n\t\treturn do_includedir(value, lxc_conf);\n\n\treturn lxc_config_read(value, lxc_conf, true);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_config_read",
          "args": [
            "value",
            "lxc_conf",
            "true"
          ],
          "line": 1957
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_config_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2115-2131",
          "snippet": "int lxc_config_read(const char *file, struct lxc_conf *conf, bool from_include)\n{\n\tstruct parse_line_conf c;\n\n\tc.conf = conf;\n\tc.from_include = from_include;\n\n\tif( access(file, R_OK) == -1 ) {\n\t\treturn -1;\n\t}\n\n\t/* Catch only the top level config file name in the structure */\n\tif(!conf->rcfile)\n\t\tconf->rcfile = strdup(file);\n\n\treturn lxc_file_for_each_line(file, parse_line, &c);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
            "static struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};\n\nint lxc_config_read(const char *file, struct lxc_conf *conf, bool from_include)\n{\n\tstruct parse_line_conf c;\n\n\tc.conf = conf;\n\tc.from_include = from_include;\n\n\tif( access(file, R_OK) == -1 ) {\n\t\treturn -1;\n\t}\n\n\t/* Catch only the top level config file name in the structure */\n\tif(!conf->rcfile)\n\t\tconf->rcfile = strdup(file);\n\n\treturn lxc_file_for_each_line(file, parse_line, &c);\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_includedir",
          "args": [
            "value",
            "lxc_conf"
          ],
          "line": 1955
        },
        "resolved": true,
        "details": {
          "function_name": "do_includedir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "1903-1949",
          "snippet": "static int do_includedir(const char *dirp, struct lxc_conf *lxc_conf)\n{\n\tstruct dirent *direntp;\n\tDIR *dir;\n\tchar path[MAXPATHLEN];\n\tint ret = -1, len;\n\n\tdir = opendir(dirp);\n\tif (!dir) {\n\t\tSYSERROR(\"failed to open '%s'\", dirp);\n\t\treturn -1;\n\t}\n\n\twhile ((direntp = readdir(dir))) {\n\t\tconst char *fnam;\n\t\tif (!direntp)\n\t\t\tbreak;\n\n\t\tfnam = direntp->d_name;\n\t\tif (!strcmp(fnam, \".\"))\n\t\t\tcontinue;\n\n\t\tif (!strcmp(fnam, \"..\"))\n\t\t\tcontinue;\n\n\t\tlen = strlen(fnam);\n\t\tif (len < 6 || strncmp(fnam+len-5, \".conf\", 5) != 0)\n\t\t\tcontinue;\n\t\tlen = snprintf(path, MAXPATHLEN, \"%s/%s\", dirp, fnam);\n\t\tif (len < 0 || len >= MAXPATHLEN) {\n\t\t\tERROR(\"lxc.include filename too long under '%s'\", dirp);\n\t\t\tret = -1;\n\t\t\tgoto out;\n\t\t}\n\n\t\tret = lxc_config_read(path, lxc_conf, true);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t}\n\tret = 0;\n\nout:\n\tif (closedir(dir))\n\t\tWARN(\"lxc.include dir: failed to close directory\");\n\n\treturn ret;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int do_includedir(const char *dirp, struct lxc_conf *lxc_conf)\n{\n\tstruct dirent *direntp;\n\tDIR *dir;\n\tchar path[MAXPATHLEN];\n\tint ret = -1, len;\n\n\tdir = opendir(dirp);\n\tif (!dir) {\n\t\tSYSERROR(\"failed to open '%s'\", dirp);\n\t\treturn -1;\n\t}\n\n\twhile ((direntp = readdir(dir))) {\n\t\tconst char *fnam;\n\t\tif (!direntp)\n\t\t\tbreak;\n\n\t\tfnam = direntp->d_name;\n\t\tif (!strcmp(fnam, \".\"))\n\t\t\tcontinue;\n\n\t\tif (!strcmp(fnam, \"..\"))\n\t\t\tcontinue;\n\n\t\tlen = strlen(fnam);\n\t\tif (len < 6 || strncmp(fnam+len-5, \".conf\", 5) != 0)\n\t\t\tcontinue;\n\t\tlen = snprintf(path, MAXPATHLEN, \"%s/%s\", dirp, fnam);\n\t\tif (len < 0 || len >= MAXPATHLEN) {\n\t\t\tERROR(\"lxc.include filename too long under '%s'\", dirp);\n\t\t\tret = -1;\n\t\t\tgoto out;\n\t\t}\n\n\t\tret = lxc_config_read(path, lxc_conf, true);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t}\n\tret = 0;\n\nout:\n\tif (closedir(dir))\n\t\tWARN(\"lxc.include dir: failed to close directory\");\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_dir",
          "args": [
            "value"
          ],
          "line": 1954
        },
        "resolved": true,
        "details": {
          "function_name": "is_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "1364-1371",
          "snippet": "int is_dir(const char *path)\n{\n\tstruct stat statbuf;\n\tint ret = stat(path, &statbuf);\n\tif (ret == 0 && S_ISDIR(statbuf.st_mode))\n\t\treturn 1;\n\treturn 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "extern bool btrfs_try_remove_subvol(const char *path);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nextern bool btrfs_try_remove_subvol(const char *path);\n\nint is_dir(const char *path)\n{\n\tstruct stat statbuf;\n\tint ret = stat(path, &statbuf);\n\tif (ret == 0 && S_ISDIR(statbuf.st_mode))\n\t\treturn 1;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_includefile(const char *key, const char *value,\n\t\t\t  struct lxc_conf *lxc_conf)\n{\n\tif (is_dir(value))\n\t\treturn do_includedir(value, lxc_conf);\n\n\treturn lxc_config_read(value, lxc_conf, true);\n}"
  },
  {
    "function_name": "do_includedir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1903-1949",
    "snippet": "static int do_includedir(const char *dirp, struct lxc_conf *lxc_conf)\n{\n\tstruct dirent *direntp;\n\tDIR *dir;\n\tchar path[MAXPATHLEN];\n\tint ret = -1, len;\n\n\tdir = opendir(dirp);\n\tif (!dir) {\n\t\tSYSERROR(\"failed to open '%s'\", dirp);\n\t\treturn -1;\n\t}\n\n\twhile ((direntp = readdir(dir))) {\n\t\tconst char *fnam;\n\t\tif (!direntp)\n\t\t\tbreak;\n\n\t\tfnam = direntp->d_name;\n\t\tif (!strcmp(fnam, \".\"))\n\t\t\tcontinue;\n\n\t\tif (!strcmp(fnam, \"..\"))\n\t\t\tcontinue;\n\n\t\tlen = strlen(fnam);\n\t\tif (len < 6 || strncmp(fnam+len-5, \".conf\", 5) != 0)\n\t\t\tcontinue;\n\t\tlen = snprintf(path, MAXPATHLEN, \"%s/%s\", dirp, fnam);\n\t\tif (len < 0 || len >= MAXPATHLEN) {\n\t\t\tERROR(\"lxc.include filename too long under '%s'\", dirp);\n\t\t\tret = -1;\n\t\t\tgoto out;\n\t\t}\n\n\t\tret = lxc_config_read(path, lxc_conf, true);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t}\n\tret = 0;\n\nout:\n\tif (closedir(dir))\n\t\tWARN(\"lxc.include dir: failed to close directory\");\n\n\treturn ret;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "\"lxc.include dir: failed to close directory\""
          ],
          "line": 1946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "closedir",
          "args": [
            "dir"
          ],
          "line": 1945
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_config_read",
          "args": [
            "path",
            "lxc_conf",
            "true"
          ],
          "line": 1938
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_config_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2115-2131",
          "snippet": "int lxc_config_read(const char *file, struct lxc_conf *conf, bool from_include)\n{\n\tstruct parse_line_conf c;\n\n\tc.conf = conf;\n\tc.from_include = from_include;\n\n\tif( access(file, R_OK) == -1 ) {\n\t\treturn -1;\n\t}\n\n\t/* Catch only the top level config file name in the structure */\n\tif(!conf->rcfile)\n\t\tconf->rcfile = strdup(file);\n\n\treturn lxc_file_for_each_line(file, parse_line, &c);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
            "static struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};\n\nint lxc_config_read(const char *file, struct lxc_conf *conf, bool from_include)\n{\n\tstruct parse_line_conf c;\n\n\tc.conf = conf;\n\tc.from_include = from_include;\n\n\tif( access(file, R_OK) == -1 ) {\n\t\treturn -1;\n\t}\n\n\t/* Catch only the top level config file name in the structure */\n\tif(!conf->rcfile)\n\t\tconf->rcfile = strdup(file);\n\n\treturn lxc_file_for_each_line(file, parse_line, &c);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"lxc.include filename too long under '%s'\"",
            "dirp"
          ],
          "line": 1933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "path",
            "MAXPATHLEN",
            "\"%s/%s\"",
            "dirp",
            "fnam"
          ],
          "line": 1931
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "fnam+len-5",
            "\".conf\"",
            "5"
          ],
          "line": 1929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "fnam"
          ],
          "line": 1928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "fnam",
            "\"..\""
          ],
          "line": 1925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "fnam",
            "\".\""
          ],
          "line": 1922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "readdir",
          "args": [
            "dir"
          ],
          "line": 1916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to open '%s'\"",
            "dirp"
          ],
          "line": 1912
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "opendir",
          "args": [
            "dirp"
          ],
          "line": 1910
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int do_includedir(const char *dirp, struct lxc_conf *lxc_conf)\n{\n\tstruct dirent *direntp;\n\tDIR *dir;\n\tchar path[MAXPATHLEN];\n\tint ret = -1, len;\n\n\tdir = opendir(dirp);\n\tif (!dir) {\n\t\tSYSERROR(\"failed to open '%s'\", dirp);\n\t\treturn -1;\n\t}\n\n\twhile ((direntp = readdir(dir))) {\n\t\tconst char *fnam;\n\t\tif (!direntp)\n\t\t\tbreak;\n\n\t\tfnam = direntp->d_name;\n\t\tif (!strcmp(fnam, \".\"))\n\t\t\tcontinue;\n\n\t\tif (!strcmp(fnam, \"..\"))\n\t\t\tcontinue;\n\n\t\tlen = strlen(fnam);\n\t\tif (len < 6 || strncmp(fnam+len-5, \".conf\", 5) != 0)\n\t\t\tcontinue;\n\t\tlen = snprintf(path, MAXPATHLEN, \"%s/%s\", dirp, fnam);\n\t\tif (len < 0 || len >= MAXPATHLEN) {\n\t\t\tERROR(\"lxc.include filename too long under '%s'\", dirp);\n\t\t\tret = -1;\n\t\t\tgoto out;\n\t\t}\n\n\t\tret = lxc_config_read(path, lxc_conf, true);\n\t\tif (ret < 0)\n\t\t\tgoto out;\n\t}\n\tret = 0;\n\nout:\n\tif (closedir(dir))\n\t\tWARN(\"lxc.include dir: failed to close directory\");\n\n\treturn ret;\n}"
  },
  {
    "function_name": "append_unexp_config_line",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1879-1901",
    "snippet": "int append_unexp_config_line(const char *line, struct lxc_conf *conf)\n{\n\tsize_t len = conf->unexpanded_len, linelen = strlen(line);\n\n\tupdate_hwaddr(line);\n\n\twhile (conf->unexpanded_alloced <= len + linelen + 2) {\n\t\tchar *tmp = realloc(conf->unexpanded_config, conf->unexpanded_alloced + 1024);\n\t\tif (!tmp)\n\t\t\treturn -1;\n\t\tif (!conf->unexpanded_config)\n\t\t\t*tmp = '\\0';\n\t\tconf->unexpanded_config = tmp;\n\t\tconf->unexpanded_alloced += 1024;\n\t}\n\tstrcat(conf->unexpanded_config, line);\n\tconf->unexpanded_len += linelen;\n\tif (line[linelen-1] != '\\n') {\n\t\tstrcat(conf->unexpanded_config, \"\\n\");\n\t\tconf->unexpanded_len++;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "conf->unexpanded_config",
            "\"\\n\""
          ],
          "line": 1897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "conf->unexpanded_config",
            "line"
          ],
          "line": 1894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "realloc",
          "args": [
            "conf->unexpanded_config",
            "conf->unexpanded_alloced + 1024"
          ],
          "line": 1886
        },
        "resolved": true,
        "details": {
          "function_name": "must_realloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/cgroups/cgfsng.c",
          "lines": "116-124",
          "snippet": "static void *must_realloc(void *orig, size_t sz)\n{\n\tvoid *ret;\n\n\tdo {\n\t\tret = realloc(orig, sz);\n\t} while (!ret);\n\treturn ret;\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include \"log.h\"",
            "#include \"commands.h\"",
            "#include \"cgroup.h\"",
            "#include \"bdev.h\"",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <grp.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <ctype.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include \"log.h\"\n#include \"commands.h\"\n#include \"cgroup.h\"\n#include \"bdev.h\"\n#include <sys/types.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <grp.h>\n#include <errno.h>\n#include <dirent.h>\n#include <ctype.h>\n#include \"config.h\"\n\nstatic void *must_realloc(void *orig, size_t sz)\n{\n\tvoid *ret;\n\n\tdo {\n\t\tret = realloc(orig, sz);\n\t} while (!ret);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "update_hwaddr",
          "args": [
            "line"
          ],
          "line": 1883
        },
        "resolved": true,
        "details": {
          "function_name": "update_hwaddr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "1858-1877",
          "snippet": "static void update_hwaddr(const char *line)\n{\n\tchar *p;\n\n\tline += lxc_char_left_gc(line, strlen(line));\n\tif (line[0] == '#')\n\t\treturn;\n\tif (strncmp(line, \"lxc.network.hwaddr\", 18) != 0)\n\t\treturn;\n\tp = strchr(line, '=');\n\tif (!p)\n\t\treturn;  // let config_network_hwaddr raise the error\n\tp++;\n\twhile (isblank(*p))\n\t\tp++;\n\tif (!*p)\n\t\treturn;\n\n\trand_complete_hwaddr(p);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void update_hwaddr(const char *line)\n{\n\tchar *p;\n\n\tline += lxc_char_left_gc(line, strlen(line));\n\tif (line[0] == '#')\n\t\treturn;\n\tif (strncmp(line, \"lxc.network.hwaddr\", 18) != 0)\n\t\treturn;\n\tp = strchr(line, '=');\n\tif (!p)\n\t\treturn;  // let config_network_hwaddr raise the error\n\tp++;\n\twhile (isblank(*p))\n\t\tp++;\n\tif (!*p)\n\t\treturn;\n\n\trand_complete_hwaddr(p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "line"
          ],
          "line": 1881
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nint append_unexp_config_line(const char *line, struct lxc_conf *conf)\n{\n\tsize_t len = conf->unexpanded_len, linelen = strlen(line);\n\n\tupdate_hwaddr(line);\n\n\twhile (conf->unexpanded_alloced <= len + linelen + 2) {\n\t\tchar *tmp = realloc(conf->unexpanded_config, conf->unexpanded_alloced + 1024);\n\t\tif (!tmp)\n\t\t\treturn -1;\n\t\tif (!conf->unexpanded_config)\n\t\t\t*tmp = '\\0';\n\t\tconf->unexpanded_config = tmp;\n\t\tconf->unexpanded_alloced += 1024;\n\t}\n\tstrcat(conf->unexpanded_config, line);\n\tconf->unexpanded_len += linelen;\n\tif (line[linelen-1] != '\\n') {\n\t\tstrcat(conf->unexpanded_config, \"\\n\");\n\t\tconf->unexpanded_len++;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "update_hwaddr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1858-1877",
    "snippet": "static void update_hwaddr(const char *line)\n{\n\tchar *p;\n\n\tline += lxc_char_left_gc(line, strlen(line));\n\tif (line[0] == '#')\n\t\treturn;\n\tif (strncmp(line, \"lxc.network.hwaddr\", 18) != 0)\n\t\treturn;\n\tp = strchr(line, '=');\n\tif (!p)\n\t\treturn;  // let config_network_hwaddr raise the error\n\tp++;\n\twhile (isblank(*p))\n\t\tp++;\n\tif (!*p)\n\t\treturn;\n\n\trand_complete_hwaddr(p);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rand_complete_hwaddr",
          "args": [
            "p"
          ],
          "line": 1876
        },
        "resolved": true,
        "details": {
          "function_name": "rand_complete_hwaddr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "636-665",
          "snippet": "static int rand_complete_hwaddr(char *hwaddr)\n{\n\tconst char hex[] = \"0123456789abcdef\";\n\tchar *curs = hwaddr;\n\n#ifndef HAVE_RAND_R\n\trandseed(true);\n#else\n\tunsigned int seed=randseed(false);\n#endif\n\twhile (*curs != '\\0' && *curs != '\\n')\n\t{\n\t\tif ( *curs == 'x' || *curs == 'X' ) {\n\t\t\tif (curs - hwaddr == 1) {\n\t\t\t\t//ensure address is unicast\n#ifdef HAVE_RAND_R\n\t\t\t\t*curs = hex[rand_r(&seed) & 0x0E];\n\t\t\t} else {\n\t\t\t\t*curs = hex[rand_r(&seed) & 0x0F];\n#else\n\t\t\t\t*curs = hex[rand() & 0x0E];\n\t\t\t} else {\n\t\t\t\t*curs = hex[rand() & 0x0F];\n#endif\n\t\t\t}\n\t\t}\n\t\tcurs++;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int rand_complete_hwaddr(char *hwaddr)\n{\n\tconst char hex[] = \"0123456789abcdef\";\n\tchar *curs = hwaddr;\n\n#ifndef HAVE_RAND_R\n\trandseed(true);\n#else\n\tunsigned int seed=randseed(false);\n#endif\n\twhile (*curs != '\\0' && *curs != '\\n')\n\t{\n\t\tif ( *curs == 'x' || *curs == 'X' ) {\n\t\t\tif (curs - hwaddr == 1) {\n\t\t\t\t//ensure address is unicast\n#ifdef HAVE_RAND_R\n\t\t\t\t*curs = hex[rand_r(&seed) & 0x0E];\n\t\t\t} else {\n\t\t\t\t*curs = hex[rand_r(&seed) & 0x0F];\n#else\n\t\t\t\t*curs = hex[rand() & 0x0E];\n\t\t\t} else {\n\t\t\t\t*curs = hex[rand() & 0x0F];\n#endif\n\t\t\t}\n\t\t}\n\t\tcurs++;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "isblank",
          "args": [
            "*p"
          ],
          "line": 1871
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "line",
            "'='"
          ],
          "line": 1867
        },
        "resolved": true,
        "details": {
          "function_name": "strchrnul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/include/getsubopt.c",
          "lines": "28-40",
          "snippet": "char *strchrnul(const char *s, int c)\n{\n    char *result;\n\n    result = strchr( s, c );\n\n    if( !result )\n    {\n        result = (char *)s + strlen( s );\n    }\n\n    return( result );\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n\nchar *strchrnul(const char *s, int c)\n{\n    char *result;\n\n    result = strchr( s, c );\n\n    if( !result )\n    {\n        result = (char *)s + strlen( s );\n    }\n\n    return( result );\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "line",
            "\"lxc.network.hwaddr\"",
            "18"
          ],
          "line": 1865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_char_left_gc",
          "args": [
            "line",
            "strlen(line)"
          ],
          "line": 1862
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_char_left_gc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/parse.c",
          "lines": "67-77",
          "snippet": "int lxc_char_left_gc(const char *buffer, size_t len)\n{\n\tsize_t i;\n\tfor (i = 0; i < len; i++) {\n\t\tif (buffer[i] == ' ' ||\n\t\t    buffer[i] == '\\t')\n\t\t\tcontinue;\n\t\treturn i;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include <dirent.h>",
            "#include <errno.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"utils.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include <dirent.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <string.h>\n#include <stdio.h>\n\nint lxc_char_left_gc(const char *buffer, size_t len)\n{\n\tsize_t i;\n\tfor (i = 0; i < len; i++) {\n\t\tif (buffer[i] == ' ' ||\n\t\t    buffer[i] == '\\t')\n\t\t\tcontinue;\n\t\treturn i;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "line"
          ],
          "line": 1862
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void update_hwaddr(const char *line)\n{\n\tchar *p;\n\n\tline += lxc_char_left_gc(line, strlen(line));\n\tif (line[0] == '#')\n\t\treturn;\n\tif (strncmp(line, \"lxc.network.hwaddr\", 18) != 0)\n\t\treturn;\n\tp = strchr(line, '=');\n\tif (!p)\n\t\treturn;  // let config_network_hwaddr raise the error\n\tp++;\n\twhile (isblank(*p))\n\t\tp++;\n\tif (!*p)\n\t\treturn;\n\n\trand_complete_hwaddr(p);\n}"
  },
  {
    "function_name": "config_console_logfile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1844-1848",
    "snippet": "static int config_console_logfile(const char *key, const char *value,\n\t\t\t  struct lxc_conf *lxc_conf)\n{\n\treturn config_path_item(&lxc_conf->console.log_path, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_path_item",
          "args": [
            "&lxc_conf->console.log_path",
            "value"
          ],
          "line": 1847
        },
        "resolved": true,
        "details": {
          "function_name": "config_path_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "359-362",
          "snippet": "static int config_path_item(char **conf_item, const char *value)\n{\n\treturn config_string_item_max(conf_item, value, PATH_MAX);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_path_item(char **conf_item, const char *value)\n{\n\treturn config_string_item_max(conf_item, value, PATH_MAX);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_console_logfile(const char *key, const char *value,\n\t\t\t  struct lxc_conf *lxc_conf)\n{\n\treturn config_path_item(&lxc_conf->console.log_path, value);\n}"
  },
  {
    "function_name": "config_console",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1838-1842",
    "snippet": "static int config_console(const char *key, const char *value,\n\t\t\t  struct lxc_conf *lxc_conf)\n{\n\treturn config_path_item(&lxc_conf->console.path, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_path_item",
          "args": [
            "&lxc_conf->console.path",
            "value"
          ],
          "line": 1841
        },
        "resolved": true,
        "details": {
          "function_name": "config_path_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "359-362",
          "snippet": "static int config_path_item(char **conf_item, const char *value)\n{\n\treturn config_string_item_max(conf_item, value, PATH_MAX);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_path_item(char **conf_item, const char *value)\n{\n\treturn config_string_item_max(conf_item, value, PATH_MAX);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_console(const char *key, const char *value,\n\t\t\t  struct lxc_conf *lxc_conf)\n{\n\treturn config_path_item(&lxc_conf->console.path, value);\n}"
  },
  {
    "function_name": "config_cap_drop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1792-1836",
    "snippet": "static int config_cap_drop(const char *key, const char *value,\n\t\t\t   struct lxc_conf *lxc_conf)\n{\n\tchar *dropcaps, *dropptr, *sptr, *token;\n\tstruct lxc_list *droplist;\n\tint ret = -1;\n\n\tif (!strlen(value))\n\t\treturn lxc_clear_config_caps(lxc_conf);\n\n\tdropcaps = strdup(value);\n\tif (!dropcaps) {\n\t\tSYSERROR(\"failed to dup '%s'\", value);\n\t\treturn -1;\n\t}\n\n\t/* in case several capability drop is specified in a single line\n\t * split these caps in a single element for the list */\n\tfor (dropptr = dropcaps;;dropptr = NULL) {\n\t\ttoken = strtok_r(dropptr, \" \\t\", &sptr);\n\t\tif (!token) {\n\t\t\tret = 0;\n\t\t\tbreak;\n\t\t}\n\n\t\tdroplist = malloc(sizeof(*droplist));\n\t\tif (!droplist) {\n\t\t\tSYSERROR(\"failed to allocate drop list\");\n\t\t\tbreak;\n\t\t}\n\n\t\tdroplist->elem = strdup(token);\n\t\tif (!droplist->elem) {\n\t\t\tSYSERROR(\"failed to dup '%s'\", token);\n\t\t\tfree(droplist);\n\t\t\tbreak;\n\t\t}\n\n\t\tlxc_list_add_tail(&lxc_conf->caps, droplist);\n\t}\n\n\tfree(dropcaps);\n\n\treturn ret;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "dropcaps"
          ],
          "line": 1833
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_list_add_tail",
          "args": [
            "&lxc_conf->caps",
            "droplist"
          ],
          "line": 1830
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_add_tail",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "133-137",
          "snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to dup '%s'\"",
            "token"
          ],
          "line": 1825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "token"
          ],
          "line": 1823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to allocate drop list\""
          ],
          "line": 1819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*droplist)"
          ],
          "line": 1817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "dropptr",
            "\" \\t\"",
            "&sptr"
          ],
          "line": 1811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to dup '%s'\"",
            "value"
          ],
          "line": 1804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "value"
          ],
          "line": 1802
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_config_caps",
          "args": [
            "lxc_conf"
          ],
          "line": 1800
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_config_caps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4123-4133",
          "snippet": "int lxc_clear_config_caps(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->caps, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int in_caplist(int cap, struct lxc_list *caps);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nstatic int in_caplist(int cap, struct lxc_list *caps);\n\nint lxc_clear_config_caps(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->caps, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 1799
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_cap_drop(const char *key, const char *value,\n\t\t\t   struct lxc_conf *lxc_conf)\n{\n\tchar *dropcaps, *dropptr, *sptr, *token;\n\tstruct lxc_list *droplist;\n\tint ret = -1;\n\n\tif (!strlen(value))\n\t\treturn lxc_clear_config_caps(lxc_conf);\n\n\tdropcaps = strdup(value);\n\tif (!dropcaps) {\n\t\tSYSERROR(\"failed to dup '%s'\", value);\n\t\treturn -1;\n\t}\n\n\t/* in case several capability drop is specified in a single line\n\t * split these caps in a single element for the list */\n\tfor (dropptr = dropcaps;;dropptr = NULL) {\n\t\ttoken = strtok_r(dropptr, \" \\t\", &sptr);\n\t\tif (!token) {\n\t\t\tret = 0;\n\t\t\tbreak;\n\t\t}\n\n\t\tdroplist = malloc(sizeof(*droplist));\n\t\tif (!droplist) {\n\t\t\tSYSERROR(\"failed to allocate drop list\");\n\t\t\tbreak;\n\t\t}\n\n\t\tdroplist->elem = strdup(token);\n\t\tif (!droplist->elem) {\n\t\t\tSYSERROR(\"failed to dup '%s'\", token);\n\t\t\tfree(droplist);\n\t\t\tbreak;\n\t\t}\n\n\t\tlxc_list_add_tail(&lxc_conf->caps, droplist);\n\t}\n\n\tfree(dropcaps);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "config_cap_keep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1743-1790",
    "snippet": "static int config_cap_keep(const char *key, const char *value,\n\t\t\t   struct lxc_conf *lxc_conf)\n{\n\tchar *keepcaps, *keepptr, *sptr, *token;\n\tstruct lxc_list *keeplist;\n\tint ret = -1;\n\n\tif (!strlen(value))\n\t\treturn lxc_clear_config_keepcaps(lxc_conf);\n\n\tkeepcaps = strdup(value);\n\tif (!keepcaps) {\n\t\tSYSERROR(\"failed to dup '%s'\", value);\n\t\treturn -1;\n\t}\n\n\t/* in case several capability keep is specified in a single line\n\t * split these caps in a single element for the list */\n\tfor (keepptr = keepcaps;;keepptr = NULL) {\n\t\ttoken = strtok_r(keepptr, \" \\t\", &sptr);\n\t\tif (!token) {\n\t\t\tret = 0;\n\t\t\tbreak;\n\t\t}\n\n\t\tif (!strcmp(token, \"none\"))\n\t\t\tlxc_clear_config_keepcaps(lxc_conf);\n\n\t\tkeeplist = malloc(sizeof(*keeplist));\n\t\tif (!keeplist) {\n\t\t\tSYSERROR(\"failed to allocate keepcap list\");\n\t\t\tbreak;\n\t\t}\n\n\t\tkeeplist->elem = strdup(token);\n\t\tif (!keeplist->elem) {\n\t\t\tSYSERROR(\"failed to dup '%s'\", token);\n\t\t\tfree(keeplist);\n\t\t\tbreak;\n\t\t}\n\n\t\tlxc_list_add_tail(&lxc_conf->keepcaps, keeplist);\n\t}\n\n\tfree(keepcaps);\n\n\treturn ret;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "keepcaps"
          ],
          "line": 1787
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_list_add_tail",
          "args": [
            "&lxc_conf->keepcaps",
            "keeplist"
          ],
          "line": 1784
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_add_tail",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "133-137",
          "snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to dup '%s'\"",
            "token"
          ],
          "line": 1779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "token"
          ],
          "line": 1777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to allocate keepcap list\""
          ],
          "line": 1773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*keeplist)"
          ],
          "line": 1771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_config_keepcaps",
          "args": [
            "lxc_conf"
          ],
          "line": 1769
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_config_keepcaps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4151-4161",
          "snippet": "int lxc_clear_config_keepcaps(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->keepcaps, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_clear_config_keepcaps(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->keepcaps, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "token",
            "\"none\""
          ],
          "line": 1768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "keepptr",
            "\" \\t\"",
            "&sptr"
          ],
          "line": 1762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to dup '%s'\"",
            "value"
          ],
          "line": 1755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "value"
          ],
          "line": 1753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 1750
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_cap_keep(const char *key, const char *value,\n\t\t\t   struct lxc_conf *lxc_conf)\n{\n\tchar *keepcaps, *keepptr, *sptr, *token;\n\tstruct lxc_list *keeplist;\n\tint ret = -1;\n\n\tif (!strlen(value))\n\t\treturn lxc_clear_config_keepcaps(lxc_conf);\n\n\tkeepcaps = strdup(value);\n\tif (!keepcaps) {\n\t\tSYSERROR(\"failed to dup '%s'\", value);\n\t\treturn -1;\n\t}\n\n\t/* in case several capability keep is specified in a single line\n\t * split these caps in a single element for the list */\n\tfor (keepptr = keepcaps;;keepptr = NULL) {\n\t\ttoken = strtok_r(keepptr, \" \\t\", &sptr);\n\t\tif (!token) {\n\t\t\tret = 0;\n\t\t\tbreak;\n\t\t}\n\n\t\tif (!strcmp(token, \"none\"))\n\t\t\tlxc_clear_config_keepcaps(lxc_conf);\n\n\t\tkeeplist = malloc(sizeof(*keeplist));\n\t\tif (!keeplist) {\n\t\t\tSYSERROR(\"failed to allocate keepcap list\");\n\t\t\tbreak;\n\t\t}\n\n\t\tkeeplist->elem = strdup(token);\n\t\tif (!keeplist->elem) {\n\t\t\tSYSERROR(\"failed to dup '%s'\", token);\n\t\t\tfree(keeplist);\n\t\t\tbreak;\n\t\t}\n\n\t\tlxc_list_add_tail(&lxc_conf->keepcaps, keeplist);\n\t}\n\n\tfree(keepcaps);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "config_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1718-1741",
    "snippet": "static int config_mount(const char *key, const char *value,\n\t\t\tstruct lxc_conf *lxc_conf)\n{\n\tchar *mntelem;\n\tstruct lxc_list *mntlist;\n\n\tif (!value || strlen(value) == 0)\n\t\treturn lxc_clear_mount_entries(lxc_conf);\n\n\tmntlist = malloc(sizeof(*mntlist));\n\tif (!mntlist)\n\t\treturn -1;\n\n\tmntelem = strdup(value);\n\tif (!mntelem) {\n\t\tfree(mntlist);\n\t\treturn -1;\n\t}\n\tmntlist->elem = mntelem;\n\n\tlxc_list_add_tail(&lxc_conf->mount_list, mntlist);\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_list_add_tail",
          "args": [
            "&lxc_conf->mount_list",
            "mntlist"
          ],
          "line": 1738
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_add_tail",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "133-137",
          "snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "mntlist"
          ],
          "line": 1733
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "value"
          ],
          "line": 1731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*mntlist)"
          ],
          "line": 1727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_mount_entries",
          "args": [
            "lxc_conf"
          ],
          "line": 1725
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_mount_entries",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4210-4220",
          "snippet": "int lxc_clear_mount_entries(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->mount_list, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_clear_mount_entries(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->mount_list, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 1724
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_mount(const char *key, const char *value,\n\t\t\tstruct lxc_conf *lxc_conf)\n{\n\tchar *mntelem;\n\tstruct lxc_list *mntlist;\n\n\tif (!value || strlen(value) == 0)\n\t\treturn lxc_clear_mount_entries(lxc_conf);\n\n\tmntlist = malloc(sizeof(*mntlist));\n\tif (!mntlist)\n\t\treturn -1;\n\n\tmntelem = strdup(value);\n\tif (!mntelem) {\n\t\tfree(mntlist);\n\t\treturn -1;\n\t}\n\tmntlist->elem = mntelem;\n\n\tlxc_list_add_tail(&lxc_conf->mount_list, mntlist);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "config_mount_auto",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1652-1716",
    "snippet": "static int config_mount_auto(const char *key, const char *value,\n\t\t\t     struct lxc_conf *lxc_conf)\n{\n\tchar *autos, *autoptr, *sptr, *token;\n\tstatic struct { const char *token; int mask; int flag; } allowed_auto_mounts[] = {\n\t\t{ \"proc\",               LXC_AUTO_PROC_MASK,      LXC_AUTO_PROC_MIXED         },\n\t\t{ \"proc:mixed\",         LXC_AUTO_PROC_MASK,      LXC_AUTO_PROC_MIXED         },\n\t\t{ \"proc:rw\",            LXC_AUTO_PROC_MASK,      LXC_AUTO_PROC_RW            },\n\t\t{ \"sys\",                LXC_AUTO_SYS_MASK,       LXC_AUTO_SYS_MIXED          },\n\t\t{ \"sys:ro\",             LXC_AUTO_SYS_MASK,       LXC_AUTO_SYS_RO             },\n\t\t{ \"sys:mixed\",          LXC_AUTO_SYS_MASK,       LXC_AUTO_SYS_MIXED          },\n\t\t{ \"sys:rw\",             LXC_AUTO_SYS_MASK,       LXC_AUTO_SYS_RW             },\n\t\t{ \"cgroup\",             LXC_AUTO_CGROUP_MASK,    LXC_AUTO_CGROUP_NOSPEC      },\n\t\t{ \"cgroup:mixed\",       LXC_AUTO_CGROUP_MASK,    LXC_AUTO_CGROUP_MIXED       },\n\t\t{ \"cgroup:ro\",          LXC_AUTO_CGROUP_MASK,    LXC_AUTO_CGROUP_RO          },\n\t\t{ \"cgroup:rw\",          LXC_AUTO_CGROUP_MASK,    LXC_AUTO_CGROUP_RW          },\n\t\t{ \"cgroup-full\",        LXC_AUTO_CGROUP_MASK,    LXC_AUTO_CGROUP_FULL_NOSPEC },\n\t\t{ \"cgroup-full:mixed\",  LXC_AUTO_CGROUP_MASK,    LXC_AUTO_CGROUP_FULL_MIXED  },\n\t\t{ \"cgroup-full:ro\",     LXC_AUTO_CGROUP_MASK,    LXC_AUTO_CGROUP_FULL_RO     },\n\t\t{ \"cgroup-full:rw\",     LXC_AUTO_CGROUP_MASK,    LXC_AUTO_CGROUP_FULL_RW     },\n\t\t/* NB: For adding anything that is just a single on/off, but has\n\t\t *     no options: keep mask and flag identical and just define the\n\t\t *     enum value as an unused bit so far\n\t\t */\n\t\t{ NULL, 0 }\n\t};\n\tint i;\n\tint ret = -1;\n\n\tif (!value || strlen(value) == 0) {\n\t\tlxc_conf->auto_mounts = 0;\n\t\treturn 0;\n\t}\n\n\tautos = strdup(value);\n\tif (!autos) {\n\t\tSYSERROR(\"failed to dup '%s'\", value);\n\t\treturn -1;\n\t}\n\n\tfor (autoptr = autos; ; autoptr = NULL) {\n\t\ttoken = strtok_r(autoptr, \" \\t\", &sptr);\n\t\tif (!token) {\n\t\t\tret = 0;\n\t\t\tbreak;\n\t\t}\n\n\t\tfor (i = 0; allowed_auto_mounts[i].token; i++) {\n\t\t\tif (!strcmp(allowed_auto_mounts[i].token, token))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (!allowed_auto_mounts[i].token) {\n\t\t\tERROR(\"Invalid filesystem to automount: %s\", token);\n\t\t\tbreak;\n\t\t}\n\n\t\tlxc_conf->auto_mounts &= ~allowed_auto_mounts[i].mask;\n\t\tlxc_conf->auto_mounts |= allowed_auto_mounts[i].flag;\n\t}\n\n\tfree(autos);\n\n\treturn ret;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "autos"
          ],
          "line": 1713
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Invalid filesystem to automount: %s\"",
            "token"
          ],
          "line": 1705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "allowed_auto_mounts[i].token",
            "token"
          ],
          "line": 1700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "autoptr",
            "\" \\t\"",
            "&sptr"
          ],
          "line": 1693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to dup '%s'\"",
            "value"
          ],
          "line": 1688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "value"
          ],
          "line": 1686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 1681
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_mount_auto(const char *key, const char *value,\n\t\t\t     struct lxc_conf *lxc_conf)\n{\n\tchar *autos, *autoptr, *sptr, *token;\n\tstatic struct { const char *token; int mask; int flag; } allowed_auto_mounts[] = {\n\t\t{ \"proc\",               LXC_AUTO_PROC_MASK,      LXC_AUTO_PROC_MIXED         },\n\t\t{ \"proc:mixed\",         LXC_AUTO_PROC_MASK,      LXC_AUTO_PROC_MIXED         },\n\t\t{ \"proc:rw\",            LXC_AUTO_PROC_MASK,      LXC_AUTO_PROC_RW            },\n\t\t{ \"sys\",                LXC_AUTO_SYS_MASK,       LXC_AUTO_SYS_MIXED          },\n\t\t{ \"sys:ro\",             LXC_AUTO_SYS_MASK,       LXC_AUTO_SYS_RO             },\n\t\t{ \"sys:mixed\",          LXC_AUTO_SYS_MASK,       LXC_AUTO_SYS_MIXED          },\n\t\t{ \"sys:rw\",             LXC_AUTO_SYS_MASK,       LXC_AUTO_SYS_RW             },\n\t\t{ \"cgroup\",             LXC_AUTO_CGROUP_MASK,    LXC_AUTO_CGROUP_NOSPEC      },\n\t\t{ \"cgroup:mixed\",       LXC_AUTO_CGROUP_MASK,    LXC_AUTO_CGROUP_MIXED       },\n\t\t{ \"cgroup:ro\",          LXC_AUTO_CGROUP_MASK,    LXC_AUTO_CGROUP_RO          },\n\t\t{ \"cgroup:rw\",          LXC_AUTO_CGROUP_MASK,    LXC_AUTO_CGROUP_RW          },\n\t\t{ \"cgroup-full\",        LXC_AUTO_CGROUP_MASK,    LXC_AUTO_CGROUP_FULL_NOSPEC },\n\t\t{ \"cgroup-full:mixed\",  LXC_AUTO_CGROUP_MASK,    LXC_AUTO_CGROUP_FULL_MIXED  },\n\t\t{ \"cgroup-full:ro\",     LXC_AUTO_CGROUP_MASK,    LXC_AUTO_CGROUP_FULL_RO     },\n\t\t{ \"cgroup-full:rw\",     LXC_AUTO_CGROUP_MASK,    LXC_AUTO_CGROUP_FULL_RW     },\n\t\t/* NB: For adding anything that is just a single on/off, but has\n\t\t *     no options: keep mask and flag identical and just define the\n\t\t *     enum value as an unused bit so far\n\t\t */\n\t\t{ NULL, 0 }\n\t};\n\tint i;\n\tint ret = -1;\n\n\tif (!value || strlen(value) == 0) {\n\t\tlxc_conf->auto_mounts = 0;\n\t\treturn 0;\n\t}\n\n\tautos = strdup(value);\n\tif (!autos) {\n\t\tSYSERROR(\"failed to dup '%s'\", value);\n\t\treturn -1;\n\t}\n\n\tfor (autoptr = autos; ; autoptr = NULL) {\n\t\ttoken = strtok_r(autoptr, \" \\t\", &sptr);\n\t\tif (!token) {\n\t\t\tret = 0;\n\t\t\tbreak;\n\t\t}\n\n\t\tfor (i = 0; allowed_auto_mounts[i].token; i++) {\n\t\t\tif (!strcmp(allowed_auto_mounts[i].token, token))\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (!allowed_auto_mounts[i].token) {\n\t\t\tERROR(\"Invalid filesystem to automount: %s\", token);\n\t\t\tbreak;\n\t\t}\n\n\t\tlxc_conf->auto_mounts &= ~allowed_auto_mounts[i].mask;\n\t\tlxc_conf->auto_mounts |= allowed_auto_mounts[i].flag;\n\t}\n\n\tfree(autos);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "config_fstab",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1644-1650",
    "snippet": "static int config_fstab(const char *key, const char *value,\n\t\t\tstruct lxc_conf *lxc_conf)\n{\n\tif (!value || strlen(value) == 0)\n\t\treturn -1;\n\treturn config_path_item(&lxc_conf->fstab, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_path_item",
          "args": [
            "&lxc_conf->fstab",
            "value"
          ],
          "line": 1649
        },
        "resolved": true,
        "details": {
          "function_name": "config_path_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "359-362",
          "snippet": "static int config_path_item(char **conf_item, const char *value)\n{\n\treturn config_string_item_max(conf_item, value, PATH_MAX);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_path_item(char **conf_item, const char *value)\n{\n\treturn config_string_item_max(conf_item, value, PATH_MAX);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 1647
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_fstab(const char *key, const char *value,\n\t\t\tstruct lxc_conf *lxc_conf)\n{\n\tif (!value || strlen(value) == 0)\n\t\treturn -1;\n\treturn config_path_item(&lxc_conf->fstab, value);\n}"
  },
  {
    "function_name": "config_idmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1583-1642",
    "snippet": "static int config_idmap(const char *key, const char *value, struct lxc_conf *lxc_conf)\n{\n\tchar *token = \"lxc.id_map\";\n\tchar *subkey;\n\tstruct lxc_list *idmaplist = NULL;\n\tstruct id_map *idmap = NULL;\n\tunsigned long hostid, nsid, range;\n\tchar type;\n\tint ret;\n\n\tif (!value || strlen(value) == 0)\n\t\treturn lxc_clear_idmaps(lxc_conf);\n\n\tsubkey = strstr(key, token);\n\n\tif (!subkey)\n\t\treturn -1;\n\n\tif (!strlen(subkey))\n\t\treturn -1;\n\n\tidmaplist = malloc(sizeof(*idmaplist));\n\tif (!idmaplist)\n\t\tgoto out;\n\n\tidmap = malloc(sizeof(*idmap));\n\tif (!idmap)\n\t\tgoto out;\n\tmemset(idmap, 0, sizeof(*idmap));\n\n\tret = sscanf(value, \"%c %lu %lu %lu\", &type, &nsid, &hostid, &range);\n\tif (ret != 4)\n\t\tgoto out;\n\n\tINFO(\"read uid map: type %c nsid %lu hostid %lu range %lu\", type, nsid, hostid, range);\n\tif (type == 'u')\n\t\tidmap->idtype = ID_TYPE_UID;\n\telse if (type == 'g')\n\t\tidmap->idtype = ID_TYPE_GID;\n\telse\n\t\tgoto out;\n\n\tidmap->hostid = hostid;\n\tidmap->nsid = nsid;\n\tidmap->range = range;\n\n\tidmaplist->elem = idmap;\n\tlxc_list_add_tail(&lxc_conf->id_map, idmaplist);\n\n\treturn 0;\n\nout:\n\tfree(idmaplist);\n\n\tif (idmap) {\n\t\tfree(idmap);\n\t}\n\n\treturn -1;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "idmap"
          ],
          "line": 1638
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_list_add_tail",
          "args": [
            "&lxc_conf->id_map",
            "idmaplist"
          ],
          "line": 1630
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_add_tail",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "133-137",
          "snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "INFO",
          "args": [
            "\"read uid map: type %c nsid %lu hostid %lu range %lu\"",
            "type",
            "nsid",
            "hostid",
            "range"
          ],
          "line": 1617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "value",
            "\"%c %lu %lu %lu\"",
            "&type",
            "&nsid",
            "&hostid",
            "&range"
          ],
          "line": 1613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "idmap",
            "0",
            "sizeof(*idmap)"
          ],
          "line": 1611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*idmap)"
          ],
          "line": 1608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*idmaplist)"
          ],
          "line": 1604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "subkey"
          ],
          "line": 1601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "key",
            "token"
          ],
          "line": 1596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_idmaps",
          "args": [
            "lxc_conf"
          ],
          "line": 1594
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_idmaps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4146-4149",
          "snippet": "int lxc_clear_idmaps(struct lxc_conf *c)\n{\n\treturn lxc_free_idmap(&c->id_map);\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_clear_idmaps(struct lxc_conf *c)\n{\n\treturn lxc_free_idmap(&c->id_map);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 1593
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_idmap(const char *key, const char *value, struct lxc_conf *lxc_conf)\n{\n\tchar *token = \"lxc.id_map\";\n\tchar *subkey;\n\tstruct lxc_list *idmaplist = NULL;\n\tstruct id_map *idmap = NULL;\n\tunsigned long hostid, nsid, range;\n\tchar type;\n\tint ret;\n\n\tif (!value || strlen(value) == 0)\n\t\treturn lxc_clear_idmaps(lxc_conf);\n\n\tsubkey = strstr(key, token);\n\n\tif (!subkey)\n\t\treturn -1;\n\n\tif (!strlen(subkey))\n\t\treturn -1;\n\n\tidmaplist = malloc(sizeof(*idmaplist));\n\tif (!idmaplist)\n\t\tgoto out;\n\n\tidmap = malloc(sizeof(*idmap));\n\tif (!idmap)\n\t\tgoto out;\n\tmemset(idmap, 0, sizeof(*idmap));\n\n\tret = sscanf(value, \"%c %lu %lu %lu\", &type, &nsid, &hostid, &range);\n\tif (ret != 4)\n\t\tgoto out;\n\n\tINFO(\"read uid map: type %c nsid %lu hostid %lu range %lu\", type, nsid, hostid, range);\n\tif (type == 'u')\n\t\tidmap->idtype = ID_TYPE_UID;\n\telse if (type == 'g')\n\t\tidmap->idtype = ID_TYPE_GID;\n\telse\n\t\tgoto out;\n\n\tidmap->hostid = hostid;\n\tidmap->nsid = nsid;\n\tidmap->range = range;\n\n\tidmaplist->elem = idmap;\n\tlxc_list_add_tail(&lxc_conf->id_map, idmaplist);\n\n\treturn 0;\n\nout:\n\tfree(idmaplist);\n\n\tif (idmap) {\n\t\tfree(idmap);\n\t}\n\n\treturn -1;\n}"
  },
  {
    "function_name": "config_cgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1524-1581",
    "snippet": "static int config_cgroup(const char *key, const char *value,\n\t\t\t struct lxc_conf *lxc_conf)\n{\n\tchar *token = \"lxc.cgroup.\";\n\tchar *subkey;\n\tstruct lxc_list *cglist = NULL;\n\tstruct lxc_cgroup *cgelem = NULL;\n\n\tif (!value || strlen(value) == 0)\n\t\treturn lxc_clear_cgroups(lxc_conf, key);\n\n\tsubkey = strstr(key, token);\n\n\tif (!subkey)\n\t\treturn -1;\n\n\tif (!strlen(subkey))\n\t\treturn -1;\n\n\tif (strlen(subkey) == strlen(token))\n\t\treturn -1;\n\n\tsubkey += strlen(token);\n\n\tcglist = malloc(sizeof(*cglist));\n\tif (!cglist)\n\t\tgoto out;\n\n\tcgelem = malloc(sizeof(*cgelem));\n\tif (!cgelem)\n\t\tgoto out;\n\tmemset(cgelem, 0, sizeof(*cgelem));\n\n\tcgelem->subsystem = strdup(subkey);\n\tcgelem->value = strdup(value);\n\n\tif (!cgelem->subsystem || !cgelem->value)\n\t\tgoto out;\n\n\tcglist->elem = cgelem;\n\n\tlxc_list_add_tail(&lxc_conf->cgroup, cglist);\n\n\treturn 0;\n\nout:\n\tfree(cglist);\n\n\tif (cgelem) {\n\t\tfree(cgelem->subsystem);\n\n\t\tfree(cgelem->value);\n\n\t\tfree(cgelem);\n\t}\n\n\treturn -1;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "cgelem"
          ],
          "line": 1577
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_list_add_tail",
          "args": [
            "&lxc_conf->cgroup",
            "cglist"
          ],
          "line": 1565
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_add_tail",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "133-137",
          "snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "value"
          ],
          "line": 1558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "subkey"
          ],
          "line": 1557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "cgelem",
            "0",
            "sizeof(*cgelem)"
          ],
          "line": 1555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*cgelem)"
          ],
          "line": 1552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*cglist)"
          ],
          "line": 1548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "token"
          ],
          "line": 1546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "token"
          ],
          "line": 1543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "subkey"
          ],
          "line": 1543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "subkey"
          ],
          "line": 1540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "key",
            "token"
          ],
          "line": 1535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_cgroups",
          "args": [
            "lxc_conf",
            "key"
          ],
          "line": 1533
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_cgroups",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4163-4183",
          "snippet": "int lxc_clear_cgroups(struct lxc_conf *c, const char *key)\n{\n\tstruct lxc_list *it,*next;\n\tbool all = false;\n\tconst char *k = key + 11;\n\n\tif (strcmp(key, \"lxc.cgroup\") == 0)\n\t\tall = true;\n\n\tlxc_list_for_each_safe(it, &c->cgroup, next) {\n\t\tstruct lxc_cgroup *cg = it->elem;\n\t\tif (!all && strcmp(cg->subsystem, k) != 0)\n\t\t\tcontinue;\n\t\tlxc_list_del(it);\n\t\tfree(cg->subsystem);\n\t\tfree(cg->value);\n\t\tfree(cg);\n\t\tfree(it);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_clear_cgroups(struct lxc_conf *c, const char *key)\n{\n\tstruct lxc_list *it,*next;\n\tbool all = false;\n\tconst char *k = key + 11;\n\n\tif (strcmp(key, \"lxc.cgroup\") == 0)\n\t\tall = true;\n\n\tlxc_list_for_each_safe(it, &c->cgroup, next) {\n\t\tstruct lxc_cgroup *cg = it->elem;\n\t\tif (!all && strcmp(cg->subsystem, k) != 0)\n\t\t\tcontinue;\n\t\tlxc_list_del(it);\n\t\tfree(cg->subsystem);\n\t\tfree(cg->value);\n\t\tfree(cg);\n\t\tfree(it);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 1532
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_cgroup(const char *key, const char *value,\n\t\t\t struct lxc_conf *lxc_conf)\n{\n\tchar *token = \"lxc.cgroup.\";\n\tchar *subkey;\n\tstruct lxc_list *cglist = NULL;\n\tstruct lxc_cgroup *cgelem = NULL;\n\n\tif (!value || strlen(value) == 0)\n\t\treturn lxc_clear_cgroups(lxc_conf, key);\n\n\tsubkey = strstr(key, token);\n\n\tif (!subkey)\n\t\treturn -1;\n\n\tif (!strlen(subkey))\n\t\treturn -1;\n\n\tif (strlen(subkey) == strlen(token))\n\t\treturn -1;\n\n\tsubkey += strlen(token);\n\n\tcglist = malloc(sizeof(*cglist));\n\tif (!cglist)\n\t\tgoto out;\n\n\tcgelem = malloc(sizeof(*cgelem));\n\tif (!cgelem)\n\t\tgoto out;\n\tmemset(cgelem, 0, sizeof(*cgelem));\n\n\tcgelem->subsystem = strdup(subkey);\n\tcgelem->value = strdup(value);\n\n\tif (!cgelem->subsystem || !cgelem->value)\n\t\tgoto out;\n\n\tcglist->elem = cgelem;\n\n\tlxc_list_add_tail(&lxc_conf->cgroup, cglist);\n\n\treturn 0;\n\nout:\n\tfree(cglist);\n\n\tif (cgelem) {\n\t\tfree(cgelem->subsystem);\n\n\t\tfree(cgelem->value);\n\n\t\tfree(cgelem);\n\t}\n\n\treturn -1;\n}"
  },
  {
    "function_name": "config_stopsignal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1512-1522",
    "snippet": "static int config_stopsignal(const char *key, const char *value,\n\t\t\t  struct lxc_conf *lxc_conf)\n{\n\tint sig_n = sig_parse(value);\n\n\tif (sig_n < 0)\n\t\treturn -1;\n\tlxc_conf->stopsignal = sig_n;\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sig_parse",
          "args": [
            "value"
          ],
          "line": 1515
        },
        "resolved": true,
        "details": {
          "function_name": "sig_parse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "1471-1486",
          "snippet": "static int sig_parse(const char *signame) {\n\tsize_t n;\n\n\tif (isdigit(*signame)) {\n\t\treturn sig_num(signame);\n\t} else if (strncasecmp(signame, \"sig\", 3) == 0) {\n\t\tsigname += 3;\n\t\tif (strncasecmp(signame, \"rt\", 2) == 0)\n\t\t\treturn rt_sig_num(signame + 2);\n\t\tfor (n = 0; n < sizeof(signames) / sizeof((signames)[0]); n++) {\n\t\t\tif (strcasecmp (signames[n].name, signame) == 0)\n\t\t\t\treturn signames[n].num;\n\t\t}\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct signame signames[] = {\n\t{ SIGHUP,    \"HUP\" },\n\t{ SIGINT,    \"INT\" },\n\t{ SIGQUIT,   \"QUIT\" },\n\t{ SIGILL,    \"ILL\" },\n\t{ SIGABRT,   \"ABRT\" },\n\t{ SIGFPE,    \"FPE\" },\n\t{ SIGKILL,   \"KILL\" },\n\t{ SIGSEGV,   \"SEGV\" },\n\t{ SIGPIPE,   \"PIPE\" },\n\t{ SIGALRM,   \"ALRM\" },\n\t{ SIGTERM,   \"TERM\" },\n\t{ SIGUSR1,   \"USR1\" },\n\t{ SIGUSR2,   \"USR2\" },\n\t{ SIGCHLD,   \"CHLD\" },\n\t{ SIGCONT,   \"CONT\" },\n\t{ SIGSTOP,   \"STOP\" },\n\t{ SIGTSTP,   \"TSTP\" },\n\t{ SIGTTIN,   \"TTIN\" },\n\t{ SIGTTOU,   \"TTOU\" },\n#ifdef SIGTRAP\n\t{ SIGTRAP,   \"TRAP\" },\n#endif\n#ifdef SIGIOT\n\t{ SIGIOT,    \"IOT\" },\n#endif\n#ifdef SIGEMT\n\t{ SIGEMT,    \"EMT\" },\n#endif\n#ifdef SIGBUS\n\t{ SIGBUS,    \"BUS\" },\n#endif\n#ifdef SIGSTKFLT\n\t{ SIGSTKFLT, \"STKFLT\" },\n#endif\n#ifdef SIGCLD\n\t{ SIGCLD,    \"CLD\" },\n#endif\n#ifdef SIGURG\n\t{ SIGURG,    \"URG\" },\n#endif\n#ifdef SIGXCPU\n\t{ SIGXCPU,   \"XCPU\" },\n#endif\n#ifdef SIGXFSZ\n\t{ SIGXFSZ,   \"XFSZ\" },\n#endif\n#ifdef SIGVTALRM\n\t{ SIGVTALRM, \"VTALRM\" },\n#endif\n#ifdef SIGPROF\n\t{ SIGPROF,   \"PROF\" },\n#endif\n#ifdef SIGWINCH\n\t{ SIGWINCH,  \"WINCH\" },\n#endif\n#ifdef SIGIO\n\t{ SIGIO,     \"IO\" },\n#endif\n#ifdef SIGPOLL\n\t{ SIGPOLL,   \"POLL\" },\n#endif\n#ifdef SIGINFO\n\t{ SIGINFO,   \"INFO\" },\n#endif\n#ifdef SIGLOST\n\t{ SIGLOST,   \"LOST\" },\n#endif\n#ifdef SIGPWR\n\t{ SIGPWR,    \"PWR\" },\n#endif\n#ifdef SIGUNUSED\n\t{ SIGUNUSED, \"UNUSED\" },\n#endif\n#ifdef SIGSYS\n\t{ SIGSYS,    \"SYS\" },\n#endif\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic const struct signame signames[] = {\n\t{ SIGHUP,    \"HUP\" },\n\t{ SIGINT,    \"INT\" },\n\t{ SIGQUIT,   \"QUIT\" },\n\t{ SIGILL,    \"ILL\" },\n\t{ SIGABRT,   \"ABRT\" },\n\t{ SIGFPE,    \"FPE\" },\n\t{ SIGKILL,   \"KILL\" },\n\t{ SIGSEGV,   \"SEGV\" },\n\t{ SIGPIPE,   \"PIPE\" },\n\t{ SIGALRM,   \"ALRM\" },\n\t{ SIGTERM,   \"TERM\" },\n\t{ SIGUSR1,   \"USR1\" },\n\t{ SIGUSR2,   \"USR2\" },\n\t{ SIGCHLD,   \"CHLD\" },\n\t{ SIGCONT,   \"CONT\" },\n\t{ SIGSTOP,   \"STOP\" },\n\t{ SIGTSTP,   \"TSTP\" },\n\t{ SIGTTIN,   \"TTIN\" },\n\t{ SIGTTOU,   \"TTOU\" },\n#ifdef SIGTRAP\n\t{ SIGTRAP,   \"TRAP\" },\n#endif\n#ifdef SIGIOT\n\t{ SIGIOT,    \"IOT\" },\n#endif\n#ifdef SIGEMT\n\t{ SIGEMT,    \"EMT\" },\n#endif\n#ifdef SIGBUS\n\t{ SIGBUS,    \"BUS\" },\n#endif\n#ifdef SIGSTKFLT\n\t{ SIGSTKFLT, \"STKFLT\" },\n#endif\n#ifdef SIGCLD\n\t{ SIGCLD,    \"CLD\" },\n#endif\n#ifdef SIGURG\n\t{ SIGURG,    \"URG\" },\n#endif\n#ifdef SIGXCPU\n\t{ SIGXCPU,   \"XCPU\" },\n#endif\n#ifdef SIGXFSZ\n\t{ SIGXFSZ,   \"XFSZ\" },\n#endif\n#ifdef SIGVTALRM\n\t{ SIGVTALRM, \"VTALRM\" },\n#endif\n#ifdef SIGPROF\n\t{ SIGPROF,   \"PROF\" },\n#endif\n#ifdef SIGWINCH\n\t{ SIGWINCH,  \"WINCH\" },\n#endif\n#ifdef SIGIO\n\t{ SIGIO,     \"IO\" },\n#endif\n#ifdef SIGPOLL\n\t{ SIGPOLL,   \"POLL\" },\n#endif\n#ifdef SIGINFO\n\t{ SIGINFO,   \"INFO\" },\n#endif\n#ifdef SIGLOST\n\t{ SIGLOST,   \"LOST\" },\n#endif\n#ifdef SIGPWR\n\t{ SIGPWR,    \"PWR\" },\n#endif\n#ifdef SIGUNUSED\n\t{ SIGUNUSED, \"UNUSED\" },\n#endif\n#ifdef SIGSYS\n\t{ SIGSYS,    \"SYS\" },\n#endif\n};\n\nstatic int sig_parse(const char *signame) {\n\tsize_t n;\n\n\tif (isdigit(*signame)) {\n\t\treturn sig_num(signame);\n\t} else if (strncasecmp(signame, \"sig\", 3) == 0) {\n\t\tsigname += 3;\n\t\tif (strncasecmp(signame, \"rt\", 2) == 0)\n\t\t\treturn rt_sig_num(signame + 2);\n\t\tfor (n = 0; n < sizeof(signames) / sizeof((signames)[0]); n++) {\n\t\t\tif (strcasecmp (signames[n].name, signame) == 0)\n\t\t\t\treturn signames[n].num;\n\t\t}\n\t}\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_stopsignal(const char *key, const char *value,\n\t\t\t  struct lxc_conf *lxc_conf)\n{\n\tint sig_n = sig_parse(value);\n\n\tif (sig_n < 0)\n\t\treturn -1;\n\tlxc_conf->stopsignal = sig_n;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "config_rebootsignal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1500-1510",
    "snippet": "static int config_rebootsignal(const char *key, const char *value,\n\t\t\t     struct lxc_conf *lxc_conf)\n{\n\tint sig_n = sig_parse(value);\n\n\tif (sig_n < 0)\n\t\treturn -1;\n\tlxc_conf->rebootsignal = sig_n;\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sig_parse",
          "args": [
            "value"
          ],
          "line": 1503
        },
        "resolved": true,
        "details": {
          "function_name": "sig_parse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "1471-1486",
          "snippet": "static int sig_parse(const char *signame) {\n\tsize_t n;\n\n\tif (isdigit(*signame)) {\n\t\treturn sig_num(signame);\n\t} else if (strncasecmp(signame, \"sig\", 3) == 0) {\n\t\tsigname += 3;\n\t\tif (strncasecmp(signame, \"rt\", 2) == 0)\n\t\t\treturn rt_sig_num(signame + 2);\n\t\tfor (n = 0; n < sizeof(signames) / sizeof((signames)[0]); n++) {\n\t\t\tif (strcasecmp (signames[n].name, signame) == 0)\n\t\t\t\treturn signames[n].num;\n\t\t}\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct signame signames[] = {\n\t{ SIGHUP,    \"HUP\" },\n\t{ SIGINT,    \"INT\" },\n\t{ SIGQUIT,   \"QUIT\" },\n\t{ SIGILL,    \"ILL\" },\n\t{ SIGABRT,   \"ABRT\" },\n\t{ SIGFPE,    \"FPE\" },\n\t{ SIGKILL,   \"KILL\" },\n\t{ SIGSEGV,   \"SEGV\" },\n\t{ SIGPIPE,   \"PIPE\" },\n\t{ SIGALRM,   \"ALRM\" },\n\t{ SIGTERM,   \"TERM\" },\n\t{ SIGUSR1,   \"USR1\" },\n\t{ SIGUSR2,   \"USR2\" },\n\t{ SIGCHLD,   \"CHLD\" },\n\t{ SIGCONT,   \"CONT\" },\n\t{ SIGSTOP,   \"STOP\" },\n\t{ SIGTSTP,   \"TSTP\" },\n\t{ SIGTTIN,   \"TTIN\" },\n\t{ SIGTTOU,   \"TTOU\" },\n#ifdef SIGTRAP\n\t{ SIGTRAP,   \"TRAP\" },\n#endif\n#ifdef SIGIOT\n\t{ SIGIOT,    \"IOT\" },\n#endif\n#ifdef SIGEMT\n\t{ SIGEMT,    \"EMT\" },\n#endif\n#ifdef SIGBUS\n\t{ SIGBUS,    \"BUS\" },\n#endif\n#ifdef SIGSTKFLT\n\t{ SIGSTKFLT, \"STKFLT\" },\n#endif\n#ifdef SIGCLD\n\t{ SIGCLD,    \"CLD\" },\n#endif\n#ifdef SIGURG\n\t{ SIGURG,    \"URG\" },\n#endif\n#ifdef SIGXCPU\n\t{ SIGXCPU,   \"XCPU\" },\n#endif\n#ifdef SIGXFSZ\n\t{ SIGXFSZ,   \"XFSZ\" },\n#endif\n#ifdef SIGVTALRM\n\t{ SIGVTALRM, \"VTALRM\" },\n#endif\n#ifdef SIGPROF\n\t{ SIGPROF,   \"PROF\" },\n#endif\n#ifdef SIGWINCH\n\t{ SIGWINCH,  \"WINCH\" },\n#endif\n#ifdef SIGIO\n\t{ SIGIO,     \"IO\" },\n#endif\n#ifdef SIGPOLL\n\t{ SIGPOLL,   \"POLL\" },\n#endif\n#ifdef SIGINFO\n\t{ SIGINFO,   \"INFO\" },\n#endif\n#ifdef SIGLOST\n\t{ SIGLOST,   \"LOST\" },\n#endif\n#ifdef SIGPWR\n\t{ SIGPWR,    \"PWR\" },\n#endif\n#ifdef SIGUNUSED\n\t{ SIGUNUSED, \"UNUSED\" },\n#endif\n#ifdef SIGSYS\n\t{ SIGSYS,    \"SYS\" },\n#endif\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic const struct signame signames[] = {\n\t{ SIGHUP,    \"HUP\" },\n\t{ SIGINT,    \"INT\" },\n\t{ SIGQUIT,   \"QUIT\" },\n\t{ SIGILL,    \"ILL\" },\n\t{ SIGABRT,   \"ABRT\" },\n\t{ SIGFPE,    \"FPE\" },\n\t{ SIGKILL,   \"KILL\" },\n\t{ SIGSEGV,   \"SEGV\" },\n\t{ SIGPIPE,   \"PIPE\" },\n\t{ SIGALRM,   \"ALRM\" },\n\t{ SIGTERM,   \"TERM\" },\n\t{ SIGUSR1,   \"USR1\" },\n\t{ SIGUSR2,   \"USR2\" },\n\t{ SIGCHLD,   \"CHLD\" },\n\t{ SIGCONT,   \"CONT\" },\n\t{ SIGSTOP,   \"STOP\" },\n\t{ SIGTSTP,   \"TSTP\" },\n\t{ SIGTTIN,   \"TTIN\" },\n\t{ SIGTTOU,   \"TTOU\" },\n#ifdef SIGTRAP\n\t{ SIGTRAP,   \"TRAP\" },\n#endif\n#ifdef SIGIOT\n\t{ SIGIOT,    \"IOT\" },\n#endif\n#ifdef SIGEMT\n\t{ SIGEMT,    \"EMT\" },\n#endif\n#ifdef SIGBUS\n\t{ SIGBUS,    \"BUS\" },\n#endif\n#ifdef SIGSTKFLT\n\t{ SIGSTKFLT, \"STKFLT\" },\n#endif\n#ifdef SIGCLD\n\t{ SIGCLD,    \"CLD\" },\n#endif\n#ifdef SIGURG\n\t{ SIGURG,    \"URG\" },\n#endif\n#ifdef SIGXCPU\n\t{ SIGXCPU,   \"XCPU\" },\n#endif\n#ifdef SIGXFSZ\n\t{ SIGXFSZ,   \"XFSZ\" },\n#endif\n#ifdef SIGVTALRM\n\t{ SIGVTALRM, \"VTALRM\" },\n#endif\n#ifdef SIGPROF\n\t{ SIGPROF,   \"PROF\" },\n#endif\n#ifdef SIGWINCH\n\t{ SIGWINCH,  \"WINCH\" },\n#endif\n#ifdef SIGIO\n\t{ SIGIO,     \"IO\" },\n#endif\n#ifdef SIGPOLL\n\t{ SIGPOLL,   \"POLL\" },\n#endif\n#ifdef SIGINFO\n\t{ SIGINFO,   \"INFO\" },\n#endif\n#ifdef SIGLOST\n\t{ SIGLOST,   \"LOST\" },\n#endif\n#ifdef SIGPWR\n\t{ SIGPWR,    \"PWR\" },\n#endif\n#ifdef SIGUNUSED\n\t{ SIGUNUSED, \"UNUSED\" },\n#endif\n#ifdef SIGSYS\n\t{ SIGSYS,    \"SYS\" },\n#endif\n};\n\nstatic int sig_parse(const char *signame) {\n\tsize_t n;\n\n\tif (isdigit(*signame)) {\n\t\treturn sig_num(signame);\n\t} else if (strncasecmp(signame, \"sig\", 3) == 0) {\n\t\tsigname += 3;\n\t\tif (strncasecmp(signame, \"rt\", 2) == 0)\n\t\t\treturn rt_sig_num(signame + 2);\n\t\tfor (n = 0; n < sizeof(signames) / sizeof((signames)[0]); n++) {\n\t\t\tif (strcasecmp (signames[n].name, signame) == 0)\n\t\t\t\treturn signames[n].num;\n\t\t}\n\t}\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_rebootsignal(const char *key, const char *value,\n\t\t\t     struct lxc_conf *lxc_conf)\n{\n\tint sig_n = sig_parse(value);\n\n\tif (sig_n < 0)\n\t\treturn -1;\n\tlxc_conf->rebootsignal = sig_n;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "config_haltsignal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1488-1498",
    "snippet": "static int config_haltsignal(const char *key, const char *value,\n\t\t\t     struct lxc_conf *lxc_conf)\n{\n\tint sig_n = sig_parse(value);\n\n\tif (sig_n < 0)\n\t\treturn -1;\n\tlxc_conf->haltsignal = sig_n;\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sig_parse",
          "args": [
            "value"
          ],
          "line": 1491
        },
        "resolved": true,
        "details": {
          "function_name": "sig_parse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "1471-1486",
          "snippet": "static int sig_parse(const char *signame) {\n\tsize_t n;\n\n\tif (isdigit(*signame)) {\n\t\treturn sig_num(signame);\n\t} else if (strncasecmp(signame, \"sig\", 3) == 0) {\n\t\tsigname += 3;\n\t\tif (strncasecmp(signame, \"rt\", 2) == 0)\n\t\t\treturn rt_sig_num(signame + 2);\n\t\tfor (n = 0; n < sizeof(signames) / sizeof((signames)[0]); n++) {\n\t\t\tif (strcasecmp (signames[n].name, signame) == 0)\n\t\t\t\treturn signames[n].num;\n\t\t}\n\t}\n\treturn -1;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct signame signames[] = {\n\t{ SIGHUP,    \"HUP\" },\n\t{ SIGINT,    \"INT\" },\n\t{ SIGQUIT,   \"QUIT\" },\n\t{ SIGILL,    \"ILL\" },\n\t{ SIGABRT,   \"ABRT\" },\n\t{ SIGFPE,    \"FPE\" },\n\t{ SIGKILL,   \"KILL\" },\n\t{ SIGSEGV,   \"SEGV\" },\n\t{ SIGPIPE,   \"PIPE\" },\n\t{ SIGALRM,   \"ALRM\" },\n\t{ SIGTERM,   \"TERM\" },\n\t{ SIGUSR1,   \"USR1\" },\n\t{ SIGUSR2,   \"USR2\" },\n\t{ SIGCHLD,   \"CHLD\" },\n\t{ SIGCONT,   \"CONT\" },\n\t{ SIGSTOP,   \"STOP\" },\n\t{ SIGTSTP,   \"TSTP\" },\n\t{ SIGTTIN,   \"TTIN\" },\n\t{ SIGTTOU,   \"TTOU\" },\n#ifdef SIGTRAP\n\t{ SIGTRAP,   \"TRAP\" },\n#endif\n#ifdef SIGIOT\n\t{ SIGIOT,    \"IOT\" },\n#endif\n#ifdef SIGEMT\n\t{ SIGEMT,    \"EMT\" },\n#endif\n#ifdef SIGBUS\n\t{ SIGBUS,    \"BUS\" },\n#endif\n#ifdef SIGSTKFLT\n\t{ SIGSTKFLT, \"STKFLT\" },\n#endif\n#ifdef SIGCLD\n\t{ SIGCLD,    \"CLD\" },\n#endif\n#ifdef SIGURG\n\t{ SIGURG,    \"URG\" },\n#endif\n#ifdef SIGXCPU\n\t{ SIGXCPU,   \"XCPU\" },\n#endif\n#ifdef SIGXFSZ\n\t{ SIGXFSZ,   \"XFSZ\" },\n#endif\n#ifdef SIGVTALRM\n\t{ SIGVTALRM, \"VTALRM\" },\n#endif\n#ifdef SIGPROF\n\t{ SIGPROF,   \"PROF\" },\n#endif\n#ifdef SIGWINCH\n\t{ SIGWINCH,  \"WINCH\" },\n#endif\n#ifdef SIGIO\n\t{ SIGIO,     \"IO\" },\n#endif\n#ifdef SIGPOLL\n\t{ SIGPOLL,   \"POLL\" },\n#endif\n#ifdef SIGINFO\n\t{ SIGINFO,   \"INFO\" },\n#endif\n#ifdef SIGLOST\n\t{ SIGLOST,   \"LOST\" },\n#endif\n#ifdef SIGPWR\n\t{ SIGPWR,    \"PWR\" },\n#endif\n#ifdef SIGUNUSED\n\t{ SIGUNUSED, \"UNUSED\" },\n#endif\n#ifdef SIGSYS\n\t{ SIGSYS,    \"SYS\" },\n#endif\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic const struct signame signames[] = {\n\t{ SIGHUP,    \"HUP\" },\n\t{ SIGINT,    \"INT\" },\n\t{ SIGQUIT,   \"QUIT\" },\n\t{ SIGILL,    \"ILL\" },\n\t{ SIGABRT,   \"ABRT\" },\n\t{ SIGFPE,    \"FPE\" },\n\t{ SIGKILL,   \"KILL\" },\n\t{ SIGSEGV,   \"SEGV\" },\n\t{ SIGPIPE,   \"PIPE\" },\n\t{ SIGALRM,   \"ALRM\" },\n\t{ SIGTERM,   \"TERM\" },\n\t{ SIGUSR1,   \"USR1\" },\n\t{ SIGUSR2,   \"USR2\" },\n\t{ SIGCHLD,   \"CHLD\" },\n\t{ SIGCONT,   \"CONT\" },\n\t{ SIGSTOP,   \"STOP\" },\n\t{ SIGTSTP,   \"TSTP\" },\n\t{ SIGTTIN,   \"TTIN\" },\n\t{ SIGTTOU,   \"TTOU\" },\n#ifdef SIGTRAP\n\t{ SIGTRAP,   \"TRAP\" },\n#endif\n#ifdef SIGIOT\n\t{ SIGIOT,    \"IOT\" },\n#endif\n#ifdef SIGEMT\n\t{ SIGEMT,    \"EMT\" },\n#endif\n#ifdef SIGBUS\n\t{ SIGBUS,    \"BUS\" },\n#endif\n#ifdef SIGSTKFLT\n\t{ SIGSTKFLT, \"STKFLT\" },\n#endif\n#ifdef SIGCLD\n\t{ SIGCLD,    \"CLD\" },\n#endif\n#ifdef SIGURG\n\t{ SIGURG,    \"URG\" },\n#endif\n#ifdef SIGXCPU\n\t{ SIGXCPU,   \"XCPU\" },\n#endif\n#ifdef SIGXFSZ\n\t{ SIGXFSZ,   \"XFSZ\" },\n#endif\n#ifdef SIGVTALRM\n\t{ SIGVTALRM, \"VTALRM\" },\n#endif\n#ifdef SIGPROF\n\t{ SIGPROF,   \"PROF\" },\n#endif\n#ifdef SIGWINCH\n\t{ SIGWINCH,  \"WINCH\" },\n#endif\n#ifdef SIGIO\n\t{ SIGIO,     \"IO\" },\n#endif\n#ifdef SIGPOLL\n\t{ SIGPOLL,   \"POLL\" },\n#endif\n#ifdef SIGINFO\n\t{ SIGINFO,   \"INFO\" },\n#endif\n#ifdef SIGLOST\n\t{ SIGLOST,   \"LOST\" },\n#endif\n#ifdef SIGPWR\n\t{ SIGPWR,    \"PWR\" },\n#endif\n#ifdef SIGUNUSED\n\t{ SIGUNUSED, \"UNUSED\" },\n#endif\n#ifdef SIGSYS\n\t{ SIGSYS,    \"SYS\" },\n#endif\n};\n\nstatic int sig_parse(const char *signame) {\n\tsize_t n;\n\n\tif (isdigit(*signame)) {\n\t\treturn sig_num(signame);\n\t} else if (strncasecmp(signame, \"sig\", 3) == 0) {\n\t\tsigname += 3;\n\t\tif (strncasecmp(signame, \"rt\", 2) == 0)\n\t\t\treturn rt_sig_num(signame + 2);\n\t\tfor (n = 0; n < sizeof(signames) / sizeof((signames)[0]); n++) {\n\t\t\tif (strcasecmp (signames[n].name, signame) == 0)\n\t\t\t\treturn signames[n].num;\n\t\t}\n\t}\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_haltsignal(const char *key, const char *value,\n\t\t\t     struct lxc_conf *lxc_conf)\n{\n\tint sig_n = sig_parse(value);\n\n\tif (sig_n < 0)\n\t\treturn -1;\n\tlxc_conf->haltsignal = sig_n;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "sig_parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1471-1486",
    "snippet": "static int sig_parse(const char *signame) {\n\tsize_t n;\n\n\tif (isdigit(*signame)) {\n\t\treturn sig_num(signame);\n\t} else if (strncasecmp(signame, \"sig\", 3) == 0) {\n\t\tsigname += 3;\n\t\tif (strncasecmp(signame, \"rt\", 2) == 0)\n\t\t\treturn rt_sig_num(signame + 2);\n\t\tfor (n = 0; n < sizeof(signames) / sizeof((signames)[0]); n++) {\n\t\t\tif (strcasecmp (signames[n].name, signame) == 0)\n\t\t\t\treturn signames[n].num;\n\t\t}\n\t}\n\treturn -1;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct signame signames[] = {\n\t{ SIGHUP,    \"HUP\" },\n\t{ SIGINT,    \"INT\" },\n\t{ SIGQUIT,   \"QUIT\" },\n\t{ SIGILL,    \"ILL\" },\n\t{ SIGABRT,   \"ABRT\" },\n\t{ SIGFPE,    \"FPE\" },\n\t{ SIGKILL,   \"KILL\" },\n\t{ SIGSEGV,   \"SEGV\" },\n\t{ SIGPIPE,   \"PIPE\" },\n\t{ SIGALRM,   \"ALRM\" },\n\t{ SIGTERM,   \"TERM\" },\n\t{ SIGUSR1,   \"USR1\" },\n\t{ SIGUSR2,   \"USR2\" },\n\t{ SIGCHLD,   \"CHLD\" },\n\t{ SIGCONT,   \"CONT\" },\n\t{ SIGSTOP,   \"STOP\" },\n\t{ SIGTSTP,   \"TSTP\" },\n\t{ SIGTTIN,   \"TTIN\" },\n\t{ SIGTTOU,   \"TTOU\" },\n#ifdef SIGTRAP\n\t{ SIGTRAP,   \"TRAP\" },\n#endif\n#ifdef SIGIOT\n\t{ SIGIOT,    \"IOT\" },\n#endif\n#ifdef SIGEMT\n\t{ SIGEMT,    \"EMT\" },\n#endif\n#ifdef SIGBUS\n\t{ SIGBUS,    \"BUS\" },\n#endif\n#ifdef SIGSTKFLT\n\t{ SIGSTKFLT, \"STKFLT\" },\n#endif\n#ifdef SIGCLD\n\t{ SIGCLD,    \"CLD\" },\n#endif\n#ifdef SIGURG\n\t{ SIGURG,    \"URG\" },\n#endif\n#ifdef SIGXCPU\n\t{ SIGXCPU,   \"XCPU\" },\n#endif\n#ifdef SIGXFSZ\n\t{ SIGXFSZ,   \"XFSZ\" },\n#endif\n#ifdef SIGVTALRM\n\t{ SIGVTALRM, \"VTALRM\" },\n#endif\n#ifdef SIGPROF\n\t{ SIGPROF,   \"PROF\" },\n#endif\n#ifdef SIGWINCH\n\t{ SIGWINCH,  \"WINCH\" },\n#endif\n#ifdef SIGIO\n\t{ SIGIO,     \"IO\" },\n#endif\n#ifdef SIGPOLL\n\t{ SIGPOLL,   \"POLL\" },\n#endif\n#ifdef SIGINFO\n\t{ SIGINFO,   \"INFO\" },\n#endif\n#ifdef SIGLOST\n\t{ SIGLOST,   \"LOST\" },\n#endif\n#ifdef SIGPWR\n\t{ SIGPWR,    \"PWR\" },\n#endif\n#ifdef SIGUNUSED\n\t{ SIGUNUSED, \"UNUSED\" },\n#endif\n#ifdef SIGSYS\n\t{ SIGSYS,    \"SYS\" },\n#endif\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "signames[n].name",
            "signame"
          ],
          "line": 1481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rt_sig_num",
          "args": [
            "signame + 2"
          ],
          "line": 1479
        },
        "resolved": true,
        "details": {
          "function_name": "rt_sig_num",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "1453-1469",
          "snippet": "static int rt_sig_num(const char *signame)\n{\n\tint sig_n = 0;\n\tint rtmax = 0;\n\n\tif (strncasecmp(signame, \"max-\", 4) == 0) {\n\t\trtmax = 1;\n\t}\n\tsigname += 4;\n\tif (!isdigit(*signame))\n\t\treturn -1;\n\tsig_n = sig_num(signame);\n\tsig_n = rtmax ? SIGRTMAX - sig_n : SIGRTMIN + sig_n;\n\tif (sig_n > SIGRTMAX || sig_n < SIGRTMIN)\n\t\treturn -1;\n\treturn sig_n;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int rt_sig_num(const char *signame)\n{\n\tint sig_n = 0;\n\tint rtmax = 0;\n\n\tif (strncasecmp(signame, \"max-\", 4) == 0) {\n\t\trtmax = 1;\n\t}\n\tsigname += 4;\n\tif (!isdigit(*signame))\n\t\treturn -1;\n\tsig_n = sig_num(signame);\n\tsig_n = rtmax ? SIGRTMAX - sig_n : SIGRTMIN + sig_n;\n\tif (sig_n > SIGRTMAX || sig_n < SIGRTMIN)\n\t\treturn -1;\n\treturn sig_n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncasecmp",
          "args": [
            "signame",
            "\"rt\"",
            "2"
          ],
          "line": 1478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncasecmp",
          "args": [
            "signame",
            "\"sig\"",
            "3"
          ],
          "line": 1476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*signame"
          ],
          "line": 1474
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic const struct signame signames[] = {\n\t{ SIGHUP,    \"HUP\" },\n\t{ SIGINT,    \"INT\" },\n\t{ SIGQUIT,   \"QUIT\" },\n\t{ SIGILL,    \"ILL\" },\n\t{ SIGABRT,   \"ABRT\" },\n\t{ SIGFPE,    \"FPE\" },\n\t{ SIGKILL,   \"KILL\" },\n\t{ SIGSEGV,   \"SEGV\" },\n\t{ SIGPIPE,   \"PIPE\" },\n\t{ SIGALRM,   \"ALRM\" },\n\t{ SIGTERM,   \"TERM\" },\n\t{ SIGUSR1,   \"USR1\" },\n\t{ SIGUSR2,   \"USR2\" },\n\t{ SIGCHLD,   \"CHLD\" },\n\t{ SIGCONT,   \"CONT\" },\n\t{ SIGSTOP,   \"STOP\" },\n\t{ SIGTSTP,   \"TSTP\" },\n\t{ SIGTTIN,   \"TTIN\" },\n\t{ SIGTTOU,   \"TTOU\" },\n#ifdef SIGTRAP\n\t{ SIGTRAP,   \"TRAP\" },\n#endif\n#ifdef SIGIOT\n\t{ SIGIOT,    \"IOT\" },\n#endif\n#ifdef SIGEMT\n\t{ SIGEMT,    \"EMT\" },\n#endif\n#ifdef SIGBUS\n\t{ SIGBUS,    \"BUS\" },\n#endif\n#ifdef SIGSTKFLT\n\t{ SIGSTKFLT, \"STKFLT\" },\n#endif\n#ifdef SIGCLD\n\t{ SIGCLD,    \"CLD\" },\n#endif\n#ifdef SIGURG\n\t{ SIGURG,    \"URG\" },\n#endif\n#ifdef SIGXCPU\n\t{ SIGXCPU,   \"XCPU\" },\n#endif\n#ifdef SIGXFSZ\n\t{ SIGXFSZ,   \"XFSZ\" },\n#endif\n#ifdef SIGVTALRM\n\t{ SIGVTALRM, \"VTALRM\" },\n#endif\n#ifdef SIGPROF\n\t{ SIGPROF,   \"PROF\" },\n#endif\n#ifdef SIGWINCH\n\t{ SIGWINCH,  \"WINCH\" },\n#endif\n#ifdef SIGIO\n\t{ SIGIO,     \"IO\" },\n#endif\n#ifdef SIGPOLL\n\t{ SIGPOLL,   \"POLL\" },\n#endif\n#ifdef SIGINFO\n\t{ SIGINFO,   \"INFO\" },\n#endif\n#ifdef SIGLOST\n\t{ SIGLOST,   \"LOST\" },\n#endif\n#ifdef SIGPWR\n\t{ SIGPWR,    \"PWR\" },\n#endif\n#ifdef SIGUNUSED\n\t{ SIGUNUSED, \"UNUSED\" },\n#endif\n#ifdef SIGSYS\n\t{ SIGSYS,    \"SYS\" },\n#endif\n};\n\nstatic int sig_parse(const char *signame) {\n\tsize_t n;\n\n\tif (isdigit(*signame)) {\n\t\treturn sig_num(signame);\n\t} else if (strncasecmp(signame, \"sig\", 3) == 0) {\n\t\tsigname += 3;\n\t\tif (strncasecmp(signame, \"rt\", 2) == 0)\n\t\t\treturn rt_sig_num(signame + 2);\n\t\tfor (n = 0; n < sizeof(signames) / sizeof((signames)[0]); n++) {\n\t\t\tif (strcasecmp (signames[n].name, signame) == 0)\n\t\t\t\treturn signames[n].num;\n\t\t}\n\t}\n\treturn -1;\n}"
  },
  {
    "function_name": "rt_sig_num",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1453-1469",
    "snippet": "static int rt_sig_num(const char *signame)\n{\n\tint sig_n = 0;\n\tint rtmax = 0;\n\n\tif (strncasecmp(signame, \"max-\", 4) == 0) {\n\t\trtmax = 1;\n\t}\n\tsigname += 4;\n\tif (!isdigit(*signame))\n\t\treturn -1;\n\tsig_n = sig_num(signame);\n\tsig_n = rtmax ? SIGRTMAX - sig_n : SIGRTMIN + sig_n;\n\tif (sig_n > SIGRTMAX || sig_n < SIGRTMIN)\n\t\treturn -1;\n\treturn sig_n;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sig_num",
          "args": [
            "signame"
          ],
          "line": 1464
        },
        "resolved": true,
        "details": {
          "function_name": "rt_sig_num",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "1453-1469",
          "snippet": "static int rt_sig_num(const char *signame)\n{\n\tint sig_n = 0;\n\tint rtmax = 0;\n\n\tif (strncasecmp(signame, \"max-\", 4) == 0) {\n\t\trtmax = 1;\n\t}\n\tsigname += 4;\n\tif (!isdigit(*signame))\n\t\treturn -1;\n\tsig_n = sig_num(signame);\n\tsig_n = rtmax ? SIGRTMAX - sig_n : SIGRTMIN + sig_n;\n\tif (sig_n > SIGRTMAX || sig_n < SIGRTMIN)\n\t\treturn -1;\n\treturn sig_n;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*signame"
          ],
          "line": 1462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncasecmp",
          "args": [
            "signame",
            "\"max-\"",
            "4"
          ],
          "line": 1458
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int rt_sig_num(const char *signame)\n{\n\tint sig_n = 0;\n\tint rtmax = 0;\n\n\tif (strncasecmp(signame, \"max-\", 4) == 0) {\n\t\trtmax = 1;\n\t}\n\tsigname += 4;\n\tif (!isdigit(*signame))\n\t\treturn -1;\n\tsig_n = sig_num(signame);\n\tsig_n = rtmax ? SIGRTMAX - sig_n : SIGRTMIN + sig_n;\n\tif (sig_n > SIGRTMAX || sig_n < SIGRTMIN)\n\t\treturn -1;\n\treturn sig_n;\n}"
  },
  {
    "function_name": "sig_num",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1441-1451",
    "snippet": "static int sig_num(const char *sig)\n{\n\tint n;\n\tchar *endp = NULL;\n\n\terrno = 0;\n\tn = strtol(sig, &endp, 10);\n\tif (sig == endp || n < 0 || errno != 0)\n\t\treturn -1;\n\treturn n;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtol",
          "args": [
            "sig",
            "&endp",
            "10"
          ],
          "line": 1447
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int sig_num(const char *sig)\n{\n\tint n;\n\tchar *endp = NULL;\n\n\terrno = 0;\n\tn = strtol(sig, &endp, 10);\n\tif (sig == endp || n < 0 || errno != 0)\n\t\treturn -1;\n\treturn n;\n}"
  },
  {
    "function_name": "config_autodev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1427-1439",
    "snippet": "static int config_autodev(const char *key, const char *value,\n\t\t\t  struct lxc_conf *lxc_conf)\n{\n\tif (lxc_safe_uint(value, &lxc_conf->autodev) < 0)\n\t\treturn -1;\n\n\tif (lxc_conf->autodev > 1) {\n\t\tERROR(\"Wrong value for lxc.autodev. Can only be set to 0 or 1\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Wrong value for lxc.autodev. Can only be set to 0 or 1\""
          ],
          "line": 1434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_safe_uint",
          "args": [
            "value",
            "&lxc_conf->autodev"
          ],
          "line": 1430
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_safe_uint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "1985-2003",
          "snippet": "int lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_autodev(const char *key, const char *value,\n\t\t\t  struct lxc_conf *lxc_conf)\n{\n\tif (lxc_safe_uint(value, &lxc_conf->autodev) < 0)\n\t\treturn -1;\n\n\tif (lxc_conf->autodev > 1) {\n\t\tERROR(\"Wrong value for lxc.autodev. Can only be set to 0 or 1\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "config_loglevel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1407-1425",
    "snippet": "static int config_loglevel(const char *key, const char *value,\n\t\t\t     struct lxc_conf *lxc_conf)\n{\n\tint newlevel;\n\n\tif (!value || strlen(value) == 0)\n\t\treturn 0;\n\n\tif (value[0] >= '0' && value[0] <= '9') {\n\t\tif (lxc_safe_int(value, &newlevel) < 0)\n\t\t\treturn -1;\n\t} else {\n\t\tnewlevel = lxc_log_priority_to_int(value);\n\t}\n\t// store these values in the lxc_conf, and then try to set for\n\t// actual current logging.\n\tlxc_conf->loglevel = newlevel;\n\treturn lxc_log_set_level(&lxc_conf->loglevel, newlevel);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_log_set_level",
          "args": [
            "&lxc_conf->loglevel",
            "newlevel"
          ],
          "line": 1424
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_log_set_level",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/log.c",
          "lines": "622-630",
          "snippet": "extern int lxc_log_set_level(int *dest, int level)\n{\n\tif (level < 0 || level >= LXC_LOG_PRIORITY_NOTSET) {\n\t\tERROR(\"invalid log priority %d\", level);\n\t\treturn -1;\n\t}\n\t*dest = level;\n\treturn 0;\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include \"caps.h\"",
            "#include \"log.h\"",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <stdio.h>",
            "#include <syslog.h>",
            "#include <time.h>",
            "#include <pthread.h>",
            "#include <string.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <limits.h>",
            "#include <inttypes.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include \"caps.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <fcntl.h>\n#include <stdio.h>\n#include <syslog.h>\n#include <time.h>\n#include <pthread.h>\n#include <string.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <limits.h>\n#include <inttypes.h>\n#include <errno.h>\n#include <stdio.h>\n#include <stdint.h>\n\nextern int lxc_log_set_level(int *dest, int level)\n{\n\tif (level < 0 || level >= LXC_LOG_PRIORITY_NOTSET) {\n\t\tERROR(\"invalid log priority %d\", level);\n\t\treturn -1;\n\t}\n\t*dest = level;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_log_priority_to_int",
          "args": [
            "value"
          ],
          "line": 1419
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_log_priority_to_int",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/log.h",
          "lines": "178-191",
          "snippet": "static inline int lxc_log_priority_to_int(const char* name)\n{\n\tif (!strcasecmp(\"TRACE\",  name)) return LXC_LOG_PRIORITY_TRACE;\n\tif (!strcasecmp(\"DEBUG\",  name)) return LXC_LOG_PRIORITY_DEBUG;\n\tif (!strcasecmp(\"INFO\",   name)) return LXC_LOG_PRIORITY_INFO;\n\tif (!strcasecmp(\"NOTICE\", name)) return LXC_LOG_PRIORITY_NOTICE;\n\tif (!strcasecmp(\"WARN\",   name)) return LXC_LOG_PRIORITY_WARN;\n\tif (!strcasecmp(\"ERROR\",  name)) return LXC_LOG_PRIORITY_ERROR;\n\tif (!strcasecmp(\"CRIT\",   name)) return LXC_LOG_PRIORITY_CRIT;\n\tif (!strcasecmp(\"ALERT\",  name)) return LXC_LOG_PRIORITY_ALERT;\n\tif (!strcasecmp(\"FATAL\",  name)) return LXC_LOG_PRIORITY_FATAL;\n\n\treturn LXC_LOG_PRIORITY_NOTSET;\n}",
          "includes": [
            "#include \"conf.h\"",
            "#include <time.h>",
            "#include <syslog.h>",
            "#include <stdbool.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <sys/time.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"conf.h\"\n#include <time.h>\n#include <syslog.h>\n#include <stdbool.h>\n#include <strings.h>\n#include <string.h>\n#include <sys/time.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"config.h\"\n\nstatic inline int lxc_log_priority_to_int(const char* name)\n{\n\tif (!strcasecmp(\"TRACE\",  name)) return LXC_LOG_PRIORITY_TRACE;\n\tif (!strcasecmp(\"DEBUG\",  name)) return LXC_LOG_PRIORITY_DEBUG;\n\tif (!strcasecmp(\"INFO\",   name)) return LXC_LOG_PRIORITY_INFO;\n\tif (!strcasecmp(\"NOTICE\", name)) return LXC_LOG_PRIORITY_NOTICE;\n\tif (!strcasecmp(\"WARN\",   name)) return LXC_LOG_PRIORITY_WARN;\n\tif (!strcasecmp(\"ERROR\",  name)) return LXC_LOG_PRIORITY_ERROR;\n\tif (!strcasecmp(\"CRIT\",   name)) return LXC_LOG_PRIORITY_CRIT;\n\tif (!strcasecmp(\"ALERT\",  name)) return LXC_LOG_PRIORITY_ALERT;\n\tif (!strcasecmp(\"FATAL\",  name)) return LXC_LOG_PRIORITY_FATAL;\n\n\treturn LXC_LOG_PRIORITY_NOTSET;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_safe_int",
          "args": [
            "value",
            "&newlevel"
          ],
          "line": 1416
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_safe_int",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "2005-2023",
          "snippet": "int lxc_safe_int(const char *numstr, int *converted)\n{\n\tchar *err = NULL;\n\tsigned long int sli;\n\n\terrno = 0;\n\tsli = strtol(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (sli > INT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (int)sli;\n\treturn 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_safe_int(const char *numstr, int *converted)\n{\n\tchar *err = NULL;\n\tsigned long int sli;\n\n\terrno = 0;\n\tsli = strtol(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (sli > INT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (int)sli;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 1412
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_loglevel(const char *key, const char *value,\n\t\t\t     struct lxc_conf *lxc_conf)\n{\n\tint newlevel;\n\n\tif (!value || strlen(value) == 0)\n\t\treturn 0;\n\n\tif (value[0] >= '0' && value[0] <= '9') {\n\t\tif (lxc_safe_int(value, &newlevel) < 0)\n\t\t\treturn -1;\n\t} else {\n\t\tnewlevel = lxc_log_priority_to_int(value);\n\t}\n\t// store these values in the lxc_conf, and then try to set for\n\t// actual current logging.\n\tlxc_conf->loglevel = newlevel;\n\treturn lxc_log_set_level(&lxc_conf->loglevel, newlevel);\n}"
  },
  {
    "function_name": "config_logfile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1394-1405",
    "snippet": "static int config_logfile(const char *key, const char *value,\n\t\t\t     struct lxc_conf *c)\n{\n\tint ret;\n\n\t// store these values in the lxc_conf, and then try to set for\n\t// actual current logging.\n\tret = config_path_item(&c->logfile, value);\n\tif (ret == 0)\n\t\tret = lxc_log_set_file(&c->logfd, c->logfile);\n\treturn ret;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_log_set_file",
          "args": [
            "&c->logfd",
            "c->logfile"
          ],
          "line": 1403
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_log_set_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/log.c",
          "lines": "650-667",
          "snippet": "extern int lxc_log_set_file(int *fd, const char *fname)\n{\n\tif (*fd != -1) {\n\t\tclose(*fd);\n\t\t*fd = -1;\n\t}\n\n\tif (build_dir(fname)) {\n\t\tERROR(\"failed to create dir for log file \\\"%s\\\" : %s\", fname,\n\t\t\t\tstrerror(errno));\n\t\treturn -1;\n\t}\n\n\t*fd = log_open(fname);\n\tif (*fd == -1)\n\t\treturn -errno;\n\treturn 0;\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include \"caps.h\"",
            "#include \"log.h\"",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <stdio.h>",
            "#include <syslog.h>",
            "#include <time.h>",
            "#include <pthread.h>",
            "#include <string.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <limits.h>",
            "#include <inttypes.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include \"caps.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <fcntl.h>\n#include <stdio.h>\n#include <syslog.h>\n#include <time.h>\n#include <pthread.h>\n#include <string.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <limits.h>\n#include <inttypes.h>\n#include <errno.h>\n#include <stdio.h>\n#include <stdint.h>\n\nextern int lxc_log_set_file(int *fd, const char *fname)\n{\n\tif (*fd != -1) {\n\t\tclose(*fd);\n\t\t*fd = -1;\n\t}\n\n\tif (build_dir(fname)) {\n\t\tERROR(\"failed to create dir for log file \\\"%s\\\" : %s\", fname,\n\t\t\t\tstrerror(errno));\n\t\treturn -1;\n\t}\n\n\t*fd = log_open(fname);\n\tif (*fd == -1)\n\t\treturn -errno;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_path_item",
          "args": [
            "&c->logfile",
            "value"
          ],
          "line": 1401
        },
        "resolved": true,
        "details": {
          "function_name": "config_path_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "359-362",
          "snippet": "static int config_path_item(char **conf_item, const char *value)\n{\n\treturn config_string_item_max(conf_item, value, PATH_MAX);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_path_item(char **conf_item, const char *value)\n{\n\treturn config_string_item_max(conf_item, value, PATH_MAX);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_logfile(const char *key, const char *value,\n\t\t\t     struct lxc_conf *c)\n{\n\tint ret;\n\n\t// store these values in the lxc_conf, and then try to set for\n\t// actual current logging.\n\tret = config_path_item(&c->logfile, value);\n\tif (ret == 0)\n\t\tret = lxc_log_set_file(&c->logfd, c->logfile);\n\treturn ret;\n}"
  },
  {
    "function_name": "config_lsm_se_context",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1388-1392",
    "snippet": "static int config_lsm_se_context(const char *key, const char *value,\n\t\t\t\t struct lxc_conf *lxc_conf)\n{\n\treturn config_string_item(&lxc_conf->lsm_se_context, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_string_item",
          "args": [
            "&lxc_conf->lsm_se_context",
            "value"
          ],
          "line": 1391
        },
        "resolved": true,
        "details": {
          "function_name": "config_string_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "327-346",
          "snippet": "static int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_lsm_se_context(const char *key, const char *value,\n\t\t\t\t struct lxc_conf *lxc_conf)\n{\n\treturn config_string_item(&lxc_conf->lsm_se_context, value);\n}"
  },
  {
    "function_name": "config_lsm_aa_incomplete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1374-1386",
    "snippet": "static int config_lsm_aa_incomplete(const char *key, const char *value,\n\t\t\t\t struct lxc_conf *lxc_conf)\n{\n\tif (lxc_safe_uint(value, &lxc_conf->lsm_aa_allow_incomplete) < 0)\n\t\treturn -1;\n\n\tif (lxc_conf->lsm_aa_allow_incomplete > 1) {\n\t\tERROR(\"Wrong value for lxc.lsm_aa_allow_incomplete. Can only be set to 0 or 1\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Wrong value for lxc.lsm_aa_allow_incomplete. Can only be set to 0 or 1\""
          ],
          "line": 1381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_safe_uint",
          "args": [
            "value",
            "&lxc_conf->lsm_aa_allow_incomplete"
          ],
          "line": 1377
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_safe_uint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "1985-2003",
          "snippet": "int lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_lsm_aa_incomplete(const char *key, const char *value,\n\t\t\t\t struct lxc_conf *lxc_conf)\n{\n\tif (lxc_safe_uint(value, &lxc_conf->lsm_aa_allow_incomplete) < 0)\n\t\treturn -1;\n\n\tif (lxc_conf->lsm_aa_allow_incomplete > 1) {\n\t\tERROR(\"Wrong value for lxc.lsm_aa_allow_incomplete. Can only be set to 0 or 1\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "config_lsm_aa_profile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1368-1372",
    "snippet": "static int config_lsm_aa_profile(const char *key, const char *value,\n\t\t\t\t struct lxc_conf *lxc_conf)\n{\n\treturn config_string_item(&lxc_conf->lsm_aa_profile, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_string_item",
          "args": [
            "&lxc_conf->lsm_aa_profile",
            "value"
          ],
          "line": 1371
        },
        "resolved": true,
        "details": {
          "function_name": "config_string_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "327-346",
          "snippet": "static int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_lsm_aa_profile(const char *key, const char *value,\n\t\t\t\t struct lxc_conf *lxc_conf)\n{\n\treturn config_string_item(&lxc_conf->lsm_aa_profile, value);\n}"
  },
  {
    "function_name": "config_kmsg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1356-1366",
    "snippet": "static int config_kmsg(const char *key, const char *value,\n\t\t\t  struct lxc_conf *lxc_conf)\n{\n\tif (lxc_safe_uint(value, &lxc_conf->kmsg) < 0)\n\t\treturn -1;\n\n\tif (lxc_conf->kmsg > 1)\n\t\treturn -1;\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_safe_uint",
          "args": [
            "value",
            "&lxc_conf->kmsg"
          ],
          "line": 1359
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_safe_uint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "1985-2003",
          "snippet": "int lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_kmsg(const char *key, const char *value,\n\t\t\t  struct lxc_conf *lxc_conf)\n{\n\tif (lxc_safe_uint(value, &lxc_conf->kmsg) < 0)\n\t\treturn -1;\n\n\tif (lxc_conf->kmsg > 1)\n\t\treturn -1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "config_ttydir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1350-1354",
    "snippet": "static int config_ttydir(const char *key, const char *value,\n\t\t\t  struct lxc_conf *lxc_conf)\n{\n\treturn config_string_item_max(&lxc_conf->ttydir, value, NAME_MAX+1);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_string_item_max",
          "args": [
            "&lxc_conf->ttydir",
            "value",
            "NAME_MAX+1"
          ],
          "line": 1353
        },
        "resolved": true,
        "details": {
          "function_name": "config_string_item_max",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "348-357",
          "snippet": "static int config_string_item_max(char **conf_item, const char *value,\n\t\t\t\t  size_t max)\n{\n\tif (strlen(value) >= max) {\n\t\tERROR(\"%s is too long (>= %lu)\", value, (unsigned long)max);\n\t\treturn -1;\n\t}\n\n\treturn config_string_item(conf_item, value);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_string_item_max(char **conf_item, const char *value,\n\t\t\t\t  size_t max)\n{\n\tif (strlen(value) >= max) {\n\t\tERROR(\"%s is too long (>= %lu)\", value, (unsigned long)max);\n\t\treturn -1;\n\t}\n\n\treturn config_string_item(conf_item, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_ttydir(const char *key, const char *value,\n\t\t\t  struct lxc_conf *lxc_conf)\n{\n\treturn config_string_item_max(&lxc_conf->ttydir, value, NAME_MAX+1);\n}"
  },
  {
    "function_name": "config_tty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1341-1348",
    "snippet": "static int config_tty(const char *key, const char *value,\n\t\t      struct lxc_conf *lxc_conf)\n{\n\tif (lxc_safe_uint(value, &lxc_conf->tty) < 0)\n\t\treturn -1;\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_safe_uint",
          "args": [
            "value",
            "&lxc_conf->tty"
          ],
          "line": 1344
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_safe_uint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "1985-2003",
          "snippet": "int lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_tty(const char *key, const char *value,\n\t\t      struct lxc_conf *lxc_conf)\n{\n\tif (lxc_safe_uint(value, &lxc_conf->tty) < 0)\n\t\treturn -1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "config_environment",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1314-1339",
    "snippet": "static int config_environment(const char *key, const char *value,\n                              struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_list *list_item = NULL;\n\n\tif (!strlen(value))\n\t\treturn lxc_clear_environment(lxc_conf);\n\n\tlist_item = malloc(sizeof(*list_item));\n\tif (!list_item)\n\t\tgoto freak_out;\n\n\tlist_item->elem = strdup(value);\n\n\tif (!list_item->elem)\n\t\tgoto freak_out;\n\n\tlxc_list_add_tail(&lxc_conf->environment, list_item);\n\n\treturn 0;\n\nfreak_out:\n\tfree(list_item);\n\n\treturn -1;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "list_item"
          ],
          "line": 1336
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_list_add_tail",
          "args": [
            "&lxc_conf->environment",
            "list_item"
          ],
          "line": 1331
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_add_tail",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "133-137",
          "snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "value"
          ],
          "line": 1326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*list_item)"
          ],
          "line": 1322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_environment",
          "args": [
            "lxc_conf"
          ],
          "line": 1320
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_environment",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4197-4207",
          "snippet": "int lxc_clear_environment(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->environment, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_clear_environment(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->environment, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 1319
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_environment(const char *key, const char *value,\n                              struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_list *list_item = NULL;\n\n\tif (!strlen(value))\n\t\treturn lxc_clear_environment(lxc_conf);\n\n\tlist_item = malloc(sizeof(*list_item));\n\tif (!list_item)\n\t\tgoto freak_out;\n\n\tlist_item->elem = strdup(value);\n\n\tif (!list_item->elem)\n\t\tgoto freak_out;\n\n\tlxc_list_add_tail(&lxc_conf->environment, list_item);\n\n\treturn 0;\n\nfreak_out:\n\tfree(list_item);\n\n\treturn -1;\n}"
  },
  {
    "function_name": "config_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1268-1312",
    "snippet": "static int config_group(const char *key, const char *value,\n\t\t      struct lxc_conf *lxc_conf)\n{\n\tchar *groups, *groupptr, *sptr, *token;\n\tstruct lxc_list *grouplist;\n\tint ret = -1;\n\n\tif (!strlen(value))\n\t\treturn lxc_clear_groups(lxc_conf);\n\n\tgroups = strdup(value);\n\tif (!groups) {\n\t\tSYSERROR(\"failed to dup '%s'\", value);\n\t\treturn -1;\n\t}\n\n\t/* in case several groups are specified in a single line\n\t * split these groups in a single element for the list */\n\tfor (groupptr = groups;;groupptr = NULL) {\n\t\ttoken = strtok_r(groupptr, \" \\t\", &sptr);\n\t\tif (!token) {\n\t\t\tret = 0;\n\t\t\tbreak;\n\t\t}\n\n\t\tgrouplist = malloc(sizeof(*grouplist));\n\t\tif (!grouplist) {\n\t\t\tSYSERROR(\"failed to allocate groups list\");\n\t\t\tbreak;\n\t\t}\n\n\t\tgrouplist->elem = strdup(token);\n\t\tif (!grouplist->elem) {\n\t\t\tSYSERROR(\"failed to dup '%s'\", token);\n\t\t\tfree(grouplist);\n\t\t\tbreak;\n\t\t}\n\n\t\tlxc_list_add_tail(&lxc_conf->groups, grouplist);\n\t}\n\n\tfree(groups);\n\n\treturn ret;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "groups"
          ],
          "line": 1309
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_list_add_tail",
          "args": [
            "&lxc_conf->groups",
            "grouplist"
          ],
          "line": 1306
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_add_tail",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "133-137",
          "snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to dup '%s'\"",
            "token"
          ],
          "line": 1301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "token"
          ],
          "line": 1299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to allocate groups list\""
          ],
          "line": 1295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*grouplist)"
          ],
          "line": 1293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "groupptr",
            "\" \\t\"",
            "&sptr"
          ],
          "line": 1287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to dup '%s'\"",
            "value"
          ],
          "line": 1280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "value"
          ],
          "line": 1278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_groups",
          "args": [
            "lxc_conf"
          ],
          "line": 1276
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_groups",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4185-4195",
          "snippet": "int lxc_clear_groups(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->groups, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_clear_groups(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\n\tlxc_list_for_each_safe(it, &c->groups, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it->elem);\n\t\tfree(it);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 1275
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_group(const char *key, const char *value,\n\t\t      struct lxc_conf *lxc_conf)\n{\n\tchar *groups, *groupptr, *sptr, *token;\n\tstruct lxc_list *grouplist;\n\tint ret = -1;\n\n\tif (!strlen(value))\n\t\treturn lxc_clear_groups(lxc_conf);\n\n\tgroups = strdup(value);\n\tif (!groups) {\n\t\tSYSERROR(\"failed to dup '%s'\", value);\n\t\treturn -1;\n\t}\n\n\t/* in case several groups are specified in a single line\n\t * split these groups in a single element for the list */\n\tfor (groupptr = groups;;groupptr = NULL) {\n\t\ttoken = strtok_r(groupptr, \" \\t\", &sptr);\n\t\tif (!token) {\n\t\t\tret = 0;\n\t\t\tbreak;\n\t\t}\n\n\t\tgrouplist = malloc(sizeof(*grouplist));\n\t\tif (!grouplist) {\n\t\t\tSYSERROR(\"failed to allocate groups list\");\n\t\t\tbreak;\n\t\t}\n\n\t\tgrouplist->elem = strdup(token);\n\t\tif (!grouplist->elem) {\n\t\t\tSYSERROR(\"failed to dup '%s'\", token);\n\t\t\tfree(grouplist);\n\t\t\tbreak;\n\t\t}\n\n\t\tlxc_list_add_tail(&lxc_conf->groups, grouplist);\n\t}\n\n\tfree(groups);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "config_monitor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1256-1266",
    "snippet": "static int config_monitor(const char *key, const char *value,\n\t\t\t  struct lxc_conf *lxc_conf)\n{\n\tif(strcmp(key, \"lxc.monitor.unshare\") == 0) {\n\t\tif (lxc_safe_uint(value, &lxc_conf->monitor_unshare) < 0)\n\t\t\treturn -1;\n\t\treturn 0;\n\t}\n\tSYSERROR(\"Unknown key: %s\", key);\n\treturn -1;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"Unknown key: %s\"",
            "key"
          ],
          "line": 1264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_safe_uint",
          "args": [
            "value",
            "&lxc_conf->monitor_unshare"
          ],
          "line": 1260
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_safe_uint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "1985-2003",
          "snippet": "int lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.monitor.unshare\""
          ],
          "line": 1259
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_monitor(const char *key, const char *value,\n\t\t\t  struct lxc_conf *lxc_conf)\n{\n\tif(strcmp(key, \"lxc.monitor.unshare\") == 0) {\n\t\tif (lxc_safe_uint(value, &lxc_conf->monitor_unshare) < 0)\n\t\t\treturn -1;\n\t\treturn 0;\n\t}\n\tSYSERROR(\"Unknown key: %s\", key);\n\treturn -1;\n}"
  },
  {
    "function_name": "config_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1232-1254",
    "snippet": "static int config_start(const char *key, const char *value,\n\t\t      struct lxc_conf *lxc_conf)\n{\n\tif(strcmp(key, \"lxc.start.auto\") == 0) {\n\t\tif (lxc_safe_uint(value, &lxc_conf->start_auto) < 0)\n\t\t\treturn -1;\n\t\tif (lxc_conf->start_auto > 1)\n\t\t\treturn -1;\n\t\treturn 0;\n\t}\n\telse if (strcmp(key, \"lxc.start.delay\") == 0) {\n\t\tif (lxc_safe_uint(value, &lxc_conf->start_delay) < 0)\n\t\t\treturn -1;\n\t\treturn 0;\n\t}\n\telse if (strcmp(key, \"lxc.start.order\") == 0) {\n\t\tif (lxc_safe_int(value, &lxc_conf->start_order) < 0)\n\t\t\treturn -1;\n\t\treturn 0;\n\t}\n\tSYSERROR(\"Unknown key: %s\", key);\n\treturn -1;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"Unknown key: %s\"",
            "key"
          ],
          "line": 1252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_safe_int",
          "args": [
            "value",
            "&lxc_conf->start_order"
          ],
          "line": 1248
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_safe_int",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "2005-2023",
          "snippet": "int lxc_safe_int(const char *numstr, int *converted)\n{\n\tchar *err = NULL;\n\tsigned long int sli;\n\n\terrno = 0;\n\tsli = strtol(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (sli > INT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (int)sli;\n\treturn 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_safe_int(const char *numstr, int *converted)\n{\n\tchar *err = NULL;\n\tsigned long int sli;\n\n\terrno = 0;\n\tsli = strtol(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (sli > INT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (int)sli;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.start.order\""
          ],
          "line": 1247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_safe_uint",
          "args": [
            "value",
            "&lxc_conf->start_delay"
          ],
          "line": 1243
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_safe_uint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "1985-2003",
          "snippet": "int lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.start.delay\""
          ],
          "line": 1242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.start.auto\""
          ],
          "line": 1235
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_start(const char *key, const char *value,\n\t\t      struct lxc_conf *lxc_conf)\n{\n\tif(strcmp(key, \"lxc.start.auto\") == 0) {\n\t\tif (lxc_safe_uint(value, &lxc_conf->start_auto) < 0)\n\t\t\treturn -1;\n\t\tif (lxc_conf->start_auto > 1)\n\t\t\treturn -1;\n\t\treturn 0;\n\t}\n\telse if (strcmp(key, \"lxc.start.delay\") == 0) {\n\t\tif (lxc_safe_uint(value, &lxc_conf->start_delay) < 0)\n\t\t\treturn -1;\n\t\treturn 0;\n\t}\n\telse if (strcmp(key, \"lxc.start.order\") == 0) {\n\t\tif (lxc_safe_int(value, &lxc_conf->start_order) < 0)\n\t\t\treturn -1;\n\t\treturn 0;\n\t}\n\tSYSERROR(\"Unknown key: %s\", key);\n\treturn -1;\n}"
  },
  {
    "function_name": "config_pts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1223-1230",
    "snippet": "static int config_pts(const char *key, const char *value,\n\t\t      struct lxc_conf *lxc_conf)\n{\n\tif (lxc_safe_uint(value, &lxc_conf->pts) < 0)\n\t\treturn -1;\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_safe_uint",
          "args": [
            "value",
            "&lxc_conf->pts"
          ],
          "line": 1226
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_safe_uint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "1985-2003",
          "snippet": "int lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_pts(const char *key, const char *value,\n\t\t      struct lxc_conf *lxc_conf)\n{\n\tif (lxc_safe_uint(value, &lxc_conf->pts) < 0)\n\t\treturn -1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "config_personality",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1210-1221",
    "snippet": "static int config_personality(const char *key, const char *value,\n\t\t\t      struct lxc_conf *lxc_conf)\n{\n\tsigned long personality = lxc_config_parse_arch(value);\n\n\tif (personality >= 0)\n\t\tlxc_conf->personality = personality;\n\telse\n\t\tWARN(\"unsupported personality '%s'\", value);\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "\"unsupported personality '%s'\"",
            "value"
          ],
          "line": 1218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_config_parse_arch",
          "args": [
            "value"
          ],
          "line": 1213
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_config_parse_arch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2165-2211",
          "snippet": "signed long lxc_config_parse_arch(const char *arch)\n{\n\t#if HAVE_SYS_PERSONALITY_H\n\tstruct per_name {\n\t\tchar *name;\n\t\tunsigned long per;\n\t} pername[] = {\n\t\t{ \"x86\", PER_LINUX32 },\n\t\t{ \"linux32\", PER_LINUX32 },\n\t\t{ \"i386\", PER_LINUX32 },\n\t\t{ \"i486\", PER_LINUX32 },\n\t\t{ \"i586\", PER_LINUX32 },\n\t\t{ \"i686\", PER_LINUX32 },\n\t\t{ \"athlon\", PER_LINUX32 },\n\t\t{ \"mips\", PER_LINUX32 },\n\t\t{ \"mipsel\", PER_LINUX32 },\n\t\t{ \"ppc\", PER_LINUX32 },\n\t\t{ \"arm\", PER_LINUX32 },\n\t\t{ \"armv7l\", PER_LINUX32 },\n\t\t{ \"armhf\", PER_LINUX32 },\n\t\t{ \"armel\", PER_LINUX32 },\n\t\t{ \"powerpc\", PER_LINUX32 },\n\t\t{ \"linux64\", PER_LINUX },\n\t\t{ \"x86_64\", PER_LINUX },\n\t\t{ \"amd64\", PER_LINUX },\n\t\t{ \"mips64\", PER_LINUX },\n\t\t{ \"mips64el\", PER_LINUX },\n\t\t{ \"ppc64\", PER_LINUX },\n\t\t{ \"ppc64le\", PER_LINUX },\n\t\t{ \"ppc64el\", PER_LINUX },\n\t\t{ \"powerpc64\", PER_LINUX },\n\t\t{ \"s390x\", PER_LINUX },\n\t\t{ \"aarch64\", PER_LINUX },\n\t\t{ \"arm64\", PER_LINUX },\n\t};\n\tsize_t len = sizeof(pername) / sizeof(pername[0]);\n\n\tsize_t i;\n\n\tfor (i = 0; i < len; i++) {\n\t\tif (!strcmp(pername[i].name, arch))\n\t\t    return pername[i].per;\n\t}\n\t#endif\n\n\treturn -1;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nsigned long lxc_config_parse_arch(const char *arch)\n{\n\t#if HAVE_SYS_PERSONALITY_H\n\tstruct per_name {\n\t\tchar *name;\n\t\tunsigned long per;\n\t} pername[] = {\n\t\t{ \"x86\", PER_LINUX32 },\n\t\t{ \"linux32\", PER_LINUX32 },\n\t\t{ \"i386\", PER_LINUX32 },\n\t\t{ \"i486\", PER_LINUX32 },\n\t\t{ \"i586\", PER_LINUX32 },\n\t\t{ \"i686\", PER_LINUX32 },\n\t\t{ \"athlon\", PER_LINUX32 },\n\t\t{ \"mips\", PER_LINUX32 },\n\t\t{ \"mipsel\", PER_LINUX32 },\n\t\t{ \"ppc\", PER_LINUX32 },\n\t\t{ \"arm\", PER_LINUX32 },\n\t\t{ \"armv7l\", PER_LINUX32 },\n\t\t{ \"armhf\", PER_LINUX32 },\n\t\t{ \"armel\", PER_LINUX32 },\n\t\t{ \"powerpc\", PER_LINUX32 },\n\t\t{ \"linux64\", PER_LINUX },\n\t\t{ \"x86_64\", PER_LINUX },\n\t\t{ \"amd64\", PER_LINUX },\n\t\t{ \"mips64\", PER_LINUX },\n\t\t{ \"mips64el\", PER_LINUX },\n\t\t{ \"ppc64\", PER_LINUX },\n\t\t{ \"ppc64le\", PER_LINUX },\n\t\t{ \"ppc64el\", PER_LINUX },\n\t\t{ \"powerpc64\", PER_LINUX },\n\t\t{ \"s390x\", PER_LINUX },\n\t\t{ \"aarch64\", PER_LINUX },\n\t\t{ \"arm64\", PER_LINUX },\n\t};\n\tsize_t len = sizeof(pername) / sizeof(pername[0]);\n\n\tsize_t i;\n\n\tfor (i = 0; i < len; i++) {\n\t\tif (!strcmp(pername[i].name, arch))\n\t\t    return pername[i].per;\n\t}\n\t#endif\n\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_personality(const char *key, const char *value,\n\t\t\t      struct lxc_conf *lxc_conf)\n{\n\tsigned long personality = lxc_config_parse_arch(value);\n\n\tif (personality >= 0)\n\t\tlxc_conf->personality = personality;\n\telse\n\t\tWARN(\"unsupported personality '%s'\", value);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "config_hook",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1170-1208",
    "snippet": "static int config_hook(const char *key, const char *value,\n\t\t\t\t struct lxc_conf *lxc_conf)\n{\n\tchar *copy;\n\n\tif (!value || strlen(value) == 0)\n\t\treturn lxc_clear_hooks(lxc_conf, key);\n\n\tif (strcmp(key, \"lxc.hook\") == 0) {\n\t\tERROR(\"lxc.hook cannot take a value\");\n\t\treturn -1;\n\t}\n\tcopy = strdup(value);\n\tif (!copy) {\n\t\tSYSERROR(\"failed to dup string '%s'\", value);\n\t\treturn -1;\n\t}\n\tif (strcmp(key, \"lxc.hook.pre-start\") == 0)\n\t\treturn add_hook(lxc_conf, LXCHOOK_PRESTART, copy);\n\telse if (strcmp(key, \"lxc.hook.pre-mount\") == 0)\n\t\treturn add_hook(lxc_conf, LXCHOOK_PREMOUNT, copy);\n\telse if (strcmp(key, \"lxc.hook.autodev\") == 0)\n\t\treturn add_hook(lxc_conf, LXCHOOK_AUTODEV, copy);\n\telse if (strcmp(key, \"lxc.hook.mount\") == 0)\n\t\treturn add_hook(lxc_conf, LXCHOOK_MOUNT, copy);\n\telse if (strcmp(key, \"lxc.hook.start\") == 0)\n\t\treturn add_hook(lxc_conf, LXCHOOK_START, copy);\n\telse if (strcmp(key, \"lxc.hook.stop\") == 0)\n\t\treturn add_hook(lxc_conf, LXCHOOK_STOP, copy);\n\telse if (strcmp(key, \"lxc.hook.post-stop\") == 0)\n\t\treturn add_hook(lxc_conf, LXCHOOK_POSTSTOP, copy);\n\telse if (strcmp(key, \"lxc.hook.clone\") == 0)\n\t\treturn add_hook(lxc_conf, LXCHOOK_CLONE, copy);\n\telse if (strcmp(key, \"lxc.hook.destroy\") == 0)\n\t\treturn add_hook(lxc_conf, LXCHOOK_DESTROY, copy);\n\tSYSERROR(\"Unknown key: %s\", key);\n\tfree(copy);\n\treturn -1;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "copy"
          ],
          "line": 1206
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"Unknown key: %s\"",
            "key"
          ],
          "line": 1205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "add_hook",
          "args": [
            "lxc_conf",
            "LXCHOOK_DESTROY",
            "copy"
          ],
          "line": 1204
        },
        "resolved": true,
        "details": {
          "function_name": "add_hook",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "1120-1132",
          "snippet": "static int add_hook(struct lxc_conf *lxc_conf, int which, char *hook)\n{\n\tstruct lxc_list *hooklist;\n\n\thooklist = malloc(sizeof(*hooklist));\n\tif (!hooklist) {\n\t\tfree(hook);\n\t\treturn -1;\n\t}\n\thooklist->elem = hook;\n\tlxc_list_add_tail(&lxc_conf->hooks[which], hooklist);\n\treturn 0;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int add_hook(struct lxc_conf *lxc_conf, int which, char *hook)\n{\n\tstruct lxc_list *hooklist;\n\n\thooklist = malloc(sizeof(*hooklist));\n\tif (!hooklist) {\n\t\tfree(hook);\n\t\treturn -1;\n\t}\n\thooklist->elem = hook;\n\tlxc_list_add_tail(&lxc_conf->hooks[which], hooklist);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.hook.destroy\""
          ],
          "line": 1203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.hook.clone\""
          ],
          "line": 1201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.hook.post-stop\""
          ],
          "line": 1199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.hook.stop\""
          ],
          "line": 1197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.hook.start\""
          ],
          "line": 1195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.hook.mount\""
          ],
          "line": 1193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.hook.autodev\""
          ],
          "line": 1191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.hook.pre-mount\""
          ],
          "line": 1189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.hook.pre-start\""
          ],
          "line": 1187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to dup string '%s'\"",
            "value"
          ],
          "line": 1184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "value"
          ],
          "line": 1182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"lxc.hook cannot take a value\""
          ],
          "line": 1179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "key",
            "\"lxc.hook\""
          ],
          "line": 1178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_hooks",
          "args": [
            "lxc_conf",
            "key"
          ],
          "line": 1176
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_hooks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4228-4254",
          "snippet": "int lxc_clear_hooks(struct lxc_conf *c, const char *key)\n{\n\tstruct lxc_list *it,*next;\n\tbool all = false, done = false;\n\tconst char *k = key + 9;\n\tint i;\n\n\tif (strcmp(key, \"lxc.hook\") == 0)\n\t\tall = true;\n\n\tfor (i=0; i<NUM_LXC_HOOKS; i++) {\n\t\tif (all || strcmp(k, lxchook_names[i]) == 0) {\n\t\t\tlxc_list_for_each_safe(it, &c->hooks[i], next) {\n\t\t\t\tlxc_list_del(it);\n\t\t\t\tfree(it->elem);\n\t\t\t\tfree(it);\n\t\t\t}\n\t\t\tdone = true;\n\t\t}\n\t}\n\n\tif (!done) {\n\t\tERROR(\"Invalid hook key: %s\", key);\n\t\treturn -1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "char *lxchook_names[NUM_LXC_HOOKS] = {\n\t\"pre-start\", \"pre-mount\", \"mount\", \"autodev\", \"start\", \"stop\", \"post-stop\", \"clone\", \"destroy\" };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nchar *lxchook_names[NUM_LXC_HOOKS] = {\n\t\"pre-start\", \"pre-mount\", \"mount\", \"autodev\", \"start\", \"stop\", \"post-stop\", \"clone\", \"destroy\" };\n\nint lxc_clear_hooks(struct lxc_conf *c, const char *key)\n{\n\tstruct lxc_list *it,*next;\n\tbool all = false, done = false;\n\tconst char *k = key + 9;\n\tint i;\n\n\tif (strcmp(key, \"lxc.hook\") == 0)\n\t\tall = true;\n\n\tfor (i=0; i<NUM_LXC_HOOKS; i++) {\n\t\tif (all || strcmp(k, lxchook_names[i]) == 0) {\n\t\t\tlxc_list_for_each_safe(it, &c->hooks[i], next) {\n\t\t\t\tlxc_list_del(it);\n\t\t\t\tfree(it->elem);\n\t\t\t\tfree(it);\n\t\t\t}\n\t\t\tdone = true;\n\t\t}\n\t}\n\n\tif (!done) {\n\t\tERROR(\"Invalid hook key: %s\", key);\n\t\treturn -1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 1175
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_hook(const char *key, const char *value,\n\t\t\t\t struct lxc_conf *lxc_conf)\n{\n\tchar *copy;\n\n\tif (!value || strlen(value) == 0)\n\t\treturn lxc_clear_hooks(lxc_conf, key);\n\n\tif (strcmp(key, \"lxc.hook\") == 0) {\n\t\tERROR(\"lxc.hook cannot take a value\");\n\t\treturn -1;\n\t}\n\tcopy = strdup(value);\n\tif (!copy) {\n\t\tSYSERROR(\"failed to dup string '%s'\", value);\n\t\treturn -1;\n\t}\n\tif (strcmp(key, \"lxc.hook.pre-start\") == 0)\n\t\treturn add_hook(lxc_conf, LXCHOOK_PRESTART, copy);\n\telse if (strcmp(key, \"lxc.hook.pre-mount\") == 0)\n\t\treturn add_hook(lxc_conf, LXCHOOK_PREMOUNT, copy);\n\telse if (strcmp(key, \"lxc.hook.autodev\") == 0)\n\t\treturn add_hook(lxc_conf, LXCHOOK_AUTODEV, copy);\n\telse if (strcmp(key, \"lxc.hook.mount\") == 0)\n\t\treturn add_hook(lxc_conf, LXCHOOK_MOUNT, copy);\n\telse if (strcmp(key, \"lxc.hook.start\") == 0)\n\t\treturn add_hook(lxc_conf, LXCHOOK_START, copy);\n\telse if (strcmp(key, \"lxc.hook.stop\") == 0)\n\t\treturn add_hook(lxc_conf, LXCHOOK_STOP, copy);\n\telse if (strcmp(key, \"lxc.hook.post-stop\") == 0)\n\t\treturn add_hook(lxc_conf, LXCHOOK_POSTSTOP, copy);\n\telse if (strcmp(key, \"lxc.hook.clone\") == 0)\n\t\treturn add_hook(lxc_conf, LXCHOOK_CLONE, copy);\n\telse if (strcmp(key, \"lxc.hook.destroy\") == 0)\n\t\treturn add_hook(lxc_conf, LXCHOOK_DESTROY, copy);\n\tSYSERROR(\"Unknown key: %s\", key);\n\tfree(copy);\n\treturn -1;\n}"
  },
  {
    "function_name": "config_init_gid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1158-1168",
    "snippet": "static int config_init_gid(const char *key, const char *value,\n\t\t\t\t struct lxc_conf *lxc_conf)\n{\n\tunsigned int init_gid;\n\n\tif (lxc_safe_uint(value, &init_gid) < 0)\n\t\treturn -1;\n\tlxc_conf->init_gid = init_gid;\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_safe_uint",
          "args": [
            "value",
            "&init_gid"
          ],
          "line": 1163
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_safe_uint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "1985-2003",
          "snippet": "int lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_init_gid(const char *key, const char *value,\n\t\t\t\t struct lxc_conf *lxc_conf)\n{\n\tunsigned int init_gid;\n\n\tif (lxc_safe_uint(value, &init_gid) < 0)\n\t\treturn -1;\n\tlxc_conf->init_gid = init_gid;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "config_init_uid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1146-1156",
    "snippet": "static int config_init_uid(const char *key, const char *value,\n\t\t\t\t struct lxc_conf *lxc_conf)\n{\n\tunsigned int init_uid;\n\n\tif (lxc_safe_uint(value, &init_uid) < 0)\n\t\treturn -1;\n\tlxc_conf->init_uid = init_uid;\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_safe_uint",
          "args": [
            "value",
            "&init_uid"
          ],
          "line": 1151
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_safe_uint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "1985-2003",
          "snippet": "int lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_init_uid(const char *key, const char *value,\n\t\t\t\t struct lxc_conf *lxc_conf)\n{\n\tunsigned int init_uid;\n\n\tif (lxc_safe_uint(value, &init_uid) < 0)\n\t\treturn -1;\n\tlxc_conf->init_uid = init_uid;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "config_init_cmd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1140-1144",
    "snippet": "static int config_init_cmd(const char *key, const char *value,\n\t\t\t\t struct lxc_conf *lxc_conf)\n{\n\treturn config_path_item(&lxc_conf->init_cmd, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_path_item",
          "args": [
            "&lxc_conf->init_cmd",
            "value"
          ],
          "line": 1143
        },
        "resolved": true,
        "details": {
          "function_name": "config_path_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "359-362",
          "snippet": "static int config_path_item(char **conf_item, const char *value)\n{\n\treturn config_string_item_max(conf_item, value, PATH_MAX);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_path_item(char **conf_item, const char *value)\n{\n\treturn config_string_item_max(conf_item, value, PATH_MAX);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_init_cmd(const char *key, const char *value,\n\t\t\t\t struct lxc_conf *lxc_conf)\n{\n\treturn config_path_item(&lxc_conf->init_cmd, value);\n}"
  },
  {
    "function_name": "config_seccomp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1134-1138",
    "snippet": "static int config_seccomp(const char *key, const char *value,\n\t\t\t\t struct lxc_conf *lxc_conf)\n{\n\treturn config_path_item(&lxc_conf->seccomp, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_path_item",
          "args": [
            "&lxc_conf->seccomp",
            "value"
          ],
          "line": 1137
        },
        "resolved": true,
        "details": {
          "function_name": "config_path_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "359-362",
          "snippet": "static int config_path_item(char **conf_item, const char *value)\n{\n\treturn config_string_item_max(conf_item, value, PATH_MAX);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_path_item(char **conf_item, const char *value)\n{\n\treturn config_string_item_max(conf_item, value, PATH_MAX);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_seccomp(const char *key, const char *value,\n\t\t\t\t struct lxc_conf *lxc_conf)\n{\n\treturn config_path_item(&lxc_conf->seccomp, value);\n}"
  },
  {
    "function_name": "add_hook",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1120-1132",
    "snippet": "static int add_hook(struct lxc_conf *lxc_conf, int which, char *hook)\n{\n\tstruct lxc_list *hooklist;\n\n\thooklist = malloc(sizeof(*hooklist));\n\tif (!hooklist) {\n\t\tfree(hook);\n\t\treturn -1;\n\t}\n\thooklist->elem = hook;\n\tlxc_list_add_tail(&lxc_conf->hooks[which], hooklist);\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_list_add_tail",
          "args": [
            "&lxc_conf->hooks[which]",
            "hooklist"
          ],
          "line": 1130
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_add_tail",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "133-137",
          "snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "hook"
          ],
          "line": 1126
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*hooklist)"
          ],
          "line": 1124
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nstatic int add_hook(struct lxc_conf *lxc_conf, int which, char *hook)\n{\n\tstruct lxc_list *hooklist;\n\n\thooklist = malloc(sizeof(*hooklist));\n\tif (!hooklist) {\n\t\tfree(hook);\n\t\treturn -1;\n\t}\n\thooklist->elem = hook;\n\tlxc_list_add_tail(&lxc_conf->hooks[which], hooklist);\n\treturn 0;\n}"
  },
  {
    "function_name": "config_network_script_down",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1108-1118",
    "snippet": "static int config_network_script_down(const char *key, const char *value,\n\t\t\t\t      struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n \t\treturn -1;\n\n\treturn config_string_item(&netdev->downscript, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_string_item",
          "args": [
            "&netdev->downscript",
            "value"
          ],
          "line": 1117
        },
        "resolved": true,
        "details": {
          "function_name": "config_string_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "327-346",
          "snippet": "static int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "network_netdev",
          "args": [
            "key",
            "value",
            "&lxc_conf->network"
          ],
          "line": 1113
        },
        "resolved": true,
        "details": {
          "function_name": "network_netdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "565-588",
          "snippet": "static struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_network_script_down(const char *key, const char *value,\n\t\t\t\t      struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n \t\treturn -1;\n\n\treturn config_string_item(&netdev->downscript, value);\n}"
  },
  {
    "function_name": "config_network_script_up",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1096-1106",
    "snippet": "static int config_network_script_up(const char *key, const char *value,\n\t\t\t\t    struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n \t\treturn -1;\n\n\treturn config_string_item(&netdev->upscript, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_string_item",
          "args": [
            "&netdev->upscript",
            "value"
          ],
          "line": 1105
        },
        "resolved": true,
        "details": {
          "function_name": "config_string_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "327-346",
          "snippet": "static int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "network_netdev",
          "args": [
            "key",
            "value",
            "&lxc_conf->network"
          ],
          "line": 1101
        },
        "resolved": true,
        "details": {
          "function_name": "network_netdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "565-588",
          "snippet": "static struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_network_script_up(const char *key, const char *value,\n\t\t\t\t    struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n \t\treturn -1;\n\n\treturn config_string_item(&netdev->upscript, value);\n}"
  },
  {
    "function_name": "config_network_ipv6_gateway",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "1058-1094",
    "snippet": "static int config_network_ipv6_gateway(const char *key, const char *value,\n\t\t\t               struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tfree(netdev->ipv6_gateway);\n\n\tif (!value || strlen(value) == 0) {\n\t\tnetdev->ipv6_gateway = NULL;\n\t} else if (!strcmp(value, \"auto\")) {\n\t\tnetdev->ipv6_gateway = NULL;\n\t\tnetdev->ipv6_gateway_auto = true;\n\t} else {\n\t\tstruct in6_addr *gw;\n\n\t\tgw = malloc(sizeof(*gw));\n\t\tif (!gw) {\n\t\t\tSYSERROR(\"failed to allocate ipv6 gateway address\");\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (!inet_pton(AF_INET6, value, gw)) {\n\t\t\tSYSERROR(\"invalid ipv6 gateway address: %s\", value);\n\t\t\tfree(gw);\n\t\t\treturn -1;\n\t\t}\n\n\t\tnetdev->ipv6_gateway = gw;\n\t\tnetdev->ipv6_gateway_auto = false;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "gw"
          ],
          "line": 1085
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"invalid ipv6 gateway address: %s\"",
            "value"
          ],
          "line": 1084
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inet_pton",
          "args": [
            "AF_INET6",
            "value",
            "gw"
          ],
          "line": 1083
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to allocate ipv6 gateway address\""
          ],
          "line": 1079
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*gw)"
          ],
          "line": 1077
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "value",
            "\"auto\""
          ],
          "line": 1071
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 1069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_netdev",
          "args": [
            "key",
            "value",
            "&lxc_conf->network"
          ],
          "line": 1063
        },
        "resolved": true,
        "details": {
          "function_name": "network_netdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "565-588",
          "snippet": "static struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_network_ipv6_gateway(const char *key, const char *value,\n\t\t\t               struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tfree(netdev->ipv6_gateway);\n\n\tif (!value || strlen(value) == 0) {\n\t\tnetdev->ipv6_gateway = NULL;\n\t} else if (!strcmp(value, \"auto\")) {\n\t\tnetdev->ipv6_gateway = NULL;\n\t\tnetdev->ipv6_gateway_auto = true;\n\t} else {\n\t\tstruct in6_addr *gw;\n\n\t\tgw = malloc(sizeof(*gw));\n\t\tif (!gw) {\n\t\t\tSYSERROR(\"failed to allocate ipv6 gateway address\");\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (!inet_pton(AF_INET6, value, gw)) {\n\t\t\tSYSERROR(\"invalid ipv6 gateway address: %s\", value);\n\t\t\tfree(gw);\n\t\t\treturn -1;\n\t\t}\n\n\t\tnetdev->ipv6_gateway = gw;\n\t\tnetdev->ipv6_gateway_auto = false;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "config_network_ipv6",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "994-1056",
    "snippet": "static int config_network_ipv6(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\tstruct lxc_inet6dev *inet6dev;\n\tstruct lxc_list *list;\n\tchar *slash,*valdup;\n\tchar *netmask;\n\n\tif (!value || !strlen(value))\n\t\treturn lxc_clear_config_item(lxc_conf, key);\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tinet6dev = malloc(sizeof(*inet6dev));\n\tif (!inet6dev) {\n\t\tSYSERROR(\"failed to allocate ipv6 address\");\n\t\treturn -1;\n\t}\n\tmemset(inet6dev, 0, sizeof(*inet6dev));\n\n\tlist = malloc(sizeof(*list));\n\tif (!list) {\n\t\tSYSERROR(\"failed to allocate memory\");\n\t\tfree(inet6dev);\n\t\treturn -1;\n\t}\n\n\tlxc_list_init(list);\n\tlist->elem = inet6dev;\n\n\tvaldup = strdup(value);\n\tif (!valdup) {\n\t\tERROR(\"no address specified\");\n\t\tfree(list);\n\t\tfree(inet6dev);\n\t\treturn -1;\n\t}\n\n\tinet6dev->prefix = 64;\n\tslash = strstr(valdup, \"/\");\n\tif (slash) {\n\t\t*slash = '\\0';\n\t\tnetmask = slash + 1;\n\t\tif (lxc_safe_uint(netmask, &inet6dev->prefix) < 0)\n\t\t\treturn -1;\n\t}\n\n\tif (!inet_pton(AF_INET6, valdup, &inet6dev->addr)) {\n\t\tSYSERROR(\"invalid ipv6 address: %s\", valdup);\n\t\tfree(list);\n\t\tfree(inet6dev);\n\t\tfree(valdup);\n\t\treturn -1;\n\t}\n\n\tlxc_list_add_tail(&netdev->ipv6, list);\n\n\tfree(valdup);\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "valdup"
          ],
          "line": 1054
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_list_add_tail",
          "args": [
            "&netdev->ipv6",
            "list"
          ],
          "line": 1052
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_add_tail",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "133-137",
          "snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"invalid ipv6 address: %s\"",
            "valdup"
          ],
          "line": 1045
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inet_pton",
          "args": [
            "AF_INET6",
            "valdup",
            "&inet6dev->addr"
          ],
          "line": 1044
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_safe_uint",
          "args": [
            "netmask",
            "&inet6dev->prefix"
          ],
          "line": 1040
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_safe_uint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "1985-2003",
          "snippet": "int lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "valdup",
            "\"/\""
          ],
          "line": 1036
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"no address specified\""
          ],
          "line": 1029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "value"
          ],
          "line": 1027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_list_init",
          "args": [
            "list"
          ],
          "line": 1024
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "68-72",
          "snippet": "static inline void lxc_list_init(struct lxc_list *list)\n{\n\tlist->elem = NULL;\n\tlist->next = list->prev = list;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void lxc_list_init(struct lxc_list *list)\n{\n\tlist->elem = NULL;\n\tlist->next = list->prev = list;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to allocate memory\""
          ],
          "line": 1019
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*list)"
          ],
          "line": 1017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "inet6dev",
            "0",
            "sizeof(*inet6dev)"
          ],
          "line": 1015
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to allocate ipv6 address\""
          ],
          "line": 1012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*inet6dev)"
          ],
          "line": 1010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_netdev",
          "args": [
            "key",
            "value",
            "&lxc_conf->network"
          ],
          "line": 1006
        },
        "resolved": true,
        "details": {
          "function_name": "network_netdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "565-588",
          "snippet": "static struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_clear_config_item",
          "args": [
            "lxc_conf",
            "key"
          ],
          "line": 1004
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_config_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2690-2715",
          "snippet": "int lxc_clear_config_item(struct lxc_conf *c, const char *key)\n{\n\tif (strcmp(key, \"lxc.network\") == 0)\n\t\treturn lxc_clear_config_network(c);\n\telse if (strncmp(key, \"lxc.network.\", 12) == 0)\n\t\treturn lxc_clear_nic(c, key + 12);\n\telse if (strcmp(key, \"lxc.cap.drop\") == 0)\n\t\treturn lxc_clear_config_caps(c);\n\telse if (strcmp(key, \"lxc.cap.keep\") == 0)\n\t\treturn lxc_clear_config_keepcaps(c);\n\telse if (strncmp(key, \"lxc.cgroup\", 10) == 0)\n\t\treturn lxc_clear_cgroups(c, key);\n\telse if (strcmp(key, \"lxc.mount.entry\") == 0)\n\t\treturn lxc_clear_mount_entries(c);\n\telse if (strcmp(key, \"lxc.mount.auto\") == 0)\n\t\treturn lxc_clear_automounts(c);\n\telse if (strncmp(key, \"lxc.hook\", 8) == 0)\n\t\treturn lxc_clear_hooks(c, key);\n\telse if (strncmp(key, \"lxc.group\", 9) == 0)\n\t\treturn lxc_clear_groups(c);\n\telse if (strncmp(key, \"lxc.environment\", 15) == 0)\n\t\treturn lxc_clear_environment(c);\n\telse if (strncmp(key, \"lxc.id_map\", 10) == 0)\n\t\treturn lxc_clear_idmaps(c);\n\treturn -1;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nint lxc_clear_config_item(struct lxc_conf *c, const char *key)\n{\n\tif (strcmp(key, \"lxc.network\") == 0)\n\t\treturn lxc_clear_config_network(c);\n\telse if (strncmp(key, \"lxc.network.\", 12) == 0)\n\t\treturn lxc_clear_nic(c, key + 12);\n\telse if (strcmp(key, \"lxc.cap.drop\") == 0)\n\t\treturn lxc_clear_config_caps(c);\n\telse if (strcmp(key, \"lxc.cap.keep\") == 0)\n\t\treturn lxc_clear_config_keepcaps(c);\n\telse if (strncmp(key, \"lxc.cgroup\", 10) == 0)\n\t\treturn lxc_clear_cgroups(c, key);\n\telse if (strcmp(key, \"lxc.mount.entry\") == 0)\n\t\treturn lxc_clear_mount_entries(c);\n\telse if (strcmp(key, \"lxc.mount.auto\") == 0)\n\t\treturn lxc_clear_automounts(c);\n\telse if (strncmp(key, \"lxc.hook\", 8) == 0)\n\t\treturn lxc_clear_hooks(c, key);\n\telse if (strncmp(key, \"lxc.group\", 9) == 0)\n\t\treturn lxc_clear_groups(c);\n\telse if (strncmp(key, \"lxc.environment\", 15) == 0)\n\t\treturn lxc_clear_environment(c);\n\telse if (strncmp(key, \"lxc.id_map\", 10) == 0)\n\t\treturn lxc_clear_idmaps(c);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 1003
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_network_ipv6(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\tstruct lxc_inet6dev *inet6dev;\n\tstruct lxc_list *list;\n\tchar *slash,*valdup;\n\tchar *netmask;\n\n\tif (!value || !strlen(value))\n\t\treturn lxc_clear_config_item(lxc_conf, key);\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tinet6dev = malloc(sizeof(*inet6dev));\n\tif (!inet6dev) {\n\t\tSYSERROR(\"failed to allocate ipv6 address\");\n\t\treturn -1;\n\t}\n\tmemset(inet6dev, 0, sizeof(*inet6dev));\n\n\tlist = malloc(sizeof(*list));\n\tif (!list) {\n\t\tSYSERROR(\"failed to allocate memory\");\n\t\tfree(inet6dev);\n\t\treturn -1;\n\t}\n\n\tlxc_list_init(list);\n\tlist->elem = inet6dev;\n\n\tvaldup = strdup(value);\n\tif (!valdup) {\n\t\tERROR(\"no address specified\");\n\t\tfree(list);\n\t\tfree(inet6dev);\n\t\treturn -1;\n\t}\n\n\tinet6dev->prefix = 64;\n\tslash = strstr(valdup, \"/\");\n\tif (slash) {\n\t\t*slash = '\\0';\n\t\tnetmask = slash + 1;\n\t\tif (lxc_safe_uint(netmask, &inet6dev->prefix) < 0)\n\t\t\treturn -1;\n\t}\n\n\tif (!inet_pton(AF_INET6, valdup, &inet6dev->addr)) {\n\t\tSYSERROR(\"invalid ipv6 address: %s\", valdup);\n\t\tfree(list);\n\t\tfree(inet6dev);\n\t\tfree(valdup);\n\t\treturn -1;\n\t}\n\n\tlxc_list_add_tail(&netdev->ipv6, list);\n\n\tfree(valdup);\n\treturn 0;\n}"
  },
  {
    "function_name": "config_network_ipv4_gateway",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "956-992",
    "snippet": "static int config_network_ipv4_gateway(const char *key, const char *value,\n\t\t\t               struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tfree(netdev->ipv4_gateway);\n\n\tif (!value || strlen(value) == 0) {\n\t\tnetdev->ipv4_gateway = NULL;\n\t} else if (!strcmp(value, \"auto\")) {\n\t\tnetdev->ipv4_gateway = NULL;\n\t\tnetdev->ipv4_gateway_auto = true;\n\t} else {\n\t\tstruct in_addr *gw;\n\n\t\tgw = malloc(sizeof(*gw));\n\t\tif (!gw) {\n\t\t\tSYSERROR(\"failed to allocate ipv4 gateway address\");\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (!inet_pton(AF_INET, value, gw)) {\n\t\t\tSYSERROR(\"invalid ipv4 gateway address: %s\", value);\n\t\t\tfree(gw);\n\t\t\treturn -1;\n\t\t}\n\n\t\tnetdev->ipv4_gateway = gw;\n\t\tnetdev->ipv4_gateway_auto = false;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "gw"
          ],
          "line": 983
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"invalid ipv4 gateway address: %s\"",
            "value"
          ],
          "line": 982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inet_pton",
          "args": [
            "AF_INET",
            "value",
            "gw"
          ],
          "line": 981
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to allocate ipv4 gateway address\""
          ],
          "line": 977
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*gw)"
          ],
          "line": 975
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "value",
            "\"auto\""
          ],
          "line": 969
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 967
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_netdev",
          "args": [
            "key",
            "value",
            "&lxc_conf->network"
          ],
          "line": 961
        },
        "resolved": true,
        "details": {
          "function_name": "network_netdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "565-588",
          "snippet": "static struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_network_ipv4_gateway(const char *key, const char *value,\n\t\t\t               struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tfree(netdev->ipv4_gateway);\n\n\tif (!value || strlen(value) == 0) {\n\t\tnetdev->ipv4_gateway = NULL;\n\t} else if (!strcmp(value, \"auto\")) {\n\t\tnetdev->ipv4_gateway = NULL;\n\t\tnetdev->ipv4_gateway_auto = true;\n\t} else {\n\t\tstruct in_addr *gw;\n\n\t\tgw = malloc(sizeof(*gw));\n\t\tif (!gw) {\n\t\t\tSYSERROR(\"failed to allocate ipv4 gateway address\");\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (!inet_pton(AF_INET, value, gw)) {\n\t\t\tSYSERROR(\"invalid ipv4 gateway address: %s\", value);\n\t\t\tfree(gw);\n\t\t\treturn -1;\n\t\t}\n\n\t\tnetdev->ipv4_gateway = gw;\n\t\tnetdev->ipv4_gateway_auto = false;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "config_network_ipv4",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "865-954",
    "snippet": "static int config_network_ipv4(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\tstruct lxc_inetdev *inetdev;\n\tstruct lxc_list *list;\n\tchar *cursor, *slash, *addr = NULL, *bcast = NULL, *prefix = NULL;\n\n\tif (!value || !strlen(value))\n\t\treturn lxc_clear_config_item(lxc_conf, key);\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tinetdev = malloc(sizeof(*inetdev));\n\tif (!inetdev) {\n\t\tSYSERROR(\"failed to allocate ipv4 address\");\n\t\treturn -1;\n\t}\n\tmemset(inetdev, 0, sizeof(*inetdev));\n\n\tlist = malloc(sizeof(*list));\n\tif (!list) {\n\t\tSYSERROR(\"failed to allocate memory\");\n\t\tfree(inetdev);\n\t\treturn -1;\n\t}\n\n\tlxc_list_init(list);\n\tlist->elem = inetdev;\n\n\taddr = strdup(value);\n\tif (!addr) {\n\t\tERROR(\"no address specified\");\n\t\tfree(inetdev);\n\t\tfree(list);\n\t\treturn -1;\n\t}\n\n\tcursor = strstr(addr, \" \");\n\tif (cursor) {\n\t\t*cursor = '\\0';\n\t\tbcast = cursor + 1;\n\t}\n\n\tslash = strstr(addr, \"/\");\n\tif (slash) {\n\t\t*slash = '\\0';\n\t\tprefix = slash + 1;\n\t}\n\n\tif (!inet_pton(AF_INET, addr, &inetdev->addr)) {\n\t\tSYSERROR(\"invalid ipv4 address: %s\", value);\n\t\tfree(inetdev);\n\t\tfree(addr);\n\t\tfree(list);\n\t\treturn -1;\n\t}\n\n\tif (bcast && !inet_pton(AF_INET, bcast, &inetdev->bcast)) {\n\t\tSYSERROR(\"invalid ipv4 broadcast address: %s\", value);\n\t\tfree(inetdev);\n\t\tfree(list);\n\t\tfree(addr);\n\t\treturn -1;\n\t}\n\n\t/* no prefix specified, determine it from the network class */\n\tif (prefix) {\n\t\tif (lxc_safe_uint(prefix, &inetdev->prefix) < 0)\n\t\t\treturn -1;\n\t} else {\n\t\tinetdev->prefix = config_ip_prefix(&inetdev->addr);\n\t}\n\n\t/* if no broadcast address, let compute one from the\n\t * prefix and address\n\t */\n\tif (!bcast) {\n\t\tinetdev->bcast.s_addr = inetdev->addr.s_addr;\n\t\tinetdev->bcast.s_addr |=\n\t\t\thtonl(INADDR_BROADCAST >>  inetdev->prefix);\n\t}\n\n\tlxc_list_add_tail(&netdev->ipv4, list);\n\n\tfree(addr);\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "addr"
          ],
          "line": 952
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_list_add_tail",
          "args": [
            "&netdev->ipv4",
            "list"
          ],
          "line": 950
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_add_tail",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "133-137",
          "snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "INADDR_BROADCAST >>  inetdev->prefix"
          ],
          "line": 947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_ip_prefix",
          "args": [
            "&inetdev->addr"
          ],
          "line": 938
        },
        "resolved": true,
        "details": {
          "function_name": "config_ip_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "471-481",
          "snippet": "static int config_ip_prefix(struct in_addr *addr)\n{\n\tif (IN_CLASSA(addr->s_addr))\n\t\treturn 32 - IN_CLASSA_NSHIFT;\n\tif (IN_CLASSB(addr->s_addr))\n\t\treturn 32 - IN_CLASSB_NSHIFT;\n\tif (IN_CLASSC(addr->s_addr))\n\t\treturn 32 - IN_CLASSC_NSHIFT;\n\n\treturn 0;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_ip_prefix(struct in_addr *addr)\n{\n\tif (IN_CLASSA(addr->s_addr))\n\t\treturn 32 - IN_CLASSA_NSHIFT;\n\tif (IN_CLASSB(addr->s_addr))\n\t\treturn 32 - IN_CLASSB_NSHIFT;\n\tif (IN_CLASSC(addr->s_addr))\n\t\treturn 32 - IN_CLASSC_NSHIFT;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_safe_uint",
          "args": [
            "prefix",
            "&inetdev->prefix"
          ],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_safe_uint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "1985-2003",
          "snippet": "int lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"invalid ipv4 broadcast address: %s\"",
            "value"
          ],
          "line": 926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inet_pton",
          "args": [
            "AF_INET",
            "bcast",
            "&inetdev->bcast"
          ],
          "line": 925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"invalid ipv4 address: %s\"",
            "value"
          ],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inet_pton",
          "args": [
            "AF_INET",
            "addr",
            "&inetdev->addr"
          ],
          "line": 917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "addr",
            "\"/\""
          ],
          "line": 911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "addr",
            "\" \""
          ],
          "line": 905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"no address specified\""
          ],
          "line": 899
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "value"
          ],
          "line": 897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_list_init",
          "args": [
            "list"
          ],
          "line": 894
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "68-72",
          "snippet": "static inline void lxc_list_init(struct lxc_list *list)\n{\n\tlist->elem = NULL;\n\tlist->next = list->prev = list;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void lxc_list_init(struct lxc_list *list)\n{\n\tlist->elem = NULL;\n\tlist->next = list->prev = list;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to allocate memory\""
          ],
          "line": 889
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*list)"
          ],
          "line": 887
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "inetdev",
            "0",
            "sizeof(*inetdev)"
          ],
          "line": 885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to allocate ipv4 address\""
          ],
          "line": 882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*inetdev)"
          ],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_netdev",
          "args": [
            "key",
            "value",
            "&lxc_conf->network"
          ],
          "line": 876
        },
        "resolved": true,
        "details": {
          "function_name": "network_netdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "565-588",
          "snippet": "static struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_clear_config_item",
          "args": [
            "lxc_conf",
            "key"
          ],
          "line": 874
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_config_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2690-2715",
          "snippet": "int lxc_clear_config_item(struct lxc_conf *c, const char *key)\n{\n\tif (strcmp(key, \"lxc.network\") == 0)\n\t\treturn lxc_clear_config_network(c);\n\telse if (strncmp(key, \"lxc.network.\", 12) == 0)\n\t\treturn lxc_clear_nic(c, key + 12);\n\telse if (strcmp(key, \"lxc.cap.drop\") == 0)\n\t\treturn lxc_clear_config_caps(c);\n\telse if (strcmp(key, \"lxc.cap.keep\") == 0)\n\t\treturn lxc_clear_config_keepcaps(c);\n\telse if (strncmp(key, \"lxc.cgroup\", 10) == 0)\n\t\treturn lxc_clear_cgroups(c, key);\n\telse if (strcmp(key, \"lxc.mount.entry\") == 0)\n\t\treturn lxc_clear_mount_entries(c);\n\telse if (strcmp(key, \"lxc.mount.auto\") == 0)\n\t\treturn lxc_clear_automounts(c);\n\telse if (strncmp(key, \"lxc.hook\", 8) == 0)\n\t\treturn lxc_clear_hooks(c, key);\n\telse if (strncmp(key, \"lxc.group\", 9) == 0)\n\t\treturn lxc_clear_groups(c);\n\telse if (strncmp(key, \"lxc.environment\", 15) == 0)\n\t\treturn lxc_clear_environment(c);\n\telse if (strncmp(key, \"lxc.id_map\", 10) == 0)\n\t\treturn lxc_clear_idmaps(c);\n\treturn -1;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nint lxc_clear_config_item(struct lxc_conf *c, const char *key)\n{\n\tif (strcmp(key, \"lxc.network\") == 0)\n\t\treturn lxc_clear_config_network(c);\n\telse if (strncmp(key, \"lxc.network.\", 12) == 0)\n\t\treturn lxc_clear_nic(c, key + 12);\n\telse if (strcmp(key, \"lxc.cap.drop\") == 0)\n\t\treturn lxc_clear_config_caps(c);\n\telse if (strcmp(key, \"lxc.cap.keep\") == 0)\n\t\treturn lxc_clear_config_keepcaps(c);\n\telse if (strncmp(key, \"lxc.cgroup\", 10) == 0)\n\t\treturn lxc_clear_cgroups(c, key);\n\telse if (strcmp(key, \"lxc.mount.entry\") == 0)\n\t\treturn lxc_clear_mount_entries(c);\n\telse if (strcmp(key, \"lxc.mount.auto\") == 0)\n\t\treturn lxc_clear_automounts(c);\n\telse if (strncmp(key, \"lxc.hook\", 8) == 0)\n\t\treturn lxc_clear_hooks(c, key);\n\telse if (strncmp(key, \"lxc.group\", 9) == 0)\n\t\treturn lxc_clear_groups(c);\n\telse if (strncmp(key, \"lxc.environment\", 15) == 0)\n\t\treturn lxc_clear_environment(c);\n\telse if (strncmp(key, \"lxc.id_map\", 10) == 0)\n\t\treturn lxc_clear_idmaps(c);\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 873
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_network_ipv4(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\tstruct lxc_inetdev *inetdev;\n\tstruct lxc_list *list;\n\tchar *cursor, *slash, *addr = NULL, *bcast = NULL, *prefix = NULL;\n\n\tif (!value || !strlen(value))\n\t\treturn lxc_clear_config_item(lxc_conf, key);\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tinetdev = malloc(sizeof(*inetdev));\n\tif (!inetdev) {\n\t\tSYSERROR(\"failed to allocate ipv4 address\");\n\t\treturn -1;\n\t}\n\tmemset(inetdev, 0, sizeof(*inetdev));\n\n\tlist = malloc(sizeof(*list));\n\tif (!list) {\n\t\tSYSERROR(\"failed to allocate memory\");\n\t\tfree(inetdev);\n\t\treturn -1;\n\t}\n\n\tlxc_list_init(list);\n\tlist->elem = inetdev;\n\n\taddr = strdup(value);\n\tif (!addr) {\n\t\tERROR(\"no address specified\");\n\t\tfree(inetdev);\n\t\tfree(list);\n\t\treturn -1;\n\t}\n\n\tcursor = strstr(addr, \" \");\n\tif (cursor) {\n\t\t*cursor = '\\0';\n\t\tbcast = cursor + 1;\n\t}\n\n\tslash = strstr(addr, \"/\");\n\tif (slash) {\n\t\t*slash = '\\0';\n\t\tprefix = slash + 1;\n\t}\n\n\tif (!inet_pton(AF_INET, addr, &inetdev->addr)) {\n\t\tSYSERROR(\"invalid ipv4 address: %s\", value);\n\t\tfree(inetdev);\n\t\tfree(addr);\n\t\tfree(list);\n\t\treturn -1;\n\t}\n\n\tif (bcast && !inet_pton(AF_INET, bcast, &inetdev->bcast)) {\n\t\tSYSERROR(\"invalid ipv4 broadcast address: %s\", value);\n\t\tfree(inetdev);\n\t\tfree(list);\n\t\tfree(addr);\n\t\treturn -1;\n\t}\n\n\t/* no prefix specified, determine it from the network class */\n\tif (prefix) {\n\t\tif (lxc_safe_uint(prefix, &inetdev->prefix) < 0)\n\t\t\treturn -1;\n\t} else {\n\t\tinetdev->prefix = config_ip_prefix(&inetdev->addr);\n\t}\n\n\t/* if no broadcast address, let compute one from the\n\t * prefix and address\n\t */\n\tif (!bcast) {\n\t\tinetdev->bcast.s_addr = inetdev->addr.s_addr;\n\t\tinetdev->bcast.s_addr |=\n\t\t\thtonl(INADDR_BROADCAST >>  inetdev->prefix);\n\t}\n\n\tlxc_list_add_tail(&netdev->ipv4, list);\n\n\tfree(addr);\n\treturn 0;\n}"
  },
  {
    "function_name": "config_network_mtu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "853-863",
    "snippet": "static int config_network_mtu(const char *key, const char *value,\n\t\t\t      struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\treturn config_string_item(&netdev->mtu, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_string_item",
          "args": [
            "&netdev->mtu",
            "value"
          ],
          "line": 862
        },
        "resolved": true,
        "details": {
          "function_name": "config_string_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "327-346",
          "snippet": "static int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "network_netdev",
          "args": [
            "key",
            "value",
            "&lxc_conf->network"
          ],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "network_netdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "565-588",
          "snippet": "static struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_network_mtu(const char *key, const char *value,\n\t\t\t      struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\treturn config_string_item(&netdev->mtu, value);\n}"
  },
  {
    "function_name": "config_network_vlan_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "834-851",
    "snippet": "static int config_network_vlan_id(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tif (netdev->type != LXC_NET_VLAN) {\n\t\tERROR(\"Invalid vlan.id for a non-macvlan netdev\");\n\t\treturn -1;\n\t}\n\tif (get_u16(&netdev->priv.vlan_attr.vid, value, 0))\n\t\treturn -1;\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_u16",
          "args": [
            "&netdev->priv.vlan_attr.vid",
            "value",
            "0"
          ],
          "line": 847
        },
        "resolved": true,
        "details": {
          "function_name": "get_u16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "223-239",
          "snippet": "extern int get_u16(unsigned short *val, const char *arg, int base)\n{\n\tunsigned long res;\n\tchar *ptr;\n\n\tif (!arg || !*arg)\n\t\treturn -1;\n\n\terrno = 0;\n\tres = strtoul(arg, &ptr, base);\n\tif (!ptr || ptr == arg || *ptr || res > 0xFFFF || errno != 0)\n\t\treturn -1;\n\n\t*val = res;\n\n\treturn 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nextern int get_u16(unsigned short *val, const char *arg, int base)\n{\n\tunsigned long res;\n\tchar *ptr;\n\n\tif (!arg || !*arg)\n\t\treturn -1;\n\n\terrno = 0;\n\tres = strtoul(arg, &ptr, base);\n\tif (!ptr || ptr == arg || *ptr || res > 0xFFFF || errno != 0)\n\t\treturn -1;\n\n\t*val = res;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Invalid vlan.id for a non-macvlan netdev\""
          ],
          "line": 844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_netdev",
          "args": [
            "key",
            "value",
            "&lxc_conf->network"
          ],
          "line": 839
        },
        "resolved": true,
        "details": {
          "function_name": "network_netdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "565-588",
          "snippet": "static struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_network_vlan_id(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tif (netdev->type != LXC_NET_VLAN) {\n\t\tERROR(\"Invalid vlan.id for a non-macvlan netdev\");\n\t\treturn -1;\n\t}\n\tif (get_u16(&netdev->priv.vlan_attr.vid, value, 0))\n\t\treturn -1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "config_network_hwaddr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "806-832",
    "snippet": "static int config_network_hwaddr(const char *key, const char *value,\n\t\t\t\t struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tchar *new_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\trand_complete_hwaddr(new_value);\n\n\tnetdev = network_netdev(key, new_value, &lxc_conf->network);\n\tif (!netdev) {\n\t\tfree(new_value);\n\t\treturn -1;\n\t};\n\n\tif (!new_value || strlen(new_value) == 0) {\n\t\tfree(new_value);\n\t\tnetdev->hwaddr = NULL;\n\t\treturn 0;\n\t}\n\n\tnetdev->hwaddr = new_value;\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "new_value"
          ],
          "line": 825
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "new_value"
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_netdev",
          "args": [
            "key",
            "new_value",
            "&lxc_conf->network"
          ],
          "line": 818
        },
        "resolved": true,
        "details": {
          "function_name": "network_netdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "565-588",
          "snippet": "static struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rand_complete_hwaddr",
          "args": [
            "new_value"
          ],
          "line": 816
        },
        "resolved": true,
        "details": {
          "function_name": "rand_complete_hwaddr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "636-665",
          "snippet": "static int rand_complete_hwaddr(char *hwaddr)\n{\n\tconst char hex[] = \"0123456789abcdef\";\n\tchar *curs = hwaddr;\n\n#ifndef HAVE_RAND_R\n\trandseed(true);\n#else\n\tunsigned int seed=randseed(false);\n#endif\n\twhile (*curs != '\\0' && *curs != '\\n')\n\t{\n\t\tif ( *curs == 'x' || *curs == 'X' ) {\n\t\t\tif (curs - hwaddr == 1) {\n\t\t\t\t//ensure address is unicast\n#ifdef HAVE_RAND_R\n\t\t\t\t*curs = hex[rand_r(&seed) & 0x0E];\n\t\t\t} else {\n\t\t\t\t*curs = hex[rand_r(&seed) & 0x0F];\n#else\n\t\t\t\t*curs = hex[rand() & 0x0E];\n\t\t\t} else {\n\t\t\t\t*curs = hex[rand() & 0x0F];\n#endif\n\t\t\t}\n\t\t}\n\t\tcurs++;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int rand_complete_hwaddr(char *hwaddr)\n{\n\tconst char hex[] = \"0123456789abcdef\";\n\tchar *curs = hwaddr;\n\n#ifndef HAVE_RAND_R\n\trandseed(true);\n#else\n\tunsigned int seed=randseed(false);\n#endif\n\twhile (*curs != '\\0' && *curs != '\\n')\n\t{\n\t\tif ( *curs == 'x' || *curs == 'X' ) {\n\t\t\tif (curs - hwaddr == 1) {\n\t\t\t\t//ensure address is unicast\n#ifdef HAVE_RAND_R\n\t\t\t\t*curs = hex[rand_r(&seed) & 0x0E];\n\t\t\t} else {\n\t\t\t\t*curs = hex[rand_r(&seed) & 0x0F];\n#else\n\t\t\t\t*curs = hex[rand() & 0x0E];\n\t\t\t} else {\n\t\t\t\t*curs = hex[rand() & 0x0F];\n#endif\n\t\t\t}\n\t\t}\n\t\tcurs++;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to strdup '%s': %m\"",
            "value"
          ],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "value"
          ],
          "line": 811
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_network_hwaddr(const char *key, const char *value,\n\t\t\t\t struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tchar *new_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\trand_complete_hwaddr(new_value);\n\n\tnetdev = network_netdev(key, new_value, &lxc_conf->network);\n\tif (!netdev) {\n\t\tfree(new_value);\n\t\treturn -1;\n\t};\n\n\tif (!new_value || strlen(new_value) == 0) {\n\t\tfree(new_value);\n\t\tnetdev->hwaddr = NULL;\n\t\treturn 0;\n\t}\n\n\tnetdev->hwaddr = new_value;\n\treturn 0;\n}"
  },
  {
    "function_name": "config_network_macvlan_mode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "790-804",
    "snippet": "static int config_network_macvlan_mode(const char *key, const char *value,\n\t\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tif (netdev->type != LXC_NET_MACVLAN) {\n\t\tERROR(\"Invalid macvlan.mode for a non-macvlan netdev\");\n\t\treturn -1;\n\t}\n\treturn macvlan_mode(&netdev->priv.macvlan_attr.mode, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "macvlan_mode",
          "args": [
            "&netdev->priv.macvlan_attr.mode",
            "value"
          ],
          "line": 803
        },
        "resolved": true,
        "details": {
          "function_name": "macvlan_mode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "611-634",
          "snippet": "static int macvlan_mode(int *valuep, const char *value)\n{\n\tstruct mc_mode {\n\t\tchar *name;\n\t\tint mode;\n\t} m[] = {\n\t\t{ \"private\", MACVLAN_MODE_PRIVATE },\n\t\t{ \"vepa\", MACVLAN_MODE_VEPA },\n\t\t{ \"bridge\", MACVLAN_MODE_BRIDGE },\n\t\t{ \"passthru\", MACVLAN_MODE_PASSTHRU },\n\t};\n\n\tsize_t i;\n\n\tfor (i = 0; i < sizeof(m)/sizeof(m[0]); i++) {\n\t\tif (strcmp(m[i].name, value))\n\t\t\tcontinue;\n\n\t\t*valuep = m[i].mode;\n\t\treturn 0;\n\t}\n\n\treturn -1;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int macvlan_mode(int *valuep, const char *value)\n{\n\tstruct mc_mode {\n\t\tchar *name;\n\t\tint mode;\n\t} m[] = {\n\t\t{ \"private\", MACVLAN_MODE_PRIVATE },\n\t\t{ \"vepa\", MACVLAN_MODE_VEPA },\n\t\t{ \"bridge\", MACVLAN_MODE_BRIDGE },\n\t\t{ \"passthru\", MACVLAN_MODE_PASSTHRU },\n\t};\n\n\tsize_t i;\n\n\tfor (i = 0; i < sizeof(m)/sizeof(m[0]); i++) {\n\t\tif (strcmp(m[i].name, value))\n\t\t\tcontinue;\n\n\t\t*valuep = m[i].mode;\n\t\treturn 0;\n\t}\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Invalid macvlan.mode for a non-macvlan netdev\""
          ],
          "line": 800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_netdev",
          "args": [
            "key",
            "value",
            "&lxc_conf->network"
          ],
          "line": 795
        },
        "resolved": true,
        "details": {
          "function_name": "network_netdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "565-588",
          "snippet": "static struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_network_macvlan_mode(const char *key, const char *value,\n\t\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tif (netdev->type != LXC_NET_MACVLAN) {\n\t\tERROR(\"Invalid macvlan.mode for a non-macvlan netdev\");\n\t\treturn -1;\n\t}\n\treturn macvlan_mode(&netdev->priv.macvlan_attr.mode, value);\n}"
  },
  {
    "function_name": "config_network_veth_pair",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "774-788",
    "snippet": "static int config_network_veth_pair(const char *key, const char *value,\n\t\t\t\t    struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tif (netdev->type != LXC_NET_VETH) {\n\t\tERROR(\"Invalid veth pair for a non-veth netdev\");\n\t\treturn -1;\n\t}\n\treturn network_ifname(&netdev->priv.veth_attr.pair, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "network_ifname",
          "args": [
            "&netdev->priv.veth_attr.pair",
            "value"
          ],
          "line": 787
        },
        "resolved": true,
        "details": {
          "function_name": "network_ifname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "590-593",
          "snippet": "static int network_ifname(char **valuep, const char *value)\n{\n\treturn config_string_item_max(valuep, value, IFNAMSIZ);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int network_ifname(char **valuep, const char *value)\n{\n\treturn config_string_item_max(valuep, value, IFNAMSIZ);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"Invalid veth pair for a non-veth netdev\""
          ],
          "line": 784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_netdev",
          "args": [
            "key",
            "value",
            "&lxc_conf->network"
          ],
          "line": 779
        },
        "resolved": true,
        "details": {
          "function_name": "network_netdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "565-588",
          "snippet": "static struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_network_veth_pair(const char *key, const char *value,\n\t\t\t\t    struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tif (netdev->type != LXC_NET_VETH) {\n\t\tERROR(\"Invalid veth pair for a non-veth netdev\");\n\t\treturn -1;\n\t}\n\treturn network_ifname(&netdev->priv.veth_attr.pair, value);\n}"
  },
  {
    "function_name": "config_network_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "762-772",
    "snippet": "static int config_network_name(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\treturn network_ifname(&netdev->name, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "network_ifname",
          "args": [
            "&netdev->name",
            "value"
          ],
          "line": 771
        },
        "resolved": true,
        "details": {
          "function_name": "network_ifname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "590-593",
          "snippet": "static int network_ifname(char **valuep, const char *value)\n{\n\treturn config_string_item_max(valuep, value, IFNAMSIZ);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int network_ifname(char **valuep, const char *value)\n{\n\treturn config_string_item_max(valuep, value, IFNAMSIZ);\n}"
        }
      },
      {
        "call_info": {
          "callee": "network_netdev",
          "args": [
            "key",
            "value",
            "&lxc_conf->network"
          ],
          "line": 767
        },
        "resolved": true,
        "details": {
          "function_name": "network_netdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "565-588",
          "snippet": "static struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_network_name(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\treturn network_ifname(&netdev->name, value);\n}"
  },
  {
    "function_name": "config_network_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "732-760",
    "snippet": "static int config_network_link(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\tstruct lxc_list * it;\n\tint ret = 0;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tif (value[strlen(value) - 1] == '+' && netdev->type == LXC_NET_PHYS) {\n\t\t//get the last network list and remove it.\n\t\tit = lxc_conf->network.prev;\n\t\tif (((struct lxc_netdev *)(it->elem))->type != LXC_NET_PHYS) {\n\t\t\tERROR(\"lxc config cannot support string pattern matching for this link type\");\n\t\t\treturn -1;\n\t\t}\n\n\t\tlxc_list_del(it);\n\t\tfree(it);\n\t\tret = create_matched_ifnames(value, lxc_conf);\n\n\t} else {\n\t\tret = network_ifname(&netdev->link, value);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "network_ifname",
          "args": [
            "&netdev->link",
            "value"
          ],
          "line": 756
        },
        "resolved": true,
        "details": {
          "function_name": "network_ifname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "590-593",
          "snippet": "static int network_ifname(char **valuep, const char *value)\n{\n\treturn config_string_item_max(valuep, value, IFNAMSIZ);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int network_ifname(char **valuep, const char *value)\n{\n\treturn config_string_item_max(valuep, value, IFNAMSIZ);\n}"
        }
      },
      {
        "call_info": {
          "callee": "create_matched_ifnames",
          "args": [
            "value",
            "lxc_conf"
          ],
          "line": 753
        },
        "resolved": true,
        "details": {
          "function_name": "create_matched_ifnames",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "692-730",
          "snippet": "static int create_matched_ifnames(const char *value, struct lxc_conf *lxc_conf)\n{\n\tstruct ifaddrs *ifaddr, *ifa;\n\tconst char *type_key = \"lxc.network.type\";\n\tconst char *link_key = \"lxc.network.link\";\n\tconst char *tmpvalue = \"phys\";\n\tint n, ret = 0;\n\n\tif (getifaddrs(&ifaddr) == -1) {\n\t\tSYSERROR(\"Get network interfaces failed\");\n\t\treturn -1;\n\t}\n\n\tfor (ifa = ifaddr, n = 0; ifa != NULL; ifa = ifa->ifa_next, n++) {\n\t\tif (!ifa->ifa_addr)\n\t\t\tcontinue;\n\t\tif (ifa->ifa_addr->sa_family != AF_PACKET)\n\t\t\tcontinue;\n\n\t\tif (!strncmp(value, ifa->ifa_name, strlen(value)-1)) {\n\t\t\tret = config_network_type(type_key, tmpvalue, lxc_conf);\n\t\t\tif (!ret) {\n\t\t\t\tret = set_network_link(link_key, ifa->ifa_name, lxc_conf);\n\t\t\t\tif (ret) {\n\t\t\t\t\tERROR(\"failed to create matched ifnames\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tERROR(\"failed to create matched ifnames\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tfreeifaddrs(ifaddr); /* free the dynamic memory */\n\tifaddr = NULL;\t    /* prevent use after free */\n\n\treturn ret;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int create_matched_ifnames(const char *value, struct lxc_conf *lxc_conf)\n{\n\tstruct ifaddrs *ifaddr, *ifa;\n\tconst char *type_key = \"lxc.network.type\";\n\tconst char *link_key = \"lxc.network.link\";\n\tconst char *tmpvalue = \"phys\";\n\tint n, ret = 0;\n\n\tif (getifaddrs(&ifaddr) == -1) {\n\t\tSYSERROR(\"Get network interfaces failed\");\n\t\treturn -1;\n\t}\n\n\tfor (ifa = ifaddr, n = 0; ifa != NULL; ifa = ifa->ifa_next, n++) {\n\t\tif (!ifa->ifa_addr)\n\t\t\tcontinue;\n\t\tif (ifa->ifa_addr->sa_family != AF_PACKET)\n\t\t\tcontinue;\n\n\t\tif (!strncmp(value, ifa->ifa_name, strlen(value)-1)) {\n\t\t\tret = config_network_type(type_key, tmpvalue, lxc_conf);\n\t\t\tif (!ret) {\n\t\t\t\tret = set_network_link(link_key, ifa->ifa_name, lxc_conf);\n\t\t\t\tif (ret) {\n\t\t\t\t\tERROR(\"failed to create matched ifnames\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tERROR(\"failed to create matched ifnames\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tfreeifaddrs(ifaddr); /* free the dynamic memory */\n\tifaddr = NULL;\t    /* prevent use after free */\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "it"
          ],
          "line": 752
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_list_del",
          "args": [
            "it"
          ],
          "line": 751
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "148-156",
          "snippet": "static inline void lxc_list_del(struct lxc_list *list)\n{\n\tstruct lxc_list *next, *prev;\n\n\tnext = list->next;\n\tprev = list->prev;\n\tnext->prev = prev;\n\tprev->next = next;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void lxc_list_del(struct lxc_list *list)\n{\n\tstruct lxc_list *next, *prev;\n\n\tnext = list->next;\n\tprev = list->prev;\n\tnext->prev = prev;\n\tprev->next = next;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"lxc config cannot support string pattern matching for this link type\""
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network_netdev",
          "args": [
            "key",
            "value",
            "&lxc_conf->network"
          ],
          "line": 739
        },
        "resolved": true,
        "details": {
          "function_name": "network_netdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "565-588",
          "snippet": "static struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_network_link(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\tstruct lxc_list * it;\n\tint ret = 0;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tif (value[strlen(value) - 1] == '+' && netdev->type == LXC_NET_PHYS) {\n\t\t//get the last network list and remove it.\n\t\tit = lxc_conf->network.prev;\n\t\tif (((struct lxc_netdev *)(it->elem))->type != LXC_NET_PHYS) {\n\t\t\tERROR(\"lxc config cannot support string pattern matching for this link type\");\n\t\t\treturn -1;\n\t\t}\n\n\t\tlxc_list_del(it);\n\t\tfree(it);\n\t\tret = create_matched_ifnames(value, lxc_conf);\n\n\t} else {\n\t\tret = network_ifname(&netdev->link, value);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "create_matched_ifnames",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "692-730",
    "snippet": "static int create_matched_ifnames(const char *value, struct lxc_conf *lxc_conf)\n{\n\tstruct ifaddrs *ifaddr, *ifa;\n\tconst char *type_key = \"lxc.network.type\";\n\tconst char *link_key = \"lxc.network.link\";\n\tconst char *tmpvalue = \"phys\";\n\tint n, ret = 0;\n\n\tif (getifaddrs(&ifaddr) == -1) {\n\t\tSYSERROR(\"Get network interfaces failed\");\n\t\treturn -1;\n\t}\n\n\tfor (ifa = ifaddr, n = 0; ifa != NULL; ifa = ifa->ifa_next, n++) {\n\t\tif (!ifa->ifa_addr)\n\t\t\tcontinue;\n\t\tif (ifa->ifa_addr->sa_family != AF_PACKET)\n\t\t\tcontinue;\n\n\t\tif (!strncmp(value, ifa->ifa_name, strlen(value)-1)) {\n\t\t\tret = config_network_type(type_key, tmpvalue, lxc_conf);\n\t\t\tif (!ret) {\n\t\t\t\tret = set_network_link(link_key, ifa->ifa_name, lxc_conf);\n\t\t\t\tif (ret) {\n\t\t\t\t\tERROR(\"failed to create matched ifnames\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tERROR(\"failed to create matched ifnames\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tfreeifaddrs(ifaddr); /* free the dynamic memory */\n\tifaddr = NULL;\t    /* prevent use after free */\n\n\treturn ret;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "freeifaddrs",
          "args": [
            "ifaddr"
          ],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "freeifaddrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/include/ifaddrs.c",
          "lines": "590-599",
          "snippet": "void freeifaddrs(struct ifaddrs *ifa)\n{\n    struct ifaddrs *l_cur;\n    while(ifa)\n    {\n        l_cur = ifa;\n        ifa = ifa->ifa_next;\n        free(l_cur);\n    }\n}",
          "includes": [
            "#include <linux/rtnetlink.h>",
            "#include <linux/netlink.h>",
            "#include <netinet/in.h>",
            "#include <net/if_arp.h>",
            "#include <sys/socket.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include \"ifaddrs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <netinet/in.h>\n#include <net/if_arp.h>\n#include <sys/socket.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <string.h>\n#include \"ifaddrs.h\"\n\nvoid freeifaddrs(struct ifaddrs *ifa)\n{\n    struct ifaddrs *l_cur;\n    while(ifa)\n    {\n        l_cur = ifa;\n        ifa = ifa->ifa_next;\n        free(l_cur);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"failed to create matched ifnames\""
          ],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"failed to create matched ifnames\""
          ],
          "line": 716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_network_link",
          "args": [
            "link_key",
            "ifa->ifa_name",
            "lxc_conf"
          ],
          "line": 714
        },
        "resolved": true,
        "details": {
          "function_name": "set_network_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "681-690",
          "snippet": "static int set_network_link(const char *key, const char *value, struct lxc_conf *lxc_conf)\n{\n        struct lxc_netdev *netdev;\n\n        netdev = network_netdev(key, value, &lxc_conf->network);\n        if (!netdev)\n                return -1;\n\n        return network_ifname(&netdev->link, value);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int set_network_link(const char *key, const char *value, struct lxc_conf *lxc_conf)\n{\n        struct lxc_netdev *netdev;\n\n        netdev = network_netdev(key, value, &lxc_conf->network);\n        if (!netdev)\n                return -1;\n\n        return network_ifname(&netdev->link, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_network_type",
          "args": [
            "type_key",
            "tmpvalue",
            "lxc_conf"
          ],
          "line": 712
        },
        "resolved": true,
        "details": {
          "function_name": "config_network_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "418-469",
          "snippet": "static int config_network_type(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_list *network = &lxc_conf->network;\n\tstruct lxc_netdev *netdev;\n\tstruct lxc_list *list;\n\n\tif (!value || strlen(value) == 0)\n\t\treturn lxc_clear_config_network(lxc_conf);\n\n\tnetdev = malloc(sizeof(*netdev));\n\tif (!netdev) {\n\t\tSYSERROR(\"failed to allocate memory\");\n\t\treturn -1;\n\t}\n\n\tmemset(netdev, 0, sizeof(*netdev));\n\tlxc_list_init(&netdev->ipv4);\n\tlxc_list_init(&netdev->ipv6);\n\n\tlist = malloc(sizeof(*list));\n\tif (!list) {\n\t\tSYSERROR(\"failed to allocate memory\");\n\t\tfree(netdev);\n\t\treturn -1;\n\t}\n\n\tlxc_list_init(list);\n\tlist->elem = netdev;\n\n\tlxc_list_add_tail(network, list);\n\n\tif (!strcmp(value, \"veth\"))\n\t\tnetdev->type = LXC_NET_VETH;\n\telse if (!strcmp(value, \"macvlan\")) {\n\t\tnetdev->type = LXC_NET_MACVLAN;\n\t\tmacvlan_mode(&netdev->priv.macvlan_attr.mode, \"private\");\n\t}\n\telse if (!strcmp(value, \"vlan\"))\n\t\tnetdev->type = LXC_NET_VLAN;\n\telse if (!strcmp(value, \"phys\"))\n\t\tnetdev->type = LXC_NET_PHYS;\n\telse if (!strcmp(value, \"empty\"))\n\t\tnetdev->type = LXC_NET_EMPTY;\n\telse if (!strcmp(value, \"none\"))\n\t\tnetdev->type = LXC_NET_NONE;\n\telse {\n\t\tERROR(\"invalid network type %s\", value);\n\t\treturn -1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_network_type(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_list *network = &lxc_conf->network;\n\tstruct lxc_netdev *netdev;\n\tstruct lxc_list *list;\n\n\tif (!value || strlen(value) == 0)\n\t\treturn lxc_clear_config_network(lxc_conf);\n\n\tnetdev = malloc(sizeof(*netdev));\n\tif (!netdev) {\n\t\tSYSERROR(\"failed to allocate memory\");\n\t\treturn -1;\n\t}\n\n\tmemset(netdev, 0, sizeof(*netdev));\n\tlxc_list_init(&netdev->ipv4);\n\tlxc_list_init(&netdev->ipv6);\n\n\tlist = malloc(sizeof(*list));\n\tif (!list) {\n\t\tSYSERROR(\"failed to allocate memory\");\n\t\tfree(netdev);\n\t\treturn -1;\n\t}\n\n\tlxc_list_init(list);\n\tlist->elem = netdev;\n\n\tlxc_list_add_tail(network, list);\n\n\tif (!strcmp(value, \"veth\"))\n\t\tnetdev->type = LXC_NET_VETH;\n\telse if (!strcmp(value, \"macvlan\")) {\n\t\tnetdev->type = LXC_NET_MACVLAN;\n\t\tmacvlan_mode(&netdev->priv.macvlan_attr.mode, \"private\");\n\t}\n\telse if (!strcmp(value, \"vlan\"))\n\t\tnetdev->type = LXC_NET_VLAN;\n\telse if (!strcmp(value, \"phys\"))\n\t\tnetdev->type = LXC_NET_PHYS;\n\telse if (!strcmp(value, \"empty\"))\n\t\tnetdev->type = LXC_NET_EMPTY;\n\telse if (!strcmp(value, \"none\"))\n\t\tnetdev->type = LXC_NET_NONE;\n\telse {\n\t\tERROR(\"invalid network type %s\", value);\n\t\treturn -1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "value",
            "ifa->ifa_name",
            "strlen(value)-1"
          ],
          "line": 711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"Get network interfaces failed\""
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getifaddrs",
          "args": [
            "&ifaddr"
          ],
          "line": 700
        },
        "resolved": true,
        "details": {
          "function_name": "getifaddrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/include/ifaddrs.c",
          "lines": "548-588",
          "snippet": "int getifaddrs(struct ifaddrs **ifap)\n{\n    if(!ifap)\n    {\n        return -1;\n    }\n    *ifap = NULL;\n\n    int l_socket = netlink_socket();\n    if(l_socket < 0)\n    {\n        return -1;\n    }\n\n    NetlinkList *l_linkResults = getResultList(l_socket, RTM_GETLINK);\n    if(!l_linkResults)\n    {\n        close(l_socket);\n        return -1;\n    }\n\n    NetlinkList *l_addrResults = getResultList(l_socket, RTM_GETADDR);\n    if(!l_addrResults)\n    {\n        close(l_socket);\n        freeResultList(l_linkResults);\n        return -1;\n    }\n\n    unsigned l_numLinks = countLinks(l_socket, l_linkResults) + countLinks(l_socket, l_addrResults);\n    struct ifaddrs *l_links[l_numLinks];\n    memset(l_links, 0, l_numLinks * sizeof(struct ifaddrs *));\n\n    interpret(l_socket, l_linkResults, l_links, ifap);\n    interpret(l_socket, l_addrResults, l_links, ifap);\n\n    freeResultList(l_linkResults);\n    freeResultList(l_addrResults);\n    close(l_socket);\n    return 0;\n}",
          "includes": [
            "#include <linux/rtnetlink.h>",
            "#include <linux/netlink.h>",
            "#include <netinet/in.h>",
            "#include <net/if_arp.h>",
            "#include <sys/socket.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include \"ifaddrs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <netinet/in.h>\n#include <net/if_arp.h>\n#include <sys/socket.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <string.h>\n#include \"ifaddrs.h\"\n\nint getifaddrs(struct ifaddrs **ifap)\n{\n    if(!ifap)\n    {\n        return -1;\n    }\n    *ifap = NULL;\n\n    int l_socket = netlink_socket();\n    if(l_socket < 0)\n    {\n        return -1;\n    }\n\n    NetlinkList *l_linkResults = getResultList(l_socket, RTM_GETLINK);\n    if(!l_linkResults)\n    {\n        close(l_socket);\n        return -1;\n    }\n\n    NetlinkList *l_addrResults = getResultList(l_socket, RTM_GETADDR);\n    if(!l_addrResults)\n    {\n        close(l_socket);\n        freeResultList(l_linkResults);\n        return -1;\n    }\n\n    unsigned l_numLinks = countLinks(l_socket, l_linkResults) + countLinks(l_socket, l_addrResults);\n    struct ifaddrs *l_links[l_numLinks];\n    memset(l_links, 0, l_numLinks * sizeof(struct ifaddrs *));\n\n    interpret(l_socket, l_linkResults, l_links, ifap);\n    interpret(l_socket, l_addrResults, l_links, ifap);\n\n    freeResultList(l_linkResults);\n    freeResultList(l_addrResults);\n    close(l_socket);\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int create_matched_ifnames(const char *value, struct lxc_conf *lxc_conf)\n{\n\tstruct ifaddrs *ifaddr, *ifa;\n\tconst char *type_key = \"lxc.network.type\";\n\tconst char *link_key = \"lxc.network.link\";\n\tconst char *tmpvalue = \"phys\";\n\tint n, ret = 0;\n\n\tif (getifaddrs(&ifaddr) == -1) {\n\t\tSYSERROR(\"Get network interfaces failed\");\n\t\treturn -1;\n\t}\n\n\tfor (ifa = ifaddr, n = 0; ifa != NULL; ifa = ifa->ifa_next, n++) {\n\t\tif (!ifa->ifa_addr)\n\t\t\tcontinue;\n\t\tif (ifa->ifa_addr->sa_family != AF_PACKET)\n\t\t\tcontinue;\n\n\t\tif (!strncmp(value, ifa->ifa_name, strlen(value)-1)) {\n\t\t\tret = config_network_type(type_key, tmpvalue, lxc_conf);\n\t\t\tif (!ret) {\n\t\t\t\tret = set_network_link(link_key, ifa->ifa_name, lxc_conf);\n\t\t\t\tif (ret) {\n\t\t\t\t\tERROR(\"failed to create matched ifnames\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tERROR(\"failed to create matched ifnames\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tfreeifaddrs(ifaddr); /* free the dynamic memory */\n\tifaddr = NULL;\t    /* prevent use after free */\n\n\treturn ret;\n}"
  },
  {
    "function_name": "set_network_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "681-690",
    "snippet": "static int set_network_link(const char *key, const char *value, struct lxc_conf *lxc_conf)\n{\n        struct lxc_netdev *netdev;\n\n        netdev = network_netdev(key, value, &lxc_conf->network);\n        if (!netdev)\n                return -1;\n\n        return network_ifname(&netdev->link, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "network_ifname",
          "args": [
            "&netdev->link",
            "value"
          ],
          "line": 689
        },
        "resolved": true,
        "details": {
          "function_name": "network_ifname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "590-593",
          "snippet": "static int network_ifname(char **valuep, const char *value)\n{\n\treturn config_string_item_max(valuep, value, IFNAMSIZ);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int network_ifname(char **valuep, const char *value)\n{\n\treturn config_string_item_max(valuep, value, IFNAMSIZ);\n}"
        }
      },
      {
        "call_info": {
          "callee": "network_netdev",
          "args": [
            "key",
            "value",
            "&lxc_conf->network"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "network_netdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "565-588",
          "snippet": "static struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int set_network_link(const char *key, const char *value, struct lxc_conf *lxc_conf)\n{\n        struct lxc_netdev *netdev;\n\n        netdev = network_netdev(key, value, &lxc_conf->network);\n        if (!netdev)\n                return -1;\n\n        return network_ifname(&netdev->link, value);\n}"
  },
  {
    "function_name": "config_network_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "667-679",
    "snippet": "static int config_network_flags(const char *key, const char *value,\n\t\t\t\tstruct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tnetdev->flags |= IFF_UP;\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "network_netdev",
          "args": [
            "key",
            "value",
            "&lxc_conf->network"
          ],
          "line": 672
        },
        "resolved": true,
        "details": {
          "function_name": "network_netdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "565-588",
          "snippet": "static struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_network_flags(const char *key, const char *value,\n\t\t\t\tstruct lxc_conf *lxc_conf)\n{\n\tstruct lxc_netdev *netdev;\n\n\tnetdev = network_netdev(key, value, &lxc_conf->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tnetdev->flags |= IFF_UP;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "rand_complete_hwaddr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "636-665",
    "snippet": "static int rand_complete_hwaddr(char *hwaddr)\n{\n\tconst char hex[] = \"0123456789abcdef\";\n\tchar *curs = hwaddr;\n\n#ifndef HAVE_RAND_R\n\trandseed(true);\n#else\n\tunsigned int seed=randseed(false);\n#endif\n\twhile (*curs != '\\0' && *curs != '\\n')\n\t{\n\t\tif ( *curs == 'x' || *curs == 'X' ) {\n\t\t\tif (curs - hwaddr == 1) {\n\t\t\t\t//ensure address is unicast\n#ifdef HAVE_RAND_R\n\t\t\t\t*curs = hex[rand_r(&seed) & 0x0E];\n\t\t\t} else {\n\t\t\t\t*curs = hex[rand_r(&seed) & 0x0F];\n#else\n\t\t\t\t*curs = hex[rand() & 0x0E];\n\t\t\t} else {\n\t\t\t\t*curs = hex[rand() & 0x0F];\n#endif\n\t\t\t}\n\t\t}\n\t\tcurs++;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rand",
          "args": [],
          "line": 658
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rand",
          "args": [],
          "line": 656
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rand_r",
          "args": [
            "&seed"
          ],
          "line": 654
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rand_r",
          "args": [
            "&seed"
          ],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "randseed",
          "args": [
            "false"
          ],
          "line": 644
        },
        "resolved": true,
        "details": {
          "function_name": "randseed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "1012-1032",
          "snippet": "int randseed(bool srand_it)\n{\n\t/*\n\t   srand pre-seed function based on /dev/urandom\n\t   */\n\tunsigned int seed = time(NULL) + getpid();\n\n\tFILE *f;\n\tf = fopen(\"/dev/urandom\", \"r\");\n\tif (f) {\n\t\tint ret = fread(&seed, sizeof(seed), 1, f);\n\t\tif (ret != 1)\n\t\t\tDEBUG(\"unable to fread /dev/urandom, %s, fallback to time+pid rand seed\", strerror(errno));\n\t\tfclose(f);\n\t}\n\n\tif (srand_it)\n\t\tsrand(seed);\n\n\treturn seed;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint randseed(bool srand_it)\n{\n\t/*\n\t   srand pre-seed function based on /dev/urandom\n\t   */\n\tunsigned int seed = time(NULL) + getpid();\n\n\tFILE *f;\n\tf = fopen(\"/dev/urandom\", \"r\");\n\tif (f) {\n\t\tint ret = fread(&seed, sizeof(seed), 1, f);\n\t\tif (ret != 1)\n\t\t\tDEBUG(\"unable to fread /dev/urandom, %s, fallback to time+pid rand seed\", strerror(errno));\n\t\tfclose(f);\n\t}\n\n\tif (srand_it)\n\t\tsrand(seed);\n\n\treturn seed;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int rand_complete_hwaddr(char *hwaddr)\n{\n\tconst char hex[] = \"0123456789abcdef\";\n\tchar *curs = hwaddr;\n\n#ifndef HAVE_RAND_R\n\trandseed(true);\n#else\n\tunsigned int seed=randseed(false);\n#endif\n\twhile (*curs != '\\0' && *curs != '\\n')\n\t{\n\t\tif ( *curs == 'x' || *curs == 'X' ) {\n\t\t\tif (curs - hwaddr == 1) {\n\t\t\t\t//ensure address is unicast\n#ifdef HAVE_RAND_R\n\t\t\t\t*curs = hex[rand_r(&seed) & 0x0E];\n\t\t\t} else {\n\t\t\t\t*curs = hex[rand_r(&seed) & 0x0F];\n#else\n\t\t\t\t*curs = hex[rand() & 0x0E];\n\t\t\t} else {\n\t\t\t\t*curs = hex[rand() & 0x0F];\n#endif\n\t\t\t}\n\t\t}\n\t\tcurs++;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "macvlan_mode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "611-634",
    "snippet": "static int macvlan_mode(int *valuep, const char *value)\n{\n\tstruct mc_mode {\n\t\tchar *name;\n\t\tint mode;\n\t} m[] = {\n\t\t{ \"private\", MACVLAN_MODE_PRIVATE },\n\t\t{ \"vepa\", MACVLAN_MODE_VEPA },\n\t\t{ \"bridge\", MACVLAN_MODE_BRIDGE },\n\t\t{ \"passthru\", MACVLAN_MODE_PASSTHRU },\n\t};\n\n\tsize_t i;\n\n\tfor (i = 0; i < sizeof(m)/sizeof(m[0]); i++) {\n\t\tif (strcmp(m[i].name, value))\n\t\t\tcontinue;\n\n\t\t*valuep = m[i].mode;\n\t\treturn 0;\n\t}\n\n\treturn -1;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "m[i].name",
            "value"
          ],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int macvlan_mode(int *valuep, const char *value)\n{\n\tstruct mc_mode {\n\t\tchar *name;\n\t\tint mode;\n\t} m[] = {\n\t\t{ \"private\", MACVLAN_MODE_PRIVATE },\n\t\t{ \"vepa\", MACVLAN_MODE_VEPA },\n\t\t{ \"bridge\", MACVLAN_MODE_BRIDGE },\n\t\t{ \"passthru\", MACVLAN_MODE_PASSTHRU },\n\t};\n\n\tsize_t i;\n\n\tfor (i = 0; i < sizeof(m)/sizeof(m[0]); i++) {\n\t\tif (strcmp(m[i].name, value))\n\t\t\tcontinue;\n\n\t\t*valuep = m[i].mode;\n\t\treturn 0;\n\t}\n\n\treturn -1;\n}"
  },
  {
    "function_name": "network_ifname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "590-593",
    "snippet": "static int network_ifname(char **valuep, const char *value)\n{\n\treturn config_string_item_max(valuep, value, IFNAMSIZ);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_string_item_max",
          "args": [
            "valuep",
            "value",
            "IFNAMSIZ"
          ],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "config_string_item_max",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "348-357",
          "snippet": "static int config_string_item_max(char **conf_item, const char *value,\n\t\t\t\t  size_t max)\n{\n\tif (strlen(value) >= max) {\n\t\tERROR(\"%s is too long (>= %lu)\", value, (unsigned long)max);\n\t\treturn -1;\n\t}\n\n\treturn config_string_item(conf_item, value);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_string_item_max(char **conf_item, const char *value,\n\t\t\t\t  size_t max)\n{\n\tif (strlen(value) >= max) {\n\t\tERROR(\"%s is too long (>= %lu)\", value, (unsigned long)max);\n\t\treturn -1;\n\t}\n\n\treturn config_string_item(conf_item, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int network_ifname(char **valuep, const char *value)\n{\n\treturn config_string_item_max(valuep, value, IFNAMSIZ);\n}"
  },
  {
    "function_name": "network_netdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "565-588",
    "snippet": "static struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"no network device defined for '%s' = '%s' option\"",
            "key",
            "value"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_netdev_from_key",
          "args": [
            "key+12",
            "network"
          ],
          "line": 579
        },
        "resolved": true,
        "details": {
          "function_name": "get_netdev_from_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "503-518",
          "snippet": "static struct lxc_netdev *get_netdev_from_key(const char *key,\n\t\t\t\t\t      struct lxc_list *network)\n{\n\tint i = 0, idx = get_network_netdev_idx(key);\n\tstruct lxc_netdev *netdev = NULL;\n\tstruct lxc_list *it;\n\tif (idx == -1)\n\t\treturn NULL;\n\tlxc_list_for_each(it, network) {\n\t\tif (idx == i++) {\n\t\t\tnetdev = it->elem;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn netdev;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct lxc_netdev *get_netdev_from_key(const char *key,\n\t\t\t\t\t      struct lxc_list *network)\n{\n\tint i = 0, idx = get_network_netdev_idx(key);\n\tstruct lxc_netdev *netdev = NULL;\n\tstruct lxc_list *it;\n\tif (idx == -1)\n\t\treturn NULL;\n\tlxc_list_for_each(it, network) {\n\t\tif (idx == i++) {\n\t\t\tnetdev = it->elem;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn netdev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_list_last_elem",
          "args": [
            "network"
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_last_elem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "88-91",
          "snippet": "static inline void *lxc_list_last_elem(struct lxc_list *list)\n{\n\treturn list->prev->elem;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void *lxc_list_last_elem(struct lxc_list *list)\n{\n\treturn list->prev->elem;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_network_netdev_idx",
          "args": [
            "key+12"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "get_network_netdev_idx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "487-497",
          "snippet": "static int get_network_netdev_idx(const char *key)\n{\n\tint ret, idx;\n\n\tif (*key < '0' || *key > '9')\n\t\treturn -1;\n\tret = sscanf(key, \"%d\", &idx);\n\tif (ret != 1)\n\t\treturn -1;\n\treturn idx;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int get_network_netdev_idx(const char *key)\n{\n\tint ret, idx;\n\n\tif (*key < '0' || *key > '9')\n\t\treturn -1;\n\tret = sscanf(key, \"%d\", &idx);\n\tif (ret != 1)\n\t\treturn -1;\n\treturn idx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"network is not created for '%s' = '%s' option\"",
            "key",
            "value"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_list_empty",
          "args": [
            "network"
          ],
          "line": 570
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "94-97",
          "snippet": "static inline int lxc_list_empty(struct lxc_list *list)\n{\n\treturn list == list->next;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline int lxc_list_empty(struct lxc_list *list)\n{\n\treturn list == list->next;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic struct lxc_netdev *network_netdev(const char *key, const char *value,\n\t\t\t\t\t struct lxc_list *network)\n{\n\tstruct lxc_netdev *netdev = NULL;\n\n\tif (lxc_list_empty(network)) {\n\t\tERROR(\"network is not created for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\tif (get_network_netdev_idx(key+12) == -1)\n\t\tnetdev = lxc_list_last_elem(network);\n\telse\n\t\tnetdev = get_netdev_from_key(key+12, network);\n\n\tif (!netdev) {\n\t\tERROR(\"no network device defined for '%s' = '%s' option\",\n\t\t      key, value);\n\t\treturn NULL;\n\t}\n\n\treturn netdev;\n}"
  },
  {
    "function_name": "lxc_list_nicconfigs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "520-563",
    "snippet": "extern int lxc_list_nicconfigs(struct lxc_conf *c, const char *key,\n\t\t\t       char *retv, int inlen)\n{\n\tstruct lxc_netdev *netdev;\n\tint fulllen = 0, len;\n\n\tnetdev = get_netdev_from_key(key+12, &c->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tstrprint(retv, inlen, \"type\\n\");\n\tstrprint(retv, inlen, \"script.up\\n\");\n\tstrprint(retv, inlen, \"script.down\\n\");\n\tif (netdev->type != LXC_NET_EMPTY) {\n\t\tstrprint(retv, inlen, \"flags\\n\");\n\t\tstrprint(retv, inlen, \"link\\n\");\n\t\tstrprint(retv, inlen, \"name\\n\");\n\t\tstrprint(retv, inlen, \"hwaddr\\n\");\n\t\tstrprint(retv, inlen, \"mtu\\n\");\n\t\tstrprint(retv, inlen, \"ipv6\\n\");\n\t\tstrprint(retv, inlen, \"ipv6.gateway\\n\");\n\t\tstrprint(retv, inlen, \"ipv4\\n\");\n\t\tstrprint(retv, inlen, \"ipv4.gateway\\n\");\n\t}\n\tswitch(netdev->type) {\n\tcase LXC_NET_VETH:\n\t\tstrprint(retv, inlen, \"veth.pair\\n\");\n\t\tbreak;\n\tcase LXC_NET_MACVLAN:\n\t\tstrprint(retv, inlen, \"macvlan.mode\\n\");\n\t\tbreak;\n\tcase LXC_NET_VLAN:\n\t\tstrprint(retv, inlen, \"vlan.id\\n\");\n\t\tbreak;\n\tcase LXC_NET_PHYS:\n\t\tbreak;\n\t}\n\treturn fulllen;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"vlan.id\\n\""
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"macvlan.mode\\n\""
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"veth.pair\\n\""
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"ipv4.gateway\\n\""
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"ipv4\\n\""
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"ipv6.gateway\\n\""
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"ipv6\\n\""
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"mtu\\n\""
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"hwaddr\\n\""
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"name\\n\""
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"link\\n\""
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"flags\\n\""
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"script.down\\n\""
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"script.up\\n\""
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"type\\n\""
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "retv",
            "0",
            "inlen"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_netdev_from_key",
          "args": [
            "key+12",
            "&c->network"
          ],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "get_netdev_from_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "503-518",
          "snippet": "static struct lxc_netdev *get_netdev_from_key(const char *key,\n\t\t\t\t\t      struct lxc_list *network)\n{\n\tint i = 0, idx = get_network_netdev_idx(key);\n\tstruct lxc_netdev *netdev = NULL;\n\tstruct lxc_list *it;\n\tif (idx == -1)\n\t\treturn NULL;\n\tlxc_list_for_each(it, network) {\n\t\tif (idx == i++) {\n\t\t\tnetdev = it->elem;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn netdev;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct lxc_netdev *get_netdev_from_key(const char *key,\n\t\t\t\t\t      struct lxc_list *network)\n{\n\tint i = 0, idx = get_network_netdev_idx(key);\n\tstruct lxc_netdev *netdev = NULL;\n\tstruct lxc_list *it;\n\tif (idx == -1)\n\t\treturn NULL;\n\tlxc_list_for_each(it, network) {\n\t\tif (idx == i++) {\n\t\t\tnetdev = it->elem;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn netdev;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nextern int lxc_list_nicconfigs(struct lxc_conf *c, const char *key,\n\t\t\t       char *retv, int inlen)\n{\n\tstruct lxc_netdev *netdev;\n\tint fulllen = 0, len;\n\n\tnetdev = get_netdev_from_key(key+12, &c->network);\n\tif (!netdev)\n\t\treturn -1;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\n\tstrprint(retv, inlen, \"type\\n\");\n\tstrprint(retv, inlen, \"script.up\\n\");\n\tstrprint(retv, inlen, \"script.down\\n\");\n\tif (netdev->type != LXC_NET_EMPTY) {\n\t\tstrprint(retv, inlen, \"flags\\n\");\n\t\tstrprint(retv, inlen, \"link\\n\");\n\t\tstrprint(retv, inlen, \"name\\n\");\n\t\tstrprint(retv, inlen, \"hwaddr\\n\");\n\t\tstrprint(retv, inlen, \"mtu\\n\");\n\t\tstrprint(retv, inlen, \"ipv6\\n\");\n\t\tstrprint(retv, inlen, \"ipv6.gateway\\n\");\n\t\tstrprint(retv, inlen, \"ipv4\\n\");\n\t\tstrprint(retv, inlen, \"ipv4.gateway\\n\");\n\t}\n\tswitch(netdev->type) {\n\tcase LXC_NET_VETH:\n\t\tstrprint(retv, inlen, \"veth.pair\\n\");\n\t\tbreak;\n\tcase LXC_NET_MACVLAN:\n\t\tstrprint(retv, inlen, \"macvlan.mode\\n\");\n\t\tbreak;\n\tcase LXC_NET_VLAN:\n\t\tstrprint(retv, inlen, \"vlan.id\\n\");\n\t\tbreak;\n\tcase LXC_NET_PHYS:\n\t\tbreak;\n\t}\n\treturn fulllen;\n}"
  },
  {
    "function_name": "get_netdev_from_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "503-518",
    "snippet": "static struct lxc_netdev *get_netdev_from_key(const char *key,\n\t\t\t\t\t      struct lxc_list *network)\n{\n\tint i = 0, idx = get_network_netdev_idx(key);\n\tstruct lxc_netdev *netdev = NULL;\n\tstruct lxc_list *it;\n\tif (idx == -1)\n\t\treturn NULL;\n\tlxc_list_for_each(it, network) {\n\t\tif (idx == i++) {\n\t\t\tnetdev = it->elem;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn netdev;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_list_for_each",
          "args": [
            "it",
            "network"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_network_netdev_idx",
          "args": [
            "key"
          ],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "get_network_netdev_idx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "487-497",
          "snippet": "static int get_network_netdev_idx(const char *key)\n{\n\tint ret, idx;\n\n\tif (*key < '0' || *key > '9')\n\t\treturn -1;\n\tret = sscanf(key, \"%d\", &idx);\n\tif (ret != 1)\n\t\treturn -1;\n\treturn idx;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int get_network_netdev_idx(const char *key)\n{\n\tint ret, idx;\n\n\tif (*key < '0' || *key > '9')\n\t\treturn -1;\n\tret = sscanf(key, \"%d\", &idx);\n\tif (ret != 1)\n\t\treturn -1;\n\treturn idx;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct lxc_netdev *get_netdev_from_key(const char *key,\n\t\t\t\t\t      struct lxc_list *network)\n{\n\tint i = 0, idx = get_network_netdev_idx(key);\n\tstruct lxc_netdev *netdev = NULL;\n\tstruct lxc_list *it;\n\tif (idx == -1)\n\t\treturn NULL;\n\tlxc_list_for_each(it, network) {\n\t\tif (idx == i++) {\n\t\t\tnetdev = it->elem;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn netdev;\n}"
  },
  {
    "function_name": "get_network_netdev_idx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "487-497",
    "snippet": "static int get_network_netdev_idx(const char *key)\n{\n\tint ret, idx;\n\n\tif (*key < '0' || *key > '9')\n\t\treturn -1;\n\tret = sscanf(key, \"%d\", &idx);\n\tif (ret != 1)\n\t\treturn -1;\n\treturn idx;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sscanf",
          "args": [
            "key",
            "\"%d\"",
            "&idx"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int get_network_netdev_idx(const char *key)\n{\n\tint ret, idx;\n\n\tif (*key < '0' || *key > '9')\n\t\treturn -1;\n\tret = sscanf(key, \"%d\", &idx);\n\tif (ret != 1)\n\t\treturn -1;\n\treturn idx;\n}"
  },
  {
    "function_name": "config_ip_prefix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "471-481",
    "snippet": "static int config_ip_prefix(struct in_addr *addr)\n{\n\tif (IN_CLASSA(addr->s_addr))\n\t\treturn 32 - IN_CLASSA_NSHIFT;\n\tif (IN_CLASSB(addr->s_addr))\n\t\treturn 32 - IN_CLASSB_NSHIFT;\n\tif (IN_CLASSC(addr->s_addr))\n\t\treturn 32 - IN_CLASSC_NSHIFT;\n\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IN_CLASSC",
          "args": [
            "addr->s_addr"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IN_CLASSB",
          "args": [
            "addr->s_addr"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IN_CLASSA",
          "args": [
            "addr->s_addr"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_ip_prefix(struct in_addr *addr)\n{\n\tif (IN_CLASSA(addr->s_addr))\n\t\treturn 32 - IN_CLASSA_NSHIFT;\n\tif (IN_CLASSB(addr->s_addr))\n\t\treturn 32 - IN_CLASSB_NSHIFT;\n\tif (IN_CLASSC(addr->s_addr))\n\t\treturn 32 - IN_CLASSC_NSHIFT;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "config_network_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "418-469",
    "snippet": "static int config_network_type(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_list *network = &lxc_conf->network;\n\tstruct lxc_netdev *netdev;\n\tstruct lxc_list *list;\n\n\tif (!value || strlen(value) == 0)\n\t\treturn lxc_clear_config_network(lxc_conf);\n\n\tnetdev = malloc(sizeof(*netdev));\n\tif (!netdev) {\n\t\tSYSERROR(\"failed to allocate memory\");\n\t\treturn -1;\n\t}\n\n\tmemset(netdev, 0, sizeof(*netdev));\n\tlxc_list_init(&netdev->ipv4);\n\tlxc_list_init(&netdev->ipv6);\n\n\tlist = malloc(sizeof(*list));\n\tif (!list) {\n\t\tSYSERROR(\"failed to allocate memory\");\n\t\tfree(netdev);\n\t\treturn -1;\n\t}\n\n\tlxc_list_init(list);\n\tlist->elem = netdev;\n\n\tlxc_list_add_tail(network, list);\n\n\tif (!strcmp(value, \"veth\"))\n\t\tnetdev->type = LXC_NET_VETH;\n\telse if (!strcmp(value, \"macvlan\")) {\n\t\tnetdev->type = LXC_NET_MACVLAN;\n\t\tmacvlan_mode(&netdev->priv.macvlan_attr.mode, \"private\");\n\t}\n\telse if (!strcmp(value, \"vlan\"))\n\t\tnetdev->type = LXC_NET_VLAN;\n\telse if (!strcmp(value, \"phys\"))\n\t\tnetdev->type = LXC_NET_PHYS;\n\telse if (!strcmp(value, \"empty\"))\n\t\tnetdev->type = LXC_NET_EMPTY;\n\telse if (!strcmp(value, \"none\"))\n\t\tnetdev->type = LXC_NET_NONE;\n\telse {\n\t\tERROR(\"invalid network type %s\", value);\n\t\treturn -1;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"invalid network type %s\"",
            "value"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "value",
            "\"none\""
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "value",
            "\"empty\""
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "value",
            "\"phys\""
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "value",
            "\"vlan\""
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "macvlan_mode",
          "args": [
            "&netdev->priv.macvlan_attr.mode",
            "\"private\""
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "macvlan_mode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "611-634",
          "snippet": "static int macvlan_mode(int *valuep, const char *value)\n{\n\tstruct mc_mode {\n\t\tchar *name;\n\t\tint mode;\n\t} m[] = {\n\t\t{ \"private\", MACVLAN_MODE_PRIVATE },\n\t\t{ \"vepa\", MACVLAN_MODE_VEPA },\n\t\t{ \"bridge\", MACVLAN_MODE_BRIDGE },\n\t\t{ \"passthru\", MACVLAN_MODE_PASSTHRU },\n\t};\n\n\tsize_t i;\n\n\tfor (i = 0; i < sizeof(m)/sizeof(m[0]); i++) {\n\t\tif (strcmp(m[i].name, value))\n\t\t\tcontinue;\n\n\t\t*valuep = m[i].mode;\n\t\treturn 0;\n\t}\n\n\treturn -1;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int macvlan_mode(int *valuep, const char *value)\n{\n\tstruct mc_mode {\n\t\tchar *name;\n\t\tint mode;\n\t} m[] = {\n\t\t{ \"private\", MACVLAN_MODE_PRIVATE },\n\t\t{ \"vepa\", MACVLAN_MODE_VEPA },\n\t\t{ \"bridge\", MACVLAN_MODE_BRIDGE },\n\t\t{ \"passthru\", MACVLAN_MODE_PASSTHRU },\n\t};\n\n\tsize_t i;\n\n\tfor (i = 0; i < sizeof(m)/sizeof(m[0]); i++) {\n\t\tif (strcmp(m[i].name, value))\n\t\t\tcontinue;\n\n\t\t*valuep = m[i].mode;\n\t\treturn 0;\n\t}\n\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "value",
            "\"macvlan\""
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "value",
            "\"veth\""
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_list_add_tail",
          "args": [
            "network",
            "list"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_add_tail",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "133-137",
          "snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void lxc_list_add_tail(struct lxc_list *head,\n\t\t\t\t     struct lxc_list *list)\n{\n\t__lxc_list_add(list, head->prev, head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_list_init",
          "args": [
            "list"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "68-72",
          "snippet": "static inline void lxc_list_init(struct lxc_list *list)\n{\n\tlist->elem = NULL;\n\tlist->next = list->prev = list;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void lxc_list_init(struct lxc_list *list)\n{\n\tlist->elem = NULL;\n\tlist->next = list->prev = list;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "netdev"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to allocate memory\""
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*list)"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "netdev",
            "0",
            "sizeof(*netdev)"
          ],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to allocate memory\""
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*netdev)"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_clear_config_network",
          "args": [
            "lxc_conf"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_config_network",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4114-4121",
          "snippet": "int lxc_clear_config_network(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\tlxc_list_for_each_safe(it, &c->network, next) {\n\t\tlxc_remove_nic(it);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_clear_config_network(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\tlxc_list_for_each_safe(it, &c->network, next) {\n\t\tlxc_remove_nic(it);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_network_type(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tstruct lxc_list *network = &lxc_conf->network;\n\tstruct lxc_netdev *netdev;\n\tstruct lxc_list *list;\n\n\tif (!value || strlen(value) == 0)\n\t\treturn lxc_clear_config_network(lxc_conf);\n\n\tnetdev = malloc(sizeof(*netdev));\n\tif (!netdev) {\n\t\tSYSERROR(\"failed to allocate memory\");\n\t\treturn -1;\n\t}\n\n\tmemset(netdev, 0, sizeof(*netdev));\n\tlxc_list_init(&netdev->ipv4);\n\tlxc_list_init(&netdev->ipv6);\n\n\tlist = malloc(sizeof(*list));\n\tif (!list) {\n\t\tSYSERROR(\"failed to allocate memory\");\n\t\tfree(netdev);\n\t\treturn -1;\n\t}\n\n\tlxc_list_init(list);\n\tlist->elem = netdev;\n\n\tlxc_list_add_tail(network, list);\n\n\tif (!strcmp(value, \"veth\"))\n\t\tnetdev->type = LXC_NET_VETH;\n\telse if (!strcmp(value, \"macvlan\")) {\n\t\tnetdev->type = LXC_NET_MACVLAN;\n\t\tmacvlan_mode(&netdev->priv.macvlan_attr.mode, \"private\");\n\t}\n\telse if (!strcmp(value, \"vlan\"))\n\t\tnetdev->type = LXC_NET_VLAN;\n\telse if (!strcmp(value, \"phys\"))\n\t\tnetdev->type = LXC_NET_PHYS;\n\telse if (!strcmp(value, \"empty\"))\n\t\tnetdev->type = LXC_NET_EMPTY;\n\telse if (!strcmp(value, \"none\"))\n\t\tnetdev->type = LXC_NET_NONE;\n\telse {\n\t\tERROR(\"invalid network type %s\", value);\n\t\treturn -1;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "config_network",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "405-414",
    "snippet": "static int config_network(const char *key, const char *value,\n\t\tstruct lxc_conf *lxc_conf)\n{\n\tif (value && strlen(value)) {\n\t\tERROR(\"lxc.network must not have a value\");\n\t\treturn -1;\n\t}\n\n\treturn lxc_clear_config_network(lxc_conf);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_clear_config_network",
          "args": [
            "lxc_conf"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_clear_config_network",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4114-4121",
          "snippet": "int lxc_clear_config_network(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\tlxc_list_for_each_safe(it, &c->network, next) {\n\t\tlxc_remove_nic(it);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_clear_config_network(struct lxc_conf *c)\n{\n\tstruct lxc_list *it,*next;\n\tlxc_list_for_each_safe(it, &c->network, next) {\n\t\tlxc_remove_nic(it);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"lxc.network must not have a value\""
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_network(const char *key, const char *value,\n\t\tstruct lxc_conf *lxc_conf)\n{\n\tif (value && strlen(value)) {\n\t\tERROR(\"lxc.network must not have a value\");\n\t\treturn -1;\n\t}\n\n\treturn lxc_clear_config_network(lxc_conf);\n}"
  },
  {
    "function_name": "config_network_nic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "370-403",
    "snippet": "static int config_network_nic(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tchar *copy = strdup(key), *p;\n\tint ret = -1;\n\tstruct lxc_config_t *config;\n\n\tif (!copy) {\n\t\tSYSERROR(\"failed to allocate memory\");\n\t\treturn -1;\n\t}\n\t/*\n\t * ok we know that to get here we've got \"lxc.network.\"\n\t * and it isn't any of the other network entries.  So\n\t * after the second . should come an integer (# of defined\n\t * nic) followed by a valid entry.\n\t */\n\tif (*(key+12) < '0' || *(key+12) > '9')\n\t\tgoto out;\n\tp = strchr(key+12, '.');\n\tif (!p)\n\t\tgoto out;\n\tstrcpy(copy+12, p+1);\n\tconfig = lxc_getconfig(copy);\n\tif (!config) {\n\t\tERROR(\"unknown key %s\", key);\n\t\tgoto out;\n\t}\n\tret = config->cb(key, value, lxc_conf);\n\nout:\n\tfree(copy);\n\treturn ret;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int config_personality(const char *, const char *, struct lxc_conf *);",
      "static int config_pts(const char *, const char *, struct lxc_conf *);",
      "static int config_tty(const char *, const char *, struct lxc_conf *);",
      "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
      "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
      "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
      "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
      "static int config_idmap(const char *, const char *, struct lxc_conf *);",
      "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
      "static int config_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
      "static int config_fstab(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
      "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
      "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
      "static int config_utsname(const char *, const char *, struct lxc_conf *);",
      "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
      "static int config_network(const char *, const char *, struct lxc_conf *);",
      "static int config_network_type(const char *, const char *, struct lxc_conf *);",
      "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
      "static int config_network_link(const char *, const char *, struct lxc_conf *);",
      "static int config_network_name(const char *, const char *, struct lxc_conf *);",
      "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
      "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
      "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
      "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
      "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
      "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
      "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
      "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
      "static int config_console(const char *, const char *, struct lxc_conf *);",
      "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
      "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
      "static int config_includefile(const char *, const char *, struct lxc_conf *);",
      "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
      "static int config_autodev(const char *, const char *, struct lxc_conf *);",
      "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
      "static int config_start(const char *, const char *, struct lxc_conf *);",
      "static int config_syslog(const char *, const char *, struct lxc_conf *);",
      "static int config_monitor(const char *, const char *, struct lxc_conf *);",
      "static int config_group(const char *, const char *, struct lxc_conf *);",
      "static int config_environment(const char *, const char *, struct lxc_conf *);",
      "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
      "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
      "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
      "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
      "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
      "static struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};",
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "copy"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "config->cb",
          "args": [
            "key",
            "value",
            "lxc_conf"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"unknown key %s\"",
            "key"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_getconfig",
          "args": [
            "copy"
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_getconfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "286-295",
          "snippet": "extern struct lxc_config_t *lxc_getconfig(const char *key)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < config_size; i++)\n\t\tif (!strncmp(config[i].name, key,\n\t\t\t     strlen(config[i].name)))\n\t\t\treturn &config[i];\n\treturn NULL;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};",
            "static const size_t config_size = sizeof(config)/sizeof(struct lxc_config_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};\nstatic const size_t config_size = sizeof(config)/sizeof(struct lxc_config_t);\n\nextern struct lxc_config_t *lxc_getconfig(const char *key)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < config_size; i++)\n\t\tif (!strncmp(config[i].name, key,\n\t\t\t     strlen(config[i].name)))\n\t\t\treturn &config[i];\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "copy+12",
            "p+1"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "key+12",
            "'.'"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "strchrnul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/include/getsubopt.c",
          "lines": "28-40",
          "snippet": "char *strchrnul(const char *s, int c)\n{\n    char *result;\n\n    result = strchr( s, c );\n\n    if( !result )\n    {\n        result = (char *)s + strlen( s );\n    }\n\n    return( result );\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n\nchar *strchrnul(const char *s, int c)\n{\n    char *result;\n\n    result = strchr( s, c );\n\n    if( !result )\n    {\n        result = (char *)s + strlen( s );\n    }\n\n    return( result );\n}"
        }
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to allocate memory\""
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "key"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_network_nic(const char *key, const char *value,\n\t\t\t       struct lxc_conf *lxc_conf)\n{\n\tchar *copy = strdup(key), *p;\n\tint ret = -1;\n\tstruct lxc_config_t *config;\n\n\tif (!copy) {\n\t\tSYSERROR(\"failed to allocate memory\");\n\t\treturn -1;\n\t}\n\t/*\n\t * ok we know that to get here we've got \"lxc.network.\"\n\t * and it isn't any of the other network entries.  So\n\t * after the second . should come an integer (# of defined\n\t * nic) followed by a valid entry.\n\t */\n\tif (*(key+12) < '0' || *(key+12) > '9')\n\t\tgoto out;\n\tp = strchr(key+12, '.');\n\tif (!p)\n\t\tgoto out;\n\tstrcpy(copy+12, p+1);\n\tconfig = lxc_getconfig(copy);\n\tif (!config) {\n\t\tERROR(\"unknown key %s\", key);\n\t\tgoto out;\n\t}\n\tret = config->cb(key, value, lxc_conf);\n\nout:\n\tfree(copy);\n\treturn ret;\n}"
  },
  {
    "function_name": "config_path_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "359-362",
    "snippet": "static int config_path_item(char **conf_item, const char *value)\n{\n\treturn config_string_item_max(conf_item, value, PATH_MAX);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_string_item_max",
          "args": [
            "conf_item",
            "value",
            "PATH_MAX"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "config_string_item_max",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "348-357",
          "snippet": "static int config_string_item_max(char **conf_item, const char *value,\n\t\t\t\t  size_t max)\n{\n\tif (strlen(value) >= max) {\n\t\tERROR(\"%s is too long (>= %lu)\", value, (unsigned long)max);\n\t\treturn -1;\n\t}\n\n\treturn config_string_item(conf_item, value);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_string_item_max(char **conf_item, const char *value,\n\t\t\t\t  size_t max)\n{\n\tif (strlen(value) >= max) {\n\t\tERROR(\"%s is too long (>= %lu)\", value, (unsigned long)max);\n\t\treturn -1;\n\t}\n\n\treturn config_string_item(conf_item, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_path_item(char **conf_item, const char *value)\n{\n\treturn config_string_item_max(conf_item, value, PATH_MAX);\n}"
  },
  {
    "function_name": "config_string_item_max",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "348-357",
    "snippet": "static int config_string_item_max(char **conf_item, const char *value,\n\t\t\t\t  size_t max)\n{\n\tif (strlen(value) >= max) {\n\t\tERROR(\"%s is too long (>= %lu)\", value, (unsigned long)max);\n\t\treturn -1;\n\t}\n\n\treturn config_string_item(conf_item, value);\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_string_item",
          "args": [
            "conf_item",
            "value"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "config_string_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "327-346",
          "snippet": "static int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int macvlan_mode(int *valuep, const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"%s is too long (>= %lu)\"",
            "value",
            "(unsigned long)max"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_string_item_max(char **conf_item, const char *value,\n\t\t\t\t  size_t max)\n{\n\tif (strlen(value) >= max) {\n\t\tERROR(\"%s is too long (>= %lu)\", value, (unsigned long)max);\n\t\treturn -1;\n\t}\n\n\treturn config_string_item(conf_item, value);\n}"
  },
  {
    "function_name": "config_string_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "327-346",
    "snippet": "static int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int macvlan_mode(int *valuep, const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "*conf_item"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_seccomp_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/seccomp.c",
          "lines": "776-786",
          "snippet": "void lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}",
          "includes": [
            "#include \"lxcseccomp.h\"",
            "#include \"log.h\"",
            "#include \"config.h\"",
            "#include <sys/utsname.h>",
            "#include <sys/mount.h>",
            "#include <seccomp.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxcseccomp.h\"\n#include \"log.h\"\n#include \"config.h\"\n#include <sys/utsname.h>\n#include <sys/mount.h>\n#include <seccomp.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <errno.h>\n\nvoid lxc_seccomp_free(struct lxc_conf *conf)\n{\n\tfree(conf->seccomp);\n\tconf->seccomp = NULL;\n#if HAVE_SCMP_FILTER_CTX\n\tif (conf->seccomp_ctx) {\n\t\tseccomp_release(conf->seccomp_ctx);\n\t\tconf->seccomp_ctx = NULL;\n\t}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to strdup '%s': %m\"",
            "value"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "value"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int macvlan_mode(int *valuep, const char *value);\n\nstatic int config_string_item(char **conf_item, const char *value)\n{\n\tchar *new_value;\n\n\tif (!value || strlen(value) == 0) {\n\t\tfree(*conf_item);\n\t\t*conf_item = NULL;\n\t\treturn 0;\n\t}\n\n\tnew_value = strdup(value);\n\tif (!new_value) {\n\t\tSYSERROR(\"failed to strdup '%s': %m\", value);\n\t\treturn -1;\n\t}\n\n\tfree(*conf_item);\n\t*conf_item = new_value;\n\treturn 0;\n}"
  },
  {
    "function_name": "lxc_listconfigs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "309-325",
    "snippet": "int lxc_listconfigs(char *retv, int inlen)\n{\n\tsize_t i;\n\tint fulllen = 0, len;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\tfor (i = 0; i < config_size; i++) {\n\t\tchar *s = config[i].name;\n\t\tif (s[strlen(s)-1] == '.')\n\t\t\tcontinue;\n\t\tstrprint(retv, inlen, \"%s\\n\", s);\n\t}\n\treturn fulllen;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};",
      "static const size_t config_size = sizeof(config)/sizeof(struct lxc_config_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprint",
          "args": [
            "retv",
            "inlen",
            "\"%s\\n\"",
            "s"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "s"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "retv",
            "0",
            "inlen"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};\nstatic const size_t config_size = sizeof(config)/sizeof(struct lxc_config_t);\n\nint lxc_listconfigs(char *retv, int inlen)\n{\n\tsize_t i;\n\tint fulllen = 0, len;\n\n\tif (!retv)\n\t\tinlen = 0;\n\telse\n\t\tmemset(retv, 0, inlen);\n\tfor (i = 0; i < config_size; i++) {\n\t\tchar *s = config[i].name;\n\t\tif (s[strlen(s)-1] == '.')\n\t\t\tcontinue;\n\t\tstrprint(retv, inlen, \"%s\\n\", s);\n\t}\n\treturn fulllen;\n}"
  },
  {
    "function_name": "lxc_getconfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
    "lines": "286-295",
    "snippet": "extern struct lxc_config_t *lxc_getconfig(const char *key)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < config_size; i++)\n\t\tif (!strncmp(config[i].name, key,\n\t\t\t     strlen(config[i].name)))\n\t\t\treturn &config[i];\n\treturn NULL;\n}",
    "includes": [
      "#include <sys/personality.h>",
      "#include <../include/ifaddrs.h>",
      "#include <ifaddrs.h>",
      "#include \"lxcseccomp.h\"",
      "#include \"network.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"utils.h\"",
      "#include \"confile.h\"",
      "#include \"config.h\"",
      "#include \"parse.h\"",
      "#include \"bdev.h\"",
      "#include <syslog.h>",
      "#include <dirent.h>",
      "#include <time.h>",
      "#include <net/if.h>",
      "#include <netinet/in.h>",
      "#include <arpa/inet.h>",
      "#include <sys/utsname.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <signal.h>",
      "#include <ctype.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};",
      "static const size_t config_size = sizeof(config)/sizeof(struct lxc_config_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "config[i].name",
            "key",
            "strlen(config[i].name)"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "config[i].name"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};\nstatic const size_t config_size = sizeof(config)/sizeof(struct lxc_config_t);\n\nextern struct lxc_config_t *lxc_getconfig(const char *key)\n{\n\tsize_t i;\n\n\tfor (i = 0; i < config_size; i++)\n\t\tif (!strncmp(config[i].name, key,\n\t\t\t     strlen(config[i].name)))\n\t\t\treturn &config[i];\n\treturn NULL;\n}"
  }
]