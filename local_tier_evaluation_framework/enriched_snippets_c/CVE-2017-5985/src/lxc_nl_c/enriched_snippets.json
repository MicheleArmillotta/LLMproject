[
  {
    "function_name": "netlink_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "317-322",
    "snippet": "extern int netlink_close(struct nl_handler *handler)\n{\n\tclose(handler->fd);\n\thandler->fd = -1;\n\treturn 0;\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "handler->fd"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "netlink_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
          "lines": "317-322",
          "snippet": "extern int netlink_close(struct nl_handler *handler)\n{\n\tclose(handler->fd);\n\thandler->fd = -1;\n\treturn 0;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern int netlink_close(struct nl_handler *handler)\n{\n\tclose(handler->fd);\n\thandler->fd = -1;\n\treturn 0;\n}"
  },
  {
    "function_name": "netlink_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "263-315",
    "snippet": "extern int netlink_open(struct nl_handler *handler, int protocol)\n{\n\tsocklen_t socklen;\n\tint sndbuf = 32768;\n\tint rcvbuf = 32768;\n\tint err;\n\n\tmemset(handler, 0, sizeof(*handler));\n\n\thandler->fd = socket(AF_NETLINK, SOCK_RAW, protocol);\n\tif (handler->fd < 0)\n\t\treturn -errno;\n\n\tif (setsockopt(handler->fd, SOL_SOCKET, SO_SNDBUF,\n\t\t       &sndbuf, sizeof(sndbuf)) < 0)\n\t\tgoto err_with_errno;\n\n\tif (setsockopt(handler->fd, SOL_SOCKET, SO_RCVBUF,\n\t\t       &rcvbuf,sizeof(rcvbuf)) < 0)\n\t\tgoto err_with_errno;\n\n\tmemset(&handler->local, 0, sizeof(handler->local));\n\thandler->local.nl_family = AF_NETLINK;\n\thandler->local.nl_groups = 0;\n\n\tif (bind(handler->fd, (struct sockaddr*)&handler->local,\n\t\t sizeof(handler->local)) < 0)\n\t\tgoto err_with_errno;\n\n\tsocklen = sizeof(handler->local);\n\tif (getsockname(handler->fd, (struct sockaddr*)&handler->local,\n\t\t\t&socklen) < 0)\n\t\tgoto err_with_errno;\n\n\tif (socklen != sizeof(handler->local)) {\n\t\terr = -EINVAL;\n\t\tgoto errclose;\n\t}\n\n\tif (handler->local.nl_family != AF_NETLINK) {\n\t\terr = -EINVAL;\n\t\tgoto errclose;\n\t}\n\n\thandler->seq = time(NULL);\n\n\treturn 0;\nerr_with_errno:\n\terr = -errno;\nerrclose:\n\tclose(handler->fd);\n\treturn err;\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "handler->fd"
          ],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "netlink_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
          "lines": "317-322",
          "snippet": "extern int netlink_close(struct nl_handler *handler)\n{\n\tclose(handler->fd);\n\thandler->fd = -1;\n\treturn 0;\n}",
          "includes": [
            "#include \"nl.h\"",
            "#include <linux/rtnetlink.h>",
            "#include <linux/netlink.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <sys/socket.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern int netlink_close(struct nl_handler *handler)\n{\n\tclose(handler->fd);\n\thandler->fd = -1;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "NULL"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getsockname",
          "args": [
            "handler->fd",
            "(struct sockaddr*)&handler->local",
            "&socklen"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bind",
          "args": [
            "handler->fd",
            "(struct sockaddr*)&handler->local",
            "sizeof(handler->local)"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&handler->local",
            "0",
            "sizeof(handler->local)"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setsockopt",
          "args": [
            "handler->fd",
            "SOL_SOCKET",
            "SO_RCVBUF",
            "&rcvbuf",
            "sizeof(rcvbuf)"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setsockopt",
          "args": [
            "handler->fd",
            "SOL_SOCKET",
            "SO_SNDBUF",
            "&sndbuf",
            "sizeof(sndbuf)"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket",
          "args": [
            "AF_NETLINK",
            "SOCK_RAW",
            "protocol"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "handler",
            "0",
            "sizeof(*handler)"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern int netlink_open(struct nl_handler *handler, int protocol)\n{\n\tsocklen_t socklen;\n\tint sndbuf = 32768;\n\tint rcvbuf = 32768;\n\tint err;\n\n\tmemset(handler, 0, sizeof(*handler));\n\n\thandler->fd = socket(AF_NETLINK, SOCK_RAW, protocol);\n\tif (handler->fd < 0)\n\t\treturn -errno;\n\n\tif (setsockopt(handler->fd, SOL_SOCKET, SO_SNDBUF,\n\t\t       &sndbuf, sizeof(sndbuf)) < 0)\n\t\tgoto err_with_errno;\n\n\tif (setsockopt(handler->fd, SOL_SOCKET, SO_RCVBUF,\n\t\t       &rcvbuf,sizeof(rcvbuf)) < 0)\n\t\tgoto err_with_errno;\n\n\tmemset(&handler->local, 0, sizeof(handler->local));\n\thandler->local.nl_family = AF_NETLINK;\n\thandler->local.nl_groups = 0;\n\n\tif (bind(handler->fd, (struct sockaddr*)&handler->local,\n\t\t sizeof(handler->local)) < 0)\n\t\tgoto err_with_errno;\n\n\tsocklen = sizeof(handler->local);\n\tif (getsockname(handler->fd, (struct sockaddr*)&handler->local,\n\t\t\t&socklen) < 0)\n\t\tgoto err_with_errno;\n\n\tif (socklen != sizeof(handler->local)) {\n\t\terr = -EINVAL;\n\t\tgoto errclose;\n\t}\n\n\tif (handler->local.nl_family != AF_NETLINK) {\n\t\terr = -EINVAL;\n\t\tgoto errclose;\n\t}\n\n\thandler->seq = time(NULL);\n\n\treturn 0;\nerr_with_errno:\n\terr = -errno;\nerrclose:\n\tclose(handler->fd);\n\treturn err;\n}"
  },
  {
    "function_name": "netlink_transaction",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "242-261",
    "snippet": "extern int netlink_transaction(struct nl_handler *handler,\n\t\t\t       struct nlmsg *request, struct nlmsg *answer)\n{\n\tint ret;\n\n\tret = netlink_send(handler, request);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tret = netlink_rcv(handler, answer);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tif (answer->nlmsghdr->nlmsg_type == NLMSG_ERROR) {\n\t\tstruct nlmsgerr *err = (struct nlmsgerr*)NLMSG_DATA(answer->nlmsghdr);\n\t\treturn err->error;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [
      "#define NLMSG_ERROR                0x2"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NLMSG_DATA",
          "args": [
            "answer->nlmsghdr"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "netlink_rcv",
          "args": [
            "handler",
            "answer"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "netlink_rcv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
          "lines": "173-210",
          "snippet": "extern int netlink_rcv(struct nl_handler *handler, struct nlmsg *answer)\n{\n\tint ret;\n\tstruct sockaddr_nl nladdr;\n\tstruct iovec iov = {\n\t\t.iov_base = answer->nlmsghdr,\n\t\t.iov_len = answer->nlmsghdr->nlmsg_len,\n\t};\n\t\n\tstruct msghdr msg = {\n\t\t.msg_name = &nladdr,\n\t\t.msg_namelen = sizeof(nladdr),\n\t\t.msg_iov = &iov,\n\t\t.msg_iovlen = 1,\n\t};\n\t\n\tmemset(&nladdr, 0, sizeof(nladdr));\n\tnladdr.nl_family = AF_NETLINK;\n\tnladdr.nl_pid = 0;\n\tnladdr.nl_groups = 0;\n\nagain:\n\tret = recvmsg(handler->fd, &msg, 0);\n\tif (ret < 0) {\n\t\tif (errno == EINTR)\n\t\t\tgoto again;\n\t\treturn -errno;\n\t}\n\n\tif (!ret)\n\t\treturn 0;\n\n\tif (msg.msg_flags & MSG_TRUNC &&\n\t    ret == answer->nlmsghdr->nlmsg_len)\n\t\treturn -EMSGSIZE;\n\n\treturn ret;\n}",
          "includes": [
            "#include \"nl.h\"",
            "#include <linux/rtnetlink.h>",
            "#include <linux/netlink.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <sys/socket.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern int netlink_rcv(struct nl_handler *handler, struct nlmsg *answer)\n{\n\tint ret;\n\tstruct sockaddr_nl nladdr;\n\tstruct iovec iov = {\n\t\t.iov_base = answer->nlmsghdr,\n\t\t.iov_len = answer->nlmsghdr->nlmsg_len,\n\t};\n\t\n\tstruct msghdr msg = {\n\t\t.msg_name = &nladdr,\n\t\t.msg_namelen = sizeof(nladdr),\n\t\t.msg_iov = &iov,\n\t\t.msg_iovlen = 1,\n\t};\n\t\n\tmemset(&nladdr, 0, sizeof(nladdr));\n\tnladdr.nl_family = AF_NETLINK;\n\tnladdr.nl_pid = 0;\n\tnladdr.nl_groups = 0;\n\nagain:\n\tret = recvmsg(handler->fd, &msg, 0);\n\tif (ret < 0) {\n\t\tif (errno == EINTR)\n\t\t\tgoto again;\n\t\treturn -errno;\n\t}\n\n\tif (!ret)\n\t\treturn 0;\n\n\tif (msg.msg_flags & MSG_TRUNC &&\n\t    ret == answer->nlmsghdr->nlmsg_len)\n\t\treturn -EMSGSIZE;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "netlink_send",
          "args": [
            "handler",
            "request"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "netlink_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
          "lines": "212-237",
          "snippet": "extern int netlink_send(struct nl_handler *handler, struct nlmsg *nlmsg)\n{\n\tstruct sockaddr_nl nladdr;\n\tstruct iovec iov = {\n\t\t.iov_base = nlmsg->nlmsghdr,\n\t\t.iov_len = nlmsg->nlmsghdr->nlmsg_len,\n\t};\n\tstruct msghdr msg = {\n\t\t.msg_name = &nladdr,\n\t\t.msg_namelen = sizeof(nladdr),\n\t\t.msg_iov = &iov,\n\t\t.msg_iovlen = 1,\n\t};\n\tint ret;\n\t\n\tmemset(&nladdr, 0, sizeof(nladdr));\n\tnladdr.nl_family = AF_NETLINK;\n\tnladdr.nl_pid = 0;\n\tnladdr.nl_groups = 0;\n\n\tret = sendmsg(handler->fd, &msg, 0);\n\tif (ret < 0)\n\t\treturn -errno;\n\n\treturn ret;\n}",
          "includes": [
            "#include \"nl.h\"",
            "#include <linux/rtnetlink.h>",
            "#include <linux/netlink.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <sys/socket.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern int netlink_send(struct nl_handler *handler, struct nlmsg *nlmsg)\n{\n\tstruct sockaddr_nl nladdr;\n\tstruct iovec iov = {\n\t\t.iov_base = nlmsg->nlmsghdr,\n\t\t.iov_len = nlmsg->nlmsghdr->nlmsg_len,\n\t};\n\tstruct msghdr msg = {\n\t\t.msg_name = &nladdr,\n\t\t.msg_namelen = sizeof(nladdr),\n\t\t.msg_iov = &iov,\n\t\t.msg_iovlen = 1,\n\t};\n\tint ret;\n\t\n\tmemset(&nladdr, 0, sizeof(nladdr));\n\tnladdr.nl_family = AF_NETLINK;\n\tnladdr.nl_pid = 0;\n\tnladdr.nl_groups = 0;\n\n\tret = sendmsg(handler->fd, &msg, 0);\n\tif (ret < 0)\n\t\treturn -errno;\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\n#define NLMSG_ERROR                0x2\n\nextern int netlink_transaction(struct nl_handler *handler,\n\t\t\t       struct nlmsg *request, struct nlmsg *answer)\n{\n\tint ret;\n\n\tret = netlink_send(handler, request);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tret = netlink_rcv(handler, answer);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tif (answer->nlmsghdr->nlmsg_type == NLMSG_ERROR) {\n\t\tstruct nlmsgerr *err = (struct nlmsgerr*)NLMSG_DATA(answer->nlmsghdr);\n\t\treturn err->error;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "netlink_send",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "212-237",
    "snippet": "extern int netlink_send(struct nl_handler *handler, struct nlmsg *nlmsg)\n{\n\tstruct sockaddr_nl nladdr;\n\tstruct iovec iov = {\n\t\t.iov_base = nlmsg->nlmsghdr,\n\t\t.iov_len = nlmsg->nlmsghdr->nlmsg_len,\n\t};\n\tstruct msghdr msg = {\n\t\t.msg_name = &nladdr,\n\t\t.msg_namelen = sizeof(nladdr),\n\t\t.msg_iov = &iov,\n\t\t.msg_iovlen = 1,\n\t};\n\tint ret;\n\t\n\tmemset(&nladdr, 0, sizeof(nladdr));\n\tnladdr.nl_family = AF_NETLINK;\n\tnladdr.nl_pid = 0;\n\tnladdr.nl_groups = 0;\n\n\tret = sendmsg(handler->fd, &msg, 0);\n\tif (ret < 0)\n\t\treturn -errno;\n\n\treturn ret;\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sendmsg",
          "args": [
            "handler->fd",
            "&msg",
            "0"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&nladdr",
            "0",
            "sizeof(nladdr)"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern int netlink_send(struct nl_handler *handler, struct nlmsg *nlmsg)\n{\n\tstruct sockaddr_nl nladdr;\n\tstruct iovec iov = {\n\t\t.iov_base = nlmsg->nlmsghdr,\n\t\t.iov_len = nlmsg->nlmsghdr->nlmsg_len,\n\t};\n\tstruct msghdr msg = {\n\t\t.msg_name = &nladdr,\n\t\t.msg_namelen = sizeof(nladdr),\n\t\t.msg_iov = &iov,\n\t\t.msg_iovlen = 1,\n\t};\n\tint ret;\n\t\n\tmemset(&nladdr, 0, sizeof(nladdr));\n\tnladdr.nl_family = AF_NETLINK;\n\tnladdr.nl_pid = 0;\n\tnladdr.nl_groups = 0;\n\n\tret = sendmsg(handler->fd, &msg, 0);\n\tif (ret < 0)\n\t\treturn -errno;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "netlink_rcv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "173-210",
    "snippet": "extern int netlink_rcv(struct nl_handler *handler, struct nlmsg *answer)\n{\n\tint ret;\n\tstruct sockaddr_nl nladdr;\n\tstruct iovec iov = {\n\t\t.iov_base = answer->nlmsghdr,\n\t\t.iov_len = answer->nlmsghdr->nlmsg_len,\n\t};\n\t\n\tstruct msghdr msg = {\n\t\t.msg_name = &nladdr,\n\t\t.msg_namelen = sizeof(nladdr),\n\t\t.msg_iov = &iov,\n\t\t.msg_iovlen = 1,\n\t};\n\t\n\tmemset(&nladdr, 0, sizeof(nladdr));\n\tnladdr.nl_family = AF_NETLINK;\n\tnladdr.nl_pid = 0;\n\tnladdr.nl_groups = 0;\n\nagain:\n\tret = recvmsg(handler->fd, &msg, 0);\n\tif (ret < 0) {\n\t\tif (errno == EINTR)\n\t\t\tgoto again;\n\t\treturn -errno;\n\t}\n\n\tif (!ret)\n\t\treturn 0;\n\n\tif (msg.msg_flags & MSG_TRUNC &&\n\t    ret == answer->nlmsghdr->nlmsg_len)\n\t\treturn -EMSGSIZE;\n\n\treturn ret;\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "recvmsg",
          "args": [
            "handler->fd",
            "&msg",
            "0"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&nladdr",
            "0",
            "sizeof(nladdr)"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern int netlink_rcv(struct nl_handler *handler, struct nlmsg *answer)\n{\n\tint ret;\n\tstruct sockaddr_nl nladdr;\n\tstruct iovec iov = {\n\t\t.iov_base = answer->nlmsghdr,\n\t\t.iov_len = answer->nlmsghdr->nlmsg_len,\n\t};\n\t\n\tstruct msghdr msg = {\n\t\t.msg_name = &nladdr,\n\t\t.msg_namelen = sizeof(nladdr),\n\t\t.msg_iov = &iov,\n\t\t.msg_iovlen = 1,\n\t};\n\t\n\tmemset(&nladdr, 0, sizeof(nladdr));\n\tnladdr.nl_family = AF_NETLINK;\n\tnladdr.nl_pid = 0;\n\tnladdr.nl_groups = 0;\n\nagain:\n\tret = recvmsg(handler->fd, &msg, 0);\n\tif (ret < 0) {\n\t\tif (errno == EINTR)\n\t\t\tgoto again;\n\t\treturn -errno;\n\t}\n\n\tif (!ret)\n\t\treturn 0;\n\n\tif (msg.msg_flags & MSG_TRUNC &&\n\t    ret == answer->nlmsghdr->nlmsg_len)\n\t\treturn -EMSGSIZE;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "nlmsg_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "164-171",
    "snippet": "extern void nlmsg_free(struct nlmsg *nlmsg)\n{\n\tif (!nlmsg)\n\t\treturn;\n\n\tfree(nlmsg->nlmsghdr);\n\tfree(nlmsg);\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "nlmsg"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "nlmsg_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
          "lines": "164-171",
          "snippet": "extern void nlmsg_free(struct nlmsg *nlmsg)\n{\n\tif (!nlmsg)\n\t\treturn;\n\n\tfree(nlmsg->nlmsghdr);\n\tfree(nlmsg);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern void nlmsg_free(struct nlmsg *nlmsg)\n{\n\tif (!nlmsg)\n\t\treturn;\n\n\tfree(nlmsg->nlmsghdr);\n\tfree(nlmsg);\n}"
  },
  {
    "function_name": "nlmsg_alloc_reserve",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "151-162",
    "snippet": "extern struct nlmsg *nlmsg_alloc_reserve(size_t size)\n{\n\tstruct nlmsg *nlmsg;\n\n\tnlmsg = nlmsg_alloc(size);\n\tif (!nlmsg)\n\t\treturn NULL;\n\n\t// just set message length to cap directly\n\tnlmsg->nlmsghdr->nlmsg_len = nlmsg->cap;\n\treturn nlmsg;\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nlmsg_alloc",
          "args": [
            "size"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "nlmsg_alloc_reserve",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
          "lines": "151-162",
          "snippet": "extern struct nlmsg *nlmsg_alloc_reserve(size_t size)\n{\n\tstruct nlmsg *nlmsg;\n\n\tnlmsg = nlmsg_alloc(size);\n\tif (!nlmsg)\n\t\treturn NULL;\n\n\t// just set message length to cap directly\n\tnlmsg->nlmsghdr->nlmsg_len = nlmsg->cap;\n\treturn nlmsg;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern struct nlmsg *nlmsg_alloc_reserve(size_t size)\n{\n\tstruct nlmsg *nlmsg;\n\n\tnlmsg = nlmsg_alloc(size);\n\tif (!nlmsg)\n\t\treturn NULL;\n\n\t// just set message length to cap directly\n\tnlmsg->nlmsghdr->nlmsg_len = nlmsg->cap;\n\treturn nlmsg;\n}"
  },
  {
    "function_name": "nlmsg_reserve",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "133-149",
    "snippet": "extern void *nlmsg_reserve(struct nlmsg *nlmsg, size_t len)\n{\n\tvoid *buf;\n\tsize_t nlmsg_len = nlmsg->nlmsghdr->nlmsg_len;\n\tsize_t tlen = NLMSG_ALIGN(len);\n\n\tif (nlmsg_len + tlen > nlmsg->cap)\n\t\treturn NULL;\n\n\tbuf = ((char *)(nlmsg->nlmsghdr)) + nlmsg_len;\n\tnlmsg->nlmsghdr->nlmsg_len += tlen;\n\n\tif (tlen > len)\n\t\tmemset(buf + len, 0, tlen - len);\n\n\treturn buf;\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "buf + len",
            "0",
            "tlen - len"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NLMSG_ALIGN",
          "args": [
            "len"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern void *nlmsg_reserve(struct nlmsg *nlmsg, size_t len)\n{\n\tvoid *buf;\n\tsize_t nlmsg_len = nlmsg->nlmsghdr->nlmsg_len;\n\tsize_t tlen = NLMSG_ALIGN(len);\n\n\tif (nlmsg_len + tlen > nlmsg->cap)\n\t\treturn NULL;\n\n\tbuf = ((char *)(nlmsg->nlmsghdr)) + nlmsg_len;\n\tnlmsg->nlmsghdr->nlmsg_len += tlen;\n\n\tif (tlen > len)\n\t\tmemset(buf + len, 0, tlen - len);\n\n\treturn buf;\n}"
  },
  {
    "function_name": "nlmsg_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "110-131",
    "snippet": "extern struct nlmsg *nlmsg_alloc(size_t size)\n{\n\tstruct nlmsg *nlmsg;\n\tsize_t len = NLMSG_HDRLEN + NLMSG_ALIGN(size);\n\n\tnlmsg = (struct nlmsg *)malloc(sizeof(struct nlmsg));\n\tif (!nlmsg)\n\t\treturn NULL;\n\n\tnlmsg->nlmsghdr = (struct nlmsghdr *)malloc(len);\n\tif (!nlmsg->nlmsghdr)\n\t\tgoto errout;\n\n\tmemset(nlmsg->nlmsghdr, 0, len);\n\tnlmsg->cap = len;\n\tnlmsg->nlmsghdr->nlmsg_len = NLMSG_HDRLEN;\n\n\treturn nlmsg;\nerrout:\n\tfree(nlmsg);\n\treturn NULL;\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "nlmsg"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "nlmsg_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
          "lines": "164-171",
          "snippet": "extern void nlmsg_free(struct nlmsg *nlmsg)\n{\n\tif (!nlmsg)\n\t\treturn;\n\n\tfree(nlmsg->nlmsghdr);\n\tfree(nlmsg);\n}",
          "includes": [
            "#include \"nl.h\"",
            "#include <linux/rtnetlink.h>",
            "#include <linux/netlink.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <sys/socket.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern void nlmsg_free(struct nlmsg *nlmsg)\n{\n\tif (!nlmsg)\n\t\treturn;\n\n\tfree(nlmsg->nlmsghdr);\n\tfree(nlmsg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "nlmsg->nlmsghdr",
            "0",
            "len"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "len"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(struct nlmsg)"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NLMSG_ALIGN",
          "args": [
            "size"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern struct nlmsg *nlmsg_alloc(size_t size)\n{\n\tstruct nlmsg *nlmsg;\n\tsize_t len = NLMSG_HDRLEN + NLMSG_ALIGN(size);\n\n\tnlmsg = (struct nlmsg *)malloc(sizeof(struct nlmsg));\n\tif (!nlmsg)\n\t\treturn NULL;\n\n\tnlmsg->nlmsghdr = (struct nlmsghdr *)malloc(len);\n\tif (!nlmsg->nlmsghdr)\n\t\tgoto errout;\n\n\tmemset(nlmsg->nlmsghdr, 0, len);\n\tnlmsg->cap = len;\n\tnlmsg->nlmsghdr->nlmsg_len = NLMSG_HDRLEN;\n\n\treturn nlmsg;\nerrout:\n\tfree(nlmsg);\n\treturn NULL;\n}"
  },
  {
    "function_name": "nla_end_nested",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "105-108",
    "snippet": "void nla_end_nested(struct nlmsg *nlmsg, struct rtattr *attr)\n{\n\tattr->rta_len = (void *)NLMSG_TAIL(nlmsg->nlmsghdr) - (void *)attr;\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NLMSG_TAIL",
          "args": [
            "nlmsg->nlmsghdr"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nvoid nla_end_nested(struct nlmsg *nlmsg, struct rtattr *attr)\n{\n\tattr->rta_len = (void *)NLMSG_TAIL(nlmsg->nlmsghdr) - (void *)attr;\n}"
  },
  {
    "function_name": "nla_begin_nested",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "95-103",
    "snippet": "struct rtattr *nla_begin_nested(struct nlmsg *nlmsg, int attr)\n{\n\tstruct rtattr *rtattr = NLMSG_TAIL(nlmsg->nlmsghdr);\n\n\tif (nla_put_attr(nlmsg, attr))\n\t\treturn NULL;\n\n\treturn rtattr;\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nla_put_attr",
          "args": [
            "nlmsg",
            "attr"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "nla_put_attr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
          "lines": "90-93",
          "snippet": "extern int nla_put_attr(struct nlmsg *nlmsg, int attr)\n{\n\treturn nla_put(nlmsg, attr, NULL, 0);\n}",
          "includes": [
            "#include \"nl.h\"",
            "#include <linux/rtnetlink.h>",
            "#include <linux/netlink.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <sys/socket.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern int nla_put_attr(struct nlmsg *nlmsg, int attr)\n{\n\treturn nla_put(nlmsg, attr, NULL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NLMSG_TAIL",
          "args": [
            "nlmsg->nlmsghdr"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nstruct rtattr *nla_begin_nested(struct nlmsg *nlmsg, int attr)\n{\n\tstruct rtattr *rtattr = NLMSG_TAIL(nlmsg->nlmsghdr);\n\n\tif (nla_put_attr(nlmsg, attr))\n\t\treturn NULL;\n\n\treturn rtattr;\n}"
  },
  {
    "function_name": "nla_put_attr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "90-93",
    "snippet": "extern int nla_put_attr(struct nlmsg *nlmsg, int attr)\n{\n\treturn nla_put(nlmsg, attr, NULL, 0);\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nla_put",
          "args": [
            "nlmsg",
            "attr",
            "NULL",
            "0"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "nla_put_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
          "lines": "69-73",
          "snippet": "extern int nla_put_buffer(struct nlmsg *nlmsg, int attr,\n\t\t\t  const void *data, size_t size)\n{\n\treturn nla_put(nlmsg, attr, data, size);\n}",
          "includes": [
            "#include \"nl.h\"",
            "#include <linux/rtnetlink.h>",
            "#include <linux/netlink.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <sys/socket.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern int nla_put_buffer(struct nlmsg *nlmsg, int attr,\n\t\t\t  const void *data, size_t size)\n{\n\treturn nla_put(nlmsg, attr, data, size);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern int nla_put_attr(struct nlmsg *nlmsg, int attr)\n{\n\treturn nla_put(nlmsg, attr, NULL, 0);\n}"
  },
  {
    "function_name": "nla_put_u16",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "85-88",
    "snippet": "extern int nla_put_u16(struct nlmsg *nlmsg, int attr, unsigned short value)\n{\n\treturn nla_put(nlmsg, attr, &value, 2);\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nla_put",
          "args": [
            "nlmsg",
            "attr",
            "&value",
            "2"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "nla_put_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
          "lines": "69-73",
          "snippet": "extern int nla_put_buffer(struct nlmsg *nlmsg, int attr,\n\t\t\t  const void *data, size_t size)\n{\n\treturn nla_put(nlmsg, attr, data, size);\n}",
          "includes": [
            "#include \"nl.h\"",
            "#include <linux/rtnetlink.h>",
            "#include <linux/netlink.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <sys/socket.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern int nla_put_buffer(struct nlmsg *nlmsg, int attr,\n\t\t\t  const void *data, size_t size)\n{\n\treturn nla_put(nlmsg, attr, data, size);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern int nla_put_u16(struct nlmsg *nlmsg, int attr, unsigned short value)\n{\n\treturn nla_put(nlmsg, attr, &value, 2);\n}"
  },
  {
    "function_name": "nla_put_u32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "80-83",
    "snippet": "extern int nla_put_u32(struct nlmsg *nlmsg, int attr, int value)\n{\n\treturn nla_put(nlmsg, attr, &value, sizeof(value));\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nla_put",
          "args": [
            "nlmsg",
            "attr",
            "&value",
            "sizeof(value)"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "nla_put_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
          "lines": "69-73",
          "snippet": "extern int nla_put_buffer(struct nlmsg *nlmsg, int attr,\n\t\t\t  const void *data, size_t size)\n{\n\treturn nla_put(nlmsg, attr, data, size);\n}",
          "includes": [
            "#include \"nl.h\"",
            "#include <linux/rtnetlink.h>",
            "#include <linux/netlink.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <sys/socket.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern int nla_put_buffer(struct nlmsg *nlmsg, int attr,\n\t\t\t  const void *data, size_t size)\n{\n\treturn nla_put(nlmsg, attr, data, size);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern int nla_put_u32(struct nlmsg *nlmsg, int attr, int value)\n{\n\treturn nla_put(nlmsg, attr, &value, sizeof(value));\n}"
  },
  {
    "function_name": "nla_put_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "75-78",
    "snippet": "extern int nla_put_string(struct nlmsg *nlmsg, int attr, const char *string)\n{\n\treturn nla_put(nlmsg, attr, string, strlen(string) + 1);\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nla_put",
          "args": [
            "nlmsg",
            "attr",
            "string",
            "strlen(string) + 1"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "nla_put_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
          "lines": "69-73",
          "snippet": "extern int nla_put_buffer(struct nlmsg *nlmsg, int attr,\n\t\t\t  const void *data, size_t size)\n{\n\treturn nla_put(nlmsg, attr, data, size);\n}",
          "includes": [
            "#include \"nl.h\"",
            "#include <linux/rtnetlink.h>",
            "#include <linux/netlink.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <sys/socket.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern int nla_put_buffer(struct nlmsg *nlmsg, int attr,\n\t\t\t  const void *data, size_t size)\n{\n\treturn nla_put(nlmsg, attr, data, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "string"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern int nla_put_string(struct nlmsg *nlmsg, int attr, const char *string)\n{\n\treturn nla_put(nlmsg, attr, string, strlen(string) + 1);\n}"
  },
  {
    "function_name": "nla_put_buffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "69-73",
    "snippet": "extern int nla_put_buffer(struct nlmsg *nlmsg, int attr,\n\t\t\t  const void *data, size_t size)\n{\n\treturn nla_put(nlmsg, attr, data, size);\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nla_put",
          "args": [
            "nlmsg",
            "attr",
            "data",
            "size"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "nla_put_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
          "lines": "69-73",
          "snippet": "extern int nla_put_buffer(struct nlmsg *nlmsg, int attr,\n\t\t\t  const void *data, size_t size)\n{\n\treturn nla_put(nlmsg, attr, data, size);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern int nla_put_buffer(struct nlmsg *nlmsg, int attr,\n\t\t\t  const void *data, size_t size)\n{\n\treturn nla_put(nlmsg, attr, data, size);\n}"
  },
  {
    "function_name": "nla_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "51-67",
    "snippet": "static int nla_put(struct nlmsg *nlmsg, int attr,\n\t\t   const void *data, size_t len)\n{\n\tstruct rtattr *rta;\n\tsize_t rtalen = RTA_LENGTH(len);\n\tsize_t tlen = NLMSG_ALIGN(nlmsg->nlmsghdr->nlmsg_len) + RTA_ALIGN(rtalen);\n\n\tif (tlen > nlmsg->cap)\n\t\treturn -ENOMEM;\n\n\trta = NLMSG_TAIL(nlmsg->nlmsghdr);\n\trta->rta_type = attr;\n\trta->rta_len = rtalen;\n\tmemcpy(RTA_DATA(rta), data, len);\n\tnlmsg->nlmsghdr->nlmsg_len = tlen;\n\treturn 0;\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "RTA_DATA(rta)",
            "data",
            "len"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RTA_DATA",
          "args": [
            "rta"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NLMSG_TAIL",
          "args": [
            "nlmsg->nlmsghdr"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RTA_ALIGN",
          "args": [
            "rtalen"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NLMSG_ALIGN",
          "args": [
            "nlmsg->nlmsghdr->nlmsg_len"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RTA_LENGTH",
          "args": [
            "len"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nstatic int nla_put(struct nlmsg *nlmsg, int attr,\n\t\t   const void *data, size_t len)\n{\n\tstruct rtattr *rta;\n\tsize_t rtalen = RTA_LENGTH(len);\n\tsize_t tlen = NLMSG_ALIGN(nlmsg->nlmsghdr->nlmsg_len) + RTA_ALIGN(rtalen);\n\n\tif (tlen > nlmsg->cap)\n\t\treturn -ENOMEM;\n\n\trta = NLMSG_TAIL(nlmsg->nlmsghdr);\n\trta->rta_type = attr;\n\trta->rta_len = rtalen;\n\tmemcpy(RTA_DATA(rta), data, len);\n\tnlmsg->nlmsghdr->nlmsg_len = tlen;\n\treturn 0;\n}"
  },
  {
    "function_name": "nlmsg_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "43-49",
    "snippet": "extern void *nlmsg_data(struct nlmsg *nlmsg)\n{\n\tchar *data = ((char *)nlmsg) + NLMSG_HDRLEN;\n\tif (!nlmsg_len(nlmsg))\n\t\treturn NULL;\n\treturn data;\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nlmsg_len",
          "args": [
            "nlmsg"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "nlmsg_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
          "lines": "38-41",
          "snippet": "extern size_t nlmsg_len(const struct nlmsg *nlmsg)\n{\n\treturn nlmsg->nlmsghdr->nlmsg_len - NLMSG_HDRLEN;\n}",
          "includes": [
            "#include \"nl.h\"",
            "#include <linux/rtnetlink.h>",
            "#include <linux/netlink.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <sys/socket.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern size_t nlmsg_len(const struct nlmsg *nlmsg)\n{\n\treturn nlmsg->nlmsghdr->nlmsg_len - NLMSG_HDRLEN;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern void *nlmsg_data(struct nlmsg *nlmsg)\n{\n\tchar *data = ((char *)nlmsg) + NLMSG_HDRLEN;\n\tif (!nlmsg_len(nlmsg))\n\t\treturn NULL;\n\treturn data;\n}"
  },
  {
    "function_name": "nlmsg_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/nl.c",
    "lines": "38-41",
    "snippet": "extern size_t nlmsg_len(const struct nlmsg *nlmsg)\n{\n\treturn nlmsg->nlmsghdr->nlmsg_len - NLMSG_HDRLEN;\n}",
    "includes": [
      "#include \"nl.h\"",
      "#include <linux/rtnetlink.h>",
      "#include <linux/netlink.h>",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <sys/socket.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nl.h\"\n#include <linux/rtnetlink.h>\n#include <linux/netlink.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <string.h>\n#include <sys/socket.h>\n\nextern size_t nlmsg_len(const struct nlmsg *nlmsg)\n{\n\treturn nlmsg->nlmsghdr->nlmsg_len - NLMSG_HDRLEN;\n}"
  }
]