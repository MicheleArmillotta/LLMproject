[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/tools/lxc_execute.c",
    "lines": "105-170",
    "snippet": "int main(int argc, char *argv[])\n{\n\tchar *rcfile;\n\tstruct lxc_conf *conf;\n\tint ret;\n\n\tlxc_list_init(&defines);\n\n\tif (lxc_caps_init())\n\t\texit(EXIT_FAILURE);\n\n\tif (lxc_arguments_parse(&my_args, argc, argv))\n\t\texit(EXIT_FAILURE);\n\n\tif (lxc_log_init(my_args.name, my_args.log_file, my_args.log_priority,\n\t\t\t my_args.progname, my_args.quiet, my_args.lxcpath[0]))\n\t\texit(EXIT_FAILURE);\n\tlxc_log_options_no_override();\n\n\t/* rcfile is specified in the cli option */\n\tif (my_args.rcfile)\n\t\trcfile = (char *)my_args.rcfile;\n\telse {\n\t\tint rc;\n\n\t\trc = asprintf(&rcfile, \"%s/%s/config\", my_args.lxcpath[0], my_args.name);\n\t\tif (rc == -1) {\n\t\t\tSYSERROR(\"failed to allocate memory\");\n\t\t\texit(EXIT_FAILURE);\n\t\t}\n\n\t\t/* container configuration does not exist */\n\t\tif (access(rcfile, F_OK)) {\n\t\t\tfree(rcfile);\n\t\t\trcfile = NULL;\n\t\t}\n\t}\n\n\tconf = lxc_conf_init();\n\tif (!conf) {\n\t\tERROR(\"failed to initialize configuration\");\n\t\texit(EXIT_FAILURE);\n\t}\n\n\tif (rcfile && lxc_config_read(rcfile, conf, NULL)) {\n\t\tERROR(\"failed to read configuration file\");\n\t\texit(EXIT_FAILURE);\n\t}\n\n\tif (lxc_config_define_load(&defines, conf))\n\t\texit(EXIT_FAILURE);\n\n\tif (my_args.uid)\n\t\tconf->init_uid = my_args.uid;\n\n\tif (my_args.gid)\n\t\tconf->init_gid = my_args.gid;\n\n\tret = lxc_execute(my_args.name, my_args.argv, my_args.quiet, conf, my_args.lxcpath[0], false);\n\n\tlxc_conf_free(conf);\n\n\tif (ret < 0)\n\t\texit(EXIT_FAILURE);\n\texit(EXIT_SUCCESS);\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include \"start.h\"",
      "#include \"config.h\"",
      "#include \"arguments.h\"",
      "#include \"confile.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"lxc.h\"",
      "#include \"caps.h\"",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <libgen.h>",
      "#include <errno.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct lxc_list defines;",
      "static struct lxc_arguments my_args = {\n\t.progname = \"lxc-execute\",\n\t.help     = \"\\\n--name=NAME -- COMMAND\\n\\\n\\n\\\nlxc-execute creates a container with the identifier NAME\\n\\\nand execs COMMAND into this container.\\n\\\n\\n\\\nOptions :\\n\\\n  -n, --name=NAME      NAME of the container\\n\\\n  -f, --rcfile=FILE    Load configuration file FILE\\n\\\n  -s, --define KEY=VAL Assign VAL to configuration variable KEY\\n\\\n  -u, --uid=UID        Execute COMMAND with UID inside the container\\n\\\n  -g, --gid=GID        Execute COMMAND with GID inside the container\\n\",\n\t.options  = my_longopts,\n\t.parser   = my_parser,\n\t.checker  = my_checker,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "EXIT_SUCCESS"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "EXIT_FAILURE"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_conf_free",
          "args": [
            "conf"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_conf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "4289-4328",
          "snippet": "void lxc_conf_free(struct lxc_conf *conf)\n{\n\tif (!conf)\n\t\treturn;\n\tif (current_config == conf)\n\t\tcurrent_config = NULL;\n\tfree(conf->console.log_path);\n\tfree(conf->console.path);\n\tfree(conf->rootfs.mount);\n\tfree(conf->rootfs.bdev_type);\n\tfree(conf->rootfs.options);\n\tfree(conf->rootfs.path);\n\tfree(conf->logfile);\n\tif (conf->logfd != -1)\n\t\tclose(conf->logfd);\n\tfree(conf->utsname);\n\tfree(conf->ttydir);\n\tfree(conf->fstab);\n\tfree(conf->rcfile);\n\tfree(conf->init_cmd);\n\tfree(conf->unexpanded_config);\n\tfree(conf->pty_names);\n\tfree(conf->syslog);\n\tlxc_clear_config_network(conf);\n\tfree(conf->lsm_aa_profile);\n\tfree(conf->lsm_se_context);\n\tlxc_seccomp_free(conf);\n\tlxc_clear_config_caps(conf);\n\tlxc_clear_config_keepcaps(conf);\n\tlxc_clear_cgroups(conf, \"lxc.cgroup\");\n\tlxc_clear_hooks(conf, \"lxc.hook\");\n\tlxc_clear_mount_entries(conf);\n\tlxc_clear_saved_nics(conf);\n\tlxc_clear_idmaps(conf);\n\tlxc_clear_groups(conf);\n\tlxc_clear_includes(conf);\n\tlxc_clear_aliens(conf);\n\tlxc_clear_environment(conf);\n\tfree(conf);\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nvoid lxc_conf_free(struct lxc_conf *conf)\n{\n\tif (!conf)\n\t\treturn;\n\tif (current_config == conf)\n\t\tcurrent_config = NULL;\n\tfree(conf->console.log_path);\n\tfree(conf->console.path);\n\tfree(conf->rootfs.mount);\n\tfree(conf->rootfs.bdev_type);\n\tfree(conf->rootfs.options);\n\tfree(conf->rootfs.path);\n\tfree(conf->logfile);\n\tif (conf->logfd != -1)\n\t\tclose(conf->logfd);\n\tfree(conf->utsname);\n\tfree(conf->ttydir);\n\tfree(conf->fstab);\n\tfree(conf->rcfile);\n\tfree(conf->init_cmd);\n\tfree(conf->unexpanded_config);\n\tfree(conf->pty_names);\n\tfree(conf->syslog);\n\tlxc_clear_config_network(conf);\n\tfree(conf->lsm_aa_profile);\n\tfree(conf->lsm_se_context);\n\tlxc_seccomp_free(conf);\n\tlxc_clear_config_caps(conf);\n\tlxc_clear_config_keepcaps(conf);\n\tlxc_clear_cgroups(conf, \"lxc.cgroup\");\n\tlxc_clear_hooks(conf, \"lxc.hook\");\n\tlxc_clear_mount_entries(conf);\n\tlxc_clear_saved_nics(conf);\n\tlxc_clear_idmaps(conf);\n\tlxc_clear_groups(conf);\n\tlxc_clear_includes(conf);\n\tlxc_clear_aliens(conf);\n\tlxc_clear_environment(conf);\n\tfree(conf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_execute",
          "args": [
            "my_args.name",
            "my_args.argv",
            "my_args.quiet",
            "conf",
            "my_args.lxcpath[0]",
            "false"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_execute",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/execute.c",
          "lines": "113-126",
          "snippet": "int lxc_execute(const char *name, char *const argv[], int quiet,\n\t\tstruct lxc_conf *conf, const char *lxcpath, bool backgrounded)\n{\n\tstruct execute_args args = {\n\t\t.argv = argv,\n\t\t.quiet = quiet\n\t};\n\n\tif (lxc_check_inherited(conf, false, -1))\n\t\treturn -1;\n\n\tconf->is_execute = 1;\n\treturn __lxc_start(name, conf, &execute_start_ops, &args, lxcpath, backgrounded);\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include \"start.h\"",
            "#include \"log.h\"",
            "#include \"conf.h\"",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct lxc_operations execute_start_ops = {\n\t.start = execute_start,\n\t.post_start = execute_post_start\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include \"start.h\"\n#include \"log.h\"\n#include \"conf.h\"\n#include <stdlib.h>\n#include <unistd.h>\n#include <errno.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nstatic struct lxc_operations execute_start_ops = {\n\t.start = execute_start,\n\t.post_start = execute_post_start\n};\n\nint lxc_execute(const char *name, char *const argv[], int quiet,\n\t\tstruct lxc_conf *conf, const char *lxcpath, bool backgrounded)\n{\n\tstruct execute_args args = {\n\t\t.argv = argv,\n\t\t.quiet = quiet\n\t};\n\n\tif (lxc_check_inherited(conf, false, -1))\n\t\treturn -1;\n\n\tconf->is_execute = 1;\n\treturn __lxc_start(name, conf, &execute_start_ops, &args, lxcpath, backgrounded);\n}"
        }
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "EXIT_FAILURE"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_config_define_load",
          "args": [
            "&defines",
            "conf"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_config_define_load",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2146-2163",
          "snippet": "int lxc_config_define_load(struct lxc_list *defines, struct lxc_conf *conf)\n{\n\tstruct lxc_list *it,*next;\n\tint ret = 0;\n\n\tlxc_list_for_each(it, defines) {\n\t\tret = lxc_config_readline(it->elem, conf);\n\t\tif (ret)\n\t\t\tbreak;\n\t}\n\n\tlxc_list_for_each_safe(it, defines, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it);\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\n\nint lxc_config_define_load(struct lxc_list *defines, struct lxc_conf *conf)\n{\n\tstruct lxc_list *it,*next;\n\tint ret = 0;\n\n\tlxc_list_for_each(it, defines) {\n\t\tret = lxc_config_readline(it->elem, conf);\n\t\tif (ret)\n\t\t\tbreak;\n\t}\n\n\tlxc_list_for_each_safe(it, defines, next) {\n\t\tlxc_list_del(it);\n\t\tfree(it);\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "EXIT_FAILURE"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"failed to read configuration file\""
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_config_read",
          "args": [
            "rcfile",
            "conf",
            "NULL"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_config_read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2115-2131",
          "snippet": "int lxc_config_read(const char *file, struct lxc_conf *conf, bool from_include)\n{\n\tstruct parse_line_conf c;\n\n\tc.conf = conf;\n\tc.from_include = from_include;\n\n\tif( access(file, R_OK) == -1 ) {\n\t\treturn -1;\n\t}\n\n\t/* Catch only the top level config file name in the structure */\n\tif(!conf->rcfile)\n\t\tconf->rcfile = strdup(file);\n\n\treturn lxc_file_for_each_line(file, parse_line, &c);\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int config_personality(const char *, const char *, struct lxc_conf *);",
            "static int config_pts(const char *, const char *, struct lxc_conf *);",
            "static int config_tty(const char *, const char *, struct lxc_conf *);",
            "static int config_ttydir(const char *, const char *, struct lxc_conf *);",
            "static int config_kmsg(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);",
            "static int config_lsm_se_context(const char *, const char *, struct lxc_conf *);",
            "static int config_cgroup(const char *, const char *, struct lxc_conf *);",
            "static int config_idmap(const char *, const char *, struct lxc_conf *);",
            "static int config_loglevel(const char *, const char *, struct lxc_conf *);",
            "static int config_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_mount_auto(const char *, const char *, struct lxc_conf *);",
            "static int config_fstab(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_mount(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_options(const char *, const char *, struct lxc_conf *);",
            "static int config_rootfs_backend(const char *, const char *, struct lxc_conf *);",
            "static int config_pivotdir(const char *, const char *, struct lxc_conf *);",
            "static int config_utsname(const char *, const char *, struct lxc_conf *);",
            "static int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);",
            "static int config_network(const char *, const char *, struct lxc_conf *);",
            "static int config_network_type(const char *, const char *, struct lxc_conf *);",
            "static int config_network_flags(const char *, const char *, struct lxc_conf *);",
            "static int config_network_link(const char *, const char *, struct lxc_conf *);",
            "static int config_network_name(const char *, const char *, struct lxc_conf *);",
            "static int config_network_veth_pair(const char *, const char *, struct lxc_conf *);",
            "static int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);",
            "static int config_network_hwaddr(const char *, const char *, struct lxc_conf *);",
            "static int config_network_vlan_id(const char *, const char *, struct lxc_conf *);",
            "static int config_network_mtu(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_up(const char *, const char *, struct lxc_conf *);",
            "static int config_network_script_down(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6(const char *, const char *, struct lxc_conf *);",
            "static int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_drop(const char *, const char *, struct lxc_conf *);",
            "static int config_cap_keep(const char *, const char *, struct lxc_conf *);",
            "static int config_console(const char *, const char *, struct lxc_conf *);",
            "static int config_console_logfile(const char *, const char *, struct lxc_conf *);",
            "static int config_seccomp(const char *, const char *, struct lxc_conf *);",
            "static int config_includefile(const char *, const char *, struct lxc_conf *);",
            "static int config_network_nic(const char *, const char *, struct lxc_conf *);",
            "static int config_autodev(const char *, const char *, struct lxc_conf *);",
            "static int config_haltsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_rebootsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_stopsignal(const char *, const char *, struct lxc_conf *);",
            "static int config_start(const char *, const char *, struct lxc_conf *);",
            "static int config_syslog(const char *, const char *, struct lxc_conf *);",
            "static int config_monitor(const char *, const char *, struct lxc_conf *);",
            "static int config_group(const char *, const char *, struct lxc_conf *);",
            "static int config_environment(const char *, const char *, struct lxc_conf *);",
            "static int config_init_cmd(const char *, const char *, struct lxc_conf *);",
            "static int config_init_uid(const char *, const char *, struct lxc_conf *);",
            "static int config_init_gid(const char *, const char *, struct lxc_conf *);",
            "static int config_ephemeral(const char *, const char *, struct lxc_conf *);",
            "static int config_no_new_privs(const char *, const char *, struct lxc_conf *);",
            "static struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int config_personality(const char *, const char *, struct lxc_conf *);\nstatic int config_pts(const char *, const char *, struct lxc_conf *);\nstatic int config_tty(const char *, const char *, struct lxc_conf *);\nstatic int config_ttydir(const char *, const char *, struct lxc_conf *);\nstatic int config_kmsg(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_profile(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_aa_incomplete(const char *, const char *, struct lxc_conf *);\nstatic int config_lsm_se_context(const char *, const char *, struct lxc_conf *);\nstatic int config_cgroup(const char *, const char *, struct lxc_conf *);\nstatic int config_idmap(const char *, const char *, struct lxc_conf *);\nstatic int config_loglevel(const char *, const char *, struct lxc_conf *);\nstatic int config_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_mount_auto(const char *, const char *, struct lxc_conf *);\nstatic int config_fstab(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_mount(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_options(const char *, const char *, struct lxc_conf *);\nstatic int config_rootfs_backend(const char *, const char *, struct lxc_conf *);\nstatic int config_pivotdir(const char *, const char *, struct lxc_conf *);\nstatic int config_utsname(const char *, const char *, struct lxc_conf *);\nstatic int config_hook(const char *, const char *, struct lxc_conf *lxc_conf);\nstatic int config_network(const char *, const char *, struct lxc_conf *);\nstatic int config_network_type(const char *, const char *, struct lxc_conf *);\nstatic int config_network_flags(const char *, const char *, struct lxc_conf *);\nstatic int config_network_link(const char *, const char *, struct lxc_conf *);\nstatic int config_network_name(const char *, const char *, struct lxc_conf *);\nstatic int config_network_veth_pair(const char *, const char *, struct lxc_conf *);\nstatic int config_network_macvlan_mode(const char *, const char *, struct lxc_conf *);\nstatic int config_network_hwaddr(const char *, const char *, struct lxc_conf *);\nstatic int config_network_vlan_id(const char *, const char *, struct lxc_conf *);\nstatic int config_network_mtu(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv4_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_up(const char *, const char *, struct lxc_conf *);\nstatic int config_network_script_down(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6(const char *, const char *, struct lxc_conf *);\nstatic int config_network_ipv6_gateway(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_drop(const char *, const char *, struct lxc_conf *);\nstatic int config_cap_keep(const char *, const char *, struct lxc_conf *);\nstatic int config_console(const char *, const char *, struct lxc_conf *);\nstatic int config_console_logfile(const char *, const char *, struct lxc_conf *);\nstatic int config_seccomp(const char *, const char *, struct lxc_conf *);\nstatic int config_includefile(const char *, const char *, struct lxc_conf *);\nstatic int config_network_nic(const char *, const char *, struct lxc_conf *);\nstatic int config_autodev(const char *, const char *, struct lxc_conf *);\nstatic int config_haltsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_rebootsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_stopsignal(const char *, const char *, struct lxc_conf *);\nstatic int config_start(const char *, const char *, struct lxc_conf *);\nstatic int config_syslog(const char *, const char *, struct lxc_conf *);\nstatic int config_monitor(const char *, const char *, struct lxc_conf *);\nstatic int config_group(const char *, const char *, struct lxc_conf *);\nstatic int config_environment(const char *, const char *, struct lxc_conf *);\nstatic int config_init_cmd(const char *, const char *, struct lxc_conf *);\nstatic int config_init_uid(const char *, const char *, struct lxc_conf *);\nstatic int config_init_gid(const char *, const char *, struct lxc_conf *);\nstatic int config_ephemeral(const char *, const char *, struct lxc_conf *);\nstatic int config_no_new_privs(const char *, const char *, struct lxc_conf *);\nstatic struct lxc_config_t config[] = {\n\n\t{ \"lxc.arch\",                 config_personality          },\n\t{ \"lxc.pts\",                  config_pts                  },\n\t{ \"lxc.tty\",                  config_tty                  },\n\t{ \"lxc.devttydir\",            config_ttydir               },\n\t{ \"lxc.kmsg\",                 config_kmsg                 },\n\t{ \"lxc.aa_profile\",           config_lsm_aa_profile       },\n\t{ \"lxc.aa_allow_incomplete\",  config_lsm_aa_incomplete    },\n\t{ \"lxc.se_context\",           config_lsm_se_context       },\n\t{ \"lxc.cgroup\",               config_cgroup               },\n\t{ \"lxc.id_map\",               config_idmap                },\n\t{ \"lxc.loglevel\",             config_loglevel             },\n\t{ \"lxc.logfile\",              config_logfile              },\n\t{ \"lxc.mount.entry\",          config_mount                },\n\t{ \"lxc.mount.auto\",           config_mount_auto           },\n\t{ \"lxc.mount\",                config_fstab                },\n\t{ \"lxc.rootfs.mount\",         config_rootfs_mount         },\n\t{ \"lxc.rootfs.options\",       config_rootfs_options       },\n\t{ \"lxc.rootfs.backend\",       config_rootfs_backend       },\n\t{ \"lxc.rootfs\",               config_rootfs               },\n\t{ \"lxc.pivotdir\",             config_pivotdir             },\n\t{ \"lxc.utsname\",              config_utsname              },\n\t{ \"lxc.hook.pre-start\",       config_hook                 },\n\t{ \"lxc.hook.pre-mount\",       config_hook                 },\n\t{ \"lxc.hook.mount\",           config_hook                 },\n\t{ \"lxc.hook.autodev\",         config_hook                 },\n\t{ \"lxc.hook.start\",           config_hook                 },\n\t{ \"lxc.hook.stop\",            config_hook                 },\n\t{ \"lxc.hook.post-stop\",       config_hook                 },\n\t{ \"lxc.hook.clone\",           config_hook                 },\n\t{ \"lxc.hook.destroy\",         config_hook                 },\n\t{ \"lxc.hook\",                 config_hook                 },\n\t{ \"lxc.network.type\",         config_network_type         },\n\t{ \"lxc.network.flags\",        config_network_flags        },\n\t{ \"lxc.network.link\",         config_network_link         },\n\t{ \"lxc.network.name\",         config_network_name         },\n\t{ \"lxc.network.macvlan.mode\", config_network_macvlan_mode },\n\t{ \"lxc.network.veth.pair\",    config_network_veth_pair    },\n\t{ \"lxc.network.script.up\",    config_network_script_up    },\n\t{ \"lxc.network.script.down\",  config_network_script_down  },\n\t{ \"lxc.network.hwaddr\",       config_network_hwaddr       },\n\t{ \"lxc.network.mtu\",          config_network_mtu          },\n\t{ \"lxc.network.vlan.id\",      config_network_vlan_id      },\n\t{ \"lxc.network.ipv4.gateway\", config_network_ipv4_gateway },\n\t{ \"lxc.network.ipv4\",         config_network_ipv4         },\n\t{ \"lxc.network.ipv6.gateway\", config_network_ipv6_gateway },\n\t{ \"lxc.network.ipv6\",         config_network_ipv6         },\n\t/* config_network_nic must come after all other 'lxc.network.*' entries */\n\t{ \"lxc.network.\",             config_network_nic          },\n\t{ \"lxc.network\",              config_network              },\n\t{ \"lxc.cap.drop\",             config_cap_drop             },\n\t{ \"lxc.cap.keep\",             config_cap_keep             },\n\t{ \"lxc.console.logfile\",      config_console_logfile      },\n\t{ \"lxc.console\",              config_console              },\n\t{ \"lxc.seccomp\",              config_seccomp              },\n\t{ \"lxc.include\",              config_includefile          },\n\t{ \"lxc.autodev\",              config_autodev              },\n\t{ \"lxc.haltsignal\",           config_haltsignal           },\n\t{ \"lxc.rebootsignal\",         config_rebootsignal         },\n\t{ \"lxc.stopsignal\",           config_stopsignal           },\n\t{ \"lxc.start.auto\",           config_start                },\n\t{ \"lxc.start.delay\",          config_start                },\n\t{ \"lxc.start.order\",          config_start                },\n\t{ \"lxc.monitor.unshare\",      config_monitor              },\n\t{ \"lxc.group\",                config_group                },\n\t{ \"lxc.environment\",          config_environment          },\n\t{ \"lxc.init_cmd\",             config_init_cmd             },\n\t{ \"lxc.init_uid\",             config_init_uid             },\n\t{ \"lxc.init_gid\",             config_init_gid             },\n\t{ \"lxc.ephemeral\",            config_ephemeral            },\n\t{ \"lxc.syslog\",               config_syslog               },\n\t{ \"lxc.no_new_privs\",\t      config_no_new_privs\t  },\n};\n\nint lxc_config_read(const char *file, struct lxc_conf *conf, bool from_include)\n{\n\tstruct parse_line_conf c;\n\n\tc.conf = conf;\n\tc.from_include = from_include;\n\n\tif( access(file, R_OK) == -1 ) {\n\t\treturn -1;\n\t}\n\n\t/* Catch only the top level config file name in the structure */\n\tif(!conf->rcfile)\n\t\tconf->rcfile = strdup(file);\n\n\treturn lxc_file_for_each_line(file, parse_line, &c);\n}"
        }
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "EXIT_FAILURE"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERROR",
          "args": [
            "\"failed to initialize configuration\""
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_conf_init",
          "args": [],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_conf_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/conf.c",
          "lines": "2520-2580",
          "snippet": "struct lxc_conf *lxc_conf_init(void)\n{\n\tstruct lxc_conf *new;\n\tint i;\n\n\tnew = \tmalloc(sizeof(*new));\n\tif (!new) {\n\t\tERROR(\"lxc_conf_init : %m\");\n\t\treturn NULL;\n\t}\n\tmemset(new, 0, sizeof(*new));\n\n\tnew->loglevel = LXC_LOG_PRIORITY_NOTSET;\n\tnew->personality = -1;\n\tnew->autodev = 1;\n\tnew->console.log_path = NULL;\n\tnew->console.log_fd = -1;\n\tnew->console.path = NULL;\n\tnew->console.peer = -1;\n\tnew->console.peerpty.busy = -1;\n\tnew->console.peerpty.master = -1;\n\tnew->console.peerpty.slave = -1;\n\tnew->console.master = -1;\n\tnew->console.slave = -1;\n\tnew->console.name[0] = '\\0';\n\tnew->maincmd_fd = -1;\n\tnew->nbd_idx = -1;\n\tnew->rootfs.mount = strdup(default_rootfs_mount);\n\tif (!new->rootfs.mount) {\n\t\tERROR(\"lxc_conf_init : %m\");\n\t\tfree(new);\n\t\treturn NULL;\n\t}\n\tnew->kmsg = 0;\n\tnew->logfd = -1;\n\tlxc_list_init(&new->cgroup);\n\tlxc_list_init(&new->network);\n\tlxc_list_init(&new->mount_list);\n\tlxc_list_init(&new->caps);\n\tlxc_list_init(&new->keepcaps);\n\tlxc_list_init(&new->id_map);\n\tlxc_list_init(&new->includes);\n\tlxc_list_init(&new->aliens);\n\tlxc_list_init(&new->environment);\n\tfor (i=0; i<NUM_LXC_HOOKS; i++)\n\t\tlxc_list_init(&new->hooks[i]);\n\tlxc_list_init(&new->groups);\n\tnew->lsm_aa_profile = NULL;\n\tnew->lsm_se_context = NULL;\n\tnew->tmp_umount_proc = 0;\n\n\tfor (i = 0; i < LXC_NS_MAX; i++)\n\t\tnew->inherit_ns_fd[i] = -1;\n\n\t/* if running in a new user namespace, init and COMMAND\n\t * default to running as UID/GID 0 when using lxc-execute */\n\tnew->init_uid = 0;\n\tnew->init_gid = 0;\n\n\treturn new;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <sys/personality.h>",
            "#include <sys/capability.h>",
            "#include \"lsm/lsm.h\"",
            "#include \"utils.h\"",
            "#include \"parse.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"lxcseccomp.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxcaufs.h\"",
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"caps.h\"       /* for lxc_caps_last_cap() */",
            "#include \"bdev.h\"",
            "#include \"af_unix.h\"",
            "#include <linux/memfd.h>",
            "#include <../include/openpty.h>",
            "#include <pty.h>",
            "#include <sys/statvfs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include <sys/wait.h>",
            "#include <sys/utsname.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <linux/loop.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "#include <libgen.h>",
            "#include <inttypes.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int in_caplist(int cap, struct lxc_list *caps);",
            "static char *default_rootfs_mount = LXCROOTFSMOUNT;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <sys/personality.h>\n#include <sys/capability.h>\n#include \"lsm/lsm.h\"\n#include \"utils.h\"\n#include \"parse.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"lxcseccomp.h\"\n#include \"lxcoverlay.h\"\n#include \"lxclock.h\"\n#include \"lxcaufs.h\"\n#include \"log.h\"\n#include \"error.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"caps.h\"       /* for lxc_caps_last_cap() */\n#include \"bdev.h\"\n#include \"af_unix.h\"\n#include <linux/memfd.h>\n#include <../include/openpty.h>\n#include <pty.h>\n#include <sys/statvfs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include <sys/wait.h>\n#include <sys/utsname.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <linux/loop.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n#include <libgen.h>\n#include <inttypes.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nstatic int in_caplist(int cap, struct lxc_list *caps);\nstatic char *default_rootfs_mount = LXCROOTFSMOUNT;\n\nstruct lxc_conf *lxc_conf_init(void)\n{\n\tstruct lxc_conf *new;\n\tint i;\n\n\tnew = \tmalloc(sizeof(*new));\n\tif (!new) {\n\t\tERROR(\"lxc_conf_init : %m\");\n\t\treturn NULL;\n\t}\n\tmemset(new, 0, sizeof(*new));\n\n\tnew->loglevel = LXC_LOG_PRIORITY_NOTSET;\n\tnew->personality = -1;\n\tnew->autodev = 1;\n\tnew->console.log_path = NULL;\n\tnew->console.log_fd = -1;\n\tnew->console.path = NULL;\n\tnew->console.peer = -1;\n\tnew->console.peerpty.busy = -1;\n\tnew->console.peerpty.master = -1;\n\tnew->console.peerpty.slave = -1;\n\tnew->console.master = -1;\n\tnew->console.slave = -1;\n\tnew->console.name[0] = '\\0';\n\tnew->maincmd_fd = -1;\n\tnew->nbd_idx = -1;\n\tnew->rootfs.mount = strdup(default_rootfs_mount);\n\tif (!new->rootfs.mount) {\n\t\tERROR(\"lxc_conf_init : %m\");\n\t\tfree(new);\n\t\treturn NULL;\n\t}\n\tnew->kmsg = 0;\n\tnew->logfd = -1;\n\tlxc_list_init(&new->cgroup);\n\tlxc_list_init(&new->network);\n\tlxc_list_init(&new->mount_list);\n\tlxc_list_init(&new->caps);\n\tlxc_list_init(&new->keepcaps);\n\tlxc_list_init(&new->id_map);\n\tlxc_list_init(&new->includes);\n\tlxc_list_init(&new->aliens);\n\tlxc_list_init(&new->environment);\n\tfor (i=0; i<NUM_LXC_HOOKS; i++)\n\t\tlxc_list_init(&new->hooks[i]);\n\tlxc_list_init(&new->groups);\n\tnew->lsm_aa_profile = NULL;\n\tnew->lsm_se_context = NULL;\n\tnew->tmp_umount_proc = 0;\n\n\tfor (i = 0; i < LXC_NS_MAX; i++)\n\t\tnew->inherit_ns_fd[i] = -1;\n\n\t/* if running in a new user namespace, init and COMMAND\n\t * default to running as UID/GID 0 when using lxc-execute */\n\tnew->init_uid = 0;\n\tnew->init_gid = 0;\n\n\treturn new;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "rcfile"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "free_mnts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/tools/lxc_copy.c",
          "lines": "539-554",
          "snippet": "static void free_mnts()\n{\n\tunsigned int i;\n\tstruct mnts *n = NULL;\n\n\tfor (i = 0, n = mnt_table; i < mnt_table_size; i++, n++) {\n\t\tfree(n->src);\n\t\tfree(n->dest);\n\t\tfree(n->options);\n\t\tfree(n->upper);\n\t\tfree(n->workdir);\n\t}\n\tfree(mnt_table);\n\tmnt_table = NULL;\n\tmnt_table_size = 0;\n}",
          "includes": [
            "#include <../include/getsubopt.h>",
            "#include \"utils.h\"",
            "#include \"state.h\"",
            "#include \"conf.h\"",
            "#include \"lxc.h\"",
            "#include \"arguments.h\"",
            "#include \"confile.h\"",
            "#include \"log.h\"",
            "#include \"bdev.h\"",
            "#include \"attach.h\"",
            "#include <lxc/lxccontainer.h>",
            "#include <stdbool.h>",
            "#include <time.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <stdlib.h>",
            "#include <sys/wait.h>",
            "#include <stdint.h>",
            "#include <sys/types.h>",
            "#include <stdio.h>",
            "#include <signal.h>",
            "#include <getopt.h>",
            "#include <unistd.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int mnt_table_size = 0;",
            "static struct mnts *mnt_table = NULL;",
            "static void free_mnts(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <../include/getsubopt.h>\n#include \"utils.h\"\n#include \"state.h\"\n#include \"conf.h\"\n#include \"lxc.h\"\n#include \"arguments.h\"\n#include \"confile.h\"\n#include \"log.h\"\n#include \"bdev.h\"\n#include \"attach.h\"\n#include <lxc/lxccontainer.h>\n#include <stdbool.h>\n#include <time.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <ctype.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <sys/wait.h>\n#include <stdint.h>\n#include <sys/types.h>\n#include <stdio.h>\n#include <signal.h>\n#include <getopt.h>\n#include <unistd.h>\n#include \"config.h\"\n\nstatic unsigned int mnt_table_size = 0;\nstatic struct mnts *mnt_table = NULL;\nstatic void free_mnts(void);\n\nstatic void free_mnts()\n{\n\tunsigned int i;\n\tstruct mnts *n = NULL;\n\n\tfor (i = 0, n = mnt_table; i < mnt_table_size; i++, n++) {\n\t\tfree(n->src);\n\t\tfree(n->dest);\n\t\tfree(n->options);\n\t\tfree(n->upper);\n\t\tfree(n->workdir);\n\t}\n\tfree(mnt_table);\n\tmnt_table = NULL;\n\tmnt_table_size = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "rcfile",
            "F_OK"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "EXIT_FAILURE"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SYSERROR",
          "args": [
            "\"failed to allocate memory\""
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asprintf",
          "args": [
            "&rcfile",
            "\"%s/%s/config\"",
            "my_args.lxcpath[0]",
            "my_args.name"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_log_options_no_override",
          "args": [],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_log_options_no_override",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/log.c",
          "lines": "685-689",
          "snippet": "extern void lxc_log_options_no_override()\n{\n\tlxc_quiet_specified = 1;\n\tlxc_loglevel_specified = 1;\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include \"caps.h\"",
            "#include \"log.h\"",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <stdio.h>",
            "#include <syslog.h>",
            "#include <time.h>",
            "#include <pthread.h>",
            "#include <string.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <limits.h>",
            "#include <inttypes.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int lxc_quiet_specified;",
            "static int lxc_loglevel_specified;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include \"caps.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <fcntl.h>\n#include <stdio.h>\n#include <syslog.h>\n#include <time.h>\n#include <pthread.h>\n#include <string.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <limits.h>\n#include <inttypes.h>\n#include <errno.h>\n#include <stdio.h>\n#include <stdint.h>\n\nint lxc_quiet_specified;\nstatic int lxc_loglevel_specified;\n\nextern void lxc_log_options_no_override()\n{\n\tlxc_quiet_specified = 1;\n\tlxc_loglevel_specified = 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "EXIT_FAILURE"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_log_init",
          "args": [
            "my_args.name",
            "my_args.log_file",
            "my_args.log_priority",
            "my_args.progname",
            "my_args.quiet",
            "my_args.lxcpath[0]"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_log_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/log.c",
          "lines": "546-615",
          "snippet": "extern int lxc_log_init(const char *name, const char *file,\n\t\t\tconst char *priority, const char *prefix, int quiet,\n\t\t\tconst char *lxcpath)\n{\n\tint lxc_priority = LXC_LOG_PRIORITY_ERROR;\n\tint ret;\n\n\tif (lxc_log_fd != -1) {\n\t\tWARN(\"lxc_log_init called with log already initialized\");\n\t\treturn 0;\n\t}\n\n\tif (priority)\n\t\tlxc_priority = lxc_log_priority_to_int(priority);\n\n\tif (!lxc_loglevel_specified) {\n\t\tlxc_log_category_lxc.priority = lxc_priority;\n\t\tlxc_loglevel_specified = 1;\n\t}\n\n\tif (!lxc_quiet_specified) {\n\t\tif (!quiet)\n\t\t\tlxc_log_category_lxc.appender->next = &log_appender_stderr;\n\t}\n\n\tif (prefix)\n\t\tlxc_log_set_prefix(prefix);\n\n\tif (name)\n\t\tlog_vmname = strdup(name);\n\n\tif (file) {\n\t\tif (strcmp(file, \"none\") == 0)\n\t\t\treturn 0;\n\t\tret = __lxc_log_set_file(file, 1);\n\t\tlxc_log_use_global_fd = 1;\n\t} else {\n\t\t/* if no name was specified, there nothing to do */\n\t\tif (!name)\n\t\t\treturn 0;\n\n\t\tret = -1;\n\n\t\tif (!lxcpath)\n\t\t\tlxcpath = LOGPATH;\n\n\t\t/* try LOGPATH if lxcpath is the default for the privileged containers */\n\t\tif (!geteuid() && strcmp(LXCPATH, lxcpath) == 0)\n\t\t\tret = _lxc_log_set_file(name, NULL, 0);\n\n\t\t/* try in lxcpath */\n\t\tif (ret < 0)\n\t\t\tret = _lxc_log_set_file(name, lxcpath, 1);\n\n\t\t/* try LOGPATH in case its writable by the caller */\n\t\tif (ret < 0)\n\t\t\tret = _lxc_log_set_file(name, NULL, 0);\n\t}\n\n\t/*\n\t * If !file, that is, if the user did not request this logpath, then\n\t * ignore failures and continue logging to console\n\t */\n\tif (!file && ret != 0) {\n\t\tINFO(\"Ignoring failure to open default logfile.\");\n\t\tret = 0;\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include \"utils.h\"",
            "#include \"caps.h\"",
            "#include \"log.h\"",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <stdio.h>",
            "#include <syslog.h>",
            "#include <time.h>",
            "#include <pthread.h>",
            "#include <string.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <limits.h>",
            "#include <inttypes.h>",
            "#include <errno.h>",
            "#include <stdio.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int lxc_log_fd = -1;",
            "int lxc_quiet_specified;",
            "int lxc_log_use_global_fd;",
            "static int lxc_loglevel_specified;",
            "static char *log_vmname = NULL;",
            "static struct lxc_log_appender log_appender_stderr = {\n\t.name\t\t= \"stderr\",\n\t.append\t\t= log_append_stderr,\n\t.next\t\t= NULL,\n};",
            "struct lxc_log_category lxc_log_category_lxc = {\n\t.name\t\t= \"lxc\",\n\t.priority\t= LXC_LOG_PRIORITY_ERROR,\n\t.appender\t= &log_appender_logfile,\n\t.parent\t\t= &log_root\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utils.h\"\n#include \"caps.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <fcntl.h>\n#include <stdio.h>\n#include <syslog.h>\n#include <time.h>\n#include <pthread.h>\n#include <string.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <limits.h>\n#include <inttypes.h>\n#include <errno.h>\n#include <stdio.h>\n#include <stdint.h>\n\nint lxc_log_fd = -1;\nint lxc_quiet_specified;\nint lxc_log_use_global_fd;\nstatic int lxc_loglevel_specified;\nstatic char *log_vmname = NULL;\nstatic struct lxc_log_appender log_appender_stderr = {\n\t.name\t\t= \"stderr\",\n\t.append\t\t= log_append_stderr,\n\t.next\t\t= NULL,\n};\nstruct lxc_log_category lxc_log_category_lxc = {\n\t.name\t\t= \"lxc\",\n\t.priority\t= LXC_LOG_PRIORITY_ERROR,\n\t.appender\t= &log_appender_logfile,\n\t.parent\t\t= &log_root\n};\n\nextern int lxc_log_init(const char *name, const char *file,\n\t\t\tconst char *priority, const char *prefix, int quiet,\n\t\t\tconst char *lxcpath)\n{\n\tint lxc_priority = LXC_LOG_PRIORITY_ERROR;\n\tint ret;\n\n\tif (lxc_log_fd != -1) {\n\t\tWARN(\"lxc_log_init called with log already initialized\");\n\t\treturn 0;\n\t}\n\n\tif (priority)\n\t\tlxc_priority = lxc_log_priority_to_int(priority);\n\n\tif (!lxc_loglevel_specified) {\n\t\tlxc_log_category_lxc.priority = lxc_priority;\n\t\tlxc_loglevel_specified = 1;\n\t}\n\n\tif (!lxc_quiet_specified) {\n\t\tif (!quiet)\n\t\t\tlxc_log_category_lxc.appender->next = &log_appender_stderr;\n\t}\n\n\tif (prefix)\n\t\tlxc_log_set_prefix(prefix);\n\n\tif (name)\n\t\tlog_vmname = strdup(name);\n\n\tif (file) {\n\t\tif (strcmp(file, \"none\") == 0)\n\t\t\treturn 0;\n\t\tret = __lxc_log_set_file(file, 1);\n\t\tlxc_log_use_global_fd = 1;\n\t} else {\n\t\t/* if no name was specified, there nothing to do */\n\t\tif (!name)\n\t\t\treturn 0;\n\n\t\tret = -1;\n\n\t\tif (!lxcpath)\n\t\t\tlxcpath = LOGPATH;\n\n\t\t/* try LOGPATH if lxcpath is the default for the privileged containers */\n\t\tif (!geteuid() && strcmp(LXCPATH, lxcpath) == 0)\n\t\t\tret = _lxc_log_set_file(name, NULL, 0);\n\n\t\t/* try in lxcpath */\n\t\tif (ret < 0)\n\t\t\tret = _lxc_log_set_file(name, lxcpath, 1);\n\n\t\t/* try LOGPATH in case its writable by the caller */\n\t\tif (ret < 0)\n\t\t\tret = _lxc_log_set_file(name, NULL, 0);\n\t}\n\n\t/*\n\t * If !file, that is, if the user did not request this logpath, then\n\t * ignore failures and continue logging to console\n\t */\n\tif (!file && ret != 0) {\n\t\tINFO(\"Ignoring failure to open default logfile.\");\n\t\tret = 0;\n\t}\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "EXIT_FAILURE"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_arguments_parse",
          "args": [
            "&my_args",
            "argc",
            "argv"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_arguments_parse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/arguments.c",
          "lines": "182-252",
          "snippet": "extern int lxc_arguments_parse(struct lxc_arguments *args,\n\t\t\t       int argc, char * const argv[])\n{\n\tchar shortopts[256];\n\tint  ret = 0;\n\n\tret = build_shortopts(args->options, shortopts, sizeof(shortopts));\n\tif (ret < 0) {\n\t\tlxc_error(args, \"build_shortopts() failed : %s\",\n\t\t\t  strerror(errno));\n\t\treturn ret;\n\t}\n\n\twhile (1)  {\n\t\tint c, index = 0;\n\n\t\tc = getopt_long(argc, argv, shortopts, args->options, &index);\n\t\tif (c == -1)\n\t\t\tbreak;\n\t\tswitch (c) {\n\t\tcase 'n': \targs->name = optarg; break;\n\t\tcase 'o':\targs->log_file = optarg; break;\n\t\tcase 'l':\targs->log_priority = optarg; break;\n\t\tcase 'q':\targs->quiet = 1; break;\n\t\tcase OPT_RCFILE: args->rcfile = optarg; break;\n\t\tcase 'P':\n\t\t\tremove_trailing_slashes(optarg);\n\t\t\tret = lxc_arguments_lxcpath_add(args, optarg);\n\t\t\tif (ret < 0)\n\t\t\t\treturn ret;\n\t\t\tbreak;\n\t\tcase OPT_USAGE: print_usage(args->options, args);\n\t\tcase OPT_VERSION: print_version();\n\t\tcase '?':\tprint_help(args, 1);\n\t\tcase 'h': \tprint_help(args, 0);\n\t\tdefault:\n\t\t\tif (args->parser) {\n\t\t\t\tret = args->parser(args, c, optarg);\n\t\t\t\tif (ret)\n\t\t\t\t\tgoto error;\n\t\t\t}\n\t\t}\n\t}\n\n\t/*\n\t * Reclaim the remaining command arguments\n\t */\n\targs->argv = &argv[optind];\n\targs->argc = argc - optind;\n\n\t/* If no lxcpaths were given, use default */\n\tif (!args->lxcpath_cnt) {\n\t\tret = lxc_arguments_lxcpath_add(args, lxc_global_config_value(\"lxc.lxcpath\"));\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t}\n\n\t/* Check the command options */\n\n\tif (!args->name && strcmp(args->progname, \"lxc-autostart\") != 0) {\n\t\tlxc_error(args, \"missing container name, use --name option\");\n\t\treturn -1;\n\t}\n\n\tif (args->checker)\n\t\tret = args->checker(args);\nerror:\n\tif (ret)\n\t\tlxc_error(args, \"could not parse command line\");\n\treturn ret;\n}",
          "includes": [
            "#include \"version.h\"",
            "#include \"utils.h\"",
            "#include \"arguments.h\"",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <ctype.h>\t\t/* for isprint() */",
            "#include <string.h>",
            "#include <limits.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"utils.h\"\n#include \"arguments.h\"\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <ctype.h>\t\t/* for isprint() */\n#include <string.h>\n#include <limits.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nextern int lxc_arguments_parse(struct lxc_arguments *args,\n\t\t\t       int argc, char * const argv[])\n{\n\tchar shortopts[256];\n\tint  ret = 0;\n\n\tret = build_shortopts(args->options, shortopts, sizeof(shortopts));\n\tif (ret < 0) {\n\t\tlxc_error(args, \"build_shortopts() failed : %s\",\n\t\t\t  strerror(errno));\n\t\treturn ret;\n\t}\n\n\twhile (1)  {\n\t\tint c, index = 0;\n\n\t\tc = getopt_long(argc, argv, shortopts, args->options, &index);\n\t\tif (c == -1)\n\t\t\tbreak;\n\t\tswitch (c) {\n\t\tcase 'n': \targs->name = optarg; break;\n\t\tcase 'o':\targs->log_file = optarg; break;\n\t\tcase 'l':\targs->log_priority = optarg; break;\n\t\tcase 'q':\targs->quiet = 1; break;\n\t\tcase OPT_RCFILE: args->rcfile = optarg; break;\n\t\tcase 'P':\n\t\t\tremove_trailing_slashes(optarg);\n\t\t\tret = lxc_arguments_lxcpath_add(args, optarg);\n\t\t\tif (ret < 0)\n\t\t\t\treturn ret;\n\t\t\tbreak;\n\t\tcase OPT_USAGE: print_usage(args->options, args);\n\t\tcase OPT_VERSION: print_version();\n\t\tcase '?':\tprint_help(args, 1);\n\t\tcase 'h': \tprint_help(args, 0);\n\t\tdefault:\n\t\t\tif (args->parser) {\n\t\t\t\tret = args->parser(args, c, optarg);\n\t\t\t\tif (ret)\n\t\t\t\t\tgoto error;\n\t\t\t}\n\t\t}\n\t}\n\n\t/*\n\t * Reclaim the remaining command arguments\n\t */\n\targs->argv = &argv[optind];\n\targs->argc = argc - optind;\n\n\t/* If no lxcpaths were given, use default */\n\tif (!args->lxcpath_cnt) {\n\t\tret = lxc_arguments_lxcpath_add(args, lxc_global_config_value(\"lxc.lxcpath\"));\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t}\n\n\t/* Check the command options */\n\n\tif (!args->name && strcmp(args->progname, \"lxc-autostart\") != 0) {\n\t\tlxc_error(args, \"missing container name, use --name option\");\n\t\treturn -1;\n\t}\n\n\tif (args->checker)\n\t\tret = args->checker(args);\nerror:\n\tif (ret)\n\t\tlxc_error(args, \"could not parse command line\");\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "EXIT_FAILURE"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_caps_init",
          "args": [],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_caps_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/caps.h",
          "lines": "47-49",
          "snippet": "static inline int lxc_caps_init(void) {\n\treturn 0;\n}",
          "includes": [
            "#include <sys/capability.h>",
            "#include <stdbool.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/capability.h>\n#include <stdbool.h>\n#include \"config.h\"\n\nstatic inline int lxc_caps_init(void) {\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_list_init",
          "args": [
            "&defines"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_list_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/list.h",
          "lines": "68-72",
          "snippet": "static inline void lxc_list_init(struct lxc_list *list)\n{\n\tlist->elem = NULL;\n\tlist->next = list->prev = list;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void lxc_list_init(struct lxc_list *list)\n{\n\tlist->elem = NULL;\n\tlist->next = list->prev = list;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include \"start.h\"\n#include \"config.h\"\n#include \"arguments.h\"\n#include \"confile.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"lxc.h\"\n#include \"caps.h\"\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <string.h>\n#include <libgen.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct lxc_list defines;\nstatic struct lxc_arguments my_args = {\n\t.progname = \"lxc-execute\",\n\t.help     = \"\\\n--name=NAME -- COMMAND\\n\\\n\\n\\\nlxc-execute creates a container with the identifier NAME\\n\\\nand execs COMMAND into this container.\\n\\\n\\n\\\nOptions :\\n\\\n  -n, --name=NAME      NAME of the container\\n\\\n  -f, --rcfile=FILE    Load configuration file FILE\\n\\\n  -s, --define KEY=VAL Assign VAL to configuration variable KEY\\n\\\n  -u, --uid=UID        Execute COMMAND with UID inside the container\\n\\\n  -g, --gid=GID        Execute COMMAND with GID inside the container\\n\",\n\t.options  = my_longopts,\n\t.parser   = my_parser,\n\t.checker  = my_checker,\n};\n\nint main(int argc, char *argv[])\n{\n\tchar *rcfile;\n\tstruct lxc_conf *conf;\n\tint ret;\n\n\tlxc_list_init(&defines);\n\n\tif (lxc_caps_init())\n\t\texit(EXIT_FAILURE);\n\n\tif (lxc_arguments_parse(&my_args, argc, argv))\n\t\texit(EXIT_FAILURE);\n\n\tif (lxc_log_init(my_args.name, my_args.log_file, my_args.log_priority,\n\t\t\t my_args.progname, my_args.quiet, my_args.lxcpath[0]))\n\t\texit(EXIT_FAILURE);\n\tlxc_log_options_no_override();\n\n\t/* rcfile is specified in the cli option */\n\tif (my_args.rcfile)\n\t\trcfile = (char *)my_args.rcfile;\n\telse {\n\t\tint rc;\n\n\t\trc = asprintf(&rcfile, \"%s/%s/config\", my_args.lxcpath[0], my_args.name);\n\t\tif (rc == -1) {\n\t\t\tSYSERROR(\"failed to allocate memory\");\n\t\t\texit(EXIT_FAILURE);\n\t\t}\n\n\t\t/* container configuration does not exist */\n\t\tif (access(rcfile, F_OK)) {\n\t\t\tfree(rcfile);\n\t\t\trcfile = NULL;\n\t\t}\n\t}\n\n\tconf = lxc_conf_init();\n\tif (!conf) {\n\t\tERROR(\"failed to initialize configuration\");\n\t\texit(EXIT_FAILURE);\n\t}\n\n\tif (rcfile && lxc_config_read(rcfile, conf, NULL)) {\n\t\tERROR(\"failed to read configuration file\");\n\t\texit(EXIT_FAILURE);\n\t}\n\n\tif (lxc_config_define_load(&defines, conf))\n\t\texit(EXIT_FAILURE);\n\n\tif (my_args.uid)\n\t\tconf->init_uid = my_args.uid;\n\n\tif (my_args.gid)\n\t\tconf->init_gid = my_args.gid;\n\n\tret = lxc_execute(my_args.name, my_args.argv, my_args.quiet, conf, my_args.lxcpath[0], false);\n\n\tlxc_conf_free(conf);\n\n\tif (ret < 0)\n\t\texit(EXIT_FAILURE);\n\texit(EXIT_SUCCESS);\n}"
  },
  {
    "function_name": "my_parser",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/tools/lxc_execute.c",
    "lines": "58-76",
    "snippet": "static int my_parser(struct lxc_arguments* args, int c, char* arg)\n{\n\tswitch (c) {\n\tcase 'f':\n\t\targs->rcfile = arg;\n\t\tbreak;\n\tcase 's':\n\t\treturn lxc_config_define_add(&defines, arg);\n\t\tbreak;\n\tcase 'u':\n\t\tif (lxc_safe_uint(arg, &args->uid) < 0)\n\t\t\treturn -1;\n\t\tbreak;\n\tcase 'g':\n\t\tif (lxc_safe_uint(arg, &args->gid) < 0)\n\t\t\treturn -1;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include \"start.h\"",
      "#include \"config.h\"",
      "#include \"arguments.h\"",
      "#include \"confile.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"lxc.h\"",
      "#include \"caps.h\"",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <libgen.h>",
      "#include <errno.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct lxc_list defines;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_safe_uint",
          "args": [
            "arg",
            "&args->gid"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_safe_uint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.c",
          "lines": "1985-2003",
          "snippet": "int lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}",
          "includes": [
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include \"utils.h\"",
            "#include \"namespace.h\"",
            "#include \"lxclock.h\"",
            "#include \"log.h\"",
            "#include <sys/wait.h>",
            "#include <sys/vfs.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/prctl.h>",
            "#include <sys/param.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stddef.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include \"utils.h\"\n#include \"namespace.h\"\n#include \"lxclock.h\"\n#include \"log.h\"\n#include <sys/wait.h>\n#include <sys/vfs.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/prctl.h>\n#include <sys/param.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include \"config.h\"\n\nint lxc_safe_uint(const char *numstr, unsigned int *converted)\n{\n\tchar *err = NULL;\n\tunsigned long int uli;\n\n\terrno = 0;\n\tuli = strtoul(numstr, &err, 0);\n\tif (errno > 0)\n\t\treturn -errno;\n\n\tif (!err || err == numstr || *err != '\\0')\n\t\treturn -EINVAL;\n\n\tif (uli > UINT_MAX)\n\t\treturn -ERANGE;\n\n\t*converted = (unsigned int)uli;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxc_config_define_add",
          "args": [
            "&defines",
            "arg"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_config_define_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/confile.c",
          "lines": "2133-2144",
          "snippet": "int lxc_config_define_add(struct lxc_list *defines, char* arg)\n{\n\tstruct lxc_list *dent;\n\n\tdent = malloc(sizeof(struct lxc_list));\n\tif (!dent)\n\t\treturn -1;\n\n\tdent->elem = arg;\n\tlxc_list_add_tail(defines, dent);\n\treturn 0;\n}",
          "includes": [
            "#include <sys/personality.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#include \"lxcseccomp.h\"",
            "#include \"network.h\"",
            "#include \"conf.h\"",
            "#include \"log.h\"",
            "#include \"utils.h\"",
            "#include \"confile.h\"",
            "#include \"config.h\"",
            "#include \"parse.h\"",
            "#include \"bdev.h\"",
            "#include <syslog.h>",
            "#include <dirent.h>",
            "#include <time.h>",
            "#include <net/if.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <sys/utsname.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <ctype.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/personality.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#include \"lxcseccomp.h\"\n#include \"network.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"utils.h\"\n#include \"confile.h\"\n#include \"config.h\"\n#include \"parse.h\"\n#include \"bdev.h\"\n#include <syslog.h>\n#include <dirent.h>\n#include <time.h>\n#include <net/if.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/utsname.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <signal.h>\n#include <ctype.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nint lxc_config_define_add(struct lxc_list *defines, char* arg)\n{\n\tstruct lxc_list *dent;\n\n\tdent = malloc(sizeof(struct lxc_list));\n\tif (!dent)\n\t\treturn -1;\n\n\tdent->elem = arg;\n\tlxc_list_add_tail(defines, dent);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include \"start.h\"\n#include \"config.h\"\n#include \"arguments.h\"\n#include \"confile.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"lxc.h\"\n#include \"caps.h\"\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <string.h>\n#include <libgen.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct lxc_list defines;\n\nstatic int my_parser(struct lxc_arguments* args, int c, char* arg)\n{\n\tswitch (c) {\n\tcase 'f':\n\t\targs->rcfile = arg;\n\t\tbreak;\n\tcase 's':\n\t\treturn lxc_config_define_add(&defines, arg);\n\t\tbreak;\n\tcase 'u':\n\t\tif (lxc_safe_uint(arg, &args->uid) < 0)\n\t\t\treturn -1;\n\t\tbreak;\n\tcase 'g':\n\t\tif (lxc_safe_uint(arg, &args->gid) < 0)\n\t\t\treturn -1;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "my_checker",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/tools/lxc_execute.c",
    "lines": "48-56",
    "snippet": "static int my_checker(const struct lxc_arguments* args)\n{\n\tif (!args->argc) {\n\t\tlxc_error(args, \"missing command to execute !\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"utils.h\"",
      "#include \"start.h\"",
      "#include \"config.h\"",
      "#include \"arguments.h\"",
      "#include \"confile.h\"",
      "#include \"conf.h\"",
      "#include \"log.h\"",
      "#include \"lxc.h\"",
      "#include \"caps.h\"",
      "#include <sys/param.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <libgen.h>",
      "#include <errno.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_error",
          "args": [
            "args",
            "\"missing command to execute !\""
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_error_set_and_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/error.c",
          "lines": "42-58",
          "snippet": "extern int  lxc_error_set_and_log(int pid, int status)\n{\n\tint ret = 0;\n\n\tif (WIFEXITED(status)) {\n\t\tret = WEXITSTATUS(status);\n\t\tif (ret)\n\t\t\tINFO(\"Child <%d> ended on error (%d).\", pid, ret);\n\t}\n\n\tif (WIFSIGNALED(status)) {\n\t\tint signal = WTERMSIG(status);\n\t\tINFO(\"Child <%d> ended on signal (%d).\", pid, signal);\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"error.h\"",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"error.h\"\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nextern int  lxc_error_set_and_log(int pid, int status)\n{\n\tint ret = 0;\n\n\tif (WIFEXITED(status)) {\n\t\tret = WEXITSTATUS(status);\n\t\tif (ret)\n\t\t\tINFO(\"Child <%d> ended on error (%d).\", pid, ret);\n\t}\n\n\tif (WIFSIGNALED(status)) {\n\t\tint signal = WTERMSIG(status);\n\t\tINFO(\"Child <%d> ended on signal (%d).\", pid, signal);\n\t}\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"utils.h\"\n#include \"start.h\"\n#include \"config.h\"\n#include \"arguments.h\"\n#include \"confile.h\"\n#include \"conf.h\"\n#include \"log.h\"\n#include \"lxc.h\"\n#include \"caps.h\"\n#include <sys/param.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <string.h>\n#include <libgen.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int my_checker(const struct lxc_arguments* args)\n{\n\tif (!args->argc) {\n\t\tlxc_error(args, \"missing command to execute !\");\n\t\treturn -1;\n\t}\n\n\treturn 0;\n}"
  }
]