[
  {
    "function_name": "luaopen_lxc_core",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "591-614",
    "snippet": "LUALIB_API int luaopen_lxc_core(lua_State *L) {\n    /* this is where we would initialize liblxc.so if we needed to */\n\n    luaL_newlib(L, lxc_lib_methods);\n\n    lua_newuserdata(L, 0);\n    lua_newtable(L);  /* metatable */\n    lua_pushvalue(L, -1);\n    lua_pushliteral(L, \"__gc\");\n    lua_pushcfunction(L, lxc_lib_uninit);\n    lua_rawset(L, -3);\n    lua_setmetatable(L, -3);\n    lua_rawset(L, -3);\n\n    luaL_newmetatable(L, CONTAINER_TYPENAME);\n    luaL_setfuncs(L, lxc_container_methods, 0);\n    lua_pushvalue(L, -1);  /* push metatable */\n    lua_pushstring(L, \"__gc\");\n    lua_pushcfunction(L, container_gc);\n    lua_settable(L, -3);\n    lua_setfield(L, -2, \"__index\");  /* metatable.__index = metatable */\n    lua_pop(L, 1);\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [
      "static luaL_Reg lxc_container_methods[] =\n{\n    {\"attach\",                  container_attach},\n    {\"create\",\t\t\tcontainer_create},\n    {\"defined\",\t\t\tcontainer_defined},\n    {\"destroy\",\t\t\tcontainer_destroy},\n    {\"init_pid\",\t\tcontainer_init_pid},\n    {\"name\",\t\t\tcontainer_name},\n    {\"running\",\t\t\tcontainer_running},\n    {\"state\",\t\t\tcontainer_state},\n    {\"freeze\",\t\t\tcontainer_freeze},\n    {\"unfreeze\",\t\tcontainer_unfreeze},\n    {\"start\",\t\t\tcontainer_start},\n    {\"stop\",\t\t\tcontainer_stop},\n    {\"shutdown\",\t\tcontainer_shutdown},\n    {\"wait\",\t\t\tcontainer_wait},\n    {\"rename\",\t\t\tcontainer_rename},\n\n    {\"config_file_name\",\tcontainer_config_file_name},\n    {\"load_config\",\t\tcontainer_load_config},\n    {\"save_config\",\t\tcontainer_save_config},\n    {\"get_cgroup_item\",\t\tcontainer_get_cgroup_item},\n    {\"set_cgroup_item\",\t\tcontainer_set_cgroup_item},\n    {\"get_config_path\",\t\tcontainer_get_config_path},\n    {\"set_config_path\",\t\tcontainer_set_config_path},\n    {\"get_config_item\",\t\tcontainer_get_config_item},\n    {\"set_config_item\",\t\tcontainer_set_config_item},\n    {\"clear_config_item\",\tcontainer_clear_config_item},\n    {\"get_keys\",\t\tcontainer_get_keys},\n    {\"get_interfaces\",\t\tcontainer_get_interfaces},\n    {\"get_ips\",\t\t\tcontainer_get_ips},\n    {NULL, NULL}\n};",
      "static luaL_Reg lxc_lib_methods[] = {\n    {\"version_get\",\t\tlxc_version_get},\n    {\"default_config_path_get\",\tlxc_default_config_path_get},\n    {\"cmd_get_config_item\",\tcmd_get_config_item},\n    {\"container_new\",\t\tcontainer_new},\n    {\"usleep\",\t\t\tlxc_util_usleep},\n    {\"dirname\",\t\t\tlxc_util_dirname},\n    {NULL, NULL}\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pop",
          "args": [
            "L",
            "1"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_setfield",
          "args": [
            "L",
            "-2",
            "\"__index\""
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_settable",
          "args": [
            "L",
            "-3"
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_pushcfunction",
          "args": [
            "L",
            "container_gc"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_pushstring",
          "args": [
            "L",
            "\"__gc\""
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_pushvalue",
          "args": [
            "L",
            "-1"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_setfuncs",
          "args": [
            "L",
            "lxc_container_methods",
            "0"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_newmetatable",
          "args": [
            "L",
            "CONTAINER_TYPENAME"
          ],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_rawset",
          "args": [
            "L",
            "-3"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_setmetatable",
          "args": [
            "L",
            "-3"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_rawset",
          "args": [
            "L",
            "-3"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_pushcfunction",
          "args": [
            "L",
            "lxc_lib_uninit"
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_pushliteral",
          "args": [
            "L",
            "\"__gc\""
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_pushvalue",
          "args": [
            "L",
            "-1"
          ],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_newtable",
          "args": [
            "L"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_newuserdata",
          "args": [
            "L",
            "0"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_newlib",
          "args": [
            "L",
            "lxc_lib_methods"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic luaL_Reg lxc_container_methods[] =\n{\n    {\"attach\",                  container_attach},\n    {\"create\",\t\t\tcontainer_create},\n    {\"defined\",\t\t\tcontainer_defined},\n    {\"destroy\",\t\t\tcontainer_destroy},\n    {\"init_pid\",\t\tcontainer_init_pid},\n    {\"name\",\t\t\tcontainer_name},\n    {\"running\",\t\t\tcontainer_running},\n    {\"state\",\t\t\tcontainer_state},\n    {\"freeze\",\t\t\tcontainer_freeze},\n    {\"unfreeze\",\t\tcontainer_unfreeze},\n    {\"start\",\t\t\tcontainer_start},\n    {\"stop\",\t\t\tcontainer_stop},\n    {\"shutdown\",\t\tcontainer_shutdown},\n    {\"wait\",\t\t\tcontainer_wait},\n    {\"rename\",\t\t\tcontainer_rename},\n\n    {\"config_file_name\",\tcontainer_config_file_name},\n    {\"load_config\",\t\tcontainer_load_config},\n    {\"save_config\",\t\tcontainer_save_config},\n    {\"get_cgroup_item\",\t\tcontainer_get_cgroup_item},\n    {\"set_cgroup_item\",\t\tcontainer_set_cgroup_item},\n    {\"get_config_path\",\t\tcontainer_get_config_path},\n    {\"set_config_path\",\t\tcontainer_set_config_path},\n    {\"get_config_item\",\t\tcontainer_get_config_item},\n    {\"set_config_item\",\t\tcontainer_set_config_item},\n    {\"clear_config_item\",\tcontainer_clear_config_item},\n    {\"get_keys\",\t\tcontainer_get_keys},\n    {\"get_interfaces\",\t\tcontainer_get_interfaces},\n    {\"get_ips\",\t\t\tcontainer_get_ips},\n    {NULL, NULL}\n};\nstatic luaL_Reg lxc_lib_methods[] = {\n    {\"version_get\",\t\tlxc_version_get},\n    {\"default_config_path_get\",\tlxc_default_config_path_get},\n    {\"cmd_get_config_item\",\tcmd_get_config_item},\n    {\"container_new\",\t\tcontainer_new},\n    {\"usleep\",\t\t\tlxc_util_usleep},\n    {\"dirname\",\t\t\tlxc_util_dirname},\n    {NULL, NULL}\n};\n\nLUALIB_API int luaopen_lxc_core(lua_State *L) {\n    /* this is where we would initialize liblxc.so if we needed to */\n\n    luaL_newlib(L, lxc_lib_methods);\n\n    lua_newuserdata(L, 0);\n    lua_newtable(L);  /* metatable */\n    lua_pushvalue(L, -1);\n    lua_pushliteral(L, \"__gc\");\n    lua_pushcfunction(L, lxc_lib_uninit);\n    lua_rawset(L, -3);\n    lua_setmetatable(L, -3);\n    lua_rawset(L, -3);\n\n    luaL_newmetatable(L, CONTAINER_TYPENAME);\n    luaL_setfuncs(L, lxc_container_methods, 0);\n    lua_pushvalue(L, -1);  /* push metatable */\n    lua_pushstring(L, \"__gc\");\n    lua_pushcfunction(L, container_gc);\n    lua_settable(L, -3);\n    lua_setfield(L, -2, \"__index\");  /* metatable.__index = metatable */\n    lua_pop(L, 1);\n    return 1;\n}"
  },
  {
    "function_name": "lxc_lib_uninit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "585-589",
    "snippet": "static int lxc_lib_uninit(lua_State *L) {\n    (void) L;\n    /* this is where we would fini liblxc.so if we needed to */\n    return 0;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\nstatic int lxc_lib_uninit(lua_State *L) {\n    (void) L;\n    /* this is where we would fini liblxc.so if we needed to */\n    return 0;\n}"
  },
  {
    "function_name": "lxc_util_dirname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "569-573",
    "snippet": "static int lxc_util_dirname(lua_State *L) {\n    char *path = strdupa(luaL_checkstring(L, 1));\n    lua_pushstring(L, dirname(path));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushstring",
          "args": [
            "L",
            "dirname(path)"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirname",
          "args": [
            "path"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_util_dirname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
          "lines": "569-573",
          "snippet": "static int lxc_util_dirname(lua_State *L) {\n    char *path = strdupa(luaL_checkstring(L, 1));\n    lua_pushstring(L, dirname(path));\n    return 1;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "strdupa",
          "args": [
            "luaL_checkstring(L, 1)"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "1"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\nstatic int lxc_util_dirname(lua_State *L) {\n    char *path = strdupa(luaL_checkstring(L, 1));\n    lua_pushstring(L, dirname(path));\n    return 1;\n}"
  },
  {
    "function_name": "lxc_util_usleep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "564-567",
    "snippet": "static int lxc_util_usleep(lua_State *L) {\n    usleep((useconds_t)luaL_checkunsigned(L, 1));\n    return 0;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "usleep",
          "args": [
            "(useconds_t)luaL_checkunsigned(L, 1)"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_util_usleep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
          "lines": "564-567",
          "snippet": "static int lxc_util_usleep(lua_State *L) {\n    usleep((useconds_t)luaL_checkunsigned(L, 1));\n    return 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "luaL_checkunsigned",
          "args": [
            "L",
            "1"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\nstatic int lxc_util_usleep(lua_State *L) {\n    usleep((useconds_t)luaL_checkunsigned(L, 1));\n    return 0;\n}"
  },
  {
    "function_name": "cmd_get_config_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "540-561",
    "snippet": "static int cmd_get_config_item(lua_State *L)\n{\n    int arg_cnt = lua_gettop(L);\n    const char *name = luaL_checkstring(L, 1);\n    const char *key = luaL_checkstring(L, 2);\n    const char *lxcpath = NULL;\n    char *value;\n\n    if (arg_cnt > 2)\n\tlxcpath = luaL_checkstring(L, 3);\n\n    value = lxc_cmd_get_config_item(name, key, lxcpath);\n    if (!value)\n\tgoto not_found;\n\n    lua_pushstring(L, value);\n    return 1;\n\nnot_found:\n    lua_pushnil(L);\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushnil",
          "args": [
            "L"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_pushstring",
          "args": [
            "L",
            "value"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_cmd_get_config_item",
          "args": [
            "name",
            "key",
            "lxcpath"
          ],
          "line": 551
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_cmd_get_config_item_callback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/commands.c",
          "lines": "523-548",
          "snippet": "static int lxc_cmd_get_config_item_callback(int fd, struct lxc_cmd_req *req,\n\t\t\t\t\t    struct lxc_handler *handler)\n{\n\tint cilen;\n\tstruct lxc_cmd_rsp rsp;\n\tchar *cidata;\n\n\tmemset(&rsp, 0, sizeof(rsp));\n\tcilen = lxc_get_config_item(handler->conf, req->data, NULL, 0);\n\tif (cilen <= 0)\n\t\tgoto err1;\n\n\tcidata = alloca(cilen + 1);\n\tif (lxc_get_config_item(handler->conf, req->data, cidata, cilen + 1) != cilen)\n\t\tgoto err1;\n\tcidata[cilen] = '\\0';\n\trsp.data = cidata;\n\trsp.datalen = cilen + 1;\n\trsp.ret = 0;\n\tgoto out;\n\nerr1:\n\trsp.ret = -1;\nout:\n\treturn lxc_cmd_rsp_send(fd, &rsp);\n}",
          "includes": [
            "#include \"config.h\"",
            "#include \"af_unix.h\"",
            "#include \"mainloop.h\"",
            "#include \"confile.h\"",
            "#include \"console.h\"",
            "#include \"commands.h\"",
            "#include \"cgroup.h\"",
            "#include \"utils.h\"",
            "#include \"start.h\"\t/* for struct lxc_handler */",
            "#include \"conf.h\"",
            "#include \"lxc.h\"",
            "#include \"log.h\"",
            "#include <stdlib.h>",
            "#include <malloc.h>",
            "#include <sys/param.h>",
            "#include <sys/un.h>",
            "#include <inttypes.h>",
            "#include <sys/socket.h>",
            "#include <poll.h>",
            "#include <fcntl.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <errno.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include \"af_unix.h\"\n#include \"mainloop.h\"\n#include \"confile.h\"\n#include \"console.h\"\n#include \"commands.h\"\n#include \"cgroup.h\"\n#include \"utils.h\"\n#include \"start.h\"\t/* for struct lxc_handler */\n#include \"conf.h\"\n#include \"lxc.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <malloc.h>\n#include <sys/param.h>\n#include <sys/un.h>\n#include <inttypes.h>\n#include <sys/socket.h>\n#include <poll.h>\n#include <fcntl.h>\n#include <signal.h>\n#include <unistd.h>\n#include <errno.h>\n#include <stdio.h>\n\nstatic int lxc_cmd_get_config_item_callback(int fd, struct lxc_cmd_req *req,\n\t\t\t\t\t    struct lxc_handler *handler)\n{\n\tint cilen;\n\tstruct lxc_cmd_rsp rsp;\n\tchar *cidata;\n\n\tmemset(&rsp, 0, sizeof(rsp));\n\tcilen = lxc_get_config_item(handler->conf, req->data, NULL, 0);\n\tif (cilen <= 0)\n\t\tgoto err1;\n\n\tcidata = alloca(cilen + 1);\n\tif (lxc_get_config_item(handler->conf, req->data, cidata, cilen + 1) != cilen)\n\t\tgoto err1;\n\tcidata[cilen] = '\\0';\n\trsp.data = cidata;\n\trsp.datalen = cilen + 1;\n\trsp.ret = 0;\n\tgoto out;\n\nerr1:\n\trsp.ret = -1;\nout:\n\treturn lxc_cmd_rsp_send(fd, &rsp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "3"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "2"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "1"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_gettop",
          "args": [
            "L"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\nstatic int cmd_get_config_item(lua_State *L)\n{\n    int arg_cnt = lua_gettop(L);\n    const char *name = luaL_checkstring(L, 1);\n    const char *key = luaL_checkstring(L, 2);\n    const char *lxcpath = NULL;\n    char *value;\n\n    if (arg_cnt > 2)\n\tlxcpath = luaL_checkstring(L, 3);\n\n    value = lxc_cmd_get_config_item(name, key, lxcpath);\n    if (!value)\n\tgoto not_found;\n\n    lua_pushstring(L, value);\n    return 1;\n\nnot_found:\n    lua_pushnil(L);\n    return 1;\n}"
  },
  {
    "function_name": "lxc_default_config_path_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "533-538",
    "snippet": "static int lxc_default_config_path_get(lua_State *L) {\n    const char *lxcpath = lxc_get_global_config_item(\"lxc.lxcpath\");\n\n    lua_pushstring(L, lxcpath);\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushstring",
          "args": [
            "L",
            "lxcpath"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_get_global_config_item",
          "args": [
            "\"lxc.lxcpath\""
          ],
          "line": 534
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_get_global_config_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/lxccontainer.c",
          "lines": "2618-2621",
          "snippet": "const char *lxc_get_global_config_item(const char *key)\n{\n\treturn lxc_global_config_value(key);\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include \"version.h\"",
            "#include \"utils.h\"",
            "#include \"state.h\"",
            "#include \"sync.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"monitor.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxccontainer.h\"",
            "#include \"lxc.h\"",
            "#include \"log.h\"",
            "#include \"criu.h\"",
            "#include \"console.h\"",
            "#include \"confile.h\"",
            "#include \"commands.h\"",
            "#include \"config.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"lxcbtrfs.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"bdev.h\"",
            "#include \"attach.h\"",
            "#include <sys/wait.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include \"version.h\"\n#include \"utils.h\"\n#include \"state.h\"\n#include \"sync.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"monitor.h\"\n#include \"lxclock.h\"\n#include \"lxccontainer.h\"\n#include \"lxc.h\"\n#include \"log.h\"\n#include \"criu.h\"\n#include \"console.h\"\n#include \"confile.h\"\n#include \"commands.h\"\n#include \"config.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"lxcbtrfs.h\"\n#include \"lxcoverlay.h\"\n#include \"bdev.h\"\n#include \"attach.h\"\n#include <sys/wait.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <sched.h>\n#include <pthread.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n\nconst char *lxc_get_global_config_item(const char *key)\n{\n\treturn lxc_global_config_value(key);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\nstatic int lxc_default_config_path_get(lua_State *L) {\n    const char *lxcpath = lxc_get_global_config_item(\"lxc.lxcpath\");\n\n    lua_pushstring(L, lxcpath);\n    return 1;\n}"
  },
  {
    "function_name": "lxc_version_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "528-531",
    "snippet": "static int lxc_version_get(lua_State *L) {\n    lua_pushstring(L, VERSION);\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushstring",
          "args": [
            "L",
            "VERSION"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\nstatic int lxc_version_get(lua_State *L) {\n    lua_pushstring(L, VERSION);\n    return 1;\n}"
  },
  {
    "function_name": "container_get_ips",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "456-492",
    "snippet": "static int container_get_ips(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    int argc = lua_gettop(L);\n    char **addresses;\n    char *iface = NULL, *family = NULL;\n    int i, scope = 0;\n\n    if (argc > 1)\n\tiface = (char *)luaL_checkstring(L, 2);\n    if (argc > 2)\n\tfamily = (char *)luaL_checkstring(L, 3);\n    if (argc > 3)\n\tscope = luaL_checkinteger(L, 4);\n\n    addresses = c->get_ips(c, iface, family, scope);\n\n    if (!addresses){\n\tlua_pushnil(L);\n\treturn 1;\n    }\n\n    for (i = 0; addresses[i]; i++);\n\n    /* protect LUA stack form overflow */\n    if (i > MAXVARS || !lua_checkstack(L, i)){\n        for (i = 0; addresses[i]; i++)\n\t    free(addresses[i]);\n\tlua_pushnil(L);\n\treturn 1;\n    }\n    for (i = 0; addresses[i]; i++){\n\tlua_pushstring(L, addresses[i]);\n\tfree(addresses[i]);\n    }\n    return i;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define MAXVARS\t200",
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "addresses[i]"
          ],
          "line": 489
        },
        "resolved": true,
        "details": {
          "function_name": "container_unfreeze",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
          "lines": "222-228",
          "snippet": "static int container_unfreeze(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushboolean(L, !!c->unfreeze(c));\n    return 1;\n}",
          "includes": [
            "#include \"lxc/commands.h\"",
            "#include <lxc/lxccontainer.h>",
            "#include <libgen.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <assert.h>",
            "#include <lauxlib.h>",
            "#include <lua.h>"
          ],
          "macros_used": [
            "#define CONTAINER_TYPENAME\t\"lxc.container\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_unfreeze(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushboolean(L, !!c->unfreeze(c));\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lua_pushstring",
          "args": [
            "L",
            "addresses[i]"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_pushnil",
          "args": [
            "L"
          ],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_checkstack",
          "args": [
            "L",
            "i"
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_pushnil",
          "args": [
            "L"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->get_ips",
          "args": [
            "c",
            "iface",
            "family",
            "scope"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkinteger",
          "args": [
            "L",
            "4"
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "3"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "2"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_gettop",
          "args": [
            "L"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define MAXVARS\t200\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_get_ips(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    int argc = lua_gettop(L);\n    char **addresses;\n    char *iface = NULL, *family = NULL;\n    int i, scope = 0;\n\n    if (argc > 1)\n\tiface = (char *)luaL_checkstring(L, 2);\n    if (argc > 2)\n\tfamily = (char *)luaL_checkstring(L, 3);\n    if (argc > 3)\n\tscope = luaL_checkinteger(L, 4);\n\n    addresses = c->get_ips(c, iface, family, scope);\n\n    if (!addresses){\n\tlua_pushnil(L);\n\treturn 1;\n    }\n\n    for (i = 0; addresses[i]; i++);\n\n    /* protect LUA stack form overflow */\n    if (i > MAXVARS || !lua_checkstack(L, i)){\n        for (i = 0; addresses[i]; i++)\n\t    free(addresses[i]);\n\tlua_pushnil(L);\n\treturn 1;\n    }\n    for (i = 0; addresses[i]; i++){\n\tlua_pushstring(L, addresses[i]);\n\tfree(addresses[i]);\n    }\n    return i;\n}"
  },
  {
    "function_name": "container_get_interfaces",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "427-454",
    "snippet": "static int container_get_interfaces(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    char **ifaces;\n    int i;\n\n    ifaces = c->get_interfaces(c);\n\n    if (!ifaces){\n\tlua_pushnil(L);\n\treturn 1;\n    }\n\n    for (i = 0; ifaces[i]; i++);\n\n    /* protect LUA stack form overflow */\n    if (i > MAXVARS || !lua_checkstack(L, i)){\n        for (i = 0; ifaces[i]; i++)\n\t    free(ifaces[i]);\n\tlua_pushnil(L);\n\treturn 1;\n    }\n    for (i = 0; ifaces[i]; i++){\n\tlua_pushstring(L, ifaces[i]);\n\tfree(ifaces[i]);\n    }\n    return i;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define MAXVARS\t200",
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "ifaces[i]"
          ],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "container_unfreeze",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
          "lines": "222-228",
          "snippet": "static int container_unfreeze(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushboolean(L, !!c->unfreeze(c));\n    return 1;\n}",
          "includes": [
            "#include \"lxc/commands.h\"",
            "#include <lxc/lxccontainer.h>",
            "#include <libgen.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <assert.h>",
            "#include <lauxlib.h>",
            "#include <lua.h>"
          ],
          "macros_used": [
            "#define CONTAINER_TYPENAME\t\"lxc.container\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_unfreeze(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushboolean(L, !!c->unfreeze(c));\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lua_pushstring",
          "args": [
            "L",
            "ifaces[i]"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_pushnil",
          "args": [
            "L"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_checkstack",
          "args": [
            "L",
            "i"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_pushnil",
          "args": [
            "L"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->get_interfaces",
          "args": [
            "c"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define MAXVARS\t200\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_get_interfaces(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    char **ifaces;\n    int i;\n\n    ifaces = c->get_interfaces(c);\n\n    if (!ifaces){\n\tlua_pushnil(L);\n\treturn 1;\n    }\n\n    for (i = 0; ifaces[i]; i++);\n\n    /* protect LUA stack form overflow */\n    if (i > MAXVARS || !lua_checkstack(L, i)){\n        for (i = 0; ifaces[i]; i++)\n\t    free(ifaces[i]);\n\tlua_pushnil(L);\n\treturn 1;\n    }\n    for (i = 0; ifaces[i]; i++){\n\tlua_pushstring(L, ifaces[i]);\n\tfree(ifaces[i]);\n    }\n    return i;\n}"
  },
  {
    "function_name": "container_attach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "402-425",
    "snippet": "static int container_attach(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    int argc = lua_gettop(L);\n    char **argv = NULL;\n    int i;\n\n    if (argc > 1) {\n\targv = alloca((argc+1) * sizeof(char *));\n\tfor (i = 0; i < argc-1; i++) {\n\t\tconst char *arg = luaL_checkstring(L, i+2);\n\t\targv[i] = strdupa(arg);\n\t}\n\targv[i] = NULL;\n    }\n    else\n    {\n    \tlua_pushnil(L);\n    \treturn 1;\n    }\n\n    lua_pushboolean(L, !(c->attach_run_wait(c, NULL, argv[0], (const char**)argv)));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushboolean",
          "args": [
            "L",
            "!(c->attach_run_wait(c, NULL, argv[0], (const char**)argv))"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->attach_run_wait",
          "args": [
            "c",
            "NULL",
            "argv[0]",
            "(const char**)argv"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_pushnil",
          "args": [
            "L"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdupa",
          "args": [
            "arg"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "i+2"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloca",
          "args": [
            "(argc+1) * sizeof(char *)"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_gettop",
          "args": [
            "L"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_attach(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    int argc = lua_gettop(L);\n    char **argv = NULL;\n    int i;\n\n    if (argc > 1) {\n\targv = alloca((argc+1) * sizeof(char *));\n\tfor (i = 0; i < argc-1; i++) {\n\t\tconst char *arg = luaL_checkstring(L, i+2);\n\t\targv[i] = strdupa(arg);\n\t}\n\targv[i] = NULL;\n    }\n    else\n    {\n    \tlua_pushnil(L);\n    \treturn 1;\n    }\n\n    lua_pushboolean(L, !(c->attach_run_wait(c, NULL, argv[0], (const char**)argv)));\n    return 1;\n}"
  },
  {
    "function_name": "container_get_keys",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "375-400",
    "snippet": "static int container_get_keys(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *key = NULL;\n    int len;\n    char *value;\n    int arg_cnt = lua_gettop(L);\n\n    if (arg_cnt > 1)\n\tkey = luaL_checkstring(L, 2);\n\n    len = c->get_keys(c, key, NULL, 0);\n    if (len <= 0)\n\tgoto not_found;\n\n    value = alloca(sizeof(char)*len + 1);\n    if (c->get_keys(c, key, value, len + 1) != len)\n\tgoto not_found;\n\n    lua_pushstring(L, value);\n    return 1;\n\nnot_found:\n    lua_pushnil(L);\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushnil",
          "args": [
            "L"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_pushstring",
          "args": [
            "L",
            "value"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->get_keys",
          "args": [
            "c",
            "key",
            "value",
            "len + 1"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloca",
          "args": [
            "sizeof(char)*len + 1"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->get_keys",
          "args": [
            "c",
            "key",
            "NULL",
            "0"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "2"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_gettop",
          "args": [
            "L"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_get_keys(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *key = NULL;\n    int len;\n    char *value;\n    int arg_cnt = lua_gettop(L);\n\n    if (arg_cnt > 1)\n\tkey = luaL_checkstring(L, 2);\n\n    len = c->get_keys(c, key, NULL, 0);\n    if (len <= 0)\n\tgoto not_found;\n\n    value = alloca(sizeof(char)*len + 1);\n    if (c->get_keys(c, key, value, len + 1) != len)\n\tgoto not_found;\n\n    lua_pushstring(L, value);\n    return 1;\n\nnot_found:\n    lua_pushnil(L);\n    return 1;\n}"
  },
  {
    "function_name": "container_set_config_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "365-373",
    "snippet": "static int container_set_config_item(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *key = luaL_checkstring(L, 2);\n    const char *value = luaL_checkstring(L, 3);\n\n    lua_pushboolean(L, !!c->set_config_item(c, key, value));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushboolean",
          "args": [
            "L",
            "!!c->set_config_item(c, key, value)"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->set_config_item",
          "args": [
            "c",
            "key",
            "value"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "3"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "2"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_set_config_item(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *key = luaL_checkstring(L, 2);\n    const char *value = luaL_checkstring(L, 3);\n\n    lua_pushboolean(L, !!c->set_config_item(c, key, value));\n    return 1;\n}"
  },
  {
    "function_name": "container_set_cgroup_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "355-363",
    "snippet": "static int container_set_cgroup_item(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *key = luaL_checkstring(L, 2);\n    const char *value = luaL_checkstring(L, 3);\n\n    lua_pushboolean(L, !!c->set_cgroup_item(c, key, value));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushboolean",
          "args": [
            "L",
            "!!c->set_cgroup_item(c, key, value)"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->set_cgroup_item",
          "args": [
            "c",
            "key",
            "value"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "3"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "2"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_set_cgroup_item(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *key = luaL_checkstring(L, 2);\n    const char *value = luaL_checkstring(L, 3);\n\n    lua_pushboolean(L, !!c->set_cgroup_item(c, key, value));\n    return 1;\n}"
  },
  {
    "function_name": "container_get_config_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "332-353",
    "snippet": "static int container_get_config_item(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *key = luaL_checkstring(L, 2);\n    int len;\n    char *value;\n\n    len = c->get_config_item(c, key, NULL, 0);\n    if (len <= 0)\n\tgoto not_found;\n\n    value = alloca(sizeof(char)*len + 1);\n    if (c->get_config_item(c, key, value, len + 1) != len)\n\tgoto not_found;\n\n    lua_pushstring(L, value);\n    return 1;\n\nnot_found:\n    lua_pushnil(L);\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushnil",
          "args": [
            "L"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_pushstring",
          "args": [
            "L",
            "value"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->get_config_item",
          "args": [
            "c",
            "key",
            "value",
            "len + 1"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloca",
          "args": [
            "sizeof(char)*len + 1"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->get_config_item",
          "args": [
            "c",
            "key",
            "NULL",
            "0"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "2"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_get_config_item(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *key = luaL_checkstring(L, 2);\n    int len;\n    char *value;\n\n    len = c->get_config_item(c, key, NULL, 0);\n    if (len <= 0)\n\tgoto not_found;\n\n    value = alloca(sizeof(char)*len + 1);\n    if (c->get_config_item(c, key, value, len + 1) != len)\n\tgoto not_found;\n\n    lua_pushstring(L, value);\n    return 1;\n\nnot_found:\n    lua_pushnil(L);\n    return 1;\n}"
  },
  {
    "function_name": "container_get_cgroup_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "309-330",
    "snippet": "static int container_get_cgroup_item(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *key = luaL_checkstring(L, 2);\n    int len;\n    char *value;\n\n    len = c->get_cgroup_item(c, key, NULL, 0);\n    if (len <= 0)\n\tgoto not_found;\n\n    value = alloca(sizeof(char)*len + 1);\n    if (c->get_cgroup_item(c, key, value, len + 1) != len)\n\tgoto not_found;\n\n    lua_pushstring(L, value);\n    return 1;\n\nnot_found:\n    lua_pushnil(L);\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushnil",
          "args": [
            "L"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_pushstring",
          "args": [
            "L",
            "value"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->get_cgroup_item",
          "args": [
            "c",
            "key",
            "value",
            "len + 1"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloca",
          "args": [
            "sizeof(char)*len + 1"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->get_cgroup_item",
          "args": [
            "c",
            "key",
            "NULL",
            "0"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "2"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_get_cgroup_item(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *key = luaL_checkstring(L, 2);\n    int len;\n    char *value;\n\n    len = c->get_cgroup_item(c, key, NULL, 0);\n    if (len <= 0)\n\tgoto not_found;\n\n    value = alloca(sizeof(char)*len + 1);\n    if (c->get_cgroup_item(c, key, value, len + 1) != len)\n\tgoto not_found;\n\n    lua_pushstring(L, value);\n    return 1;\n\nnot_found:\n    lua_pushnil(L);\n    return 1;\n}"
  },
  {
    "function_name": "container_clear_config_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "300-307",
    "snippet": "static int container_clear_config_item(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *key = luaL_checkstring(L, 2);\n\n    lua_pushboolean(L, !!c->clear_config_item(c, key));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushboolean",
          "args": [
            "L",
            "!!c->clear_config_item(c, key)"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->clear_config_item",
          "args": [
            "c",
            "key"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "2"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_clear_config_item(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *key = luaL_checkstring(L, 2);\n\n    lua_pushboolean(L, !!c->clear_config_item(c, key));\n    return 1;\n}"
  },
  {
    "function_name": "container_set_config_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "291-298",
    "snippet": "static int container_set_config_path(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *config_path = luaL_checkstring(L, 2);\n\n    lua_pushboolean(L, !!c->set_config_path(c, config_path));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushboolean",
          "args": [
            "L",
            "!!c->set_config_path(c, config_path)"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->set_config_path",
          "args": [
            "c",
            "config_path"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "2"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_set_config_path(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *config_path = luaL_checkstring(L, 2);\n\n    lua_pushboolean(L, !!c->set_config_path(c, config_path));\n    return 1;\n}"
  },
  {
    "function_name": "container_get_config_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "281-289",
    "snippet": "static int container_get_config_path(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *config_path;\n\n    config_path = c->get_config_path(c);\n    lua_pushstring(L, config_path);\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushstring",
          "args": [
            "L",
            "config_path"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->get_config_path",
          "args": [
            "c"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_get_config_path(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *config_path;\n\n    config_path = c->get_config_path(c);\n    lua_pushstring(L, config_path);\n    return 1;\n}"
  },
  {
    "function_name": "container_save_config",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "268-279",
    "snippet": "static int container_save_config(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    int arg_cnt = lua_gettop(L);\n    const char *alt_path = NULL;\n\n    if (arg_cnt > 1)\n\talt_path = luaL_checkstring(L, 2);\n\n    lua_pushboolean(L, !!c->save_config(c, alt_path));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushboolean",
          "args": [
            "L",
            "!!c->save_config(c, alt_path)"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->save_config",
          "args": [
            "c",
            "alt_path"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "2"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_gettop",
          "args": [
            "L"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_save_config(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    int arg_cnt = lua_gettop(L);\n    const char *alt_path = NULL;\n\n    if (arg_cnt > 1)\n\talt_path = luaL_checkstring(L, 2);\n\n    lua_pushboolean(L, !!c->save_config(c, alt_path));\n    return 1;\n}"
  },
  {
    "function_name": "container_load_config",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "255-266",
    "snippet": "static int container_load_config(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    int arg_cnt = lua_gettop(L);\n    const char *alt_path = NULL;\n\n    if (arg_cnt > 1)\n\talt_path = luaL_checkstring(L, 2);\n\n    lua_pushboolean(L, !!c->load_config(c, alt_path));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushboolean",
          "args": [
            "L",
            "!!c->load_config(c, alt_path)"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->load_config",
          "args": [
            "c",
            "alt_path"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "2"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_gettop",
          "args": [
            "L"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_load_config(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    int arg_cnt = lua_gettop(L);\n    const char *alt_path = NULL;\n\n    if (arg_cnt > 1)\n\talt_path = luaL_checkstring(L, 2);\n\n    lua_pushboolean(L, !!c->load_config(c, alt_path));\n    return 1;\n}"
  },
  {
    "function_name": "container_init_pid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "246-252",
    "snippet": "static int container_init_pid(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushinteger(L, c->init_pid(c));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushinteger",
          "args": [
            "L",
            "c->init_pid(c)"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->init_pid",
          "args": [
            "c"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_init_pid(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushinteger(L, c->init_pid(c));\n    return 1;\n}"
  },
  {
    "function_name": "container_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "238-244",
    "snippet": "static int container_state(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushstring(L, c->state(c));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushstring",
          "args": [
            "L",
            "c->state(c)"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->state",
          "args": [
            "c"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_state(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushstring(L, c->state(c));\n    return 1;\n}"
  },
  {
    "function_name": "container_running",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "230-236",
    "snippet": "static int container_running(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushboolean(L, !!c->is_running(c));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushboolean",
          "args": [
            "L",
            "!!c->is_running(c)"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->is_running",
          "args": [
            "c"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_running(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushboolean(L, !!c->is_running(c));\n    return 1;\n}"
  },
  {
    "function_name": "container_unfreeze",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "222-228",
    "snippet": "static int container_unfreeze(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushboolean(L, !!c->unfreeze(c));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushboolean",
          "args": [
            "L",
            "!!c->unfreeze(c)"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->unfreeze",
          "args": [
            "c"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_unfreeze(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushboolean(L, !!c->unfreeze(c));\n    return 1;\n}"
  },
  {
    "function_name": "container_freeze",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "214-220",
    "snippet": "static int container_freeze(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushboolean(L, !!c->freeze(c));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushboolean",
          "args": [
            "L",
            "!!c->freeze(c)"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->freeze",
          "args": [
            "c"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_freeze(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushboolean(L, !!c->freeze(c));\n    return 1;\n}"
  },
  {
    "function_name": "container_rename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "200-212",
    "snippet": "static int container_rename(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *new_name;\n    int argc = lua_gettop(L);\n\n    if (argc > 1) {\n\tnew_name = luaL_checkstring(L, 2);\n\tlua_pushboolean(L, !!c->rename(c, new_name));\n    } else\n\tlua_pushnil(L);\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushnil",
          "args": [
            "L"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_pushboolean",
          "args": [
            "L",
            "!!c->rename(c, new_name)"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->rename",
          "args": [
            "c",
            "new_name"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "2"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_gettop",
          "args": [
            "L"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_rename(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *new_name;\n    int argc = lua_gettop(L);\n\n    if (argc > 1) {\n\tnew_name = luaL_checkstring(L, 2);\n\tlua_pushboolean(L, !!c->rename(c, new_name));\n    } else\n\tlua_pushnil(L);\n    return 1;\n}"
  },
  {
    "function_name": "container_wait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "190-198",
    "snippet": "static int container_wait(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *state = luaL_checkstring(L, 2);\n    int timeout = luaL_checkinteger(L, 3);\n\n    lua_pushboolean(L, !!c->wait(c, state, timeout));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushboolean",
          "args": [
            "L",
            "!!c->wait(c, state, timeout)"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->wait",
          "args": [
            "c",
            "state",
            "timeout"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkinteger",
          "args": [
            "L",
            "3"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "2"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_wait(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    const char *state = luaL_checkstring(L, 2);\n    int timeout = luaL_checkinteger(L, 3);\n\n    lua_pushboolean(L, !!c->wait(c, state, timeout));\n    return 1;\n}"
  },
  {
    "function_name": "container_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "181-188",
    "snippet": "static int container_shutdown(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    int timeout = luaL_checkinteger(L, 2);\n\n    lua_pushboolean(L, !!c->shutdown(c, timeout));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushboolean",
          "args": [
            "L",
            "!!c->shutdown(c, timeout)"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->shutdown",
          "args": [
            "c",
            "timeout"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkinteger",
          "args": [
            "L",
            "2"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_shutdown(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    int timeout = luaL_checkinteger(L, 2);\n\n    lua_pushboolean(L, !!c->shutdown(c, timeout));\n    return 1;\n}"
  },
  {
    "function_name": "container_stop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "173-179",
    "snippet": "static int container_stop(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushboolean(L, !!c->stop(c));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushboolean",
          "args": [
            "L",
            "!!c->stop(c)"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->stop",
          "args": [
            "c"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_stop(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushboolean(L, !!c->stop(c));\n    return 1;\n}"
  },
  {
    "function_name": "container_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "147-171",
    "snippet": "static int container_start(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    int argc = lua_gettop(L);\n    char **argv = NULL;\n    int i,j;\n    int useinit = 0;\n\n    if (argc > 1) {\n\targv = alloca((argc+1) * sizeof(char *));\n\tfor (i = 0, j = 0; i < argc-1; i++) {\n\t    const char *arg = luaL_checkstring(L, i+2);\n\n\t    if (!strcmp(arg, \"useinit\"))\n\t\tuseinit = 1;\n\t    else\n\t\targv[j++] = strdupa(arg);\n\t}\n\targv[j] = NULL;\n    }\n\n    c->want_daemonize(c, true);\n    lua_pushboolean(L, !!c->start(c, useinit, argv));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushboolean",
          "args": [
            "L",
            "!!c->start(c, useinit, argv)"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->start",
          "args": [
            "c",
            "useinit",
            "argv"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->want_daemonize",
          "args": [
            "c",
            "true"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdupa",
          "args": [
            "arg"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "arg",
            "\"useinit\""
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "i+2"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloca",
          "args": [
            "(argc+1) * sizeof(char *)"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_gettop",
          "args": [
            "L"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_start(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    int argc = lua_gettop(L);\n    char **argv = NULL;\n    int i,j;\n    int useinit = 0;\n\n    if (argc > 1) {\n\targv = alloca((argc+1) * sizeof(char *));\n\tfor (i = 0, j = 0; i < argc-1; i++) {\n\t    const char *arg = luaL_checkstring(L, i+2);\n\n\t    if (!strcmp(arg, \"useinit\"))\n\t\tuseinit = 1;\n\t    else\n\t\targv[j++] = strdupa(arg);\n\t}\n\targv[j] = NULL;\n    }\n\n    c->want_daemonize(c, true);\n    lua_pushboolean(L, !!c->start(c, useinit, argv));\n    return 1;\n}"
  },
  {
    "function_name": "container_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "138-144",
    "snippet": "static int container_destroy(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushboolean(L, !!c->destroy(c));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushboolean",
          "args": [
            "L",
            "!!c->destroy(c)"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->destroy",
          "args": [
            "c"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_destroy(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushboolean(L, !!c->destroy(c));\n    return 1;\n}"
  },
  {
    "function_name": "container_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "121-136",
    "snippet": "static int container_create(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    char *template_name = strdupa(luaL_checkstring(L, 2));\n    int argc = lua_gettop(L);\n    char **argv;\n    int i;\n\n    argv = alloca((argc+1) * sizeof(char *));\n    for (i = 0; i < argc-2; i++)\n\targv[i] = strdupa(luaL_checkstring(L, i+3));\n    argv[i] = NULL;\n\n    lua_pushboolean(L, !!c->create(c, template_name, NULL, NULL, 0, argv));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushboolean",
          "args": [
            "L",
            "!!c->create(c, template_name, NULL, NULL, 0, argv)"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->create",
          "args": [
            "c",
            "template_name",
            "NULL",
            "NULL",
            "0",
            "argv"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdupa",
          "args": [
            "luaL_checkstring(L, i+3)"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "i+3"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloca",
          "args": [
            "(argc+1) * sizeof(char *)"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_gettop",
          "args": [
            "L"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdupa",
          "args": [
            "luaL_checkstring(L, 2)"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "2"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_create(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    char *template_name = strdupa(luaL_checkstring(L, 2));\n    int argc = lua_gettop(L);\n    char **argv;\n    int i;\n\n    argv = alloca((argc+1) * sizeof(char *));\n    for (i = 0; i < argc-2; i++)\n\targv[i] = strdupa(luaL_checkstring(L, i+3));\n    argv[i] = NULL;\n\n    lua_pushboolean(L, !!c->create(c, template_name, NULL, NULL, 0, argv));\n    return 1;\n}"
  },
  {
    "function_name": "container_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "113-119",
    "snippet": "static int container_name(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushstring(L, c->name);\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushstring",
          "args": [
            "L",
            "c->name"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_name(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushstring(L, c->name);\n    return 1;\n}"
  },
  {
    "function_name": "container_defined",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "105-111",
    "snippet": "static int container_defined(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushboolean(L, !!c->is_defined(c));\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushboolean",
          "args": [
            "L",
            "!!c->is_defined(c)"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->is_defined",
          "args": [
            "c"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_defined(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushboolean(L, !!c->is_defined(c));\n    return 1;\n}"
  },
  {
    "function_name": "container_config_file_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "94-103",
    "snippet": "static int container_config_file_name(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    char *config_file_name;\n\n    config_file_name = c->config_file_name(c);\n    lua_pushstring(L, config_file_name);\n    free(config_file_name);\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "config_file_name"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "container_unfreeze",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
          "lines": "222-228",
          "snippet": "static int container_unfreeze(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushboolean(L, !!c->unfreeze(c));\n    return 1;\n}",
          "includes": [
            "#include \"lxc/commands.h\"",
            "#include <lxc/lxccontainer.h>",
            "#include <libgen.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <assert.h>",
            "#include <lauxlib.h>",
            "#include <lua.h>"
          ],
          "macros_used": [
            "#define CONTAINER_TYPENAME\t\"lxc.container\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_unfreeze(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    lua_pushboolean(L, !!c->unfreeze(c));\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lua_pushstring",
          "args": [
            "L",
            "config_file_name"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c->config_file_name",
          "args": [
            "c"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_config_file_name(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n    char *config_file_name;\n\n    config_file_name = c->config_file_name(c);\n    lua_pushstring(L, config_file_name);\n    free(config_file_name);\n    return 1;\n}"
  },
  {
    "function_name": "container_gc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "85-92",
    "snippet": "static int container_gc(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    /* XXX what to do if this fails? */\n    lxc_container_put(c);\n    return 0;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxc_container_put",
          "args": [
            "c"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_container_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/lxccontainer.c",
          "lines": "312-325",
          "snippet": "int lxc_container_put(struct lxc_container *c)\n{\n\tif (!c)\n\t\treturn -1;\n\tif (container_mem_lock(c))\n\t\treturn -1;\n\tif (--c->numthreads < 1) {\n\t\tcontainer_mem_unlock(c);\n\t\tlxc_container_free(c);\n\t\treturn 1;\n\t}\n\tcontainer_mem_unlock(c);\n\treturn 0;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include \"version.h\"",
            "#include \"utils.h\"",
            "#include \"state.h\"",
            "#include \"sync.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"monitor.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxccontainer.h\"",
            "#include \"lxc.h\"",
            "#include \"log.h\"",
            "#include \"criu.h\"",
            "#include \"console.h\"",
            "#include \"confile.h\"",
            "#include \"commands.h\"",
            "#include \"config.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"lxcbtrfs.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"bdev.h\"",
            "#include \"attach.h\"",
            "#include <sys/wait.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool do_lxcapi_destroy(struct lxc_container *c);",
            "static const char *lxcapi_get_config_path(struct lxc_container *c);",
            "static bool container_destroy(struct lxc_container *c);",
            "static bool lxcapi_snapshot_destroy_all(struct lxc_container *c);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include \"version.h\"\n#include \"utils.h\"\n#include \"state.h\"\n#include \"sync.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"monitor.h\"\n#include \"lxclock.h\"\n#include \"lxccontainer.h\"\n#include \"lxc.h\"\n#include \"log.h\"\n#include \"criu.h\"\n#include \"console.h\"\n#include \"confile.h\"\n#include \"commands.h\"\n#include \"config.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"lxcbtrfs.h\"\n#include \"lxcoverlay.h\"\n#include \"bdev.h\"\n#include \"attach.h\"\n#include <sys/wait.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <sched.h>\n#include <pthread.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n\nstatic bool do_lxcapi_destroy(struct lxc_container *c);\nstatic const char *lxcapi_get_config_path(struct lxc_container *c);\nstatic bool container_destroy(struct lxc_container *c);\nstatic bool lxcapi_snapshot_destroy_all(struct lxc_container *c);\n\nint lxc_container_put(struct lxc_container *c)\n{\n\tif (!c)\n\t\treturn -1;\n\tif (container_mem_lock(c))\n\t\treturn -1;\n\tif (--c->numthreads < 1) {\n\t\tcontainer_mem_unlock(c);\n\t\tlxc_container_free(c);\n\t\treturn 1;\n\t}\n\tcontainer_mem_unlock(c);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lua_unboxpointer",
          "args": [
            "L",
            "1",
            "CONTAINER_TYPENAME"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_gc(lua_State *L)\n{\n    struct lxc_container *c = lua_unboxpointer(L, 1, CONTAINER_TYPENAME);\n\n    /* XXX what to do if this fails? */\n    lxc_container_put(c);\n    return 0;\n}"
  },
  {
    "function_name": "container_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lua-lxc/core.c",
    "lines": "64-83",
    "snippet": "static int container_new(lua_State *L)\n{\n    struct lxc_container *c;\n    const char *name = luaL_checkstring(L, 1);\n    const char *configpath = NULL;\n    int argc = lua_gettop(L);\n\n    if (argc > 1)\n\tconfigpath = luaL_checkstring(L, 2);\n\n    c = lxc_container_new(name, configpath);\n    if (c) {\n\tlua_boxpointer(L, c);\n\tluaL_getmetatable(L, CONTAINER_TYPENAME);\n\tlua_setmetatable(L, -2);\n    } else {\n\tlua_pushnil(L);\n    }\n    return 1;\n}",
    "includes": [
      "#include \"lxc/commands.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <libgen.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <lauxlib.h>",
      "#include <lua.h>"
    ],
    "macros_used": [
      "#define CONTAINER_TYPENAME\t\"lxc.container\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lua_pushnil",
          "args": [
            "L"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_setmetatable",
          "args": [
            "L",
            "-2"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_getmetatable",
          "args": [
            "L",
            "CONTAINER_TYPENAME"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_boxpointer",
          "args": [
            "L",
            "c"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_container_new",
          "args": [
            "name",
            "configpath"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_container_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/lxccontainer.c",
          "lines": "4099-4218",
          "snippet": "struct lxc_container *lxc_container_new(const char *name, const char *configpath)\n{\n\tstruct lxc_container *c;\n\n\tif (!name)\n\t\treturn NULL;\n\n\tc = malloc(sizeof(*c));\n\tif (!c) {\n\t\tfprintf(stderr, \"failed to malloc lxc_container\\n\");\n\t\treturn NULL;\n\t}\n\tmemset(c, 0, sizeof(*c));\n\n\tif (configpath)\n\t\tc->config_path = strdup(configpath);\n\telse\n\t\tc->config_path = strdup(lxc_global_config_value(\"lxc.lxcpath\"));\n\n\tif (!c->config_path) {\n\t\tfprintf(stderr, \"Out of memory\\n\");\n\t\tgoto err;\n\t}\n\n\tremove_trailing_slashes(c->config_path);\n\tc->name = malloc(strlen(name)+1);\n\tif (!c->name) {\n\t\tfprintf(stderr, \"Error allocating lxc_container name\\n\");\n\t\tgoto err;\n\t}\n\tstrcpy(c->name, name);\n\n\tc->numthreads = 1;\n\tif (!(c->slock = lxc_newlock(c->config_path, name))) {\n\t\tfprintf(stderr, \"failed to create lock\\n\");\n\t\tgoto err;\n\t}\n\n\tif (!(c->privlock = lxc_newlock(NULL, NULL))) {\n\t\tfprintf(stderr, \"failed to alloc privlock\\n\");\n\t\tgoto err;\n\t}\n\n\tif (!set_config_filename(c)) {\n\t\tfprintf(stderr, \"Error allocating config file pathname\\n\");\n\t\tgoto err;\n\t}\n\n\tif (file_exists(c->configfile) && !lxcapi_load_config(c, NULL))\n\t\tgoto err;\n\n\tif (ongoing_create(c) == 2) {\n\t\tERROR(\"Error: %s creation was not completed\", c->name);\n\t\tcontainer_destroy(c);\n\t\tlxcapi_clear_config(c);\n\t}\n\tc->daemonize = true;\n\tc->pidfile = NULL;\n\n\t// assign the member functions\n\tc->is_defined = lxcapi_is_defined;\n\tc->state = lxcapi_state;\n\tc->is_running = lxcapi_is_running;\n\tc->freeze = lxcapi_freeze;\n\tc->unfreeze = lxcapi_unfreeze;\n\tc->console = lxcapi_console;\n\tc->console_getfd = lxcapi_console_getfd;\n\tc->init_pid = lxcapi_init_pid;\n\tc->load_config = lxcapi_load_config;\n\tc->want_daemonize = lxcapi_want_daemonize;\n\tc->want_close_all_fds = lxcapi_want_close_all_fds;\n\tc->start = lxcapi_start;\n\tc->startl = lxcapi_startl;\n\tc->stop = lxcapi_stop;\n\tc->config_file_name = lxcapi_config_file_name;\n\tc->wait = lxcapi_wait;\n\tc->set_config_item = lxcapi_set_config_item;\n\tc->destroy = lxcapi_destroy;\n\tc->destroy_with_snapshots = lxcapi_destroy_with_snapshots;\n\tc->rename = lxcapi_rename;\n\tc->save_config = lxcapi_save_config;\n\tc->get_keys = lxcapi_get_keys;\n\tc->create = lxcapi_create;\n\tc->createl = lxcapi_createl;\n\tc->shutdown = lxcapi_shutdown;\n\tc->reboot = lxcapi_reboot;\n\tc->clear_config = lxcapi_clear_config;\n\tc->clear_config_item = lxcapi_clear_config_item;\n\tc->get_config_item = lxcapi_get_config_item;\n\tc->get_running_config_item = lxcapi_get_running_config_item;\n\tc->get_cgroup_item = lxcapi_get_cgroup_item;\n\tc->set_cgroup_item = lxcapi_set_cgroup_item;\n\tc->get_config_path = lxcapi_get_config_path;\n\tc->set_config_path = lxcapi_set_config_path;\n\tc->clone = lxcapi_clone;\n\tc->get_interfaces = lxcapi_get_interfaces;\n\tc->get_ips = lxcapi_get_ips;\n\tc->attach = lxcapi_attach;\n\tc->attach_run_wait = lxcapi_attach_run_wait;\n\tc->attach_run_waitl = lxcapi_attach_run_waitl;\n\tc->snapshot = lxcapi_snapshot;\n\tc->snapshot_list = lxcapi_snapshot_list;\n\tc->snapshot_restore = lxcapi_snapshot_restore;\n\tc->snapshot_destroy = lxcapi_snapshot_destroy;\n\tc->snapshot_destroy_all = lxcapi_snapshot_destroy_all;\n\tc->may_control = lxcapi_may_control;\n\tc->add_device_node = lxcapi_add_device_node;\n\tc->remove_device_node = lxcapi_remove_device_node;\n\tc->attach_interface = lxcapi_attach_interface;\n\tc->detach_interface = lxcapi_detach_interface;\n\tc->checkpoint = lxcapi_checkpoint;\n\tc->restore = lxcapi_restore;\n\tc->migrate = lxcapi_migrate;\n\n\treturn c;\n\nerr:\n\tlxc_container_free(c);\n\treturn NULL;\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include \"version.h\"",
            "#include \"utils.h\"",
            "#include \"state.h\"",
            "#include \"sync.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"monitor.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxccontainer.h\"",
            "#include \"lxc.h\"",
            "#include \"log.h\"",
            "#include \"criu.h\"",
            "#include \"console.h\"",
            "#include \"confile.h\"",
            "#include \"commands.h\"",
            "#include \"config.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"lxcbtrfs.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"bdev.h\"",
            "#include \"attach.h\"",
            "#include <sys/wait.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool do_lxcapi_destroy(struct lxc_container *c);",
            "static const char *lxcapi_get_config_path(struct lxc_container *c);",
            "static bool container_destroy(struct lxc_container *c);",
            "static bool lxcapi_snapshot_destroy_all(struct lxc_container *c);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include \"version.h\"\n#include \"utils.h\"\n#include \"state.h\"\n#include \"sync.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"monitor.h\"\n#include \"lxclock.h\"\n#include \"lxccontainer.h\"\n#include \"lxc.h\"\n#include \"log.h\"\n#include \"criu.h\"\n#include \"console.h\"\n#include \"confile.h\"\n#include \"commands.h\"\n#include \"config.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"lxcbtrfs.h\"\n#include \"lxcoverlay.h\"\n#include \"bdev.h\"\n#include \"attach.h\"\n#include <sys/wait.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <sched.h>\n#include <pthread.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n\nstatic bool do_lxcapi_destroy(struct lxc_container *c);\nstatic const char *lxcapi_get_config_path(struct lxc_container *c);\nstatic bool container_destroy(struct lxc_container *c);\nstatic bool lxcapi_snapshot_destroy_all(struct lxc_container *c);\n\nstruct lxc_container *lxc_container_new(const char *name, const char *configpath)\n{\n\tstruct lxc_container *c;\n\n\tif (!name)\n\t\treturn NULL;\n\n\tc = malloc(sizeof(*c));\n\tif (!c) {\n\t\tfprintf(stderr, \"failed to malloc lxc_container\\n\");\n\t\treturn NULL;\n\t}\n\tmemset(c, 0, sizeof(*c));\n\n\tif (configpath)\n\t\tc->config_path = strdup(configpath);\n\telse\n\t\tc->config_path = strdup(lxc_global_config_value(\"lxc.lxcpath\"));\n\n\tif (!c->config_path) {\n\t\tfprintf(stderr, \"Out of memory\\n\");\n\t\tgoto err;\n\t}\n\n\tremove_trailing_slashes(c->config_path);\n\tc->name = malloc(strlen(name)+1);\n\tif (!c->name) {\n\t\tfprintf(stderr, \"Error allocating lxc_container name\\n\");\n\t\tgoto err;\n\t}\n\tstrcpy(c->name, name);\n\n\tc->numthreads = 1;\n\tif (!(c->slock = lxc_newlock(c->config_path, name))) {\n\t\tfprintf(stderr, \"failed to create lock\\n\");\n\t\tgoto err;\n\t}\n\n\tif (!(c->privlock = lxc_newlock(NULL, NULL))) {\n\t\tfprintf(stderr, \"failed to alloc privlock\\n\");\n\t\tgoto err;\n\t}\n\n\tif (!set_config_filename(c)) {\n\t\tfprintf(stderr, \"Error allocating config file pathname\\n\");\n\t\tgoto err;\n\t}\n\n\tif (file_exists(c->configfile) && !lxcapi_load_config(c, NULL))\n\t\tgoto err;\n\n\tif (ongoing_create(c) == 2) {\n\t\tERROR(\"Error: %s creation was not completed\", c->name);\n\t\tcontainer_destroy(c);\n\t\tlxcapi_clear_config(c);\n\t}\n\tc->daemonize = true;\n\tc->pidfile = NULL;\n\n\t// assign the member functions\n\tc->is_defined = lxcapi_is_defined;\n\tc->state = lxcapi_state;\n\tc->is_running = lxcapi_is_running;\n\tc->freeze = lxcapi_freeze;\n\tc->unfreeze = lxcapi_unfreeze;\n\tc->console = lxcapi_console;\n\tc->console_getfd = lxcapi_console_getfd;\n\tc->init_pid = lxcapi_init_pid;\n\tc->load_config = lxcapi_load_config;\n\tc->want_daemonize = lxcapi_want_daemonize;\n\tc->want_close_all_fds = lxcapi_want_close_all_fds;\n\tc->start = lxcapi_start;\n\tc->startl = lxcapi_startl;\n\tc->stop = lxcapi_stop;\n\tc->config_file_name = lxcapi_config_file_name;\n\tc->wait = lxcapi_wait;\n\tc->set_config_item = lxcapi_set_config_item;\n\tc->destroy = lxcapi_destroy;\n\tc->destroy_with_snapshots = lxcapi_destroy_with_snapshots;\n\tc->rename = lxcapi_rename;\n\tc->save_config = lxcapi_save_config;\n\tc->get_keys = lxcapi_get_keys;\n\tc->create = lxcapi_create;\n\tc->createl = lxcapi_createl;\n\tc->shutdown = lxcapi_shutdown;\n\tc->reboot = lxcapi_reboot;\n\tc->clear_config = lxcapi_clear_config;\n\tc->clear_config_item = lxcapi_clear_config_item;\n\tc->get_config_item = lxcapi_get_config_item;\n\tc->get_running_config_item = lxcapi_get_running_config_item;\n\tc->get_cgroup_item = lxcapi_get_cgroup_item;\n\tc->set_cgroup_item = lxcapi_set_cgroup_item;\n\tc->get_config_path = lxcapi_get_config_path;\n\tc->set_config_path = lxcapi_set_config_path;\n\tc->clone = lxcapi_clone;\n\tc->get_interfaces = lxcapi_get_interfaces;\n\tc->get_ips = lxcapi_get_ips;\n\tc->attach = lxcapi_attach;\n\tc->attach_run_wait = lxcapi_attach_run_wait;\n\tc->attach_run_waitl = lxcapi_attach_run_waitl;\n\tc->snapshot = lxcapi_snapshot;\n\tc->snapshot_list = lxcapi_snapshot_list;\n\tc->snapshot_restore = lxcapi_snapshot_restore;\n\tc->snapshot_destroy = lxcapi_snapshot_destroy;\n\tc->snapshot_destroy_all = lxcapi_snapshot_destroy_all;\n\tc->may_control = lxcapi_may_control;\n\tc->add_device_node = lxcapi_add_device_node;\n\tc->remove_device_node = lxcapi_remove_device_node;\n\tc->attach_interface = lxcapi_attach_interface;\n\tc->detach_interface = lxcapi_detach_interface;\n\tc->checkpoint = lxcapi_checkpoint;\n\tc->restore = lxcapi_restore;\n\tc->migrate = lxcapi_migrate;\n\n\treturn c;\n\nerr:\n\tlxc_container_free(c);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "2"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lua_gettop",
          "args": [
            "L"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "luaL_checkstring",
          "args": [
            "L",
            "1"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lxc/commands.h\"\n#include <lxc/lxccontainer.h>\n#include <libgen.h>\n#include <unistd.h>\n#include <string.h>\n#include <assert.h>\n#include <lauxlib.h>\n#include <lua.h>\n\n#define CONTAINER_TYPENAME\t\"lxc.container\"\n\nstatic int container_new(lua_State *L)\n{\n    struct lxc_container *c;\n    const char *name = luaL_checkstring(L, 1);\n    const char *configpath = NULL;\n    int argc = lua_gettop(L);\n\n    if (argc > 1)\n\tconfigpath = luaL_checkstring(L, 2);\n\n    c = lxc_container_new(name, configpath);\n    if (c) {\n\tlua_boxpointer(L, c);\n\tluaL_getmetatable(L, CONTAINER_TYPENAME);\n\tlua_setmetatable(L, -2);\n    } else {\n\tlua_pushnil(L);\n    }\n    return 1;\n}"
  }
]