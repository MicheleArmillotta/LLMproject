[
  {
    "function_name": "__lxc_log",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/log.h",
    "lines": "224-232",
    "snippet": "static inline void\n__lxc_log(const struct lxc_log_category* category,\n\t  struct lxc_log_event* event)\n{\n\twhile (category) {\n\t\t__lxc_log_append(category->appender, event);\n\t\tcategory = category->parent;\n\t}\n}",
    "includes": [
      "#include \"conf.h\"",
      "#include <time.h>",
      "#include <syslog.h>",
      "#include <stdbool.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <sys/time.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__lxc_log_append",
          "args": [
            "category->appender",
            "event"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "__lxc_log_append",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/log.h",
          "lines": "208-222",
          "snippet": "static inline void\n__lxc_log_append(const struct lxc_log_appender *appender,\n\t\tstruct lxc_log_event* event)\n{\n\tva_list va, *va_keep;\n\tva_keep = event->vap;\n\n\twhile (appender) {\n\t\tva_copy(va, *va_keep);\n\t\tevent->vap = &va;\n\t\tappender->append(appender, event);\n\t\tappender = appender->next;\n\t\tva_end(va);\n\t}\n}",
          "includes": [
            "#include \"conf.h\"",
            "#include <time.h>",
            "#include <syslog.h>",
            "#include <stdbool.h>",
            "#include <strings.h>",
            "#include <string.h>",
            "#include <sys/time.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"conf.h\"\n#include <time.h>\n#include <syslog.h>\n#include <stdbool.h>\n#include <strings.h>\n#include <string.h>\n#include <sys/time.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"config.h\"\n\nstatic inline void\n__lxc_log_append(const struct lxc_log_appender *appender,\n\t\tstruct lxc_log_event* event)\n{\n\tva_list va, *va_keep;\n\tva_keep = event->vap;\n\n\twhile (appender) {\n\t\tva_copy(va, *va_keep);\n\t\tevent->vap = &va;\n\t\tappender->append(appender, event);\n\t\tappender = appender->next;\n\t\tva_end(va);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"conf.h\"\n#include <time.h>\n#include <syslog.h>\n#include <stdbool.h>\n#include <strings.h>\n#include <string.h>\n#include <sys/time.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"config.h\"\n\nstatic inline void\n__lxc_log(const struct lxc_log_category* category,\n\t  struct lxc_log_event* event)\n{\n\twhile (category) {\n\t\t__lxc_log_append(category->appender, event);\n\t\tcategory = category->parent;\n\t}\n}"
  },
  {
    "function_name": "__lxc_log_append",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/log.h",
    "lines": "208-222",
    "snippet": "static inline void\n__lxc_log_append(const struct lxc_log_appender *appender,\n\t\tstruct lxc_log_event* event)\n{\n\tva_list va, *va_keep;\n\tva_keep = event->vap;\n\n\twhile (appender) {\n\t\tva_copy(va, *va_keep);\n\t\tevent->vap = &va;\n\t\tappender->append(appender, event);\n\t\tappender = appender->next;\n\t\tva_end(va);\n\t}\n}",
    "includes": [
      "#include \"conf.h\"",
      "#include <time.h>",
      "#include <syslog.h>",
      "#include <stdbool.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <sys/time.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "va"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appender->append",
          "args": [
            "appender",
            "event"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_copy",
          "args": [
            "va",
            "*va_keep"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"conf.h\"\n#include <time.h>\n#include <syslog.h>\n#include <stdbool.h>\n#include <strings.h>\n#include <string.h>\n#include <sys/time.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"config.h\"\n\nstatic inline void\n__lxc_log_append(const struct lxc_log_appender *appender,\n\t\tstruct lxc_log_event* event)\n{\n\tva_list va, *va_keep;\n\tva_keep = event->vap;\n\n\twhile (appender) {\n\t\tva_copy(va, *va_keep);\n\t\tevent->vap = &va;\n\t\tappender->append(appender, event);\n\t\tappender = appender->next;\n\t\tva_end(va);\n\t}\n}"
  },
  {
    "function_name": "lxc_syslog_priority_to_int",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/log.h",
    "lines": "193-206",
    "snippet": "static inline int lxc_syslog_priority_to_int(const char* name)\n{\n\tif (!strcasecmp(\"daemon\", name)) return LOG_DAEMON;\n\tif (!strcasecmp(\"local0\", name)) return LOG_LOCAL0;\n\tif (!strcasecmp(\"local1\", name)) return LOG_LOCAL1;\n\tif (!strcasecmp(\"local2\", name)) return LOG_LOCAL2;\n\tif (!strcasecmp(\"local3\", name)) return LOG_LOCAL3;\n\tif (!strcasecmp(\"local4\", name)) return LOG_LOCAL4;\n\tif (!strcasecmp(\"local5\", name)) return LOG_LOCAL5;\n\tif (!strcasecmp(\"local6\", name)) return LOG_LOCAL6;\n\tif (!strcasecmp(\"local7\", name)) return LOG_LOCAL7;\n\n\treturn -EINVAL;\n}",
    "includes": [
      "#include \"conf.h\"",
      "#include <time.h>",
      "#include <syslog.h>",
      "#include <stdbool.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <sys/time.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "\"local7\"",
            "name"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "\"local6\"",
            "name"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "\"local5\"",
            "name"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "\"local4\"",
            "name"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "\"local3\"",
            "name"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "\"local2\"",
            "name"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "\"local1\"",
            "name"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "\"local0\"",
            "name"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "\"daemon\"",
            "name"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"conf.h\"\n#include <time.h>\n#include <syslog.h>\n#include <stdbool.h>\n#include <strings.h>\n#include <string.h>\n#include <sys/time.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"config.h\"\n\nstatic inline int lxc_syslog_priority_to_int(const char* name)\n{\n\tif (!strcasecmp(\"daemon\", name)) return LOG_DAEMON;\n\tif (!strcasecmp(\"local0\", name)) return LOG_LOCAL0;\n\tif (!strcasecmp(\"local1\", name)) return LOG_LOCAL1;\n\tif (!strcasecmp(\"local2\", name)) return LOG_LOCAL2;\n\tif (!strcasecmp(\"local3\", name)) return LOG_LOCAL3;\n\tif (!strcasecmp(\"local4\", name)) return LOG_LOCAL4;\n\tif (!strcasecmp(\"local5\", name)) return LOG_LOCAL5;\n\tif (!strcasecmp(\"local6\", name)) return LOG_LOCAL6;\n\tif (!strcasecmp(\"local7\", name)) return LOG_LOCAL7;\n\n\treturn -EINVAL;\n}"
  },
  {
    "function_name": "lxc_log_priority_to_int",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/log.h",
    "lines": "178-191",
    "snippet": "static inline int lxc_log_priority_to_int(const char* name)\n{\n\tif (!strcasecmp(\"TRACE\",  name)) return LXC_LOG_PRIORITY_TRACE;\n\tif (!strcasecmp(\"DEBUG\",  name)) return LXC_LOG_PRIORITY_DEBUG;\n\tif (!strcasecmp(\"INFO\",   name)) return LXC_LOG_PRIORITY_INFO;\n\tif (!strcasecmp(\"NOTICE\", name)) return LXC_LOG_PRIORITY_NOTICE;\n\tif (!strcasecmp(\"WARN\",   name)) return LXC_LOG_PRIORITY_WARN;\n\tif (!strcasecmp(\"ERROR\",  name)) return LXC_LOG_PRIORITY_ERROR;\n\tif (!strcasecmp(\"CRIT\",   name)) return LXC_LOG_PRIORITY_CRIT;\n\tif (!strcasecmp(\"ALERT\",  name)) return LXC_LOG_PRIORITY_ALERT;\n\tif (!strcasecmp(\"FATAL\",  name)) return LXC_LOG_PRIORITY_FATAL;\n\n\treturn LXC_LOG_PRIORITY_NOTSET;\n}",
    "includes": [
      "#include \"conf.h\"",
      "#include <time.h>",
      "#include <syslog.h>",
      "#include <stdbool.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <sys/time.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "\"FATAL\"",
            "name"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "\"ALERT\"",
            "name"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "\"CRIT\"",
            "name"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "\"ERROR\"",
            "name"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "\"WARN\"",
            "name"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "\"NOTICE\"",
            "name"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "\"INFO\"",
            "name"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "\"DEBUG\"",
            "name"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "\"TRACE\"",
            "name"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"conf.h\"\n#include <time.h>\n#include <syslog.h>\n#include <stdbool.h>\n#include <strings.h>\n#include <string.h>\n#include <sys/time.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"config.h\"\n\nstatic inline int lxc_log_priority_to_int(const char* name)\n{\n\tif (!strcasecmp(\"TRACE\",  name)) return LXC_LOG_PRIORITY_TRACE;\n\tif (!strcasecmp(\"DEBUG\",  name)) return LXC_LOG_PRIORITY_DEBUG;\n\tif (!strcasecmp(\"INFO\",   name)) return LXC_LOG_PRIORITY_INFO;\n\tif (!strcasecmp(\"NOTICE\", name)) return LXC_LOG_PRIORITY_NOTICE;\n\tif (!strcasecmp(\"WARN\",   name)) return LXC_LOG_PRIORITY_WARN;\n\tif (!strcasecmp(\"ERROR\",  name)) return LXC_LOG_PRIORITY_ERROR;\n\tif (!strcasecmp(\"CRIT\",   name)) return LXC_LOG_PRIORITY_CRIT;\n\tif (!strcasecmp(\"ALERT\",  name)) return LXC_LOG_PRIORITY_ALERT;\n\tif (!strcasecmp(\"FATAL\",  name)) return LXC_LOG_PRIORITY_FATAL;\n\n\treturn LXC_LOG_PRIORITY_NOTSET;\n}"
  },
  {
    "function_name": "lxc_syslog_priority_to_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/log.h",
    "lines": "158-173",
    "snippet": "static inline const char* lxc_syslog_priority_to_string(int priority)\n{\n\tswitch (priority) {\n\tcase LOG_DAEMON: return \"daemon\";\n\tcase LOG_LOCAL0: return \"local0\";\n\tcase LOG_LOCAL1: return \"local1\";\n\tcase LOG_LOCAL2: return \"local2\";\n\tcase LOG_LOCAL3: return \"local3\";\n\tcase LOG_LOCAL4: return \"local4\";\n\tcase LOG_LOCAL5: return \"local5\";\n\tcase LOG_LOCAL6: return \"local6\";\n\tcase LOG_LOCAL7: return \"local7\";\n\tdefault:\n\t\treturn \"NOTSET\";\n\t}\n}",
    "includes": [
      "#include \"conf.h\"",
      "#include <time.h>",
      "#include <syslog.h>",
      "#include <stdbool.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <sys/time.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"conf.h\"\n#include <time.h>\n#include <syslog.h>\n#include <stdbool.h>\n#include <strings.h>\n#include <string.h>\n#include <sys/time.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"config.h\"\n\nstatic inline const char* lxc_syslog_priority_to_string(int priority)\n{\n\tswitch (priority) {\n\tcase LOG_DAEMON: return \"daemon\";\n\tcase LOG_LOCAL0: return \"local0\";\n\tcase LOG_LOCAL1: return \"local1\";\n\tcase LOG_LOCAL2: return \"local2\";\n\tcase LOG_LOCAL3: return \"local3\";\n\tcase LOG_LOCAL4: return \"local4\";\n\tcase LOG_LOCAL5: return \"local5\";\n\tcase LOG_LOCAL6: return \"local6\";\n\tcase LOG_LOCAL7: return \"local7\";\n\tdefault:\n\t\treturn \"NOTSET\";\n\t}\n}"
  },
  {
    "function_name": "lxc_log_priority_to_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/log.h",
    "lines": "141-156",
    "snippet": "static inline const char* lxc_log_priority_to_string(int priority)\n{\n\tswitch (priority) {\n\tcase LXC_LOG_PRIORITY_TRACE:\treturn \"TRACE\";\n\tcase LXC_LOG_PRIORITY_DEBUG:\treturn \"DEBUG\";\n\tcase LXC_LOG_PRIORITY_INFO:\treturn \"INFO\";\n\tcase LXC_LOG_PRIORITY_NOTICE:\treturn \"NOTICE\";\n\tcase LXC_LOG_PRIORITY_WARN:\treturn \"WARN\";\n\tcase LXC_LOG_PRIORITY_ERROR:\treturn \"ERROR\";\n\tcase LXC_LOG_PRIORITY_CRIT:\treturn \"CRIT\";\n\tcase LXC_LOG_PRIORITY_ALERT:\treturn \"ALERT\";\n\tcase LXC_LOG_PRIORITY_FATAL:\treturn \"FATAL\";\n\tdefault:\n\t\treturn \"NOTSET\";\n\t}\n}",
    "includes": [
      "#include \"conf.h\"",
      "#include <time.h>",
      "#include <syslog.h>",
      "#include <stdbool.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <sys/time.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"conf.h\"\n#include <time.h>\n#include <syslog.h>\n#include <stdbool.h>\n#include <strings.h>\n#include <string.h>\n#include <sys/time.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"config.h\"\n\nstatic inline const char* lxc_log_priority_to_string(int priority)\n{\n\tswitch (priority) {\n\tcase LXC_LOG_PRIORITY_TRACE:\treturn \"TRACE\";\n\tcase LXC_LOG_PRIORITY_DEBUG:\treturn \"DEBUG\";\n\tcase LXC_LOG_PRIORITY_INFO:\treturn \"INFO\";\n\tcase LXC_LOG_PRIORITY_NOTICE:\treturn \"NOTICE\";\n\tcase LXC_LOG_PRIORITY_WARN:\treturn \"WARN\";\n\tcase LXC_LOG_PRIORITY_ERROR:\treturn \"ERROR\";\n\tcase LXC_LOG_PRIORITY_CRIT:\treturn \"CRIT\";\n\tcase LXC_LOG_PRIORITY_ALERT:\treturn \"ALERT\";\n\tcase LXC_LOG_PRIORITY_FATAL:\treturn \"FATAL\";\n\tdefault:\n\t\treturn \"NOTSET\";\n\t}\n}"
  },
  {
    "function_name": "lxc_log_priority_is_enabled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/log.h",
    "lines": "120-136",
    "snippet": "static inline int\nlxc_log_priority_is_enabled(const struct lxc_log_category* category,\n\t\t\t   int priority)\n{\n\twhile (category->priority == LXC_LOG_PRIORITY_NOTSET &&\n\t       category->parent)\n\t\tcategory = category->parent;\n\n\tint cmp_prio = category->priority;\n#ifndef NO_LXC_CONF\n\tif (!lxc_log_use_global_fd && current_config &&\n\t\t\tcurrent_config->loglevel != LXC_LOG_PRIORITY_NOTSET)\n\t\tcmp_prio = current_config->loglevel;\n#endif\n\n\treturn priority >= cmp_prio;\n}",
    "includes": [
      "#include \"conf.h\"",
      "#include <time.h>",
      "#include <syslog.h>",
      "#include <stdbool.h>",
      "#include <strings.h>",
      "#include <string.h>",
      "#include <sys/time.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"conf.h\"\n#include <time.h>\n#include <syslog.h>\n#include <stdbool.h>\n#include <strings.h>\n#include <string.h>\n#include <sys/time.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"config.h\"\n\nstatic inline int\nlxc_log_priority_is_enabled(const struct lxc_log_category* category,\n\t\t\t   int priority)\n{\n\twhile (category->priority == LXC_LOG_PRIORITY_NOTSET &&\n\t       category->parent)\n\t\tcategory = category->parent;\n\n\tint cmp_prio = category->priority;\n#ifndef NO_LXC_CONF\n\tif (!lxc_log_use_global_fd && current_config &&\n\t\t\tcurrent_config->loglevel != LXC_LOG_PRIORITY_NOTSET)\n\t\tcmp_prio = current_config->loglevel;\n#endif\n\n\treturn priority >= cmp_prio;\n}"
  }
]