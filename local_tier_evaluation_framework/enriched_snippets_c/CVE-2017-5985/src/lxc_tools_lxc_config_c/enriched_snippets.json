[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/tools/lxc_config.c",
    "lines": "60-81",
    "snippet": "int main(int argc, char *argv[])\n{\n\tstruct lxc_config_items *i;\n\tconst char *value;\n\n\tif (argc < 2)\n\t\tusage(argv[0]);\n\tif (strcmp(argv[1], \"-l\") == 0)\n\t\tlist_config_items();\n\tfor (i = &items[0]; i->name; i++) {\n\t\tif (strcmp(argv[1], i->name) == 0) {\n\t\t\tvalue = lxc_get_global_config_item(i->name);\n\t\t\tif (value)\n\t\t\t\tprintf(\"%s\\n\", value);\n\t\t\telse\n\t\t\t\tprintf(\"%s is not set.\\n\", argv[1]);\n\t\t\texit(EXIT_SUCCESS);\n\t\t}\n\t}\n\tprintf(\"Unknown configuration item: %s\\n\", argv[1]);\n\texit(EXIT_FAILURE);\n}",
    "includes": [
      "#include \"config.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct lxc_config_items items[] =\n{\n\t{ .name = \"lxc.default_config\", },\n\t{ .name = \"lxc.lxcpath\", },\n\t{ .name = \"lxc.bdev.lvm.vg\", },\n\t{ .name = \"lxc.bdev.lvm.thin_pool\", },\n\t{ .name = \"lxc.bdev.zfs.root\", },\n\t{ .name = \"lxc.cgroup.use\", },\n\t{ .name = \"lxc.cgroup.pattern\", },\n\t{ .name = NULL, },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "EXIT_FAILURE"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Unknown configuration item: %s\\n\"",
            "argv[1]"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "EXIT_SUCCESS"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s is not set.\\n\"",
            "argv[1]"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\\n\"",
            "value"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxc_get_global_config_item",
          "args": [
            "i->name"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "lxc_get_global_config_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/lxccontainer.c",
          "lines": "2618-2621",
          "snippet": "const char *lxc_get_global_config_item(const char *key)\n{\n\treturn lxc_global_config_value(key);\n}",
          "includes": [
            "#include <mntent.h>",
            "#include <../include/lxcmntent.h>",
            "#include <../include/ifaddrs.h>",
            "#include <ifaddrs.h>",
            "#    include <sys/sysmacros.h>",
            "#    include <sys/mkdev.h>",
            "#include \"version.h\"",
            "#include \"utils.h\"",
            "#include \"state.h\"",
            "#include \"sync.h\"",
            "#include \"network.h\"",
            "#include \"namespace.h\"",
            "#include \"monitor.h\"",
            "#include \"lxclock.h\"",
            "#include \"lxccontainer.h\"",
            "#include \"lxc.h\"",
            "#include \"log.h\"",
            "#include \"criu.h\"",
            "#include \"console.h\"",
            "#include \"confile.h\"",
            "#include \"commands.h\"",
            "#include \"config.h\"",
            "#include \"conf.h\"",
            "#include \"cgroup.h\"",
            "#include \"lxcbtrfs.h\"",
            "#include \"lxcoverlay.h\"",
            "#include \"bdev.h\"",
            "#include \"attach.h\"",
            "#include <sys/wait.h>",
            "#include <sys/types.h>",
            "#include <sys/syscall.h>",
            "#include <sys/mount.h>",
            "#include <sys/mman.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include <sched.h>",
            "#include <pthread.h>",
            "#include <libgen.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <mntent.h>\n#include <../include/lxcmntent.h>\n#include <../include/ifaddrs.h>\n#include <ifaddrs.h>\n#    include <sys/sysmacros.h>\n#    include <sys/mkdev.h>\n#include \"version.h\"\n#include \"utils.h\"\n#include \"state.h\"\n#include \"sync.h\"\n#include \"network.h\"\n#include \"namespace.h\"\n#include \"monitor.h\"\n#include \"lxclock.h\"\n#include \"lxccontainer.h\"\n#include \"lxc.h\"\n#include \"log.h\"\n#include \"criu.h\"\n#include \"console.h\"\n#include \"confile.h\"\n#include \"commands.h\"\n#include \"config.h\"\n#include \"conf.h\"\n#include \"cgroup.h\"\n#include \"lxcbtrfs.h\"\n#include \"lxcoverlay.h\"\n#include \"bdev.h\"\n#include \"attach.h\"\n#include <sys/wait.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <sys/mount.h>\n#include <sys/mman.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include <sched.h>\n#include <pthread.h>\n#include <libgen.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n\nconst char *lxc_get_global_config_item(const char *key)\n{\n\treturn lxc_global_config_value(key);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[1]",
            "i->name"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_config_items",
          "args": [],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "list_config_items",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/tools/lxc_config.c",
          "lines": "51-58",
          "snippet": "static void list_config_items(void)\n{\n\tstruct lxc_config_items *i;\n\n\tfor (i = &items[0]; i->name; i++)\n\t\tprintf(\"%s\\n\", i->name);\n\texit(EXIT_SUCCESS);\n}",
          "includes": [
            "#include \"config.h\"",
            "#include <lxc/lxccontainer.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct lxc_config_items items[] =\n{\n\t{ .name = \"lxc.default_config\", },\n\t{ .name = \"lxc.lxcpath\", },\n\t{ .name = \"lxc.bdev.lvm.vg\", },\n\t{ .name = \"lxc.bdev.lvm.thin_pool\", },\n\t{ .name = \"lxc.bdev.zfs.root\", },\n\t{ .name = \"lxc.cgroup.use\", },\n\t{ .name = \"lxc.cgroup.pattern\", },\n\t{ .name = NULL, },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <lxc/lxccontainer.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic struct lxc_config_items items[] =\n{\n\t{ .name = \"lxc.default_config\", },\n\t{ .name = \"lxc.lxcpath\", },\n\t{ .name = \"lxc.bdev.lvm.vg\", },\n\t{ .name = \"lxc.bdev.lvm.thin_pool\", },\n\t{ .name = \"lxc.bdev.zfs.root\", },\n\t{ .name = \"lxc.cgroup.use\", },\n\t{ .name = \"lxc.cgroup.pattern\", },\n\t{ .name = NULL, },\n};\n\nstatic void list_config_items(void)\n{\n\tstruct lxc_config_items *i;\n\n\tfor (i = &items[0]; i->name; i++)\n\t\tprintf(\"%s\\n\", i->name);\n\texit(EXIT_SUCCESS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[1]",
            "\"-l\""
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "usage",
          "args": [
            "argv[0]"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "usage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/tools/lxc_config.c",
          "lines": "44-49",
          "snippet": "static void usage(char *me)\n{\n\tprintf(\"Usage: %s -l: list all available configuration items\\n\", me);\n\tprintf(\"       %s item: print configuration item\\n\", me);\n\texit(EXIT_SUCCESS);\n}",
          "includes": [
            "#include \"config.h\"",
            "#include <lxc/lxccontainer.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct lxc_config_items items[] =\n{\n\t{ .name = \"lxc.default_config\", },\n\t{ .name = \"lxc.lxcpath\", },\n\t{ .name = \"lxc.bdev.lvm.vg\", },\n\t{ .name = \"lxc.bdev.lvm.thin_pool\", },\n\t{ .name = \"lxc.bdev.zfs.root\", },\n\t{ .name = \"lxc.cgroup.use\", },\n\t{ .name = \"lxc.cgroup.pattern\", },\n\t{ .name = NULL, },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <lxc/lxccontainer.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic struct lxc_config_items items[] =\n{\n\t{ .name = \"lxc.default_config\", },\n\t{ .name = \"lxc.lxcpath\", },\n\t{ .name = \"lxc.bdev.lvm.vg\", },\n\t{ .name = \"lxc.bdev.lvm.thin_pool\", },\n\t{ .name = \"lxc.bdev.zfs.root\", },\n\t{ .name = \"lxc.cgroup.use\", },\n\t{ .name = \"lxc.cgroup.pattern\", },\n\t{ .name = NULL, },\n};\n\nstatic void usage(char *me)\n{\n\tprintf(\"Usage: %s -l: list all available configuration items\\n\", me);\n\tprintf(\"       %s item: print configuration item\\n\", me);\n\texit(EXIT_SUCCESS);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <lxc/lxccontainer.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic struct lxc_config_items items[] =\n{\n\t{ .name = \"lxc.default_config\", },\n\t{ .name = \"lxc.lxcpath\", },\n\t{ .name = \"lxc.bdev.lvm.vg\", },\n\t{ .name = \"lxc.bdev.lvm.thin_pool\", },\n\t{ .name = \"lxc.bdev.zfs.root\", },\n\t{ .name = \"lxc.cgroup.use\", },\n\t{ .name = \"lxc.cgroup.pattern\", },\n\t{ .name = NULL, },\n};\n\nint main(int argc, char *argv[])\n{\n\tstruct lxc_config_items *i;\n\tconst char *value;\n\n\tif (argc < 2)\n\t\tusage(argv[0]);\n\tif (strcmp(argv[1], \"-l\") == 0)\n\t\tlist_config_items();\n\tfor (i = &items[0]; i->name; i++) {\n\t\tif (strcmp(argv[1], i->name) == 0) {\n\t\t\tvalue = lxc_get_global_config_item(i->name);\n\t\t\tif (value)\n\t\t\t\tprintf(\"%s\\n\", value);\n\t\t\telse\n\t\t\t\tprintf(\"%s is not set.\\n\", argv[1]);\n\t\t\texit(EXIT_SUCCESS);\n\t\t}\n\t}\n\tprintf(\"Unknown configuration item: %s\\n\", argv[1]);\n\texit(EXIT_FAILURE);\n}"
  },
  {
    "function_name": "list_config_items",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/tools/lxc_config.c",
    "lines": "51-58",
    "snippet": "static void list_config_items(void)\n{\n\tstruct lxc_config_items *i;\n\n\tfor (i = &items[0]; i->name; i++)\n\t\tprintf(\"%s\\n\", i->name);\n\texit(EXIT_SUCCESS);\n}",
    "includes": [
      "#include \"config.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct lxc_config_items items[] =\n{\n\t{ .name = \"lxc.default_config\", },\n\t{ .name = \"lxc.lxcpath\", },\n\t{ .name = \"lxc.bdev.lvm.vg\", },\n\t{ .name = \"lxc.bdev.lvm.thin_pool\", },\n\t{ .name = \"lxc.bdev.zfs.root\", },\n\t{ .name = \"lxc.cgroup.use\", },\n\t{ .name = \"lxc.cgroup.pattern\", },\n\t{ .name = NULL, },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "EXIT_SUCCESS"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\\n\"",
            "i->name"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <lxc/lxccontainer.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic struct lxc_config_items items[] =\n{\n\t{ .name = \"lxc.default_config\", },\n\t{ .name = \"lxc.lxcpath\", },\n\t{ .name = \"lxc.bdev.lvm.vg\", },\n\t{ .name = \"lxc.bdev.lvm.thin_pool\", },\n\t{ .name = \"lxc.bdev.zfs.root\", },\n\t{ .name = \"lxc.cgroup.use\", },\n\t{ .name = \"lxc.cgroup.pattern\", },\n\t{ .name = NULL, },\n};\n\nstatic void list_config_items(void)\n{\n\tstruct lxc_config_items *i;\n\n\tfor (i = &items[0]; i->name; i++)\n\t\tprintf(\"%s\\n\", i->name);\n\texit(EXIT_SUCCESS);\n}"
  },
  {
    "function_name": "usage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/tools/lxc_config.c",
    "lines": "44-49",
    "snippet": "static void usage(char *me)\n{\n\tprintf(\"Usage: %s -l: list all available configuration items\\n\", me);\n\tprintf(\"       %s item: print configuration item\\n\", me);\n\texit(EXIT_SUCCESS);\n}",
    "includes": [
      "#include \"config.h\"",
      "#include <lxc/lxccontainer.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct lxc_config_items items[] =\n{\n\t{ .name = \"lxc.default_config\", },\n\t{ .name = \"lxc.lxcpath\", },\n\t{ .name = \"lxc.bdev.lvm.vg\", },\n\t{ .name = \"lxc.bdev.lvm.thin_pool\", },\n\t{ .name = \"lxc.bdev.zfs.root\", },\n\t{ .name = \"lxc.cgroup.use\", },\n\t{ .name = \"lxc.cgroup.pattern\", },\n\t{ .name = NULL, },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "EXIT_SUCCESS"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"       %s item: print configuration item\\n\"",
            "me"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Usage: %s -l: list all available configuration items\\n\"",
            "me"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <lxc/lxccontainer.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic struct lxc_config_items items[] =\n{\n\t{ .name = \"lxc.default_config\", },\n\t{ .name = \"lxc.lxcpath\", },\n\t{ .name = \"lxc.bdev.lvm.vg\", },\n\t{ .name = \"lxc.bdev.lvm.thin_pool\", },\n\t{ .name = \"lxc.bdev.zfs.root\", },\n\t{ .name = \"lxc.cgroup.use\", },\n\t{ .name = \"lxc.cgroup.pattern\", },\n\t{ .name = NULL, },\n};\n\nstatic void usage(char *me)\n{\n\tprintf(\"Usage: %s -l: list all available configuration items\\n\", me);\n\tprintf(\"       %s item: print configuration item\\n\", me);\n\texit(EXIT_SUCCESS);\n}"
  }
]