[
  {
    "function_name": "am_unpriv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.h",
    "lines": "288-290",
    "snippet": "inline static bool am_unpriv(void) {\n\treturn geteuid() != 0;\n}",
    "includes": [
      "#include <stdint.h>",
      "#  include <sys/signalfd.h>",
      "#include <../include/getline.h>",
      "#include \"initutils.h\"",
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <sys/syscall.h>",
      "#include <stdbool.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#  include <sys/signalfd.h>\n#include <../include/getline.h>\n#include \"initutils.h\"\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"config.h\"\n\ninline static bool am_unpriv(void) {\n\treturn geteuid() != 0;\n}"
  },
  {
    "function_name": "signalfd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.h",
    "lines": "155-163",
    "snippet": "static inline int signalfd(int fd, const sigset_t *mask, int flags)\n{\n\tint retval;\n\n\tretval = syscall (__NR_signalfd4, fd, mask, _NSIG / 8, flags);\n\tif (errno == ENOSYS && flags == 0)\n\t\tretval = syscall (__NR_signalfd, fd, mask, _NSIG / 8);\n\treturn retval;\n}",
    "includes": [
      "#include <stdint.h>",
      "#  include <sys/signalfd.h>",
      "#include <../include/getline.h>",
      "#include \"initutils.h\"",
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <sys/syscall.h>",
      "#include <stdbool.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "__NR_signalfd",
            "fd",
            "mask",
            "_NSIG / 8"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "__NR_signalfd4",
            "fd",
            "mask",
            "_NSIG / 8",
            "flags"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#  include <sys/signalfd.h>\n#include <../include/getline.h>\n#include \"initutils.h\"\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"config.h\"\n\nstatic inline int signalfd(int fd, const sigset_t *mask, int flags)\n{\n\tint retval;\n\n\tretval = syscall (__NR_signalfd4, fd, mask, _NSIG / 8, flags);\n\tif (errno == ENOSYS && flags == 0)\n\t\tretval = syscall (__NR_signalfd, fd, mask, _NSIG / 8);\n\treturn retval;\n}"
  },
  {
    "function_name": "unshare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.h",
    "lines": "73-81",
    "snippet": "static inline int unshare(int flags)\n{\n#ifdef __NR_unshare\n\treturn syscall(__NR_unshare, flags);\n#else\n\terrno = ENOSYS;\n\treturn -1;\n#endif\n}",
    "includes": [
      "#include <stdint.h>",
      "#  include <sys/signalfd.h>",
      "#include <../include/getline.h>",
      "#include \"initutils.h\"",
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <sys/syscall.h>",
      "#include <stdbool.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "__NR_unshare",
            "flags"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#  include <sys/signalfd.h>\n#include <../include/getline.h>\n#include \"initutils.h\"\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"config.h\"\n\nstatic inline int unshare(int flags)\n{\n#ifdef __NR_unshare\n\treturn syscall(__NR_unshare, flags);\n#else\n\terrno = ENOSYS;\n\treturn -1;\n#endif\n}"
  },
  {
    "function_name": "setns",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2017-5985/repo/src/lxc/utils.h",
    "lines": "58-68",
    "snippet": "static inline int setns(int fd, int nstype)\n{\n#ifdef __NR_setns\n\treturn syscall(__NR_setns, fd, nstype);\n#elif defined(__NR_set_ns)\n\treturn syscall(__NR_set_ns, fd, nstype);\n#else\n\terrno = ENOSYS;\n\treturn -1;\n#endif\n}",
    "includes": [
      "#include <stdint.h>",
      "#  include <sys/signalfd.h>",
      "#include <../include/getline.h>",
      "#include \"initutils.h\"",
      "#include <unistd.h>",
      "#include <sys/types.h>",
      "#include <sys/syscall.h>",
      "#include <stdbool.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "__NR_set_ns",
            "fd",
            "nstype"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "__NR_setns",
            "fd",
            "nstype"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdint.h>\n#  include <sys/signalfd.h>\n#include <../include/getline.h>\n#include \"initutils.h\"\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/syscall.h>\n#include <stdbool.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"config.h\"\n\nstatic inline int setns(int fd, int nstype)\n{\n#ifdef __NR_setns\n\treturn syscall(__NR_setns, fd, nstype);\n#elif defined(__NR_set_ns)\n\treturn syscall(__NR_set_ns, fd, nstype);\n#else\n\terrno = ENOSYS;\n\treturn -1;\n#endif\n}"
  }
]