[
  {
    "function_name": "cs_cmd_devoice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/voice.c",
    "lines": "127-137",
    "snippet": "static void cs_cmd_devoice(sourceinfo_t *si, int parc, char *parv[])\n{\n\tif (!parv[0])\n\t{\n\t\tcommand_fail(si, fault_needmoreparams, STR_INSUFFICIENT_PARAMS, \"DEVOICE\");\n\t\tcommand_fail(si, fault_needmoreparams, _(\"Syntax: DEVOICE <#channel> [nickname] [...]\"));\n\t\treturn;\n\t}\n\n\tcmd_voice(si, false, parc, parv);\n}",
    "includes": [
      "#include \"chanserv.h\"",
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void cs_cmd_voice(sourceinfo_t *si, int parc, char *parv[]);",
      "static void cs_cmd_devoice(sourceinfo_t *si, int parc, char *parv[]);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cmd_voice",
          "args": [
            "si",
            "false",
            "parc",
            "parv"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "cmd_voice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/voice.c",
          "lines": "41-113",
          "snippet": "static void cmd_voice(sourceinfo_t *si, bool voicing, int parc, char *parv[])\n{\n\tchar *chan = parv[0];\n\tchar *nick = parv[1];\n\tchar *nicks;\n\tbool voice;\n\tmychan_t *mc;\n\tuser_t *tu;\n\tchanuser_t *cu;\n\tmowgli_node_t *n;\n\n\tmc = mychan_find(chan);\n\tif (!mc)\n\t{\n\t\tcommand_fail(si, fault_nosuch_target, _(\"Channel \\2%s\\2 is not registered.\"), chan);\n\t\treturn;\n\t}\n\n\tif (metadata_find(mc, \"private:close:closer\"))\n\t{\n\t\tcommand_fail(si, fault_noprivs, _(\"\\2%s\\2 is closed.\"), chan);\n\t\treturn;\n\t}\n\n\tnicks = (!nick ? strdup(si->su->nick) : strdup(nick));\n\tprefix_action_set_all(&voice_actions, voicing, nicks);\n\tfree(nicks);\n\n\tMOWGLI_LIST_FOREACH(n, voice_actions.head)\n\t{\n\t\tstruct prefix_action *act = n->data;\n\t\tnick = act->nick;\n\t\tvoice = act->en;\n\n\t\t/* figure out who we're going to voice */\n\t\tif (!(tu = user_find_named(nick)))\n\t\t{\n\t\t\tcommand_fail(si, fault_nosuch_target, _(\"\\2%s\\2 is not online.\"), nick);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!chanacs_source_has_flag(mc, si, CA_VOICE) && (tu != si->su || !chanacs_source_has_flag(mc, si, CA_AUTOVOICE)))\n\t\t{\n\t\t\tcommand_fail(si, fault_noprivs, _(\"You are not authorized to (de)voice \\2%s\\2 on \\2%s\\2.\"), nick, mc->name);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (is_internal_client(tu))\n\t\t\tcontinue;\n\n\t\tcu = chanuser_find(mc->chan, tu);\n\t\tif (!cu)\n\t\t{\n\t\t\tcommand_fail(si, fault_nosuch_target, _(\"\\2%s\\2 is not on \\2%s\\2.\"), tu->nick, mc->name);\n\t\t\tcontinue;\n\t\t}\n\n\t\tmodestack_mode_param(chansvs.nick, mc->chan, voice ? MTYPE_ADD : MTYPE_DEL, 'v', CLIENT_NAME(tu));\n\t\tif (voice)\n\t\t\tcu->modes |= CSTATUS_VOICE;\n\t\telse\n\t\t\tcu->modes &= ~CSTATUS_VOICE;\n\n\t\tif (si->c == NULL && tu != si->su)\n\t\t\tchange_notify(chansvs.nick, tu, \"You have been %svoiced on %s by %s\", voice ? \"\" : \"de\", mc->name, get_source_name(si));\n\n\t\tlogcommand(si, CMDLOG_DO, \"%sVOICE: \\2%s!%s@%s\\2 on \\2%s\\2\", voice ? \"\": \"DE\", tu->nick, tu->user, tu->vhost, mc->name);\n\t\tif (si->su == NULL || !chanuser_find(mc->chan, si->su))\n\t\t\tcommand_success_nodata(si, _(\"\\2%s\\2 has been %svoiced on \\2%s\\2.\"), tu->nick, voice ? \"\" : \"de\", mc->name);\n\t}\n\n\tprefix_action_clear(&voice_actions);\n}",
          "includes": [
            "#include \"chanserv.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void cs_cmd_voice(sourceinfo_t *si, int parc, char *parv[]);",
            "static void cs_cmd_devoice(sourceinfo_t *si, int parc, char *parv[]);",
            "static mowgli_list_t voice_actions;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic void cs_cmd_voice(sourceinfo_t *si, int parc, char *parv[]);\nstatic void cs_cmd_devoice(sourceinfo_t *si, int parc, char *parv[]);\nstatic mowgli_list_t voice_actions;\n\nstatic void cmd_voice(sourceinfo_t *si, bool voicing, int parc, char *parv[])\n{\n\tchar *chan = parv[0];\n\tchar *nick = parv[1];\n\tchar *nicks;\n\tbool voice;\n\tmychan_t *mc;\n\tuser_t *tu;\n\tchanuser_t *cu;\n\tmowgli_node_t *n;\n\n\tmc = mychan_find(chan);\n\tif (!mc)\n\t{\n\t\tcommand_fail(si, fault_nosuch_target, _(\"Channel \\2%s\\2 is not registered.\"), chan);\n\t\treturn;\n\t}\n\n\tif (metadata_find(mc, \"private:close:closer\"))\n\t{\n\t\tcommand_fail(si, fault_noprivs, _(\"\\2%s\\2 is closed.\"), chan);\n\t\treturn;\n\t}\n\n\tnicks = (!nick ? strdup(si->su->nick) : strdup(nick));\n\tprefix_action_set_all(&voice_actions, voicing, nicks);\n\tfree(nicks);\n\n\tMOWGLI_LIST_FOREACH(n, voice_actions.head)\n\t{\n\t\tstruct prefix_action *act = n->data;\n\t\tnick = act->nick;\n\t\tvoice = act->en;\n\n\t\t/* figure out who we're going to voice */\n\t\tif (!(tu = user_find_named(nick)))\n\t\t{\n\t\t\tcommand_fail(si, fault_nosuch_target, _(\"\\2%s\\2 is not online.\"), nick);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!chanacs_source_has_flag(mc, si, CA_VOICE) && (tu != si->su || !chanacs_source_has_flag(mc, si, CA_AUTOVOICE)))\n\t\t{\n\t\t\tcommand_fail(si, fault_noprivs, _(\"You are not authorized to (de)voice \\2%s\\2 on \\2%s\\2.\"), nick, mc->name);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (is_internal_client(tu))\n\t\t\tcontinue;\n\n\t\tcu = chanuser_find(mc->chan, tu);\n\t\tif (!cu)\n\t\t{\n\t\t\tcommand_fail(si, fault_nosuch_target, _(\"\\2%s\\2 is not on \\2%s\\2.\"), tu->nick, mc->name);\n\t\t\tcontinue;\n\t\t}\n\n\t\tmodestack_mode_param(chansvs.nick, mc->chan, voice ? MTYPE_ADD : MTYPE_DEL, 'v', CLIENT_NAME(tu));\n\t\tif (voice)\n\t\t\tcu->modes |= CSTATUS_VOICE;\n\t\telse\n\t\t\tcu->modes &= ~CSTATUS_VOICE;\n\n\t\tif (si->c == NULL && tu != si->su)\n\t\t\tchange_notify(chansvs.nick, tu, \"You have been %svoiced on %s by %s\", voice ? \"\" : \"de\", mc->name, get_source_name(si));\n\n\t\tlogcommand(si, CMDLOG_DO, \"%sVOICE: \\2%s!%s@%s\\2 on \\2%s\\2\", voice ? \"\": \"DE\", tu->nick, tu->user, tu->vhost, mc->name);\n\t\tif (si->su == NULL || !chanuser_find(mc->chan, si->su))\n\t\t\tcommand_success_nodata(si, _(\"\\2%s\\2 has been %svoiced on \\2%s\\2.\"), tu->nick, voice ? \"\" : \"de\", mc->name);\n\t}\n\n\tprefix_action_clear(&voice_actions);\n}"
        }
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_needmoreparams",
            "_(\"Syntax: DEVOICE <#channel> [nickname] [...]\")"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Syntax: DEVOICE <#channel> [nickname] [...]\""
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "_moddeinit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/voice.c",
          "lines": "33-37",
          "snippet": "void _moddeinit(module_unload_intent_t intent)\n{\n\tservice_named_unbind_command(\"chanserv\", &cs_voice);\n\tservice_named_unbind_command(\"chanserv\", &cs_devoice);\n}",
          "includes": [
            "#include \"chanserv.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "command_t cs_voice = { \"VOICE\", N_(\"Gives channel voice to a user.\"),\n                         AC_NONE, 2, cs_cmd_voice, { .path = \"cservice/op_voice\" } };",
            "command_t cs_devoice = { \"DEVOICE\", N_(\"Removes channel voice from a user.\"),\n                         AC_NONE, 2, cs_cmd_devoice, { .path = \"cservice/op_voice\" } };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\ncommand_t cs_voice = { \"VOICE\", N_(\"Gives channel voice to a user.\"),\n                         AC_NONE, 2, cs_cmd_voice, { .path = \"cservice/op_voice\" } };\ncommand_t cs_devoice = { \"DEVOICE\", N_(\"Removes channel voice from a user.\"),\n                         AC_NONE, 2, cs_cmd_devoice, { .path = \"cservice/op_voice\" } };\n\nvoid _moddeinit(module_unload_intent_t intent)\n{\n\tservice_named_unbind_command(\"chanserv\", &cs_voice);\n\tservice_named_unbind_command(\"chanserv\", &cs_devoice);\n}"
        }
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_needmoreparams",
            "STR_INSUFFICIENT_PARAMS",
            "\"DEVOICE\""
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic void cs_cmd_voice(sourceinfo_t *si, int parc, char *parv[]);\nstatic void cs_cmd_devoice(sourceinfo_t *si, int parc, char *parv[]);\n\nstatic void cs_cmd_devoice(sourceinfo_t *si, int parc, char *parv[])\n{\n\tif (!parv[0])\n\t{\n\t\tcommand_fail(si, fault_needmoreparams, STR_INSUFFICIENT_PARAMS, \"DEVOICE\");\n\t\tcommand_fail(si, fault_needmoreparams, _(\"Syntax: DEVOICE <#channel> [nickname] [...]\"));\n\t\treturn;\n\t}\n\n\tcmd_voice(si, false, parc, parv);\n}"
  },
  {
    "function_name": "cs_cmd_voice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/voice.c",
    "lines": "115-125",
    "snippet": "static void cs_cmd_voice(sourceinfo_t *si, int parc, char *parv[])\n{\n\tif (!parv[0])\n\t{\n\t\tcommand_fail(si, fault_needmoreparams, STR_INSUFFICIENT_PARAMS, \"VOICE\");\n\t\tcommand_fail(si, fault_needmoreparams, _(\"Syntax: VOICE <#channel> [nickname] [...]\"));\n\t\treturn;\n\t}\n\n\tcmd_voice(si, true, parc, parv);\n}",
    "includes": [
      "#include \"chanserv.h\"",
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void cs_cmd_voice(sourceinfo_t *si, int parc, char *parv[]);",
      "static void cs_cmd_devoice(sourceinfo_t *si, int parc, char *parv[]);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cmd_voice",
          "args": [
            "si",
            "true",
            "parc",
            "parv"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "cmd_voice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/voice.c",
          "lines": "41-113",
          "snippet": "static void cmd_voice(sourceinfo_t *si, bool voicing, int parc, char *parv[])\n{\n\tchar *chan = parv[0];\n\tchar *nick = parv[1];\n\tchar *nicks;\n\tbool voice;\n\tmychan_t *mc;\n\tuser_t *tu;\n\tchanuser_t *cu;\n\tmowgli_node_t *n;\n\n\tmc = mychan_find(chan);\n\tif (!mc)\n\t{\n\t\tcommand_fail(si, fault_nosuch_target, _(\"Channel \\2%s\\2 is not registered.\"), chan);\n\t\treturn;\n\t}\n\n\tif (metadata_find(mc, \"private:close:closer\"))\n\t{\n\t\tcommand_fail(si, fault_noprivs, _(\"\\2%s\\2 is closed.\"), chan);\n\t\treturn;\n\t}\n\n\tnicks = (!nick ? strdup(si->su->nick) : strdup(nick));\n\tprefix_action_set_all(&voice_actions, voicing, nicks);\n\tfree(nicks);\n\n\tMOWGLI_LIST_FOREACH(n, voice_actions.head)\n\t{\n\t\tstruct prefix_action *act = n->data;\n\t\tnick = act->nick;\n\t\tvoice = act->en;\n\n\t\t/* figure out who we're going to voice */\n\t\tif (!(tu = user_find_named(nick)))\n\t\t{\n\t\t\tcommand_fail(si, fault_nosuch_target, _(\"\\2%s\\2 is not online.\"), nick);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!chanacs_source_has_flag(mc, si, CA_VOICE) && (tu != si->su || !chanacs_source_has_flag(mc, si, CA_AUTOVOICE)))\n\t\t{\n\t\t\tcommand_fail(si, fault_noprivs, _(\"You are not authorized to (de)voice \\2%s\\2 on \\2%s\\2.\"), nick, mc->name);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (is_internal_client(tu))\n\t\t\tcontinue;\n\n\t\tcu = chanuser_find(mc->chan, tu);\n\t\tif (!cu)\n\t\t{\n\t\t\tcommand_fail(si, fault_nosuch_target, _(\"\\2%s\\2 is not on \\2%s\\2.\"), tu->nick, mc->name);\n\t\t\tcontinue;\n\t\t}\n\n\t\tmodestack_mode_param(chansvs.nick, mc->chan, voice ? MTYPE_ADD : MTYPE_DEL, 'v', CLIENT_NAME(tu));\n\t\tif (voice)\n\t\t\tcu->modes |= CSTATUS_VOICE;\n\t\telse\n\t\t\tcu->modes &= ~CSTATUS_VOICE;\n\n\t\tif (si->c == NULL && tu != si->su)\n\t\t\tchange_notify(chansvs.nick, tu, \"You have been %svoiced on %s by %s\", voice ? \"\" : \"de\", mc->name, get_source_name(si));\n\n\t\tlogcommand(si, CMDLOG_DO, \"%sVOICE: \\2%s!%s@%s\\2 on \\2%s\\2\", voice ? \"\": \"DE\", tu->nick, tu->user, tu->vhost, mc->name);\n\t\tif (si->su == NULL || !chanuser_find(mc->chan, si->su))\n\t\t\tcommand_success_nodata(si, _(\"\\2%s\\2 has been %svoiced on \\2%s\\2.\"), tu->nick, voice ? \"\" : \"de\", mc->name);\n\t}\n\n\tprefix_action_clear(&voice_actions);\n}",
          "includes": [
            "#include \"chanserv.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void cs_cmd_voice(sourceinfo_t *si, int parc, char *parv[]);",
            "static void cs_cmd_devoice(sourceinfo_t *si, int parc, char *parv[]);",
            "static mowgli_list_t voice_actions;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic void cs_cmd_voice(sourceinfo_t *si, int parc, char *parv[]);\nstatic void cs_cmd_devoice(sourceinfo_t *si, int parc, char *parv[]);\nstatic mowgli_list_t voice_actions;\n\nstatic void cmd_voice(sourceinfo_t *si, bool voicing, int parc, char *parv[])\n{\n\tchar *chan = parv[0];\n\tchar *nick = parv[1];\n\tchar *nicks;\n\tbool voice;\n\tmychan_t *mc;\n\tuser_t *tu;\n\tchanuser_t *cu;\n\tmowgli_node_t *n;\n\n\tmc = mychan_find(chan);\n\tif (!mc)\n\t{\n\t\tcommand_fail(si, fault_nosuch_target, _(\"Channel \\2%s\\2 is not registered.\"), chan);\n\t\treturn;\n\t}\n\n\tif (metadata_find(mc, \"private:close:closer\"))\n\t{\n\t\tcommand_fail(si, fault_noprivs, _(\"\\2%s\\2 is closed.\"), chan);\n\t\treturn;\n\t}\n\n\tnicks = (!nick ? strdup(si->su->nick) : strdup(nick));\n\tprefix_action_set_all(&voice_actions, voicing, nicks);\n\tfree(nicks);\n\n\tMOWGLI_LIST_FOREACH(n, voice_actions.head)\n\t{\n\t\tstruct prefix_action *act = n->data;\n\t\tnick = act->nick;\n\t\tvoice = act->en;\n\n\t\t/* figure out who we're going to voice */\n\t\tif (!(tu = user_find_named(nick)))\n\t\t{\n\t\t\tcommand_fail(si, fault_nosuch_target, _(\"\\2%s\\2 is not online.\"), nick);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!chanacs_source_has_flag(mc, si, CA_VOICE) && (tu != si->su || !chanacs_source_has_flag(mc, si, CA_AUTOVOICE)))\n\t\t{\n\t\t\tcommand_fail(si, fault_noprivs, _(\"You are not authorized to (de)voice \\2%s\\2 on \\2%s\\2.\"), nick, mc->name);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (is_internal_client(tu))\n\t\t\tcontinue;\n\n\t\tcu = chanuser_find(mc->chan, tu);\n\t\tif (!cu)\n\t\t{\n\t\t\tcommand_fail(si, fault_nosuch_target, _(\"\\2%s\\2 is not on \\2%s\\2.\"), tu->nick, mc->name);\n\t\t\tcontinue;\n\t\t}\n\n\t\tmodestack_mode_param(chansvs.nick, mc->chan, voice ? MTYPE_ADD : MTYPE_DEL, 'v', CLIENT_NAME(tu));\n\t\tif (voice)\n\t\t\tcu->modes |= CSTATUS_VOICE;\n\t\telse\n\t\t\tcu->modes &= ~CSTATUS_VOICE;\n\n\t\tif (si->c == NULL && tu != si->su)\n\t\t\tchange_notify(chansvs.nick, tu, \"You have been %svoiced on %s by %s\", voice ? \"\" : \"de\", mc->name, get_source_name(si));\n\n\t\tlogcommand(si, CMDLOG_DO, \"%sVOICE: \\2%s!%s@%s\\2 on \\2%s\\2\", voice ? \"\": \"DE\", tu->nick, tu->user, tu->vhost, mc->name);\n\t\tif (si->su == NULL || !chanuser_find(mc->chan, si->su))\n\t\t\tcommand_success_nodata(si, _(\"\\2%s\\2 has been %svoiced on \\2%s\\2.\"), tu->nick, voice ? \"\" : \"de\", mc->name);\n\t}\n\n\tprefix_action_clear(&voice_actions);\n}"
        }
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_needmoreparams",
            "_(\"Syntax: VOICE <#channel> [nickname] [...]\")"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Syntax: VOICE <#channel> [nickname] [...]\""
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "_moddeinit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/voice.c",
          "lines": "33-37",
          "snippet": "void _moddeinit(module_unload_intent_t intent)\n{\n\tservice_named_unbind_command(\"chanserv\", &cs_voice);\n\tservice_named_unbind_command(\"chanserv\", &cs_devoice);\n}",
          "includes": [
            "#include \"chanserv.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "command_t cs_voice = { \"VOICE\", N_(\"Gives channel voice to a user.\"),\n                         AC_NONE, 2, cs_cmd_voice, { .path = \"cservice/op_voice\" } };",
            "command_t cs_devoice = { \"DEVOICE\", N_(\"Removes channel voice from a user.\"),\n                         AC_NONE, 2, cs_cmd_devoice, { .path = \"cservice/op_voice\" } };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\ncommand_t cs_voice = { \"VOICE\", N_(\"Gives channel voice to a user.\"),\n                         AC_NONE, 2, cs_cmd_voice, { .path = \"cservice/op_voice\" } };\ncommand_t cs_devoice = { \"DEVOICE\", N_(\"Removes channel voice from a user.\"),\n                         AC_NONE, 2, cs_cmd_devoice, { .path = \"cservice/op_voice\" } };\n\nvoid _moddeinit(module_unload_intent_t intent)\n{\n\tservice_named_unbind_command(\"chanserv\", &cs_voice);\n\tservice_named_unbind_command(\"chanserv\", &cs_devoice);\n}"
        }
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_needmoreparams",
            "STR_INSUFFICIENT_PARAMS",
            "\"VOICE\""
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic void cs_cmd_voice(sourceinfo_t *si, int parc, char *parv[]);\nstatic void cs_cmd_devoice(sourceinfo_t *si, int parc, char *parv[]);\n\nstatic void cs_cmd_voice(sourceinfo_t *si, int parc, char *parv[])\n{\n\tif (!parv[0])\n\t{\n\t\tcommand_fail(si, fault_needmoreparams, STR_INSUFFICIENT_PARAMS, \"VOICE\");\n\t\tcommand_fail(si, fault_needmoreparams, _(\"Syntax: VOICE <#channel> [nickname] [...]\"));\n\t\treturn;\n\t}\n\n\tcmd_voice(si, true, parc, parv);\n}"
  },
  {
    "function_name": "cmd_voice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/voice.c",
    "lines": "41-113",
    "snippet": "static void cmd_voice(sourceinfo_t *si, bool voicing, int parc, char *parv[])\n{\n\tchar *chan = parv[0];\n\tchar *nick = parv[1];\n\tchar *nicks;\n\tbool voice;\n\tmychan_t *mc;\n\tuser_t *tu;\n\tchanuser_t *cu;\n\tmowgli_node_t *n;\n\n\tmc = mychan_find(chan);\n\tif (!mc)\n\t{\n\t\tcommand_fail(si, fault_nosuch_target, _(\"Channel \\2%s\\2 is not registered.\"), chan);\n\t\treturn;\n\t}\n\n\tif (metadata_find(mc, \"private:close:closer\"))\n\t{\n\t\tcommand_fail(si, fault_noprivs, _(\"\\2%s\\2 is closed.\"), chan);\n\t\treturn;\n\t}\n\n\tnicks = (!nick ? strdup(si->su->nick) : strdup(nick));\n\tprefix_action_set_all(&voice_actions, voicing, nicks);\n\tfree(nicks);\n\n\tMOWGLI_LIST_FOREACH(n, voice_actions.head)\n\t{\n\t\tstruct prefix_action *act = n->data;\n\t\tnick = act->nick;\n\t\tvoice = act->en;\n\n\t\t/* figure out who we're going to voice */\n\t\tif (!(tu = user_find_named(nick)))\n\t\t{\n\t\t\tcommand_fail(si, fault_nosuch_target, _(\"\\2%s\\2 is not online.\"), nick);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!chanacs_source_has_flag(mc, si, CA_VOICE) && (tu != si->su || !chanacs_source_has_flag(mc, si, CA_AUTOVOICE)))\n\t\t{\n\t\t\tcommand_fail(si, fault_noprivs, _(\"You are not authorized to (de)voice \\2%s\\2 on \\2%s\\2.\"), nick, mc->name);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (is_internal_client(tu))\n\t\t\tcontinue;\n\n\t\tcu = chanuser_find(mc->chan, tu);\n\t\tif (!cu)\n\t\t{\n\t\t\tcommand_fail(si, fault_nosuch_target, _(\"\\2%s\\2 is not on \\2%s\\2.\"), tu->nick, mc->name);\n\t\t\tcontinue;\n\t\t}\n\n\t\tmodestack_mode_param(chansvs.nick, mc->chan, voice ? MTYPE_ADD : MTYPE_DEL, 'v', CLIENT_NAME(tu));\n\t\tif (voice)\n\t\t\tcu->modes |= CSTATUS_VOICE;\n\t\telse\n\t\t\tcu->modes &= ~CSTATUS_VOICE;\n\n\t\tif (si->c == NULL && tu != si->su)\n\t\t\tchange_notify(chansvs.nick, tu, \"You have been %svoiced on %s by %s\", voice ? \"\" : \"de\", mc->name, get_source_name(si));\n\n\t\tlogcommand(si, CMDLOG_DO, \"%sVOICE: \\2%s!%s@%s\\2 on \\2%s\\2\", voice ? \"\": \"DE\", tu->nick, tu->user, tu->vhost, mc->name);\n\t\tif (si->su == NULL || !chanuser_find(mc->chan, si->su))\n\t\t\tcommand_success_nodata(si, _(\"\\2%s\\2 has been %svoiced on \\2%s\\2.\"), tu->nick, voice ? \"\" : \"de\", mc->name);\n\t}\n\n\tprefix_action_clear(&voice_actions);\n}",
    "includes": [
      "#include \"chanserv.h\"",
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void cs_cmd_voice(sourceinfo_t *si, int parc, char *parv[]);",
      "static void cs_cmd_devoice(sourceinfo_t *si, int parc, char *parv[]);",
      "static mowgli_list_t voice_actions;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "prefix_action_clear",
          "args": [
            "&voice_actions"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "prefix_action_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/chanserv.h",
          "lines": "72-82",
          "snippet": "static inline void prefix_action_clear(mowgli_list_t *actions)\n{\n\tmowgli_node_t *n, *tn;\n\n\tMOWGLI_LIST_FOREACH_SAFE(n, tn, actions->head)\n\t{\n\t\tfree(n->data);\n\t\tmowgli_node_delete(n, actions);\n\t\tmowgli_node_free(n);\n\t}\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void prefix_action_clear(mowgli_list_t *actions)\n{\n\tmowgli_node_t *n, *tn;\n\n\tMOWGLI_LIST_FOREACH_SAFE(n, tn, actions->head)\n\t{\n\t\tfree(n->data);\n\t\tmowgli_node_delete(n, actions);\n\t\tmowgli_node_free(n);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"\\2%s\\2 has been %svoiced on \\2%s\\2.\")",
            "tu->nick",
            "voice ? \"\" : \"de\"",
            "mc->name"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"\\2%s\\2 has been %svoiced on \\2%s\\2.\""
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "_moddeinit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/voice.c",
          "lines": "33-37",
          "snippet": "void _moddeinit(module_unload_intent_t intent)\n{\n\tservice_named_unbind_command(\"chanserv\", &cs_voice);\n\tservice_named_unbind_command(\"chanserv\", &cs_devoice);\n}",
          "includes": [
            "#include \"chanserv.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "command_t cs_voice = { \"VOICE\", N_(\"Gives channel voice to a user.\"),\n                         AC_NONE, 2, cs_cmd_voice, { .path = \"cservice/op_voice\" } };",
            "command_t cs_devoice = { \"DEVOICE\", N_(\"Removes channel voice from a user.\"),\n                         AC_NONE, 2, cs_cmd_devoice, { .path = \"cservice/op_voice\" } };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\ncommand_t cs_voice = { \"VOICE\", N_(\"Gives channel voice to a user.\"),\n                         AC_NONE, 2, cs_cmd_voice, { .path = \"cservice/op_voice\" } };\ncommand_t cs_devoice = { \"DEVOICE\", N_(\"Removes channel voice from a user.\"),\n                         AC_NONE, 2, cs_cmd_devoice, { .path = \"cservice/op_voice\" } };\n\nvoid _moddeinit(module_unload_intent_t intent)\n{\n\tservice_named_unbind_command(\"chanserv\", &cs_voice);\n\tservice_named_unbind_command(\"chanserv\", &cs_devoice);\n}"
        }
      },
      {
        "call_info": {
          "callee": "chanuser_find",
          "args": [
            "mc->chan",
            "si->su"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "logcommand",
          "args": [
            "si",
            "CMDLOG_DO",
            "\"%sVOICE: \\2%s!%s@%s\\2 on \\2%s\\2\"",
            "voice ? \"\": \"DE\"",
            "tu->nick",
            "tu->user",
            "tu->vhost",
            "mc->name"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "change_notify",
          "args": [
            "chansvs.nick",
            "tu",
            "\"You have been %svoiced on %s by %s\"",
            "voice ? \"\" : \"de\"",
            "mc->name",
            "get_source_name(si)"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_source_name",
          "args": [
            "si"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "modestack_mode_param",
          "args": [
            "chansvs.nick",
            "mc->chan",
            "voice ? MTYPE_ADD : MTYPE_DEL",
            "'v'",
            "CLIENT_NAME(tu)"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CLIENT_NAME",
          "args": [
            "tu"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_nosuch_target",
            "_(\"\\2%s\\2 is not on \\2%s\\2.\")",
            "tu->nick",
            "mc->name"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chanuser_find",
          "args": [
            "mc->chan",
            "tu"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_internal_client",
          "args": [
            "tu"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_noprivs",
            "_(\"You are not authorized to (de)voice \\2%s\\2 on \\2%s\\2.\")",
            "nick",
            "mc->name"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chanacs_source_has_flag",
          "args": [
            "mc",
            "si",
            "CA_AUTOVOICE"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chanacs_source_has_flag",
          "args": [
            "mc",
            "si",
            "CA_VOICE"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_nosuch_target",
            "_(\"\\2%s\\2 is not online.\")",
            "nick"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "user_find_named",
          "args": [
            "nick"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MOWGLI_LIST_FOREACH",
          "args": [
            "n",
            "voice_actions.head"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "nicks"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "free_template_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/access.c",
          "lines": "358-371",
          "snippet": "static void free_template_list(mowgli_list_t *l)\n{\n\tmowgli_node_t *n, *tn;\n\n\treturn_if_fail(l != NULL);\n\n\tMOWGLI_ITER_FOREACH_SAFE(n, tn, l->head)\n\t{\n\t\ttemplate_t *t = n->data;\n\n\t\tmowgli_node_delete(&t->node, l);\n\t\tfree(t);\n\t}\n}",
          "includes": [
            "#include \"template.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"template.h\"\n#include \"atheme.h\"\n\nstatic void free_template_list(mowgli_list_t *l)\n{\n\tmowgli_node_t *n, *tn;\n\n\treturn_if_fail(l != NULL);\n\n\tMOWGLI_ITER_FOREACH_SAFE(n, tn, l->head)\n\t{\n\t\ttemplate_t *t = n->data;\n\n\t\tmowgli_node_delete(&t->node, l);\n\t\tfree(t);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "prefix_action_set_all",
          "args": [
            "&voice_actions",
            "voicing",
            "nicks"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "prefix_action_set_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/chanserv.h",
          "lines": "43-70",
          "snippet": "static inline void prefix_action_set_all(mowgli_list_t *actions, bool dfl, char *nicks)\n{\n\tchar *nick, *strtokctx = NULL;\n\tbool en;\n\n\tnick = strtok_r(nicks, \" \", &strtokctx);\n\tdo\n\t{\n\t\tswitch (*nick)\n\t\t{\n\t\tcase '-':\n\t\t\ten = false;\n\t\t\tnick++;\n\t\t\tbreak;\n\t\tcase '+':\n\t\t\ten = true;\n\t\t\tnick++;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\ten = dfl;\n\t\t}\n\n\t\tif (!strcmp(nick, \"\"))\n\t\t\tcontinue;\n\n\t\tprefix_action_set(actions, nick, en);\n\t} while ((nick = strtok_r(NULL, \" \", &strtokctx)) != NULL);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void prefix_action_set_all(mowgli_list_t *actions, bool dfl, char *nicks)\n{\n\tchar *nick, *strtokctx = NULL;\n\tbool en;\n\n\tnick = strtok_r(nicks, \" \", &strtokctx);\n\tdo\n\t{\n\t\tswitch (*nick)\n\t\t{\n\t\tcase '-':\n\t\t\ten = false;\n\t\t\tnick++;\n\t\t\tbreak;\n\t\tcase '+':\n\t\t\ten = true;\n\t\t\tnick++;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\ten = dfl;\n\t\t}\n\n\t\tif (!strcmp(nick, \"\"))\n\t\t\tcontinue;\n\n\t\tprefix_action_set(actions, nick, en);\n\t} while ((nick = strtok_r(NULL, \" \", &strtokctx)) != NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "nick"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "si->su->nick"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_noprivs",
            "_(\"\\2%s\\2 is closed.\")",
            "chan"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_find",
          "args": [
            "mc",
            "\"private:close:closer\""
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_nosuch_target",
            "_(\"Channel \\2%s\\2 is not registered.\")",
            "chan"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mychan_find",
          "args": [
            "chan"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic void cs_cmd_voice(sourceinfo_t *si, int parc, char *parv[]);\nstatic void cs_cmd_devoice(sourceinfo_t *si, int parc, char *parv[]);\nstatic mowgli_list_t voice_actions;\n\nstatic void cmd_voice(sourceinfo_t *si, bool voicing, int parc, char *parv[])\n{\n\tchar *chan = parv[0];\n\tchar *nick = parv[1];\n\tchar *nicks;\n\tbool voice;\n\tmychan_t *mc;\n\tuser_t *tu;\n\tchanuser_t *cu;\n\tmowgli_node_t *n;\n\n\tmc = mychan_find(chan);\n\tif (!mc)\n\t{\n\t\tcommand_fail(si, fault_nosuch_target, _(\"Channel \\2%s\\2 is not registered.\"), chan);\n\t\treturn;\n\t}\n\n\tif (metadata_find(mc, \"private:close:closer\"))\n\t{\n\t\tcommand_fail(si, fault_noprivs, _(\"\\2%s\\2 is closed.\"), chan);\n\t\treturn;\n\t}\n\n\tnicks = (!nick ? strdup(si->su->nick) : strdup(nick));\n\tprefix_action_set_all(&voice_actions, voicing, nicks);\n\tfree(nicks);\n\n\tMOWGLI_LIST_FOREACH(n, voice_actions.head)\n\t{\n\t\tstruct prefix_action *act = n->data;\n\t\tnick = act->nick;\n\t\tvoice = act->en;\n\n\t\t/* figure out who we're going to voice */\n\t\tif (!(tu = user_find_named(nick)))\n\t\t{\n\t\t\tcommand_fail(si, fault_nosuch_target, _(\"\\2%s\\2 is not online.\"), nick);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!chanacs_source_has_flag(mc, si, CA_VOICE) && (tu != si->su || !chanacs_source_has_flag(mc, si, CA_AUTOVOICE)))\n\t\t{\n\t\t\tcommand_fail(si, fault_noprivs, _(\"You are not authorized to (de)voice \\2%s\\2 on \\2%s\\2.\"), nick, mc->name);\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (is_internal_client(tu))\n\t\t\tcontinue;\n\n\t\tcu = chanuser_find(mc->chan, tu);\n\t\tif (!cu)\n\t\t{\n\t\t\tcommand_fail(si, fault_nosuch_target, _(\"\\2%s\\2 is not on \\2%s\\2.\"), tu->nick, mc->name);\n\t\t\tcontinue;\n\t\t}\n\n\t\tmodestack_mode_param(chansvs.nick, mc->chan, voice ? MTYPE_ADD : MTYPE_DEL, 'v', CLIENT_NAME(tu));\n\t\tif (voice)\n\t\t\tcu->modes |= CSTATUS_VOICE;\n\t\telse\n\t\t\tcu->modes &= ~CSTATUS_VOICE;\n\n\t\tif (si->c == NULL && tu != si->su)\n\t\t\tchange_notify(chansvs.nick, tu, \"You have been %svoiced on %s by %s\", voice ? \"\" : \"de\", mc->name, get_source_name(si));\n\n\t\tlogcommand(si, CMDLOG_DO, \"%sVOICE: \\2%s!%s@%s\\2 on \\2%s\\2\", voice ? \"\": \"DE\", tu->nick, tu->user, tu->vhost, mc->name);\n\t\tif (si->su == NULL || !chanuser_find(mc->chan, si->su))\n\t\t\tcommand_success_nodata(si, _(\"\\2%s\\2 has been %svoiced on \\2%s\\2.\"), tu->nick, voice ? \"\" : \"de\", mc->name);\n\t}\n\n\tprefix_action_clear(&voice_actions);\n}"
  },
  {
    "function_name": "_moddeinit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/voice.c",
    "lines": "33-37",
    "snippet": "void _moddeinit(module_unload_intent_t intent)\n{\n\tservice_named_unbind_command(\"chanserv\", &cs_voice);\n\tservice_named_unbind_command(\"chanserv\", &cs_devoice);\n}",
    "includes": [
      "#include \"chanserv.h\"",
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "command_t cs_voice = { \"VOICE\", N_(\"Gives channel voice to a user.\"),\n                         AC_NONE, 2, cs_cmd_voice, { .path = \"cservice/op_voice\" } };",
      "command_t cs_devoice = { \"DEVOICE\", N_(\"Removes channel voice from a user.\"),\n                         AC_NONE, 2, cs_cmd_devoice, { .path = \"cservice/op_voice\" } };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "service_named_unbind_command",
          "args": [
            "\"chanserv\"",
            "&cs_devoice"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "service_named_unbind_command",
          "args": [
            "\"chanserv\"",
            "&cs_voice"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\ncommand_t cs_voice = { \"VOICE\", N_(\"Gives channel voice to a user.\"),\n                         AC_NONE, 2, cs_cmd_voice, { .path = \"cservice/op_voice\" } };\ncommand_t cs_devoice = { \"DEVOICE\", N_(\"Removes channel voice from a user.\"),\n                         AC_NONE, 2, cs_cmd_devoice, { .path = \"cservice/op_voice\" } };\n\nvoid _moddeinit(module_unload_intent_t intent)\n{\n\tservice_named_unbind_command(\"chanserv\", &cs_voice);\n\tservice_named_unbind_command(\"chanserv\", &cs_devoice);\n}"
  },
  {
    "function_name": "_modinit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/voice.c",
    "lines": "27-31",
    "snippet": "void _modinit(module_t *m)\n{\n        service_named_bind_command(\"chanserv\", &cs_voice);\n        service_named_bind_command(\"chanserv\", &cs_devoice);\n}",
    "includes": [
      "#include \"chanserv.h\"",
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "command_t cs_voice = { \"VOICE\", N_(\"Gives channel voice to a user.\"),\n                         AC_NONE, 2, cs_cmd_voice, { .path = \"cservice/op_voice\" } };",
      "command_t cs_devoice = { \"DEVOICE\", N_(\"Removes channel voice from a user.\"),\n                         AC_NONE, 2, cs_cmd_devoice, { .path = \"cservice/op_voice\" } };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "service_named_bind_command",
          "args": [
            "\"chanserv\"",
            "&cs_devoice"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "service_named_bind_command",
          "args": [
            "\"chanserv\"",
            "&cs_voice"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\ncommand_t cs_voice = { \"VOICE\", N_(\"Gives channel voice to a user.\"),\n                         AC_NONE, 2, cs_cmd_voice, { .path = \"cservice/op_voice\" } };\ncommand_t cs_devoice = { \"DEVOICE\", N_(\"Removes channel voice from a user.\"),\n                         AC_NONE, 2, cs_cmd_devoice, { .path = \"cservice/op_voice\" } };\n\nvoid _modinit(module_t *m)\n{\n        service_named_bind_command(\"chanserv\", &cs_voice);\n        service_named_bind_command(\"chanserv\", &cs_devoice);\n}"
  }
]