[
  {
    "function_name": "_modinit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/successor_acl.c",
    "lines": "43-56",
    "snippet": "void _modinit(module_t *m)\n{\n\tm->mflags = MODTYPE_CORE;\n\n\tif ((successor_flag = flags_associate('S', 0, false, \"successor\")) == 0)\n\t{\n\t\tslog(LG_ERROR, \"chanserv/successor_acl: Inserting +S into flagset failed.\");\n\t\texit(EXIT_FAILURE);\n\t}\n\n\tslog(LG_DEBUG, \"chanserv/successor_acl: +S has been inserted with bitmask 0x%x\", successor_flag);\n\thook_add_first_channel_pick_successor(channel_pick_successor_hook);\n\thook_add_channel_succession(channel_succession_hook);\n}",
    "includes": [
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int successor_flag = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hook_add_channel_succession",
          "args": [
            "channel_succession_hook"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hook_add_first_channel_pick_successor",
          "args": [
            "channel_pick_successor_hook"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slog",
          "args": [
            "LG_DEBUG",
            "\"chanserv/successor_acl: +S has been inserted with bitmask 0x%x\"",
            "successor_flag"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "EXIT_FAILURE"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slog",
          "args": [
            "LG_ERROR",
            "\"chanserv/successor_acl: Inserting +S into flagset failed.\""
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flags_associate",
          "args": [
            "'S'",
            "0",
            "false",
            "\"successor\""
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atheme.h\"\n\nstatic unsigned int successor_flag = 0;\n\nvoid _modinit(module_t *m)\n{\n\tm->mflags = MODTYPE_CORE;\n\n\tif ((successor_flag = flags_associate('S', 0, false, \"successor\")) == 0)\n\t{\n\t\tslog(LG_ERROR, \"chanserv/successor_acl: Inserting +S into flagset failed.\");\n\t\texit(EXIT_FAILURE);\n\t}\n\n\tslog(LG_DEBUG, \"chanserv/successor_acl: +S has been inserted with bitmask 0x%x\", successor_flag);\n\thook_add_first_channel_pick_successor(channel_pick_successor_hook);\n\thook_add_channel_succession(channel_succession_hook);\n}"
  },
  {
    "function_name": "channel_succession_hook",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/successor_acl.c",
    "lines": "33-41",
    "snippet": "static void channel_succession_hook(hook_channel_succession_req_t *req)\n{\n\treturn_if_fail(req != NULL);\n\treturn_if_fail(req->mc != NULL);\n\treturn_if_fail(req->mu != NULL);\n\n\t/* Remove the successor flag from the new founder. */\n\tchanacs_change_simple(req->mc, entity(req->mu), NULL, 0, successor_flag, NULL);\n}",
    "includes": [
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int successor_flag = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "chanacs_change_simple",
          "args": [
            "req->mc",
            "entity(req->mu)",
            "NULL",
            "0",
            "successor_flag",
            "NULL"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "entity",
          "args": [
            "req->mu"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "return_if_fail",
          "args": [
            "req->mu != NULL"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "return_if_fail",
          "args": [
            "req->mc != NULL"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "return_if_fail",
          "args": [
            "req != NULL"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atheme.h\"\n\nstatic unsigned int successor_flag = 0;\n\nstatic void channel_succession_hook(hook_channel_succession_req_t *req)\n{\n\treturn_if_fail(req != NULL);\n\treturn_if_fail(req->mc != NULL);\n\treturn_if_fail(req->mu != NULL);\n\n\t/* Remove the successor flag from the new founder. */\n\tchanacs_change_simple(req->mc, entity(req->mu), NULL, 0, successor_flag, NULL);\n}"
  },
  {
    "function_name": "channel_pick_successor_hook",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/successor_acl.c",
    "lines": "19-31",
    "snippet": "static void channel_pick_successor_hook(hook_channel_succession_req_t *req)\n{\n\treturn_if_fail(req != NULL);\n\treturn_if_fail(req->mc != NULL);\n\n\t/* maybe some other module already chose a new successor. */\n\tif (req->mu != NULL)\n\t\treturn;\n\n\treq->mu = mychan_pick_candidate(req->mc, successor_flag);\n\tif (req->mu == NULL)\n\t\treturn;\n}",
    "includes": [
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int successor_flag = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mychan_pick_candidate",
          "args": [
            "req->mc",
            "successor_flag"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "return_if_fail",
          "args": [
            "req->mc != NULL"
          ],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "return_if_fail",
          "args": [
            "req != NULL"
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atheme.h\"\n\nstatic unsigned int successor_flag = 0;\n\nstatic void channel_pick_successor_hook(hook_channel_succession_req_t *req)\n{\n\treturn_if_fail(req != NULL);\n\treturn_if_fail(req->mc != NULL);\n\n\t/* maybe some other module already chose a new successor. */\n\tif (req->mu != NULL)\n\t\treturn;\n\n\treq->mu = mychan_pick_candidate(req->mc, successor_flag);\n\tif (req->mu == NULL)\n\t\treturn;\n}"
  }
]