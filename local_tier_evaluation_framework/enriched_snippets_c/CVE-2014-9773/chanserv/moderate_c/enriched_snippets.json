[
  {
    "function_name": "_moddeinit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
    "lines": "378-392",
    "snippet": "void _moddeinit(module_unload_intent_t intent)\n{\n\tmowgli_patricia_destroy(csreq_list, NULL, NULL);\n\n\tservice_named_unbind_command(\"chanserv\", &cs_activate);\n\tservice_named_unbind_command(\"chanserv\", &cs_reject);\n\tservice_named_unbind_command(\"chanserv\", &cs_waiting);\n\n\thook_del_channel_can_register(can_register);\n\thook_del_db_write(csreq_marshal_set);\n\n\tdel_conf_item(\"REGGROUP\", &chansvs.me->conf_table);\n\n\tdb_unregister_type_handler(\"CSREQ\");\n}",
    "includes": [
      "#include \"chanserv.h\"",
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static command_t cs_activate = { \"ACTIVATE\", N_(\"Activates a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_activate, { .path = \"cservice/activate\" } };",
      "static command_t cs_reject   = { \"REJECT\", N_(\"Rejects a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_reject, { .path = \"cservice/reject\" } };",
      "static command_t cs_waiting  = { \"WAITING\", N_(\"View pending registrations\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 1, cs_cmd_waiting, { .path = \"cservice/waiting\" } };",
      "static mowgli_patricia_t *csreq_list = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "db_unregister_type_handler",
          "args": [
            "\"CSREQ\""
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "del_conf_item",
          "args": [
            "\"REGGROUP\"",
            "&chansvs.me->conf_table"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hook_del_db_write",
          "args": [
            "csreq_marshal_set"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hook_del_channel_can_register",
          "args": [
            "can_register"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "service_named_unbind_command",
          "args": [
            "\"chanserv\"",
            "&cs_waiting"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "service_named_unbind_command",
          "args": [
            "\"chanserv\"",
            "&cs_reject"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "service_named_unbind_command",
          "args": [
            "\"chanserv\"",
            "&cs_activate"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mowgli_patricia_destroy",
          "args": [
            "csreq_list",
            "NULL",
            "NULL"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic command_t cs_activate = { \"ACTIVATE\", N_(\"Activates a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_activate, { .path = \"cservice/activate\" } };\nstatic command_t cs_reject   = { \"REJECT\", N_(\"Rejects a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_reject, { .path = \"cservice/reject\" } };\nstatic command_t cs_waiting  = { \"WAITING\", N_(\"View pending registrations\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 1, cs_cmd_waiting, { .path = \"cservice/waiting\" } };\nstatic mowgli_patricia_t *csreq_list = NULL;\n\nvoid _moddeinit(module_unload_intent_t intent)\n{\n\tmowgli_patricia_destroy(csreq_list, NULL, NULL);\n\n\tservice_named_unbind_command(\"chanserv\", &cs_activate);\n\tservice_named_unbind_command(\"chanserv\", &cs_reject);\n\tservice_named_unbind_command(\"chanserv\", &cs_waiting);\n\n\thook_del_channel_can_register(can_register);\n\thook_del_db_write(csreq_marshal_set);\n\n\tdel_conf_item(\"REGGROUP\", &chansvs.me->conf_table);\n\n\tdb_unregister_type_handler(\"CSREQ\");\n}"
  },
  {
    "function_name": "_modinit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
    "lines": "360-376",
    "snippet": "void _modinit(module_t *m)\n{\n\tcsreq_list = mowgli_patricia_create(strcasecanon);\n\n\tservice_named_bind_command(\"chanserv\", &cs_activate);\n\tservice_named_bind_command(\"chanserv\", &cs_reject);\n\tservice_named_bind_command(\"chanserv\", &cs_waiting);\n\n\thook_add_event(\"channel_can_register\");\n\thook_add_channel_can_register(can_register);\n\n\thook_add_db_write(csreq_marshal_set);\n\n\tadd_dupstr_conf_item(\"REGGROUP\", &chansvs.me->conf_table, 0, &groupmemo, NULL);\n\n\tdb_register_type_handler(\"CSREQ\", csreq_demarshal);\n}",
    "includes": [
      "#include \"chanserv.h\"",
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static command_t cs_activate = { \"ACTIVATE\", N_(\"Activates a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_activate, { .path = \"cservice/activate\" } };",
      "static command_t cs_reject   = { \"REJECT\", N_(\"Rejects a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_reject, { .path = \"cservice/reject\" } };",
      "static command_t cs_waiting  = { \"WAITING\", N_(\"View pending registrations\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 1, cs_cmd_waiting, { .path = \"cservice/waiting\" } };",
      "static mowgli_patricia_t *csreq_list = NULL;",
      "static char *groupmemo;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "db_register_type_handler",
          "args": [
            "\"CSREQ\"",
            "csreq_demarshal"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "add_dupstr_conf_item",
          "args": [
            "\"REGGROUP\"",
            "&chansvs.me->conf_table",
            "0",
            "&groupmemo",
            "NULL"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hook_add_db_write",
          "args": [
            "csreq_marshal_set"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hook_add_channel_can_register",
          "args": [
            "can_register"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hook_add_event",
          "args": [
            "\"channel_can_register\""
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "service_named_bind_command",
          "args": [
            "\"chanserv\"",
            "&cs_waiting"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "service_named_bind_command",
          "args": [
            "\"chanserv\"",
            "&cs_reject"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "service_named_bind_command",
          "args": [
            "\"chanserv\"",
            "&cs_activate"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mowgli_patricia_create",
          "args": [
            "strcasecanon"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic command_t cs_activate = { \"ACTIVATE\", N_(\"Activates a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_activate, { .path = \"cservice/activate\" } };\nstatic command_t cs_reject   = { \"REJECT\", N_(\"Rejects a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_reject, { .path = \"cservice/reject\" } };\nstatic command_t cs_waiting  = { \"WAITING\", N_(\"View pending registrations\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 1, cs_cmd_waiting, { .path = \"cservice/waiting\" } };\nstatic mowgli_patricia_t *csreq_list = NULL;\nstatic char *groupmemo;\n\nvoid _modinit(module_t *m)\n{\n\tcsreq_list = mowgli_patricia_create(strcasecanon);\n\n\tservice_named_bind_command(\"chanserv\", &cs_activate);\n\tservice_named_bind_command(\"chanserv\", &cs_reject);\n\tservice_named_bind_command(\"chanserv\", &cs_waiting);\n\n\thook_add_event(\"channel_can_register\");\n\thook_add_channel_can_register(can_register);\n\n\thook_add_db_write(csreq_marshal_set);\n\n\tadd_dupstr_conf_item(\"REGGROUP\", &chansvs.me->conf_table, 0, &groupmemo, NULL);\n\n\tdb_register_type_handler(\"CSREQ\", csreq_demarshal);\n}"
  },
  {
    "function_name": "cs_cmd_waiting",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
    "lines": "338-356",
    "snippet": "static void cs_cmd_waiting(sourceinfo_t *si, int parc, char *parv[])\n{\n\tmowgli_patricia_iteration_state_t state;\n\tcsreq_t *cs;\n\tstruct tm tm;\n\tchar strfbuf[BUFSIZE];\n\n\tMOWGLI_PATRICIA_FOREACH(cs, &state, csreq_list)\n\t{\n\t\ttm = *localtime(&cs->ts);\n\t\tstrftime(strfbuf, sizeof strfbuf, TIME_FORMAT, &tm);\n\n\t\tcommand_success_nodata(si, _(\"\\2%s\\2 (\\2%s\\2) [%s (%s ago)]\"),\n\t\t\t\t       cs->name, cs->mt->name, strfbuf, time_ago(cs->ts));\n\t}\n\n\tcommand_success_nodata(si, _(\"End of list.\"));\n\tlogcommand(si, CMDLOG_GET, \"WAITING\");\n}",
    "includes": [
      "#include \"chanserv.h\"",
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void cs_cmd_activate(sourceinfo_t *si, int parc, char *parv[]);",
      "static void cs_cmd_reject(sourceinfo_t *si, int parc, char *parv[]);",
      "static void cs_cmd_waiting(sourceinfo_t *si, int parc, char *parv[]);",
      "static mowgli_patricia_t *csreq_list = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "logcommand",
          "args": [
            "si",
            "CMDLOG_GET",
            "\"WAITING\""
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"End of list.\")"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"End of list.\""
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "_moddeinit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
          "lines": "378-392",
          "snippet": "void _moddeinit(module_unload_intent_t intent)\n{\n\tmowgli_patricia_destroy(csreq_list, NULL, NULL);\n\n\tservice_named_unbind_command(\"chanserv\", &cs_activate);\n\tservice_named_unbind_command(\"chanserv\", &cs_reject);\n\tservice_named_unbind_command(\"chanserv\", &cs_waiting);\n\n\thook_del_channel_can_register(can_register);\n\thook_del_db_write(csreq_marshal_set);\n\n\tdel_conf_item(\"REGGROUP\", &chansvs.me->conf_table);\n\n\tdb_unregister_type_handler(\"CSREQ\");\n}",
          "includes": [
            "#include \"chanserv.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static command_t cs_activate = { \"ACTIVATE\", N_(\"Activates a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_activate, { .path = \"cservice/activate\" } };",
            "static command_t cs_reject   = { \"REJECT\", N_(\"Rejects a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_reject, { .path = \"cservice/reject\" } };",
            "static command_t cs_waiting  = { \"WAITING\", N_(\"View pending registrations\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 1, cs_cmd_waiting, { .path = \"cservice/waiting\" } };",
            "static mowgli_patricia_t *csreq_list = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic command_t cs_activate = { \"ACTIVATE\", N_(\"Activates a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_activate, { .path = \"cservice/activate\" } };\nstatic command_t cs_reject   = { \"REJECT\", N_(\"Rejects a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_reject, { .path = \"cservice/reject\" } };\nstatic command_t cs_waiting  = { \"WAITING\", N_(\"View pending registrations\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 1, cs_cmd_waiting, { .path = \"cservice/waiting\" } };\nstatic mowgli_patricia_t *csreq_list = NULL;\n\nvoid _moddeinit(module_unload_intent_t intent)\n{\n\tmowgli_patricia_destroy(csreq_list, NULL, NULL);\n\n\tservice_named_unbind_command(\"chanserv\", &cs_activate);\n\tservice_named_unbind_command(\"chanserv\", &cs_reject);\n\tservice_named_unbind_command(\"chanserv\", &cs_waiting);\n\n\thook_del_channel_can_register(can_register);\n\thook_del_db_write(csreq_marshal_set);\n\n\tdel_conf_item(\"REGGROUP\", &chansvs.me->conf_table);\n\n\tdb_unregister_type_handler(\"CSREQ\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"\\2%s\\2 (\\2%s\\2) [%s (%s ago)]\")",
            "cs->name",
            "cs->mt->name",
            "strfbuf",
            "time_ago(cs->ts)"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time_ago",
          "args": [
            "cs->ts"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strftime",
          "args": [
            "strfbuf",
            "sizeof strfbuf",
            "TIME_FORMAT",
            "&tm"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "localtime",
          "args": [
            "&cs->ts"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MOWGLI_PATRICIA_FOREACH",
          "args": [
            "cs",
            "&state",
            "csreq_list"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic void cs_cmd_activate(sourceinfo_t *si, int parc, char *parv[]);\nstatic void cs_cmd_reject(sourceinfo_t *si, int parc, char *parv[]);\nstatic void cs_cmd_waiting(sourceinfo_t *si, int parc, char *parv[]);\nstatic mowgli_patricia_t *csreq_list = NULL;\n\nstatic void cs_cmd_waiting(sourceinfo_t *si, int parc, char *parv[])\n{\n\tmowgli_patricia_iteration_state_t state;\n\tcsreq_t *cs;\n\tstruct tm tm;\n\tchar strfbuf[BUFSIZE];\n\n\tMOWGLI_PATRICIA_FOREACH(cs, &state, csreq_list)\n\t{\n\t\ttm = *localtime(&cs->ts);\n\t\tstrftime(strfbuf, sizeof strfbuf, TIME_FORMAT, &tm);\n\n\t\tcommand_success_nodata(si, _(\"\\2%s\\2 (\\2%s\\2) [%s (%s ago)]\"),\n\t\t\t\t       cs->name, cs->mt->name, strfbuf, time_ago(cs->ts));\n\t}\n\n\tcommand_success_nodata(si, _(\"End of list.\"));\n\tlogcommand(si, CMDLOG_GET, \"WAITING\");\n}"
  },
  {
    "function_name": "cs_cmd_reject",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
    "lines": "309-336",
    "snippet": "static void cs_cmd_reject(sourceinfo_t *si, int parc, char *parv[])\n{\n\tcsreq_t *cs;\n\tmyuser_t *mu;\n\n\tif (!parv[0])\n\t{\n\t\tcommand_fail(si, fault_needmoreparams, STR_INSUFFICIENT_PARAMS, \"REJECT\");\n\t\tcommand_fail(si, fault_needmoreparams, _(\"Syntax: REJECT <#channel>\"));\n\t\treturn;\n\t}\n\n\tcs = csreq_find(parv[0]);\n\tif (cs == NULL)\n\t{\n\t\tcommand_fail(si, fault_nosuch_target, _(\"\\2%s\\2 is not pending registration.\"), parv[0]);\n\t\treturn;\n\t}\n\n\tmu = user(cs->mt);\n\tif (mu != NULL)\n\t\tsend_memo(si, mu, \"Your registration request for \\2%s\\2 was rejected.\", parv[0]);\n\n\tcsreq_destroy(cs);\n\n\tcommand_success_nodata(si, _(\"\\2%s\\2 was rejected.\"), parv[0]);\n\tlogcommand(si, CMDLOG_ADMIN, \"REJECT: \\2%s\\2\", parv[0]);\n}",
    "includes": [
      "#include \"chanserv.h\"",
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void cs_cmd_activate(sourceinfo_t *si, int parc, char *parv[]);",
      "static void cs_cmd_reject(sourceinfo_t *si, int parc, char *parv[]);",
      "static void cs_cmd_waiting(sourceinfo_t *si, int parc, char *parv[]);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "logcommand",
          "args": [
            "si",
            "CMDLOG_ADMIN",
            "\"REJECT: \\2%s\\2\"",
            "parv[0]"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"\\2%s\\2 was rejected.\")",
            "parv[0]"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"\\2%s\\2 was rejected.\""
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "_moddeinit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
          "lines": "378-392",
          "snippet": "void _moddeinit(module_unload_intent_t intent)\n{\n\tmowgli_patricia_destroy(csreq_list, NULL, NULL);\n\n\tservice_named_unbind_command(\"chanserv\", &cs_activate);\n\tservice_named_unbind_command(\"chanserv\", &cs_reject);\n\tservice_named_unbind_command(\"chanserv\", &cs_waiting);\n\n\thook_del_channel_can_register(can_register);\n\thook_del_db_write(csreq_marshal_set);\n\n\tdel_conf_item(\"REGGROUP\", &chansvs.me->conf_table);\n\n\tdb_unregister_type_handler(\"CSREQ\");\n}",
          "includes": [
            "#include \"chanserv.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static command_t cs_activate = { \"ACTIVATE\", N_(\"Activates a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_activate, { .path = \"cservice/activate\" } };",
            "static command_t cs_reject   = { \"REJECT\", N_(\"Rejects a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_reject, { .path = \"cservice/reject\" } };",
            "static command_t cs_waiting  = { \"WAITING\", N_(\"View pending registrations\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 1, cs_cmd_waiting, { .path = \"cservice/waiting\" } };",
            "static mowgli_patricia_t *csreq_list = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic command_t cs_activate = { \"ACTIVATE\", N_(\"Activates a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_activate, { .path = \"cservice/activate\" } };\nstatic command_t cs_reject   = { \"REJECT\", N_(\"Rejects a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_reject, { .path = \"cservice/reject\" } };\nstatic command_t cs_waiting  = { \"WAITING\", N_(\"View pending registrations\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 1, cs_cmd_waiting, { .path = \"cservice/waiting\" } };\nstatic mowgli_patricia_t *csreq_list = NULL;\n\nvoid _moddeinit(module_unload_intent_t intent)\n{\n\tmowgli_patricia_destroy(csreq_list, NULL, NULL);\n\n\tservice_named_unbind_command(\"chanserv\", &cs_activate);\n\tservice_named_unbind_command(\"chanserv\", &cs_reject);\n\tservice_named_unbind_command(\"chanserv\", &cs_waiting);\n\n\thook_del_channel_can_register(can_register);\n\thook_del_db_write(csreq_marshal_set);\n\n\tdel_conf_item(\"REGGROUP\", &chansvs.me->conf_table);\n\n\tdb_unregister_type_handler(\"CSREQ\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "csreq_destroy",
          "args": [
            "cs"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "csreq_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
          "lines": "79-86",
          "snippet": "static void csreq_destroy(csreq_t *cs)\n{\n\treturn_if_fail(cs != NULL);\n\n\tmowgli_patricia_delete(csreq_list, cs->name);\n\tfree(cs->name);\n\tfree(cs);\n}",
          "includes": [
            "#include \"chanserv.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static mowgli_patricia_t *csreq_list = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic mowgli_patricia_t *csreq_list = NULL;\n\nstatic void csreq_destroy(csreq_t *cs)\n{\n\treturn_if_fail(cs != NULL);\n\n\tmowgli_patricia_delete(csreq_list, cs->name);\n\tfree(cs->name);\n\tfree(cs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "send_memo",
          "args": [
            "si",
            "mu",
            "\"Your registration request for \\2%s\\2 was rejected.\"",
            "parv[0]"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "send_memo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
          "lines": "124-150",
          "snippet": "static void send_memo(sourceinfo_t *si, myuser_t *mu, const char *memo, ...)\n{\n\tservice_t *msvs;\n\tva_list va;\n\tchar buf[BUFSIZE];\n\n\treturn_if_fail(si != NULL);\n\treturn_if_fail(mu != NULL);\n\treturn_if_fail(memo != NULL);\n\n\tva_start(va, memo);\n\tvsnprintf(buf, BUFSIZE, memo, va);\n\tva_end(va);\n\n\tif ((msvs = service_find(\"memoserv\")) == NULL)\n\t\tmyuser_notice(chansvs.nick, mu, \"%s\", buf);\n\telse\n\t{\n\t\tchar cmdbuf[BUFSIZE];\n\n\t\tmowgli_strlcpy(cmdbuf, entity(mu)->name, BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, \" \", BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, buf, BUFSIZE);\n\n\t\tcommand_exec_split(msvs, si, \"SEND\", cmdbuf, msvs->commands);\n\t}\n}",
          "includes": [
            "#include \"chanserv.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic void send_memo(sourceinfo_t *si, myuser_t *mu, const char *memo, ...)\n{\n\tservice_t *msvs;\n\tva_list va;\n\tchar buf[BUFSIZE];\n\n\treturn_if_fail(si != NULL);\n\treturn_if_fail(mu != NULL);\n\treturn_if_fail(memo != NULL);\n\n\tva_start(va, memo);\n\tvsnprintf(buf, BUFSIZE, memo, va);\n\tva_end(va);\n\n\tif ((msvs = service_find(\"memoserv\")) == NULL)\n\t\tmyuser_notice(chansvs.nick, mu, \"%s\", buf);\n\telse\n\t{\n\t\tchar cmdbuf[BUFSIZE];\n\n\t\tmowgli_strlcpy(cmdbuf, entity(mu)->name, BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, \" \", BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, buf, BUFSIZE);\n\n\t\tcommand_exec_split(msvs, si, \"SEND\", cmdbuf, msvs->commands);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "user",
          "args": [
            "cs->mt"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "sync_myuser",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/sync.c",
          "lines": "266-276",
          "snippet": "static void sync_myuser(myuser_t *mu)\n{\n\tmowgli_node_t *iter;\n\n\treturn_if_fail(mu != NULL);\n\n\tMOWGLI_ITER_FOREACH(iter, mu->logins.head)\n\t{\n\t\tsync_user(iter->data);\n\t}\n}",
          "includes": [
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"atheme.h\"\n\nstatic void sync_myuser(myuser_t *mu)\n{\n\tmowgli_node_t *iter;\n\n\treturn_if_fail(mu != NULL);\n\n\tMOWGLI_ITER_FOREACH(iter, mu->logins.head)\n\t{\n\t\tsync_user(iter->data);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_nosuch_target",
            "_(\"\\2%s\\2 is not pending registration.\")",
            "parv[0]"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "csreq_find",
          "args": [
            "parv[0]"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "csreq_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
          "lines": "72-77",
          "snippet": "static csreq_t *csreq_find(const char *name)\n{\n\treturn_val_if_fail(name != NULL, NULL);\n\n\treturn mowgli_patricia_retrieve(csreq_list, name);\n}",
          "includes": [
            "#include \"chanserv.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static mowgli_patricia_t *csreq_list = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic mowgli_patricia_t *csreq_list = NULL;\n\nstatic csreq_t *csreq_find(const char *name)\n{\n\treturn_val_if_fail(name != NULL, NULL);\n\n\treturn mowgli_patricia_retrieve(csreq_list, name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_needmoreparams",
            "_(\"Syntax: REJECT <#channel>\")"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_needmoreparams",
            "STR_INSUFFICIENT_PARAMS",
            "\"REJECT\""
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic void cs_cmd_activate(sourceinfo_t *si, int parc, char *parv[]);\nstatic void cs_cmd_reject(sourceinfo_t *si, int parc, char *parv[]);\nstatic void cs_cmd_waiting(sourceinfo_t *si, int parc, char *parv[]);\n\nstatic void cs_cmd_reject(sourceinfo_t *si, int parc, char *parv[])\n{\n\tcsreq_t *cs;\n\tmyuser_t *mu;\n\n\tif (!parv[0])\n\t{\n\t\tcommand_fail(si, fault_needmoreparams, STR_INSUFFICIENT_PARAMS, \"REJECT\");\n\t\tcommand_fail(si, fault_needmoreparams, _(\"Syntax: REJECT <#channel>\"));\n\t\treturn;\n\t}\n\n\tcs = csreq_find(parv[0]);\n\tif (cs == NULL)\n\t{\n\t\tcommand_fail(si, fault_nosuch_target, _(\"\\2%s\\2 is not pending registration.\"), parv[0]);\n\t\treturn;\n\t}\n\n\tmu = user(cs->mt);\n\tif (mu != NULL)\n\t\tsend_memo(si, mu, \"Your registration request for \\2%s\\2 was rejected.\", parv[0]);\n\n\tcsreq_destroy(cs);\n\n\tcommand_success_nodata(si, _(\"\\2%s\\2 was rejected.\"), parv[0]);\n\tlogcommand(si, CMDLOG_ADMIN, \"REJECT: \\2%s\\2\", parv[0]);\n}"
  },
  {
    "function_name": "cs_cmd_activate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
    "lines": "208-307",
    "snippet": "static void cs_cmd_activate(sourceinfo_t *si, int parc, char *parv[])\n{\n\tmyuser_t *mu;\n\tmychan_t *mc;\n\tcsreq_t *cs;\n\tchanuser_t *cu;\n\tuser_t *u;\n\tchannel_t *c;\n\tchar str[BUFSIZE];\n\thook_channel_req_t hdata;\n\tsourceinfo_t baked_si;\n\tunsigned int fl;\n\n\tif (!parv[0])\n\t{\n\t\tcommand_fail(si, fault_needmoreparams, STR_INSUFFICIENT_PARAMS, \"ACTIVATE\");\n\t\tcommand_fail(si, fault_needmoreparams, _(\"Syntax: ACTIVATE <#channel>\"));\n\t\treturn;\n\t}\n\n\tcs = csreq_find(parv[0]);\n\tif (cs == NULL)\n\t{\n\t\tcommand_fail(si, fault_nosuch_target, _(\"\\2%s\\2 is not pending registration.\"), parv[0]);\n\t\treturn;\n\t}\n\n\tmu = user(cs->mt);\n\tif (mu != NULL)\n\t\tsend_memo(si, mu, \"Your registration request for \\2%s\\2 was approved.\", parv[0]);\n\n\tc = channel_find(cs->name);\n\tmc = mychan_add(cs->name);\n\tmc->registered = CURRTIME;\n\tmc->used = CURRTIME;\n\tmc->mlock_on |= (CMODE_NOEXT | CMODE_TOPIC);\n\tif (c != NULL && c->limit == 0)\n\t\tmc->mlock_off |= CMODE_LIMIT;\n\tif (c != NULL && c->key == NULL)\n\t\tmc->mlock_off |= CMODE_KEY;\n\tmc->flags |= config_options.defcflags;\n\tslog(LG_DEBUG, \"cs_cmd_activate(): defcflags = %d, mc->flags = %d, guard? %s\", config_options.defcflags, mc->flags, (mc->flags & MC_GUARD) ? \"YES\" : \"NO\");\n\n\tchanacs_add(mc, cs->mt, custom_founder_check(), CURRTIME, entity(si->smu));\n\n\tcommand_success_nodata(si, _(\"\\2%s\\2 is now registered to \\2%s\\2.\"), mc->name, cs->mt->name);\n\n\tif (c != NULL && c->ts > 0)\n\t{\n\t\tsnprintf(str, sizeof str, \"%lu\", (unsigned long)c->ts);\n\t\tmetadata_add(mc, \"private:channelts\", str);\n\t}\n\n\tif (chansvs.deftemplates != NULL && *chansvs.deftemplates != '\\0')\n\t\tmetadata_add(mc, \"private:templates\", chansvs.deftemplates);\n\n\tif (mu != NULL && MOWGLI_LIST_LENGTH(&mu->logins) > 0)\n\t{\n\t\tu = mu->logins.head->data;\n\n\t\tbaked_si.su = u;\n\t\tbaked_si.smu = mu;\n\t\tbaked_si.service = si->service;\n\n\t        hdata.si = &baked_si;\n\t        hdata.mc = mc;\n        \thook_call_channel_register(&hdata);\n\n\t\tif (mc->chan != NULL)\n\t\t{\n\t\t        /* Allow the hook to override this. */\n\t\t        fl = chanacs_source_flags(mc, &baked_si);\n\t\t        cu = chanuser_find(mc->chan, u);\n\t\t        if (cu == NULL)\n\t        \t        ;\n\t        \telse if (ircd->uses_owner && fl & CA_USEOWNER && fl & CA_AUTOOP &&\n\t\t                        !(cu->modes & CSTATUS_OWNER))\n        \t\t{\n\t\t                modestack_mode_param(si->service->nick, mc->chan, MTYPE_ADD,\n        \t        \t                ircd->owner_mchar[1], CLIENT_NAME(u));\n        \t\t        cu->modes |= CSTATUS_OWNER;\n\t\t        }\n        \t\telse if (ircd->uses_protect && fl & CA_USEPROTECT && fl & CA_AUTOOP &&\n\t        \t                !(cu->modes & CSTATUS_PROTECT))\n\t\t        {\n\t\t                modestack_mode_param(si->service->nick, mc->chan, MTYPE_ADD,\n                \t\t                ircd->protect_mchar[1], CLIENT_NAME(u));\n        \t        \tcu->modes |= CSTATUS_PROTECT;\n\t\t        }\n\t\t}\n\t}\n\n\tcsreq_destroy(cs);\n\t/* Check if GUARD is enabled by default and if so, ChanServ should join even \n\t * if the founder is no longer present or identified. --siniStar\n\t */\n\tif (mc->flags & MC_GUARD)\n\t\tjoin(mc->name, chansvs.nick);\n\tlogcommand(si, CMDLOG_ADMIN, \"ACTIVATE: \\2%s\\2\", parv[0]);\n}",
    "includes": [
      "#include \"chanserv.h\"",
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void cs_cmd_activate(sourceinfo_t *si, int parc, char *parv[]);",
      "static void cs_cmd_reject(sourceinfo_t *si, int parc, char *parv[]);",
      "static void cs_cmd_waiting(sourceinfo_t *si, int parc, char *parv[]);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "logcommand",
          "args": [
            "si",
            "CMDLOG_ADMIN",
            "\"ACTIVATE: \\2%s\\2\"",
            "parv[0]"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "join",
          "args": [
            "mc->name",
            "chansvs.nick"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "csreq_destroy",
          "args": [
            "cs"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "csreq_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
          "lines": "79-86",
          "snippet": "static void csreq_destroy(csreq_t *cs)\n{\n\treturn_if_fail(cs != NULL);\n\n\tmowgli_patricia_delete(csreq_list, cs->name);\n\tfree(cs->name);\n\tfree(cs);\n}",
          "includes": [
            "#include \"chanserv.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static mowgli_patricia_t *csreq_list = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic mowgli_patricia_t *csreq_list = NULL;\n\nstatic void csreq_destroy(csreq_t *cs)\n{\n\treturn_if_fail(cs != NULL);\n\n\tmowgli_patricia_delete(csreq_list, cs->name);\n\tfree(cs->name);\n\tfree(cs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "modestack_mode_param",
          "args": [
            "si->service->nick",
            "mc->chan",
            "MTYPE_ADD",
            "ircd->protect_mchar[1]",
            "CLIENT_NAME(u)"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CLIENT_NAME",
          "args": [
            "u"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "modestack_mode_param",
          "args": [
            "si->service->nick",
            "mc->chan",
            "MTYPE_ADD",
            "ircd->owner_mchar[1]",
            "CLIENT_NAME(u)"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CLIENT_NAME",
          "args": [
            "u"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chanuser_find",
          "args": [
            "mc->chan",
            "u"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chanacs_source_flags",
          "args": [
            "mc",
            "&baked_si"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hook_call_channel_register",
          "args": [
            "&hdata"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MOWGLI_LIST_LENGTH",
          "args": [
            "&mu->logins"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_add",
          "args": [
            "mc",
            "\"private:templates\"",
            "chansvs.deftemplates"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_add",
          "args": [
            "mc",
            "\"private:channelts\"",
            "str"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "str",
            "sizeof str",
            "\"%lu\"",
            "(unsigned long)c->ts"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"\\2%s\\2 is now registered to \\2%s\\2.\")",
            "mc->name",
            "cs->mt->name"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"\\2%s\\2 is now registered to \\2%s\\2.\""
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "_moddeinit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
          "lines": "378-392",
          "snippet": "void _moddeinit(module_unload_intent_t intent)\n{\n\tmowgli_patricia_destroy(csreq_list, NULL, NULL);\n\n\tservice_named_unbind_command(\"chanserv\", &cs_activate);\n\tservice_named_unbind_command(\"chanserv\", &cs_reject);\n\tservice_named_unbind_command(\"chanserv\", &cs_waiting);\n\n\thook_del_channel_can_register(can_register);\n\thook_del_db_write(csreq_marshal_set);\n\n\tdel_conf_item(\"REGGROUP\", &chansvs.me->conf_table);\n\n\tdb_unregister_type_handler(\"CSREQ\");\n}",
          "includes": [
            "#include \"chanserv.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static command_t cs_activate = { \"ACTIVATE\", N_(\"Activates a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_activate, { .path = \"cservice/activate\" } };",
            "static command_t cs_reject   = { \"REJECT\", N_(\"Rejects a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_reject, { .path = \"cservice/reject\" } };",
            "static command_t cs_waiting  = { \"WAITING\", N_(\"View pending registrations\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 1, cs_cmd_waiting, { .path = \"cservice/waiting\" } };",
            "static mowgli_patricia_t *csreq_list = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic command_t cs_activate = { \"ACTIVATE\", N_(\"Activates a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_activate, { .path = \"cservice/activate\" } };\nstatic command_t cs_reject   = { \"REJECT\", N_(\"Rejects a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_reject, { .path = \"cservice/reject\" } };\nstatic command_t cs_waiting  = { \"WAITING\", N_(\"View pending registrations\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 1, cs_cmd_waiting, { .path = \"cservice/waiting\" } };\nstatic mowgli_patricia_t *csreq_list = NULL;\n\nvoid _moddeinit(module_unload_intent_t intent)\n{\n\tmowgli_patricia_destroy(csreq_list, NULL, NULL);\n\n\tservice_named_unbind_command(\"chanserv\", &cs_activate);\n\tservice_named_unbind_command(\"chanserv\", &cs_reject);\n\tservice_named_unbind_command(\"chanserv\", &cs_waiting);\n\n\thook_del_channel_can_register(can_register);\n\thook_del_db_write(csreq_marshal_set);\n\n\tdel_conf_item(\"REGGROUP\", &chansvs.me->conf_table);\n\n\tdb_unregister_type_handler(\"CSREQ\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "chanacs_add",
          "args": [
            "mc",
            "cs->mt",
            "custom_founder_check()",
            "CURRTIME",
            "entity(si->smu)"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "entity",
          "args": [
            "si->smu"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "custom_founder_check",
          "args": [],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "custom_founder_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/chanserv.h",
          "lines": "6-14",
          "snippet": "static inline unsigned int custom_founder_check(void)\n{\n\tchar *p;\n\n\tif (chansvs.founder_flags != NULL && (p = strchr(chansvs.founder_flags, 'F')) != NULL)\n\t\treturn flags_to_bitmask(chansvs.founder_flags, 0);\n\telse\n\t\treturn CA_INITIAL & ca_all;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline unsigned int custom_founder_check(void)\n{\n\tchar *p;\n\n\tif (chansvs.founder_flags != NULL && (p = strchr(chansvs.founder_flags, 'F')) != NULL)\n\t\treturn flags_to_bitmask(chansvs.founder_flags, 0);\n\telse\n\t\treturn CA_INITIAL & ca_all;\n}"
        }
      },
      {
        "call_info": {
          "callee": "slog",
          "args": [
            "LG_DEBUG",
            "\"cs_cmd_activate(): defcflags = %d, mc->flags = %d, guard? %s\"",
            "config_options.defcflags",
            "mc->flags",
            "(mc->flags & MC_GUARD) ? \"YES\" : \"NO\""
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mychan_add",
          "args": [
            "cs->name"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "channel_find",
          "args": [
            "cs->name"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "send_memo",
          "args": [
            "si",
            "mu",
            "\"Your registration request for \\2%s\\2 was approved.\"",
            "parv[0]"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "send_memo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
          "lines": "124-150",
          "snippet": "static void send_memo(sourceinfo_t *si, myuser_t *mu, const char *memo, ...)\n{\n\tservice_t *msvs;\n\tva_list va;\n\tchar buf[BUFSIZE];\n\n\treturn_if_fail(si != NULL);\n\treturn_if_fail(mu != NULL);\n\treturn_if_fail(memo != NULL);\n\n\tva_start(va, memo);\n\tvsnprintf(buf, BUFSIZE, memo, va);\n\tva_end(va);\n\n\tif ((msvs = service_find(\"memoserv\")) == NULL)\n\t\tmyuser_notice(chansvs.nick, mu, \"%s\", buf);\n\telse\n\t{\n\t\tchar cmdbuf[BUFSIZE];\n\n\t\tmowgli_strlcpy(cmdbuf, entity(mu)->name, BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, \" \", BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, buf, BUFSIZE);\n\n\t\tcommand_exec_split(msvs, si, \"SEND\", cmdbuf, msvs->commands);\n\t}\n}",
          "includes": [
            "#include \"chanserv.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic void send_memo(sourceinfo_t *si, myuser_t *mu, const char *memo, ...)\n{\n\tservice_t *msvs;\n\tva_list va;\n\tchar buf[BUFSIZE];\n\n\treturn_if_fail(si != NULL);\n\treturn_if_fail(mu != NULL);\n\treturn_if_fail(memo != NULL);\n\n\tva_start(va, memo);\n\tvsnprintf(buf, BUFSIZE, memo, va);\n\tva_end(va);\n\n\tif ((msvs = service_find(\"memoserv\")) == NULL)\n\t\tmyuser_notice(chansvs.nick, mu, \"%s\", buf);\n\telse\n\t{\n\t\tchar cmdbuf[BUFSIZE];\n\n\t\tmowgli_strlcpy(cmdbuf, entity(mu)->name, BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, \" \", BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, buf, BUFSIZE);\n\n\t\tcommand_exec_split(msvs, si, \"SEND\", cmdbuf, msvs->commands);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "user",
          "args": [
            "cs->mt"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "sync_myuser",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/sync.c",
          "lines": "266-276",
          "snippet": "static void sync_myuser(myuser_t *mu)\n{\n\tmowgli_node_t *iter;\n\n\treturn_if_fail(mu != NULL);\n\n\tMOWGLI_ITER_FOREACH(iter, mu->logins.head)\n\t{\n\t\tsync_user(iter->data);\n\t}\n}",
          "includes": [
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"atheme.h\"\n\nstatic void sync_myuser(myuser_t *mu)\n{\n\tmowgli_node_t *iter;\n\n\treturn_if_fail(mu != NULL);\n\n\tMOWGLI_ITER_FOREACH(iter, mu->logins.head)\n\t{\n\t\tsync_user(iter->data);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_nosuch_target",
            "_(\"\\2%s\\2 is not pending registration.\")",
            "parv[0]"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "csreq_find",
          "args": [
            "parv[0]"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "csreq_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
          "lines": "72-77",
          "snippet": "static csreq_t *csreq_find(const char *name)\n{\n\treturn_val_if_fail(name != NULL, NULL);\n\n\treturn mowgli_patricia_retrieve(csreq_list, name);\n}",
          "includes": [
            "#include \"chanserv.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static mowgli_patricia_t *csreq_list = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic mowgli_patricia_t *csreq_list = NULL;\n\nstatic csreq_t *csreq_find(const char *name)\n{\n\treturn_val_if_fail(name != NULL, NULL);\n\n\treturn mowgli_patricia_retrieve(csreq_list, name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_needmoreparams",
            "_(\"Syntax: ACTIVATE <#channel>\")"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_needmoreparams",
            "STR_INSUFFICIENT_PARAMS",
            "\"ACTIVATE\""
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic void cs_cmd_activate(sourceinfo_t *si, int parc, char *parv[]);\nstatic void cs_cmd_reject(sourceinfo_t *si, int parc, char *parv[]);\nstatic void cs_cmd_waiting(sourceinfo_t *si, int parc, char *parv[]);\n\nstatic void cs_cmd_activate(sourceinfo_t *si, int parc, char *parv[])\n{\n\tmyuser_t *mu;\n\tmychan_t *mc;\n\tcsreq_t *cs;\n\tchanuser_t *cu;\n\tuser_t *u;\n\tchannel_t *c;\n\tchar str[BUFSIZE];\n\thook_channel_req_t hdata;\n\tsourceinfo_t baked_si;\n\tunsigned int fl;\n\n\tif (!parv[0])\n\t{\n\t\tcommand_fail(si, fault_needmoreparams, STR_INSUFFICIENT_PARAMS, \"ACTIVATE\");\n\t\tcommand_fail(si, fault_needmoreparams, _(\"Syntax: ACTIVATE <#channel>\"));\n\t\treturn;\n\t}\n\n\tcs = csreq_find(parv[0]);\n\tif (cs == NULL)\n\t{\n\t\tcommand_fail(si, fault_nosuch_target, _(\"\\2%s\\2 is not pending registration.\"), parv[0]);\n\t\treturn;\n\t}\n\n\tmu = user(cs->mt);\n\tif (mu != NULL)\n\t\tsend_memo(si, mu, \"Your registration request for \\2%s\\2 was approved.\", parv[0]);\n\n\tc = channel_find(cs->name);\n\tmc = mychan_add(cs->name);\n\tmc->registered = CURRTIME;\n\tmc->used = CURRTIME;\n\tmc->mlock_on |= (CMODE_NOEXT | CMODE_TOPIC);\n\tif (c != NULL && c->limit == 0)\n\t\tmc->mlock_off |= CMODE_LIMIT;\n\tif (c != NULL && c->key == NULL)\n\t\tmc->mlock_off |= CMODE_KEY;\n\tmc->flags |= config_options.defcflags;\n\tslog(LG_DEBUG, \"cs_cmd_activate(): defcflags = %d, mc->flags = %d, guard? %s\", config_options.defcflags, mc->flags, (mc->flags & MC_GUARD) ? \"YES\" : \"NO\");\n\n\tchanacs_add(mc, cs->mt, custom_founder_check(), CURRTIME, entity(si->smu));\n\n\tcommand_success_nodata(si, _(\"\\2%s\\2 is now registered to \\2%s\\2.\"), mc->name, cs->mt->name);\n\n\tif (c != NULL && c->ts > 0)\n\t{\n\t\tsnprintf(str, sizeof str, \"%lu\", (unsigned long)c->ts);\n\t\tmetadata_add(mc, \"private:channelts\", str);\n\t}\n\n\tif (chansvs.deftemplates != NULL && *chansvs.deftemplates != '\\0')\n\t\tmetadata_add(mc, \"private:templates\", chansvs.deftemplates);\n\n\tif (mu != NULL && MOWGLI_LIST_LENGTH(&mu->logins) > 0)\n\t{\n\t\tu = mu->logins.head->data;\n\n\t\tbaked_si.su = u;\n\t\tbaked_si.smu = mu;\n\t\tbaked_si.service = si->service;\n\n\t        hdata.si = &baked_si;\n\t        hdata.mc = mc;\n        \thook_call_channel_register(&hdata);\n\n\t\tif (mc->chan != NULL)\n\t\t{\n\t\t        /* Allow the hook to override this. */\n\t\t        fl = chanacs_source_flags(mc, &baked_si);\n\t\t        cu = chanuser_find(mc->chan, u);\n\t\t        if (cu == NULL)\n\t        \t        ;\n\t        \telse if (ircd->uses_owner && fl & CA_USEOWNER && fl & CA_AUTOOP &&\n\t\t                        !(cu->modes & CSTATUS_OWNER))\n        \t\t{\n\t\t                modestack_mode_param(si->service->nick, mc->chan, MTYPE_ADD,\n        \t        \t                ircd->owner_mchar[1], CLIENT_NAME(u));\n        \t\t        cu->modes |= CSTATUS_OWNER;\n\t\t        }\n        \t\telse if (ircd->uses_protect && fl & CA_USEPROTECT && fl & CA_AUTOOP &&\n\t        \t                !(cu->modes & CSTATUS_PROTECT))\n\t\t        {\n\t\t                modestack_mode_param(si->service->nick, mc->chan, MTYPE_ADD,\n                \t\t                ircd->protect_mchar[1], CLIENT_NAME(u));\n        \t        \tcu->modes |= CSTATUS_PROTECT;\n\t\t        }\n\t\t}\n\t}\n\n\tcsreq_destroy(cs);\n\t/* Check if GUARD is enabled by default and if so, ChanServ should join even \n\t * if the founder is no longer present or identified. --siniStar\n\t */\n\tif (mc->flags & MC_GUARD)\n\t\tjoin(mc->name, chansvs.nick);\n\tlogcommand(si, CMDLOG_ADMIN, \"ACTIVATE: \\2%s\\2\", parv[0]);\n}"
  },
  {
    "function_name": "can_register",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
    "lines": "182-204",
    "snippet": "static void can_register(hook_channel_register_check_t *req)\n{\n\tcsreq_t *cs;\n\n\treturn_if_fail(req != NULL);\n\n\t/* no point in moderating registrations from those who have PRIV_CHAN_ADMIN since they can\n\t * approve them anyway. --nenolod\n\t */\n\tif (has_priv(req->si, PRIV_CHAN_ADMIN))\n\t\treturn;\n\n\treq->approved++;\n\n\tcs = csreq_create(req->name, entity(req->si->smu));\n\tcommand_success_nodata(req->si, _(\"\\2%s\\2 reviews every Channel Registration request.  Your request to register \\2%s\\2 has been received and should be reviewed shortly.\"),\n\t\t\t       me.netname, cs->name);\n\n\tif (groupmemo != NULL)\n\t\tsend_group_memo(req->si, \"[auto memo] Please review channel \\2%s\\2 for me.\", req->name);\n\n\tlogcommand(req->si, CMDLOG_REGISTER, \"REGISTER: \\2%s\\2 (pending)\", req->name);\n}",
    "includes": [
      "#include \"chanserv.h\"",
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void can_register(hook_channel_register_check_t *req);",
      "static char *groupmemo;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "logcommand",
          "args": [
            "req->si",
            "CMDLOG_REGISTER",
            "\"REGISTER: \\2%s\\2 (pending)\"",
            "req->name"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "send_group_memo",
          "args": [
            "req->si",
            "\"[auto memo] Please review channel \\2%s\\2 for me.\"",
            "req->name"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "send_group_memo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
          "lines": "152-177",
          "snippet": "static void send_group_memo(sourceinfo_t *si, const char *memo, ...)\n{\n\tservice_t *msvs;\n\tva_list va;\n\tchar buf[BUFSIZE];\n\n\treturn_if_fail(si != NULL);\n\treturn_if_fail(memo != NULL);\n\n\tva_start(va, memo);\n\tvsnprintf(buf, BUFSIZE, memo, va);\n\tva_end(va);\n\n\tif ((msvs = service_find(\"memoserv\")) == NULL)\n\t\treturn;\n\telse\n\t{\n\t\tchar cmdbuf[BUFSIZE];\n\n\t\tmowgli_strlcpy(cmdbuf, groupmemo, BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, \" \", BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, buf, BUFSIZE);\n\n\t\tcommand_exec_split(msvs, si, \"SEND\", cmdbuf, msvs->commands);\n\t}\n}",
          "includes": [
            "#include \"chanserv.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char *groupmemo;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic char *groupmemo;\n\nstatic void send_group_memo(sourceinfo_t *si, const char *memo, ...)\n{\n\tservice_t *msvs;\n\tva_list va;\n\tchar buf[BUFSIZE];\n\n\treturn_if_fail(si != NULL);\n\treturn_if_fail(memo != NULL);\n\n\tva_start(va, memo);\n\tvsnprintf(buf, BUFSIZE, memo, va);\n\tva_end(va);\n\n\tif ((msvs = service_find(\"memoserv\")) == NULL)\n\t\treturn;\n\telse\n\t{\n\t\tchar cmdbuf[BUFSIZE];\n\n\t\tmowgli_strlcpy(cmdbuf, groupmemo, BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, \" \", BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, buf, BUFSIZE);\n\n\t\tcommand_exec_split(msvs, si, \"SEND\", cmdbuf, msvs->commands);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "req->si",
            "_(\"\\2%s\\2 reviews every Channel Registration request.  Your request to register \\2%s\\2 has been received and should be reviewed shortly.\")",
            "me.netname",
            "cs->name"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"\\2%s\\2 reviews every Channel Registration request.  Your request to register \\2%s\\2 has been received and should be reviewed shortly.\""
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "_moddeinit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
          "lines": "378-392",
          "snippet": "void _moddeinit(module_unload_intent_t intent)\n{\n\tmowgli_patricia_destroy(csreq_list, NULL, NULL);\n\n\tservice_named_unbind_command(\"chanserv\", &cs_activate);\n\tservice_named_unbind_command(\"chanserv\", &cs_reject);\n\tservice_named_unbind_command(\"chanserv\", &cs_waiting);\n\n\thook_del_channel_can_register(can_register);\n\thook_del_db_write(csreq_marshal_set);\n\n\tdel_conf_item(\"REGGROUP\", &chansvs.me->conf_table);\n\n\tdb_unregister_type_handler(\"CSREQ\");\n}",
          "includes": [
            "#include \"chanserv.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static command_t cs_activate = { \"ACTIVATE\", N_(\"Activates a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_activate, { .path = \"cservice/activate\" } };",
            "static command_t cs_reject   = { \"REJECT\", N_(\"Rejects a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_reject, { .path = \"cservice/reject\" } };",
            "static command_t cs_waiting  = { \"WAITING\", N_(\"View pending registrations\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 1, cs_cmd_waiting, { .path = \"cservice/waiting\" } };",
            "static mowgli_patricia_t *csreq_list = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic command_t cs_activate = { \"ACTIVATE\", N_(\"Activates a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_activate, { .path = \"cservice/activate\" } };\nstatic command_t cs_reject   = { \"REJECT\", N_(\"Rejects a pending registration\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 2, cs_cmd_reject, { .path = \"cservice/reject\" } };\nstatic command_t cs_waiting  = { \"WAITING\", N_(\"View pending registrations\"), PRIV_CHAN_ADMIN,\n\t\t\t\t 1, cs_cmd_waiting, { .path = \"cservice/waiting\" } };\nstatic mowgli_patricia_t *csreq_list = NULL;\n\nvoid _moddeinit(module_unload_intent_t intent)\n{\n\tmowgli_patricia_destroy(csreq_list, NULL, NULL);\n\n\tservice_named_unbind_command(\"chanserv\", &cs_activate);\n\tservice_named_unbind_command(\"chanserv\", &cs_reject);\n\tservice_named_unbind_command(\"chanserv\", &cs_waiting);\n\n\thook_del_channel_can_register(can_register);\n\thook_del_db_write(csreq_marshal_set);\n\n\tdel_conf_item(\"REGGROUP\", &chansvs.me->conf_table);\n\n\tdb_unregister_type_handler(\"CSREQ\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "csreq_create",
          "args": [
            "req->name",
            "entity(req->si->smu)"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "csreq_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
          "lines": "55-70",
          "snippet": "static csreq_t *csreq_create(const char *name, myentity_t *mt)\n{\n\tcsreq_t *cs;\n\n\treturn_val_if_fail(name != NULL, NULL);\n\treturn_val_if_fail(mt != NULL, NULL);\n\n\tcs = smalloc(sizeof(csreq_t));\n\tcs->name = sstrdup(name);\n\tcs->mt = mt;\n\tcs->ts = CURRTIME;\n\n\tmowgli_patricia_add(csreq_list, cs->name, cs);\n\n\treturn cs;\n}",
          "includes": [
            "#include \"chanserv.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static mowgli_patricia_t *csreq_list = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic mowgli_patricia_t *csreq_list = NULL;\n\nstatic csreq_t *csreq_create(const char *name, myentity_t *mt)\n{\n\tcsreq_t *cs;\n\n\treturn_val_if_fail(name != NULL, NULL);\n\treturn_val_if_fail(mt != NULL, NULL);\n\n\tcs = smalloc(sizeof(csreq_t));\n\tcs->name = sstrdup(name);\n\tcs->mt = mt;\n\tcs->ts = CURRTIME;\n\n\tmowgli_patricia_add(csreq_list, cs->name, cs);\n\n\treturn cs;\n}"
        }
      },
      {
        "call_info": {
          "callee": "entity",
          "args": [
            "req->si->smu"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_priv",
          "args": [
            "req->si",
            "PRIV_CHAN_ADMIN"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "return_if_fail",
          "args": [
            "req != NULL"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic void can_register(hook_channel_register_check_t *req);\nstatic char *groupmemo;\n\nstatic void can_register(hook_channel_register_check_t *req)\n{\n\tcsreq_t *cs;\n\n\treturn_if_fail(req != NULL);\n\n\t/* no point in moderating registrations from those who have PRIV_CHAN_ADMIN since they can\n\t * approve them anyway. --nenolod\n\t */\n\tif (has_priv(req->si, PRIV_CHAN_ADMIN))\n\t\treturn;\n\n\treq->approved++;\n\n\tcs = csreq_create(req->name, entity(req->si->smu));\n\tcommand_success_nodata(req->si, _(\"\\2%s\\2 reviews every Channel Registration request.  Your request to register \\2%s\\2 has been received and should be reviewed shortly.\"),\n\t\t\t       me.netname, cs->name);\n\n\tif (groupmemo != NULL)\n\t\tsend_group_memo(req->si, \"[auto memo] Please review channel \\2%s\\2 for me.\", req->name);\n\n\tlogcommand(req->si, CMDLOG_REGISTER, \"REGISTER: \\2%s\\2 (pending)\", req->name);\n}"
  },
  {
    "function_name": "send_group_memo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
    "lines": "152-177",
    "snippet": "static void send_group_memo(sourceinfo_t *si, const char *memo, ...)\n{\n\tservice_t *msvs;\n\tva_list va;\n\tchar buf[BUFSIZE];\n\n\treturn_if_fail(si != NULL);\n\treturn_if_fail(memo != NULL);\n\n\tva_start(va, memo);\n\tvsnprintf(buf, BUFSIZE, memo, va);\n\tva_end(va);\n\n\tif ((msvs = service_find(\"memoserv\")) == NULL)\n\t\treturn;\n\telse\n\t{\n\t\tchar cmdbuf[BUFSIZE];\n\n\t\tmowgli_strlcpy(cmdbuf, groupmemo, BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, \" \", BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, buf, BUFSIZE);\n\n\t\tcommand_exec_split(msvs, si, \"SEND\", cmdbuf, msvs->commands);\n\t}\n}",
    "includes": [
      "#include \"chanserv.h\"",
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static char *groupmemo;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "command_exec_split",
          "args": [
            "msvs",
            "si",
            "\"SEND\"",
            "cmdbuf",
            "msvs->commands"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mowgli_strlcat",
          "args": [
            "cmdbuf",
            "buf",
            "BUFSIZE"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mowgli_strlcat",
          "args": [
            "cmdbuf",
            "\" \"",
            "BUFSIZE"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mowgli_strlcpy",
          "args": [
            "cmdbuf",
            "groupmemo",
            "BUFSIZE"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "service_find",
          "args": [
            "\"memoserv\""
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "va"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsnprintf",
          "args": [
            "buf",
            "BUFSIZE",
            "memo",
            "va"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "va",
            "memo"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "return_if_fail",
          "args": [
            "memo != NULL"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "return_if_fail",
          "args": [
            "si != NULL"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic char *groupmemo;\n\nstatic void send_group_memo(sourceinfo_t *si, const char *memo, ...)\n{\n\tservice_t *msvs;\n\tva_list va;\n\tchar buf[BUFSIZE];\n\n\treturn_if_fail(si != NULL);\n\treturn_if_fail(memo != NULL);\n\n\tva_start(va, memo);\n\tvsnprintf(buf, BUFSIZE, memo, va);\n\tva_end(va);\n\n\tif ((msvs = service_find(\"memoserv\")) == NULL)\n\t\treturn;\n\telse\n\t{\n\t\tchar cmdbuf[BUFSIZE];\n\n\t\tmowgli_strlcpy(cmdbuf, groupmemo, BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, \" \", BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, buf, BUFSIZE);\n\n\t\tcommand_exec_split(msvs, si, \"SEND\", cmdbuf, msvs->commands);\n\t}\n}"
  },
  {
    "function_name": "send_memo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
    "lines": "124-150",
    "snippet": "static void send_memo(sourceinfo_t *si, myuser_t *mu, const char *memo, ...)\n{\n\tservice_t *msvs;\n\tva_list va;\n\tchar buf[BUFSIZE];\n\n\treturn_if_fail(si != NULL);\n\treturn_if_fail(mu != NULL);\n\treturn_if_fail(memo != NULL);\n\n\tva_start(va, memo);\n\tvsnprintf(buf, BUFSIZE, memo, va);\n\tva_end(va);\n\n\tif ((msvs = service_find(\"memoserv\")) == NULL)\n\t\tmyuser_notice(chansvs.nick, mu, \"%s\", buf);\n\telse\n\t{\n\t\tchar cmdbuf[BUFSIZE];\n\n\t\tmowgli_strlcpy(cmdbuf, entity(mu)->name, BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, \" \", BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, buf, BUFSIZE);\n\n\t\tcommand_exec_split(msvs, si, \"SEND\", cmdbuf, msvs->commands);\n\t}\n}",
    "includes": [
      "#include \"chanserv.h\"",
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "command_exec_split",
          "args": [
            "msvs",
            "si",
            "\"SEND\"",
            "cmdbuf",
            "msvs->commands"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mowgli_strlcat",
          "args": [
            "cmdbuf",
            "buf",
            "BUFSIZE"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mowgli_strlcat",
          "args": [
            "cmdbuf",
            "\" \"",
            "BUFSIZE"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mowgli_strlcpy",
          "args": [
            "cmdbuf",
            "entity(mu)->name",
            "BUFSIZE"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "entity",
          "args": [
            "mu"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "myuser_notice",
          "args": [
            "chansvs.nick",
            "mu",
            "\"%s\"",
            "buf"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "service_find",
          "args": [
            "\"memoserv\""
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "va"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsnprintf",
          "args": [
            "buf",
            "BUFSIZE",
            "memo",
            "va"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "va",
            "memo"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "return_if_fail",
          "args": [
            "memo != NULL"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "return_if_fail",
          "args": [
            "mu != NULL"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "return_if_fail",
          "args": [
            "si != NULL"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic void send_memo(sourceinfo_t *si, myuser_t *mu, const char *memo, ...)\n{\n\tservice_t *msvs;\n\tva_list va;\n\tchar buf[BUFSIZE];\n\n\treturn_if_fail(si != NULL);\n\treturn_if_fail(mu != NULL);\n\treturn_if_fail(memo != NULL);\n\n\tva_start(va, memo);\n\tvsnprintf(buf, BUFSIZE, memo, va);\n\tva_end(va);\n\n\tif ((msvs = service_find(\"memoserv\")) == NULL)\n\t\tmyuser_notice(chansvs.nick, mu, \"%s\", buf);\n\telse\n\t{\n\t\tchar cmdbuf[BUFSIZE];\n\n\t\tmowgli_strlcpy(cmdbuf, entity(mu)->name, BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, \" \", BUFSIZE);\n\t\tmowgli_strlcat(cmdbuf, buf, BUFSIZE);\n\n\t\tcommand_exec_split(msvs, si, \"SEND\", cmdbuf, msvs->commands);\n\t}\n}"
  },
  {
    "function_name": "csreq_marshal_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
    "lines": "107-120",
    "snippet": "static void csreq_marshal_set(database_handle_t *db)\n{\n\tmowgli_patricia_iteration_state_t state;\n\tcsreq_t *cs;\n\n\tMOWGLI_PATRICIA_FOREACH(cs, &state, csreq_list)\n\t{\n\t\tdb_start_row(db, \"CSREQ\");\n\t\tdb_write_word(db, cs->name);\n\t\tdb_write_word(db, cs->mt->name);\n\t\tdb_write_time(db, cs->ts);\n\t\tdb_commit_row(db);\n\t}\n}",
    "includes": [
      "#include \"chanserv.h\"",
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static mowgli_patricia_t *csreq_list = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "db_commit_row",
          "args": [
            "db"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_write_time",
          "args": [
            "db",
            "cs->ts"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_write_word",
          "args": [
            "db",
            "cs->mt->name"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_write_word",
          "args": [
            "db",
            "cs->name"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_start_row",
          "args": [
            "db",
            "\"CSREQ\""
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MOWGLI_PATRICIA_FOREACH",
          "args": [
            "cs",
            "&state",
            "csreq_list"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic mowgli_patricia_t *csreq_list = NULL;\n\nstatic void csreq_marshal_set(database_handle_t *db)\n{\n\tmowgli_patricia_iteration_state_t state;\n\tcsreq_t *cs;\n\n\tMOWGLI_PATRICIA_FOREACH(cs, &state, csreq_list)\n\t{\n\t\tdb_start_row(db, \"CSREQ\");\n\t\tdb_write_word(db, cs->name);\n\t\tdb_write_word(db, cs->mt->name);\n\t\tdb_write_time(db, cs->ts);\n\t\tdb_commit_row(db);\n\t}\n}"
  },
  {
    "function_name": "csreq_demarshal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
    "lines": "88-105",
    "snippet": "static void csreq_demarshal(database_handle_t *db, const char *type)\n{\n        const char *chan = db_sread_word(db);\n        const char *nick = db_sread_word(db);\n        time_t req_ts = db_sread_time(db);\n\tmyentity_t *mt;\n\tcsreq_t *cs;\n\n\tmt = myentity_find(nick);\n\tif (mt == NULL)\n\t{\n\t\tslog(LG_INFO, \"csreq_demarshal(): couldn't find entity for '%s'\", nick);\n\t\treturn;\n\t}\n\n\tcs = csreq_create(chan, mt);\n\tcs->ts = req_ts;\n}",
    "includes": [
      "#include \"chanserv.h\"",
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "csreq_create",
          "args": [
            "chan",
            "mt"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "csreq_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
          "lines": "55-70",
          "snippet": "static csreq_t *csreq_create(const char *name, myentity_t *mt)\n{\n\tcsreq_t *cs;\n\n\treturn_val_if_fail(name != NULL, NULL);\n\treturn_val_if_fail(mt != NULL, NULL);\n\n\tcs = smalloc(sizeof(csreq_t));\n\tcs->name = sstrdup(name);\n\tcs->mt = mt;\n\tcs->ts = CURRTIME;\n\n\tmowgli_patricia_add(csreq_list, cs->name, cs);\n\n\treturn cs;\n}",
          "includes": [
            "#include \"chanserv.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static mowgli_patricia_t *csreq_list = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic mowgli_patricia_t *csreq_list = NULL;\n\nstatic csreq_t *csreq_create(const char *name, myentity_t *mt)\n{\n\tcsreq_t *cs;\n\n\treturn_val_if_fail(name != NULL, NULL);\n\treturn_val_if_fail(mt != NULL, NULL);\n\n\tcs = smalloc(sizeof(csreq_t));\n\tcs->name = sstrdup(name);\n\tcs->mt = mt;\n\tcs->ts = CURRTIME;\n\n\tmowgli_patricia_add(csreq_list, cs->name, cs);\n\n\treturn cs;\n}"
        }
      },
      {
        "call_info": {
          "callee": "slog",
          "args": [
            "LG_INFO",
            "\"csreq_demarshal(): couldn't find entity for '%s'\"",
            "nick"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "myentity_find",
          "args": [
            "nick"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_sread_time",
          "args": [
            "db"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_sread_word",
          "args": [
            "db"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "db_sread_word",
          "args": [
            "db"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic void csreq_demarshal(database_handle_t *db, const char *type)\n{\n        const char *chan = db_sread_word(db);\n        const char *nick = db_sread_word(db);\n        time_t req_ts = db_sread_time(db);\n\tmyentity_t *mt;\n\tcsreq_t *cs;\n\n\tmt = myentity_find(nick);\n\tif (mt == NULL)\n\t{\n\t\tslog(LG_INFO, \"csreq_demarshal(): couldn't find entity for '%s'\", nick);\n\t\treturn;\n\t}\n\n\tcs = csreq_create(chan, mt);\n\tcs->ts = req_ts;\n}"
  },
  {
    "function_name": "csreq_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
    "lines": "79-86",
    "snippet": "static void csreq_destroy(csreq_t *cs)\n{\n\treturn_if_fail(cs != NULL);\n\n\tmowgli_patricia_delete(csreq_list, cs->name);\n\tfree(cs->name);\n\tfree(cs);\n}",
    "includes": [
      "#include \"chanserv.h\"",
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static mowgli_patricia_t *csreq_list = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "cs"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "free_template_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/access.c",
          "lines": "358-371",
          "snippet": "static void free_template_list(mowgli_list_t *l)\n{\n\tmowgli_node_t *n, *tn;\n\n\treturn_if_fail(l != NULL);\n\n\tMOWGLI_ITER_FOREACH_SAFE(n, tn, l->head)\n\t{\n\t\ttemplate_t *t = n->data;\n\n\t\tmowgli_node_delete(&t->node, l);\n\t\tfree(t);\n\t}\n}",
          "includes": [
            "#include \"template.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"template.h\"\n#include \"atheme.h\"\n\nstatic void free_template_list(mowgli_list_t *l)\n{\n\tmowgli_node_t *n, *tn;\n\n\treturn_if_fail(l != NULL);\n\n\tMOWGLI_ITER_FOREACH_SAFE(n, tn, l->head)\n\t{\n\t\ttemplate_t *t = n->data;\n\n\t\tmowgli_node_delete(&t->node, l);\n\t\tfree(t);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mowgli_patricia_delete",
          "args": [
            "csreq_list",
            "cs->name"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "return_if_fail",
          "args": [
            "cs != NULL"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic mowgli_patricia_t *csreq_list = NULL;\n\nstatic void csreq_destroy(csreq_t *cs)\n{\n\treturn_if_fail(cs != NULL);\n\n\tmowgli_patricia_delete(csreq_list, cs->name);\n\tfree(cs->name);\n\tfree(cs);\n}"
  },
  {
    "function_name": "csreq_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
    "lines": "72-77",
    "snippet": "static csreq_t *csreq_find(const char *name)\n{\n\treturn_val_if_fail(name != NULL, NULL);\n\n\treturn mowgli_patricia_retrieve(csreq_list, name);\n}",
    "includes": [
      "#include \"chanserv.h\"",
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static mowgli_patricia_t *csreq_list = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mowgli_patricia_retrieve",
          "args": [
            "csreq_list",
            "name"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "return_val_if_fail",
          "args": [
            "name != NULL",
            "NULL"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic mowgli_patricia_t *csreq_list = NULL;\n\nstatic csreq_t *csreq_find(const char *name)\n{\n\treturn_val_if_fail(name != NULL, NULL);\n\n\treturn mowgli_patricia_retrieve(csreq_list, name);\n}"
  },
  {
    "function_name": "csreq_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/moderate.c",
    "lines": "55-70",
    "snippet": "static csreq_t *csreq_create(const char *name, myentity_t *mt)\n{\n\tcsreq_t *cs;\n\n\treturn_val_if_fail(name != NULL, NULL);\n\treturn_val_if_fail(mt != NULL, NULL);\n\n\tcs = smalloc(sizeof(csreq_t));\n\tcs->name = sstrdup(name);\n\tcs->mt = mt;\n\tcs->ts = CURRTIME;\n\n\tmowgli_patricia_add(csreq_list, cs->name, cs);\n\n\treturn cs;\n}",
    "includes": [
      "#include \"chanserv.h\"",
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static mowgli_patricia_t *csreq_list = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mowgli_patricia_add",
          "args": [
            "csreq_list",
            "cs->name",
            "cs"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sstrdup",
          "args": [
            "name"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smalloc",
          "args": [
            "sizeof(csreq_t)"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "return_val_if_fail",
          "args": [
            "mt != NULL",
            "NULL"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "return_val_if_fail",
          "args": [
            "name != NULL",
            "NULL"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"chanserv.h\"\n#include \"atheme.h\"\n\nstatic mowgli_patricia_t *csreq_list = NULL;\n\nstatic csreq_t *csreq_create(const char *name, myentity_t *mt)\n{\n\tcsreq_t *cs;\n\n\treturn_val_if_fail(name != NULL, NULL);\n\treturn_val_if_fail(mt != NULL, NULL);\n\n\tcs = smalloc(sizeof(csreq_t));\n\tcs->name = sstrdup(name);\n\tcs->mt = mt;\n\tcs->ts = CURRTIME;\n\n\tmowgli_patricia_add(csreq_list, cs->name, cs);\n\n\treturn cs;\n}"
  }
]