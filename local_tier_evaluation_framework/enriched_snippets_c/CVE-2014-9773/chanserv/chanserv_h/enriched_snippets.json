[
  {
    "function_name": "prefix_action_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/chanserv.h",
    "lines": "72-82",
    "snippet": "static inline void prefix_action_clear(mowgli_list_t *actions)\n{\n\tmowgli_node_t *n, *tn;\n\n\tMOWGLI_LIST_FOREACH_SAFE(n, tn, actions->head)\n\t{\n\t\tfree(n->data);\n\t\tmowgli_node_delete(n, actions);\n\t\tmowgli_node_free(n);\n\t}\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mowgli_node_free",
          "args": [
            "n"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mowgli_node_delete",
          "args": [
            "n",
            "actions"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "n->data"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "free_template_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/access.c",
          "lines": "358-371",
          "snippet": "static void free_template_list(mowgli_list_t *l)\n{\n\tmowgli_node_t *n, *tn;\n\n\treturn_if_fail(l != NULL);\n\n\tMOWGLI_ITER_FOREACH_SAFE(n, tn, l->head)\n\t{\n\t\ttemplate_t *t = n->data;\n\n\t\tmowgli_node_delete(&t->node, l);\n\t\tfree(t);\n\t}\n}",
          "includes": [
            "#include \"template.h\"",
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"template.h\"\n#include \"atheme.h\"\n\nstatic void free_template_list(mowgli_list_t *l)\n{\n\tmowgli_node_t *n, *tn;\n\n\treturn_if_fail(l != NULL);\n\n\tMOWGLI_ITER_FOREACH_SAFE(n, tn, l->head)\n\t{\n\t\ttemplate_t *t = n->data;\n\n\t\tmowgli_node_delete(&t->node, l);\n\t\tfree(t);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "MOWGLI_LIST_FOREACH_SAFE",
          "args": [
            "n",
            "tn",
            "actions->head"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void prefix_action_clear(mowgli_list_t *actions)\n{\n\tmowgli_node_t *n, *tn;\n\n\tMOWGLI_LIST_FOREACH_SAFE(n, tn, actions->head)\n\t{\n\t\tfree(n->data);\n\t\tmowgli_node_delete(n, actions);\n\t\tmowgli_node_free(n);\n\t}\n}"
  },
  {
    "function_name": "prefix_action_set_all",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/chanserv.h",
    "lines": "43-70",
    "snippet": "static inline void prefix_action_set_all(mowgli_list_t *actions, bool dfl, char *nicks)\n{\n\tchar *nick, *strtokctx = NULL;\n\tbool en;\n\n\tnick = strtok_r(nicks, \" \", &strtokctx);\n\tdo\n\t{\n\t\tswitch (*nick)\n\t\t{\n\t\tcase '-':\n\t\t\ten = false;\n\t\t\tnick++;\n\t\t\tbreak;\n\t\tcase '+':\n\t\t\ten = true;\n\t\t\tnick++;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\ten = dfl;\n\t\t}\n\n\t\tif (!strcmp(nick, \"\"))\n\t\t\tcontinue;\n\n\t\tprefix_action_set(actions, nick, en);\n\t} while ((nick = strtok_r(NULL, \" \", &strtokctx)) != NULL);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "NULL",
            "\" \"",
            "&strtokctx"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prefix_action_set",
          "args": [
            "actions",
            "nick",
            "en"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "prefix_action_set_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/chanserv.h",
          "lines": "43-70",
          "snippet": "static inline void prefix_action_set_all(mowgli_list_t *actions, bool dfl, char *nicks)\n{\n\tchar *nick, *strtokctx = NULL;\n\tbool en;\n\n\tnick = strtok_r(nicks, \" \", &strtokctx);\n\tdo\n\t{\n\t\tswitch (*nick)\n\t\t{\n\t\tcase '-':\n\t\t\ten = false;\n\t\t\tnick++;\n\t\t\tbreak;\n\t\tcase '+':\n\t\t\ten = true;\n\t\t\tnick++;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\ten = dfl;\n\t\t}\n\n\t\tif (!strcmp(nick, \"\"))\n\t\t\tcontinue;\n\n\t\tprefix_action_set(actions, nick, en);\n\t} while ((nick = strtok_r(NULL, \" \", &strtokctx)) != NULL);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "nick",
            "\"\""
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "nicks",
            "\" \"",
            "&strtokctx"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void prefix_action_set_all(mowgli_list_t *actions, bool dfl, char *nicks)\n{\n\tchar *nick, *strtokctx = NULL;\n\tbool en;\n\n\tnick = strtok_r(nicks, \" \", &strtokctx);\n\tdo\n\t{\n\t\tswitch (*nick)\n\t\t{\n\t\tcase '-':\n\t\t\ten = false;\n\t\t\tnick++;\n\t\t\tbreak;\n\t\tcase '+':\n\t\t\ten = true;\n\t\t\tnick++;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\ten = dfl;\n\t\t}\n\n\t\tif (!strcmp(nick, \"\"))\n\t\t\tcontinue;\n\n\t\tprefix_action_set(actions, nick, en);\n\t} while ((nick = strtok_r(NULL, \" \", &strtokctx)) != NULL);\n}"
  },
  {
    "function_name": "prefix_action_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/chanserv.h",
    "lines": "22-41",
    "snippet": "static inline void prefix_action_set(mowgli_list_t *actions, char *nick, bool en)\n{\n\tstruct prefix_action *act;\n\tmowgli_node_t *n;\n\n\tMOWGLI_LIST_FOREACH(n, actions->head)\n\t{\n\t\tact = n->data;\n\t\tif (!strcmp(act->nick, nick))\n\t\t{\n\t\t\tact->en = en;\n\t\t\treturn;\n\t\t}\n\t}\n\n\tact = smalloc(sizeof(*act) + strlen(nick) + 1);\n\tact->en = en;\n\tstrcpy(act->nick, nick);\n\tmowgli_node_add(act, mowgli_node_create(), actions);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mowgli_node_add",
          "args": [
            "act",
            "mowgli_node_create()",
            "actions"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mowgli_node_create",
          "args": [],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "act->nick",
            "nick"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smalloc",
          "args": [
            "sizeof(*act) + strlen(nick) + 1"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "nick"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "act->nick",
            "nick"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MOWGLI_LIST_FOREACH",
          "args": [
            "n",
            "actions->head"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline void prefix_action_set(mowgli_list_t *actions, char *nick, bool en)\n{\n\tstruct prefix_action *act;\n\tmowgli_node_t *n;\n\n\tMOWGLI_LIST_FOREACH(n, actions->head)\n\t{\n\t\tact = n->data;\n\t\tif (!strcmp(act->nick, nick))\n\t\t{\n\t\t\tact->en = en;\n\t\t\treturn;\n\t\t}\n\t}\n\n\tact = smalloc(sizeof(*act) + strlen(nick) + 1);\n\tact->en = en;\n\tstrcpy(act->nick, nick);\n\tmowgli_node_add(act, mowgli_node_create(), actions);\n}"
  },
  {
    "function_name": "custom_founder_check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/chanserv.h",
    "lines": "6-14",
    "snippet": "static inline unsigned int custom_founder_check(void)\n{\n\tchar *p;\n\n\tif (chansvs.founder_flags != NULL && (p = strchr(chansvs.founder_flags, 'F')) != NULL)\n\t\treturn flags_to_bitmask(chansvs.founder_flags, 0);\n\telse\n\t\treturn CA_INITIAL & ca_all;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flags_to_bitmask",
          "args": [
            "chansvs.founder_flags",
            "0"
          ],
          "line": 11
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "chansvs.founder_flags",
            "'F'"
          ],
          "line": 10
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline unsigned int custom_founder_check(void)\n{\n\tchar *p;\n\n\tif (chansvs.founder_flags != NULL && (p = strchr(chansvs.founder_flags, 'F')) != NULL)\n\t\treturn flags_to_bitmask(chansvs.founder_flags, 0);\n\telse\n\t\treturn CA_INITIAL & ca_all;\n}"
  }
]