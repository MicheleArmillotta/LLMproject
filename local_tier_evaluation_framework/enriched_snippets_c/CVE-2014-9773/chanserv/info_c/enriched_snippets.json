[
  {
    "function_name": "cs_cmd_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/info.c",
    "lines": "33-314",
    "snippet": "static void cs_cmd_info(sourceinfo_t *si, int parc, char *parv[])\n{\n\tmychan_t *mc;\n\tchar *name = parv[0];\n\tchar buf[BUFSIZE], strfbuf[BUFSIZE];\n\tstruct tm tm;\n\tmyuser_t *mu;\n\tmetadata_t *md;\n\tmowgli_patricia_iteration_state_t state;\n\thook_channel_req_t req;\n\tbool hide_info, hide_acl;\n\n\tif (!name)\n\t{\n\t\tcommand_fail(si, fault_needmoreparams, STR_INSUFFICIENT_PARAMS, \"INFO\");\n\t\tcommand_fail(si, fault_needmoreparams, _(\"Syntax: INFO <#channel>\"));\n\t\treturn;\n\t}\n\n\tif (*name != '#')\n\t{\n\t\tcommand_fail(si, fault_badparams, STR_INVALID_PARAMS, \"INFO\");\n\t\tcommand_fail(si, fault_badparams, _(\"Syntax: INFO <#channel>\"));\n\t\treturn;\n\t}\n\n\tif (!(mc = mychan_find(name)))\n\t{\n\t\tcommand_fail(si, fault_nosuch_target, _(\"Channel \\2%s\\2 is not registered.\"), name);\n\t\treturn;\n\t}\n\n\tif (!has_priv(si, PRIV_CHAN_AUSPEX) && metadata_find(mc, \"private:close:closer\"))\n\t{\n\t\tcommand_fail(si, fault_noprivs, _(\"\\2%s\\2 has been closed down by the %s administration.\"), mc->name, me.netname);\n\t\treturn;\n\t}\n\n\thide_info = use_channel_private && mc->flags & MC_PRIVATE &&\n\t\t!chanacs_source_has_flag(mc, si, CA_ACLVIEW) &&\n\t\t!has_priv(si, PRIV_CHAN_AUSPEX);\n\thide_acl = !chanacs_source_has_flag(mc, si, CA_ACLVIEW) &&\n\t\t!has_priv(si, PRIV_CHAN_AUSPEX) &&\n\t\t!(mc->flags & MC_PUBACL);\n\n\ttm = *localtime(&mc->registered);\n\tstrftime(strfbuf, sizeof strfbuf, TIME_FORMAT, &tm);\n\n\tcommand_success_nodata(si, _(\"Information on \\2%s\\2:\"), mc->name);\n\n\tif (!(hide_info && hide_acl))\n\t\tcommand_success_nodata(si, _(\"Founder    : %s\"), mychan_founder_names(mc));\n\n\tif (!hide_acl)\n\t{\n\t\tmu = mychan_pick_successor(mc);\n\t\tif (mu != NULL)\n\t\t\tcommand_success_nodata(si, _(\"Successor  : %s\"), entity(mu)->name);\n\t\telse\n\t\t\tcommand_success_nodata(si, _(\"Successor  : (none)\"));\n\t}\n\n\tcommand_success_nodata(si, _(\"Registered : %s (%s ago)\"), strfbuf, time_ago(mc->registered));\n\n\tif (CURRTIME - mc->used >= 86400)\n\t{\n\t\tif (hide_info)\n\t\t\tcommand_success_nodata(si, _(\"Last used  : (about %d weeks ago)\"), (int)((CURRTIME - mc->used) / 604800));\n\t\telse\n\t\t{\n\t\t\ttm = *localtime(&mc->used);\n\t\t\tstrftime(strfbuf, sizeof strfbuf, TIME_FORMAT, &tm);\n\t\t\tcommand_success_nodata(si, _(\"Last used  : %s (%s ago)\"), strfbuf, time_ago(mc->used));\n\t\t}\n\t}\n\n\tmd = metadata_find(mc, \"private:mlockext\");\n\tif (mc->mlock_on || mc->mlock_off || mc->mlock_limit || mc->mlock_key || md)\n\t{\n\t\tif (md != NULL && strlen(md->value) > 450)\n\t\t{\n\t\t\t/* Be safe */\n\t\t\tcommand_success_nodata(si, _(\"Mode lock is too long, not entirely shown\"));\n\t\t\tmd = NULL;\n\t\t}\n\n\t\tcommand_success_nodata(si, _(\"Mode lock  : %s\"), mychan_get_mlock(mc));\n\t}\n\n\n\tif ((!hide_info || (si->su != NULL && chanuser_find(mc->chan, si->su))) &&\n\t\t\t(md = metadata_find(mc, \"url\")))\n\t\tcommand_success_nodata(si, \"URL        : %s\", md->value);\n\n\tif (!hide_info && (md = metadata_find(mc, \"email\")))\n\t\tcommand_success_nodata(si, \"Email      : %s\", md->value);\n\n\tif ((!hide_info || (si->su != NULL && chanuser_find(mc->chan, si->su))) &&\n\t\t\t(md = metadata_find(mc, \"private:entrymsg\")))\n\t\tcommand_success_nodata(si, \"Entrymsg   : %s\", md->value);\n\n\tif (!hide_info)\n\t{\n\t\tMOWGLI_PATRICIA_FOREACH(md, &state, object(mc)->metadata)\n\t\t{\n\t\t\tif (!strncmp(md->name, \"private:\", 8))\n\t\t\t\tcontinue;\n\t\t\t/* these are shown separately */\n\t\t\tif (!strcasecmp(md->name, \"email\") ||\n\t\t\t\t\t!strcasecmp(md->name, \"url\") ||\n\t\t\t\t\t!strcasecmp(md->name, \"disable_fantasy\"))\n\t\t\t\tcontinue;\n\t\t\tcommand_success_nodata(si, _(\"Metadata   : %s = %s\"),\n\t\t\t\t\tmd->name, md->value);\n\t\t}\n\t}\n\n\t*buf = '\\0';\n\n\tif (MC_HOLD & mc->flags)\n\t\tstrcat(buf, \"HOLD\");\n\n\tif (MC_SECURE & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"SECURE\");\n\t}\n\n\tif (MC_VERBOSE & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"VERBOSE\");\n\t}\n\tif (MC_VERBOSE_OPS & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"VERBOSE_OPS\");\n\t}\n\n\tif (MC_RESTRICTED & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"RESTRICTED\");\n\t}\n\n\tif (MC_KEEPTOPIC & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"KEEPTOPIC\");\n\t}\n\n\tif (MC_TOPICLOCK & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"TOPICLOCK\");\n\t}\n\n\tif (MC_GUARD & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"GUARD\");\n\t}\n\n\tif (MC_ANTIFLOOD & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"ANTIFLOOD\");\n\t}\n\n\tif (chansvs.fantasy && !metadata_find(mc, \"disable_fantasy\"))\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"FANTASY\");\n\t}\n\t\n\tif (MC_NOSYNC & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"NOSYNC\");\n\t}\n\n\tif (use_channel_private && MC_PRIVATE & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"PRIVATE\");\n\t}\n\n\tif (MC_PUBACL & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"PUBACL\");\n\t}\n\n\tif (use_limitflags && MC_LIMITFLAGS & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"LIMITFLAGS\");\n\t}\n\n\tif (*buf)\n\t\tcommand_success_nodata(si, _(\"Flags      : %s\"), buf);\n\n\tif (chansvs.fantasy && !metadata_find(mc, \"disable_fantasy\"))\n\t{\n\t\tif ((md = metadata_find(mc, \"private:prefix\")))\n\t\t\tcommand_success_nodata(si, _(\"Prefix     : %s\"), md->value);\n\t\telse\n\t\t\tcommand_success_nodata(si, _(\"Prefix     : %s (default)\"), chansvs.trigger);\n\t}\n\n\tif (has_priv(si, PRIV_CHAN_AUSPEX) && (md = metadata_find(mc, \"private:mark:setter\")))\n\t{\n\t\tconst char *setter = md->value;\n\t\tconst char *reason;\n\t\ttime_t ts;\n\n\t\tmd = metadata_find(mc, \"private:mark:reason\");\n\t\treason = md != NULL ? md->value : \"unknown\";\n\n\t\tmd = metadata_find(mc, \"private:mark:timestamp\");\n\t\tts = md != NULL ? atoi(md->value) : 0;\n\n\t\ttm = *localtime(&ts);\n\t\tstrftime(strfbuf, sizeof strfbuf, TIME_FORMAT, &tm);\n\n\t\tcommand_success_nodata(si, _(\"%s was \\2MARKED\\2 by %s on %s (%s)\"), mc->name, setter, strfbuf, reason);\n\t}\n\n\tif (has_priv(si, PRIV_CHAN_AUSPEX) && (MC_INHABIT & mc->flags))\n\t\tcommand_success_nodata(si, _(\"%s is temporarily holding this channel.\"), chansvs.nick);\n\n\tif (has_priv(si, PRIV_CHAN_AUSPEX) && (md = metadata_find(mc, \"private:close:closer\")))\n\t{\n\t\tconst char *setter = md->value;\n\t\tconst char *reason;\n\t\ttime_t ts;\n\n\t\tmd = metadata_find(mc, \"private:close:reason\");\n\t\treason = md != NULL ? md->value : \"unknown\";\n\n\t\tmd = metadata_find(mc, \"private:close:timestamp\");\n\t\tts = md != NULL ? atoi(md->value) : 0;\n\n\t\ttm = *localtime(&ts);\n\t\tstrftime(strfbuf, sizeof strfbuf, TIME_FORMAT, &tm);\n\n\t\tcommand_success_nodata(si, _(\"%s was \\2CLOSED\\2 by %s on %s (%s)\"), mc->name, setter, strfbuf, reason);\n\t}\n\n\treq.mc = mc;\n\treq.si = si;\n\thook_call_channel_info(&req);\n\n\tcommand_success_nodata(si, _(\"\\2*** End of Info ***\\2\"));\n\tlogcommand(si, CMDLOG_GET, \"INFO: \\2%s\\2\", mc->name);\n}",
    "includes": [
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void cs_cmd_info(sourceinfo_t *si, int parc, char *parv[]);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "logcommand",
          "args": [
            "si",
            "CMDLOG_GET",
            "\"INFO: \\2%s\\2\"",
            "mc->name"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"\\2*** End of Info ***\\2\")"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"\\2*** End of Info ***\\2\""
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "_moddeinit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/info.c",
          "lines": "28-31",
          "snippet": "void _moddeinit(module_unload_intent_t intent)\n{\n\tservice_named_unbind_command(\"chanserv\", &cs_info);\n}",
          "includes": [
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "command_t cs_info = { \"INFO\", N_(\"Displays information on registrations.\"),\n                        AC_NONE, 2, cs_cmd_info, { .path = \"cservice/info\" } };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atheme.h\"\n\ncommand_t cs_info = { \"INFO\", N_(\"Displays information on registrations.\"),\n                        AC_NONE, 2, cs_cmd_info, { .path = \"cservice/info\" } };\n\nvoid _moddeinit(module_unload_intent_t intent)\n{\n\tservice_named_unbind_command(\"chanserv\", &cs_info);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hook_call_channel_info",
          "args": [
            "&req"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"%s was \\2CLOSED\\2 by %s on %s (%s)\")",
            "mc->name",
            "setter",
            "strfbuf",
            "reason"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strftime",
          "args": [
            "strfbuf",
            "sizeof strfbuf",
            "TIME_FORMAT",
            "&tm"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "localtime",
          "args": [
            "&ts"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atoi",
          "args": [
            "md->value"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_find",
          "args": [
            "mc",
            "\"private:close:timestamp\""
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_find",
          "args": [
            "mc",
            "\"private:close:reason\""
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_find",
          "args": [
            "mc",
            "\"private:close:closer\""
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_priv",
          "args": [
            "si",
            "PRIV_CHAN_AUSPEX"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"%s is temporarily holding this channel.\")",
            "chansvs.nick"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_priv",
          "args": [
            "si",
            "PRIV_CHAN_AUSPEX"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"%s was \\2MARKED\\2 by %s on %s (%s)\")",
            "mc->name",
            "setter",
            "strfbuf",
            "reason"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strftime",
          "args": [
            "strfbuf",
            "sizeof strfbuf",
            "TIME_FORMAT",
            "&tm"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "localtime",
          "args": [
            "&ts"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atoi",
          "args": [
            "md->value"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_find",
          "args": [
            "mc",
            "\"private:mark:timestamp\""
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_find",
          "args": [
            "mc",
            "\"private:mark:reason\""
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_find",
          "args": [
            "mc",
            "\"private:mark:setter\""
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_priv",
          "args": [
            "si",
            "PRIV_CHAN_AUSPEX"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"Prefix     : %s (default)\")",
            "chansvs.trigger"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"Prefix     : %s\")",
            "md->value"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_find",
          "args": [
            "mc",
            "\"private:prefix\""
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_find",
          "args": [
            "mc",
            "\"disable_fantasy\""
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"Flags      : %s\")",
            "buf"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\"LIMITFLAGS\""
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\" \""
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\"PUBACL\""
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\" \""
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\"PRIVATE\""
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\" \""
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\"NOSYNC\""
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\" \""
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\"FANTASY\""
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\" \""
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_find",
          "args": [
            "mc",
            "\"disable_fantasy\""
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\"ANTIFLOOD\""
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\" \""
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\"GUARD\""
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\" \""
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\"TOPICLOCK\""
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\" \""
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\"KEEPTOPIC\""
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\" \""
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\"RESTRICTED\""
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\" \""
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\"VERBOSE_OPS\""
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\" \""
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\"VERBOSE\""
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\" \""
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\"SECURE\""
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\" \""
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "buf",
            "\"HOLD\""
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"Metadata   : %s = %s\")",
            "md->name",
            "md->value"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "md->name",
            "\"disable_fantasy\""
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "md->name",
            "\"url\""
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "md->name",
            "\"email\""
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "md->name",
            "\"private:\"",
            "8"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MOWGLI_PATRICIA_FOREACH",
          "args": [
            "md",
            "&state",
            "object(mc)->metadata"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "object",
          "args": [
            "mc"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "\"Entrymsg   : %s\"",
            "md->value"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_find",
          "args": [
            "mc",
            "\"private:entrymsg\""
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chanuser_find",
          "args": [
            "mc->chan",
            "si->su"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "\"Email      : %s\"",
            "md->value"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_find",
          "args": [
            "mc",
            "\"email\""
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "\"URL        : %s\"",
            "md->value"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_find",
          "args": [
            "mc",
            "\"url\""
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chanuser_find",
          "args": [
            "mc->chan",
            "si->su"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"Mode lock  : %s\")",
            "mychan_get_mlock(mc)"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mychan_get_mlock",
          "args": [
            "mc"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"Mode lock is too long, not entirely shown\")"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "md->value"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_find",
          "args": [
            "mc",
            "\"private:mlockext\""
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"Last used  : %s (%s ago)\")",
            "strfbuf",
            "time_ago(mc->used)"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time_ago",
          "args": [
            "mc->used"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strftime",
          "args": [
            "strfbuf",
            "sizeof strfbuf",
            "TIME_FORMAT",
            "&tm"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "localtime",
          "args": [
            "&mc->used"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"Last used  : (about %d weeks ago)\")",
            "(int)((CURRTIME - mc->used) / 604800)"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"Registered : %s (%s ago)\")",
            "strfbuf",
            "time_ago(mc->registered)"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time_ago",
          "args": [
            "mc->registered"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"Successor  : (none)\")"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"Successor  : %s\")",
            "entity(mu)->name"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "entity",
          "args": [
            "mu"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mychan_pick_successor",
          "args": [
            "mc"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"Founder    : %s\")",
            "mychan_founder_names(mc)"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mychan_founder_names",
          "args": [
            "mc"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"Information on \\2%s\\2:\")",
            "mc->name"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strftime",
          "args": [
            "strfbuf",
            "sizeof strfbuf",
            "TIME_FORMAT",
            "&tm"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "localtime",
          "args": [
            "&mc->registered"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_priv",
          "args": [
            "si",
            "PRIV_CHAN_AUSPEX"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chanacs_source_has_flag",
          "args": [
            "mc",
            "si",
            "CA_ACLVIEW"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_priv",
          "args": [
            "si",
            "PRIV_CHAN_AUSPEX"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chanacs_source_has_flag",
          "args": [
            "mc",
            "si",
            "CA_ACLVIEW"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_noprivs",
            "_(\"\\2%s\\2 has been closed down by the %s administration.\")",
            "mc->name",
            "me.netname"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_find",
          "args": [
            "mc",
            "\"private:close:closer\""
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_priv",
          "args": [
            "si",
            "PRIV_CHAN_AUSPEX"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_nosuch_target",
            "_(\"Channel \\2%s\\2 is not registered.\")",
            "name"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mychan_find",
          "args": [
            "name"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_badparams",
            "_(\"Syntax: INFO <#channel>\")"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_badparams",
            "STR_INVALID_PARAMS",
            "\"INFO\""
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_needmoreparams",
            "_(\"Syntax: INFO <#channel>\")"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_needmoreparams",
            "STR_INSUFFICIENT_PARAMS",
            "\"INFO\""
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atheme.h\"\n\nstatic void cs_cmd_info(sourceinfo_t *si, int parc, char *parv[]);\n\nstatic void cs_cmd_info(sourceinfo_t *si, int parc, char *parv[])\n{\n\tmychan_t *mc;\n\tchar *name = parv[0];\n\tchar buf[BUFSIZE], strfbuf[BUFSIZE];\n\tstruct tm tm;\n\tmyuser_t *mu;\n\tmetadata_t *md;\n\tmowgli_patricia_iteration_state_t state;\n\thook_channel_req_t req;\n\tbool hide_info, hide_acl;\n\n\tif (!name)\n\t{\n\t\tcommand_fail(si, fault_needmoreparams, STR_INSUFFICIENT_PARAMS, \"INFO\");\n\t\tcommand_fail(si, fault_needmoreparams, _(\"Syntax: INFO <#channel>\"));\n\t\treturn;\n\t}\n\n\tif (*name != '#')\n\t{\n\t\tcommand_fail(si, fault_badparams, STR_INVALID_PARAMS, \"INFO\");\n\t\tcommand_fail(si, fault_badparams, _(\"Syntax: INFO <#channel>\"));\n\t\treturn;\n\t}\n\n\tif (!(mc = mychan_find(name)))\n\t{\n\t\tcommand_fail(si, fault_nosuch_target, _(\"Channel \\2%s\\2 is not registered.\"), name);\n\t\treturn;\n\t}\n\n\tif (!has_priv(si, PRIV_CHAN_AUSPEX) && metadata_find(mc, \"private:close:closer\"))\n\t{\n\t\tcommand_fail(si, fault_noprivs, _(\"\\2%s\\2 has been closed down by the %s administration.\"), mc->name, me.netname);\n\t\treturn;\n\t}\n\n\thide_info = use_channel_private && mc->flags & MC_PRIVATE &&\n\t\t!chanacs_source_has_flag(mc, si, CA_ACLVIEW) &&\n\t\t!has_priv(si, PRIV_CHAN_AUSPEX);\n\thide_acl = !chanacs_source_has_flag(mc, si, CA_ACLVIEW) &&\n\t\t!has_priv(si, PRIV_CHAN_AUSPEX) &&\n\t\t!(mc->flags & MC_PUBACL);\n\n\ttm = *localtime(&mc->registered);\n\tstrftime(strfbuf, sizeof strfbuf, TIME_FORMAT, &tm);\n\n\tcommand_success_nodata(si, _(\"Information on \\2%s\\2:\"), mc->name);\n\n\tif (!(hide_info && hide_acl))\n\t\tcommand_success_nodata(si, _(\"Founder    : %s\"), mychan_founder_names(mc));\n\n\tif (!hide_acl)\n\t{\n\t\tmu = mychan_pick_successor(mc);\n\t\tif (mu != NULL)\n\t\t\tcommand_success_nodata(si, _(\"Successor  : %s\"), entity(mu)->name);\n\t\telse\n\t\t\tcommand_success_nodata(si, _(\"Successor  : (none)\"));\n\t}\n\n\tcommand_success_nodata(si, _(\"Registered : %s (%s ago)\"), strfbuf, time_ago(mc->registered));\n\n\tif (CURRTIME - mc->used >= 86400)\n\t{\n\t\tif (hide_info)\n\t\t\tcommand_success_nodata(si, _(\"Last used  : (about %d weeks ago)\"), (int)((CURRTIME - mc->used) / 604800));\n\t\telse\n\t\t{\n\t\t\ttm = *localtime(&mc->used);\n\t\t\tstrftime(strfbuf, sizeof strfbuf, TIME_FORMAT, &tm);\n\t\t\tcommand_success_nodata(si, _(\"Last used  : %s (%s ago)\"), strfbuf, time_ago(mc->used));\n\t\t}\n\t}\n\n\tmd = metadata_find(mc, \"private:mlockext\");\n\tif (mc->mlock_on || mc->mlock_off || mc->mlock_limit || mc->mlock_key || md)\n\t{\n\t\tif (md != NULL && strlen(md->value) > 450)\n\t\t{\n\t\t\t/* Be safe */\n\t\t\tcommand_success_nodata(si, _(\"Mode lock is too long, not entirely shown\"));\n\t\t\tmd = NULL;\n\t\t}\n\n\t\tcommand_success_nodata(si, _(\"Mode lock  : %s\"), mychan_get_mlock(mc));\n\t}\n\n\n\tif ((!hide_info || (si->su != NULL && chanuser_find(mc->chan, si->su))) &&\n\t\t\t(md = metadata_find(mc, \"url\")))\n\t\tcommand_success_nodata(si, \"URL        : %s\", md->value);\n\n\tif (!hide_info && (md = metadata_find(mc, \"email\")))\n\t\tcommand_success_nodata(si, \"Email      : %s\", md->value);\n\n\tif ((!hide_info || (si->su != NULL && chanuser_find(mc->chan, si->su))) &&\n\t\t\t(md = metadata_find(mc, \"private:entrymsg\")))\n\t\tcommand_success_nodata(si, \"Entrymsg   : %s\", md->value);\n\n\tif (!hide_info)\n\t{\n\t\tMOWGLI_PATRICIA_FOREACH(md, &state, object(mc)->metadata)\n\t\t{\n\t\t\tif (!strncmp(md->name, \"private:\", 8))\n\t\t\t\tcontinue;\n\t\t\t/* these are shown separately */\n\t\t\tif (!strcasecmp(md->name, \"email\") ||\n\t\t\t\t\t!strcasecmp(md->name, \"url\") ||\n\t\t\t\t\t!strcasecmp(md->name, \"disable_fantasy\"))\n\t\t\t\tcontinue;\n\t\t\tcommand_success_nodata(si, _(\"Metadata   : %s = %s\"),\n\t\t\t\t\tmd->name, md->value);\n\t\t}\n\t}\n\n\t*buf = '\\0';\n\n\tif (MC_HOLD & mc->flags)\n\t\tstrcat(buf, \"HOLD\");\n\n\tif (MC_SECURE & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"SECURE\");\n\t}\n\n\tif (MC_VERBOSE & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"VERBOSE\");\n\t}\n\tif (MC_VERBOSE_OPS & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"VERBOSE_OPS\");\n\t}\n\n\tif (MC_RESTRICTED & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"RESTRICTED\");\n\t}\n\n\tif (MC_KEEPTOPIC & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"KEEPTOPIC\");\n\t}\n\n\tif (MC_TOPICLOCK & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"TOPICLOCK\");\n\t}\n\n\tif (MC_GUARD & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"GUARD\");\n\t}\n\n\tif (MC_ANTIFLOOD & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"ANTIFLOOD\");\n\t}\n\n\tif (chansvs.fantasy && !metadata_find(mc, \"disable_fantasy\"))\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"FANTASY\");\n\t}\n\t\n\tif (MC_NOSYNC & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"NOSYNC\");\n\t}\n\n\tif (use_channel_private && MC_PRIVATE & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"PRIVATE\");\n\t}\n\n\tif (MC_PUBACL & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"PUBACL\");\n\t}\n\n\tif (use_limitflags && MC_LIMITFLAGS & mc->flags)\n\t{\n\t\tif (*buf)\n\t\t\tstrcat(buf, \" \");\n\n\t\tstrcat(buf, \"LIMITFLAGS\");\n\t}\n\n\tif (*buf)\n\t\tcommand_success_nodata(si, _(\"Flags      : %s\"), buf);\n\n\tif (chansvs.fantasy && !metadata_find(mc, \"disable_fantasy\"))\n\t{\n\t\tif ((md = metadata_find(mc, \"private:prefix\")))\n\t\t\tcommand_success_nodata(si, _(\"Prefix     : %s\"), md->value);\n\t\telse\n\t\t\tcommand_success_nodata(si, _(\"Prefix     : %s (default)\"), chansvs.trigger);\n\t}\n\n\tif (has_priv(si, PRIV_CHAN_AUSPEX) && (md = metadata_find(mc, \"private:mark:setter\")))\n\t{\n\t\tconst char *setter = md->value;\n\t\tconst char *reason;\n\t\ttime_t ts;\n\n\t\tmd = metadata_find(mc, \"private:mark:reason\");\n\t\treason = md != NULL ? md->value : \"unknown\";\n\n\t\tmd = metadata_find(mc, \"private:mark:timestamp\");\n\t\tts = md != NULL ? atoi(md->value) : 0;\n\n\t\ttm = *localtime(&ts);\n\t\tstrftime(strfbuf, sizeof strfbuf, TIME_FORMAT, &tm);\n\n\t\tcommand_success_nodata(si, _(\"%s was \\2MARKED\\2 by %s on %s (%s)\"), mc->name, setter, strfbuf, reason);\n\t}\n\n\tif (has_priv(si, PRIV_CHAN_AUSPEX) && (MC_INHABIT & mc->flags))\n\t\tcommand_success_nodata(si, _(\"%s is temporarily holding this channel.\"), chansvs.nick);\n\n\tif (has_priv(si, PRIV_CHAN_AUSPEX) && (md = metadata_find(mc, \"private:close:closer\")))\n\t{\n\t\tconst char *setter = md->value;\n\t\tconst char *reason;\n\t\ttime_t ts;\n\n\t\tmd = metadata_find(mc, \"private:close:reason\");\n\t\treason = md != NULL ? md->value : \"unknown\";\n\n\t\tmd = metadata_find(mc, \"private:close:timestamp\");\n\t\tts = md != NULL ? atoi(md->value) : 0;\n\n\t\ttm = *localtime(&ts);\n\t\tstrftime(strfbuf, sizeof strfbuf, TIME_FORMAT, &tm);\n\n\t\tcommand_success_nodata(si, _(\"%s was \\2CLOSED\\2 by %s on %s (%s)\"), mc->name, setter, strfbuf, reason);\n\t}\n\n\treq.mc = mc;\n\treq.si = si;\n\thook_call_channel_info(&req);\n\n\tcommand_success_nodata(si, _(\"\\2*** End of Info ***\\2\"));\n\tlogcommand(si, CMDLOG_GET, \"INFO: \\2%s\\2\", mc->name);\n}"
  },
  {
    "function_name": "_moddeinit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/info.c",
    "lines": "28-31",
    "snippet": "void _moddeinit(module_unload_intent_t intent)\n{\n\tservice_named_unbind_command(\"chanserv\", &cs_info);\n}",
    "includes": [
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "command_t cs_info = { \"INFO\", N_(\"Displays information on registrations.\"),\n                        AC_NONE, 2, cs_cmd_info, { .path = \"cservice/info\" } };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "service_named_unbind_command",
          "args": [
            "\"chanserv\"",
            "&cs_info"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atheme.h\"\n\ncommand_t cs_info = { \"INFO\", N_(\"Displays information on registrations.\"),\n                        AC_NONE, 2, cs_cmd_info, { .path = \"cservice/info\" } };\n\nvoid _moddeinit(module_unload_intent_t intent)\n{\n\tservice_named_unbind_command(\"chanserv\", &cs_info);\n}"
  },
  {
    "function_name": "_modinit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/info.c",
    "lines": "23-26",
    "snippet": "void _modinit(module_t *m)\n{\n        service_named_bind_command(\"chanserv\", &cs_info);\n}",
    "includes": [
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "command_t cs_info = { \"INFO\", N_(\"Displays information on registrations.\"),\n                        AC_NONE, 2, cs_cmd_info, { .path = \"cservice/info\" } };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "service_named_bind_command",
          "args": [
            "\"chanserv\"",
            "&cs_info"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atheme.h\"\n\ncommand_t cs_info = { \"INFO\", N_(\"Displays information on registrations.\"),\n                        AC_NONE, 2, cs_cmd_info, { .path = \"cservice/info\" } };\n\nvoid _modinit(module_t *m)\n{\n        service_named_bind_command(\"chanserv\", &cs_info);\n}"
  }
]