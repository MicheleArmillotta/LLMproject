[
  {
    "function_name": "cs_cmd_why",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/why.c",
    "lines": "33-163",
    "snippet": "static void cs_cmd_why(sourceinfo_t *si, int parc, char *parv[])\n{\n\tconst char *chan = parv[0];\n\tconst char *targ = parv[1];\n\tmychan_t *mc;\n\tuser_t *u;\n\tmyuser_t *mu;\n\tmowgli_node_t *n;\n\tchanacs_t *ca;\n\tentity_chanacs_validation_vtable_t *vt;\n\tmetadata_t *md;\n\tbool operoverride = false;\n\tint fl = 0;\n\n\tif (!chan || (!targ && si->su == NULL))\n\t{\n\t\tcommand_fail(si, fault_needmoreparams, STR_INSUFFICIENT_PARAMS, \"WHY\");\n\t\tcommand_fail(si, fault_needmoreparams, _(\"Syntax: WHY <channel> [user]\"));\n\t\treturn;\n\t}\n\n\tif (!targ)\n\t\ttarg = si->su->nick;\n\n\tmc = mychan_find(chan);\n\tu = user_find_named(targ);\n\n\tif (u == NULL)\n\t{\n\t\tcommand_fail(si, fault_nosuch_target, _(\"\\2%s\\2 is not online.\"),\n\t\t\ttarg);\n\t\treturn;\n\t}\n\n\tmu = u->myuser;\n\n\tif (mc == NULL)\n\t{\n\t\tcommand_fail(si, fault_nosuch_target, _(\"Channel \\2%s\\2 is not registered.\"),\n\t\t\tchan);\n\t\treturn;\n\t}\n\n\tif (!(mc->flags & MC_PUBACL) && !chanacs_source_has_flag(mc, si, CA_ACLVIEW))\n\t{\n\t\tif (has_priv(si, PRIV_CHAN_AUSPEX))\n\t\t\toperoverride = true;\n\t\telse\n\t\t{\n\t\t\tcommand_fail(si, fault_noprivs, _(\"You are not authorized to perform this operation.\"));\n\t\t\treturn;\n\t\t}\n\t}\n\n\tif (metadata_find(mc, \"private:close:closer\"))\n\t{\n\t\tcommand_fail(si, fault_noprivs, _(\"\\2%s\\2 is closed.\"), chan);\n\t\treturn;\n\t}\n\n\tif (operoverride)\n\t\tlogcommand(si, CMDLOG_ADMIN, \"WHY: \\2%s!%s@%s\\2 on \\2%s\\2 (oper override)\", u->nick, u->user, u->vhost, mc->name);\n\telse\n\t\tlogcommand(si, CMDLOG_GET, \"WHY: \\2%s!%s@%s\\2 on \\2%s\\2\", u->nick, u->user, u->vhost, mc->name);\n\n\tMOWGLI_ITER_FOREACH(n, mc->chanacs.head)\n\t{\n\t\tca = (chanacs_t *)n->data;\n\n\t\tif (ca->entity == NULL)\n\t\t\tcontinue;\n\t\tvt = myentity_get_chanacs_validator(ca->entity);\n\t\tif (ca->entity == entity(u->myuser) ||\n\t\t\t\t(vt->match_user != NULL ?\n\t\t\t\t vt->match_user(ca, u) != NULL :\n\t\t\t\t u->myuser != NULL &&\n\t\t\t\t vt->match_entity(ca, entity(u->myuser)) != NULL))\n\t\t{\n\t\t\tfl |= ca->level;\n\t\t\tif (ca->entity == entity(u->myuser))\n\t\t\t\tcommand_success_nodata(si,\n\t\t\t\t\t\"\\2%s\\2 has flags \\2%s\\2 in \\2%s\\2 because they are logged in as \\2%s\\2.\",\n\t\t\t\t\tu->nick, bitmask_to_flags2(ca->level, 0), mc->name, ca->entity->name);\n\t\t\telse if (isgroup(ca->entity))\n\t\t\t\tcommand_success_nodata(si,\n\t\t\t\t\t\"\\2%s\\2 has flags \\2%s\\2 in \\2%s\\2 because they are a member of \\2%s\\2.\",\n\t\t\t\t\tu->nick, bitmask_to_flags2(ca->level, 0), mc->name, ca->entity->name);\n\t\t\telse\n\t\t\t\tcommand_success_nodata(si,\n\t\t\t\t\t\"\\2%s\\2 has flags \\2%s\\2 in \\2%s\\2 because they match \\2%s\\2.\",\n\t\t\t\t\tu->nick, bitmask_to_flags2(ca->level, 0), mc->name, ca->entity->name);\n\t\t\tif (ca->level & CA_AKICK)\n\t\t\t{\n\t\t\t\tmd = metadata_find(ca, \"reason\");\n\t\t\t\tif (md != NULL)\n\t\t\t\t\tcommand_success_nodata(si, \"Ban reason: %s\", md->value);\n\t\t\t}\n\t\t}\n\t}\n\tfor (n = next_matching_host_chanacs(mc, u, mc->chanacs.head); n != NULL; n = next_matching_host_chanacs(mc, u, n->next))\n\t{\n\t\tca = n->data;\n\t\tfl |= ca->level;\n\t\tcommand_success_nodata(si,\n\t\t\t\t\"\\2%s\\2 has flags \\2%s\\2 in \\2%s\\2 because they match the mask \\2%s\\2.\",\n\t\t\t\tu->nick, bitmask_to_flags2(ca->level, 0), mc->name, ca->host);\n\t\tif (ca->level & CA_AKICK)\n\t\t{\n\t\t\tmd = metadata_find(ca, \"reason\");\n\t\t\tif (md != NULL)\n\t\t\t\tcommand_success_nodata(si, \"Ban reason: %s\", md->value);\n\t\t}\n\t}\n\n\tif (fl & (CA_AUTOOP | CA_AUTOHALFOP | CA_AUTOVOICE))\n\t{\n\t\tif (mc->flags & MC_NOOP)\n\t\t\tcommand_success_nodata(si, _(\"The \\2%s\\2 flag is set for \\2%s\\2, therefore no status will be given.\"),\n\t\t\t\t\t\"NOOP\",\n\t\t\t\t\tmc->name);\n\t\telse if (mu != NULL && mu->flags & MU_NOOP)\n\t\t\tcommand_success_nodata(si, _(\"The \\2%s\\2 flag is set for \\2%s\\2, therefore no status will be given.\"),\n\t\t\t\t\t\"NOOP\",\n\t\t\t\t\tentity(mu)->name);\n\t}\n\tif ((fl & (CA_AKICK | CA_EXEMPT)) == (CA_AKICK | CA_EXEMPT))\n\t\tcommand_success_nodata(si, _(\"+e exempts from +b.\"));\n\telse if (fl == 0)\n\t\tcommand_success_nodata(si, _(\"\\2%s\\2 has no special access to \\2%s\\2.\"),\n\t\t\t\tu->nick, mc->name);\n}",
    "includes": [
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void cs_cmd_why(sourceinfo_t *si, int parc, char *parv[]);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"\\2%s\\2 has no special access to \\2%s\\2.\")",
            "u->nick",
            "mc->name"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"\\2%s\\2 has no special access to \\2%s\\2.\""
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "_moddeinit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/why.c",
          "lines": "28-31",
          "snippet": "void _moddeinit(module_unload_intent_t intent)\n{\n\tservice_named_unbind_command(\"chanserv\", &cs_why);\n}",
          "includes": [
            "#include \"atheme.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "command_t cs_why = { \"WHY\", N_(\"Explains channel access logic.\"),\n\t\t     AC_NONE, 2, cs_cmd_why, { .path = \"cservice/why\" } };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atheme.h\"\n\ncommand_t cs_why = { \"WHY\", N_(\"Explains channel access logic.\"),\n\t\t     AC_NONE, 2, cs_cmd_why, { .path = \"cservice/why\" } };\n\nvoid _moddeinit(module_unload_intent_t intent)\n{\n\tservice_named_unbind_command(\"chanserv\", &cs_why);\n}"
        }
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"+e exempts from +b.\")"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"The \\2%s\\2 flag is set for \\2%s\\2, therefore no status will be given.\")",
            "\"NOOP\"",
            "entity(mu)->name"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "entity",
          "args": [
            "mu"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "_(\"The \\2%s\\2 flag is set for \\2%s\\2, therefore no status will be given.\")",
            "\"NOOP\"",
            "mc->name"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "\"Ban reason: %s\"",
            "md->value"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_find",
          "args": [
            "ca",
            "\"reason\""
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "\"\\2%s\\2 has flags \\2%s\\2 in \\2%s\\2 because they match the mask \\2%s\\2.\"",
            "u->nick",
            "bitmask_to_flags2(ca->level, 0)",
            "mc->name",
            "ca->host"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitmask_to_flags2",
          "args": [
            "ca->level",
            "0"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "next_matching_host_chanacs",
          "args": [
            "mc",
            "u",
            "n->next"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "next_matching_host_chanacs",
          "args": [
            "mc",
            "u",
            "mc->chanacs.head"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "\"Ban reason: %s\"",
            "md->value"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_find",
          "args": [
            "ca",
            "\"reason\""
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "\"\\2%s\\2 has flags \\2%s\\2 in \\2%s\\2 because they match \\2%s\\2.\"",
            "u->nick",
            "bitmask_to_flags2(ca->level, 0)",
            "mc->name",
            "ca->entity->name"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitmask_to_flags2",
          "args": [
            "ca->level",
            "0"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "\"\\2%s\\2 has flags \\2%s\\2 in \\2%s\\2 because they are a member of \\2%s\\2.\"",
            "u->nick",
            "bitmask_to_flags2(ca->level, 0)",
            "mc->name",
            "ca->entity->name"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitmask_to_flags2",
          "args": [
            "ca->level",
            "0"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isgroup",
          "args": [
            "ca->entity"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_success_nodata",
          "args": [
            "si",
            "\"\\2%s\\2 has flags \\2%s\\2 in \\2%s\\2 because they are logged in as \\2%s\\2.\"",
            "u->nick",
            "bitmask_to_flags2(ca->level, 0)",
            "mc->name",
            "ca->entity->name"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitmask_to_flags2",
          "args": [
            "ca->level",
            "0"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "entity",
          "args": [
            "u->myuser"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vt->match_entity",
          "args": [
            "ca",
            "entity(u->myuser)"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "entity",
          "args": [
            "u->myuser"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vt->match_user",
          "args": [
            "ca",
            "u"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "entity",
          "args": [
            "u->myuser"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "myentity_get_chanacs_validator",
          "args": [
            "ca->entity"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MOWGLI_ITER_FOREACH",
          "args": [
            "n",
            "mc->chanacs.head"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "logcommand",
          "args": [
            "si",
            "CMDLOG_GET",
            "\"WHY: \\2%s!%s@%s\\2 on \\2%s\\2\"",
            "u->nick",
            "u->user",
            "u->vhost",
            "mc->name"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "logcommand",
          "args": [
            "si",
            "CMDLOG_ADMIN",
            "\"WHY: \\2%s!%s@%s\\2 on \\2%s\\2 (oper override)\"",
            "u->nick",
            "u->user",
            "u->vhost",
            "mc->name"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_noprivs",
            "_(\"\\2%s\\2 is closed.\")",
            "chan"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "metadata_find",
          "args": [
            "mc",
            "\"private:close:closer\""
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_noprivs",
            "_(\"You are not authorized to perform this operation.\")"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_priv",
          "args": [
            "si",
            "PRIV_CHAN_AUSPEX"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chanacs_source_has_flag",
          "args": [
            "mc",
            "si",
            "CA_ACLVIEW"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_nosuch_target",
            "_(\"Channel \\2%s\\2 is not registered.\")",
            "chan"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_nosuch_target",
            "_(\"\\2%s\\2 is not online.\")",
            "targ"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "user_find_named",
          "args": [
            "targ"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mychan_find",
          "args": [
            "chan"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_needmoreparams",
            "_(\"Syntax: WHY <channel> [user]\")"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "command_fail",
          "args": [
            "si",
            "fault_needmoreparams",
            "STR_INSUFFICIENT_PARAMS",
            "\"WHY\""
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atheme.h\"\n\nstatic void cs_cmd_why(sourceinfo_t *si, int parc, char *parv[]);\n\nstatic void cs_cmd_why(sourceinfo_t *si, int parc, char *parv[])\n{\n\tconst char *chan = parv[0];\n\tconst char *targ = parv[1];\n\tmychan_t *mc;\n\tuser_t *u;\n\tmyuser_t *mu;\n\tmowgli_node_t *n;\n\tchanacs_t *ca;\n\tentity_chanacs_validation_vtable_t *vt;\n\tmetadata_t *md;\n\tbool operoverride = false;\n\tint fl = 0;\n\n\tif (!chan || (!targ && si->su == NULL))\n\t{\n\t\tcommand_fail(si, fault_needmoreparams, STR_INSUFFICIENT_PARAMS, \"WHY\");\n\t\tcommand_fail(si, fault_needmoreparams, _(\"Syntax: WHY <channel> [user]\"));\n\t\treturn;\n\t}\n\n\tif (!targ)\n\t\ttarg = si->su->nick;\n\n\tmc = mychan_find(chan);\n\tu = user_find_named(targ);\n\n\tif (u == NULL)\n\t{\n\t\tcommand_fail(si, fault_nosuch_target, _(\"\\2%s\\2 is not online.\"),\n\t\t\ttarg);\n\t\treturn;\n\t}\n\n\tmu = u->myuser;\n\n\tif (mc == NULL)\n\t{\n\t\tcommand_fail(si, fault_nosuch_target, _(\"Channel \\2%s\\2 is not registered.\"),\n\t\t\tchan);\n\t\treturn;\n\t}\n\n\tif (!(mc->flags & MC_PUBACL) && !chanacs_source_has_flag(mc, si, CA_ACLVIEW))\n\t{\n\t\tif (has_priv(si, PRIV_CHAN_AUSPEX))\n\t\t\toperoverride = true;\n\t\telse\n\t\t{\n\t\t\tcommand_fail(si, fault_noprivs, _(\"You are not authorized to perform this operation.\"));\n\t\t\treturn;\n\t\t}\n\t}\n\n\tif (metadata_find(mc, \"private:close:closer\"))\n\t{\n\t\tcommand_fail(si, fault_noprivs, _(\"\\2%s\\2 is closed.\"), chan);\n\t\treturn;\n\t}\n\n\tif (operoverride)\n\t\tlogcommand(si, CMDLOG_ADMIN, \"WHY: \\2%s!%s@%s\\2 on \\2%s\\2 (oper override)\", u->nick, u->user, u->vhost, mc->name);\n\telse\n\t\tlogcommand(si, CMDLOG_GET, \"WHY: \\2%s!%s@%s\\2 on \\2%s\\2\", u->nick, u->user, u->vhost, mc->name);\n\n\tMOWGLI_ITER_FOREACH(n, mc->chanacs.head)\n\t{\n\t\tca = (chanacs_t *)n->data;\n\n\t\tif (ca->entity == NULL)\n\t\t\tcontinue;\n\t\tvt = myentity_get_chanacs_validator(ca->entity);\n\t\tif (ca->entity == entity(u->myuser) ||\n\t\t\t\t(vt->match_user != NULL ?\n\t\t\t\t vt->match_user(ca, u) != NULL :\n\t\t\t\t u->myuser != NULL &&\n\t\t\t\t vt->match_entity(ca, entity(u->myuser)) != NULL))\n\t\t{\n\t\t\tfl |= ca->level;\n\t\t\tif (ca->entity == entity(u->myuser))\n\t\t\t\tcommand_success_nodata(si,\n\t\t\t\t\t\"\\2%s\\2 has flags \\2%s\\2 in \\2%s\\2 because they are logged in as \\2%s\\2.\",\n\t\t\t\t\tu->nick, bitmask_to_flags2(ca->level, 0), mc->name, ca->entity->name);\n\t\t\telse if (isgroup(ca->entity))\n\t\t\t\tcommand_success_nodata(si,\n\t\t\t\t\t\"\\2%s\\2 has flags \\2%s\\2 in \\2%s\\2 because they are a member of \\2%s\\2.\",\n\t\t\t\t\tu->nick, bitmask_to_flags2(ca->level, 0), mc->name, ca->entity->name);\n\t\t\telse\n\t\t\t\tcommand_success_nodata(si,\n\t\t\t\t\t\"\\2%s\\2 has flags \\2%s\\2 in \\2%s\\2 because they match \\2%s\\2.\",\n\t\t\t\t\tu->nick, bitmask_to_flags2(ca->level, 0), mc->name, ca->entity->name);\n\t\t\tif (ca->level & CA_AKICK)\n\t\t\t{\n\t\t\t\tmd = metadata_find(ca, \"reason\");\n\t\t\t\tif (md != NULL)\n\t\t\t\t\tcommand_success_nodata(si, \"Ban reason: %s\", md->value);\n\t\t\t}\n\t\t}\n\t}\n\tfor (n = next_matching_host_chanacs(mc, u, mc->chanacs.head); n != NULL; n = next_matching_host_chanacs(mc, u, n->next))\n\t{\n\t\tca = n->data;\n\t\tfl |= ca->level;\n\t\tcommand_success_nodata(si,\n\t\t\t\t\"\\2%s\\2 has flags \\2%s\\2 in \\2%s\\2 because they match the mask \\2%s\\2.\",\n\t\t\t\tu->nick, bitmask_to_flags2(ca->level, 0), mc->name, ca->host);\n\t\tif (ca->level & CA_AKICK)\n\t\t{\n\t\t\tmd = metadata_find(ca, \"reason\");\n\t\t\tif (md != NULL)\n\t\t\t\tcommand_success_nodata(si, \"Ban reason: %s\", md->value);\n\t\t}\n\t}\n\n\tif (fl & (CA_AUTOOP | CA_AUTOHALFOP | CA_AUTOVOICE))\n\t{\n\t\tif (mc->flags & MC_NOOP)\n\t\t\tcommand_success_nodata(si, _(\"The \\2%s\\2 flag is set for \\2%s\\2, therefore no status will be given.\"),\n\t\t\t\t\t\"NOOP\",\n\t\t\t\t\tmc->name);\n\t\telse if (mu != NULL && mu->flags & MU_NOOP)\n\t\t\tcommand_success_nodata(si, _(\"The \\2%s\\2 flag is set for \\2%s\\2, therefore no status will be given.\"),\n\t\t\t\t\t\"NOOP\",\n\t\t\t\t\tentity(mu)->name);\n\t}\n\tif ((fl & (CA_AKICK | CA_EXEMPT)) == (CA_AKICK | CA_EXEMPT))\n\t\tcommand_success_nodata(si, _(\"+e exempts from +b.\"));\n\telse if (fl == 0)\n\t\tcommand_success_nodata(si, _(\"\\2%s\\2 has no special access to \\2%s\\2.\"),\n\t\t\t\tu->nick, mc->name);\n}"
  },
  {
    "function_name": "_moddeinit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/why.c",
    "lines": "28-31",
    "snippet": "void _moddeinit(module_unload_intent_t intent)\n{\n\tservice_named_unbind_command(\"chanserv\", &cs_why);\n}",
    "includes": [
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "command_t cs_why = { \"WHY\", N_(\"Explains channel access logic.\"),\n\t\t     AC_NONE, 2, cs_cmd_why, { .path = \"cservice/why\" } };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "service_named_unbind_command",
          "args": [
            "\"chanserv\"",
            "&cs_why"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atheme.h\"\n\ncommand_t cs_why = { \"WHY\", N_(\"Explains channel access logic.\"),\n\t\t     AC_NONE, 2, cs_cmd_why, { .path = \"cservice/why\" } };\n\nvoid _moddeinit(module_unload_intent_t intent)\n{\n\tservice_named_unbind_command(\"chanserv\", &cs_why);\n}"
  },
  {
    "function_name": "_modinit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2014-9773/repo/modules/chanserv/why.c",
    "lines": "23-26",
    "snippet": "void _modinit(module_t *m)\n{\n\tservice_named_bind_command(\"chanserv\", &cs_why);\n}",
    "includes": [
      "#include \"atheme.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "command_t cs_why = { \"WHY\", N_(\"Explains channel access logic.\"),\n\t\t     AC_NONE, 2, cs_cmd_why, { .path = \"cservice/why\" } };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "service_named_bind_command",
          "args": [
            "\"chanserv\"",
            "&cs_why"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"atheme.h\"\n\ncommand_t cs_why = { \"WHY\", N_(\"Explains channel access logic.\"),\n\t\t     AC_NONE, 2, cs_cmd_why, { .path = \"cservice/why\" } };\n\nvoid _modinit(module_t *m)\n{\n\tservice_named_bind_command(\"chanserv\", &cs_why);\n}"
  }
]