[
  {
    "function_name": "_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/cli/strftime.c",
    "lines": "451-464",
    "snippet": "static int\n_add(str, pt, ptlim)\n\tconst char *str;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\n\tfor (;; ++(*pt)) {\n\t\tif (*pt == ptlim)\n\t\t\treturn (0);\n\t\tif ((**pt = *str++) == '\\0')\n\t\t\treturn (1);\n\t}\n}",
    "includes": [
      "#include <time.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static\tint _add"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <time.h>\n#include <string.h>\n\nstatic\tint _add;\n\nstatic int\n_add(str, pt, ptlim)\n\tconst char *str;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\n\tfor (;; ++(*pt)) {\n\t\tif (*pt == ptlim)\n\t\t\treturn (0);\n\t\tif ((**pt = *str++) == '\\0')\n\t\t\treturn (1);\n\t}\n}"
  },
  {
    "function_name": "_conv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/cli/strftime.c",
    "lines": "433-449",
    "snippet": "static int\n_conv(n, digits, pad, pt, ptlim)\n\tint n, digits;\n\tint pad;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\tchar buf[10];\n\tchar *p;\n\n\tbuf[sizeof (buf) - 1] = '\\0';\n\tfor (p = buf + sizeof(buf) - 2; n > 0 && p > buf; n /= 10, --digits)\n\t\t*p-- = n % 10 + '0';\n\twhile (p > buf && digits-- > 0)\n\t\t*p-- = pad;\n\treturn (_add(++p, pt, ptlim));\n}",
    "includes": [
      "#include <time.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static\tint _add",
      "static\tint _conv"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_add",
          "args": [
            "++p",
            "pt",
            "ptlim"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/cli/strftime.c",
          "lines": "451-464",
          "snippet": "static int\n_add(str, pt, ptlim)\n\tconst char *str;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\n\tfor (;; ++(*pt)) {\n\t\tif (*pt == ptlim)\n\t\t\treturn (0);\n\t\tif ((**pt = *str++) == '\\0')\n\t\t\treturn (1);\n\t}\n}",
          "includes": [
            "#include <time.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static\tint _add"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <string.h>\n\nstatic\tint _add;\n\nstatic int\n_add(str, pt, ptlim)\n\tconst char *str;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\n\tfor (;; ++(*pt)) {\n\t\tif (*pt == ptlim)\n\t\t\treturn (0);\n\t\tif ((**pt = *str++) == '\\0')\n\t\t\treturn (1);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <string.h>\n\nstatic\tint _add;\nstatic\tint _conv;\n\nstatic int\n_conv(n, digits, pad, pt, ptlim)\n\tint n, digits;\n\tint pad;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\tchar buf[10];\n\tchar *p;\n\n\tbuf[sizeof (buf) - 1] = '\\0';\n\tfor (p = buf + sizeof(buf) - 2; n > 0 && p > buf; n /= 10, --digits)\n\t\t*p-- = n % 10 + '0';\n\twhile (p > buf && digits-- > 0)\n\t\t*p-- = pad;\n\treturn (_add(++p, pt, ptlim));\n}"
  },
  {
    "function_name": "_secs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/cli/strftime.c",
    "lines": "413-431",
    "snippet": "static int\n_secs(t, pt, ptlim)\n\tconst struct tm *t;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\tchar buf[15];\n\ttime_t s;\n\tchar *p;\n\tstruct tm tmp;\n\n\tbuf[sizeof (buf) - 1] = '\\0';\n\t/* Make a copy, mktime(3) modifies the tm struct. */\n\ttmp = *t;\n\ts = mktime(&tmp);\n\tfor (p = buf + sizeof(buf) - 2; s > 0 && p > buf; s /= 10)\n\t\t*p-- = (char)(s % 10 + '0');\n\treturn (_add(++p, pt, ptlim));\n}",
    "includes": [
      "#include <time.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static\tint _add",
      "static\tint _secs"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_add",
          "args": [
            "++p",
            "pt",
            "ptlim"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/cli/strftime.c",
          "lines": "451-464",
          "snippet": "static int\n_add(str, pt, ptlim)\n\tconst char *str;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\n\tfor (;; ++(*pt)) {\n\t\tif (*pt == ptlim)\n\t\t\treturn (0);\n\t\tif ((**pt = *str++) == '\\0')\n\t\t\treturn (1);\n\t}\n}",
          "includes": [
            "#include <time.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static\tint _add"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <string.h>\n\nstatic\tint _add;\n\nstatic int\n_add(str, pt, ptlim)\n\tconst char *str;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\n\tfor (;; ++(*pt)) {\n\t\tif (*pt == ptlim)\n\t\t\treturn (0);\n\t\tif ((**pt = *str++) == '\\0')\n\t\t\treturn (1);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mktime",
          "args": [
            "&tmp"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <string.h>\n\nstatic\tint _add;\nstatic\tint _secs;\n\nstatic int\n_secs(t, pt, ptlim)\n\tconst struct tm *t;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\tchar buf[15];\n\ttime_t s;\n\tchar *p;\n\tstruct tm tmp;\n\n\tbuf[sizeof (buf) - 1] = '\\0';\n\t/* Make a copy, mktime(3) modifies the tm struct. */\n\ttmp = *t;\n\ts = mktime(&tmp);\n\tfor (p = buf + sizeof(buf) - 2; s > 0 && p > buf; s /= 10)\n\t\t*p-- = (char)(s % 10 + '0');\n\treturn (_add(++p, pt, ptlim));\n}"
  },
  {
    "function_name": "_fmt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/cli/strftime.c",
    "lines": "128-411",
    "snippet": "static size_t\n_fmt(format, t, pt, ptlim)\n\tconst char *format;\n\tconst struct tm *t;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\tfor (; *format; ++format) {\n\t\tif (*format == '%') {\n\t\t\t++format;\n\t\t\tif (*format == 'E') {\n\t\t\t\t/* Alternate Era */\n\t\t\t\t++format;\n\t\t\t} else if (*format == 'O') {\n\t\t\t\t/* Alternate numeric symbols */\n\t\t\t\t++format;\n\t\t\t}\n\t\t\tswitch (*format) {\n\t\t\tcase '\\0':\n\t\t\t\t--format;\n\t\t\t\tbreak;\n\t\t\tcase 'A':\n\t\t\t\tif (t->tm_wday < 0 || t->tm_wday > 6)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->day[t->tm_wday],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\n\t\t\tcase 'a':\n\t\t\t\tif (t->tm_wday < 0 || t->tm_wday > 6)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->abday[t->tm_wday],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'B':\n\t\t\t\tif (t->tm_mon < 0 || t->tm_mon > 11)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->mon[t->tm_mon],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'b':\n\t\t\tcase 'h':\n\t\t\t\tif (t->tm_mon < 0 || t->tm_mon > 11)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->abmon[t->tm_mon],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'C':\n\t\t\t\tif (!_conv((t->tm_year + TM_YEAR_BASE) / 100,\n\t\t\t\t    2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'c':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->d_t_fmt, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'D':\n\t\t\t\tif (!_fmt(\"%m/%d/%y\", t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'd':\n\t\t\t\tif (!_conv(t->tm_mday, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'e':\n\t\t\t\tif (!_conv(t->tm_mday, 2, ' ', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'H':\n\t\t\t\tif (!_conv(t->tm_hour, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'I':\n\t\t\t\tif (!_conv(t->tm_hour % 12 ?\n\t\t\t\t    t->tm_hour % 12 : 12, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'j':\n\t\t\t\tif (!_conv(t->tm_yday + 1, 3, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'k':\n\t\t\t\tif (!_conv(t->tm_hour, 2, ' ', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'l':\n\t\t\t\tif (!_conv(t->tm_hour % 12 ?\n\t\t\t\t    t->tm_hour % 12: 12, 2, ' ', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'M':\n\t\t\t\tif (!_conv(t->tm_min, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'm':\n\t\t\t\tif (!_conv(t->tm_mon + 1, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'n':\n\t\t\t\tif (!_add(\"\\n\", pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'p':\n\t\t\t\tif (!_add(_CurrentTimeLocale->am_pm[t->tm_hour\n\t\t\t\t    >= 12], pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'R':\n\t\t\t\tif (!_fmt(\"%H:%M\", t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'r':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->t_fmt_ampm, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'S':\n\t\t\t\tif (!_conv(t->tm_sec, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 's':\n\t\t\t\tif (!_secs(t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'T':\n\t\t\t\tif (!_fmt(\"%H:%M:%S\", t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 't':\n\t\t\t\tif (!_add(\"\\t\", pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'U':\n\t\t\t\tif (!_conv(SUN_WEEK(t), 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'u':\n\t\t\t\tif (!_conv(t->tm_wday ? t->tm_wday : 7, 1, '0',\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'V':\t/* ISO 8601 week number */\n\t\t\tcase 'G':\t/* ISO 8601 year (four digits) */\n\t\t\tcase 'g':\t/* ISO 8601 year (two digits) */\n/*\n** From Arnold Robbins' strftime version 3.0:  \"the week number of the\n** year (the first Monday as the first day of week 1) as a decimal number\n** (01-53).\"\n** (ado, 1993-05-24)\n**\n** From \"http://www.ft.uni-erlangen.de/~mskuhn/iso-time.html\" by Markus Kuhn:\n** \"Week 01 of a year is per definition the first week which has the\n** Thursday in this year, which is equivalent to the week which contains\n** the fourth day of January. In other words, the first week of a new year\n** is the week which has the majority of its days in the new year. Week 01\n** might also contain days from the previous year and the week before week\n** 01 of a year is the last week (52 or 53) of the previous year even if\n** it contains days from the new year. A week starts with Monday (day 1)\n** and ends with Sunday (day 7).  For example, the first week of the year\n** 1997 lasts from 1996-12-30 to 1997-01-05...\"\n** (ado, 1996-01-02)\n*/\n\t\t\t\t{\n\t\t\t\t\tint\tyear;\n\t\t\t\t\tint\tyday;\n\t\t\t\t\tint\twday;\n\t\t\t\t\tint\tw;\n\n\t\t\t\t\tyear = t->tm_year + TM_YEAR_BASE;\n\t\t\t\t\tyday = t->tm_yday;\n\t\t\t\t\twday = t->tm_wday;\n\t\t\t\t\tfor ( ; ; ) {\n\t\t\t\t\t\tint\tlen;\n\t\t\t\t\t\tint\tbot;\n\t\t\t\t\t\tint\ttop;\n\n\t\t\t\t\t\tlen = isleap(year) ?\n\t\t\t\t\t\t\tDAYSPERLYEAR :\n\t\t\t\t\t\t\tDAYSPERNYEAR;\n\t\t\t\t\t\t/*\n\t\t\t\t\t\t** What yday (-3 ... 3) does\n\t\t\t\t\t\t** the ISO year begin on?\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tbot = ((yday + 11 - wday) %\n\t\t\t\t\t\t\tDAYSPERWEEK) - 3;\n\t\t\t\t\t\t/*\n\t\t\t\t\t\t** What yday does the NEXT\n\t\t\t\t\t\t** ISO year begin on?\n\t\t\t\t\t\t*/\n\t\t\t\t\t\ttop = bot -\n\t\t\t\t\t\t\t(len % DAYSPERWEEK);\n\t\t\t\t\t\tif (top < -3)\n\t\t\t\t\t\t\ttop += DAYSPERWEEK;\n\t\t\t\t\t\ttop += len;\n\t\t\t\t\t\tif (yday >= top) {\n\t\t\t\t\t\t\t++year;\n\t\t\t\t\t\t\tw = 1;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (yday >= bot) {\n\t\t\t\t\t\t\tw = 1 + ((yday - bot) /\n\t\t\t\t\t\t\t\tDAYSPERWEEK);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t--year;\n\t\t\t\t\t\tyday += isleap(year) ?\n\t\t\t\t\t\t\tDAYSPERLYEAR :\n\t\t\t\t\t\t\tDAYSPERNYEAR;\n\t\t\t\t\t}\n#ifdef XPG4_1994_04_09\n\t\t\t\t\tif ((w == 52\n\t\t\t\t\t     && t->tm_mon == TM_JANUARY)\n\t\t\t\t\t    || (w == 1\n\t\t\t\t\t\t&& t->tm_mon == TM_DECEMBER))\n\t\t\t\t\t\tw = 53;\n#endif /* defined XPG4_1994_04_09 */\n\t\t\t\t\tif (*format == 'V') {\n\t\t\t\t\t\tif (!_conv(w, 2, '0',\n\t\t\t\t\t\t\tpt, ptlim))\n\t\t\t\t\t\t\treturn (0);\n\t\t\t\t\t} else if (*format == 'g') {\n\t\t\t\t\t\tif (!_conv(year % 100, 2, '0',\n\t\t\t\t\t\t\tpt, ptlim))\n\t\t\t\t\t\t\treturn (0);\n\t\t\t\t\t} else\tif (!_conv(year, 4, '0',\n\t\t\t\t\t\t\tpt, ptlim))\n\t\t\t\t\t\t\treturn (0);\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\tcase 'W':\n\t\t\t\tif (!_conv(MON_WEEK(t), 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'w':\n\t\t\t\tif (!_conv(t->tm_wday, 1, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'x':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->d_fmt, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'X':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->t_fmt, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'y':\n\t\t\t\tif (!_conv((t->tm_year + TM_YEAR_BASE) % 100,\n\t\t\t\t    2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'Y':\n\t\t\t\tif (!_conv((t->tm_year + TM_YEAR_BASE), 4, '0',\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'Z':\n\t\t\t\tif (tzname[t->tm_isdst ? 1 : 0] &&\n\t\t\t\t    !_add(tzname[t->tm_isdst ? 1 : 0], pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase '%':\n\t\t\t/*\n\t\t\t * X311J/88-090 (4.12.3.5): if conversion char is\n\t\t\t * undefined, behavior is undefined.  Print out the\n\t\t\t * character itself as printf(3) does.\n\t\t\t */\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (*pt == ptlim)\n\t\t\treturn (0);\n\t\t*(*pt)++ = *format;\n\t}\n\treturn (ptlim - *pt);\n}",
    "includes": [
      "#include <time.h>",
      "#include <string.h>"
    ],
    "macros_used": [
      "#define tzname my_tzname",
      "#define DAYSPERWEEK 7",
      "#define DAYSPERNYEAR 365",
      "#define DAYSPERLYEAR 366",
      "#define TM_YEAR_BASE 1900",
      "#define _CurrentTimeLocale (&dummy_locale_info)"
    ],
    "globals_used": [
      "static const char *const tzname[2] = { 0, 0 };",
      "static\tint _add",
      "static\tint _conv",
      "static\tint _secs",
      "static\tsize_t _fmt"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_add",
          "args": [
            "tzname[t->tm_isdst ? 1 : 0]",
            "pt",
            "ptlim"
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/cli/strftime.c",
          "lines": "451-464",
          "snippet": "static int\n_add(str, pt, ptlim)\n\tconst char *str;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\n\tfor (;; ++(*pt)) {\n\t\tif (*pt == ptlim)\n\t\t\treturn (0);\n\t\tif ((**pt = *str++) == '\\0')\n\t\t\treturn (1);\n\t}\n}",
          "includes": [
            "#include <time.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static\tint _add"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <string.h>\n\nstatic\tint _add;\n\nstatic int\n_add(str, pt, ptlim)\n\tconst char *str;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\n\tfor (;; ++(*pt)) {\n\t\tif (*pt == ptlim)\n\t\t\treturn (0);\n\t\tif ((**pt = *str++) == '\\0')\n\t\t\treturn (1);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "_conv",
          "args": [
            "(t->tm_year + TM_YEAR_BASE)",
            "4",
            "'0'",
            "pt",
            "ptlim"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "_conv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/cli/strftime.c",
          "lines": "433-449",
          "snippet": "static int\n_conv(n, digits, pad, pt, ptlim)\n\tint n, digits;\n\tint pad;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\tchar buf[10];\n\tchar *p;\n\n\tbuf[sizeof (buf) - 1] = '\\0';\n\tfor (p = buf + sizeof(buf) - 2; n > 0 && p > buf; n /= 10, --digits)\n\t\t*p-- = n % 10 + '0';\n\twhile (p > buf && digits-- > 0)\n\t\t*p-- = pad;\n\treturn (_add(++p, pt, ptlim));\n}",
          "includes": [
            "#include <time.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static\tint _add",
            "static\tint _conv"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <string.h>\n\nstatic\tint _add;\nstatic\tint _conv;\n\nstatic int\n_conv(n, digits, pad, pt, ptlim)\n\tint n, digits;\n\tint pad;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\tchar buf[10];\n\tchar *p;\n\n\tbuf[sizeof (buf) - 1] = '\\0';\n\tfor (p = buf + sizeof(buf) - 2; n > 0 && p > buf; n /= 10, --digits)\n\t\t*p-- = n % 10 + '0';\n\twhile (p > buf && digits-- > 0)\n\t\t*p-- = pad;\n\treturn (_add(++p, pt, ptlim));\n}"
        }
      },
      {
        "call_info": {
          "callee": "_fmt",
          "args": [
            "_CurrentTimeLocale->t_fmt",
            "t",
            "pt",
            "ptlim"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "_fmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/cli/strftime.c",
          "lines": "128-411",
          "snippet": "static size_t\n_fmt(format, t, pt, ptlim)\n\tconst char *format;\n\tconst struct tm *t;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\tfor (; *format; ++format) {\n\t\tif (*format == '%') {\n\t\t\t++format;\n\t\t\tif (*format == 'E') {\n\t\t\t\t/* Alternate Era */\n\t\t\t\t++format;\n\t\t\t} else if (*format == 'O') {\n\t\t\t\t/* Alternate numeric symbols */\n\t\t\t\t++format;\n\t\t\t}\n\t\t\tswitch (*format) {\n\t\t\tcase '\\0':\n\t\t\t\t--format;\n\t\t\t\tbreak;\n\t\t\tcase 'A':\n\t\t\t\tif (t->tm_wday < 0 || t->tm_wday > 6)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->day[t->tm_wday],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\n\t\t\tcase 'a':\n\t\t\t\tif (t->tm_wday < 0 || t->tm_wday > 6)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->abday[t->tm_wday],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'B':\n\t\t\t\tif (t->tm_mon < 0 || t->tm_mon > 11)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->mon[t->tm_mon],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'b':\n\t\t\tcase 'h':\n\t\t\t\tif (t->tm_mon < 0 || t->tm_mon > 11)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->abmon[t->tm_mon],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'C':\n\t\t\t\tif (!_conv((t->tm_year + TM_YEAR_BASE) / 100,\n\t\t\t\t    2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'c':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->d_t_fmt, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'D':\n\t\t\t\tif (!_fmt(\"%m/%d/%y\", t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'd':\n\t\t\t\tif (!_conv(t->tm_mday, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'e':\n\t\t\t\tif (!_conv(t->tm_mday, 2, ' ', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'H':\n\t\t\t\tif (!_conv(t->tm_hour, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'I':\n\t\t\t\tif (!_conv(t->tm_hour % 12 ?\n\t\t\t\t    t->tm_hour % 12 : 12, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'j':\n\t\t\t\tif (!_conv(t->tm_yday + 1, 3, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'k':\n\t\t\t\tif (!_conv(t->tm_hour, 2, ' ', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'l':\n\t\t\t\tif (!_conv(t->tm_hour % 12 ?\n\t\t\t\t    t->tm_hour % 12: 12, 2, ' ', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'M':\n\t\t\t\tif (!_conv(t->tm_min, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'm':\n\t\t\t\tif (!_conv(t->tm_mon + 1, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'n':\n\t\t\t\tif (!_add(\"\\n\", pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'p':\n\t\t\t\tif (!_add(_CurrentTimeLocale->am_pm[t->tm_hour\n\t\t\t\t    >= 12], pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'R':\n\t\t\t\tif (!_fmt(\"%H:%M\", t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'r':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->t_fmt_ampm, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'S':\n\t\t\t\tif (!_conv(t->tm_sec, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 's':\n\t\t\t\tif (!_secs(t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'T':\n\t\t\t\tif (!_fmt(\"%H:%M:%S\", t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 't':\n\t\t\t\tif (!_add(\"\\t\", pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'U':\n\t\t\t\tif (!_conv(SUN_WEEK(t), 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'u':\n\t\t\t\tif (!_conv(t->tm_wday ? t->tm_wday : 7, 1, '0',\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'V':\t/* ISO 8601 week number */\n\t\t\tcase 'G':\t/* ISO 8601 year (four digits) */\n\t\t\tcase 'g':\t/* ISO 8601 year (two digits) */\n/*\n** From Arnold Robbins' strftime version 3.0:  \"the week number of the\n** year (the first Monday as the first day of week 1) as a decimal number\n** (01-53).\"\n** (ado, 1993-05-24)\n**\n** From \"http://www.ft.uni-erlangen.de/~mskuhn/iso-time.html\" by Markus Kuhn:\n** \"Week 01 of a year is per definition the first week which has the\n** Thursday in this year, which is equivalent to the week which contains\n** the fourth day of January. In other words, the first week of a new year\n** is the week which has the majority of its days in the new year. Week 01\n** might also contain days from the previous year and the week before week\n** 01 of a year is the last week (52 or 53) of the previous year even if\n** it contains days from the new year. A week starts with Monday (day 1)\n** and ends with Sunday (day 7).  For example, the first week of the year\n** 1997 lasts from 1996-12-30 to 1997-01-05...\"\n** (ado, 1996-01-02)\n*/\n\t\t\t\t{\n\t\t\t\t\tint\tyear;\n\t\t\t\t\tint\tyday;\n\t\t\t\t\tint\twday;\n\t\t\t\t\tint\tw;\n\n\t\t\t\t\tyear = t->tm_year + TM_YEAR_BASE;\n\t\t\t\t\tyday = t->tm_yday;\n\t\t\t\t\twday = t->tm_wday;\n\t\t\t\t\tfor ( ; ; ) {\n\t\t\t\t\t\tint\tlen;\n\t\t\t\t\t\tint\tbot;\n\t\t\t\t\t\tint\ttop;\n\n\t\t\t\t\t\tlen = isleap(year) ?\n\t\t\t\t\t\t\tDAYSPERLYEAR :\n\t\t\t\t\t\t\tDAYSPERNYEAR;\n\t\t\t\t\t\t/*\n\t\t\t\t\t\t** What yday (-3 ... 3) does\n\t\t\t\t\t\t** the ISO year begin on?\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tbot = ((yday + 11 - wday) %\n\t\t\t\t\t\t\tDAYSPERWEEK) - 3;\n\t\t\t\t\t\t/*\n\t\t\t\t\t\t** What yday does the NEXT\n\t\t\t\t\t\t** ISO year begin on?\n\t\t\t\t\t\t*/\n\t\t\t\t\t\ttop = bot -\n\t\t\t\t\t\t\t(len % DAYSPERWEEK);\n\t\t\t\t\t\tif (top < -3)\n\t\t\t\t\t\t\ttop += DAYSPERWEEK;\n\t\t\t\t\t\ttop += len;\n\t\t\t\t\t\tif (yday >= top) {\n\t\t\t\t\t\t\t++year;\n\t\t\t\t\t\t\tw = 1;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (yday >= bot) {\n\t\t\t\t\t\t\tw = 1 + ((yday - bot) /\n\t\t\t\t\t\t\t\tDAYSPERWEEK);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t--year;\n\t\t\t\t\t\tyday += isleap(year) ?\n\t\t\t\t\t\t\tDAYSPERLYEAR :\n\t\t\t\t\t\t\tDAYSPERNYEAR;\n\t\t\t\t\t}\n#ifdef XPG4_1994_04_09\n\t\t\t\t\tif ((w == 52\n\t\t\t\t\t     && t->tm_mon == TM_JANUARY)\n\t\t\t\t\t    || (w == 1\n\t\t\t\t\t\t&& t->tm_mon == TM_DECEMBER))\n\t\t\t\t\t\tw = 53;\n#endif /* defined XPG4_1994_04_09 */\n\t\t\t\t\tif (*format == 'V') {\n\t\t\t\t\t\tif (!_conv(w, 2, '0',\n\t\t\t\t\t\t\tpt, ptlim))\n\t\t\t\t\t\t\treturn (0);\n\t\t\t\t\t} else if (*format == 'g') {\n\t\t\t\t\t\tif (!_conv(year % 100, 2, '0',\n\t\t\t\t\t\t\tpt, ptlim))\n\t\t\t\t\t\t\treturn (0);\n\t\t\t\t\t} else\tif (!_conv(year, 4, '0',\n\t\t\t\t\t\t\tpt, ptlim))\n\t\t\t\t\t\t\treturn (0);\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\tcase 'W':\n\t\t\t\tif (!_conv(MON_WEEK(t), 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'w':\n\t\t\t\tif (!_conv(t->tm_wday, 1, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'x':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->d_fmt, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'X':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->t_fmt, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'y':\n\t\t\t\tif (!_conv((t->tm_year + TM_YEAR_BASE) % 100,\n\t\t\t\t    2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'Y':\n\t\t\t\tif (!_conv((t->tm_year + TM_YEAR_BASE), 4, '0',\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'Z':\n\t\t\t\tif (tzname[t->tm_isdst ? 1 : 0] &&\n\t\t\t\t    !_add(tzname[t->tm_isdst ? 1 : 0], pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase '%':\n\t\t\t/*\n\t\t\t * X311J/88-090 (4.12.3.5): if conversion char is\n\t\t\t * undefined, behavior is undefined.  Print out the\n\t\t\t * character itself as printf(3) does.\n\t\t\t */\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (*pt == ptlim)\n\t\t\treturn (0);\n\t\t*(*pt)++ = *format;\n\t}\n\treturn (ptlim - *pt);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "MON_WEEK",
          "args": [
            "t"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isleap",
          "args": [
            "year"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isleap",
          "args": [
            "year"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SUN_WEEK",
          "args": [
            "t"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_secs",
          "args": [
            "t",
            "pt",
            "ptlim"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "_secs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/cli/strftime.c",
          "lines": "413-431",
          "snippet": "static int\n_secs(t, pt, ptlim)\n\tconst struct tm *t;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\tchar buf[15];\n\ttime_t s;\n\tchar *p;\n\tstruct tm tmp;\n\n\tbuf[sizeof (buf) - 1] = '\\0';\n\t/* Make a copy, mktime(3) modifies the tm struct. */\n\ttmp = *t;\n\ts = mktime(&tmp);\n\tfor (p = buf + sizeof(buf) - 2; s > 0 && p > buf; s /= 10)\n\t\t*p-- = (char)(s % 10 + '0');\n\treturn (_add(++p, pt, ptlim));\n}",
          "includes": [
            "#include <time.h>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static\tint _add",
            "static\tint _secs"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <string.h>\n\nstatic\tint _add;\nstatic\tint _secs;\n\nstatic int\n_secs(t, pt, ptlim)\n\tconst struct tm *t;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\tchar buf[15];\n\ttime_t s;\n\tchar *p;\n\tstruct tm tmp;\n\n\tbuf[sizeof (buf) - 1] = '\\0';\n\t/* Make a copy, mktime(3) modifies the tm struct. */\n\ttmp = *t;\n\ts = mktime(&tmp);\n\tfor (p = buf + sizeof(buf) - 2; s > 0 && p > buf; s /= 10)\n\t\t*p-- = (char)(s % 10 + '0');\n\treturn (_add(++p, pt, ptlim));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <string.h>\n\n#define tzname my_tzname\n#define DAYSPERWEEK 7\n#define DAYSPERNYEAR 365\n#define DAYSPERLYEAR 366\n#define TM_YEAR_BASE 1900\n#define _CurrentTimeLocale (&dummy_locale_info)\n\nstatic const char *const tzname[2] = { 0, 0 };\nstatic\tint _add;\nstatic\tint _conv;\nstatic\tint _secs;\nstatic\tsize_t _fmt;\n\nstatic size_t\n_fmt(format, t, pt, ptlim)\n\tconst char *format;\n\tconst struct tm *t;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\tfor (; *format; ++format) {\n\t\tif (*format == '%') {\n\t\t\t++format;\n\t\t\tif (*format == 'E') {\n\t\t\t\t/* Alternate Era */\n\t\t\t\t++format;\n\t\t\t} else if (*format == 'O') {\n\t\t\t\t/* Alternate numeric symbols */\n\t\t\t\t++format;\n\t\t\t}\n\t\t\tswitch (*format) {\n\t\t\tcase '\\0':\n\t\t\t\t--format;\n\t\t\t\tbreak;\n\t\t\tcase 'A':\n\t\t\t\tif (t->tm_wday < 0 || t->tm_wday > 6)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->day[t->tm_wday],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\n\t\t\tcase 'a':\n\t\t\t\tif (t->tm_wday < 0 || t->tm_wday > 6)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->abday[t->tm_wday],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'B':\n\t\t\t\tif (t->tm_mon < 0 || t->tm_mon > 11)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->mon[t->tm_mon],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'b':\n\t\t\tcase 'h':\n\t\t\t\tif (t->tm_mon < 0 || t->tm_mon > 11)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->abmon[t->tm_mon],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'C':\n\t\t\t\tif (!_conv((t->tm_year + TM_YEAR_BASE) / 100,\n\t\t\t\t    2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'c':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->d_t_fmt, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'D':\n\t\t\t\tif (!_fmt(\"%m/%d/%y\", t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'd':\n\t\t\t\tif (!_conv(t->tm_mday, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'e':\n\t\t\t\tif (!_conv(t->tm_mday, 2, ' ', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'H':\n\t\t\t\tif (!_conv(t->tm_hour, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'I':\n\t\t\t\tif (!_conv(t->tm_hour % 12 ?\n\t\t\t\t    t->tm_hour % 12 : 12, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'j':\n\t\t\t\tif (!_conv(t->tm_yday + 1, 3, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'k':\n\t\t\t\tif (!_conv(t->tm_hour, 2, ' ', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'l':\n\t\t\t\tif (!_conv(t->tm_hour % 12 ?\n\t\t\t\t    t->tm_hour % 12: 12, 2, ' ', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'M':\n\t\t\t\tif (!_conv(t->tm_min, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'm':\n\t\t\t\tif (!_conv(t->tm_mon + 1, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'n':\n\t\t\t\tif (!_add(\"\\n\", pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'p':\n\t\t\t\tif (!_add(_CurrentTimeLocale->am_pm[t->tm_hour\n\t\t\t\t    >= 12], pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'R':\n\t\t\t\tif (!_fmt(\"%H:%M\", t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'r':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->t_fmt_ampm, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'S':\n\t\t\t\tif (!_conv(t->tm_sec, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 's':\n\t\t\t\tif (!_secs(t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'T':\n\t\t\t\tif (!_fmt(\"%H:%M:%S\", t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 't':\n\t\t\t\tif (!_add(\"\\t\", pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'U':\n\t\t\t\tif (!_conv(SUN_WEEK(t), 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'u':\n\t\t\t\tif (!_conv(t->tm_wday ? t->tm_wday : 7, 1, '0',\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'V':\t/* ISO 8601 week number */\n\t\t\tcase 'G':\t/* ISO 8601 year (four digits) */\n\t\t\tcase 'g':\t/* ISO 8601 year (two digits) */\n/*\n** From Arnold Robbins' strftime version 3.0:  \"the week number of the\n** year (the first Monday as the first day of week 1) as a decimal number\n** (01-53).\"\n** (ado, 1993-05-24)\n**\n** From \"http://www.ft.uni-erlangen.de/~mskuhn/iso-time.html\" by Markus Kuhn:\n** \"Week 01 of a year is per definition the first week which has the\n** Thursday in this year, which is equivalent to the week which contains\n** the fourth day of January. In other words, the first week of a new year\n** is the week which has the majority of its days in the new year. Week 01\n** might also contain days from the previous year and the week before week\n** 01 of a year is the last week (52 or 53) of the previous year even if\n** it contains days from the new year. A week starts with Monday (day 1)\n** and ends with Sunday (day 7).  For example, the first week of the year\n** 1997 lasts from 1996-12-30 to 1997-01-05...\"\n** (ado, 1996-01-02)\n*/\n\t\t\t\t{\n\t\t\t\t\tint\tyear;\n\t\t\t\t\tint\tyday;\n\t\t\t\t\tint\twday;\n\t\t\t\t\tint\tw;\n\n\t\t\t\t\tyear = t->tm_year + TM_YEAR_BASE;\n\t\t\t\t\tyday = t->tm_yday;\n\t\t\t\t\twday = t->tm_wday;\n\t\t\t\t\tfor ( ; ; ) {\n\t\t\t\t\t\tint\tlen;\n\t\t\t\t\t\tint\tbot;\n\t\t\t\t\t\tint\ttop;\n\n\t\t\t\t\t\tlen = isleap(year) ?\n\t\t\t\t\t\t\tDAYSPERLYEAR :\n\t\t\t\t\t\t\tDAYSPERNYEAR;\n\t\t\t\t\t\t/*\n\t\t\t\t\t\t** What yday (-3 ... 3) does\n\t\t\t\t\t\t** the ISO year begin on?\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tbot = ((yday + 11 - wday) %\n\t\t\t\t\t\t\tDAYSPERWEEK) - 3;\n\t\t\t\t\t\t/*\n\t\t\t\t\t\t** What yday does the NEXT\n\t\t\t\t\t\t** ISO year begin on?\n\t\t\t\t\t\t*/\n\t\t\t\t\t\ttop = bot -\n\t\t\t\t\t\t\t(len % DAYSPERWEEK);\n\t\t\t\t\t\tif (top < -3)\n\t\t\t\t\t\t\ttop += DAYSPERWEEK;\n\t\t\t\t\t\ttop += len;\n\t\t\t\t\t\tif (yday >= top) {\n\t\t\t\t\t\t\t++year;\n\t\t\t\t\t\t\tw = 1;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (yday >= bot) {\n\t\t\t\t\t\t\tw = 1 + ((yday - bot) /\n\t\t\t\t\t\t\t\tDAYSPERWEEK);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t--year;\n\t\t\t\t\t\tyday += isleap(year) ?\n\t\t\t\t\t\t\tDAYSPERLYEAR :\n\t\t\t\t\t\t\tDAYSPERNYEAR;\n\t\t\t\t\t}\n#ifdef XPG4_1994_04_09\n\t\t\t\t\tif ((w == 52\n\t\t\t\t\t     && t->tm_mon == TM_JANUARY)\n\t\t\t\t\t    || (w == 1\n\t\t\t\t\t\t&& t->tm_mon == TM_DECEMBER))\n\t\t\t\t\t\tw = 53;\n#endif /* defined XPG4_1994_04_09 */\n\t\t\t\t\tif (*format == 'V') {\n\t\t\t\t\t\tif (!_conv(w, 2, '0',\n\t\t\t\t\t\t\tpt, ptlim))\n\t\t\t\t\t\t\treturn (0);\n\t\t\t\t\t} else if (*format == 'g') {\n\t\t\t\t\t\tif (!_conv(year % 100, 2, '0',\n\t\t\t\t\t\t\tpt, ptlim))\n\t\t\t\t\t\t\treturn (0);\n\t\t\t\t\t} else\tif (!_conv(year, 4, '0',\n\t\t\t\t\t\t\tpt, ptlim))\n\t\t\t\t\t\t\treturn (0);\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\tcase 'W':\n\t\t\t\tif (!_conv(MON_WEEK(t), 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'w':\n\t\t\t\tif (!_conv(t->tm_wday, 1, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'x':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->d_fmt, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'X':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->t_fmt, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'y':\n\t\t\t\tif (!_conv((t->tm_year + TM_YEAR_BASE) % 100,\n\t\t\t\t    2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'Y':\n\t\t\t\tif (!_conv((t->tm_year + TM_YEAR_BASE), 4, '0',\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'Z':\n\t\t\t\tif (tzname[t->tm_isdst ? 1 : 0] &&\n\t\t\t\t    !_add(tzname[t->tm_isdst ? 1 : 0], pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase '%':\n\t\t\t/*\n\t\t\t * X311J/88-090 (4.12.3.5): if conversion char is\n\t\t\t * undefined, behavior is undefined.  Print out the\n\t\t\t * character itself as printf(3) does.\n\t\t\t */\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (*pt == ptlim)\n\t\t\treturn (0);\n\t\t*(*pt)++ = *format;\n\t}\n\treturn (ptlim - *pt);\n}"
  },
  {
    "function_name": "strftime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/cli/strftime.c",
    "lines": "102-121",
    "snippet": "size_t\nstrftime(s, maxsize, format, t)\n\tchar *s;\n\tsize_t maxsize;\n\tconst char *format;\n\tconst struct tm *t;\n{\n\tchar *pt;\n\n\ttzset();\n\tif (maxsize < 1)\n\t\treturn (0);\n\n\tpt = s;\n\tif (_fmt(format, t, &pt, s + maxsize)) {\n\t\t*pt = '\\0';\n\t\treturn (pt - s);\n\t} else\n\t\treturn (0);\n}",
    "includes": [
      "#include <time.h>",
      "#include <string.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static\tsize_t _fmt"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_fmt",
          "args": [
            "format",
            "t",
            "&pt",
            "s + maxsize"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "_fmt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/cli/strftime.c",
          "lines": "128-411",
          "snippet": "static size_t\n_fmt(format, t, pt, ptlim)\n\tconst char *format;\n\tconst struct tm *t;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\tfor (; *format; ++format) {\n\t\tif (*format == '%') {\n\t\t\t++format;\n\t\t\tif (*format == 'E') {\n\t\t\t\t/* Alternate Era */\n\t\t\t\t++format;\n\t\t\t} else if (*format == 'O') {\n\t\t\t\t/* Alternate numeric symbols */\n\t\t\t\t++format;\n\t\t\t}\n\t\t\tswitch (*format) {\n\t\t\tcase '\\0':\n\t\t\t\t--format;\n\t\t\t\tbreak;\n\t\t\tcase 'A':\n\t\t\t\tif (t->tm_wday < 0 || t->tm_wday > 6)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->day[t->tm_wday],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\n\t\t\tcase 'a':\n\t\t\t\tif (t->tm_wday < 0 || t->tm_wday > 6)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->abday[t->tm_wday],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'B':\n\t\t\t\tif (t->tm_mon < 0 || t->tm_mon > 11)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->mon[t->tm_mon],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'b':\n\t\t\tcase 'h':\n\t\t\t\tif (t->tm_mon < 0 || t->tm_mon > 11)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->abmon[t->tm_mon],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'C':\n\t\t\t\tif (!_conv((t->tm_year + TM_YEAR_BASE) / 100,\n\t\t\t\t    2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'c':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->d_t_fmt, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'D':\n\t\t\t\tif (!_fmt(\"%m/%d/%y\", t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'd':\n\t\t\t\tif (!_conv(t->tm_mday, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'e':\n\t\t\t\tif (!_conv(t->tm_mday, 2, ' ', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'H':\n\t\t\t\tif (!_conv(t->tm_hour, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'I':\n\t\t\t\tif (!_conv(t->tm_hour % 12 ?\n\t\t\t\t    t->tm_hour % 12 : 12, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'j':\n\t\t\t\tif (!_conv(t->tm_yday + 1, 3, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'k':\n\t\t\t\tif (!_conv(t->tm_hour, 2, ' ', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'l':\n\t\t\t\tif (!_conv(t->tm_hour % 12 ?\n\t\t\t\t    t->tm_hour % 12: 12, 2, ' ', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'M':\n\t\t\t\tif (!_conv(t->tm_min, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'm':\n\t\t\t\tif (!_conv(t->tm_mon + 1, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'n':\n\t\t\t\tif (!_add(\"\\n\", pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'p':\n\t\t\t\tif (!_add(_CurrentTimeLocale->am_pm[t->tm_hour\n\t\t\t\t    >= 12], pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'R':\n\t\t\t\tif (!_fmt(\"%H:%M\", t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'r':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->t_fmt_ampm, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'S':\n\t\t\t\tif (!_conv(t->tm_sec, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 's':\n\t\t\t\tif (!_secs(t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'T':\n\t\t\t\tif (!_fmt(\"%H:%M:%S\", t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 't':\n\t\t\t\tif (!_add(\"\\t\", pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'U':\n\t\t\t\tif (!_conv(SUN_WEEK(t), 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'u':\n\t\t\t\tif (!_conv(t->tm_wday ? t->tm_wday : 7, 1, '0',\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'V':\t/* ISO 8601 week number */\n\t\t\tcase 'G':\t/* ISO 8601 year (four digits) */\n\t\t\tcase 'g':\t/* ISO 8601 year (two digits) */\n/*\n** From Arnold Robbins' strftime version 3.0:  \"the week number of the\n** year (the first Monday as the first day of week 1) as a decimal number\n** (01-53).\"\n** (ado, 1993-05-24)\n**\n** From \"http://www.ft.uni-erlangen.de/~mskuhn/iso-time.html\" by Markus Kuhn:\n** \"Week 01 of a year is per definition the first week which has the\n** Thursday in this year, which is equivalent to the week which contains\n** the fourth day of January. In other words, the first week of a new year\n** is the week which has the majority of its days in the new year. Week 01\n** might also contain days from the previous year and the week before week\n** 01 of a year is the last week (52 or 53) of the previous year even if\n** it contains days from the new year. A week starts with Monday (day 1)\n** and ends with Sunday (day 7).  For example, the first week of the year\n** 1997 lasts from 1996-12-30 to 1997-01-05...\"\n** (ado, 1996-01-02)\n*/\n\t\t\t\t{\n\t\t\t\t\tint\tyear;\n\t\t\t\t\tint\tyday;\n\t\t\t\t\tint\twday;\n\t\t\t\t\tint\tw;\n\n\t\t\t\t\tyear = t->tm_year + TM_YEAR_BASE;\n\t\t\t\t\tyday = t->tm_yday;\n\t\t\t\t\twday = t->tm_wday;\n\t\t\t\t\tfor ( ; ; ) {\n\t\t\t\t\t\tint\tlen;\n\t\t\t\t\t\tint\tbot;\n\t\t\t\t\t\tint\ttop;\n\n\t\t\t\t\t\tlen = isleap(year) ?\n\t\t\t\t\t\t\tDAYSPERLYEAR :\n\t\t\t\t\t\t\tDAYSPERNYEAR;\n\t\t\t\t\t\t/*\n\t\t\t\t\t\t** What yday (-3 ... 3) does\n\t\t\t\t\t\t** the ISO year begin on?\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tbot = ((yday + 11 - wday) %\n\t\t\t\t\t\t\tDAYSPERWEEK) - 3;\n\t\t\t\t\t\t/*\n\t\t\t\t\t\t** What yday does the NEXT\n\t\t\t\t\t\t** ISO year begin on?\n\t\t\t\t\t\t*/\n\t\t\t\t\t\ttop = bot -\n\t\t\t\t\t\t\t(len % DAYSPERWEEK);\n\t\t\t\t\t\tif (top < -3)\n\t\t\t\t\t\t\ttop += DAYSPERWEEK;\n\t\t\t\t\t\ttop += len;\n\t\t\t\t\t\tif (yday >= top) {\n\t\t\t\t\t\t\t++year;\n\t\t\t\t\t\t\tw = 1;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (yday >= bot) {\n\t\t\t\t\t\t\tw = 1 + ((yday - bot) /\n\t\t\t\t\t\t\t\tDAYSPERWEEK);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t--year;\n\t\t\t\t\t\tyday += isleap(year) ?\n\t\t\t\t\t\t\tDAYSPERLYEAR :\n\t\t\t\t\t\t\tDAYSPERNYEAR;\n\t\t\t\t\t}\n#ifdef XPG4_1994_04_09\n\t\t\t\t\tif ((w == 52\n\t\t\t\t\t     && t->tm_mon == TM_JANUARY)\n\t\t\t\t\t    || (w == 1\n\t\t\t\t\t\t&& t->tm_mon == TM_DECEMBER))\n\t\t\t\t\t\tw = 53;\n#endif /* defined XPG4_1994_04_09 */\n\t\t\t\t\tif (*format == 'V') {\n\t\t\t\t\t\tif (!_conv(w, 2, '0',\n\t\t\t\t\t\t\tpt, ptlim))\n\t\t\t\t\t\t\treturn (0);\n\t\t\t\t\t} else if (*format == 'g') {\n\t\t\t\t\t\tif (!_conv(year % 100, 2, '0',\n\t\t\t\t\t\t\tpt, ptlim))\n\t\t\t\t\t\t\treturn (0);\n\t\t\t\t\t} else\tif (!_conv(year, 4, '0',\n\t\t\t\t\t\t\tpt, ptlim))\n\t\t\t\t\t\t\treturn (0);\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\tcase 'W':\n\t\t\t\tif (!_conv(MON_WEEK(t), 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'w':\n\t\t\t\tif (!_conv(t->tm_wday, 1, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'x':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->d_fmt, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'X':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->t_fmt, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'y':\n\t\t\t\tif (!_conv((t->tm_year + TM_YEAR_BASE) % 100,\n\t\t\t\t    2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'Y':\n\t\t\t\tif (!_conv((t->tm_year + TM_YEAR_BASE), 4, '0',\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'Z':\n\t\t\t\tif (tzname[t->tm_isdst ? 1 : 0] &&\n\t\t\t\t    !_add(tzname[t->tm_isdst ? 1 : 0], pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase '%':\n\t\t\t/*\n\t\t\t * X311J/88-090 (4.12.3.5): if conversion char is\n\t\t\t * undefined, behavior is undefined.  Print out the\n\t\t\t * character itself as printf(3) does.\n\t\t\t */\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (*pt == ptlim)\n\t\t\treturn (0);\n\t\t*(*pt)++ = *format;\n\t}\n\treturn (ptlim - *pt);\n}",
          "includes": [
            "#include <time.h>",
            "#include <string.h>"
          ],
          "macros_used": [
            "#define tzname my_tzname",
            "#define DAYSPERWEEK 7",
            "#define DAYSPERNYEAR 365",
            "#define DAYSPERLYEAR 366",
            "#define TM_YEAR_BASE 1900",
            "#define _CurrentTimeLocale (&dummy_locale_info)"
          ],
          "globals_used": [
            "static const char *const tzname[2] = { 0, 0 };",
            "static\tint _add",
            "static\tint _conv",
            "static\tint _secs",
            "static\tsize_t _fmt"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <string.h>\n\n#define tzname my_tzname\n#define DAYSPERWEEK 7\n#define DAYSPERNYEAR 365\n#define DAYSPERLYEAR 366\n#define TM_YEAR_BASE 1900\n#define _CurrentTimeLocale (&dummy_locale_info)\n\nstatic const char *const tzname[2] = { 0, 0 };\nstatic\tint _add;\nstatic\tint _conv;\nstatic\tint _secs;\nstatic\tsize_t _fmt;\n\nstatic size_t\n_fmt(format, t, pt, ptlim)\n\tconst char *format;\n\tconst struct tm *t;\n\tchar **pt;\n\tconst char * const ptlim;\n{\n\tfor (; *format; ++format) {\n\t\tif (*format == '%') {\n\t\t\t++format;\n\t\t\tif (*format == 'E') {\n\t\t\t\t/* Alternate Era */\n\t\t\t\t++format;\n\t\t\t} else if (*format == 'O') {\n\t\t\t\t/* Alternate numeric symbols */\n\t\t\t\t++format;\n\t\t\t}\n\t\t\tswitch (*format) {\n\t\t\tcase '\\0':\n\t\t\t\t--format;\n\t\t\t\tbreak;\n\t\t\tcase 'A':\n\t\t\t\tif (t->tm_wday < 0 || t->tm_wday > 6)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->day[t->tm_wday],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\n\t\t\tcase 'a':\n\t\t\t\tif (t->tm_wday < 0 || t->tm_wday > 6)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->abday[t->tm_wday],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'B':\n\t\t\t\tif (t->tm_mon < 0 || t->tm_mon > 11)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->mon[t->tm_mon],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'b':\n\t\t\tcase 'h':\n\t\t\t\tif (t->tm_mon < 0 || t->tm_mon > 11)\n\t\t\t\t\treturn (0);\n\t\t\t\tif (!_add(_CurrentTimeLocale->abmon[t->tm_mon],\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'C':\n\t\t\t\tif (!_conv((t->tm_year + TM_YEAR_BASE) / 100,\n\t\t\t\t    2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'c':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->d_t_fmt, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'D':\n\t\t\t\tif (!_fmt(\"%m/%d/%y\", t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'd':\n\t\t\t\tif (!_conv(t->tm_mday, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'e':\n\t\t\t\tif (!_conv(t->tm_mday, 2, ' ', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'H':\n\t\t\t\tif (!_conv(t->tm_hour, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'I':\n\t\t\t\tif (!_conv(t->tm_hour % 12 ?\n\t\t\t\t    t->tm_hour % 12 : 12, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'j':\n\t\t\t\tif (!_conv(t->tm_yday + 1, 3, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'k':\n\t\t\t\tif (!_conv(t->tm_hour, 2, ' ', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'l':\n\t\t\t\tif (!_conv(t->tm_hour % 12 ?\n\t\t\t\t    t->tm_hour % 12: 12, 2, ' ', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'M':\n\t\t\t\tif (!_conv(t->tm_min, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'm':\n\t\t\t\tif (!_conv(t->tm_mon + 1, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'n':\n\t\t\t\tif (!_add(\"\\n\", pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'p':\n\t\t\t\tif (!_add(_CurrentTimeLocale->am_pm[t->tm_hour\n\t\t\t\t    >= 12], pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'R':\n\t\t\t\tif (!_fmt(\"%H:%M\", t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'r':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->t_fmt_ampm, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'S':\n\t\t\t\tif (!_conv(t->tm_sec, 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 's':\n\t\t\t\tif (!_secs(t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'T':\n\t\t\t\tif (!_fmt(\"%H:%M:%S\", t, pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 't':\n\t\t\t\tif (!_add(\"\\t\", pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'U':\n\t\t\t\tif (!_conv(SUN_WEEK(t), 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'u':\n\t\t\t\tif (!_conv(t->tm_wday ? t->tm_wday : 7, 1, '0',\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'V':\t/* ISO 8601 week number */\n\t\t\tcase 'G':\t/* ISO 8601 year (four digits) */\n\t\t\tcase 'g':\t/* ISO 8601 year (two digits) */\n/*\n** From Arnold Robbins' strftime version 3.0:  \"the week number of the\n** year (the first Monday as the first day of week 1) as a decimal number\n** (01-53).\"\n** (ado, 1993-05-24)\n**\n** From \"http://www.ft.uni-erlangen.de/~mskuhn/iso-time.html\" by Markus Kuhn:\n** \"Week 01 of a year is per definition the first week which has the\n** Thursday in this year, which is equivalent to the week which contains\n** the fourth day of January. In other words, the first week of a new year\n** is the week which has the majority of its days in the new year. Week 01\n** might also contain days from the previous year and the week before week\n** 01 of a year is the last week (52 or 53) of the previous year even if\n** it contains days from the new year. A week starts with Monday (day 1)\n** and ends with Sunday (day 7).  For example, the first week of the year\n** 1997 lasts from 1996-12-30 to 1997-01-05...\"\n** (ado, 1996-01-02)\n*/\n\t\t\t\t{\n\t\t\t\t\tint\tyear;\n\t\t\t\t\tint\tyday;\n\t\t\t\t\tint\twday;\n\t\t\t\t\tint\tw;\n\n\t\t\t\t\tyear = t->tm_year + TM_YEAR_BASE;\n\t\t\t\t\tyday = t->tm_yday;\n\t\t\t\t\twday = t->tm_wday;\n\t\t\t\t\tfor ( ; ; ) {\n\t\t\t\t\t\tint\tlen;\n\t\t\t\t\t\tint\tbot;\n\t\t\t\t\t\tint\ttop;\n\n\t\t\t\t\t\tlen = isleap(year) ?\n\t\t\t\t\t\t\tDAYSPERLYEAR :\n\t\t\t\t\t\t\tDAYSPERNYEAR;\n\t\t\t\t\t\t/*\n\t\t\t\t\t\t** What yday (-3 ... 3) does\n\t\t\t\t\t\t** the ISO year begin on?\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tbot = ((yday + 11 - wday) %\n\t\t\t\t\t\t\tDAYSPERWEEK) - 3;\n\t\t\t\t\t\t/*\n\t\t\t\t\t\t** What yday does the NEXT\n\t\t\t\t\t\t** ISO year begin on?\n\t\t\t\t\t\t*/\n\t\t\t\t\t\ttop = bot -\n\t\t\t\t\t\t\t(len % DAYSPERWEEK);\n\t\t\t\t\t\tif (top < -3)\n\t\t\t\t\t\t\ttop += DAYSPERWEEK;\n\t\t\t\t\t\ttop += len;\n\t\t\t\t\t\tif (yday >= top) {\n\t\t\t\t\t\t\t++year;\n\t\t\t\t\t\t\tw = 1;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (yday >= bot) {\n\t\t\t\t\t\t\tw = 1 + ((yday - bot) /\n\t\t\t\t\t\t\t\tDAYSPERWEEK);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t--year;\n\t\t\t\t\t\tyday += isleap(year) ?\n\t\t\t\t\t\t\tDAYSPERLYEAR :\n\t\t\t\t\t\t\tDAYSPERNYEAR;\n\t\t\t\t\t}\n#ifdef XPG4_1994_04_09\n\t\t\t\t\tif ((w == 52\n\t\t\t\t\t     && t->tm_mon == TM_JANUARY)\n\t\t\t\t\t    || (w == 1\n\t\t\t\t\t\t&& t->tm_mon == TM_DECEMBER))\n\t\t\t\t\t\tw = 53;\n#endif /* defined XPG4_1994_04_09 */\n\t\t\t\t\tif (*format == 'V') {\n\t\t\t\t\t\tif (!_conv(w, 2, '0',\n\t\t\t\t\t\t\tpt, ptlim))\n\t\t\t\t\t\t\treturn (0);\n\t\t\t\t\t} else if (*format == 'g') {\n\t\t\t\t\t\tif (!_conv(year % 100, 2, '0',\n\t\t\t\t\t\t\tpt, ptlim))\n\t\t\t\t\t\t\treturn (0);\n\t\t\t\t\t} else\tif (!_conv(year, 4, '0',\n\t\t\t\t\t\t\tpt, ptlim))\n\t\t\t\t\t\t\treturn (0);\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\tcase 'W':\n\t\t\t\tif (!_conv(MON_WEEK(t), 2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'w':\n\t\t\t\tif (!_conv(t->tm_wday, 1, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'x':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->d_fmt, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'X':\n\t\t\t\tif (!_fmt(_CurrentTimeLocale->t_fmt, t, pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'y':\n\t\t\t\tif (!_conv((t->tm_year + TM_YEAR_BASE) % 100,\n\t\t\t\t    2, '0', pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'Y':\n\t\t\t\tif (!_conv((t->tm_year + TM_YEAR_BASE), 4, '0',\n\t\t\t\t    pt, ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase 'Z':\n\t\t\t\tif (tzname[t->tm_isdst ? 1 : 0] &&\n\t\t\t\t    !_add(tzname[t->tm_isdst ? 1 : 0], pt,\n\t\t\t\t    ptlim))\n\t\t\t\t\treturn (0);\n\t\t\t\tcontinue;\n\t\t\tcase '%':\n\t\t\t/*\n\t\t\t * X311J/88-090 (4.12.3.5): if conversion char is\n\t\t\t * undefined, behavior is undefined.  Print out the\n\t\t\t * character itself as printf(3) does.\n\t\t\t */\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (*pt == ptlim)\n\t\t\treturn (0);\n\t\t*(*pt)++ = *format;\n\t}\n\treturn (ptlim - *pt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tzset",
          "args": [],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <string.h>\n\nstatic\tsize_t _fmt;\n\nsize_t\nstrftime(s, maxsize, format, t)\n\tchar *s;\n\tsize_t maxsize;\n\tconst char *format;\n\tconst struct tm *t;\n{\n\tchar *pt;\n\n\ttzset();\n\tif (maxsize < 1)\n\t\treturn (0);\n\n\tpt = s;\n\tif (_fmt(format, t, &pt, s + maxsize)) {\n\t\t*pt = '\\0';\n\t\treturn (pt - s);\n\t} else\n\t\treturn (0);\n}"
  }
]