[
  {
    "function_name": "tcl_krb5_get_object",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_krb5_hash.c",
    "lines": "129-166",
    "snippet": "ClientData tcl_krb5_get_object(Tcl_Interp *interp,\n\t\t\t       char *handle)\n{\n     char *myhandle, *id_ptr;\n     Tcl_HashTable *table;\n     Tcl_HashEntry *entry;\n\n     if (! (myhandle = strdup(handle))) {\n\t  Tcl_SetResult(interp, memory_error, TCL_STATIC);\n\t  return 0;\n     }\n\n     if (! (id_ptr = index(myhandle, *SEP_STR))) {\n\t  free(myhandle);\n\t  Tcl_ResetResult(interp);\n\t  Tcl_AppendResult(interp, \"malformatted handle \\\"\", handle,\n\t\t\t   \"\\\"\", 0);\n\t  return 0;\n     }\n\n     *id_ptr = '\\0';\n     \n     if (! (table = get_hash_table(interp, myhandle))) {\n\t  free(myhandle);\n\t  return 0;\n     }\n\n     free(myhandle);\n\n     if (! (entry = Tcl_FindHashEntry(table, handle))) {\n\t  Tcl_ResetResult(interp);\n\t  Tcl_AppendResult(interp, \"no object corresponding to handle \\\"\",\n\t\t\t   handle, \"\\\"\", 0);\n\t  return 0;\n     }\n\n     return(Tcl_GetHashValue(entry));\n}",
    "includes": [
      "#include <assert.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>"
    ],
    "macros_used": [
      "#define SEP_STR \"$\""
    ],
    "globals_used": [
      "static char *memory_error = \"out of memory\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "Tcl_GetHashValue",
          "args": [
            "entry"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendResult",
          "args": [
            "interp",
            "\"no object corresponding to handle \\\"\"",
            "handle",
            "\"\\\"\"",
            "0"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_ResetResult",
          "args": [
            "interp"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_FindHashEntry",
          "args": [
            "table",
            "handle"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "myhandle"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "free_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "939-943",
          "snippet": "static void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_hash_table",
          "args": [
            "interp",
            "myhandle"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "get_hash_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_krb5_hash.c",
          "lines": "56-69",
          "snippet": "static TclHashTable *get_hash_table(Tcl_Interp *interp,\n\t\t\t\t    char *type)\n{\n     static Tcl_HashTable *hash_table = 0;\n\n     if (! hash_table) {\n\t  if (! (hash_table = malloc(sizeof(*hash_table)))) {\n\t       Tcl_SetResult(interp, memory_error, TCL_STATIC);\n\t       return 0;\n\t  }\n\t  Tcl_InitHashTable(hash_table, TCL_STRING_KEYS);\n     }\n     return hash_table;\n}",
          "includes": [
            "#include <assert.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *memory_error = \"out of memory\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n\nstatic char *memory_error = \"out of memory\";\n\nstatic TclHashTable *get_hash_table(Tcl_Interp *interp,\n\t\t\t\t    char *type)\n{\n     static Tcl_HashTable *hash_table = 0;\n\n     if (! hash_table) {\n\t  if (! (hash_table = malloc(sizeof(*hash_table)))) {\n\t       Tcl_SetResult(interp, memory_error, TCL_STATIC);\n\t       return 0;\n\t  }\n\t  Tcl_InitHashTable(hash_table, TCL_STRING_KEYS);\n     }\n     return hash_table;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendResult",
          "args": [
            "interp",
            "\"malformatted handle \\\"\"",
            "handle",
            "\"\\\"\"",
            "0"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_ResetResult",
          "args": [
            "interp"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "myhandle",
            "*SEP_STR"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetResult",
          "args": [
            "interp",
            "memory_error",
            "TCL_STATIC"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "handle"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <assert.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n\n#define SEP_STR \"$\"\n\nstatic char *memory_error = \"out of memory\";\n\nClientData tcl_krb5_get_object(Tcl_Interp *interp,\n\t\t\t       char *handle)\n{\n     char *myhandle, *id_ptr;\n     Tcl_HashTable *table;\n     Tcl_HashEntry *entry;\n\n     if (! (myhandle = strdup(handle))) {\n\t  Tcl_SetResult(interp, memory_error, TCL_STATIC);\n\t  return 0;\n     }\n\n     if (! (id_ptr = index(myhandle, *SEP_STR))) {\n\t  free(myhandle);\n\t  Tcl_ResetResult(interp);\n\t  Tcl_AppendResult(interp, \"malformatted handle \\\"\", handle,\n\t\t\t   \"\\\"\", 0);\n\t  return 0;\n     }\n\n     *id_ptr = '\\0';\n     \n     if (! (table = get_hash_table(interp, myhandle))) {\n\t  free(myhandle);\n\t  return 0;\n     }\n\n     free(myhandle);\n\n     if (! (entry = Tcl_FindHashEntry(table, handle))) {\n\t  Tcl_ResetResult(interp);\n\t  Tcl_AppendResult(interp, \"no object corresponding to handle \\\"\",\n\t\t\t   handle, \"\\\"\", 0);\n\t  return 0;\n     }\n\n     return(Tcl_GetHashValue(entry));\n}"
  },
  {
    "function_name": "tcl_krb5_create_object",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_krb5_hash.c",
    "lines": "99-127",
    "snippet": "Tcl_DString *tcl_krb5_create_object(Tcl_Interp *interp,\n\t\t\t\t    char *type,\n\t\t\t\t    ClientData datum)\n{\n     Tcl_HashTable *table;\n     Tcl_DString *handle;\n     Tcl_HashEntry *entry;\n     int entry_created = 0;\n\n     if (! (table = get_hash_table(interp, type))) {\n\t  return 0;\n     }\n\n     if (! (handle = get_new_handle(interp, type))) {\n\t  return 0;\n     }\n\n     if (! (entry = Tcl_CreateHashEntry(table, handle, &entry_created))) {\n\t  Tcl_SetResult(interp, \"error creating hash entry\", TCL_STATIC);\n\t  Tcl_DStringFree(handle);\n\t  return TCL_ERROR;\n     }\n\n     assert(entry_created);\n\n     Tcl_SetHashValue(entry, datum);\n\n     return handle;\n}",
    "includes": [
      "#include <assert.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Tcl_SetHashValue",
          "args": [
            "entry",
            "datum"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "entry_created"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringFree",
          "args": [
            "handle"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetResult",
          "args": [
            "interp",
            "\"error creating hash entry\"",
            "TCL_STATIC"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateHashEntry",
          "args": [
            "table",
            "handle",
            "&entry_created"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_new_handle",
          "args": [
            "interp",
            "type"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "get_new_handle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_krb5_hash.c",
          "lines": "74-96",
          "snippet": "static Tcl_HashEntry *get_new_handle(Tcl_Interp *interp,\n\t\t\t\t     char *type)\n{\n     static unsigned long int id_counter = 0;\n     Tcl_DString *handle;\n     char int_buf[ID_BUF_SIZE];\n     \n     if (! (handle = malloc(sizeof(*handle)))) {\n\t  Tcl_SetResult(interp, memory_error, TCL_STATIC);\n\t  return 0;\n     }\n     Tcl_DStringInit(handle);\n\n     assert(id_counter <= MAX_ID);\n\n     sprintf(int_buf, \"%d\", id_counter++);\n\n     Tcl_DStringAppend(handle, type, -1);\n     Tcl_DStringAppend(handle, SEP_STR, -1);\n     Tcl_DStringAppend(handle, int_buf, -1);\n\n     return handle;\n}",
          "includes": [
            "#include <assert.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>"
          ],
          "macros_used": [
            "#define ID_BUF_SIZE 10",
            "#define MAX_ID 999999999",
            "#define SEP_STR \"$\""
          ],
          "globals_used": [
            "static char *memory_error = \"out of memory\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n\n#define ID_BUF_SIZE 10\n#define MAX_ID 999999999\n#define SEP_STR \"$\"\n\nstatic char *memory_error = \"out of memory\";\n\nstatic Tcl_HashEntry *get_new_handle(Tcl_Interp *interp,\n\t\t\t\t     char *type)\n{\n     static unsigned long int id_counter = 0;\n     Tcl_DString *handle;\n     char int_buf[ID_BUF_SIZE];\n     \n     if (! (handle = malloc(sizeof(*handle)))) {\n\t  Tcl_SetResult(interp, memory_error, TCL_STATIC);\n\t  return 0;\n     }\n     Tcl_DStringInit(handle);\n\n     assert(id_counter <= MAX_ID);\n\n     sprintf(int_buf, \"%d\", id_counter++);\n\n     Tcl_DStringAppend(handle, type, -1);\n     Tcl_DStringAppend(handle, SEP_STR, -1);\n     Tcl_DStringAppend(handle, int_buf, -1);\n\n     return handle;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_hash_table",
          "args": [
            "interp",
            "type"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "get_hash_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_krb5_hash.c",
          "lines": "56-69",
          "snippet": "static TclHashTable *get_hash_table(Tcl_Interp *interp,\n\t\t\t\t    char *type)\n{\n     static Tcl_HashTable *hash_table = 0;\n\n     if (! hash_table) {\n\t  if (! (hash_table = malloc(sizeof(*hash_table)))) {\n\t       Tcl_SetResult(interp, memory_error, TCL_STATIC);\n\t       return 0;\n\t  }\n\t  Tcl_InitHashTable(hash_table, TCL_STRING_KEYS);\n     }\n     return hash_table;\n}",
          "includes": [
            "#include <assert.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *memory_error = \"out of memory\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n\nstatic char *memory_error = \"out of memory\";\n\nstatic TclHashTable *get_hash_table(Tcl_Interp *interp,\n\t\t\t\t    char *type)\n{\n     static Tcl_HashTable *hash_table = 0;\n\n     if (! hash_table) {\n\t  if (! (hash_table = malloc(sizeof(*hash_table)))) {\n\t       Tcl_SetResult(interp, memory_error, TCL_STATIC);\n\t       return 0;\n\t  }\n\t  Tcl_InitHashTable(hash_table, TCL_STRING_KEYS);\n     }\n     return hash_table;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <assert.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n\nTcl_DString *tcl_krb5_create_object(Tcl_Interp *interp,\n\t\t\t\t    char *type,\n\t\t\t\t    ClientData datum)\n{\n     Tcl_HashTable *table;\n     Tcl_DString *handle;\n     Tcl_HashEntry *entry;\n     int entry_created = 0;\n\n     if (! (table = get_hash_table(interp, type))) {\n\t  return 0;\n     }\n\n     if (! (handle = get_new_handle(interp, type))) {\n\t  return 0;\n     }\n\n     if (! (entry = Tcl_CreateHashEntry(table, handle, &entry_created))) {\n\t  Tcl_SetResult(interp, \"error creating hash entry\", TCL_STATIC);\n\t  Tcl_DStringFree(handle);\n\t  return TCL_ERROR;\n     }\n\n     assert(entry_created);\n\n     Tcl_SetHashValue(entry, datum);\n\n     return handle;\n}"
  },
  {
    "function_name": "get_new_handle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_krb5_hash.c",
    "lines": "74-96",
    "snippet": "static Tcl_HashEntry *get_new_handle(Tcl_Interp *interp,\n\t\t\t\t     char *type)\n{\n     static unsigned long int id_counter = 0;\n     Tcl_DString *handle;\n     char int_buf[ID_BUF_SIZE];\n     \n     if (! (handle = malloc(sizeof(*handle)))) {\n\t  Tcl_SetResult(interp, memory_error, TCL_STATIC);\n\t  return 0;\n     }\n     Tcl_DStringInit(handle);\n\n     assert(id_counter <= MAX_ID);\n\n     sprintf(int_buf, \"%d\", id_counter++);\n\n     Tcl_DStringAppend(handle, type, -1);\n     Tcl_DStringAppend(handle, SEP_STR, -1);\n     Tcl_DStringAppend(handle, int_buf, -1);\n\n     return handle;\n}",
    "includes": [
      "#include <assert.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>"
    ],
    "macros_used": [
      "#define ID_BUF_SIZE 10",
      "#define MAX_ID 999999999",
      "#define SEP_STR \"$\""
    ],
    "globals_used": [
      "static char *memory_error = \"out of memory\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "Tcl_DStringAppend",
          "args": [
            "handle",
            "int_buf",
            "-1"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppend",
          "args": [
            "handle",
            "SEP_STR",
            "-1"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppend",
          "args": [
            "handle",
            "type",
            "-1"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "int_buf",
            "\"%d\"",
            "id_counter++"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "id_counter <= MAX_ID"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringInit",
          "args": [
            "handle"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetResult",
          "args": [
            "interp",
            "memory_error",
            "TCL_STATIC"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*handle)"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <assert.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n\n#define ID_BUF_SIZE 10\n#define MAX_ID 999999999\n#define SEP_STR \"$\"\n\nstatic char *memory_error = \"out of memory\";\n\nstatic Tcl_HashEntry *get_new_handle(Tcl_Interp *interp,\n\t\t\t\t     char *type)\n{\n     static unsigned long int id_counter = 0;\n     Tcl_DString *handle;\n     char int_buf[ID_BUF_SIZE];\n     \n     if (! (handle = malloc(sizeof(*handle)))) {\n\t  Tcl_SetResult(interp, memory_error, TCL_STATIC);\n\t  return 0;\n     }\n     Tcl_DStringInit(handle);\n\n     assert(id_counter <= MAX_ID);\n\n     sprintf(int_buf, \"%d\", id_counter++);\n\n     Tcl_DStringAppend(handle, type, -1);\n     Tcl_DStringAppend(handle, SEP_STR, -1);\n     Tcl_DStringAppend(handle, int_buf, -1);\n\n     return handle;\n}"
  },
  {
    "function_name": "get_hash_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_krb5_hash.c",
    "lines": "56-69",
    "snippet": "static TclHashTable *get_hash_table(Tcl_Interp *interp,\n\t\t\t\t    char *type)\n{\n     static Tcl_HashTable *hash_table = 0;\n\n     if (! hash_table) {\n\t  if (! (hash_table = malloc(sizeof(*hash_table)))) {\n\t       Tcl_SetResult(interp, memory_error, TCL_STATIC);\n\t       return 0;\n\t  }\n\t  Tcl_InitHashTable(hash_table, TCL_STRING_KEYS);\n     }\n     return hash_table;\n}",
    "includes": [
      "#include <assert.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char *memory_error = \"out of memory\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "Tcl_InitHashTable",
          "args": [
            "hash_table",
            "TCL_STRING_KEYS"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetResult",
          "args": [
            "interp",
            "memory_error",
            "TCL_STATIC"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*hash_table)"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <assert.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n\nstatic char *memory_error = \"out of memory\";\n\nstatic TclHashTable *get_hash_table(Tcl_Interp *interp,\n\t\t\t\t    char *type)\n{\n     static Tcl_HashTable *hash_table = 0;\n\n     if (! hash_table) {\n\t  if (! (hash_table = malloc(sizeof(*hash_table)))) {\n\t       Tcl_SetResult(interp, memory_error, TCL_STATIC);\n\t       return 0;\n\t  }\n\t  Tcl_InitHashTable(hash_table, TCL_STRING_KEYS);\n     }\n     return hash_table;\n}"
  }
]