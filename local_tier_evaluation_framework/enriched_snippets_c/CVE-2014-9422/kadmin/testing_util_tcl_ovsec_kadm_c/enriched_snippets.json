[
  {
    "function_name": "Tcl_ovsec_kadm_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "1978-2029",
    "snippet": "void Tcl_ovsec_kadm_init(Tcl_Interp *interp)\n{\n    char buf[20];\n\n     Tcl_SetVar(interp, \"OVSEC_KADM_ADMIN_SERVICE\",\n\t\tOVSEC_KADM_ADMIN_SERVICE, TCL_GLOBAL_ONLY);\n     Tcl_SetVar(interp, \"OVSEC_KADM_CHANGEPW_SERVICE\",\n\t\tOVSEC_KADM_CHANGEPW_SERVICE, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", OVSEC_KADM_STRUCT_VERSION);\n     Tcl_SetVar(interp, \"OVSEC_KADM_STRUCT_VERSION\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", OVSEC_KADM_API_VERSION_1);\n     Tcl_SetVar(interp, \"OVSEC_KADM_API_VERSION_1\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", OVSEC_KADM_API_VERSION_MASK);\n     Tcl_SetVar(interp, \"OVSEC_KADM_API_VERSION_MASK\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", OVSEC_KADM_STRUCT_VERSION_MASK);\n     Tcl_SetVar(interp, \"OVSEC_KADM_STRUCT_VERSION_MASK\", buf,\n\t\tTCL_GLOBAL_ONLY);\n\n     Tcl_CreateCommand(interp, \"ovsec_kadm_init\", tcl_ovsec_kadm_init, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_destroy\", tcl_ovsec_kadm_destroy, 0,\n\t\t       0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_create_principal\",\n\t\t       tcl_ovsec_kadm_create_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_delete_principal\",\n\t\t       tcl_ovsec_kadm_delete_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_modify_principal\",\n\t\t       tcl_ovsec_kadm_modify_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_rename_principal\",\n\t\t       tcl_ovsec_kadm_rename_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_chpass_principal\",\n\t\t       tcl_ovsec_kadm_chpass_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_chpass_principal_util\",\n\t\t       tcl_ovsec_kadm_chpass_principal_util, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_randkey_principal\",\n\t\t       tcl_ovsec_kadm_randkey_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_get_principal\",\n\t\t       tcl_ovsec_kadm_get_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_create_policy\",\n\t\t       tcl_ovsec_kadm_create_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_delete_policy\",\n\t\t       tcl_ovsec_kadm_delete_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_modify_policy\",\n\t\t       tcl_ovsec_kadm_modify_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_get_policy\",\n\t\t       tcl_ovsec_kadm_get_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_free_principal_ent\",\n\t\t       tcl_ovsec_kadm_free_principal_ent, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_free_policy_ent\",\n\t\t       tcl_ovsec_kadm_free_policy_ent, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_get_privs\",\n\t\t       tcl_ovsec_kadm_get_privs, 0, 0);\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Tcl_CreateCommand",
          "args": [
            "interp",
            "\"ovsec_kadm_get_privs\"",
            "tcl_ovsec_kadm_get_privs",
            "0",
            "0"
          ],
          "line": 2027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateCommand",
          "args": [
            "interp",
            "\"ovsec_kadm_free_policy_ent\"",
            "tcl_ovsec_kadm_free_policy_ent",
            "0",
            "0"
          ],
          "line": 2025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateCommand",
          "args": [
            "interp",
            "\"ovsec_kadm_free_principal_ent\"",
            "tcl_ovsec_kadm_free_principal_ent",
            "0",
            "0"
          ],
          "line": 2023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateCommand",
          "args": [
            "interp",
            "\"ovsec_kadm_get_policy\"",
            "tcl_ovsec_kadm_get_policy",
            "0",
            "0"
          ],
          "line": 2021
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateCommand",
          "args": [
            "interp",
            "\"ovsec_kadm_modify_policy\"",
            "tcl_ovsec_kadm_modify_policy",
            "0",
            "0"
          ],
          "line": 2019
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateCommand",
          "args": [
            "interp",
            "\"ovsec_kadm_delete_policy\"",
            "tcl_ovsec_kadm_delete_policy",
            "0",
            "0"
          ],
          "line": 2017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateCommand",
          "args": [
            "interp",
            "\"ovsec_kadm_create_policy\"",
            "tcl_ovsec_kadm_create_policy",
            "0",
            "0"
          ],
          "line": 2015
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateCommand",
          "args": [
            "interp",
            "\"ovsec_kadm_get_principal\"",
            "tcl_ovsec_kadm_get_principal",
            "0",
            "0"
          ],
          "line": 2013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateCommand",
          "args": [
            "interp",
            "\"ovsec_kadm_randkey_principal\"",
            "tcl_ovsec_kadm_randkey_principal",
            "0",
            "0"
          ],
          "line": 2011
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateCommand",
          "args": [
            "interp",
            "\"ovsec_kadm_chpass_principal_util\"",
            "tcl_ovsec_kadm_chpass_principal_util",
            "0",
            "0"
          ],
          "line": 2009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateCommand",
          "args": [
            "interp",
            "\"ovsec_kadm_chpass_principal\"",
            "tcl_ovsec_kadm_chpass_principal",
            "0",
            "0"
          ],
          "line": 2007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateCommand",
          "args": [
            "interp",
            "\"ovsec_kadm_rename_principal\"",
            "tcl_ovsec_kadm_rename_principal",
            "0",
            "0"
          ],
          "line": 2005
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateCommand",
          "args": [
            "interp",
            "\"ovsec_kadm_modify_principal\"",
            "tcl_ovsec_kadm_modify_principal",
            "0",
            "0"
          ],
          "line": 2003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateCommand",
          "args": [
            "interp",
            "\"ovsec_kadm_delete_principal\"",
            "tcl_ovsec_kadm_delete_principal",
            "0",
            "0"
          ],
          "line": 2001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateCommand",
          "args": [
            "interp",
            "\"ovsec_kadm_create_principal\"",
            "tcl_ovsec_kadm_create_principal",
            "0",
            "0"
          ],
          "line": 1999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateCommand",
          "args": [
            "interp",
            "\"ovsec_kadm_destroy\"",
            "tcl_ovsec_kadm_destroy",
            "0",
            "0"
          ],
          "line": 1997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateCommand",
          "args": [
            "interp",
            "\"ovsec_kadm_init\"",
            "tcl_ovsec_kadm_init",
            "0",
            "0"
          ],
          "line": 1996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetVar",
          "args": [
            "interp",
            "\"OVSEC_KADM_STRUCT_VERSION_MASK\"",
            "buf",
            "TCL_GLOBAL_ONLY"
          ],
          "line": 1993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\"",
            "OVSEC_KADM_STRUCT_VERSION_MASK"
          ],
          "line": 1992
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetVar",
          "args": [
            "interp",
            "\"OVSEC_KADM_API_VERSION_MASK\"",
            "buf",
            "TCL_GLOBAL_ONLY"
          ],
          "line": 1991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\"",
            "OVSEC_KADM_API_VERSION_MASK"
          ],
          "line": 1990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetVar",
          "args": [
            "interp",
            "\"OVSEC_KADM_API_VERSION_1\"",
            "buf",
            "TCL_GLOBAL_ONLY"
          ],
          "line": 1989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\"",
            "OVSEC_KADM_API_VERSION_1"
          ],
          "line": 1988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetVar",
          "args": [
            "interp",
            "\"OVSEC_KADM_STRUCT_VERSION\"",
            "buf",
            "TCL_GLOBAL_ONLY"
          ],
          "line": 1987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\"",
            "OVSEC_KADM_STRUCT_VERSION"
          ],
          "line": 1986
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetVar",
          "args": [
            "interp",
            "\"OVSEC_KADM_CHANGEPW_SERVICE\"",
            "OVSEC_KADM_CHANGEPW_SERVICE",
            "TCL_GLOBAL_ONLY"
          ],
          "line": 1984
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetVar",
          "args": [
            "interp",
            "\"OVSEC_KADM_ADMIN_SERVICE\"",
            "OVSEC_KADM_ADMIN_SERVICE",
            "TCL_GLOBAL_ONLY"
          ],
          "line": 1982
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nvoid Tcl_ovsec_kadm_init(Tcl_Interp *interp)\n{\n    char buf[20];\n\n     Tcl_SetVar(interp, \"OVSEC_KADM_ADMIN_SERVICE\",\n\t\tOVSEC_KADM_ADMIN_SERVICE, TCL_GLOBAL_ONLY);\n     Tcl_SetVar(interp, \"OVSEC_KADM_CHANGEPW_SERVICE\",\n\t\tOVSEC_KADM_CHANGEPW_SERVICE, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", OVSEC_KADM_STRUCT_VERSION);\n     Tcl_SetVar(interp, \"OVSEC_KADM_STRUCT_VERSION\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", OVSEC_KADM_API_VERSION_1);\n     Tcl_SetVar(interp, \"OVSEC_KADM_API_VERSION_1\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", OVSEC_KADM_API_VERSION_MASK);\n     Tcl_SetVar(interp, \"OVSEC_KADM_API_VERSION_MASK\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", OVSEC_KADM_STRUCT_VERSION_MASK);\n     Tcl_SetVar(interp, \"OVSEC_KADM_STRUCT_VERSION_MASK\", buf,\n\t\tTCL_GLOBAL_ONLY);\n\n     Tcl_CreateCommand(interp, \"ovsec_kadm_init\", tcl_ovsec_kadm_init, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_destroy\", tcl_ovsec_kadm_destroy, 0,\n\t\t       0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_create_principal\",\n\t\t       tcl_ovsec_kadm_create_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_delete_principal\",\n\t\t       tcl_ovsec_kadm_delete_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_modify_principal\",\n\t\t       tcl_ovsec_kadm_modify_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_rename_principal\",\n\t\t       tcl_ovsec_kadm_rename_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_chpass_principal\",\n\t\t       tcl_ovsec_kadm_chpass_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_chpass_principal_util\",\n\t\t       tcl_ovsec_kadm_chpass_principal_util, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_randkey_principal\",\n\t\t       tcl_ovsec_kadm_randkey_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_get_principal\",\n\t\t       tcl_ovsec_kadm_get_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_create_policy\",\n\t\t       tcl_ovsec_kadm_create_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_delete_policy\",\n\t\t       tcl_ovsec_kadm_delete_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_modify_policy\",\n\t\t       tcl_ovsec_kadm_modify_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_get_policy\",\n\t\t       tcl_ovsec_kadm_get_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_free_principal_ent\",\n\t\t       tcl_ovsec_kadm_free_principal_ent, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_free_policy_ent\",\n\t\t       tcl_ovsec_kadm_free_policy_ent, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_get_privs\",\n\t\t       tcl_ovsec_kadm_get_privs, 0, 0);\n}"
  },
  {
    "function_name": "tcl_ovsec_kadm_get_privs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "1939-1975",
    "snippet": "static int tcl_ovsec_kadm_get_privs(ClientData clientData, Tcl_Interp *interp,\n\t\t\t\t    int argc, char *argv[])\n{\n     char *set_ret;\n     ovsec_kadm_ret_t ret;\n     char *priv_var;\n     long privs;\n\n     GET_HANDLE(1, 0);\n\n     if (parse_str(interp, argv[0], &priv_var) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing privs variable name\");\n\t  return TCL_ERROR;\n     }\n\n     ret = ovsec_kadm_get_privs(server_handle, priv_var ? &privs : 0);\n\n     if (ret == OVSEC_KADM_OK) {\n\t  if (priv_var) {\n\t       Tcl_DString *str = unparse_privs(privs);\n\t       set_ret = Tcl_SetVar(interp, priv_var, str->string,\n\t\t\t\t    TCL_LEAVE_ERR_MSG);\n\t       Tcl_DStringFree(str);\n\t       free(str);\n\t       if (! set_ret) {\n\t\t    Tcl_AppendElement(interp, \"while setting priv variable\");\n\t\t    return TCL_ERROR;\n\t       }\n\t  }\n\t  set_ok(interp, \"Privileges retrieved.\");\n\t  return TCL_OK;\n     }\n     else {\n\t  stash_error(interp, ret);\n\t  return TCL_ERROR;\n     }\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stash_error",
          "args": [
            "interp",
            "ret"
          ],
          "line": 1972
        },
        "resolved": true,
        "details": {
          "function_name": "stash_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "407-413",
          "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_ok",
          "args": [
            "interp",
            "\"Privileges retrieved.\""
          ],
          "line": 1968
        },
        "resolved": true,
        "details": {
          "function_name": "set_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "244-249",
          "snippet": "static void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while setting priv variable\""
          ],
          "line": 1964
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "str"
          ],
          "line": 1962
        },
        "resolved": true,
        "details": {
          "function_name": "free_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "939-943",
          "snippet": "static void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_DStringFree",
          "args": [
            "str"
          ],
          "line": 1961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetVar",
          "args": [
            "interp",
            "priv_var",
            "str->string",
            "TCL_LEAVE_ERR_MSG"
          ],
          "line": 1959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unparse_privs",
          "args": [
            "privs"
          ],
          "line": 1958
        },
        "resolved": true,
        "details": {
          "function_name": "unparse_privs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "477-481",
          "snippet": "static Tcl_DString *unparse_privs(krb5_flags flags)\n{\n     return unparse_flags(priv_flags, sizeof(priv_flags) /\n\t\t\t  sizeof(struct flagval), flags);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct flagval priv_flags[] = {\n     {\"OVSEC_KADM_PRIV_GET\", OVSEC_KADM_PRIV_GET},\n     {\"OVSEC_KADM_PRIV_ADD\", OVSEC_KADM_PRIV_ADD},\n     {\"OVSEC_KADM_PRIV_MODIFY\", OVSEC_KADM_PRIV_MODIFY},\n     {\"OVSEC_KADM_PRIV_DELETE\", OVSEC_KADM_PRIV_DELETE}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstruct flagval priv_flags[] = {\n     {\"OVSEC_KADM_PRIV_GET\", OVSEC_KADM_PRIV_GET},\n     {\"OVSEC_KADM_PRIV_ADD\", OVSEC_KADM_PRIV_ADD},\n     {\"OVSEC_KADM_PRIV_MODIFY\", OVSEC_KADM_PRIV_MODIFY},\n     {\"OVSEC_KADM_PRIV_DELETE\", OVSEC_KADM_PRIV_DELETE}\n};\n\nstatic Tcl_DString *unparse_privs(krb5_flags flags)\n{\n     return unparse_flags(priv_flags, sizeof(priv_flags) /\n\t\t\t  sizeof(struct flagval), flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_get_privs",
          "args": [
            "server_handle",
            "priv_var ? &privs : 0"
          ],
          "line": 1954
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing privs variable name\""
          ],
          "line": 1950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_str",
          "args": [
            "interp",
            "argv[0]",
            "&priv_var"
          ],
          "line": 1949
        },
        "resolved": true,
        "details": {
          "function_name": "parse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "229-241",
          "snippet": "static int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GET_HANDLE",
          "args": [
            "1",
            "0"
          ],
          "line": 1947
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int tcl_ovsec_kadm_get_privs(ClientData clientData, Tcl_Interp *interp,\n\t\t\t\t    int argc, char *argv[])\n{\n     char *set_ret;\n     ovsec_kadm_ret_t ret;\n     char *priv_var;\n     long privs;\n\n     GET_HANDLE(1, 0);\n\n     if (parse_str(interp, argv[0], &priv_var) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing privs variable name\");\n\t  return TCL_ERROR;\n     }\n\n     ret = ovsec_kadm_get_privs(server_handle, priv_var ? &privs : 0);\n\n     if (ret == OVSEC_KADM_OK) {\n\t  if (priv_var) {\n\t       Tcl_DString *str = unparse_privs(privs);\n\t       set_ret = Tcl_SetVar(interp, priv_var, str->string,\n\t\t\t\t    TCL_LEAVE_ERR_MSG);\n\t       Tcl_DStringFree(str);\n\t       free(str);\n\t       if (! set_ret) {\n\t\t    Tcl_AppendElement(interp, \"while setting priv variable\");\n\t\t    return TCL_ERROR;\n\t       }\n\t  }\n\t  set_ok(interp, \"Privileges retrieved.\");\n\t  return TCL_OK;\n     }\n     else {\n\t  stash_error(interp, ret);\n\t  return TCL_ERROR;\n     }\n}"
  },
  {
    "function_name": "tcl_ovsec_kadm_free_policy_ent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "1884-1936",
    "snippet": "static int tcl_ovsec_kadm_free_policy_ent(ClientData clientData,\n\t\t\t\t\t  Tcl_Interp *interp,\n\t\t\t\t\t  int argc, char *argv[])\n{\n     char *ent_name;\n     ovsec_kadm_policy_ent_t ent;\n     ovsec_kadm_ret_t ret;\n\n     GET_HANDLE(1, 0);\n\n     if (parse_str(interp, argv[0], &ent_name) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing entry name\");\n\t  return TCL_ERROR;\n     }\n\n     if ((! ent_name) &&\n\t (ret = ovsec_kadm_free_policy_ent(server_handle, 0))) {\n\t stash_error(interp, ret);\n\t return TCL_ERROR;\n     }\n     else {\n\t  Tcl_HashEntry *entry;\n\n\t  if (strncmp(ent_name, \"policy\", sizeof(\"policy\")-1)) {\n\t       Tcl_AppendResult(interp, \"invalid principal handle \\\"\",\n\t\t\t\tent_name, \"\\\"\", 0);\n\t       return TCL_ERROR;\n\t  }\n\t  if (! struct_table) {\n\t       if (! (struct_table = malloc(sizeof(*struct_table)))) {\n\t\t    fprintf(stderr, \"Out of memory!\\n\");\n\t\t    exit(1); /* XXX */\n\t       }\n\t       Tcl_InitHashTable(struct_table, TCL_STRING_KEYS);\n\t  }\n\t  \n\t  if (! (entry = Tcl_FindHashEntry(struct_table, ent_name))) {\n\t       Tcl_AppendResult(interp, \"policy handle \\\"\", ent_name,\n\t\t\t\t\"\\\" not found\", 0);\n\t       return TCL_ERROR;\n\t  }\n\n\t  ent = (ovsec_kadm_policy_ent_t) Tcl_GetHashValue(entry);\n\n\t  if ((ret = ovsec_kadm_free_policy_ent(server_handle, ent))) {\n\t      stash_error(interp, ret);\n\t      return TCL_ERROR;\n\t  }\n\t  Tcl_DeleteHashEntry(entry);\n     }\n     set_ok(interp, \"Policy freed.\");\n     return TCL_OK;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static Tcl_HashTable *struct_table = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_ok",
          "args": [
            "interp",
            "\"Policy freed.\""
          ],
          "line": 1934
        },
        "resolved": true,
        "details": {
          "function_name": "set_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "244-249",
          "snippet": "static void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_DeleteHashEntry",
          "args": [
            "entry"
          ],
          "line": 1932
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stash_error",
          "args": [
            "interp",
            "ret"
          ],
          "line": 1929
        },
        "resolved": true,
        "details": {
          "function_name": "stash_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "407-413",
          "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_free_policy_ent",
          "args": [
            "server_handle",
            "ent"
          ],
          "line": 1928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetHashValue",
          "args": [
            "entry"
          ],
          "line": 1926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendResult",
          "args": [
            "interp",
            "\"policy handle \\\"\"",
            "ent_name",
            "\"\\\" not found\"",
            "0"
          ],
          "line": 1921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_FindHashEntry",
          "args": [
            "struct_table",
            "ent_name"
          ],
          "line": 1920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_InitHashTable",
          "args": [
            "struct_table",
            "TCL_STRING_KEYS"
          ],
          "line": 1917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 1915
        },
        "resolved": true,
        "details": {
          "function_name": "request_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/server/ovsec_kadmd.c",
          "lines": "841-846",
          "snippet": "void request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}",
          "includes": [
            "#include    \"purify.h\"",
            "#include    \"misc.h\"",
            "#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */",
            "#include    <string.h>",
            "#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */",
            "#include    <krb5/adm_proto.h>",
            "#include    <kadm5/server_acl.h>",
            "#include    <kadm5/kadm_rpc.h>",
            "#include    <kadm5/admin.h>",
            "#include    <gssrpc/auth_gssapi.h>",
            "#include    \"gssapiP_krb5.h\" /* for kg_get_context */",
            "#include    <gssapi/gssapi.h>",
            "#include    <gssrpc/rpc.h>",
            "#include    <arpa/inet.h>  /* inet_ntoa */",
            "#include    <netinet/in.h>",
            "#include    <unistd.h>",
            "#include    <sys/socket.h>",
            "#include    <sys/time.h>",
            "#include    <sys/select.h>",
            "#include    <sys/types.h>",
            "#include    <syslog.h>",
            "#include    <signal.h>",
            "#include    <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "volatile int\tsignal_request_exit = 0;",
            "void\trequest_exit(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include    \"purify.h\"\n#include    \"misc.h\"\n#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */\n#include    <string.h>\n#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */\n#include    <krb5/adm_proto.h>\n#include    <kadm5/server_acl.h>\n#include    <kadm5/kadm_rpc.h>\n#include    <kadm5/admin.h>\n#include    <gssrpc/auth_gssapi.h>\n#include    \"gssapiP_krb5.h\" /* for kg_get_context */\n#include    <gssapi/gssapi.h>\n#include    <gssrpc/rpc.h>\n#include    <arpa/inet.h>  /* inet_ntoa */\n#include    <netinet/in.h>\n#include    <unistd.h>\n#include    <sys/socket.h>\n#include    <sys/time.h>\n#include    <sys/select.h>\n#include    <sys/types.h>\n#include    <syslog.h>\n#include    <signal.h>\n#include    <stdio.h>\n\nvolatile int\tsignal_request_exit = 0;\nvoid\trequest_exit(int);\n\nvoid request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 1914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*struct_table)"
          ],
          "line": 1913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendResult",
          "args": [
            "interp",
            "\"invalid principal handle \\\"\"",
            "ent_name",
            "\"\\\"\"",
            "0"
          ],
          "line": 1908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "ent_name",
            "\"policy\"",
            "sizeof(\"policy\")-1"
          ],
          "line": 1907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_free_policy_ent",
          "args": [
            "server_handle",
            "0"
          ],
          "line": 1900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing entry name\""
          ],
          "line": 1895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_str",
          "args": [
            "interp",
            "argv[0]",
            "&ent_name"
          ],
          "line": 1894
        },
        "resolved": true,
        "details": {
          "function_name": "parse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "229-241",
          "snippet": "static int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GET_HANDLE",
          "args": [
            "1",
            "0"
          ],
          "line": 1892
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_HashTable *struct_table = 0;\n\nstatic int tcl_ovsec_kadm_free_policy_ent(ClientData clientData,\n\t\t\t\t\t  Tcl_Interp *interp,\n\t\t\t\t\t  int argc, char *argv[])\n{\n     char *ent_name;\n     ovsec_kadm_policy_ent_t ent;\n     ovsec_kadm_ret_t ret;\n\n     GET_HANDLE(1, 0);\n\n     if (parse_str(interp, argv[0], &ent_name) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing entry name\");\n\t  return TCL_ERROR;\n     }\n\n     if ((! ent_name) &&\n\t (ret = ovsec_kadm_free_policy_ent(server_handle, 0))) {\n\t stash_error(interp, ret);\n\t return TCL_ERROR;\n     }\n     else {\n\t  Tcl_HashEntry *entry;\n\n\t  if (strncmp(ent_name, \"policy\", sizeof(\"policy\")-1)) {\n\t       Tcl_AppendResult(interp, \"invalid principal handle \\\"\",\n\t\t\t\tent_name, \"\\\"\", 0);\n\t       return TCL_ERROR;\n\t  }\n\t  if (! struct_table) {\n\t       if (! (struct_table = malloc(sizeof(*struct_table)))) {\n\t\t    fprintf(stderr, \"Out of memory!\\n\");\n\t\t    exit(1); /* XXX */\n\t       }\n\t       Tcl_InitHashTable(struct_table, TCL_STRING_KEYS);\n\t  }\n\t  \n\t  if (! (entry = Tcl_FindHashEntry(struct_table, ent_name))) {\n\t       Tcl_AppendResult(interp, \"policy handle \\\"\", ent_name,\n\t\t\t\t\"\\\" not found\", 0);\n\t       return TCL_ERROR;\n\t  }\n\n\t  ent = (ovsec_kadm_policy_ent_t) Tcl_GetHashValue(entry);\n\n\t  if ((ret = ovsec_kadm_free_policy_ent(server_handle, ent))) {\n\t      stash_error(interp, ret);\n\t      return TCL_ERROR;\n\t  }\n\t  Tcl_DeleteHashEntry(entry);\n     }\n     set_ok(interp, \"Policy freed.\");\n     return TCL_OK;\n}"
  },
  {
    "function_name": "tcl_ovsec_kadm_free_principal_ent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "1829-1881",
    "snippet": "static int tcl_ovsec_kadm_free_principal_ent(ClientData clientData,\n\t\t\t\t\t     Tcl_Interp *interp,\n\t\t\t\t\t     int argc, char *argv[])\n{\n     char *ent_name;\n     ovsec_kadm_principal_ent_t ent;\n     ovsec_kadm_ret_t ret;\n\n     GET_HANDLE(1, 0);\n\n     if (parse_str(interp, argv[0], &ent_name) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing entry name\");\n\t  return TCL_ERROR;\n     }\n\n     if ((! ent_name) &&\n\t (ret = ovsec_kadm_free_principal_ent(server_handle, 0))) {\n\t stash_error(interp, ret);\n\t return TCL_ERROR;\n     }\n     else {\n\t  Tcl_HashEntry *entry;\n\n\t  if (strncmp(ent_name, \"principal\", sizeof(\"principal\")-1)) {\n\t       Tcl_AppendResult(interp, \"invalid principal handle \\\"\",\n\t\t\t\tent_name, \"\\\"\", 0);\n\t       return TCL_ERROR;\n\t  }\n\t  if (! struct_table) {\n\t       if (! (struct_table = malloc(sizeof(*struct_table)))) {\n\t\t    fprintf(stderr, \"Out of memory!\\n\");\n\t\t    exit(1); /* XXX */\n\t       }\n\t       Tcl_InitHashTable(struct_table, TCL_STRING_KEYS);\n\t  }\n\t  \n\t  if (! (entry = Tcl_FindHashEntry(struct_table, ent_name))) {\n\t       Tcl_AppendResult(interp, \"principal handle \\\"\", ent_name,\n\t\t\t\t\"\\\" not found\", 0);\n\t       return TCL_ERROR;\n\t  }\n\n\t  ent = (ovsec_kadm_principal_ent_t) Tcl_GetHashValue(entry);\n\n\t  if ((ret = ovsec_kadm_free_principal_ent(server_handle, ent))) {\n\t      stash_error(interp, ret);\n\t      return TCL_ERROR;\n\t  }\n\t  Tcl_DeleteHashEntry(entry);\n     }\n     set_ok(interp, \"Principal freed.\");\n     return TCL_OK;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static Tcl_HashTable *struct_table = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_ok",
          "args": [
            "interp",
            "\"Principal freed.\""
          ],
          "line": 1879
        },
        "resolved": true,
        "details": {
          "function_name": "set_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "244-249",
          "snippet": "static void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_DeleteHashEntry",
          "args": [
            "entry"
          ],
          "line": 1877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stash_error",
          "args": [
            "interp",
            "ret"
          ],
          "line": 1874
        },
        "resolved": true,
        "details": {
          "function_name": "stash_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "407-413",
          "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_free_principal_ent",
          "args": [
            "server_handle",
            "ent"
          ],
          "line": 1873
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetHashValue",
          "args": [
            "entry"
          ],
          "line": 1871
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendResult",
          "args": [
            "interp",
            "\"principal handle \\\"\"",
            "ent_name",
            "\"\\\" not found\"",
            "0"
          ],
          "line": 1866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_FindHashEntry",
          "args": [
            "struct_table",
            "ent_name"
          ],
          "line": 1865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_InitHashTable",
          "args": [
            "struct_table",
            "TCL_STRING_KEYS"
          ],
          "line": 1862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 1860
        },
        "resolved": true,
        "details": {
          "function_name": "request_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/server/ovsec_kadmd.c",
          "lines": "841-846",
          "snippet": "void request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}",
          "includes": [
            "#include    \"purify.h\"",
            "#include    \"misc.h\"",
            "#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */",
            "#include    <string.h>",
            "#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */",
            "#include    <krb5/adm_proto.h>",
            "#include    <kadm5/server_acl.h>",
            "#include    <kadm5/kadm_rpc.h>",
            "#include    <kadm5/admin.h>",
            "#include    <gssrpc/auth_gssapi.h>",
            "#include    \"gssapiP_krb5.h\" /* for kg_get_context */",
            "#include    <gssapi/gssapi.h>",
            "#include    <gssrpc/rpc.h>",
            "#include    <arpa/inet.h>  /* inet_ntoa */",
            "#include    <netinet/in.h>",
            "#include    <unistd.h>",
            "#include    <sys/socket.h>",
            "#include    <sys/time.h>",
            "#include    <sys/select.h>",
            "#include    <sys/types.h>",
            "#include    <syslog.h>",
            "#include    <signal.h>",
            "#include    <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "volatile int\tsignal_request_exit = 0;",
            "void\trequest_exit(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include    \"purify.h\"\n#include    \"misc.h\"\n#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */\n#include    <string.h>\n#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */\n#include    <krb5/adm_proto.h>\n#include    <kadm5/server_acl.h>\n#include    <kadm5/kadm_rpc.h>\n#include    <kadm5/admin.h>\n#include    <gssrpc/auth_gssapi.h>\n#include    \"gssapiP_krb5.h\" /* for kg_get_context */\n#include    <gssapi/gssapi.h>\n#include    <gssrpc/rpc.h>\n#include    <arpa/inet.h>  /* inet_ntoa */\n#include    <netinet/in.h>\n#include    <unistd.h>\n#include    <sys/socket.h>\n#include    <sys/time.h>\n#include    <sys/select.h>\n#include    <sys/types.h>\n#include    <syslog.h>\n#include    <signal.h>\n#include    <stdio.h>\n\nvolatile int\tsignal_request_exit = 0;\nvoid\trequest_exit(int);\n\nvoid request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 1859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*struct_table)"
          ],
          "line": 1858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendResult",
          "args": [
            "interp",
            "\"invalid principal handle \\\"\"",
            "ent_name",
            "\"\\\"\"",
            "0"
          ],
          "line": 1853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "ent_name",
            "\"principal\"",
            "sizeof(\"principal\")-1"
          ],
          "line": 1852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_free_principal_ent",
          "args": [
            "server_handle",
            "0"
          ],
          "line": 1845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing entry name\""
          ],
          "line": 1840
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_str",
          "args": [
            "interp",
            "argv[0]",
            "&ent_name"
          ],
          "line": 1839
        },
        "resolved": true,
        "details": {
          "function_name": "parse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "229-241",
          "snippet": "static int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GET_HANDLE",
          "args": [
            "1",
            "0"
          ],
          "line": 1837
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_HashTable *struct_table = 0;\n\nstatic int tcl_ovsec_kadm_free_principal_ent(ClientData clientData,\n\t\t\t\t\t     Tcl_Interp *interp,\n\t\t\t\t\t     int argc, char *argv[])\n{\n     char *ent_name;\n     ovsec_kadm_principal_ent_t ent;\n     ovsec_kadm_ret_t ret;\n\n     GET_HANDLE(1, 0);\n\n     if (parse_str(interp, argv[0], &ent_name) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing entry name\");\n\t  return TCL_ERROR;\n     }\n\n     if ((! ent_name) &&\n\t (ret = ovsec_kadm_free_principal_ent(server_handle, 0))) {\n\t stash_error(interp, ret);\n\t return TCL_ERROR;\n     }\n     else {\n\t  Tcl_HashEntry *entry;\n\n\t  if (strncmp(ent_name, \"principal\", sizeof(\"principal\")-1)) {\n\t       Tcl_AppendResult(interp, \"invalid principal handle \\\"\",\n\t\t\t\tent_name, \"\\\"\", 0);\n\t       return TCL_ERROR;\n\t  }\n\t  if (! struct_table) {\n\t       if (! (struct_table = malloc(sizeof(*struct_table)))) {\n\t\t    fprintf(stderr, \"Out of memory!\\n\");\n\t\t    exit(1); /* XXX */\n\t       }\n\t       Tcl_InitHashTable(struct_table, TCL_STRING_KEYS);\n\t  }\n\t  \n\t  if (! (entry = Tcl_FindHashEntry(struct_table, ent_name))) {\n\t       Tcl_AppendResult(interp, \"principal handle \\\"\", ent_name,\n\t\t\t\t\"\\\" not found\", 0);\n\t       return TCL_ERROR;\n\t  }\n\n\t  ent = (ovsec_kadm_principal_ent_t) Tcl_GetHashValue(entry);\n\n\t  if ((ret = ovsec_kadm_free_principal_ent(server_handle, ent))) {\n\t      stash_error(interp, ret);\n\t      return TCL_ERROR;\n\t  }\n\t  Tcl_DeleteHashEntry(entry);\n     }\n     set_ok(interp, \"Principal freed.\");\n     return TCL_OK;\n}"
  },
  {
    "function_name": "tcl_ovsec_kadm_get_policy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "1734-1825",
    "snippet": "static int tcl_ovsec_kadm_get_policy(ClientData clientData,\n\t\t\t\t     Tcl_Interp *interp,\n\t\t\t\t     int argc, char *argv[])\n{\n     ovsec_kadm_policy_ent_t ent;\n     Tcl_DString *ent_dstring = 0;\n     char *policy;\n     char *ent_var;\n     ovsec_kadm_ret_t ret;\n     int retcode = TCL_OK;\n\n     GET_HANDLE(2, 1);\n\n     if (parse_str(interp, argv[0], &policy) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy name\");\n\t  return TCL_ERROR;\n     }\n     \n     if (parse_str(interp, argv[1], &ent_var) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing entry variable name\");\n\t  return TCL_ERROR;\n     }\n     \n     ret = ovsec_kadm_get_policy(server_handle, policy, ent_var ? &ent : 0);\n\n     if (ret == OVSEC_KADM_OK) {\n\t  if (ent_var) {\n\t       if (dostruct) {\n\t\t    char buf[20];\n\t\t    int i = 1, newPtr = 0;\n\t\t    Tcl_HashEntry *entry;\n\t\t    \n\t\t    if (! struct_table) {\n\t\t\t if (! (struct_table =\n\t\t\t\tmalloc(sizeof(*struct_table)))) {\n\t\t\t      fprintf(stderr, \"Out of memory!\\n\");\n\t\t\t      exit(1); /* XXX */\n\t\t\t }\n\t\t\t Tcl_InitHashTable(struct_table, TCL_STRING_KEYS);\n\t\t    }\n\n\t\t    do {\n\t\t\t sprintf(buf, \"policy%d\", i);\n\t\t\t entry = Tcl_CreateHashEntry(struct_table, buf,\n\t\t\t\t\t\t     &newPtr);\n\t\t\t i++;\n\t\t    } while (! newPtr);\n\n\t\t    Tcl_SetHashValue(entry, ent);\n\t\t    if (! Tcl_SetVar(interp, ent_var, buf,\n\t\t\t\t     TCL_LEAVE_ERR_MSG)) {\n\t\t\t Tcl_AppendElement(interp,\n\t\t\t\t\t   \"while setting entry variable\");\n\t\t\t Tcl_DeleteHashEntry(entry);\n\t\t\t retcode = TCL_ERROR;\n\t\t\t goto finished;\n\t\t    }\n\t\t    set_ok(interp, \"Policy structure retrieved.\");\n\t       }\n\t       else {\n\t\t    ent_dstring = unparse_policy_ent(ent);\n\t\t    if (! Tcl_SetVar(interp, ent_var, ent_dstring->string,\n\t\t\t\t     TCL_LEAVE_ERR_MSG)) {\n\t\t\t Tcl_AppendElement(interp,\n\t\t\t\t\t   \"while setting entry variable\");\n\t\t\t retcode = TCL_ERROR;\n\t\t\t goto finished;\n\t\t    }\n\t\t    set_ok(interp, \"Policy retrieved.\");\n\t       }\n\t  }\n     }\n     else {\n\t  ent = 0;\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n\nfinished:\n     if (ent_dstring) {\n\t  Tcl_DStringFree(ent_dstring);\n\t  free(ent_dstring);\n     }\n     if (ent && ((! dostruct) || (retcode != TCL_OK))) {\n\t if ((ret = ovsec_kadm_free_policy_ent(server_handle, ent)) &&\n\t     (retcode == TCL_OK)) {\n\t     stash_error(interp, ret);\n\t     retcode = TCL_ERROR;\n\t }\n     }\n     return retcode;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static Tcl_HashTable *struct_table = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "stash_error",
          "args": [
            "interp",
            "ret"
          ],
          "line": 1820
        },
        "resolved": true,
        "details": {
          "function_name": "stash_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "407-413",
          "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_free_policy_ent",
          "args": [
            "server_handle",
            "ent"
          ],
          "line": 1818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "ent_dstring"
          ],
          "line": 1815
        },
        "resolved": true,
        "details": {
          "function_name": "free_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "939-943",
          "snippet": "static void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_DStringFree",
          "args": [
            "ent_dstring"
          ],
          "line": 1814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_ok",
          "args": [
            "interp",
            "\"Policy retrieved.\""
          ],
          "line": 1802
        },
        "resolved": true,
        "details": {
          "function_name": "set_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "244-249",
          "snippet": "static void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while setting entry variable\""
          ],
          "line": 1797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetVar",
          "args": [
            "interp",
            "ent_var",
            "ent_dstring->string",
            "TCL_LEAVE_ERR_MSG"
          ],
          "line": 1795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unparse_policy_ent",
          "args": [
            "ent"
          ],
          "line": 1794
        },
        "resolved": true,
        "details": {
          "function_name": "unparse_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "798-834",
          "snippet": "static Tcl_DString *unparse_policy_ent(ovsec_kadm_policy_ent_t policy)\n{\n     Tcl_DString *str, *tmp_dstring;\n     char buf[20];\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     tmp_dstring = unparse_str(policy->policy);\n     Tcl_DStringAppendElement(str, tmp_dstring->string);\n     Tcl_DStringFree(tmp_dstring);\n     free(tmp_dstring);\n     \n     sprintf(buf, \"%ld\", policy->pw_min_life);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->pw_max_life);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->pw_min_length);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->pw_min_classes);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->pw_history_num);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->policy_refcnt);\n     Tcl_DStringAppendElement(str, buf);\n\n     return str;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_DString *unparse_policy_ent(ovsec_kadm_policy_ent_t policy)\n{\n     Tcl_DString *str, *tmp_dstring;\n     char buf[20];\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     tmp_dstring = unparse_str(policy->policy);\n     Tcl_DStringAppendElement(str, tmp_dstring->string);\n     Tcl_DStringFree(tmp_dstring);\n     free(tmp_dstring);\n     \n     sprintf(buf, \"%ld\", policy->pw_min_life);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->pw_max_life);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->pw_min_length);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->pw_min_classes);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->pw_history_num);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->policy_refcnt);\n     Tcl_DStringAppendElement(str, buf);\n\n     return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_DeleteHashEntry",
          "args": [
            "entry"
          ],
          "line": 1787
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while setting entry variable\""
          ],
          "line": 1785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetVar",
          "args": [
            "interp",
            "ent_var",
            "buf",
            "TCL_LEAVE_ERR_MSG"
          ],
          "line": 1783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetHashValue",
          "args": [
            "entry",
            "ent"
          ],
          "line": 1782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateHashEntry",
          "args": [
            "struct_table",
            "buf",
            "&newPtr"
          ],
          "line": 1777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"policy%d\"",
            "i"
          ],
          "line": 1776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_InitHashTable",
          "args": [
            "struct_table",
            "TCL_STRING_KEYS"
          ],
          "line": 1772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 1770
        },
        "resolved": true,
        "details": {
          "function_name": "request_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/server/ovsec_kadmd.c",
          "lines": "841-846",
          "snippet": "void request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}",
          "includes": [
            "#include    \"purify.h\"",
            "#include    \"misc.h\"",
            "#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */",
            "#include    <string.h>",
            "#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */",
            "#include    <krb5/adm_proto.h>",
            "#include    <kadm5/server_acl.h>",
            "#include    <kadm5/kadm_rpc.h>",
            "#include    <kadm5/admin.h>",
            "#include    <gssrpc/auth_gssapi.h>",
            "#include    \"gssapiP_krb5.h\" /* for kg_get_context */",
            "#include    <gssapi/gssapi.h>",
            "#include    <gssrpc/rpc.h>",
            "#include    <arpa/inet.h>  /* inet_ntoa */",
            "#include    <netinet/in.h>",
            "#include    <unistd.h>",
            "#include    <sys/socket.h>",
            "#include    <sys/time.h>",
            "#include    <sys/select.h>",
            "#include    <sys/types.h>",
            "#include    <syslog.h>",
            "#include    <signal.h>",
            "#include    <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "volatile int\tsignal_request_exit = 0;",
            "void\trequest_exit(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include    \"purify.h\"\n#include    \"misc.h\"\n#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */\n#include    <string.h>\n#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */\n#include    <krb5/adm_proto.h>\n#include    <kadm5/server_acl.h>\n#include    <kadm5/kadm_rpc.h>\n#include    <kadm5/admin.h>\n#include    <gssrpc/auth_gssapi.h>\n#include    \"gssapiP_krb5.h\" /* for kg_get_context */\n#include    <gssapi/gssapi.h>\n#include    <gssrpc/rpc.h>\n#include    <arpa/inet.h>  /* inet_ntoa */\n#include    <netinet/in.h>\n#include    <unistd.h>\n#include    <sys/socket.h>\n#include    <sys/time.h>\n#include    <sys/select.h>\n#include    <sys/types.h>\n#include    <syslog.h>\n#include    <signal.h>\n#include    <stdio.h>\n\nvolatile int\tsignal_request_exit = 0;\nvoid\trequest_exit(int);\n\nvoid request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 1769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*struct_table)"
          ],
          "line": 1768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_get_policy",
          "args": [
            "server_handle",
            "policy",
            "ent_var ? &ent : 0"
          ],
          "line": 1757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing entry variable name\""
          ],
          "line": 1753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_str",
          "args": [
            "interp",
            "argv[1]",
            "&ent_var"
          ],
          "line": 1752
        },
        "resolved": true,
        "details": {
          "function_name": "parse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "229-241",
          "snippet": "static int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing policy name\""
          ],
          "line": 1748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GET_HANDLE",
          "args": [
            "2",
            "1"
          ],
          "line": 1745
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_HashTable *struct_table = 0;\n\nstatic int tcl_ovsec_kadm_get_policy(ClientData clientData,\n\t\t\t\t     Tcl_Interp *interp,\n\t\t\t\t     int argc, char *argv[])\n{\n     ovsec_kadm_policy_ent_t ent;\n     Tcl_DString *ent_dstring = 0;\n     char *policy;\n     char *ent_var;\n     ovsec_kadm_ret_t ret;\n     int retcode = TCL_OK;\n\n     GET_HANDLE(2, 1);\n\n     if (parse_str(interp, argv[0], &policy) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy name\");\n\t  return TCL_ERROR;\n     }\n     \n     if (parse_str(interp, argv[1], &ent_var) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing entry variable name\");\n\t  return TCL_ERROR;\n     }\n     \n     ret = ovsec_kadm_get_policy(server_handle, policy, ent_var ? &ent : 0);\n\n     if (ret == OVSEC_KADM_OK) {\n\t  if (ent_var) {\n\t       if (dostruct) {\n\t\t    char buf[20];\n\t\t    int i = 1, newPtr = 0;\n\t\t    Tcl_HashEntry *entry;\n\t\t    \n\t\t    if (! struct_table) {\n\t\t\t if (! (struct_table =\n\t\t\t\tmalloc(sizeof(*struct_table)))) {\n\t\t\t      fprintf(stderr, \"Out of memory!\\n\");\n\t\t\t      exit(1); /* XXX */\n\t\t\t }\n\t\t\t Tcl_InitHashTable(struct_table, TCL_STRING_KEYS);\n\t\t    }\n\n\t\t    do {\n\t\t\t sprintf(buf, \"policy%d\", i);\n\t\t\t entry = Tcl_CreateHashEntry(struct_table, buf,\n\t\t\t\t\t\t     &newPtr);\n\t\t\t i++;\n\t\t    } while (! newPtr);\n\n\t\t    Tcl_SetHashValue(entry, ent);\n\t\t    if (! Tcl_SetVar(interp, ent_var, buf,\n\t\t\t\t     TCL_LEAVE_ERR_MSG)) {\n\t\t\t Tcl_AppendElement(interp,\n\t\t\t\t\t   \"while setting entry variable\");\n\t\t\t Tcl_DeleteHashEntry(entry);\n\t\t\t retcode = TCL_ERROR;\n\t\t\t goto finished;\n\t\t    }\n\t\t    set_ok(interp, \"Policy structure retrieved.\");\n\t       }\n\t       else {\n\t\t    ent_dstring = unparse_policy_ent(ent);\n\t\t    if (! Tcl_SetVar(interp, ent_var, ent_dstring->string,\n\t\t\t\t     TCL_LEAVE_ERR_MSG)) {\n\t\t\t Tcl_AppendElement(interp,\n\t\t\t\t\t   \"while setting entry variable\");\n\t\t\t retcode = TCL_ERROR;\n\t\t\t goto finished;\n\t\t    }\n\t\t    set_ok(interp, \"Policy retrieved.\");\n\t       }\n\t  }\n     }\n     else {\n\t  ent = 0;\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n\nfinished:\n     if (ent_dstring) {\n\t  Tcl_DStringFree(ent_dstring);\n\t  free(ent_dstring);\n     }\n     if (ent && ((! dostruct) || (retcode != TCL_OK))) {\n\t if ((ret = ovsec_kadm_free_policy_ent(server_handle, ent)) &&\n\t     (retcode == TCL_OK)) {\n\t     stash_error(interp, ret);\n\t     retcode = TCL_ERROR;\n\t }\n     }\n     return retcode;\n}"
  },
  {
    "function_name": "tcl_ovsec_kadm_modify_policy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "1687-1731",
    "snippet": "static int tcl_ovsec_kadm_modify_policy(ClientData clientData,\n\t\t\t\t\tTcl_Interp *interp,\n\t\t\t\t\tint argc, char *argv[])\n{\n     char *policy_string;\n     ovsec_kadm_policy_ent_t policy = 0;\n     int tcl_ret;\n     krb5_int32 mask;\n     int retcode = TCL_OK;\n     ovsec_kadm_ret_t ret;\n\n     GET_HANDLE(2, 0);\n\n     if ((tcl_ret = parse_str(interp, argv[0], &policy_string)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy\");\n\t  return tcl_ret;\n     }\n\n     if (policy_string &&\n\t ((tcl_ret = parse_policy_ent(interp, policy_string, &policy))\n\t  != TCL_OK)) {\n\t  return tcl_ret;\n     }\n\n     if ((tcl_ret = parse_policy_mask(interp, argv[1], &mask)) != TCL_OK) {\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     ret = ovsec_kadm_modify_policy(server_handle, policy, mask);\n\n     if (ret != OVSEC_KADM_OK) {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n     else {\n\t  set_ok(interp, \"Policy modified.\");\n     }\n\nfinished:\n     if (policy) {\n\t  free_policy_ent(&policy);\n     }\n     return retcode;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_policy_ent",
          "args": [
            "&policy"
          ],
          "line": 1728
        },
        "resolved": true,
        "details": {
          "function_name": "free_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "939-943",
          "snippet": "static void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_ok",
          "args": [
            "interp",
            "\"Policy modified.\""
          ],
          "line": 1723
        },
        "resolved": true,
        "details": {
          "function_name": "set_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "244-249",
          "snippet": "static void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "stash_error",
          "args": [
            "interp",
            "ret"
          ],
          "line": 1719
        },
        "resolved": true,
        "details": {
          "function_name": "stash_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "407-413",
          "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_modify_policy",
          "args": [
            "server_handle",
            "policy",
            "mask"
          ],
          "line": 1716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_policy_mask",
          "args": [
            "interp",
            "argv[1]",
            "&mask"
          ],
          "line": 1711
        },
        "resolved": true,
        "details": {
          "function_name": "parse_policy_mask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "549-564",
          "snippet": "static int parse_policy_mask(Tcl_Interp *interp, char *str, krb5_int32 *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, policy_mask_flags,\n\t\t\t\tsizeof(policy_mask_flags) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct flagval policy_mask_flags[] = {\n     {\"OVSEC_KADM_POLICY\", OVSEC_KADM_POLICY},\n     {\"OVSEC_KADM_PW_MAX_LIFE\", OVSEC_KADM_PW_MAX_LIFE},\n     {\"OVSEC_KADM_PW_MIN_LIFE\", OVSEC_KADM_PW_MIN_LIFE},\n     {\"OVSEC_KADM_PW_MIN_LENGTH\", OVSEC_KADM_PW_MIN_LENGTH},\n     {\"OVSEC_KADM_PW_MIN_CLASSES\", OVSEC_KADM_PW_MIN_CLASSES},\n     {\"OVSEC_KADM_PW_HISTORY_NUM\", OVSEC_KADM_PW_HISTORY_NUM},\n     {\"OVSEC_KADM_REF_COUNT\", OVSEC_KADM_REF_COUNT}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstruct flagval policy_mask_flags[] = {\n     {\"OVSEC_KADM_POLICY\", OVSEC_KADM_POLICY},\n     {\"OVSEC_KADM_PW_MAX_LIFE\", OVSEC_KADM_PW_MAX_LIFE},\n     {\"OVSEC_KADM_PW_MIN_LIFE\", OVSEC_KADM_PW_MIN_LIFE},\n     {\"OVSEC_KADM_PW_MIN_LENGTH\", OVSEC_KADM_PW_MIN_LENGTH},\n     {\"OVSEC_KADM_PW_MIN_CLASSES\", OVSEC_KADM_PW_MIN_CLASSES},\n     {\"OVSEC_KADM_PW_HISTORY_NUM\", OVSEC_KADM_PW_HISTORY_NUM},\n     {\"OVSEC_KADM_REF_COUNT\", OVSEC_KADM_REF_COUNT}\n};\n\nstatic int parse_policy_mask(Tcl_Interp *interp, char *str, krb5_int32 *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, policy_mask_flags,\n\t\t\t\tsizeof(policy_mask_flags) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "parse_policy_ent",
          "args": [
            "interp",
            "policy_string",
            "&policy"
          ],
          "line": 1706
        },
        "resolved": true,
        "details": {
          "function_name": "parse_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "838-936",
          "snippet": "static int parse_policy_ent(Tcl_Interp *interp, char *list,\n\t\t\t    ovsec_kadm_policy_ent_t *out_policy)\n{\n     ovsec_kadm_policy_ent_t policy;\n     int tcl_ret;\n     int argc;\n     char **argv;\n     int tmp;\n     int retcode = TCL_OK;\n\n     if ((tcl_ret = Tcl_SplitList(interp, list, &argc, &argv)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     if (argc != 7) {\n\t  sprintf(interp->result, \"wrong # args in policy structure (%d should be 7)\",\n\t\t  argc);\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if (! (policy = malloc(sizeof *policy))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n  \n     if ((tcl_ret = parse_str(interp, argv[0], &policy->policy)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if(policy->policy != NULL) {\n\tif (! (policy->policy = strdup(policy->policy))) {\n\t    fprintf(stderr, \"Out of memory!\\n\");\n\t    exit(1); /* XXX */\n\t}\n     }\n     \n     /*\n      * All of the numerical values parsed here are parsed into an\n      * \"int\" and then assigned into the structure in case the actual\n      * width of the field in the Kerberos structure is different from\n      * the width of an integer.\n      */\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[1], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_min_life\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_min_life = tmp;\n     \n     if ((tcl_ret = Tcl_GetInt(interp, argv[2], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_max_life\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_max_life = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[3], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_min_length\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_min_length = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[4], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_min_classes\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_min_classes = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[5], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_history_num\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_history_num = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[6], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy_refcnt\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->policy_refcnt = tmp;\n\nfinished:\n     free(argv);\n     *out_policy = policy;\n     return retcode;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_policy_ent(Tcl_Interp *interp, char *list,\n\t\t\t    ovsec_kadm_policy_ent_t *out_policy)\n{\n     ovsec_kadm_policy_ent_t policy;\n     int tcl_ret;\n     int argc;\n     char **argv;\n     int tmp;\n     int retcode = TCL_OK;\n\n     if ((tcl_ret = Tcl_SplitList(interp, list, &argc, &argv)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     if (argc != 7) {\n\t  sprintf(interp->result, \"wrong # args in policy structure (%d should be 7)\",\n\t\t  argc);\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if (! (policy = malloc(sizeof *policy))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n  \n     if ((tcl_ret = parse_str(interp, argv[0], &policy->policy)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if(policy->policy != NULL) {\n\tif (! (policy->policy = strdup(policy->policy))) {\n\t    fprintf(stderr, \"Out of memory!\\n\");\n\t    exit(1); /* XXX */\n\t}\n     }\n     \n     /*\n      * All of the numerical values parsed here are parsed into an\n      * \"int\" and then assigned into the structure in case the actual\n      * width of the field in the Kerberos structure is different from\n      * the width of an integer.\n      */\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[1], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_min_life\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_min_life = tmp;\n     \n     if ((tcl_ret = Tcl_GetInt(interp, argv[2], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_max_life\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_max_life = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[3], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_min_length\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_min_length = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[4], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_min_classes\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_min_classes = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[5], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_history_num\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_history_num = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[6], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy_refcnt\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->policy_refcnt = tmp;\n\nfinished:\n     free(argv);\n     *out_policy = policy;\n     return retcode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing policy\""
          ],
          "line": 1701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_str",
          "args": [
            "interp",
            "argv[0]",
            "&policy_string"
          ],
          "line": 1700
        },
        "resolved": true,
        "details": {
          "function_name": "parse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "229-241",
          "snippet": "static int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GET_HANDLE",
          "args": [
            "2",
            "0"
          ],
          "line": 1698
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int tcl_ovsec_kadm_modify_policy(ClientData clientData,\n\t\t\t\t\tTcl_Interp *interp,\n\t\t\t\t\tint argc, char *argv[])\n{\n     char *policy_string;\n     ovsec_kadm_policy_ent_t policy = 0;\n     int tcl_ret;\n     krb5_int32 mask;\n     int retcode = TCL_OK;\n     ovsec_kadm_ret_t ret;\n\n     GET_HANDLE(2, 0);\n\n     if ((tcl_ret = parse_str(interp, argv[0], &policy_string)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy\");\n\t  return tcl_ret;\n     }\n\n     if (policy_string &&\n\t ((tcl_ret = parse_policy_ent(interp, policy_string, &policy))\n\t  != TCL_OK)) {\n\t  return tcl_ret;\n     }\n\n     if ((tcl_ret = parse_policy_mask(interp, argv[1], &mask)) != TCL_OK) {\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     ret = ovsec_kadm_modify_policy(server_handle, policy, mask);\n\n     if (ret != OVSEC_KADM_OK) {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n     else {\n\t  set_ok(interp, \"Policy modified.\");\n     }\n\nfinished:\n     if (policy) {\n\t  free_policy_ent(&policy);\n     }\n     return retcode;\n}"
  },
  {
    "function_name": "tcl_ovsec_kadm_delete_policy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "1659-1683",
    "snippet": "static int tcl_ovsec_kadm_delete_policy(ClientData clientData,\n\t\t\t\t\tTcl_Interp *interp,\n\t\t\t\t\tint argc, char *argv[])\n{\n     ovsec_kadm_ret_t ret;\n     char *policy;\n\n     GET_HANDLE(1, 0);\n\n     if (parse_str(interp, argv[0], &policy) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy name\");\n\t  return TCL_ERROR;\n     }\n     \n     ret = ovsec_kadm_delete_policy(server_handle, policy);\n\n     if (ret != OVSEC_KADM_OK) {\n\t  stash_error(interp, ret);\n\t  return TCL_ERROR;\n     }\n     else {\n\t  set_ok(interp, \"Policy deleted.\");\n\t  return TCL_OK;\n     }\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_ok",
          "args": [
            "interp",
            "\"Policy deleted.\""
          ],
          "line": 1680
        },
        "resolved": true,
        "details": {
          "function_name": "set_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "244-249",
          "snippet": "static void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "stash_error",
          "args": [
            "interp",
            "ret"
          ],
          "line": 1676
        },
        "resolved": true,
        "details": {
          "function_name": "stash_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "407-413",
          "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_delete_policy",
          "args": [
            "server_handle",
            "policy"
          ],
          "line": 1673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing policy name\""
          ],
          "line": 1669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_str",
          "args": [
            "interp",
            "argv[0]",
            "&policy"
          ],
          "line": 1668
        },
        "resolved": true,
        "details": {
          "function_name": "parse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "229-241",
          "snippet": "static int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GET_HANDLE",
          "args": [
            "1",
            "0"
          ],
          "line": 1666
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int tcl_ovsec_kadm_delete_policy(ClientData clientData,\n\t\t\t\t\tTcl_Interp *interp,\n\t\t\t\t\tint argc, char *argv[])\n{\n     ovsec_kadm_ret_t ret;\n     char *policy;\n\n     GET_HANDLE(1, 0);\n\n     if (parse_str(interp, argv[0], &policy) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy name\");\n\t  return TCL_ERROR;\n     }\n     \n     ret = ovsec_kadm_delete_policy(server_handle, policy);\n\n     if (ret != OVSEC_KADM_OK) {\n\t  stash_error(interp, ret);\n\t  return TCL_ERROR;\n     }\n     else {\n\t  set_ok(interp, \"Policy deleted.\");\n\t  return TCL_OK;\n     }\n}"
  },
  {
    "function_name": "tcl_ovsec_kadm_create_policy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "1610-1655",
    "snippet": "static int tcl_ovsec_kadm_create_policy(ClientData clientData,\n\t\t\t\t\tTcl_Interp *interp,\n\t\t\t\t\tint argc, char *argv[])\n{\n     int tcl_ret;\n     ovsec_kadm_ret_t ret;\n     int retcode = TCL_OK;\n     char *policy_string;\n     ovsec_kadm_policy_ent_t policy = 0;\n     krb5_int32 mask;\n\n     GET_HANDLE(2, 0);\n\n     if ((tcl_ret = parse_str(interp, argv[0], &policy_string)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy\");\n\t  return tcl_ret;\n     }\n\n     if (policy_string &&\n\t ((tcl_ret = parse_policy_ent(interp, policy_string, &policy))\n\t  != TCL_OK)) {\n\t  return tcl_ret;\n     }\n\n     if ((tcl_ret = parse_policy_mask(interp, argv[1], &mask)) != TCL_OK) {\n\t  retcode = tcl_ret;\n\t  goto finished;\n     }\n\n     ret = ovsec_kadm_create_policy(server_handle, policy, mask);\n\n     if (ret != OVSEC_KADM_OK) {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     else {\n\t  set_ok(interp, \"Policy created.\");\n     }\n\nfinished:\n     if (policy) {\n\t  free_policy_ent(&policy);\n     }\n     return retcode;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_policy_ent",
          "args": [
            "&policy"
          ],
          "line": 1652
        },
        "resolved": true,
        "details": {
          "function_name": "free_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "939-943",
          "snippet": "static void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_ok",
          "args": [
            "interp",
            "\"Policy created.\""
          ],
          "line": 1647
        },
        "resolved": true,
        "details": {
          "function_name": "set_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "244-249",
          "snippet": "static void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "stash_error",
          "args": [
            "interp",
            "ret"
          ],
          "line": 1642
        },
        "resolved": true,
        "details": {
          "function_name": "stash_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "407-413",
          "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_create_policy",
          "args": [
            "server_handle",
            "policy",
            "mask"
          ],
          "line": 1639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_policy_mask",
          "args": [
            "interp",
            "argv[1]",
            "&mask"
          ],
          "line": 1634
        },
        "resolved": true,
        "details": {
          "function_name": "parse_policy_mask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "549-564",
          "snippet": "static int parse_policy_mask(Tcl_Interp *interp, char *str, krb5_int32 *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, policy_mask_flags,\n\t\t\t\tsizeof(policy_mask_flags) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct flagval policy_mask_flags[] = {\n     {\"OVSEC_KADM_POLICY\", OVSEC_KADM_POLICY},\n     {\"OVSEC_KADM_PW_MAX_LIFE\", OVSEC_KADM_PW_MAX_LIFE},\n     {\"OVSEC_KADM_PW_MIN_LIFE\", OVSEC_KADM_PW_MIN_LIFE},\n     {\"OVSEC_KADM_PW_MIN_LENGTH\", OVSEC_KADM_PW_MIN_LENGTH},\n     {\"OVSEC_KADM_PW_MIN_CLASSES\", OVSEC_KADM_PW_MIN_CLASSES},\n     {\"OVSEC_KADM_PW_HISTORY_NUM\", OVSEC_KADM_PW_HISTORY_NUM},\n     {\"OVSEC_KADM_REF_COUNT\", OVSEC_KADM_REF_COUNT}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstruct flagval policy_mask_flags[] = {\n     {\"OVSEC_KADM_POLICY\", OVSEC_KADM_POLICY},\n     {\"OVSEC_KADM_PW_MAX_LIFE\", OVSEC_KADM_PW_MAX_LIFE},\n     {\"OVSEC_KADM_PW_MIN_LIFE\", OVSEC_KADM_PW_MIN_LIFE},\n     {\"OVSEC_KADM_PW_MIN_LENGTH\", OVSEC_KADM_PW_MIN_LENGTH},\n     {\"OVSEC_KADM_PW_MIN_CLASSES\", OVSEC_KADM_PW_MIN_CLASSES},\n     {\"OVSEC_KADM_PW_HISTORY_NUM\", OVSEC_KADM_PW_HISTORY_NUM},\n     {\"OVSEC_KADM_REF_COUNT\", OVSEC_KADM_REF_COUNT}\n};\n\nstatic int parse_policy_mask(Tcl_Interp *interp, char *str, krb5_int32 *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, policy_mask_flags,\n\t\t\t\tsizeof(policy_mask_flags) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "parse_policy_ent",
          "args": [
            "interp",
            "policy_string",
            "&policy"
          ],
          "line": 1629
        },
        "resolved": true,
        "details": {
          "function_name": "parse_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "838-936",
          "snippet": "static int parse_policy_ent(Tcl_Interp *interp, char *list,\n\t\t\t    ovsec_kadm_policy_ent_t *out_policy)\n{\n     ovsec_kadm_policy_ent_t policy;\n     int tcl_ret;\n     int argc;\n     char **argv;\n     int tmp;\n     int retcode = TCL_OK;\n\n     if ((tcl_ret = Tcl_SplitList(interp, list, &argc, &argv)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     if (argc != 7) {\n\t  sprintf(interp->result, \"wrong # args in policy structure (%d should be 7)\",\n\t\t  argc);\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if (! (policy = malloc(sizeof *policy))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n  \n     if ((tcl_ret = parse_str(interp, argv[0], &policy->policy)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if(policy->policy != NULL) {\n\tif (! (policy->policy = strdup(policy->policy))) {\n\t    fprintf(stderr, \"Out of memory!\\n\");\n\t    exit(1); /* XXX */\n\t}\n     }\n     \n     /*\n      * All of the numerical values parsed here are parsed into an\n      * \"int\" and then assigned into the structure in case the actual\n      * width of the field in the Kerberos structure is different from\n      * the width of an integer.\n      */\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[1], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_min_life\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_min_life = tmp;\n     \n     if ((tcl_ret = Tcl_GetInt(interp, argv[2], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_max_life\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_max_life = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[3], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_min_length\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_min_length = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[4], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_min_classes\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_min_classes = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[5], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_history_num\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_history_num = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[6], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy_refcnt\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->policy_refcnt = tmp;\n\nfinished:\n     free(argv);\n     *out_policy = policy;\n     return retcode;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_policy_ent(Tcl_Interp *interp, char *list,\n\t\t\t    ovsec_kadm_policy_ent_t *out_policy)\n{\n     ovsec_kadm_policy_ent_t policy;\n     int tcl_ret;\n     int argc;\n     char **argv;\n     int tmp;\n     int retcode = TCL_OK;\n\n     if ((tcl_ret = Tcl_SplitList(interp, list, &argc, &argv)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     if (argc != 7) {\n\t  sprintf(interp->result, \"wrong # args in policy structure (%d should be 7)\",\n\t\t  argc);\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if (! (policy = malloc(sizeof *policy))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n  \n     if ((tcl_ret = parse_str(interp, argv[0], &policy->policy)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if(policy->policy != NULL) {\n\tif (! (policy->policy = strdup(policy->policy))) {\n\t    fprintf(stderr, \"Out of memory!\\n\");\n\t    exit(1); /* XXX */\n\t}\n     }\n     \n     /*\n      * All of the numerical values parsed here are parsed into an\n      * \"int\" and then assigned into the structure in case the actual\n      * width of the field in the Kerberos structure is different from\n      * the width of an integer.\n      */\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[1], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_min_life\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_min_life = tmp;\n     \n     if ((tcl_ret = Tcl_GetInt(interp, argv[2], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_max_life\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_max_life = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[3], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_min_length\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_min_length = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[4], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_min_classes\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_min_classes = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[5], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_history_num\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_history_num = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[6], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy_refcnt\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->policy_refcnt = tmp;\n\nfinished:\n     free(argv);\n     *out_policy = policy;\n     return retcode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing policy\""
          ],
          "line": 1624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_str",
          "args": [
            "interp",
            "argv[0]",
            "&policy_string"
          ],
          "line": 1623
        },
        "resolved": true,
        "details": {
          "function_name": "parse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "229-241",
          "snippet": "static int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GET_HANDLE",
          "args": [
            "2",
            "0"
          ],
          "line": 1621
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int tcl_ovsec_kadm_create_policy(ClientData clientData,\n\t\t\t\t\tTcl_Interp *interp,\n\t\t\t\t\tint argc, char *argv[])\n{\n     int tcl_ret;\n     ovsec_kadm_ret_t ret;\n     int retcode = TCL_OK;\n     char *policy_string;\n     ovsec_kadm_policy_ent_t policy = 0;\n     krb5_int32 mask;\n\n     GET_HANDLE(2, 0);\n\n     if ((tcl_ret = parse_str(interp, argv[0], &policy_string)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy\");\n\t  return tcl_ret;\n     }\n\n     if (policy_string &&\n\t ((tcl_ret = parse_policy_ent(interp, policy_string, &policy))\n\t  != TCL_OK)) {\n\t  return tcl_ret;\n     }\n\n     if ((tcl_ret = parse_policy_mask(interp, argv[1], &mask)) != TCL_OK) {\n\t  retcode = tcl_ret;\n\t  goto finished;\n     }\n\n     ret = ovsec_kadm_create_policy(server_handle, policy, mask);\n\n     if (ret != OVSEC_KADM_OK) {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     else {\n\t  set_ok(interp, \"Policy created.\");\n     }\n\nfinished:\n     if (policy) {\n\t  free_policy_ent(&policy);\n     }\n     return retcode;\n}"
  },
  {
    "function_name": "tcl_ovsec_kadm_get_principal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "1506-1608",
    "snippet": "static int tcl_ovsec_kadm_get_principal(ClientData clientData,\n\t\t\t\t\tTcl_Interp *interp,\n\t\t\t\t\tint argc, char *argv[])\n{\n     krb5_principal princ;\n     ovsec_kadm_principal_ent_t ent;\n     Tcl_DString *ent_dstring = 0;\n     char *ent_var;\n     char *name;\n     krb5_error_code krb5_ret;\n     int tcl_ret;\n     ovsec_kadm_ret_t ret;\n     int retcode = TCL_OK;\n     \n     GET_HANDLE(2, 1);\n\n     if((tcl_ret = parse_str(interp, argv[0], &name)) != TCL_OK)\n\treturn tcl_ret;\n     if(name != NULL) {\n\tif ((krb5_ret = krb5_parse_name(context, name, &princ))) {\n\t    stash_error(interp, krb5_ret);\n\t    Tcl_AppendElement(interp, \"while parsing principal name\");\n\t    return TCL_ERROR;\n\t}\n     } else princ = NULL;\n\n     if ((tcl_ret = parse_str(interp, argv[1], &ent_var)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing entry variable name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     \n     ret = ovsec_kadm_get_principal(server_handle, princ, ent_var ? &ent : 0);\n\n     if (ret == OVSEC_KADM_OK) {\n\t  if (ent_var) {\n\t       if (dostruct) {\n\t\t    char buf[20];\n\t\t    int i = 1, newPtr = 0;\n\t\t    Tcl_HashEntry *entry;\n\t\t    \n\t\t    if (! struct_table) {\n\t\t\t if (! (struct_table =\n\t\t\t\tmalloc(sizeof(*struct_table)))) {\n\t\t\t      fprintf(stderr, \"Out of memory!\\n\");\n\t\t\t      exit(1); /* XXX */\n\t\t\t }\n\t\t\t Tcl_InitHashTable(struct_table, TCL_STRING_KEYS);\n\t\t    }\n\n\t\t    do {\n\t\t\t sprintf(buf, \"principal%d\", i);\n\t\t\t entry = Tcl_CreateHashEntry(struct_table, buf,\n\t\t\t\t\t\t     &newPtr);\n\t\t\t i++;\n\t\t    } while (! newPtr);\n\n\t\t    Tcl_SetHashValue(entry, ent);\n\t\t    if (! Tcl_SetVar(interp, ent_var, buf,\n\t\t\t\t     TCL_LEAVE_ERR_MSG)) {\n\t\t\t Tcl_AppendElement(interp,\n\t\t\t\t\t   \"while setting entry variable\");\n\t\t\t Tcl_DeleteHashEntry(entry);\n\t\t\t retcode = TCL_ERROR;\n\t\t\t goto finished;\n\t\t    }\n\t\t    set_ok(interp, \"Principal structure retrieved.\");\n\t       }\n\t       else {\n\t\t    ent_dstring = unparse_principal_ent(ent);\n\t\t    if (! Tcl_SetVar(interp, ent_var, ent_dstring->string,\n\t\t\t\t     TCL_LEAVE_ERR_MSG)) {\n\t\t\t Tcl_AppendElement(interp,\n\t\t\t\t\t   \"while setting entry variable\");\n\t\t\t retcode = TCL_ERROR;\n\t\t\t goto finished;\n\t\t    }\n\t\t    set_ok(interp, \"Principal retrieved.\");\n\t       }\n\t  }\n     }\n     else {\n\t  ent = 0;\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n\nfinished:\n     if (ent_dstring) {\n\t  Tcl_DStringFree(ent_dstring);\n\t  free(ent_dstring);\n     }\n     if(princ != NULL)\n\tkrb5_free_principal(context, princ);\n     if (ent && ((! dostruct) || (retcode != TCL_OK))) {\n\t if ((ret = ovsec_kadm_free_principal_ent(server_handle, ent)) &&\n\t     (retcode == TCL_OK)) {\n\t     stash_error(interp, ret);\n\t     retcode = TCL_ERROR;\n\t }\n     }\n     return retcode;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static krb5_context context;",
      "static Tcl_HashTable *struct_table = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "stash_error",
          "args": [
            "interp",
            "ret"
          ],
          "line": 1603
        },
        "resolved": true,
        "details": {
          "function_name": "stash_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "407-413",
          "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_free_principal_ent",
          "args": [
            "server_handle",
            "ent"
          ],
          "line": 1601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krb5_free_principal",
          "args": [
            "context",
            "princ"
          ],
          "line": 1599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "ent_dstring"
          ],
          "line": 1596
        },
        "resolved": true,
        "details": {
          "function_name": "free_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "939-943",
          "snippet": "static void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_DStringFree",
          "args": [
            "ent_dstring"
          ],
          "line": 1595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_ok",
          "args": [
            "interp",
            "\"Principal retrieved.\""
          ],
          "line": 1583
        },
        "resolved": true,
        "details": {
          "function_name": "set_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "244-249",
          "snippet": "static void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while setting entry variable\""
          ],
          "line": 1578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetVar",
          "args": [
            "interp",
            "ent_var",
            "ent_dstring->string",
            "TCL_LEAVE_ERR_MSG"
          ],
          "line": 1576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unparse_principal_ent",
          "args": [
            "ent"
          ],
          "line": 1575
        },
        "resolved": true,
        "details": {
          "function_name": "unparse_principal_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "567-649",
          "snippet": "static Tcl_DString *unparse_principal_ent(ovsec_kadm_principal_ent_t princ)\n{\n     Tcl_DString *str, *tmp_dstring;\n     char *tmp;\n     char buf[20];\n     krb5_error_code krb5_ret;\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     tmp = 0; /* It looks to me from looking at the library source */\n\t      /* code for krb5_parse_name that the pointer passed into */\n\t      /* it should be initialized to 0 if I want it do be */\n\t      /* allocated automatically. */\n     krb5_ret = krb5_unparse_name(context, princ->principal, &tmp);\n     if (krb5_ret) {\n\t  /* XXX Do we want to return an error?  Not sure. */\n\t  Tcl_DStringAppendElement(str, \"[unparseable principal]\");\n     }\n     else {\n\t  Tcl_DStringAppendElement(str, tmp);\n\t  free(tmp);\n     }\n\n     sprintf(buf, \"%d\", princ->princ_expire_time);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%d\", princ->last_pwd_change);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%d\", princ->pw_expiration);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%d\", princ->max_life);\n     Tcl_DStringAppendElement(str, buf);\n\n     tmp = 0;\n     krb5_ret = krb5_unparse_name(context, princ->mod_name, &tmp);\n     if (krb5_ret) {\n\t  /* XXX */\n\t  Tcl_DStringAppendElement(str, \"[unparseable principal]\");\n     }\n     else {\n\t  Tcl_DStringAppendElement(str, tmp);\n\t  free(tmp);\n     }\n\n     sprintf(buf, \"%d\", princ->mod_date);\n     Tcl_DStringAppendElement(str, buf);\n\n     tmp_dstring = unparse_krb5_flags(princ->attributes);\n     Tcl_DStringAppendElement(str, tmp_dstring->string);\n     Tcl_DStringFree(tmp_dstring);\n     free(tmp_dstring);\n\n     sprintf(buf, \"%d\", princ->kvno);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%d\", princ->mkvno);\n     Tcl_DStringAppendElement(str, buf);\n\n     /* XXX This may be dangerous, because the contents of the policy */\n     /* field are undefined if the POLICY bit isn't set.  However, I */\n     /* think it's a bug for the field not to be null in that case */\n     /* anyway, so we should assume that it will be null so that we'll */\n     /* catch it if it isn't. */\n     \n     tmp_dstring = unparse_str(princ->policy);\n     Tcl_DStringAppendElement(str, tmp_dstring->string);\n     Tcl_DStringFree(tmp_dstring);\n     free(tmp_dstring);\n\n     tmp_dstring = unparse_aux_attributes(princ->aux_attributes);\n     Tcl_DStringAppendElement(str, tmp_dstring->string);\n     Tcl_DStringFree(tmp_dstring);\n     free(tmp_dstring);\n\n     return str;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static krb5_context context;",
            "struct flagval aux_attributes[] = {\n     {\"OVSEC_KADM_POLICY\",   OVSEC_KADM_POLICY}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic krb5_context context;\nstruct flagval aux_attributes[] = {\n     {\"OVSEC_KADM_POLICY\",   OVSEC_KADM_POLICY}\n};\n\nstatic Tcl_DString *unparse_principal_ent(ovsec_kadm_principal_ent_t princ)\n{\n     Tcl_DString *str, *tmp_dstring;\n     char *tmp;\n     char buf[20];\n     krb5_error_code krb5_ret;\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     tmp = 0; /* It looks to me from looking at the library source */\n\t      /* code for krb5_parse_name that the pointer passed into */\n\t      /* it should be initialized to 0 if I want it do be */\n\t      /* allocated automatically. */\n     krb5_ret = krb5_unparse_name(context, princ->principal, &tmp);\n     if (krb5_ret) {\n\t  /* XXX Do we want to return an error?  Not sure. */\n\t  Tcl_DStringAppendElement(str, \"[unparseable principal]\");\n     }\n     else {\n\t  Tcl_DStringAppendElement(str, tmp);\n\t  free(tmp);\n     }\n\n     sprintf(buf, \"%d\", princ->princ_expire_time);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%d\", princ->last_pwd_change);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%d\", princ->pw_expiration);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%d\", princ->max_life);\n     Tcl_DStringAppendElement(str, buf);\n\n     tmp = 0;\n     krb5_ret = krb5_unparse_name(context, princ->mod_name, &tmp);\n     if (krb5_ret) {\n\t  /* XXX */\n\t  Tcl_DStringAppendElement(str, \"[unparseable principal]\");\n     }\n     else {\n\t  Tcl_DStringAppendElement(str, tmp);\n\t  free(tmp);\n     }\n\n     sprintf(buf, \"%d\", princ->mod_date);\n     Tcl_DStringAppendElement(str, buf);\n\n     tmp_dstring = unparse_krb5_flags(princ->attributes);\n     Tcl_DStringAppendElement(str, tmp_dstring->string);\n     Tcl_DStringFree(tmp_dstring);\n     free(tmp_dstring);\n\n     sprintf(buf, \"%d\", princ->kvno);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%d\", princ->mkvno);\n     Tcl_DStringAppendElement(str, buf);\n\n     /* XXX This may be dangerous, because the contents of the policy */\n     /* field are undefined if the POLICY bit isn't set.  However, I */\n     /* think it's a bug for the field not to be null in that case */\n     /* anyway, so we should assume that it will be null so that we'll */\n     /* catch it if it isn't. */\n     \n     tmp_dstring = unparse_str(princ->policy);\n     Tcl_DStringAppendElement(str, tmp_dstring->string);\n     Tcl_DStringFree(tmp_dstring);\n     free(tmp_dstring);\n\n     tmp_dstring = unparse_aux_attributes(princ->aux_attributes);\n     Tcl_DStringAppendElement(str, tmp_dstring->string);\n     Tcl_DStringFree(tmp_dstring);\n     free(tmp_dstring);\n\n     return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_DeleteHashEntry",
          "args": [
            "entry"
          ],
          "line": 1568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while setting entry variable\""
          ],
          "line": 1566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetVar",
          "args": [
            "interp",
            "ent_var",
            "buf",
            "TCL_LEAVE_ERR_MSG"
          ],
          "line": 1564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetHashValue",
          "args": [
            "entry",
            "ent"
          ],
          "line": 1563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateHashEntry",
          "args": [
            "struct_table",
            "buf",
            "&newPtr"
          ],
          "line": 1558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"principal%d\"",
            "i"
          ],
          "line": 1557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_InitHashTable",
          "args": [
            "struct_table",
            "TCL_STRING_KEYS"
          ],
          "line": 1553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 1551
        },
        "resolved": true,
        "details": {
          "function_name": "request_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/server/ovsec_kadmd.c",
          "lines": "841-846",
          "snippet": "void request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}",
          "includes": [
            "#include    \"purify.h\"",
            "#include    \"misc.h\"",
            "#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */",
            "#include    <string.h>",
            "#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */",
            "#include    <krb5/adm_proto.h>",
            "#include    <kadm5/server_acl.h>",
            "#include    <kadm5/kadm_rpc.h>",
            "#include    <kadm5/admin.h>",
            "#include    <gssrpc/auth_gssapi.h>",
            "#include    \"gssapiP_krb5.h\" /* for kg_get_context */",
            "#include    <gssapi/gssapi.h>",
            "#include    <gssrpc/rpc.h>",
            "#include    <arpa/inet.h>  /* inet_ntoa */",
            "#include    <netinet/in.h>",
            "#include    <unistd.h>",
            "#include    <sys/socket.h>",
            "#include    <sys/time.h>",
            "#include    <sys/select.h>",
            "#include    <sys/types.h>",
            "#include    <syslog.h>",
            "#include    <signal.h>",
            "#include    <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "volatile int\tsignal_request_exit = 0;",
            "void\trequest_exit(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include    \"purify.h\"\n#include    \"misc.h\"\n#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */\n#include    <string.h>\n#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */\n#include    <krb5/adm_proto.h>\n#include    <kadm5/server_acl.h>\n#include    <kadm5/kadm_rpc.h>\n#include    <kadm5/admin.h>\n#include    <gssrpc/auth_gssapi.h>\n#include    \"gssapiP_krb5.h\" /* for kg_get_context */\n#include    <gssapi/gssapi.h>\n#include    <gssrpc/rpc.h>\n#include    <arpa/inet.h>  /* inet_ntoa */\n#include    <netinet/in.h>\n#include    <unistd.h>\n#include    <sys/socket.h>\n#include    <sys/time.h>\n#include    <sys/select.h>\n#include    <sys/types.h>\n#include    <syslog.h>\n#include    <signal.h>\n#include    <stdio.h>\n\nvolatile int\tsignal_request_exit = 0;\nvoid\trequest_exit(int);\n\nvoid request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 1550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*struct_table)"
          ],
          "line": 1549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_get_principal",
          "args": [
            "server_handle",
            "princ",
            "ent_var ? &ent : 0"
          ],
          "line": 1538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing entry variable name\""
          ],
          "line": 1533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_str",
          "args": [
            "interp",
            "argv[1]",
            "&ent_var"
          ],
          "line": 1532
        },
        "resolved": true,
        "details": {
          "function_name": "parse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "229-241",
          "snippet": "static int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing principal name\""
          ],
          "line": 1527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krb5_parse_name",
          "args": [
            "context",
            "name",
            "&princ"
          ],
          "line": 1525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GET_HANDLE",
          "args": [
            "2",
            "1"
          ],
          "line": 1520
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic krb5_context context;\nstatic Tcl_HashTable *struct_table = 0;\n\nstatic int tcl_ovsec_kadm_get_principal(ClientData clientData,\n\t\t\t\t\tTcl_Interp *interp,\n\t\t\t\t\tint argc, char *argv[])\n{\n     krb5_principal princ;\n     ovsec_kadm_principal_ent_t ent;\n     Tcl_DString *ent_dstring = 0;\n     char *ent_var;\n     char *name;\n     krb5_error_code krb5_ret;\n     int tcl_ret;\n     ovsec_kadm_ret_t ret;\n     int retcode = TCL_OK;\n     \n     GET_HANDLE(2, 1);\n\n     if((tcl_ret = parse_str(interp, argv[0], &name)) != TCL_OK)\n\treturn tcl_ret;\n     if(name != NULL) {\n\tif ((krb5_ret = krb5_parse_name(context, name, &princ))) {\n\t    stash_error(interp, krb5_ret);\n\t    Tcl_AppendElement(interp, \"while parsing principal name\");\n\t    return TCL_ERROR;\n\t}\n     } else princ = NULL;\n\n     if ((tcl_ret = parse_str(interp, argv[1], &ent_var)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing entry variable name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     \n     ret = ovsec_kadm_get_principal(server_handle, princ, ent_var ? &ent : 0);\n\n     if (ret == OVSEC_KADM_OK) {\n\t  if (ent_var) {\n\t       if (dostruct) {\n\t\t    char buf[20];\n\t\t    int i = 1, newPtr = 0;\n\t\t    Tcl_HashEntry *entry;\n\t\t    \n\t\t    if (! struct_table) {\n\t\t\t if (! (struct_table =\n\t\t\t\tmalloc(sizeof(*struct_table)))) {\n\t\t\t      fprintf(stderr, \"Out of memory!\\n\");\n\t\t\t      exit(1); /* XXX */\n\t\t\t }\n\t\t\t Tcl_InitHashTable(struct_table, TCL_STRING_KEYS);\n\t\t    }\n\n\t\t    do {\n\t\t\t sprintf(buf, \"principal%d\", i);\n\t\t\t entry = Tcl_CreateHashEntry(struct_table, buf,\n\t\t\t\t\t\t     &newPtr);\n\t\t\t i++;\n\t\t    } while (! newPtr);\n\n\t\t    Tcl_SetHashValue(entry, ent);\n\t\t    if (! Tcl_SetVar(interp, ent_var, buf,\n\t\t\t\t     TCL_LEAVE_ERR_MSG)) {\n\t\t\t Tcl_AppendElement(interp,\n\t\t\t\t\t   \"while setting entry variable\");\n\t\t\t Tcl_DeleteHashEntry(entry);\n\t\t\t retcode = TCL_ERROR;\n\t\t\t goto finished;\n\t\t    }\n\t\t    set_ok(interp, \"Principal structure retrieved.\");\n\t       }\n\t       else {\n\t\t    ent_dstring = unparse_principal_ent(ent);\n\t\t    if (! Tcl_SetVar(interp, ent_var, ent_dstring->string,\n\t\t\t\t     TCL_LEAVE_ERR_MSG)) {\n\t\t\t Tcl_AppendElement(interp,\n\t\t\t\t\t   \"while setting entry variable\");\n\t\t\t retcode = TCL_ERROR;\n\t\t\t goto finished;\n\t\t    }\n\t\t    set_ok(interp, \"Principal retrieved.\");\n\t       }\n\t  }\n     }\n     else {\n\t  ent = 0;\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n\nfinished:\n     if (ent_dstring) {\n\t  Tcl_DStringFree(ent_dstring);\n\t  free(ent_dstring);\n     }\n     if(princ != NULL)\n\tkrb5_free_principal(context, princ);\n     if (ent && ((! dostruct) || (retcode != TCL_OK))) {\n\t if ((ret = ovsec_kadm_free_principal_ent(server_handle, ent)) &&\n\t     (retcode == TCL_OK)) {\n\t     stash_error(interp, ret);\n\t     retcode = TCL_ERROR;\n\t }\n     }\n     return retcode;\n}"
  },
  {
    "function_name": "tcl_ovsec_kadm_randkey_principal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "1432-1502",
    "snippet": "static int tcl_ovsec_kadm_randkey_principal(ClientData clientData,\n\t\t\t\t\t    Tcl_Interp *interp,\n\t\t\t\t\t    int argc, char *argv[])\n{\n     krb5_principal princ;\n     krb5_keyblock *keyblock;\n     char *keyblock_var;\n     Tcl_DString *keyblock_dstring = 0;\n#ifdef OVERRIDE     \n     int override_qual;\n#endif     \n     krb5_error_code krb5_ret;\n     ovsec_kadm_ret_t ret;\n     int retcode = TCL_OK;\n\n     GET_HANDLE(2, 0);\n\n     if ((krb5_ret = krb5_parse_name(context, argv[0], &princ))) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing principal name\");\n\t  return TCL_ERROR;\n     }\n\n     if (parse_str(interp, argv[1], &keyblock_var) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing keyblock variable name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n#ifdef OVERRIDE\n     if (Tcl_GetBoolean(interp, argv[2], &override_qual) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing override_qual\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     ret = ovsec_kadm_randkey_principal(server_handle,\n\t\t\t\t\tprinc, keyblock_var ? &keyblock : 0,\n\t\t\t\t\toverride_qual);\n#else\n     ret = ovsec_kadm_randkey_principal(server_handle,\n\t\t\t\t\tprinc, keyblock_var ? &keyblock : 0);\n#endif\t\t\t\t\t\n\n     if (ret == OVSEC_KADM_OK) {\n\t  if (keyblock_var) {\n\t       keyblock_dstring = unparse_keyblock(keyblock);\n\t       if (! Tcl_SetVar(interp, keyblock_var,\n\t\t\t\tkeyblock_dstring->string,\n\t\t\t\tTCL_LEAVE_ERR_MSG)) {\n\t\t    Tcl_AppendElement(interp,\n\t\t\t\t      \"while setting keyblock variable\");\n\t\t    retcode = TCL_ERROR;\n\t\t    goto finished;\n\t       }\n\t  }\n\t  set_ok(interp, \"Key randomized.\");\n\t  \n     }\n     else {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n\nfinished:\n     krb5_free_principal(context, princ);\n     if (keyblock_dstring) {\n\t  Tcl_DStringFree(keyblock_dstring);\n\t  free(keyblock_dstring);\n     }\n     return retcode;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static krb5_context context;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "keyblock_dstring"
          ],
          "line": 1499
        },
        "resolved": true,
        "details": {
          "function_name": "free_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "939-943",
          "snippet": "static void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_DStringFree",
          "args": [
            "keyblock_dstring"
          ],
          "line": 1498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krb5_free_principal",
          "args": [
            "context",
            "princ"
          ],
          "line": 1496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stash_error",
          "args": [
            "interp",
            "ret"
          ],
          "line": 1491
        },
        "resolved": true,
        "details": {
          "function_name": "stash_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "407-413",
          "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_ok",
          "args": [
            "interp",
            "\"Key randomized.\""
          ],
          "line": 1487
        },
        "resolved": true,
        "details": {
          "function_name": "set_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "244-249",
          "snippet": "static void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while setting keyblock variable\""
          ],
          "line": 1481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetVar",
          "args": [
            "interp",
            "keyblock_var",
            "keyblock_dstring->string",
            "TCL_LEAVE_ERR_MSG"
          ],
          "line": 1478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unparse_keyblock",
          "args": [
            "keyblock"
          ],
          "line": 1477
        },
        "resolved": true,
        "details": {
          "function_name": "unparse_keyblock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "972-1002",
          "snippet": "static Tcl_DString *unparse_keyblock(krb5_keyblock *keyblock)\n{\n     Tcl_DString *str;\n     Tcl_DString *keytype;\n     int i;\n     \n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     keytype = unparse_keytype(keyblock->enctype);\n     Tcl_DStringAppendElement(str, keytype->string);\n     Tcl_DStringFree(keytype);\n     free(keytype);\n     if (keyblock->length == 0) {\n\t  Tcl_DStringAppendElement(str, \"0x00\");\n     }\n     else {\n\t  Tcl_DStringAppendElement(str, \"0x\");\n\t  for (i = 0; i < keyblock->length; i++) {\n\t       char buf[3];\n\t       sprintf(buf, \"%02x\", (int) keyblock->contents[i]);\n\t       Tcl_DStringAppend(str, buf, -1);\n\t  }\n     }\n\n     return str;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_DString *unparse_keyblock(krb5_keyblock *keyblock)\n{\n     Tcl_DString *str;\n     Tcl_DString *keytype;\n     int i;\n     \n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     keytype = unparse_keytype(keyblock->enctype);\n     Tcl_DStringAppendElement(str, keytype->string);\n     Tcl_DStringFree(keytype);\n     free(keytype);\n     if (keyblock->length == 0) {\n\t  Tcl_DStringAppendElement(str, \"0x00\");\n     }\n     else {\n\t  Tcl_DStringAppendElement(str, \"0x\");\n\t  for (i = 0; i < keyblock->length; i++) {\n\t       char buf[3];\n\t       sprintf(buf, \"%02x\", (int) keyblock->contents[i]);\n\t       Tcl_DStringAppend(str, buf, -1);\n\t  }\n     }\n\n     return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_randkey_principal",
          "args": [
            "server_handle",
            "princ",
            "keyblock_var ? &keyblock : 0"
          ],
          "line": 1471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_randkey_principal",
          "args": [
            "server_handle",
            "princ",
            "keyblock_var ? &keyblock : 0",
            "override_qual"
          ],
          "line": 1467
        },
        "resolved": true,
        "details": {
          "function_name": "tcl_ovsec_kadm_randkey_principal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "1432-1502",
          "snippet": "static int tcl_ovsec_kadm_randkey_principal(ClientData clientData,\n\t\t\t\t\t    Tcl_Interp *interp,\n\t\t\t\t\t    int argc, char *argv[])\n{\n     krb5_principal princ;\n     krb5_keyblock *keyblock;\n     char *keyblock_var;\n     Tcl_DString *keyblock_dstring = 0;\n#ifdef OVERRIDE     \n     int override_qual;\n#endif     \n     krb5_error_code krb5_ret;\n     ovsec_kadm_ret_t ret;\n     int retcode = TCL_OK;\n\n     GET_HANDLE(2, 0);\n\n     if ((krb5_ret = krb5_parse_name(context, argv[0], &princ))) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing principal name\");\n\t  return TCL_ERROR;\n     }\n\n     if (parse_str(interp, argv[1], &keyblock_var) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing keyblock variable name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n#ifdef OVERRIDE\n     if (Tcl_GetBoolean(interp, argv[2], &override_qual) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing override_qual\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     ret = ovsec_kadm_randkey_principal(server_handle,\n\t\t\t\t\tprinc, keyblock_var ? &keyblock : 0,\n\t\t\t\t\toverride_qual);\n#else\n     ret = ovsec_kadm_randkey_principal(server_handle,\n\t\t\t\t\tprinc, keyblock_var ? &keyblock : 0);\n#endif\t\t\t\t\t\n\n     if (ret == OVSEC_KADM_OK) {\n\t  if (keyblock_var) {\n\t       keyblock_dstring = unparse_keyblock(keyblock);\n\t       if (! Tcl_SetVar(interp, keyblock_var,\n\t\t\t\tkeyblock_dstring->string,\n\t\t\t\tTCL_LEAVE_ERR_MSG)) {\n\t\t    Tcl_AppendElement(interp,\n\t\t\t\t      \"while setting keyblock variable\");\n\t\t    retcode = TCL_ERROR;\n\t\t    goto finished;\n\t       }\n\t  }\n\t  set_ok(interp, \"Key randomized.\");\n\t  \n     }\n     else {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n\nfinished:\n     krb5_free_principal(context, princ);\n     if (keyblock_dstring) {\n\t  Tcl_DStringFree(keyblock_dstring);\n\t  free(keyblock_dstring);\n     }\n     return retcode;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing override_qual\""
          ],
          "line": 1462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetBoolean",
          "args": [
            "interp",
            "argv[2]",
            "&override_qual"
          ],
          "line": 1461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing keyblock variable name\""
          ],
          "line": 1456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_str",
          "args": [
            "interp",
            "argv[1]",
            "&keyblock_var"
          ],
          "line": 1455
        },
        "resolved": true,
        "details": {
          "function_name": "parse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "229-241",
          "snippet": "static int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing principal name\""
          ],
          "line": 1451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krb5_parse_name",
          "args": [
            "context",
            "argv[0]",
            "&princ"
          ],
          "line": 1449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GET_HANDLE",
          "args": [
            "2",
            "0"
          ],
          "line": 1447
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic krb5_context context;\n\nstatic int tcl_ovsec_kadm_randkey_principal(ClientData clientData,\n\t\t\t\t\t    Tcl_Interp *interp,\n\t\t\t\t\t    int argc, char *argv[])\n{\n     krb5_principal princ;\n     krb5_keyblock *keyblock;\n     char *keyblock_var;\n     Tcl_DString *keyblock_dstring = 0;\n#ifdef OVERRIDE     \n     int override_qual;\n#endif     \n     krb5_error_code krb5_ret;\n     ovsec_kadm_ret_t ret;\n     int retcode = TCL_OK;\n\n     GET_HANDLE(2, 0);\n\n     if ((krb5_ret = krb5_parse_name(context, argv[0], &princ))) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing principal name\");\n\t  return TCL_ERROR;\n     }\n\n     if (parse_str(interp, argv[1], &keyblock_var) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing keyblock variable name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n#ifdef OVERRIDE\n     if (Tcl_GetBoolean(interp, argv[2], &override_qual) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing override_qual\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     ret = ovsec_kadm_randkey_principal(server_handle,\n\t\t\t\t\tprinc, keyblock_var ? &keyblock : 0,\n\t\t\t\t\toverride_qual);\n#else\n     ret = ovsec_kadm_randkey_principal(server_handle,\n\t\t\t\t\tprinc, keyblock_var ? &keyblock : 0);\n#endif\t\t\t\t\t\n\n     if (ret == OVSEC_KADM_OK) {\n\t  if (keyblock_var) {\n\t       keyblock_dstring = unparse_keyblock(keyblock);\n\t       if (! Tcl_SetVar(interp, keyblock_var,\n\t\t\t\tkeyblock_dstring->string,\n\t\t\t\tTCL_LEAVE_ERR_MSG)) {\n\t\t    Tcl_AppendElement(interp,\n\t\t\t\t      \"while setting keyblock variable\");\n\t\t    retcode = TCL_ERROR;\n\t\t    goto finished;\n\t       }\n\t  }\n\t  set_ok(interp, \"Key randomized.\");\n\t  \n     }\n     else {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n\nfinished:\n     krb5_free_principal(context, princ);\n     if (keyblock_dstring) {\n\t  Tcl_DStringFree(keyblock_dstring);\n\t  free(keyblock_dstring);\n     }\n     return retcode;\n}"
  },
  {
    "function_name": "tcl_ovsec_kadm_chpass_principal_util",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "1348-1428",
    "snippet": "static int tcl_ovsec_kadm_chpass_principal_util(ClientData clientData,\n\t\t\t\t\t\tTcl_Interp *interp,\n\t\t\t\t\t\tint argc, char *argv[])\n{\n     krb5_principal princ;\n     char *new_pw;\n#ifdef OVERRIDE     \n     int override_qual;\n#endif     \n     char *pw_ret, *pw_ret_var;\n     char msg_ret[1024], *msg_ret_var;\n     krb5_error_code krb5_ret;\n     ovsec_kadm_ret_t ret;\n     int retcode = TCL_OK;\n\n     GET_HANDLE(4, 0);\n\n     if ((krb5_ret = krb5_parse_name(context, argv[0], &princ))) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing principal name\");\n\t  return TCL_ERROR;\n     }\n\n     if (parse_str(interp, argv[1], &new_pw) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing new password\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n#ifdef OVERRIDE\n     if (Tcl_GetBoolean(interp, argv[2], &override_qual) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing override_qual\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n#endif\n     if (parse_str(interp, argv[3], &pw_ret_var) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_ret variable name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if (parse_str(interp, argv[4], &msg_ret_var) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing msg_ret variable name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     ret = ovsec_kadm_chpass_principal_util(server_handle, princ, new_pw,\n#ifdef OVERRIDE     \n\t\t\t\t\t    override_qual,\n#endif\t\t\t\t\t    \n\t\t\t\t\t    pw_ret_var ? &pw_ret : 0,\n\t\t\t\t\t    msg_ret_var ? msg_ret : 0);\n\n     if (ret == OVSEC_KADM_OK) {\n\t  if (pw_ret_var &&\n\t      (! Tcl_SetVar(interp, pw_ret_var, pw_ret,\n\t\t\t    TCL_LEAVE_ERR_MSG))) {\n\t       Tcl_AppendElement(interp, \"while setting pw_ret variable\");\n\t       retcode = TCL_ERROR;\n\t       goto finished;\n\t  }\n\t  if (msg_ret_var &&\n\t      (! Tcl_SetVar(interp, msg_ret_var, msg_ret,\n\t\t\t    TCL_LEAVE_ERR_MSG))) {\n\t       Tcl_AppendElement(interp,\n\t\t\t\t \"while setting msg_ret variable\");\n\t       retcode = TCL_ERROR;\n\t       goto finished;\n\t  }\n\t  set_ok(interp, \"Password changed.\");\n     }\n     else {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n\nfinished:\n     krb5_free_principal(context, princ);\n     return retcode;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static krb5_context context;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "krb5_free_principal",
          "args": [
            "context",
            "princ"
          ],
          "line": 1426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stash_error",
          "args": [
            "interp",
            "ret"
          ],
          "line": 1421
        },
        "resolved": true,
        "details": {
          "function_name": "stash_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "407-413",
          "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_ok",
          "args": [
            "interp",
            "\"Password changed.\""
          ],
          "line": 1418
        },
        "resolved": true,
        "details": {
          "function_name": "set_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "244-249",
          "snippet": "static void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while setting msg_ret variable\""
          ],
          "line": 1413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetVar",
          "args": [
            "interp",
            "msg_ret_var",
            "msg_ret",
            "TCL_LEAVE_ERR_MSG"
          ],
          "line": 1411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while setting pw_ret variable\""
          ],
          "line": 1406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetVar",
          "args": [
            "interp",
            "pw_ret_var",
            "pw_ret",
            "TCL_LEAVE_ERR_MSG"
          ],
          "line": 1404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_chpass_principal_util",
          "args": [
            "server_handle",
            "princ",
            "new_pw",
            "#ifdef OVERRIDEoverride_qual",
            "#endifpw_ret_var ? &pw_ret : 0",
            "msg_ret_var ? msg_ret : 0"
          ],
          "line": 1395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing msg_ret variable name\""
          ],
          "line": 1390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_str",
          "args": [
            "interp",
            "argv[4]",
            "&msg_ret_var"
          ],
          "line": 1389
        },
        "resolved": true,
        "details": {
          "function_name": "parse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "229-241",
          "snippet": "static int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing pw_ret variable name\""
          ],
          "line": 1384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing override_qual\""
          ],
          "line": 1378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetBoolean",
          "args": [
            "interp",
            "argv[2]",
            "&override_qual"
          ],
          "line": 1377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing new password\""
          ],
          "line": 1372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing principal name\""
          ],
          "line": 1367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krb5_parse_name",
          "args": [
            "context",
            "argv[0]",
            "&princ"
          ],
          "line": 1365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GET_HANDLE",
          "args": [
            "4",
            "0"
          ],
          "line": 1363
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic krb5_context context;\n\nstatic int tcl_ovsec_kadm_chpass_principal_util(ClientData clientData,\n\t\t\t\t\t\tTcl_Interp *interp,\n\t\t\t\t\t\tint argc, char *argv[])\n{\n     krb5_principal princ;\n     char *new_pw;\n#ifdef OVERRIDE     \n     int override_qual;\n#endif     \n     char *pw_ret, *pw_ret_var;\n     char msg_ret[1024], *msg_ret_var;\n     krb5_error_code krb5_ret;\n     ovsec_kadm_ret_t ret;\n     int retcode = TCL_OK;\n\n     GET_HANDLE(4, 0);\n\n     if ((krb5_ret = krb5_parse_name(context, argv[0], &princ))) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing principal name\");\n\t  return TCL_ERROR;\n     }\n\n     if (parse_str(interp, argv[1], &new_pw) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing new password\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n#ifdef OVERRIDE\n     if (Tcl_GetBoolean(interp, argv[2], &override_qual) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing override_qual\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n#endif\n     if (parse_str(interp, argv[3], &pw_ret_var) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_ret variable name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if (parse_str(interp, argv[4], &msg_ret_var) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing msg_ret variable name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     ret = ovsec_kadm_chpass_principal_util(server_handle, princ, new_pw,\n#ifdef OVERRIDE     \n\t\t\t\t\t    override_qual,\n#endif\t\t\t\t\t    \n\t\t\t\t\t    pw_ret_var ? &pw_ret : 0,\n\t\t\t\t\t    msg_ret_var ? msg_ret : 0);\n\n     if (ret == OVSEC_KADM_OK) {\n\t  if (pw_ret_var &&\n\t      (! Tcl_SetVar(interp, pw_ret_var, pw_ret,\n\t\t\t    TCL_LEAVE_ERR_MSG))) {\n\t       Tcl_AppendElement(interp, \"while setting pw_ret variable\");\n\t       retcode = TCL_ERROR;\n\t       goto finished;\n\t  }\n\t  if (msg_ret_var &&\n\t      (! Tcl_SetVar(interp, msg_ret_var, msg_ret,\n\t\t\t    TCL_LEAVE_ERR_MSG))) {\n\t       Tcl_AppendElement(interp,\n\t\t\t\t \"while setting msg_ret variable\");\n\t       retcode = TCL_ERROR;\n\t       goto finished;\n\t  }\n\t  set_ok(interp, \"Password changed.\");\n     }\n     else {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n\nfinished:\n     krb5_free_principal(context, princ);\n     return retcode;\n}"
  },
  {
    "function_name": "tcl_ovsec_kadm_chpass_principal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "1291-1344",
    "snippet": "static int tcl_ovsec_kadm_chpass_principal(ClientData clientData, \n\t\t\t\t\t   Tcl_Interp *interp,\n\t\t\t\t\t   int argc, char *argv[])\n{\n     krb5_principal princ;\n     char *pw;\n#ifdef OVERRIDE     \n     int override_qual;\n#endif     \n     krb5_error_code krb5_ret;\n     int retcode = TCL_OK;\n     ovsec_kadm_ret_t ret;\n\n     GET_HANDLE(2, 0);\n\n     krb5_ret = krb5_parse_name(context, argv[0], &princ);\n     if (krb5_ret) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing principal name\");\n\t  return TCL_ERROR;\n     }\n\n     if (parse_str(interp, argv[1], &pw) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing password\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n#ifdef OVERRIDE\n     if (Tcl_GetBoolean(interp, argv[2], &override_qual) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing override_qual\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     \n     ret = ovsec_kadm_chpass_principal(server_handle,\n\t\t\t\t       princ, pw, override_qual);\n#else\n     ret = ovsec_kadm_chpass_principal(server_handle, princ, pw);\n#endif     \n\n     if (ret == OVSEC_KADM_OK) {\n\t  set_ok(interp, \"Password changed.\");\n\t  goto finished;\n     }\n     else {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n\nfinished:\n     krb5_free_principal(context, princ);\n     return retcode;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static krb5_context context;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "krb5_free_principal",
          "args": [
            "context",
            "princ"
          ],
          "line": 1342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stash_error",
          "args": [
            "interp",
            "ret"
          ],
          "line": 1337
        },
        "resolved": true,
        "details": {
          "function_name": "stash_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "407-413",
          "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_ok",
          "args": [
            "interp",
            "\"Password changed.\""
          ],
          "line": 1333
        },
        "resolved": true,
        "details": {
          "function_name": "set_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "244-249",
          "snippet": "static void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_chpass_principal",
          "args": [
            "server_handle",
            "princ",
            "pw"
          ],
          "line": 1329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_chpass_principal",
          "args": [
            "server_handle",
            "princ",
            "pw",
            "override_qual"
          ],
          "line": 1326
        },
        "resolved": true,
        "details": {
          "function_name": "tcl_ovsec_kadm_chpass_principal_util",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "1348-1428",
          "snippet": "static int tcl_ovsec_kadm_chpass_principal_util(ClientData clientData,\n\t\t\t\t\t\tTcl_Interp *interp,\n\t\t\t\t\t\tint argc, char *argv[])\n{\n     krb5_principal princ;\n     char *new_pw;\n#ifdef OVERRIDE     \n     int override_qual;\n#endif     \n     char *pw_ret, *pw_ret_var;\n     char msg_ret[1024], *msg_ret_var;\n     krb5_error_code krb5_ret;\n     ovsec_kadm_ret_t ret;\n     int retcode = TCL_OK;\n\n     GET_HANDLE(4, 0);\n\n     if ((krb5_ret = krb5_parse_name(context, argv[0], &princ))) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing principal name\");\n\t  return TCL_ERROR;\n     }\n\n     if (parse_str(interp, argv[1], &new_pw) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing new password\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n#ifdef OVERRIDE\n     if (Tcl_GetBoolean(interp, argv[2], &override_qual) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing override_qual\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n#endif\n     if (parse_str(interp, argv[3], &pw_ret_var) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_ret variable name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if (parse_str(interp, argv[4], &msg_ret_var) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing msg_ret variable name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     ret = ovsec_kadm_chpass_principal_util(server_handle, princ, new_pw,\n#ifdef OVERRIDE     \n\t\t\t\t\t    override_qual,\n#endif\t\t\t\t\t    \n\t\t\t\t\t    pw_ret_var ? &pw_ret : 0,\n\t\t\t\t\t    msg_ret_var ? msg_ret : 0);\n\n     if (ret == OVSEC_KADM_OK) {\n\t  if (pw_ret_var &&\n\t      (! Tcl_SetVar(interp, pw_ret_var, pw_ret,\n\t\t\t    TCL_LEAVE_ERR_MSG))) {\n\t       Tcl_AppendElement(interp, \"while setting pw_ret variable\");\n\t       retcode = TCL_ERROR;\n\t       goto finished;\n\t  }\n\t  if (msg_ret_var &&\n\t      (! Tcl_SetVar(interp, msg_ret_var, msg_ret,\n\t\t\t    TCL_LEAVE_ERR_MSG))) {\n\t       Tcl_AppendElement(interp,\n\t\t\t\t \"while setting msg_ret variable\");\n\t       retcode = TCL_ERROR;\n\t       goto finished;\n\t  }\n\t  set_ok(interp, \"Password changed.\");\n     }\n     else {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n\nfinished:\n     krb5_free_principal(context, princ);\n     return retcode;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static krb5_context context;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic krb5_context context;\n\nstatic int tcl_ovsec_kadm_chpass_principal_util(ClientData clientData,\n\t\t\t\t\t\tTcl_Interp *interp,\n\t\t\t\t\t\tint argc, char *argv[])\n{\n     krb5_principal princ;\n     char *new_pw;\n#ifdef OVERRIDE     \n     int override_qual;\n#endif     \n     char *pw_ret, *pw_ret_var;\n     char msg_ret[1024], *msg_ret_var;\n     krb5_error_code krb5_ret;\n     ovsec_kadm_ret_t ret;\n     int retcode = TCL_OK;\n\n     GET_HANDLE(4, 0);\n\n     if ((krb5_ret = krb5_parse_name(context, argv[0], &princ))) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing principal name\");\n\t  return TCL_ERROR;\n     }\n\n     if (parse_str(interp, argv[1], &new_pw) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing new password\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n#ifdef OVERRIDE\n     if (Tcl_GetBoolean(interp, argv[2], &override_qual) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing override_qual\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n#endif\n     if (parse_str(interp, argv[3], &pw_ret_var) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_ret variable name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if (parse_str(interp, argv[4], &msg_ret_var) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing msg_ret variable name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     ret = ovsec_kadm_chpass_principal_util(server_handle, princ, new_pw,\n#ifdef OVERRIDE     \n\t\t\t\t\t    override_qual,\n#endif\t\t\t\t\t    \n\t\t\t\t\t    pw_ret_var ? &pw_ret : 0,\n\t\t\t\t\t    msg_ret_var ? msg_ret : 0);\n\n     if (ret == OVSEC_KADM_OK) {\n\t  if (pw_ret_var &&\n\t      (! Tcl_SetVar(interp, pw_ret_var, pw_ret,\n\t\t\t    TCL_LEAVE_ERR_MSG))) {\n\t       Tcl_AppendElement(interp, \"while setting pw_ret variable\");\n\t       retcode = TCL_ERROR;\n\t       goto finished;\n\t  }\n\t  if (msg_ret_var &&\n\t      (! Tcl_SetVar(interp, msg_ret_var, msg_ret,\n\t\t\t    TCL_LEAVE_ERR_MSG))) {\n\t       Tcl_AppendElement(interp,\n\t\t\t\t \"while setting msg_ret variable\");\n\t       retcode = TCL_ERROR;\n\t       goto finished;\n\t  }\n\t  set_ok(interp, \"Password changed.\");\n     }\n     else {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n\nfinished:\n     krb5_free_principal(context, princ);\n     return retcode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing override_qual\""
          ],
          "line": 1321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetBoolean",
          "args": [
            "interp",
            "argv[2]",
            "&override_qual"
          ],
          "line": 1320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing password\""
          ],
          "line": 1314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_str",
          "args": [
            "interp",
            "argv[1]",
            "&pw"
          ],
          "line": 1313
        },
        "resolved": true,
        "details": {
          "function_name": "parse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "229-241",
          "snippet": "static int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing principal name\""
          ],
          "line": 1309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krb5_parse_name",
          "args": [
            "context",
            "argv[0]",
            "&princ"
          ],
          "line": 1306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GET_HANDLE",
          "args": [
            "2",
            "0"
          ],
          "line": 1304
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic krb5_context context;\n\nstatic int tcl_ovsec_kadm_chpass_principal(ClientData clientData, \n\t\t\t\t\t   Tcl_Interp *interp,\n\t\t\t\t\t   int argc, char *argv[])\n{\n     krb5_principal princ;\n     char *pw;\n#ifdef OVERRIDE     \n     int override_qual;\n#endif     \n     krb5_error_code krb5_ret;\n     int retcode = TCL_OK;\n     ovsec_kadm_ret_t ret;\n\n     GET_HANDLE(2, 0);\n\n     krb5_ret = krb5_parse_name(context, argv[0], &princ);\n     if (krb5_ret) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing principal name\");\n\t  return TCL_ERROR;\n     }\n\n     if (parse_str(interp, argv[1], &pw) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing password\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n#ifdef OVERRIDE\n     if (Tcl_GetBoolean(interp, argv[2], &override_qual) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing override_qual\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     \n     ret = ovsec_kadm_chpass_principal(server_handle,\n\t\t\t\t       princ, pw, override_qual);\n#else\n     ret = ovsec_kadm_chpass_principal(server_handle, princ, pw);\n#endif     \n\n     if (ret == OVSEC_KADM_OK) {\n\t  set_ok(interp, \"Password changed.\");\n\t  goto finished;\n     }\n     else {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n\nfinished:\n     krb5_free_principal(context, princ);\n     return retcode;\n}"
  },
  {
    "function_name": "tcl_ovsec_kadm_rename_principal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "1248-1287",
    "snippet": "static int tcl_ovsec_kadm_rename_principal(ClientData clientData,\n\t\t\t\t\t   Tcl_Interp *interp,\n\t\t\t\t\t   int argc, char *argv[])\n{\n     krb5_principal source, target;\n     krb5_error_code krb5_ret;\n     ovsec_kadm_ret_t ret;\n     int retcode = TCL_OK;\n\n     GET_HANDLE(2, 0);\n\n     krb5_ret = krb5_parse_name(context, argv[0], &source);\n     if (krb5_ret) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing source\");\n\t  return TCL_ERROR;\n     }\n\n     krb5_ret = krb5_parse_name(context, argv[1], &target);\n     if (krb5_ret) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing target\");\n\t  krb5_free_principal(context, source);\n\t  return TCL_ERROR;\n     }\n\n     ret = ovsec_kadm_rename_principal(server_handle, source, target);\n\n     if (ret == OVSEC_KADM_OK) {\n\t  set_ok(interp, \"Principal renamed.\");\n     }\n     else {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n\n     krb5_free_principal(context, source);\n     krb5_free_principal(context, target);\n     return retcode;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static krb5_context context;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "krb5_free_principal",
          "args": [
            "context",
            "target"
          ],
          "line": 1285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krb5_free_principal",
          "args": [
            "context",
            "source"
          ],
          "line": 1284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stash_error",
          "args": [
            "interp",
            "ret"
          ],
          "line": 1280
        },
        "resolved": true,
        "details": {
          "function_name": "stash_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "407-413",
          "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_ok",
          "args": [
            "interp",
            "\"Principal renamed.\""
          ],
          "line": 1277
        },
        "resolved": true,
        "details": {
          "function_name": "set_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "244-249",
          "snippet": "static void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_rename_principal",
          "args": [
            "server_handle",
            "source",
            "target"
          ],
          "line": 1274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krb5_free_principal",
          "args": [
            "context",
            "source"
          ],
          "line": 1270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing target\""
          ],
          "line": 1269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krb5_parse_name",
          "args": [
            "context",
            "argv[1]",
            "&target"
          ],
          "line": 1266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing source\""
          ],
          "line": 1262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krb5_parse_name",
          "args": [
            "context",
            "argv[0]",
            "&source"
          ],
          "line": 1259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GET_HANDLE",
          "args": [
            "2",
            "0"
          ],
          "line": 1257
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic krb5_context context;\n\nstatic int tcl_ovsec_kadm_rename_principal(ClientData clientData,\n\t\t\t\t\t   Tcl_Interp *interp,\n\t\t\t\t\t   int argc, char *argv[])\n{\n     krb5_principal source, target;\n     krb5_error_code krb5_ret;\n     ovsec_kadm_ret_t ret;\n     int retcode = TCL_OK;\n\n     GET_HANDLE(2, 0);\n\n     krb5_ret = krb5_parse_name(context, argv[0], &source);\n     if (krb5_ret) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing source\");\n\t  return TCL_ERROR;\n     }\n\n     krb5_ret = krb5_parse_name(context, argv[1], &target);\n     if (krb5_ret) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing target\");\n\t  krb5_free_principal(context, source);\n\t  return TCL_ERROR;\n     }\n\n     ret = ovsec_kadm_rename_principal(server_handle, source, target);\n\n     if (ret == OVSEC_KADM_OK) {\n\t  set_ok(interp, \"Principal renamed.\");\n     }\n     else {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n\n     krb5_free_principal(context, source);\n     krb5_free_principal(context, target);\n     return retcode;\n}"
  },
  {
    "function_name": "tcl_ovsec_kadm_modify_principal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "1201-1245",
    "snippet": "static int tcl_ovsec_kadm_modify_principal(ClientData clientData, \n\t\t\t\t\t   Tcl_Interp *interp,\n\t\t\t\t\t   int argc, char *argv[])\n{\n     char *princ_string;\n     ovsec_kadm_principal_ent_t princ = 0;\n     int tcl_ret;\n     krb5_int32 mask;\n     int retcode = TCL_OK;\n     ovsec_kadm_ret_t ret;\n\n     GET_HANDLE(2, 0);\n\n     if ((tcl_ret = parse_str(interp, argv[0], &princ_string)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing principal\");\n\t  return tcl_ret;\n     }\n\n     if (princ_string &&\n\t ((tcl_ret = parse_principal_ent(interp, princ_string, &princ))\n\t  != TCL_OK)) {\n\t  return tcl_ret;\n     }\n     \n     if ((tcl_ret = parse_principal_mask(interp, argv[1], &mask)) != TCL_OK) {\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     ret = ovsec_kadm_modify_principal(server_handle, princ, mask);\n\n     if (ret != OVSEC_KADM_OK) {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n     else {\n\t  set_ok(interp, \"Principal modified.\");\n     }\n\nfinished:\n     if (princ) {\n\t  free_principal_ent(&princ);\n     }\n     return retcode;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_principal_ent",
          "args": [
            "&princ"
          ],
          "line": 1242
        },
        "resolved": true,
        "details": {
          "function_name": "free_principal_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "790-796",
          "snippet": "static void free_principal_ent(ovsec_kadm_principal_ent_t *princ)\n{\n     krb5_free_principal(context, (*princ)->principal);\n     krb5_free_principal(context, (*princ)->mod_name);\n     free(*princ);\n     *princ = 0;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static krb5_context context;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic krb5_context context;\n\nstatic void free_principal_ent(ovsec_kadm_principal_ent_t *princ)\n{\n     krb5_free_principal(context, (*princ)->principal);\n     krb5_free_principal(context, (*princ)->mod_name);\n     free(*princ);\n     *princ = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_ok",
          "args": [
            "interp",
            "\"Principal modified.\""
          ],
          "line": 1237
        },
        "resolved": true,
        "details": {
          "function_name": "set_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "244-249",
          "snippet": "static void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "stash_error",
          "args": [
            "interp",
            "ret"
          ],
          "line": 1233
        },
        "resolved": true,
        "details": {
          "function_name": "stash_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "407-413",
          "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_modify_principal",
          "args": [
            "server_handle",
            "princ",
            "mask"
          ],
          "line": 1230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_principal_mask",
          "args": [
            "interp",
            "argv[1]",
            "&mask"
          ],
          "line": 1225
        },
        "resolved": true,
        "details": {
          "function_name": "parse_principal_mask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "531-546",
          "snippet": "static int parse_principal_mask(Tcl_Interp *interp, char *str, krb5_int32 *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, principal_mask_flags,\n\t\t\t\tsizeof(principal_mask_flags) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct flagval principal_mask_flags[] = {\n     {\"OVSEC_KADM_PRINCIPAL\", OVSEC_KADM_PRINCIPAL},\n     {\"OVSEC_KADM_PRINC_EXPIRE_TIME\", OVSEC_KADM_PRINC_EXPIRE_TIME},\n     {\"OVSEC_KADM_PW_EXPIRATION\", OVSEC_KADM_PW_EXPIRATION},\n     {\"OVSEC_KADM_LAST_PWD_CHANGE\", OVSEC_KADM_LAST_PWD_CHANGE},\n     {\"OVSEC_KADM_ATTRIBUTES\", OVSEC_KADM_ATTRIBUTES},\n     {\"OVSEC_KADM_MAX_LIFE\", OVSEC_KADM_MAX_LIFE},\n     {\"OVSEC_KADM_MOD_TIME\", OVSEC_KADM_MOD_TIME},\n     {\"OVSEC_KADM_MOD_NAME\", OVSEC_KADM_MOD_NAME},\n     {\"OVSEC_KADM_KVNO\", OVSEC_KADM_KVNO},\n     {\"OVSEC_KADM_MKVNO\", OVSEC_KADM_MKVNO},\n     {\"OVSEC_KADM_AUX_ATTRIBUTES\", OVSEC_KADM_AUX_ATTRIBUTES},\n     {\"OVSEC_KADM_POLICY\", OVSEC_KADM_POLICY},\n     {\"OVSEC_KADM_POLICY_CLR\", OVSEC_KADM_POLICY_CLR}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstruct flagval principal_mask_flags[] = {\n     {\"OVSEC_KADM_PRINCIPAL\", OVSEC_KADM_PRINCIPAL},\n     {\"OVSEC_KADM_PRINC_EXPIRE_TIME\", OVSEC_KADM_PRINC_EXPIRE_TIME},\n     {\"OVSEC_KADM_PW_EXPIRATION\", OVSEC_KADM_PW_EXPIRATION},\n     {\"OVSEC_KADM_LAST_PWD_CHANGE\", OVSEC_KADM_LAST_PWD_CHANGE},\n     {\"OVSEC_KADM_ATTRIBUTES\", OVSEC_KADM_ATTRIBUTES},\n     {\"OVSEC_KADM_MAX_LIFE\", OVSEC_KADM_MAX_LIFE},\n     {\"OVSEC_KADM_MOD_TIME\", OVSEC_KADM_MOD_TIME},\n     {\"OVSEC_KADM_MOD_NAME\", OVSEC_KADM_MOD_NAME},\n     {\"OVSEC_KADM_KVNO\", OVSEC_KADM_KVNO},\n     {\"OVSEC_KADM_MKVNO\", OVSEC_KADM_MKVNO},\n     {\"OVSEC_KADM_AUX_ATTRIBUTES\", OVSEC_KADM_AUX_ATTRIBUTES},\n     {\"OVSEC_KADM_POLICY\", OVSEC_KADM_POLICY},\n     {\"OVSEC_KADM_POLICY_CLR\", OVSEC_KADM_POLICY_CLR}\n};\n\nstatic int parse_principal_mask(Tcl_Interp *interp, char *str, krb5_int32 *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, principal_mask_flags,\n\t\t\t\tsizeof(principal_mask_flags) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "parse_principal_ent",
          "args": [
            "interp",
            "princ_string",
            "&princ"
          ],
          "line": 1220
        },
        "resolved": true,
        "details": {
          "function_name": "parse_principal_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "653-787",
          "snippet": "static int parse_principal_ent(Tcl_Interp *interp, char *list,\n\t\t\t       ovsec_kadm_principal_ent_t *out_princ)\n{\n     ovsec_kadm_principal_ent_t princ;\n     krb5_error_code krb5_ret;\n     int tcl_ret;\n     int argc;\n     char **argv;\n     int tmp;\n     int retcode = TCL_OK;\n\n     if ((tcl_ret = Tcl_SplitList(interp, list, &argc, &argv)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     if (argc != 12) {\n\t  sprintf(interp->result, \"wrong # args in principal structure (%d should be 12)\",\n\t\t  argc);\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if (! (princ = malloc(sizeof *princ))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n  \n     if ((krb5_ret = krb5_parse_name(context, argv[0], &princ->principal)) != 0) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing principal\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     /*\n      * All of the numerical values parsed here are parsed into an\n      * \"int\" and then assigned into the structure in case the actual\n      * width of the field in the Kerberos structure is different from\n      * the width of an integer.\n      */\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[1], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing princ_expire_time\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->princ_expire_time = tmp;\n     \n     if ((tcl_ret = Tcl_GetInt(interp, argv[2], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing last_pwd_change\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->last_pwd_change = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[3], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_expiration\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->pw_expiration = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[4], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing max_life\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->max_life = tmp;\n\n     if ((krb5_ret = krb5_parse_name(context, argv[5], &princ->mod_name)) != 0) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing mod_name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\t  \n     if ((tcl_ret = Tcl_GetInt(interp, argv[6], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing mod_date\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->mod_date = tmp;\n\n     if ((tcl_ret = parse_krb5_flags(interp, argv[7], &princ->attributes))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing attributes\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[8], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing kvno\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->kvno = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[9], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing mkvno\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->mkvno = tmp;\n\n     if ((tcl_ret = parse_str(interp, argv[10], &princ->policy)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     if(princ->policy != NULL) {\n\tif(!(princ->policy = strdup(princ->policy))) {\n\t    fprintf(stderr, \"Out of memory!\\n\");\n\t    exit(1);\n\t}\n     }\n\n     if ((tcl_ret = parse_aux_attributes(interp, argv[11],\n\t\t\t\t\t &princ->aux_attributes)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing aux_attributes\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\nfinished:\n     free(argv);\n     *out_princ = princ;\n     return retcode;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static krb5_context context;",
            "struct flagval aux_attributes[] = {\n     {\"OVSEC_KADM_POLICY\",   OVSEC_KADM_POLICY}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic krb5_context context;\nstruct flagval aux_attributes[] = {\n     {\"OVSEC_KADM_POLICY\",   OVSEC_KADM_POLICY}\n};\n\nstatic int parse_principal_ent(Tcl_Interp *interp, char *list,\n\t\t\t       ovsec_kadm_principal_ent_t *out_princ)\n{\n     ovsec_kadm_principal_ent_t princ;\n     krb5_error_code krb5_ret;\n     int tcl_ret;\n     int argc;\n     char **argv;\n     int tmp;\n     int retcode = TCL_OK;\n\n     if ((tcl_ret = Tcl_SplitList(interp, list, &argc, &argv)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     if (argc != 12) {\n\t  sprintf(interp->result, \"wrong # args in principal structure (%d should be 12)\",\n\t\t  argc);\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if (! (princ = malloc(sizeof *princ))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n  \n     if ((krb5_ret = krb5_parse_name(context, argv[0], &princ->principal)) != 0) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing principal\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     /*\n      * All of the numerical values parsed here are parsed into an\n      * \"int\" and then assigned into the structure in case the actual\n      * width of the field in the Kerberos structure is different from\n      * the width of an integer.\n      */\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[1], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing princ_expire_time\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->princ_expire_time = tmp;\n     \n     if ((tcl_ret = Tcl_GetInt(interp, argv[2], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing last_pwd_change\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->last_pwd_change = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[3], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_expiration\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->pw_expiration = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[4], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing max_life\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->max_life = tmp;\n\n     if ((krb5_ret = krb5_parse_name(context, argv[5], &princ->mod_name)) != 0) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing mod_name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\t  \n     if ((tcl_ret = Tcl_GetInt(interp, argv[6], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing mod_date\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->mod_date = tmp;\n\n     if ((tcl_ret = parse_krb5_flags(interp, argv[7], &princ->attributes))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing attributes\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[8], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing kvno\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->kvno = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[9], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing mkvno\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->mkvno = tmp;\n\n     if ((tcl_ret = parse_str(interp, argv[10], &princ->policy)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     if(princ->policy != NULL) {\n\tif(!(princ->policy = strdup(princ->policy))) {\n\t    fprintf(stderr, \"Out of memory!\\n\");\n\t    exit(1);\n\t}\n     }\n\n     if ((tcl_ret = parse_aux_attributes(interp, argv[11],\n\t\t\t\t\t &princ->aux_attributes)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing aux_attributes\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\nfinished:\n     free(argv);\n     *out_princ = princ;\n     return retcode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing principal\""
          ],
          "line": 1215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_str",
          "args": [
            "interp",
            "argv[0]",
            "&princ_string"
          ],
          "line": 1214
        },
        "resolved": true,
        "details": {
          "function_name": "parse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "229-241",
          "snippet": "static int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GET_HANDLE",
          "args": [
            "2",
            "0"
          ],
          "line": 1212
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int tcl_ovsec_kadm_modify_principal(ClientData clientData, \n\t\t\t\t\t   Tcl_Interp *interp,\n\t\t\t\t\t   int argc, char *argv[])\n{\n     char *princ_string;\n     ovsec_kadm_principal_ent_t princ = 0;\n     int tcl_ret;\n     krb5_int32 mask;\n     int retcode = TCL_OK;\n     ovsec_kadm_ret_t ret;\n\n     GET_HANDLE(2, 0);\n\n     if ((tcl_ret = parse_str(interp, argv[0], &princ_string)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing principal\");\n\t  return tcl_ret;\n     }\n\n     if (princ_string &&\n\t ((tcl_ret = parse_principal_ent(interp, princ_string, &princ))\n\t  != TCL_OK)) {\n\t  return tcl_ret;\n     }\n     \n     if ((tcl_ret = parse_principal_mask(interp, argv[1], &mask)) != TCL_OK) {\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     ret = ovsec_kadm_modify_principal(server_handle, princ, mask);\n\n     if (ret != OVSEC_KADM_OK) {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n     }\n     else {\n\t  set_ok(interp, \"Principal modified.\");\n     }\n\nfinished:\n     if (princ) {\n\t  free_principal_ent(&princ);\n     }\n     return retcode;\n}"
  },
  {
    "function_name": "tcl_ovsec_kadm_delete_principal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "1162-1197",
    "snippet": "static int tcl_ovsec_kadm_delete_principal(ClientData clientData, \n\t\t\t\t\t   Tcl_Interp *interp,\n\t\t\t\t\t   int argc, char *argv[])\n{\n     krb5_principal princ;\n     krb5_error_code krb5_ret;\n     ovsec_kadm_ret_t ret;\n     int tcl_ret;\n     char *name;\n     \n     GET_HANDLE(1, 0);\n\n     if((tcl_ret = parse_str(interp, argv[0], &name)) != TCL_OK)\n\treturn tcl_ret;\n     if(name != NULL) {\n        krb5_ret = krb5_parse_name(context, name, &princ);\n\tif (krb5_ret) {\n\t    stash_error(interp, krb5_ret);\n\t    Tcl_AppendElement(interp, \"while parsing principal\");\n\t    return TCL_ERROR;\n\t}\n     } else princ = NULL;\n     ret = ovsec_kadm_delete_principal(server_handle, princ);\n\n     if(princ != NULL) \n\tkrb5_free_principal(context, princ);\n\n     if (ret != OVSEC_KADM_OK) {\n\t  stash_error(interp, ret);\n\t  return TCL_ERROR;\n     }\n     else {\n\t  set_ok(interp, \"Principal deleted.\");\n\t  return TCL_OK;\n     }\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static krb5_context context;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_ok",
          "args": [
            "interp",
            "\"Principal deleted.\""
          ],
          "line": 1194
        },
        "resolved": true,
        "details": {
          "function_name": "set_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "244-249",
          "snippet": "static void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "stash_error",
          "args": [
            "interp",
            "ret"
          ],
          "line": 1190
        },
        "resolved": true,
        "details": {
          "function_name": "stash_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "407-413",
          "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
        }
      },
      {
        "call_info": {
          "callee": "krb5_free_principal",
          "args": [
            "context",
            "princ"
          ],
          "line": 1187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_delete_principal",
          "args": [
            "server_handle",
            "princ"
          ],
          "line": 1184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing principal\""
          ],
          "line": 1180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krb5_parse_name",
          "args": [
            "context",
            "name",
            "&princ"
          ],
          "line": 1177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_str",
          "args": [
            "interp",
            "argv[0]",
            "&name"
          ],
          "line": 1174
        },
        "resolved": true,
        "details": {
          "function_name": "parse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "229-241",
          "snippet": "static int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GET_HANDLE",
          "args": [
            "1",
            "0"
          ],
          "line": 1172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic krb5_context context;\n\nstatic int tcl_ovsec_kadm_delete_principal(ClientData clientData, \n\t\t\t\t\t   Tcl_Interp *interp,\n\t\t\t\t\t   int argc, char *argv[])\n{\n     krb5_principal princ;\n     krb5_error_code krb5_ret;\n     ovsec_kadm_ret_t ret;\n     int tcl_ret;\n     char *name;\n     \n     GET_HANDLE(1, 0);\n\n     if((tcl_ret = parse_str(interp, argv[0], &name)) != TCL_OK)\n\treturn tcl_ret;\n     if(name != NULL) {\n        krb5_ret = krb5_parse_name(context, name, &princ);\n\tif (krb5_ret) {\n\t    stash_error(interp, krb5_ret);\n\t    Tcl_AppendElement(interp, \"while parsing principal\");\n\t    return TCL_ERROR;\n\t}\n     } else princ = NULL;\n     ret = ovsec_kadm_delete_principal(server_handle, princ);\n\n     if(princ != NULL) \n\tkrb5_free_principal(context, princ);\n\n     if (ret != OVSEC_KADM_OK) {\n\t  stash_error(interp, ret);\n\t  return TCL_ERROR;\n     }\n     else {\n\t  set_ok(interp, \"Principal deleted.\");\n\t  return TCL_OK;\n     }\n}"
  },
  {
    "function_name": "tcl_ovsec_kadm_create_principal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "1092-1158",
    "snippet": "static int tcl_ovsec_kadm_create_principal(ClientData clientData, \n\t\t\t\t\t   Tcl_Interp *interp,\n\t\t\t\t\t   int argc, char *argv[])\n{\n     int tcl_ret;\n     ovsec_kadm_ret_t ret;\n     int retcode = TCL_OK;\n     char *princ_string;\n     ovsec_kadm_principal_ent_t princ = 0;\n     krb5_int32 mask;\n     char *pw;\n#ifdef OVERRIDE     \n     int override_qual;\n#endif     \n\n     GET_HANDLE(3, 0);\n\n     if ((tcl_ret = parse_str(interp, argv[0], &princ_string)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing principal\");\n\t  return tcl_ret;\n     }\n\n     if (princ_string &&\n\t ((tcl_ret = parse_principal_ent(interp, princ_string, &princ))\n\t  != TCL_OK)) {\n\t  return tcl_ret;\n     }\n\n     if ((tcl_ret = parse_principal_mask(interp, argv[1], &mask)) != TCL_OK) {\n\t  retcode = tcl_ret;\n\t  goto finished;\n     }\n\n     if ((tcl_ret = parse_str(interp, argv[2], &pw)) != TCL_OK) {\n\t  retcode = tcl_ret;\n\t  goto finished;\n     }\n#ifdef OVERRIDE\n     if ((tcl_ret = Tcl_GetBoolean(interp, argv[3], &override_qual)) !=\n\t TCL_OK) {\n\t  retcode = tcl_ret;\n\t  goto finished;\n     }\n#endif     \n\n#ifdef OVERRIDE\n     ret = ovsec_kadm_create_principal(server_handle, princ, mask, pw,\n\t\t\t\t       override_qual);\n#else\n     ret = ovsec_kadm_create_principal(server_handle, princ, mask, pw);\n#endif     \n\n     if (ret != OVSEC_KADM_OK) {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     else {\n\t  set_ok(interp, \"Principal created.\");\n     }\n\nfinished:\n     if (princ) {\n\t  free_principal_ent(&princ);\n     }\n     return retcode;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_principal_ent",
          "args": [
            "&princ"
          ],
          "line": 1155
        },
        "resolved": true,
        "details": {
          "function_name": "free_principal_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "790-796",
          "snippet": "static void free_principal_ent(ovsec_kadm_principal_ent_t *princ)\n{\n     krb5_free_principal(context, (*princ)->principal);\n     krb5_free_principal(context, (*princ)->mod_name);\n     free(*princ);\n     *princ = 0;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static krb5_context context;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic krb5_context context;\n\nstatic void free_principal_ent(ovsec_kadm_principal_ent_t *princ)\n{\n     krb5_free_principal(context, (*princ)->principal);\n     krb5_free_principal(context, (*princ)->mod_name);\n     free(*princ);\n     *princ = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_ok",
          "args": [
            "interp",
            "\"Principal created.\""
          ],
          "line": 1150
        },
        "resolved": true,
        "details": {
          "function_name": "set_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "244-249",
          "snippet": "static void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "stash_error",
          "args": [
            "interp",
            "ret"
          ],
          "line": 1145
        },
        "resolved": true,
        "details": {
          "function_name": "stash_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "407-413",
          "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_create_principal",
          "args": [
            "server_handle",
            "princ",
            "mask",
            "pw"
          ],
          "line": 1141
        },
        "resolved": true,
        "details": {
          "function_name": "tcl_ovsec_kadm_create_principal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "1092-1158",
          "snippet": "static int tcl_ovsec_kadm_create_principal(ClientData clientData, \n\t\t\t\t\t   Tcl_Interp *interp,\n\t\t\t\t\t   int argc, char *argv[])\n{\n     int tcl_ret;\n     ovsec_kadm_ret_t ret;\n     int retcode = TCL_OK;\n     char *princ_string;\n     ovsec_kadm_principal_ent_t princ = 0;\n     krb5_int32 mask;\n     char *pw;\n#ifdef OVERRIDE     \n     int override_qual;\n#endif     \n\n     GET_HANDLE(3, 0);\n\n     if ((tcl_ret = parse_str(interp, argv[0], &princ_string)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing principal\");\n\t  return tcl_ret;\n     }\n\n     if (princ_string &&\n\t ((tcl_ret = parse_principal_ent(interp, princ_string, &princ))\n\t  != TCL_OK)) {\n\t  return tcl_ret;\n     }\n\n     if ((tcl_ret = parse_principal_mask(interp, argv[1], &mask)) != TCL_OK) {\n\t  retcode = tcl_ret;\n\t  goto finished;\n     }\n\n     if ((tcl_ret = parse_str(interp, argv[2], &pw)) != TCL_OK) {\n\t  retcode = tcl_ret;\n\t  goto finished;\n     }\n#ifdef OVERRIDE\n     if ((tcl_ret = Tcl_GetBoolean(interp, argv[3], &override_qual)) !=\n\t TCL_OK) {\n\t  retcode = tcl_ret;\n\t  goto finished;\n     }\n#endif     \n\n#ifdef OVERRIDE\n     ret = ovsec_kadm_create_principal(server_handle, princ, mask, pw,\n\t\t\t\t       override_qual);\n#else\n     ret = ovsec_kadm_create_principal(server_handle, princ, mask, pw);\n#endif     \n\n     if (ret != OVSEC_KADM_OK) {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     else {\n\t  set_ok(interp, \"Principal created.\");\n     }\n\nfinished:\n     if (princ) {\n\t  free_principal_ent(&princ);\n     }\n     return retcode;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_create_principal",
          "args": [
            "server_handle",
            "princ",
            "mask",
            "pw",
            "override_qual"
          ],
          "line": 1138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetBoolean",
          "args": [
            "interp",
            "argv[3]",
            "&override_qual"
          ],
          "line": 1130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_str",
          "args": [
            "interp",
            "argv[2]",
            "&pw"
          ],
          "line": 1125
        },
        "resolved": true,
        "details": {
          "function_name": "parse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "229-241",
          "snippet": "static int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "parse_principal_mask",
          "args": [
            "interp",
            "argv[1]",
            "&mask"
          ],
          "line": 1120
        },
        "resolved": true,
        "details": {
          "function_name": "parse_principal_mask",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "531-546",
          "snippet": "static int parse_principal_mask(Tcl_Interp *interp, char *str, krb5_int32 *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, principal_mask_flags,\n\t\t\t\tsizeof(principal_mask_flags) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct flagval principal_mask_flags[] = {\n     {\"OVSEC_KADM_PRINCIPAL\", OVSEC_KADM_PRINCIPAL},\n     {\"OVSEC_KADM_PRINC_EXPIRE_TIME\", OVSEC_KADM_PRINC_EXPIRE_TIME},\n     {\"OVSEC_KADM_PW_EXPIRATION\", OVSEC_KADM_PW_EXPIRATION},\n     {\"OVSEC_KADM_LAST_PWD_CHANGE\", OVSEC_KADM_LAST_PWD_CHANGE},\n     {\"OVSEC_KADM_ATTRIBUTES\", OVSEC_KADM_ATTRIBUTES},\n     {\"OVSEC_KADM_MAX_LIFE\", OVSEC_KADM_MAX_LIFE},\n     {\"OVSEC_KADM_MOD_TIME\", OVSEC_KADM_MOD_TIME},\n     {\"OVSEC_KADM_MOD_NAME\", OVSEC_KADM_MOD_NAME},\n     {\"OVSEC_KADM_KVNO\", OVSEC_KADM_KVNO},\n     {\"OVSEC_KADM_MKVNO\", OVSEC_KADM_MKVNO},\n     {\"OVSEC_KADM_AUX_ATTRIBUTES\", OVSEC_KADM_AUX_ATTRIBUTES},\n     {\"OVSEC_KADM_POLICY\", OVSEC_KADM_POLICY},\n     {\"OVSEC_KADM_POLICY_CLR\", OVSEC_KADM_POLICY_CLR}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstruct flagval principal_mask_flags[] = {\n     {\"OVSEC_KADM_PRINCIPAL\", OVSEC_KADM_PRINCIPAL},\n     {\"OVSEC_KADM_PRINC_EXPIRE_TIME\", OVSEC_KADM_PRINC_EXPIRE_TIME},\n     {\"OVSEC_KADM_PW_EXPIRATION\", OVSEC_KADM_PW_EXPIRATION},\n     {\"OVSEC_KADM_LAST_PWD_CHANGE\", OVSEC_KADM_LAST_PWD_CHANGE},\n     {\"OVSEC_KADM_ATTRIBUTES\", OVSEC_KADM_ATTRIBUTES},\n     {\"OVSEC_KADM_MAX_LIFE\", OVSEC_KADM_MAX_LIFE},\n     {\"OVSEC_KADM_MOD_TIME\", OVSEC_KADM_MOD_TIME},\n     {\"OVSEC_KADM_MOD_NAME\", OVSEC_KADM_MOD_NAME},\n     {\"OVSEC_KADM_KVNO\", OVSEC_KADM_KVNO},\n     {\"OVSEC_KADM_MKVNO\", OVSEC_KADM_MKVNO},\n     {\"OVSEC_KADM_AUX_ATTRIBUTES\", OVSEC_KADM_AUX_ATTRIBUTES},\n     {\"OVSEC_KADM_POLICY\", OVSEC_KADM_POLICY},\n     {\"OVSEC_KADM_POLICY_CLR\", OVSEC_KADM_POLICY_CLR}\n};\n\nstatic int parse_principal_mask(Tcl_Interp *interp, char *str, krb5_int32 *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, principal_mask_flags,\n\t\t\t\tsizeof(principal_mask_flags) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "parse_principal_ent",
          "args": [
            "interp",
            "princ_string",
            "&princ"
          ],
          "line": 1115
        },
        "resolved": true,
        "details": {
          "function_name": "parse_principal_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "653-787",
          "snippet": "static int parse_principal_ent(Tcl_Interp *interp, char *list,\n\t\t\t       ovsec_kadm_principal_ent_t *out_princ)\n{\n     ovsec_kadm_principal_ent_t princ;\n     krb5_error_code krb5_ret;\n     int tcl_ret;\n     int argc;\n     char **argv;\n     int tmp;\n     int retcode = TCL_OK;\n\n     if ((tcl_ret = Tcl_SplitList(interp, list, &argc, &argv)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     if (argc != 12) {\n\t  sprintf(interp->result, \"wrong # args in principal structure (%d should be 12)\",\n\t\t  argc);\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if (! (princ = malloc(sizeof *princ))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n  \n     if ((krb5_ret = krb5_parse_name(context, argv[0], &princ->principal)) != 0) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing principal\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     /*\n      * All of the numerical values parsed here are parsed into an\n      * \"int\" and then assigned into the structure in case the actual\n      * width of the field in the Kerberos structure is different from\n      * the width of an integer.\n      */\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[1], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing princ_expire_time\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->princ_expire_time = tmp;\n     \n     if ((tcl_ret = Tcl_GetInt(interp, argv[2], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing last_pwd_change\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->last_pwd_change = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[3], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_expiration\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->pw_expiration = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[4], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing max_life\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->max_life = tmp;\n\n     if ((krb5_ret = krb5_parse_name(context, argv[5], &princ->mod_name)) != 0) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing mod_name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\t  \n     if ((tcl_ret = Tcl_GetInt(interp, argv[6], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing mod_date\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->mod_date = tmp;\n\n     if ((tcl_ret = parse_krb5_flags(interp, argv[7], &princ->attributes))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing attributes\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[8], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing kvno\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->kvno = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[9], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing mkvno\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->mkvno = tmp;\n\n     if ((tcl_ret = parse_str(interp, argv[10], &princ->policy)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     if(princ->policy != NULL) {\n\tif(!(princ->policy = strdup(princ->policy))) {\n\t    fprintf(stderr, \"Out of memory!\\n\");\n\t    exit(1);\n\t}\n     }\n\n     if ((tcl_ret = parse_aux_attributes(interp, argv[11],\n\t\t\t\t\t &princ->aux_attributes)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing aux_attributes\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\nfinished:\n     free(argv);\n     *out_princ = princ;\n     return retcode;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static krb5_context context;",
            "struct flagval aux_attributes[] = {\n     {\"OVSEC_KADM_POLICY\",   OVSEC_KADM_POLICY}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic krb5_context context;\nstruct flagval aux_attributes[] = {\n     {\"OVSEC_KADM_POLICY\",   OVSEC_KADM_POLICY}\n};\n\nstatic int parse_principal_ent(Tcl_Interp *interp, char *list,\n\t\t\t       ovsec_kadm_principal_ent_t *out_princ)\n{\n     ovsec_kadm_principal_ent_t princ;\n     krb5_error_code krb5_ret;\n     int tcl_ret;\n     int argc;\n     char **argv;\n     int tmp;\n     int retcode = TCL_OK;\n\n     if ((tcl_ret = Tcl_SplitList(interp, list, &argc, &argv)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     if (argc != 12) {\n\t  sprintf(interp->result, \"wrong # args in principal structure (%d should be 12)\",\n\t\t  argc);\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if (! (princ = malloc(sizeof *princ))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n  \n     if ((krb5_ret = krb5_parse_name(context, argv[0], &princ->principal)) != 0) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing principal\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     /*\n      * All of the numerical values parsed here are parsed into an\n      * \"int\" and then assigned into the structure in case the actual\n      * width of the field in the Kerberos structure is different from\n      * the width of an integer.\n      */\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[1], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing princ_expire_time\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->princ_expire_time = tmp;\n     \n     if ((tcl_ret = Tcl_GetInt(interp, argv[2], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing last_pwd_change\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->last_pwd_change = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[3], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_expiration\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->pw_expiration = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[4], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing max_life\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->max_life = tmp;\n\n     if ((krb5_ret = krb5_parse_name(context, argv[5], &princ->mod_name)) != 0) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing mod_name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\t  \n     if ((tcl_ret = Tcl_GetInt(interp, argv[6], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing mod_date\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->mod_date = tmp;\n\n     if ((tcl_ret = parse_krb5_flags(interp, argv[7], &princ->attributes))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing attributes\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[8], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing kvno\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->kvno = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[9], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing mkvno\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->mkvno = tmp;\n\n     if ((tcl_ret = parse_str(interp, argv[10], &princ->policy)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     if(princ->policy != NULL) {\n\tif(!(princ->policy = strdup(princ->policy))) {\n\t    fprintf(stderr, \"Out of memory!\\n\");\n\t    exit(1);\n\t}\n     }\n\n     if ((tcl_ret = parse_aux_attributes(interp, argv[11],\n\t\t\t\t\t &princ->aux_attributes)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing aux_attributes\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\nfinished:\n     free(argv);\n     *out_princ = princ;\n     return retcode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing principal\""
          ],
          "line": 1110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GET_HANDLE",
          "args": [
            "3",
            "0"
          ],
          "line": 1107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int tcl_ovsec_kadm_create_principal(ClientData clientData, \n\t\t\t\t\t   Tcl_Interp *interp,\n\t\t\t\t\t   int argc, char *argv[])\n{\n     int tcl_ret;\n     ovsec_kadm_ret_t ret;\n     int retcode = TCL_OK;\n     char *princ_string;\n     ovsec_kadm_principal_ent_t princ = 0;\n     krb5_int32 mask;\n     char *pw;\n#ifdef OVERRIDE     \n     int override_qual;\n#endif     \n\n     GET_HANDLE(3, 0);\n\n     if ((tcl_ret = parse_str(interp, argv[0], &princ_string)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing principal\");\n\t  return tcl_ret;\n     }\n\n     if (princ_string &&\n\t ((tcl_ret = parse_principal_ent(interp, princ_string, &princ))\n\t  != TCL_OK)) {\n\t  return tcl_ret;\n     }\n\n     if ((tcl_ret = parse_principal_mask(interp, argv[1], &mask)) != TCL_OK) {\n\t  retcode = tcl_ret;\n\t  goto finished;\n     }\n\n     if ((tcl_ret = parse_str(interp, argv[2], &pw)) != TCL_OK) {\n\t  retcode = tcl_ret;\n\t  goto finished;\n     }\n#ifdef OVERRIDE\n     if ((tcl_ret = Tcl_GetBoolean(interp, argv[3], &override_qual)) !=\n\t TCL_OK) {\n\t  retcode = tcl_ret;\n\t  goto finished;\n     }\n#endif     \n\n#ifdef OVERRIDE\n     ret = ovsec_kadm_create_principal(server_handle, princ, mask, pw,\n\t\t\t\t       override_qual);\n#else\n     ret = ovsec_kadm_create_principal(server_handle, princ, mask, pw);\n#endif     \n\n     if (ret != OVSEC_KADM_OK) {\n\t  stash_error(interp, ret);\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     else {\n\t  set_ok(interp, \"Principal created.\");\n     }\n\nfinished:\n     if (princ) {\n\t  free_principal_ent(&princ);\n     }\n     return retcode;\n}"
  },
  {
    "function_name": "tcl_ovsec_kadm_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "1069-1090",
    "snippet": "static int tcl_ovsec_kadm_destroy(ClientData clientData, Tcl_Interp *interp,\n\t\t\t\t  int argc, char *argv[])\n{\n     ovsec_kadm_ret_t ret;\n     int tcl_ret;\n\n     GET_HANDLE(0, 0);\n\n     ret = ovsec_kadm_destroy(server_handle);\n\n     if (ret != OVSEC_KADM_OK) {\n\t  stash_error(interp, ret);\n\t  return TCL_ERROR;\n     }\n\n     if ((tcl_ret = remove_server_handle(interp, argv[-1])) != TCL_OK) {\n\t return tcl_ret;\n     }\n     \n     set_ok(interp, \"OV Admin system deinitialized.\");\n     return TCL_OK;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_ok",
          "args": [
            "interp",
            "\"OV Admin system deinitialized.\""
          ],
          "line": 1088
        },
        "resolved": true,
        "details": {
          "function_name": "set_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "244-249",
          "snippet": "static void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "remove_server_handle",
          "args": [
            "interp",
            "argv[-1]"
          ],
          "line": 1084
        },
        "resolved": true,
        "details": {
          "function_name": "remove_server_handle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "137-149",
          "snippet": "static int remove_server_handle(Tcl_Interp *interp, char *name) \n{\n    Tcl_HashEntry *entry;\n\n    if (! (struct_table &&\n\t   (entry = Tcl_FindHashEntry(struct_table, name)))) {\n\tTcl_AppendResult(interp, \"unknown server handle \", name, 0);\n\treturn TCL_ERROR;\n    }\n\n    Tcl_DeleteHashEntry(entry);\n    return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static Tcl_HashTable *struct_table = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_HashTable *struct_table = 0;\n\nstatic int remove_server_handle(Tcl_Interp *interp, char *name) \n{\n    Tcl_HashEntry *entry;\n\n    if (! (struct_table &&\n\t   (entry = Tcl_FindHashEntry(struct_table, name)))) {\n\tTcl_AppendResult(interp, \"unknown server handle \", name, 0);\n\treturn TCL_ERROR;\n    }\n\n    Tcl_DeleteHashEntry(entry);\n    return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "stash_error",
          "args": [
            "interp",
            "ret"
          ],
          "line": 1080
        },
        "resolved": true,
        "details": {
          "function_name": "stash_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "407-413",
          "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_destroy",
          "args": [
            "server_handle"
          ],
          "line": 1077
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GET_HANDLE",
          "args": [
            "0",
            "0"
          ],
          "line": 1075
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int tcl_ovsec_kadm_destroy(ClientData clientData, Tcl_Interp *interp,\n\t\t\t\t  int argc, char *argv[])\n{\n     ovsec_kadm_ret_t ret;\n     int tcl_ret;\n\n     GET_HANDLE(0, 0);\n\n     ret = ovsec_kadm_destroy(server_handle);\n\n     if (ret != OVSEC_KADM_OK) {\n\t  stash_error(interp, ret);\n\t  return TCL_ERROR;\n     }\n\n     if ((tcl_ret = remove_server_handle(interp, argv[-1])) != TCL_OK) {\n\t return tcl_ret;\n     }\n     \n     set_ok(interp, \"OV Admin system deinitialized.\");\n     return TCL_OK;\n}"
  },
  {
    "function_name": "tcl_ovsec_kadm_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "1006-1065",
    "snippet": "static int tcl_ovsec_kadm_init(ClientData clientData, Tcl_Interp *interp,\n\t\t\t       int argc, char *argv[])\n{\n     ovsec_kadm_ret_t ret;\n     char *client_name, *pass, *service_name, *realm;\n     int tcl_ret;\n     krb5_ui_4 struct_version, api_version;\n     char *handle_var;\n     void *server_handle;\n     char *handle_name;\n     char *whoami = argv[0];\n\n     argv++, argc--;\n\n     krb5_init_context(&context);\n\n     if (argc != 7) {\n\t  Tcl_AppendResult(interp, whoami, \": \", arg_error, 0);\n\t  return TCL_ERROR;\n     }\n\n     if (((tcl_ret = parse_str(interp, argv[0], &client_name)) != TCL_OK) ||\n\t ((tcl_ret = parse_str(interp, argv[1], &pass)) != TCL_OK) ||\n\t ((tcl_ret = parse_str(interp, argv[2], &service_name)) != TCL_OK) ||\n\t ((tcl_ret = parse_str(interp, argv[3], &realm)) != TCL_OK) ||\n\t ((tcl_ret = Tcl_GetInt(interp, argv[4], (int *) &struct_version)) !=\n\t  TCL_OK) ||\n\t ((tcl_ret = Tcl_GetInt(interp, argv[5], (int *) &api_version)) !=\n\t  TCL_OK)) {\n\t  return tcl_ret;\n     }\n\n     handle_var = argv[6];\n\n     if (! (handle_var && *handle_var)) {\n\t Tcl_SetResult(interp, \"must specify server handle variable name\",\n\t\t       TCL_STATIC);\n\t return TCL_ERROR;\n     }\n     \n     ret = ovsec_kadm_init(client_name, pass, service_name, realm,\n\t\t\t   struct_version, api_version, &server_handle);\n\n     if (ret != OVSEC_KADM_OK) {\n\t  stash_error(interp, ret);\n\t  return TCL_ERROR;\n     }\n\n     if ((tcl_ret = put_server_handle(interp, server_handle, &handle_name))\n\t != TCL_OK) {\n\t return tcl_ret;\n     }\n     \n     if (! Tcl_SetVar(interp, handle_var, handle_name, TCL_LEAVE_ERR_MSG)) {\n\t return TCL_ERROR;\n     }\n     \n     set_ok(interp, \"OV Admin system initialized.\");\n     return TCL_OK;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static krb5_context context;",
      "static char *arg_error = \"wrong # args\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_ok",
          "args": [
            "interp",
            "\"OV Admin system initialized.\""
          ],
          "line": 1063
        },
        "resolved": true,
        "details": {
          "function_name": "set_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "244-249",
          "snippet": "static void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_SetVar",
          "args": [
            "interp",
            "handle_var",
            "handle_name",
            "TCL_LEAVE_ERR_MSG"
          ],
          "line": 1059
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_server_handle",
          "args": [
            "interp",
            "server_handle",
            "&handle_name"
          ],
          "line": 1054
        },
        "resolved": true,
        "details": {
          "function_name": "put_server_handle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "81-114",
          "snippet": "static int put_server_handle(Tcl_Interp *interp, void *handle, char **name)\n{\n    int i = 1, newPtr = 0;\n    static char buf[20];\n    Tcl_HashEntry *entry;\n\n    if (! struct_table) {\n\tif (! (struct_table =\n\t       malloc(sizeof(*struct_table)))) {\n\t    fprintf(stderr, \"Out of memory!\\n\");\n\t    exit(1); /* XXX */\n\t}\n\tTcl_InitHashTable(struct_table, TCL_STRING_KEYS);\n    }\n\n    do {\n\t/*\n\t * Handles from ovsec_kadm_init() and kadm5_init() should not\n\t * be mixed during unit tests, but the API would happily\n\t * accept them.  Making the hash entry names different in\n\t * tcl_kadm.c and tcl_ovsec_kadm.c ensures that GET_HANDLE\n\t * will fail if presented a handle from the other API.\n\t */\n\tsprintf(buf, \"ovsec_kadm_handle%d\", i);\n\tentry = Tcl_CreateHashEntry(struct_table, buf, &newPtr);\n\ti++;\n    } while (! newPtr);\n\n    Tcl_SetHashValue(entry, handle);\n\n    *name = buf;\n\n    return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static Tcl_HashTable *struct_table = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_HashTable *struct_table = 0;\n\nstatic int put_server_handle(Tcl_Interp *interp, void *handle, char **name)\n{\n    int i = 1, newPtr = 0;\n    static char buf[20];\n    Tcl_HashEntry *entry;\n\n    if (! struct_table) {\n\tif (! (struct_table =\n\t       malloc(sizeof(*struct_table)))) {\n\t    fprintf(stderr, \"Out of memory!\\n\");\n\t    exit(1); /* XXX */\n\t}\n\tTcl_InitHashTable(struct_table, TCL_STRING_KEYS);\n    }\n\n    do {\n\t/*\n\t * Handles from ovsec_kadm_init() and kadm5_init() should not\n\t * be mixed during unit tests, but the API would happily\n\t * accept them.  Making the hash entry names different in\n\t * tcl_kadm.c and tcl_ovsec_kadm.c ensures that GET_HANDLE\n\t * will fail if presented a handle from the other API.\n\t */\n\tsprintf(buf, \"ovsec_kadm_handle%d\", i);\n\tentry = Tcl_CreateHashEntry(struct_table, buf, &newPtr);\n\ti++;\n    } while (! newPtr);\n\n    Tcl_SetHashValue(entry, handle);\n\n    *name = buf;\n\n    return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "stash_error",
          "args": [
            "interp",
            "ret"
          ],
          "line": 1050
        },
        "resolved": true,
        "details": {
          "function_name": "stash_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "407-413",
          "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ovsec_kadm_init",
          "args": [
            "client_name",
            "pass",
            "service_name",
            "realm",
            "struct_version",
            "api_version",
            "&server_handle"
          ],
          "line": 1046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetResult",
          "args": [
            "interp",
            "\"must specify server handle variable name\"",
            "TCL_STATIC"
          ],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetInt",
          "args": [
            "interp",
            "argv[5]",
            "(int *) &api_version"
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetInt",
          "args": [
            "interp",
            "argv[4]",
            "(int *) &struct_version"
          ],
          "line": 1031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_str",
          "args": [
            "interp",
            "argv[3]",
            "&realm"
          ],
          "line": 1030
        },
        "resolved": true,
        "details": {
          "function_name": "parse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "229-241",
          "snippet": "static int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendResult",
          "args": [
            "interp",
            "whoami",
            "\": \"",
            "arg_error",
            "0"
          ],
          "line": 1023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krb5_init_context",
          "args": [
            "&context"
          ],
          "line": 1020
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic krb5_context context;\nstatic char *arg_error = \"wrong # args\";\n\nstatic int tcl_ovsec_kadm_init(ClientData clientData, Tcl_Interp *interp,\n\t\t\t       int argc, char *argv[])\n{\n     ovsec_kadm_ret_t ret;\n     char *client_name, *pass, *service_name, *realm;\n     int tcl_ret;\n     krb5_ui_4 struct_version, api_version;\n     char *handle_var;\n     void *server_handle;\n     char *handle_name;\n     char *whoami = argv[0];\n\n     argv++, argc--;\n\n     krb5_init_context(&context);\n\n     if (argc != 7) {\n\t  Tcl_AppendResult(interp, whoami, \": \", arg_error, 0);\n\t  return TCL_ERROR;\n     }\n\n     if (((tcl_ret = parse_str(interp, argv[0], &client_name)) != TCL_OK) ||\n\t ((tcl_ret = parse_str(interp, argv[1], &pass)) != TCL_OK) ||\n\t ((tcl_ret = parse_str(interp, argv[2], &service_name)) != TCL_OK) ||\n\t ((tcl_ret = parse_str(interp, argv[3], &realm)) != TCL_OK) ||\n\t ((tcl_ret = Tcl_GetInt(interp, argv[4], (int *) &struct_version)) !=\n\t  TCL_OK) ||\n\t ((tcl_ret = Tcl_GetInt(interp, argv[5], (int *) &api_version)) !=\n\t  TCL_OK)) {\n\t  return tcl_ret;\n     }\n\n     handle_var = argv[6];\n\n     if (! (handle_var && *handle_var)) {\n\t Tcl_SetResult(interp, \"must specify server handle variable name\",\n\t\t       TCL_STATIC);\n\t return TCL_ERROR;\n     }\n     \n     ret = ovsec_kadm_init(client_name, pass, service_name, realm,\n\t\t\t   struct_version, api_version, &server_handle);\n\n     if (ret != OVSEC_KADM_OK) {\n\t  stash_error(interp, ret);\n\t  return TCL_ERROR;\n     }\n\n     if ((tcl_ret = put_server_handle(interp, server_handle, &handle_name))\n\t != TCL_OK) {\n\t return tcl_ret;\n     }\n     \n     if (! Tcl_SetVar(interp, handle_var, handle_name, TCL_LEAVE_ERR_MSG)) {\n\t return TCL_ERROR;\n     }\n     \n     set_ok(interp, \"OV Admin system initialized.\");\n     return TCL_OK;\n}"
  },
  {
    "function_name": "unparse_keyblock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "972-1002",
    "snippet": "static Tcl_DString *unparse_keyblock(krb5_keyblock *keyblock)\n{\n     Tcl_DString *str;\n     Tcl_DString *keytype;\n     int i;\n     \n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     keytype = unparse_keytype(keyblock->enctype);\n     Tcl_DStringAppendElement(str, keytype->string);\n     Tcl_DStringFree(keytype);\n     free(keytype);\n     if (keyblock->length == 0) {\n\t  Tcl_DStringAppendElement(str, \"0x00\");\n     }\n     else {\n\t  Tcl_DStringAppendElement(str, \"0x\");\n\t  for (i = 0; i < keyblock->length; i++) {\n\t       char buf[3];\n\t       sprintf(buf, \"%02x\", (int) keyblock->contents[i]);\n\t       Tcl_DStringAppend(str, buf, -1);\n\t  }\n     }\n\n     return str;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Tcl_DStringAppend",
          "args": [
            "str",
            "buf",
            "-1"
          ],
          "line": 997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%02x\"",
            "(int) keyblock->contents[i]"
          ],
          "line": 996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "\"0x\""
          ],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "\"0x00\""
          ],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "keytype"
          ],
          "line": 988
        },
        "resolved": true,
        "details": {
          "function_name": "free_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "939-943",
          "snippet": "static void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_DStringFree",
          "args": [
            "keytype"
          ],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "keytype->string"
          ],
          "line": 986
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unparse_keytype",
          "args": [
            "keyblock->enctype"
          ],
          "line": 985
        },
        "resolved": true,
        "details": {
          "function_name": "unparse_keytype",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "945-969",
          "snippet": "static Tcl_DString *unparse_keytype(krb5_enctype enctype)\n{\n     Tcl_DString *str;\n     char buf[50];\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     switch (enctype) {\n\t  /* XXX is this right? */\n     case ENCTYPE_NULL: Tcl_DStringAppend(str, \"ENCTYPE_NULL\", -1); break;\n     case ENCTYPE_DES_CBC_CRC:\n\t  Tcl_DStringAppend(str, \"ENCTYPE_DES_CBC_CRC\", -1); break;\n     default:\n\t  sprintf(buf, \"UNKNOWN KEYTYPE (0x%x)\", enctype);\n\t  Tcl_DStringAppend(str, buf, -1);\n\t  break;\n     }\n\n     return str;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_DString *unparse_keytype(krb5_enctype enctype)\n{\n     Tcl_DString *str;\n     char buf[50];\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     switch (enctype) {\n\t  /* XXX is this right? */\n     case ENCTYPE_NULL: Tcl_DStringAppend(str, \"ENCTYPE_NULL\", -1); break;\n     case ENCTYPE_DES_CBC_CRC:\n\t  Tcl_DStringAppend(str, \"ENCTYPE_DES_CBC_CRC\", -1); break;\n     default:\n\t  sprintf(buf, \"UNKNOWN KEYTYPE (0x%x)\", enctype);\n\t  Tcl_DStringAppend(str, buf, -1);\n\t  break;\n     }\n\n     return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_DStringInit",
          "args": [
            "str"
          ],
          "line": 983
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 980
        },
        "resolved": true,
        "details": {
          "function_name": "request_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/server/ovsec_kadmd.c",
          "lines": "841-846",
          "snippet": "void request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}",
          "includes": [
            "#include    \"purify.h\"",
            "#include    \"misc.h\"",
            "#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */",
            "#include    <string.h>",
            "#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */",
            "#include    <krb5/adm_proto.h>",
            "#include    <kadm5/server_acl.h>",
            "#include    <kadm5/kadm_rpc.h>",
            "#include    <kadm5/admin.h>",
            "#include    <gssrpc/auth_gssapi.h>",
            "#include    \"gssapiP_krb5.h\" /* for kg_get_context */",
            "#include    <gssapi/gssapi.h>",
            "#include    <gssrpc/rpc.h>",
            "#include    <arpa/inet.h>  /* inet_ntoa */",
            "#include    <netinet/in.h>",
            "#include    <unistd.h>",
            "#include    <sys/socket.h>",
            "#include    <sys/time.h>",
            "#include    <sys/select.h>",
            "#include    <sys/types.h>",
            "#include    <syslog.h>",
            "#include    <signal.h>",
            "#include    <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "volatile int\tsignal_request_exit = 0;",
            "void\trequest_exit(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include    \"purify.h\"\n#include    \"misc.h\"\n#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */\n#include    <string.h>\n#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */\n#include    <krb5/adm_proto.h>\n#include    <kadm5/server_acl.h>\n#include    <kadm5/kadm_rpc.h>\n#include    <kadm5/admin.h>\n#include    <gssrpc/auth_gssapi.h>\n#include    \"gssapiP_krb5.h\" /* for kg_get_context */\n#include    <gssapi/gssapi.h>\n#include    <gssrpc/rpc.h>\n#include    <arpa/inet.h>  /* inet_ntoa */\n#include    <netinet/in.h>\n#include    <unistd.h>\n#include    <sys/socket.h>\n#include    <sys/time.h>\n#include    <sys/select.h>\n#include    <sys/types.h>\n#include    <syslog.h>\n#include    <signal.h>\n#include    <stdio.h>\n\nvolatile int\tsignal_request_exit = 0;\nvoid\trequest_exit(int);\n\nvoid request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*str)"
          ],
          "line": 978
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_DString *unparse_keyblock(krb5_keyblock *keyblock)\n{\n     Tcl_DString *str;\n     Tcl_DString *keytype;\n     int i;\n     \n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     keytype = unparse_keytype(keyblock->enctype);\n     Tcl_DStringAppendElement(str, keytype->string);\n     Tcl_DStringFree(keytype);\n     free(keytype);\n     if (keyblock->length == 0) {\n\t  Tcl_DStringAppendElement(str, \"0x00\");\n     }\n     else {\n\t  Tcl_DStringAppendElement(str, \"0x\");\n\t  for (i = 0; i < keyblock->length; i++) {\n\t       char buf[3];\n\t       sprintf(buf, \"%02x\", (int) keyblock->contents[i]);\n\t       Tcl_DStringAppend(str, buf, -1);\n\t  }\n     }\n\n     return str;\n}"
  },
  {
    "function_name": "unparse_keytype",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "945-969",
    "snippet": "static Tcl_DString *unparse_keytype(krb5_enctype enctype)\n{\n     Tcl_DString *str;\n     char buf[50];\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     switch (enctype) {\n\t  /* XXX is this right? */\n     case ENCTYPE_NULL: Tcl_DStringAppend(str, \"ENCTYPE_NULL\", -1); break;\n     case ENCTYPE_DES_CBC_CRC:\n\t  Tcl_DStringAppend(str, \"ENCTYPE_DES_CBC_CRC\", -1); break;\n     default:\n\t  sprintf(buf, \"UNKNOWN KEYTYPE (0x%x)\", enctype);\n\t  Tcl_DStringAppend(str, buf, -1);\n\t  break;\n     }\n\n     return str;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Tcl_DStringAppend",
          "args": [
            "str",
            "buf",
            "-1"
          ],
          "line": 964
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"UNKNOWN KEYTYPE (0x%x)\"",
            "enctype"
          ],
          "line": 963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppend",
          "args": [
            "str",
            "\"ENCTYPE_DES_CBC_CRC\"",
            "-1"
          ],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppend",
          "args": [
            "str",
            "\"ENCTYPE_NULL\"",
            "-1"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringInit",
          "args": [
            "str"
          ],
          "line": 955
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 952
        },
        "resolved": true,
        "details": {
          "function_name": "request_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/server/ovsec_kadmd.c",
          "lines": "841-846",
          "snippet": "void request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}",
          "includes": [
            "#include    \"purify.h\"",
            "#include    \"misc.h\"",
            "#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */",
            "#include    <string.h>",
            "#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */",
            "#include    <krb5/adm_proto.h>",
            "#include    <kadm5/server_acl.h>",
            "#include    <kadm5/kadm_rpc.h>",
            "#include    <kadm5/admin.h>",
            "#include    <gssrpc/auth_gssapi.h>",
            "#include    \"gssapiP_krb5.h\" /* for kg_get_context */",
            "#include    <gssapi/gssapi.h>",
            "#include    <gssrpc/rpc.h>",
            "#include    <arpa/inet.h>  /* inet_ntoa */",
            "#include    <netinet/in.h>",
            "#include    <unistd.h>",
            "#include    <sys/socket.h>",
            "#include    <sys/time.h>",
            "#include    <sys/select.h>",
            "#include    <sys/types.h>",
            "#include    <syslog.h>",
            "#include    <signal.h>",
            "#include    <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "volatile int\tsignal_request_exit = 0;",
            "void\trequest_exit(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include    \"purify.h\"\n#include    \"misc.h\"\n#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */\n#include    <string.h>\n#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */\n#include    <krb5/adm_proto.h>\n#include    <kadm5/server_acl.h>\n#include    <kadm5/kadm_rpc.h>\n#include    <kadm5/admin.h>\n#include    <gssrpc/auth_gssapi.h>\n#include    \"gssapiP_krb5.h\" /* for kg_get_context */\n#include    <gssapi/gssapi.h>\n#include    <gssrpc/rpc.h>\n#include    <arpa/inet.h>  /* inet_ntoa */\n#include    <netinet/in.h>\n#include    <unistd.h>\n#include    <sys/socket.h>\n#include    <sys/time.h>\n#include    <sys/select.h>\n#include    <sys/types.h>\n#include    <syslog.h>\n#include    <signal.h>\n#include    <stdio.h>\n\nvolatile int\tsignal_request_exit = 0;\nvoid\trequest_exit(int);\n\nvoid request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*str)"
          ],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_DString *unparse_keytype(krb5_enctype enctype)\n{\n     Tcl_DString *str;\n     char buf[50];\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     switch (enctype) {\n\t  /* XXX is this right? */\n     case ENCTYPE_NULL: Tcl_DStringAppend(str, \"ENCTYPE_NULL\", -1); break;\n     case ENCTYPE_DES_CBC_CRC:\n\t  Tcl_DStringAppend(str, \"ENCTYPE_DES_CBC_CRC\", -1); break;\n     default:\n\t  sprintf(buf, \"UNKNOWN KEYTYPE (0x%x)\", enctype);\n\t  Tcl_DStringAppend(str, buf, -1);\n\t  break;\n     }\n\n     return str;\n}"
  },
  {
    "function_name": "free_policy_ent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "939-943",
    "snippet": "static void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "*policy"
          ],
          "line": 941
        },
        "resolved": true,
        "details": {
          "function_name": "free_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "939-943",
          "snippet": "static void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}"
  },
  {
    "function_name": "parse_policy_ent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "838-936",
    "snippet": "static int parse_policy_ent(Tcl_Interp *interp, char *list,\n\t\t\t    ovsec_kadm_policy_ent_t *out_policy)\n{\n     ovsec_kadm_policy_ent_t policy;\n     int tcl_ret;\n     int argc;\n     char **argv;\n     int tmp;\n     int retcode = TCL_OK;\n\n     if ((tcl_ret = Tcl_SplitList(interp, list, &argc, &argv)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     if (argc != 7) {\n\t  sprintf(interp->result, \"wrong # args in policy structure (%d should be 7)\",\n\t\t  argc);\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if (! (policy = malloc(sizeof *policy))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n  \n     if ((tcl_ret = parse_str(interp, argv[0], &policy->policy)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if(policy->policy != NULL) {\n\tif (! (policy->policy = strdup(policy->policy))) {\n\t    fprintf(stderr, \"Out of memory!\\n\");\n\t    exit(1); /* XXX */\n\t}\n     }\n     \n     /*\n      * All of the numerical values parsed here are parsed into an\n      * \"int\" and then assigned into the structure in case the actual\n      * width of the field in the Kerberos structure is different from\n      * the width of an integer.\n      */\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[1], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_min_life\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_min_life = tmp;\n     \n     if ((tcl_ret = Tcl_GetInt(interp, argv[2], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_max_life\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_max_life = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[3], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_min_length\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_min_length = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[4], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_min_classes\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_min_classes = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[5], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_history_num\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_history_num = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[6], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy_refcnt\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->policy_refcnt = tmp;\n\nfinished:\n     free(argv);\n     *out_policy = policy;\n     return retcode;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "argv"
          ],
          "line": 933
        },
        "resolved": true,
        "details": {
          "function_name": "free_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "939-943",
          "snippet": "static void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing policy_refcnt\""
          ],
          "line": 926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetInt",
          "args": [
            "interp",
            "argv[6]",
            "&tmp"
          ],
          "line": 924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing pw_history_num\""
          ],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetInt",
          "args": [
            "interp",
            "argv[5]",
            "&tmp"
          ],
          "line": 916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing pw_min_classes\""
          ],
          "line": 910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetInt",
          "args": [
            "interp",
            "argv[4]",
            "&tmp"
          ],
          "line": 908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing pw_min_length\""
          ],
          "line": 902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetInt",
          "args": [
            "interp",
            "argv[3]",
            "&tmp"
          ],
          "line": 900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing pw_max_life\""
          ],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetInt",
          "args": [
            "interp",
            "argv[2]",
            "&tmp"
          ],
          "line": 892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing pw_min_life\""
          ],
          "line": 886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetInt",
          "args": [
            "interp",
            "argv[1]",
            "&tmp"
          ],
          "line": 884
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 873
        },
        "resolved": true,
        "details": {
          "function_name": "request_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/server/ovsec_kadmd.c",
          "lines": "841-846",
          "snippet": "void request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}",
          "includes": [
            "#include    \"purify.h\"",
            "#include    \"misc.h\"",
            "#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */",
            "#include    <string.h>",
            "#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */",
            "#include    <krb5/adm_proto.h>",
            "#include    <kadm5/server_acl.h>",
            "#include    <kadm5/kadm_rpc.h>",
            "#include    <kadm5/admin.h>",
            "#include    <gssrpc/auth_gssapi.h>",
            "#include    \"gssapiP_krb5.h\" /* for kg_get_context */",
            "#include    <gssapi/gssapi.h>",
            "#include    <gssrpc/rpc.h>",
            "#include    <arpa/inet.h>  /* inet_ntoa */",
            "#include    <netinet/in.h>",
            "#include    <unistd.h>",
            "#include    <sys/socket.h>",
            "#include    <sys/time.h>",
            "#include    <sys/select.h>",
            "#include    <sys/types.h>",
            "#include    <syslog.h>",
            "#include    <signal.h>",
            "#include    <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "volatile int\tsignal_request_exit = 0;",
            "void\trequest_exit(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include    \"purify.h\"\n#include    \"misc.h\"\n#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */\n#include    <string.h>\n#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */\n#include    <krb5/adm_proto.h>\n#include    <kadm5/server_acl.h>\n#include    <kadm5/kadm_rpc.h>\n#include    <kadm5/admin.h>\n#include    <gssrpc/auth_gssapi.h>\n#include    \"gssapiP_krb5.h\" /* for kg_get_context */\n#include    <gssapi/gssapi.h>\n#include    <gssrpc/rpc.h>\n#include    <arpa/inet.h>  /* inet_ntoa */\n#include    <netinet/in.h>\n#include    <unistd.h>\n#include    <sys/socket.h>\n#include    <sys/time.h>\n#include    <sys/select.h>\n#include    <sys/types.h>\n#include    <syslog.h>\n#include    <signal.h>\n#include    <stdio.h>\n\nvolatile int\tsignal_request_exit = 0;\nvoid\trequest_exit(int);\n\nvoid request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "policy->policy"
          ],
          "line": 871
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing policy name\""
          ],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_str",
          "args": [
            "interp",
            "argv[0]",
            "&policy->policy"
          ],
          "line": 864
        },
        "resolved": true,
        "details": {
          "function_name": "parse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "229-241",
          "snippet": "static int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof *policy"
          ],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "interp->result",
            "\"wrong # args in policy structure (%d should be 7)\"",
            "argc"
          ],
          "line": 853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SplitList",
          "args": [
            "interp",
            "list",
            "&argc",
            "&argv"
          ],
          "line": 848
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_policy_ent(Tcl_Interp *interp, char *list,\n\t\t\t    ovsec_kadm_policy_ent_t *out_policy)\n{\n     ovsec_kadm_policy_ent_t policy;\n     int tcl_ret;\n     int argc;\n     char **argv;\n     int tmp;\n     int retcode = TCL_OK;\n\n     if ((tcl_ret = Tcl_SplitList(interp, list, &argc, &argv)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     if (argc != 7) {\n\t  sprintf(interp->result, \"wrong # args in policy structure (%d should be 7)\",\n\t\t  argc);\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if (! (policy = malloc(sizeof *policy))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n  \n     if ((tcl_ret = parse_str(interp, argv[0], &policy->policy)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if(policy->policy != NULL) {\n\tif (! (policy->policy = strdup(policy->policy))) {\n\t    fprintf(stderr, \"Out of memory!\\n\");\n\t    exit(1); /* XXX */\n\t}\n     }\n     \n     /*\n      * All of the numerical values parsed here are parsed into an\n      * \"int\" and then assigned into the structure in case the actual\n      * width of the field in the Kerberos structure is different from\n      * the width of an integer.\n      */\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[1], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_min_life\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_min_life = tmp;\n     \n     if ((tcl_ret = Tcl_GetInt(interp, argv[2], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_max_life\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_max_life = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[3], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_min_length\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_min_length = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[4], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_min_classes\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_min_classes = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[5], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_history_num\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->pw_history_num = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[6], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy_refcnt\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     policy->policy_refcnt = tmp;\n\nfinished:\n     free(argv);\n     *out_policy = policy;\n     return retcode;\n}"
  },
  {
    "function_name": "unparse_policy_ent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "798-834",
    "snippet": "static Tcl_DString *unparse_policy_ent(ovsec_kadm_policy_ent_t policy)\n{\n     Tcl_DString *str, *tmp_dstring;\n     char buf[20];\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     tmp_dstring = unparse_str(policy->policy);\n     Tcl_DStringAppendElement(str, tmp_dstring->string);\n     Tcl_DStringFree(tmp_dstring);\n     free(tmp_dstring);\n     \n     sprintf(buf, \"%ld\", policy->pw_min_life);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->pw_max_life);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->pw_min_length);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->pw_min_classes);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->pw_history_num);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->policy_refcnt);\n     Tcl_DStringAppendElement(str, buf);\n\n     return str;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "buf"
          ],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%ld\"",
            "policy->policy_refcnt"
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "buf"
          ],
          "line": 828
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%ld\"",
            "policy->pw_history_num"
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "buf"
          ],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%ld\"",
            "policy->pw_min_classes"
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "buf"
          ],
          "line": 822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%ld\"",
            "policy->pw_min_length"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "buf"
          ],
          "line": 819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%ld\"",
            "policy->pw_max_life"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "buf"
          ],
          "line": 816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%ld\"",
            "policy->pw_min_life"
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "tmp_dstring"
          ],
          "line": 813
        },
        "resolved": true,
        "details": {
          "function_name": "free_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "939-943",
          "snippet": "static void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_DStringFree",
          "args": [
            "tmp_dstring"
          ],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "tmp_dstring->string"
          ],
          "line": 811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unparse_str",
          "args": [
            "policy->policy"
          ],
          "line": 810
        },
        "resolved": true,
        "details": {
          "function_name": "unparse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "206-225",
          "snippet": "static Tcl_DString *unparse_str(char *in_str)\n{\n     Tcl_DString *str;\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     if (! in_str) {\n\t  Tcl_DStringAppend(str, \"null\", -1);\n     }\n     else {\n\t  Tcl_DStringAppend(str, in_str, -1);\n     }\n\n     return str;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_DString *unparse_str(char *in_str)\n{\n     Tcl_DString *str;\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     if (! in_str) {\n\t  Tcl_DStringAppend(str, \"null\", -1);\n     }\n     else {\n\t  Tcl_DStringAppend(str, in_str, -1);\n     }\n\n     return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_DStringInit",
          "args": [
            "str"
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 805
        },
        "resolved": true,
        "details": {
          "function_name": "request_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/server/ovsec_kadmd.c",
          "lines": "841-846",
          "snippet": "void request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}",
          "includes": [
            "#include    \"purify.h\"",
            "#include    \"misc.h\"",
            "#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */",
            "#include    <string.h>",
            "#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */",
            "#include    <krb5/adm_proto.h>",
            "#include    <kadm5/server_acl.h>",
            "#include    <kadm5/kadm_rpc.h>",
            "#include    <kadm5/admin.h>",
            "#include    <gssrpc/auth_gssapi.h>",
            "#include    \"gssapiP_krb5.h\" /* for kg_get_context */",
            "#include    <gssapi/gssapi.h>",
            "#include    <gssrpc/rpc.h>",
            "#include    <arpa/inet.h>  /* inet_ntoa */",
            "#include    <netinet/in.h>",
            "#include    <unistd.h>",
            "#include    <sys/socket.h>",
            "#include    <sys/time.h>",
            "#include    <sys/select.h>",
            "#include    <sys/types.h>",
            "#include    <syslog.h>",
            "#include    <signal.h>",
            "#include    <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "volatile int\tsignal_request_exit = 0;",
            "void\trequest_exit(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include    \"purify.h\"\n#include    \"misc.h\"\n#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */\n#include    <string.h>\n#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */\n#include    <krb5/adm_proto.h>\n#include    <kadm5/server_acl.h>\n#include    <kadm5/kadm_rpc.h>\n#include    <kadm5/admin.h>\n#include    <gssrpc/auth_gssapi.h>\n#include    \"gssapiP_krb5.h\" /* for kg_get_context */\n#include    <gssapi/gssapi.h>\n#include    <gssrpc/rpc.h>\n#include    <arpa/inet.h>  /* inet_ntoa */\n#include    <netinet/in.h>\n#include    <unistd.h>\n#include    <sys/socket.h>\n#include    <sys/time.h>\n#include    <sys/select.h>\n#include    <sys/types.h>\n#include    <syslog.h>\n#include    <signal.h>\n#include    <stdio.h>\n\nvolatile int\tsignal_request_exit = 0;\nvoid\trequest_exit(int);\n\nvoid request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*str)"
          ],
          "line": 803
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_DString *unparse_policy_ent(ovsec_kadm_policy_ent_t policy)\n{\n     Tcl_DString *str, *tmp_dstring;\n     char buf[20];\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     tmp_dstring = unparse_str(policy->policy);\n     Tcl_DStringAppendElement(str, tmp_dstring->string);\n     Tcl_DStringFree(tmp_dstring);\n     free(tmp_dstring);\n     \n     sprintf(buf, \"%ld\", policy->pw_min_life);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->pw_max_life);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->pw_min_length);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->pw_min_classes);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->pw_history_num);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%ld\", policy->policy_refcnt);\n     Tcl_DStringAppendElement(str, buf);\n\n     return str;\n}"
  },
  {
    "function_name": "free_principal_ent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "790-796",
    "snippet": "static void free_principal_ent(ovsec_kadm_principal_ent_t *princ)\n{\n     krb5_free_principal(context, (*princ)->principal);\n     krb5_free_principal(context, (*princ)->mod_name);\n     free(*princ);\n     *princ = 0;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static krb5_context context;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "*princ"
          ],
          "line": 794
        },
        "resolved": true,
        "details": {
          "function_name": "free_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "939-943",
          "snippet": "static void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "krb5_free_principal",
          "args": [
            "context",
            "(*princ)->mod_name"
          ],
          "line": 793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krb5_free_principal",
          "args": [
            "context",
            "(*princ)->principal"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic krb5_context context;\n\nstatic void free_principal_ent(ovsec_kadm_principal_ent_t *princ)\n{\n     krb5_free_principal(context, (*princ)->principal);\n     krb5_free_principal(context, (*princ)->mod_name);\n     free(*princ);\n     *princ = 0;\n}"
  },
  {
    "function_name": "parse_principal_ent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "653-787",
    "snippet": "static int parse_principal_ent(Tcl_Interp *interp, char *list,\n\t\t\t       ovsec_kadm_principal_ent_t *out_princ)\n{\n     ovsec_kadm_principal_ent_t princ;\n     krb5_error_code krb5_ret;\n     int tcl_ret;\n     int argc;\n     char **argv;\n     int tmp;\n     int retcode = TCL_OK;\n\n     if ((tcl_ret = Tcl_SplitList(interp, list, &argc, &argv)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     if (argc != 12) {\n\t  sprintf(interp->result, \"wrong # args in principal structure (%d should be 12)\",\n\t\t  argc);\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if (! (princ = malloc(sizeof *princ))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n  \n     if ((krb5_ret = krb5_parse_name(context, argv[0], &princ->principal)) != 0) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing principal\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     /*\n      * All of the numerical values parsed here are parsed into an\n      * \"int\" and then assigned into the structure in case the actual\n      * width of the field in the Kerberos structure is different from\n      * the width of an integer.\n      */\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[1], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing princ_expire_time\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->princ_expire_time = tmp;\n     \n     if ((tcl_ret = Tcl_GetInt(interp, argv[2], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing last_pwd_change\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->last_pwd_change = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[3], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_expiration\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->pw_expiration = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[4], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing max_life\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->max_life = tmp;\n\n     if ((krb5_ret = krb5_parse_name(context, argv[5], &princ->mod_name)) != 0) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing mod_name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\t  \n     if ((tcl_ret = Tcl_GetInt(interp, argv[6], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing mod_date\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->mod_date = tmp;\n\n     if ((tcl_ret = parse_krb5_flags(interp, argv[7], &princ->attributes))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing attributes\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[8], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing kvno\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->kvno = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[9], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing mkvno\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->mkvno = tmp;\n\n     if ((tcl_ret = parse_str(interp, argv[10], &princ->policy)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     if(princ->policy != NULL) {\n\tif(!(princ->policy = strdup(princ->policy))) {\n\t    fprintf(stderr, \"Out of memory!\\n\");\n\t    exit(1);\n\t}\n     }\n\n     if ((tcl_ret = parse_aux_attributes(interp, argv[11],\n\t\t\t\t\t &princ->aux_attributes)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing aux_attributes\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\nfinished:\n     free(argv);\n     *out_princ = princ;\n     return retcode;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static krb5_context context;",
      "struct flagval aux_attributes[] = {\n     {\"OVSEC_KADM_POLICY\",   OVSEC_KADM_POLICY}\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "argv"
          ],
          "line": 784
        },
        "resolved": true,
        "details": {
          "function_name": "free_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "939-943",
          "snippet": "static void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing aux_attributes\""
          ],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_aux_attributes",
          "args": [
            "interp",
            "argv[11]",
            "&princ->aux_attributes"
          ],
          "line": 776
        },
        "resolved": true,
        "details": {
          "function_name": "parse_aux_attributes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "514-529",
          "snippet": "static int parse_aux_attributes(Tcl_Interp *interp, char *str, long *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, aux_attributes,\n\t\t\t\tsizeof(aux_attributes) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct flagval aux_attributes[] = {\n     {\"OVSEC_KADM_POLICY\",   OVSEC_KADM_POLICY}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstruct flagval aux_attributes[] = {\n     {\"OVSEC_KADM_POLICY\",   OVSEC_KADM_POLICY}\n};\n\nstatic int parse_aux_attributes(Tcl_Interp *interp, char *str, long *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, aux_attributes,\n\t\t\t\tsizeof(aux_attributes) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "request_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/server/ovsec_kadmd.c",
          "lines": "841-846",
          "snippet": "void request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}",
          "includes": [
            "#include    \"purify.h\"",
            "#include    \"misc.h\"",
            "#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */",
            "#include    <string.h>",
            "#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */",
            "#include    <krb5/adm_proto.h>",
            "#include    <kadm5/server_acl.h>",
            "#include    <kadm5/kadm_rpc.h>",
            "#include    <kadm5/admin.h>",
            "#include    <gssrpc/auth_gssapi.h>",
            "#include    \"gssapiP_krb5.h\" /* for kg_get_context */",
            "#include    <gssapi/gssapi.h>",
            "#include    <gssrpc/rpc.h>",
            "#include    <arpa/inet.h>  /* inet_ntoa */",
            "#include    <netinet/in.h>",
            "#include    <unistd.h>",
            "#include    <sys/socket.h>",
            "#include    <sys/time.h>",
            "#include    <sys/select.h>",
            "#include    <sys/types.h>",
            "#include    <syslog.h>",
            "#include    <signal.h>",
            "#include    <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "volatile int\tsignal_request_exit = 0;",
            "void\trequest_exit(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include    \"purify.h\"\n#include    \"misc.h\"\n#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */\n#include    <string.h>\n#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */\n#include    <krb5/adm_proto.h>\n#include    <kadm5/server_acl.h>\n#include    <kadm5/kadm_rpc.h>\n#include    <kadm5/admin.h>\n#include    <gssrpc/auth_gssapi.h>\n#include    \"gssapiP_krb5.h\" /* for kg_get_context */\n#include    <gssapi/gssapi.h>\n#include    <gssrpc/rpc.h>\n#include    <arpa/inet.h>  /* inet_ntoa */\n#include    <netinet/in.h>\n#include    <unistd.h>\n#include    <sys/socket.h>\n#include    <sys/time.h>\n#include    <sys/select.h>\n#include    <sys/types.h>\n#include    <syslog.h>\n#include    <signal.h>\n#include    <stdio.h>\n\nvolatile int\tsignal_request_exit = 0;\nvoid\trequest_exit(int);\n\nvoid request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "princ->policy"
          ],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing policy\""
          ],
          "line": 765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_str",
          "args": [
            "interp",
            "argv[10]",
            "&princ->policy"
          ],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "parse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "229-241",
          "snippet": "static int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing mkvno\""
          ],
          "line": 758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetInt",
          "args": [
            "interp",
            "argv[9]",
            "&tmp"
          ],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing kvno\""
          ],
          "line": 750
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetInt",
          "args": [
            "interp",
            "argv[8]",
            "&tmp"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing attributes\""
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_krb5_flags",
          "args": [
            "interp",
            "argv[7]",
            "&princ->attributes"
          ],
          "line": 741
        },
        "resolved": true,
        "details": {
          "function_name": "parse_krb5_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "490-505",
          "snippet": "static int parse_krb5_flags(Tcl_Interp *interp, char *str, krb5_flags *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, krb5_flags_array,\n\t\t\t\tsizeof(krb5_flags_array) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct flagval krb5_flags_array[] = {\n     {\"KRB5_KDB_DISALLOW_POSTDATED\", KRB5_KDB_DISALLOW_POSTDATED},\n     {\"KRB5_KDB_DISALLOW_FORWARDABLE\", KRB5_KDB_DISALLOW_FORWARDABLE},\n     {\"KRB5_KDB_DISALLOW_TGT_BASED\", KRB5_KDB_DISALLOW_TGT_BASED},\n     {\"KRB5_KDB_DISALLOW_RENEWABLE\", KRB5_KDB_DISALLOW_RENEWABLE},\n     {\"KRB5_KDB_DISALLOW_PROXIABLE\", KRB5_KDB_DISALLOW_PROXIABLE},\n     {\"KRB5_KDB_DISALLOW_DUP_SKEY\", KRB5_KDB_DISALLOW_DUP_SKEY},\n     {\"KRB5_KDB_DISALLOW_ALL_TIX\", KRB5_KDB_DISALLOW_ALL_TIX},\n     {\"KRB5_KDB_REQUIRES_PRE_AUTH\", KRB5_KDB_REQUIRES_PRE_AUTH},\n     {\"KRB5_KDB_REQUIRES_HW_AUTH\", KRB5_KDB_REQUIRES_HW_AUTH},\n     {\"KRB5_KDB_REQUIRES_PWCHANGE\", KRB5_KDB_REQUIRES_PWCHANGE},\n     {\"KRB5_KDB_DISALLOW_SVR\", KRB5_KDB_DISALLOW_SVR},\n     {\"KRB5_KDB_PWCHANGE_SERVICE\", KRB5_KDB_PWCHANGE_SERVICE}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstruct flagval krb5_flags_array[] = {\n     {\"KRB5_KDB_DISALLOW_POSTDATED\", KRB5_KDB_DISALLOW_POSTDATED},\n     {\"KRB5_KDB_DISALLOW_FORWARDABLE\", KRB5_KDB_DISALLOW_FORWARDABLE},\n     {\"KRB5_KDB_DISALLOW_TGT_BASED\", KRB5_KDB_DISALLOW_TGT_BASED},\n     {\"KRB5_KDB_DISALLOW_RENEWABLE\", KRB5_KDB_DISALLOW_RENEWABLE},\n     {\"KRB5_KDB_DISALLOW_PROXIABLE\", KRB5_KDB_DISALLOW_PROXIABLE},\n     {\"KRB5_KDB_DISALLOW_DUP_SKEY\", KRB5_KDB_DISALLOW_DUP_SKEY},\n     {\"KRB5_KDB_DISALLOW_ALL_TIX\", KRB5_KDB_DISALLOW_ALL_TIX},\n     {\"KRB5_KDB_REQUIRES_PRE_AUTH\", KRB5_KDB_REQUIRES_PRE_AUTH},\n     {\"KRB5_KDB_REQUIRES_HW_AUTH\", KRB5_KDB_REQUIRES_HW_AUTH},\n     {\"KRB5_KDB_REQUIRES_PWCHANGE\", KRB5_KDB_REQUIRES_PWCHANGE},\n     {\"KRB5_KDB_DISALLOW_SVR\", KRB5_KDB_DISALLOW_SVR},\n     {\"KRB5_KDB_PWCHANGE_SERVICE\", KRB5_KDB_PWCHANGE_SERVICE}\n};\n\nstatic int parse_krb5_flags(Tcl_Interp *interp, char *str, krb5_flags *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, krb5_flags_array,\n\t\t\t\tsizeof(krb5_flags_array) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing mod_date\""
          ],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetInt",
          "args": [
            "interp",
            "argv[6]",
            "&tmp"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing mod_name\""
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stash_error",
          "args": [
            "interp",
            "krb5_ret"
          ],
          "line": 727
        },
        "resolved": true,
        "details": {
          "function_name": "stash_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "407-413",
          "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
        }
      },
      {
        "call_info": {
          "callee": "krb5_parse_name",
          "args": [
            "context",
            "argv[5]",
            "&princ->mod_name"
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing max_life\""
          ],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetInt",
          "args": [
            "interp",
            "argv[4]",
            "&tmp"
          ],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing pw_expiration\""
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetInt",
          "args": [
            "interp",
            "argv[3]",
            "&tmp"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing last_pwd_change\""
          ],
          "line": 704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetInt",
          "args": [
            "interp",
            "argv[2]",
            "&tmp"
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing princ_expire_time\""
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetInt",
          "args": [
            "interp",
            "argv[1]",
            "&tmp"
          ],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"while parsing principal\""
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krb5_parse_name",
          "args": [
            "context",
            "argv[0]",
            "&princ->principal"
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof *princ"
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "interp->result",
            "\"wrong # args in principal structure (%d should be 12)\"",
            "argc"
          ],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SplitList",
          "args": [
            "interp",
            "list",
            "&argc",
            "&argv"
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic krb5_context context;\nstruct flagval aux_attributes[] = {\n     {\"OVSEC_KADM_POLICY\",   OVSEC_KADM_POLICY}\n};\n\nstatic int parse_principal_ent(Tcl_Interp *interp, char *list,\n\t\t\t       ovsec_kadm_principal_ent_t *out_princ)\n{\n     ovsec_kadm_principal_ent_t princ;\n     krb5_error_code krb5_ret;\n     int tcl_ret;\n     int argc;\n     char **argv;\n     int tmp;\n     int retcode = TCL_OK;\n\n     if ((tcl_ret = Tcl_SplitList(interp, list, &argc, &argv)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     if (argc != 12) {\n\t  sprintf(interp->result, \"wrong # args in principal structure (%d should be 12)\",\n\t\t  argc);\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if (! (princ = malloc(sizeof *princ))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n  \n     if ((krb5_ret = krb5_parse_name(context, argv[0], &princ->principal)) != 0) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing principal\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     /*\n      * All of the numerical values parsed here are parsed into an\n      * \"int\" and then assigned into the structure in case the actual\n      * width of the field in the Kerberos structure is different from\n      * the width of an integer.\n      */\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[1], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing princ_expire_time\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->princ_expire_time = tmp;\n     \n     if ((tcl_ret = Tcl_GetInt(interp, argv[2], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing last_pwd_change\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->last_pwd_change = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[3], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing pw_expiration\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->pw_expiration = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[4], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing max_life\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->max_life = tmp;\n\n     if ((krb5_ret = krb5_parse_name(context, argv[5], &princ->mod_name)) != 0) {\n\t  stash_error(interp, krb5_ret);\n\t  Tcl_AppendElement(interp, \"while parsing mod_name\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\t  \n     if ((tcl_ret = Tcl_GetInt(interp, argv[6], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing mod_date\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->mod_date = tmp;\n\n     if ((tcl_ret = parse_krb5_flags(interp, argv[7], &princ->attributes))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing attributes\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[8], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing kvno\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->kvno = tmp;\n\n     if ((tcl_ret = Tcl_GetInt(interp, argv[9], &tmp))\n\t != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing mkvno\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     princ->mkvno = tmp;\n\n     if ((tcl_ret = parse_str(interp, argv[10], &princ->policy)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing policy\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n     if(princ->policy != NULL) {\n\tif(!(princ->policy = strdup(princ->policy))) {\n\t    fprintf(stderr, \"Out of memory!\\n\");\n\t    exit(1);\n\t}\n     }\n\n     if ((tcl_ret = parse_aux_attributes(interp, argv[11],\n\t\t\t\t\t &princ->aux_attributes)) != TCL_OK) {\n\t  Tcl_AppendElement(interp, \"while parsing aux_attributes\");\n\t  retcode = TCL_ERROR;\n\t  goto finished;\n     }\n\nfinished:\n     free(argv);\n     *out_princ = princ;\n     return retcode;\n}"
  },
  {
    "function_name": "unparse_principal_ent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "567-649",
    "snippet": "static Tcl_DString *unparse_principal_ent(ovsec_kadm_principal_ent_t princ)\n{\n     Tcl_DString *str, *tmp_dstring;\n     char *tmp;\n     char buf[20];\n     krb5_error_code krb5_ret;\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     tmp = 0; /* It looks to me from looking at the library source */\n\t      /* code for krb5_parse_name that the pointer passed into */\n\t      /* it should be initialized to 0 if I want it do be */\n\t      /* allocated automatically. */\n     krb5_ret = krb5_unparse_name(context, princ->principal, &tmp);\n     if (krb5_ret) {\n\t  /* XXX Do we want to return an error?  Not sure. */\n\t  Tcl_DStringAppendElement(str, \"[unparseable principal]\");\n     }\n     else {\n\t  Tcl_DStringAppendElement(str, tmp);\n\t  free(tmp);\n     }\n\n     sprintf(buf, \"%d\", princ->princ_expire_time);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%d\", princ->last_pwd_change);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%d\", princ->pw_expiration);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%d\", princ->max_life);\n     Tcl_DStringAppendElement(str, buf);\n\n     tmp = 0;\n     krb5_ret = krb5_unparse_name(context, princ->mod_name, &tmp);\n     if (krb5_ret) {\n\t  /* XXX */\n\t  Tcl_DStringAppendElement(str, \"[unparseable principal]\");\n     }\n     else {\n\t  Tcl_DStringAppendElement(str, tmp);\n\t  free(tmp);\n     }\n\n     sprintf(buf, \"%d\", princ->mod_date);\n     Tcl_DStringAppendElement(str, buf);\n\n     tmp_dstring = unparse_krb5_flags(princ->attributes);\n     Tcl_DStringAppendElement(str, tmp_dstring->string);\n     Tcl_DStringFree(tmp_dstring);\n     free(tmp_dstring);\n\n     sprintf(buf, \"%d\", princ->kvno);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%d\", princ->mkvno);\n     Tcl_DStringAppendElement(str, buf);\n\n     /* XXX This may be dangerous, because the contents of the policy */\n     /* field are undefined if the POLICY bit isn't set.  However, I */\n     /* think it's a bug for the field not to be null in that case */\n     /* anyway, so we should assume that it will be null so that we'll */\n     /* catch it if it isn't. */\n     \n     tmp_dstring = unparse_str(princ->policy);\n     Tcl_DStringAppendElement(str, tmp_dstring->string);\n     Tcl_DStringFree(tmp_dstring);\n     free(tmp_dstring);\n\n     tmp_dstring = unparse_aux_attributes(princ->aux_attributes);\n     Tcl_DStringAppendElement(str, tmp_dstring->string);\n     Tcl_DStringFree(tmp_dstring);\n     free(tmp_dstring);\n\n     return str;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static krb5_context context;",
      "struct flagval aux_attributes[] = {\n     {\"OVSEC_KADM_POLICY\",   OVSEC_KADM_POLICY}\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "tmp_dstring"
          ],
          "line": 646
        },
        "resolved": true,
        "details": {
          "function_name": "free_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "939-943",
          "snippet": "static void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_DStringFree",
          "args": [
            "tmp_dstring"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "tmp_dstring->string"
          ],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unparse_aux_attributes",
          "args": [
            "princ->aux_attributes"
          ],
          "line": 643
        },
        "resolved": true,
        "details": {
          "function_name": "unparse_aux_attributes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "507-511",
          "snippet": "static Tcl_DString *unparse_aux_attributes(krb5_int32 flags)\n{\n     return unparse_flags(aux_attributes, sizeof(aux_attributes) /\n\t\t\t  sizeof(struct flagval), flags);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct flagval aux_attributes[] = {\n     {\"OVSEC_KADM_POLICY\",   OVSEC_KADM_POLICY}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstruct flagval aux_attributes[] = {\n     {\"OVSEC_KADM_POLICY\",   OVSEC_KADM_POLICY}\n};\n\nstatic Tcl_DString *unparse_aux_attributes(krb5_int32 flags)\n{\n     return unparse_flags(aux_attributes, sizeof(aux_attributes) /\n\t\t\t  sizeof(struct flagval), flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_DStringFree",
          "args": [
            "tmp_dstring"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "tmp_dstring->string"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unparse_str",
          "args": [
            "princ->policy"
          ],
          "line": 638
        },
        "resolved": true,
        "details": {
          "function_name": "unparse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "206-225",
          "snippet": "static Tcl_DString *unparse_str(char *in_str)\n{\n     Tcl_DString *str;\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     if (! in_str) {\n\t  Tcl_DStringAppend(str, \"null\", -1);\n     }\n     else {\n\t  Tcl_DStringAppend(str, in_str, -1);\n     }\n\n     return str;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_DString *unparse_str(char *in_str)\n{\n     Tcl_DString *str;\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     if (! in_str) {\n\t  Tcl_DStringAppend(str, \"null\", -1);\n     }\n     else {\n\t  Tcl_DStringAppend(str, in_str, -1);\n     }\n\n     return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "buf"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\"",
            "princ->mkvno"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "buf"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\"",
            "princ->kvno"
          ],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringFree",
          "args": [
            "tmp_dstring"
          ],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "tmp_dstring->string"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unparse_krb5_flags",
          "args": [
            "princ->attributes"
          ],
          "line": 621
        },
        "resolved": true,
        "details": {
          "function_name": "unparse_krb5_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "484-488",
          "snippet": "static Tcl_DString *unparse_krb5_flags(krb5_flags flags)\n{\n     return unparse_flags(krb5_flags_array, sizeof(krb5_flags_array) /\n\t\t\t  sizeof(struct flagval), flags);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct flagval krb5_flags_array[] = {\n     {\"KRB5_KDB_DISALLOW_POSTDATED\", KRB5_KDB_DISALLOW_POSTDATED},\n     {\"KRB5_KDB_DISALLOW_FORWARDABLE\", KRB5_KDB_DISALLOW_FORWARDABLE},\n     {\"KRB5_KDB_DISALLOW_TGT_BASED\", KRB5_KDB_DISALLOW_TGT_BASED},\n     {\"KRB5_KDB_DISALLOW_RENEWABLE\", KRB5_KDB_DISALLOW_RENEWABLE},\n     {\"KRB5_KDB_DISALLOW_PROXIABLE\", KRB5_KDB_DISALLOW_PROXIABLE},\n     {\"KRB5_KDB_DISALLOW_DUP_SKEY\", KRB5_KDB_DISALLOW_DUP_SKEY},\n     {\"KRB5_KDB_DISALLOW_ALL_TIX\", KRB5_KDB_DISALLOW_ALL_TIX},\n     {\"KRB5_KDB_REQUIRES_PRE_AUTH\", KRB5_KDB_REQUIRES_PRE_AUTH},\n     {\"KRB5_KDB_REQUIRES_HW_AUTH\", KRB5_KDB_REQUIRES_HW_AUTH},\n     {\"KRB5_KDB_REQUIRES_PWCHANGE\", KRB5_KDB_REQUIRES_PWCHANGE},\n     {\"KRB5_KDB_DISALLOW_SVR\", KRB5_KDB_DISALLOW_SVR},\n     {\"KRB5_KDB_PWCHANGE_SERVICE\", KRB5_KDB_PWCHANGE_SERVICE}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstruct flagval krb5_flags_array[] = {\n     {\"KRB5_KDB_DISALLOW_POSTDATED\", KRB5_KDB_DISALLOW_POSTDATED},\n     {\"KRB5_KDB_DISALLOW_FORWARDABLE\", KRB5_KDB_DISALLOW_FORWARDABLE},\n     {\"KRB5_KDB_DISALLOW_TGT_BASED\", KRB5_KDB_DISALLOW_TGT_BASED},\n     {\"KRB5_KDB_DISALLOW_RENEWABLE\", KRB5_KDB_DISALLOW_RENEWABLE},\n     {\"KRB5_KDB_DISALLOW_PROXIABLE\", KRB5_KDB_DISALLOW_PROXIABLE},\n     {\"KRB5_KDB_DISALLOW_DUP_SKEY\", KRB5_KDB_DISALLOW_DUP_SKEY},\n     {\"KRB5_KDB_DISALLOW_ALL_TIX\", KRB5_KDB_DISALLOW_ALL_TIX},\n     {\"KRB5_KDB_REQUIRES_PRE_AUTH\", KRB5_KDB_REQUIRES_PRE_AUTH},\n     {\"KRB5_KDB_REQUIRES_HW_AUTH\", KRB5_KDB_REQUIRES_HW_AUTH},\n     {\"KRB5_KDB_REQUIRES_PWCHANGE\", KRB5_KDB_REQUIRES_PWCHANGE},\n     {\"KRB5_KDB_DISALLOW_SVR\", KRB5_KDB_DISALLOW_SVR},\n     {\"KRB5_KDB_PWCHANGE_SERVICE\", KRB5_KDB_PWCHANGE_SERVICE}\n};\n\nstatic Tcl_DString *unparse_krb5_flags(krb5_flags flags)\n{\n     return unparse_flags(krb5_flags_array, sizeof(krb5_flags_array) /\n\t\t\t  sizeof(struct flagval), flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "buf"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\"",
            "princ->mod_date"
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "tmp"
          ],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "\"[unparseable principal]\""
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krb5_unparse_name",
          "args": [
            "context",
            "princ->mod_name",
            "&tmp"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "buf"
          ],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\"",
            "princ->max_life"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "buf"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\"",
            "princ->pw_expiration"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "buf"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\"",
            "princ->last_pwd_change"
          ],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "buf"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%d\"",
            "princ->princ_expire_time"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "tmp"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "\"[unparseable principal]\""
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krb5_unparse_name",
          "args": [
            "context",
            "princ->principal",
            "&tmp"
          ],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringInit",
          "args": [
            "str"
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "request_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/server/ovsec_kadmd.c",
          "lines": "841-846",
          "snippet": "void request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}",
          "includes": [
            "#include    \"purify.h\"",
            "#include    \"misc.h\"",
            "#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */",
            "#include    <string.h>",
            "#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */",
            "#include    <krb5/adm_proto.h>",
            "#include    <kadm5/server_acl.h>",
            "#include    <kadm5/kadm_rpc.h>",
            "#include    <kadm5/admin.h>",
            "#include    <gssrpc/auth_gssapi.h>",
            "#include    \"gssapiP_krb5.h\" /* for kg_get_context */",
            "#include    <gssapi/gssapi.h>",
            "#include    <gssrpc/rpc.h>",
            "#include    <arpa/inet.h>  /* inet_ntoa */",
            "#include    <netinet/in.h>",
            "#include    <unistd.h>",
            "#include    <sys/socket.h>",
            "#include    <sys/time.h>",
            "#include    <sys/select.h>",
            "#include    <sys/types.h>",
            "#include    <syslog.h>",
            "#include    <signal.h>",
            "#include    <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "volatile int\tsignal_request_exit = 0;",
            "void\trequest_exit(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include    \"purify.h\"\n#include    \"misc.h\"\n#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */\n#include    <string.h>\n#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */\n#include    <krb5/adm_proto.h>\n#include    <kadm5/server_acl.h>\n#include    <kadm5/kadm_rpc.h>\n#include    <kadm5/admin.h>\n#include    <gssrpc/auth_gssapi.h>\n#include    \"gssapiP_krb5.h\" /* for kg_get_context */\n#include    <gssapi/gssapi.h>\n#include    <gssrpc/rpc.h>\n#include    <arpa/inet.h>  /* inet_ntoa */\n#include    <netinet/in.h>\n#include    <unistd.h>\n#include    <sys/socket.h>\n#include    <sys/time.h>\n#include    <sys/select.h>\n#include    <sys/types.h>\n#include    <syslog.h>\n#include    <signal.h>\n#include    <stdio.h>\n\nvolatile int\tsignal_request_exit = 0;\nvoid\trequest_exit(int);\n\nvoid request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*str)"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic krb5_context context;\nstruct flagval aux_attributes[] = {\n     {\"OVSEC_KADM_POLICY\",   OVSEC_KADM_POLICY}\n};\n\nstatic Tcl_DString *unparse_principal_ent(ovsec_kadm_principal_ent_t princ)\n{\n     Tcl_DString *str, *tmp_dstring;\n     char *tmp;\n     char buf[20];\n     krb5_error_code krb5_ret;\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     tmp = 0; /* It looks to me from looking at the library source */\n\t      /* code for krb5_parse_name that the pointer passed into */\n\t      /* it should be initialized to 0 if I want it do be */\n\t      /* allocated automatically. */\n     krb5_ret = krb5_unparse_name(context, princ->principal, &tmp);\n     if (krb5_ret) {\n\t  /* XXX Do we want to return an error?  Not sure. */\n\t  Tcl_DStringAppendElement(str, \"[unparseable principal]\");\n     }\n     else {\n\t  Tcl_DStringAppendElement(str, tmp);\n\t  free(tmp);\n     }\n\n     sprintf(buf, \"%d\", princ->princ_expire_time);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%d\", princ->last_pwd_change);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%d\", princ->pw_expiration);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%d\", princ->max_life);\n     Tcl_DStringAppendElement(str, buf);\n\n     tmp = 0;\n     krb5_ret = krb5_unparse_name(context, princ->mod_name, &tmp);\n     if (krb5_ret) {\n\t  /* XXX */\n\t  Tcl_DStringAppendElement(str, \"[unparseable principal]\");\n     }\n     else {\n\t  Tcl_DStringAppendElement(str, tmp);\n\t  free(tmp);\n     }\n\n     sprintf(buf, \"%d\", princ->mod_date);\n     Tcl_DStringAppendElement(str, buf);\n\n     tmp_dstring = unparse_krb5_flags(princ->attributes);\n     Tcl_DStringAppendElement(str, tmp_dstring->string);\n     Tcl_DStringFree(tmp_dstring);\n     free(tmp_dstring);\n\n     sprintf(buf, \"%d\", princ->kvno);\n     Tcl_DStringAppendElement(str, buf);\n\n     sprintf(buf, \"%d\", princ->mkvno);\n     Tcl_DStringAppendElement(str, buf);\n\n     /* XXX This may be dangerous, because the contents of the policy */\n     /* field are undefined if the POLICY bit isn't set.  However, I */\n     /* think it's a bug for the field not to be null in that case */\n     /* anyway, so we should assume that it will be null so that we'll */\n     /* catch it if it isn't. */\n     \n     tmp_dstring = unparse_str(princ->policy);\n     Tcl_DStringAppendElement(str, tmp_dstring->string);\n     Tcl_DStringFree(tmp_dstring);\n     free(tmp_dstring);\n\n     tmp_dstring = unparse_aux_attributes(princ->aux_attributes);\n     Tcl_DStringAppendElement(str, tmp_dstring->string);\n     Tcl_DStringFree(tmp_dstring);\n     free(tmp_dstring);\n\n     return str;\n}"
  },
  {
    "function_name": "parse_policy_mask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "549-564",
    "snippet": "static int parse_policy_mask(Tcl_Interp *interp, char *str, krb5_int32 *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, policy_mask_flags,\n\t\t\t\tsizeof(policy_mask_flags) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct flagval policy_mask_flags[] = {\n     {\"OVSEC_KADM_POLICY\", OVSEC_KADM_POLICY},\n     {\"OVSEC_KADM_PW_MAX_LIFE\", OVSEC_KADM_PW_MAX_LIFE},\n     {\"OVSEC_KADM_PW_MIN_LIFE\", OVSEC_KADM_PW_MIN_LIFE},\n     {\"OVSEC_KADM_PW_MIN_LENGTH\", OVSEC_KADM_PW_MIN_LENGTH},\n     {\"OVSEC_KADM_PW_MIN_CLASSES\", OVSEC_KADM_PW_MIN_CLASSES},\n     {\"OVSEC_KADM_PW_HISTORY_NUM\", OVSEC_KADM_PW_HISTORY_NUM},\n     {\"OVSEC_KADM_REF_COUNT\", OVSEC_KADM_REF_COUNT}\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "parse_flags",
          "args": [
            "interp",
            "table",
            "policy_mask_flags",
            "sizeof(policy_mask_flags) /\n\t\t\t\tsizeof(struct flagval)",
            "str",
            "&tmp"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "parse_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "440-475",
          "snippet": "static int parse_flags(Tcl_Interp *interp, Tcl_HashTable *table,\n\t\t       struct flagval *array, int size, char *str,\n\t\t       krb5_flags *flags)\n{\n     int tmp, argc, i, retcode = TCL_OK;\n     char **argv;\n     Tcl_HashEntry *entry;\n\n     if (Tcl_GetInt(interp, str, &tmp) == TCL_OK) {\n\t  *flags = tmp;\n\t  return TCL_OK;\n     }\n     Tcl_ResetResult(interp);\n\n     if (Tcl_SplitList(interp, str, &argc, &argv) != TCL_OK) {\n\t  return TCL_ERROR;\n     }\n\n     if (! table) {\n\t  table = create_flag_table(array, size);\n     }\n\n     *flags = 0;\n\n     for (i = 0; i < argc; i++) {\n\t  if (! (entry = Tcl_FindHashEntry(table, argv[i]))) {\n\t       Tcl_AppendResult(interp, \"unknown krb5 flag \", argv[i], 0);\n\t       retcode = TCL_ERROR;\n\t       break;\n\t  }\n\t  *flags |= *(krb5_flags *) Tcl_GetHashValue(entry);\n     }\n  \n     free(argv);\n     return(retcode);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_flags(Tcl_Interp *interp, Tcl_HashTable *table,\n\t\t       struct flagval *array, int size, char *str,\n\t\t       krb5_flags *flags)\n{\n     int tmp, argc, i, retcode = TCL_OK;\n     char **argv;\n     Tcl_HashEntry *entry;\n\n     if (Tcl_GetInt(interp, str, &tmp) == TCL_OK) {\n\t  *flags = tmp;\n\t  return TCL_OK;\n     }\n     Tcl_ResetResult(interp);\n\n     if (Tcl_SplitList(interp, str, &argc, &argv) != TCL_OK) {\n\t  return TCL_ERROR;\n     }\n\n     if (! table) {\n\t  table = create_flag_table(array, size);\n     }\n\n     *flags = 0;\n\n     for (i = 0; i < argc; i++) {\n\t  if (! (entry = Tcl_FindHashEntry(table, argv[i]))) {\n\t       Tcl_AppendResult(interp, \"unknown krb5 flag \", argv[i], 0);\n\t       retcode = TCL_ERROR;\n\t       break;\n\t  }\n\t  *flags |= *(krb5_flags *) Tcl_GetHashValue(entry);\n     }\n  \n     free(argv);\n     return(retcode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstruct flagval policy_mask_flags[] = {\n     {\"OVSEC_KADM_POLICY\", OVSEC_KADM_POLICY},\n     {\"OVSEC_KADM_PW_MAX_LIFE\", OVSEC_KADM_PW_MAX_LIFE},\n     {\"OVSEC_KADM_PW_MIN_LIFE\", OVSEC_KADM_PW_MIN_LIFE},\n     {\"OVSEC_KADM_PW_MIN_LENGTH\", OVSEC_KADM_PW_MIN_LENGTH},\n     {\"OVSEC_KADM_PW_MIN_CLASSES\", OVSEC_KADM_PW_MIN_CLASSES},\n     {\"OVSEC_KADM_PW_HISTORY_NUM\", OVSEC_KADM_PW_HISTORY_NUM},\n     {\"OVSEC_KADM_REF_COUNT\", OVSEC_KADM_REF_COUNT}\n};\n\nstatic int parse_policy_mask(Tcl_Interp *interp, char *str, krb5_int32 *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, policy_mask_flags,\n\t\t\t\tsizeof(policy_mask_flags) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}"
  },
  {
    "function_name": "parse_principal_mask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "531-546",
    "snippet": "static int parse_principal_mask(Tcl_Interp *interp, char *str, krb5_int32 *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, principal_mask_flags,\n\t\t\t\tsizeof(principal_mask_flags) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct flagval principal_mask_flags[] = {\n     {\"OVSEC_KADM_PRINCIPAL\", OVSEC_KADM_PRINCIPAL},\n     {\"OVSEC_KADM_PRINC_EXPIRE_TIME\", OVSEC_KADM_PRINC_EXPIRE_TIME},\n     {\"OVSEC_KADM_PW_EXPIRATION\", OVSEC_KADM_PW_EXPIRATION},\n     {\"OVSEC_KADM_LAST_PWD_CHANGE\", OVSEC_KADM_LAST_PWD_CHANGE},\n     {\"OVSEC_KADM_ATTRIBUTES\", OVSEC_KADM_ATTRIBUTES},\n     {\"OVSEC_KADM_MAX_LIFE\", OVSEC_KADM_MAX_LIFE},\n     {\"OVSEC_KADM_MOD_TIME\", OVSEC_KADM_MOD_TIME},\n     {\"OVSEC_KADM_MOD_NAME\", OVSEC_KADM_MOD_NAME},\n     {\"OVSEC_KADM_KVNO\", OVSEC_KADM_KVNO},\n     {\"OVSEC_KADM_MKVNO\", OVSEC_KADM_MKVNO},\n     {\"OVSEC_KADM_AUX_ATTRIBUTES\", OVSEC_KADM_AUX_ATTRIBUTES},\n     {\"OVSEC_KADM_POLICY\", OVSEC_KADM_POLICY},\n     {\"OVSEC_KADM_POLICY_CLR\", OVSEC_KADM_POLICY_CLR}\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "parse_flags",
          "args": [
            "interp",
            "table",
            "principal_mask_flags",
            "sizeof(principal_mask_flags) /\n\t\t\t\tsizeof(struct flagval)",
            "str",
            "&tmp"
          ],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "parse_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "440-475",
          "snippet": "static int parse_flags(Tcl_Interp *interp, Tcl_HashTable *table,\n\t\t       struct flagval *array, int size, char *str,\n\t\t       krb5_flags *flags)\n{\n     int tmp, argc, i, retcode = TCL_OK;\n     char **argv;\n     Tcl_HashEntry *entry;\n\n     if (Tcl_GetInt(interp, str, &tmp) == TCL_OK) {\n\t  *flags = tmp;\n\t  return TCL_OK;\n     }\n     Tcl_ResetResult(interp);\n\n     if (Tcl_SplitList(interp, str, &argc, &argv) != TCL_OK) {\n\t  return TCL_ERROR;\n     }\n\n     if (! table) {\n\t  table = create_flag_table(array, size);\n     }\n\n     *flags = 0;\n\n     for (i = 0; i < argc; i++) {\n\t  if (! (entry = Tcl_FindHashEntry(table, argv[i]))) {\n\t       Tcl_AppendResult(interp, \"unknown krb5 flag \", argv[i], 0);\n\t       retcode = TCL_ERROR;\n\t       break;\n\t  }\n\t  *flags |= *(krb5_flags *) Tcl_GetHashValue(entry);\n     }\n  \n     free(argv);\n     return(retcode);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_flags(Tcl_Interp *interp, Tcl_HashTable *table,\n\t\t       struct flagval *array, int size, char *str,\n\t\t       krb5_flags *flags)\n{\n     int tmp, argc, i, retcode = TCL_OK;\n     char **argv;\n     Tcl_HashEntry *entry;\n\n     if (Tcl_GetInt(interp, str, &tmp) == TCL_OK) {\n\t  *flags = tmp;\n\t  return TCL_OK;\n     }\n     Tcl_ResetResult(interp);\n\n     if (Tcl_SplitList(interp, str, &argc, &argv) != TCL_OK) {\n\t  return TCL_ERROR;\n     }\n\n     if (! table) {\n\t  table = create_flag_table(array, size);\n     }\n\n     *flags = 0;\n\n     for (i = 0; i < argc; i++) {\n\t  if (! (entry = Tcl_FindHashEntry(table, argv[i]))) {\n\t       Tcl_AppendResult(interp, \"unknown krb5 flag \", argv[i], 0);\n\t       retcode = TCL_ERROR;\n\t       break;\n\t  }\n\t  *flags |= *(krb5_flags *) Tcl_GetHashValue(entry);\n     }\n  \n     free(argv);\n     return(retcode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstruct flagval principal_mask_flags[] = {\n     {\"OVSEC_KADM_PRINCIPAL\", OVSEC_KADM_PRINCIPAL},\n     {\"OVSEC_KADM_PRINC_EXPIRE_TIME\", OVSEC_KADM_PRINC_EXPIRE_TIME},\n     {\"OVSEC_KADM_PW_EXPIRATION\", OVSEC_KADM_PW_EXPIRATION},\n     {\"OVSEC_KADM_LAST_PWD_CHANGE\", OVSEC_KADM_LAST_PWD_CHANGE},\n     {\"OVSEC_KADM_ATTRIBUTES\", OVSEC_KADM_ATTRIBUTES},\n     {\"OVSEC_KADM_MAX_LIFE\", OVSEC_KADM_MAX_LIFE},\n     {\"OVSEC_KADM_MOD_TIME\", OVSEC_KADM_MOD_TIME},\n     {\"OVSEC_KADM_MOD_NAME\", OVSEC_KADM_MOD_NAME},\n     {\"OVSEC_KADM_KVNO\", OVSEC_KADM_KVNO},\n     {\"OVSEC_KADM_MKVNO\", OVSEC_KADM_MKVNO},\n     {\"OVSEC_KADM_AUX_ATTRIBUTES\", OVSEC_KADM_AUX_ATTRIBUTES},\n     {\"OVSEC_KADM_POLICY\", OVSEC_KADM_POLICY},\n     {\"OVSEC_KADM_POLICY_CLR\", OVSEC_KADM_POLICY_CLR}\n};\n\nstatic int parse_principal_mask(Tcl_Interp *interp, char *str, krb5_int32 *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, principal_mask_flags,\n\t\t\t\tsizeof(principal_mask_flags) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}"
  },
  {
    "function_name": "parse_aux_attributes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "514-529",
    "snippet": "static int parse_aux_attributes(Tcl_Interp *interp, char *str, long *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, aux_attributes,\n\t\t\t\tsizeof(aux_attributes) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct flagval aux_attributes[] = {\n     {\"OVSEC_KADM_POLICY\",   OVSEC_KADM_POLICY}\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "parse_flags",
          "args": [
            "interp",
            "table",
            "aux_attributes",
            "sizeof(aux_attributes) /\n\t\t\t\tsizeof(struct flagval)",
            "str",
            "&tmp"
          ],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "parse_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "440-475",
          "snippet": "static int parse_flags(Tcl_Interp *interp, Tcl_HashTable *table,\n\t\t       struct flagval *array, int size, char *str,\n\t\t       krb5_flags *flags)\n{\n     int tmp, argc, i, retcode = TCL_OK;\n     char **argv;\n     Tcl_HashEntry *entry;\n\n     if (Tcl_GetInt(interp, str, &tmp) == TCL_OK) {\n\t  *flags = tmp;\n\t  return TCL_OK;\n     }\n     Tcl_ResetResult(interp);\n\n     if (Tcl_SplitList(interp, str, &argc, &argv) != TCL_OK) {\n\t  return TCL_ERROR;\n     }\n\n     if (! table) {\n\t  table = create_flag_table(array, size);\n     }\n\n     *flags = 0;\n\n     for (i = 0; i < argc; i++) {\n\t  if (! (entry = Tcl_FindHashEntry(table, argv[i]))) {\n\t       Tcl_AppendResult(interp, \"unknown krb5 flag \", argv[i], 0);\n\t       retcode = TCL_ERROR;\n\t       break;\n\t  }\n\t  *flags |= *(krb5_flags *) Tcl_GetHashValue(entry);\n     }\n  \n     free(argv);\n     return(retcode);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_flags(Tcl_Interp *interp, Tcl_HashTable *table,\n\t\t       struct flagval *array, int size, char *str,\n\t\t       krb5_flags *flags)\n{\n     int tmp, argc, i, retcode = TCL_OK;\n     char **argv;\n     Tcl_HashEntry *entry;\n\n     if (Tcl_GetInt(interp, str, &tmp) == TCL_OK) {\n\t  *flags = tmp;\n\t  return TCL_OK;\n     }\n     Tcl_ResetResult(interp);\n\n     if (Tcl_SplitList(interp, str, &argc, &argv) != TCL_OK) {\n\t  return TCL_ERROR;\n     }\n\n     if (! table) {\n\t  table = create_flag_table(array, size);\n     }\n\n     *flags = 0;\n\n     for (i = 0; i < argc; i++) {\n\t  if (! (entry = Tcl_FindHashEntry(table, argv[i]))) {\n\t       Tcl_AppendResult(interp, \"unknown krb5 flag \", argv[i], 0);\n\t       retcode = TCL_ERROR;\n\t       break;\n\t  }\n\t  *flags |= *(krb5_flags *) Tcl_GetHashValue(entry);\n     }\n  \n     free(argv);\n     return(retcode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstruct flagval aux_attributes[] = {\n     {\"OVSEC_KADM_POLICY\",   OVSEC_KADM_POLICY}\n};\n\nstatic int parse_aux_attributes(Tcl_Interp *interp, char *str, long *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, aux_attributes,\n\t\t\t\tsizeof(aux_attributes) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}"
  },
  {
    "function_name": "unparse_aux_attributes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "507-511",
    "snippet": "static Tcl_DString *unparse_aux_attributes(krb5_int32 flags)\n{\n     return unparse_flags(aux_attributes, sizeof(aux_attributes) /\n\t\t\t  sizeof(struct flagval), flags);\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct flagval aux_attributes[] = {\n     {\"OVSEC_KADM_POLICY\",   OVSEC_KADM_POLICY}\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unparse_flags",
          "args": [
            "aux_attributes",
            "sizeof(aux_attributes) /\n\t\t\t  sizeof(struct flagval)",
            "flags"
          ],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "unparse_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "417-437",
          "snippet": "static Tcl_DString *unparse_flags(struct flagval *array, int size,\n\t\t\t\t  krb5_int32 flags)\n{\n     int i;\n     Tcl_DString *str;\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     for (i = 0; i < size; i++) {\n\t  if (flags & array[i].val) {\n\t       Tcl_DStringAppendElement(str, array[i].name);\n\t  }\n     }\n\n     return str;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_DString *unparse_flags(struct flagval *array, int size,\n\t\t\t\t  krb5_int32 flags)\n{\n     int i;\n     Tcl_DString *str;\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     for (i = 0; i < size; i++) {\n\t  if (flags & array[i].val) {\n\t       Tcl_DStringAppendElement(str, array[i].name);\n\t  }\n     }\n\n     return str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstruct flagval aux_attributes[] = {\n     {\"OVSEC_KADM_POLICY\",   OVSEC_KADM_POLICY}\n};\n\nstatic Tcl_DString *unparse_aux_attributes(krb5_int32 flags)\n{\n     return unparse_flags(aux_attributes, sizeof(aux_attributes) /\n\t\t\t  sizeof(struct flagval), flags);\n}"
  },
  {
    "function_name": "parse_krb5_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "490-505",
    "snippet": "static int parse_krb5_flags(Tcl_Interp *interp, char *str, krb5_flags *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, krb5_flags_array,\n\t\t\t\tsizeof(krb5_flags_array) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct flagval krb5_flags_array[] = {\n     {\"KRB5_KDB_DISALLOW_POSTDATED\", KRB5_KDB_DISALLOW_POSTDATED},\n     {\"KRB5_KDB_DISALLOW_FORWARDABLE\", KRB5_KDB_DISALLOW_FORWARDABLE},\n     {\"KRB5_KDB_DISALLOW_TGT_BASED\", KRB5_KDB_DISALLOW_TGT_BASED},\n     {\"KRB5_KDB_DISALLOW_RENEWABLE\", KRB5_KDB_DISALLOW_RENEWABLE},\n     {\"KRB5_KDB_DISALLOW_PROXIABLE\", KRB5_KDB_DISALLOW_PROXIABLE},\n     {\"KRB5_KDB_DISALLOW_DUP_SKEY\", KRB5_KDB_DISALLOW_DUP_SKEY},\n     {\"KRB5_KDB_DISALLOW_ALL_TIX\", KRB5_KDB_DISALLOW_ALL_TIX},\n     {\"KRB5_KDB_REQUIRES_PRE_AUTH\", KRB5_KDB_REQUIRES_PRE_AUTH},\n     {\"KRB5_KDB_REQUIRES_HW_AUTH\", KRB5_KDB_REQUIRES_HW_AUTH},\n     {\"KRB5_KDB_REQUIRES_PWCHANGE\", KRB5_KDB_REQUIRES_PWCHANGE},\n     {\"KRB5_KDB_DISALLOW_SVR\", KRB5_KDB_DISALLOW_SVR},\n     {\"KRB5_KDB_PWCHANGE_SERVICE\", KRB5_KDB_PWCHANGE_SERVICE}\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "parse_flags",
          "args": [
            "interp",
            "table",
            "krb5_flags_array",
            "sizeof(krb5_flags_array) /\n\t\t\t\tsizeof(struct flagval)",
            "str",
            "&tmp"
          ],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "parse_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "440-475",
          "snippet": "static int parse_flags(Tcl_Interp *interp, Tcl_HashTable *table,\n\t\t       struct flagval *array, int size, char *str,\n\t\t       krb5_flags *flags)\n{\n     int tmp, argc, i, retcode = TCL_OK;\n     char **argv;\n     Tcl_HashEntry *entry;\n\n     if (Tcl_GetInt(interp, str, &tmp) == TCL_OK) {\n\t  *flags = tmp;\n\t  return TCL_OK;\n     }\n     Tcl_ResetResult(interp);\n\n     if (Tcl_SplitList(interp, str, &argc, &argv) != TCL_OK) {\n\t  return TCL_ERROR;\n     }\n\n     if (! table) {\n\t  table = create_flag_table(array, size);\n     }\n\n     *flags = 0;\n\n     for (i = 0; i < argc; i++) {\n\t  if (! (entry = Tcl_FindHashEntry(table, argv[i]))) {\n\t       Tcl_AppendResult(interp, \"unknown krb5 flag \", argv[i], 0);\n\t       retcode = TCL_ERROR;\n\t       break;\n\t  }\n\t  *flags |= *(krb5_flags *) Tcl_GetHashValue(entry);\n     }\n  \n     free(argv);\n     return(retcode);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_flags(Tcl_Interp *interp, Tcl_HashTable *table,\n\t\t       struct flagval *array, int size, char *str,\n\t\t       krb5_flags *flags)\n{\n     int tmp, argc, i, retcode = TCL_OK;\n     char **argv;\n     Tcl_HashEntry *entry;\n\n     if (Tcl_GetInt(interp, str, &tmp) == TCL_OK) {\n\t  *flags = tmp;\n\t  return TCL_OK;\n     }\n     Tcl_ResetResult(interp);\n\n     if (Tcl_SplitList(interp, str, &argc, &argv) != TCL_OK) {\n\t  return TCL_ERROR;\n     }\n\n     if (! table) {\n\t  table = create_flag_table(array, size);\n     }\n\n     *flags = 0;\n\n     for (i = 0; i < argc; i++) {\n\t  if (! (entry = Tcl_FindHashEntry(table, argv[i]))) {\n\t       Tcl_AppendResult(interp, \"unknown krb5 flag \", argv[i], 0);\n\t       retcode = TCL_ERROR;\n\t       break;\n\t  }\n\t  *flags |= *(krb5_flags *) Tcl_GetHashValue(entry);\n     }\n  \n     free(argv);\n     return(retcode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstruct flagval krb5_flags_array[] = {\n     {\"KRB5_KDB_DISALLOW_POSTDATED\", KRB5_KDB_DISALLOW_POSTDATED},\n     {\"KRB5_KDB_DISALLOW_FORWARDABLE\", KRB5_KDB_DISALLOW_FORWARDABLE},\n     {\"KRB5_KDB_DISALLOW_TGT_BASED\", KRB5_KDB_DISALLOW_TGT_BASED},\n     {\"KRB5_KDB_DISALLOW_RENEWABLE\", KRB5_KDB_DISALLOW_RENEWABLE},\n     {\"KRB5_KDB_DISALLOW_PROXIABLE\", KRB5_KDB_DISALLOW_PROXIABLE},\n     {\"KRB5_KDB_DISALLOW_DUP_SKEY\", KRB5_KDB_DISALLOW_DUP_SKEY},\n     {\"KRB5_KDB_DISALLOW_ALL_TIX\", KRB5_KDB_DISALLOW_ALL_TIX},\n     {\"KRB5_KDB_REQUIRES_PRE_AUTH\", KRB5_KDB_REQUIRES_PRE_AUTH},\n     {\"KRB5_KDB_REQUIRES_HW_AUTH\", KRB5_KDB_REQUIRES_HW_AUTH},\n     {\"KRB5_KDB_REQUIRES_PWCHANGE\", KRB5_KDB_REQUIRES_PWCHANGE},\n     {\"KRB5_KDB_DISALLOW_SVR\", KRB5_KDB_DISALLOW_SVR},\n     {\"KRB5_KDB_PWCHANGE_SERVICE\", KRB5_KDB_PWCHANGE_SERVICE}\n};\n\nstatic int parse_krb5_flags(Tcl_Interp *interp, char *str, krb5_flags *flags)\n{\n     krb5_flags tmp;\n     static Tcl_HashTable *table = 0;\n     int tcl_ret;\n     \n     if ((tcl_ret = parse_flags(interp, table, krb5_flags_array,\n\t\t\t\tsizeof(krb5_flags_array) /\n\t\t\t\tsizeof(struct flagval),\n\t\t\t\tstr, &tmp)) != TCL_OK) {\n\t  return tcl_ret;\n     }\n\n     *flags = tmp;\n     return TCL_OK;\n}"
  },
  {
    "function_name": "unparse_krb5_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "484-488",
    "snippet": "static Tcl_DString *unparse_krb5_flags(krb5_flags flags)\n{\n     return unparse_flags(krb5_flags_array, sizeof(krb5_flags_array) /\n\t\t\t  sizeof(struct flagval), flags);\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct flagval krb5_flags_array[] = {\n     {\"KRB5_KDB_DISALLOW_POSTDATED\", KRB5_KDB_DISALLOW_POSTDATED},\n     {\"KRB5_KDB_DISALLOW_FORWARDABLE\", KRB5_KDB_DISALLOW_FORWARDABLE},\n     {\"KRB5_KDB_DISALLOW_TGT_BASED\", KRB5_KDB_DISALLOW_TGT_BASED},\n     {\"KRB5_KDB_DISALLOW_RENEWABLE\", KRB5_KDB_DISALLOW_RENEWABLE},\n     {\"KRB5_KDB_DISALLOW_PROXIABLE\", KRB5_KDB_DISALLOW_PROXIABLE},\n     {\"KRB5_KDB_DISALLOW_DUP_SKEY\", KRB5_KDB_DISALLOW_DUP_SKEY},\n     {\"KRB5_KDB_DISALLOW_ALL_TIX\", KRB5_KDB_DISALLOW_ALL_TIX},\n     {\"KRB5_KDB_REQUIRES_PRE_AUTH\", KRB5_KDB_REQUIRES_PRE_AUTH},\n     {\"KRB5_KDB_REQUIRES_HW_AUTH\", KRB5_KDB_REQUIRES_HW_AUTH},\n     {\"KRB5_KDB_REQUIRES_PWCHANGE\", KRB5_KDB_REQUIRES_PWCHANGE},\n     {\"KRB5_KDB_DISALLOW_SVR\", KRB5_KDB_DISALLOW_SVR},\n     {\"KRB5_KDB_PWCHANGE_SERVICE\", KRB5_KDB_PWCHANGE_SERVICE}\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unparse_flags",
          "args": [
            "krb5_flags_array",
            "sizeof(krb5_flags_array) /\n\t\t\t  sizeof(struct flagval)",
            "flags"
          ],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "unparse_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "417-437",
          "snippet": "static Tcl_DString *unparse_flags(struct flagval *array, int size,\n\t\t\t\t  krb5_int32 flags)\n{\n     int i;\n     Tcl_DString *str;\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     for (i = 0; i < size; i++) {\n\t  if (flags & array[i].val) {\n\t       Tcl_DStringAppendElement(str, array[i].name);\n\t  }\n     }\n\n     return str;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_DString *unparse_flags(struct flagval *array, int size,\n\t\t\t\t  krb5_int32 flags)\n{\n     int i;\n     Tcl_DString *str;\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     for (i = 0; i < size; i++) {\n\t  if (flags & array[i].val) {\n\t       Tcl_DStringAppendElement(str, array[i].name);\n\t  }\n     }\n\n     return str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstruct flagval krb5_flags_array[] = {\n     {\"KRB5_KDB_DISALLOW_POSTDATED\", KRB5_KDB_DISALLOW_POSTDATED},\n     {\"KRB5_KDB_DISALLOW_FORWARDABLE\", KRB5_KDB_DISALLOW_FORWARDABLE},\n     {\"KRB5_KDB_DISALLOW_TGT_BASED\", KRB5_KDB_DISALLOW_TGT_BASED},\n     {\"KRB5_KDB_DISALLOW_RENEWABLE\", KRB5_KDB_DISALLOW_RENEWABLE},\n     {\"KRB5_KDB_DISALLOW_PROXIABLE\", KRB5_KDB_DISALLOW_PROXIABLE},\n     {\"KRB5_KDB_DISALLOW_DUP_SKEY\", KRB5_KDB_DISALLOW_DUP_SKEY},\n     {\"KRB5_KDB_DISALLOW_ALL_TIX\", KRB5_KDB_DISALLOW_ALL_TIX},\n     {\"KRB5_KDB_REQUIRES_PRE_AUTH\", KRB5_KDB_REQUIRES_PRE_AUTH},\n     {\"KRB5_KDB_REQUIRES_HW_AUTH\", KRB5_KDB_REQUIRES_HW_AUTH},\n     {\"KRB5_KDB_REQUIRES_PWCHANGE\", KRB5_KDB_REQUIRES_PWCHANGE},\n     {\"KRB5_KDB_DISALLOW_SVR\", KRB5_KDB_DISALLOW_SVR},\n     {\"KRB5_KDB_PWCHANGE_SERVICE\", KRB5_KDB_PWCHANGE_SERVICE}\n};\n\nstatic Tcl_DString *unparse_krb5_flags(krb5_flags flags)\n{\n     return unparse_flags(krb5_flags_array, sizeof(krb5_flags_array) /\n\t\t\t  sizeof(struct flagval), flags);\n}"
  },
  {
    "function_name": "unparse_privs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "477-481",
    "snippet": "static Tcl_DString *unparse_privs(krb5_flags flags)\n{\n     return unparse_flags(priv_flags, sizeof(priv_flags) /\n\t\t\t  sizeof(struct flagval), flags);\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct flagval priv_flags[] = {\n     {\"OVSEC_KADM_PRIV_GET\", OVSEC_KADM_PRIV_GET},\n     {\"OVSEC_KADM_PRIV_ADD\", OVSEC_KADM_PRIV_ADD},\n     {\"OVSEC_KADM_PRIV_MODIFY\", OVSEC_KADM_PRIV_MODIFY},\n     {\"OVSEC_KADM_PRIV_DELETE\", OVSEC_KADM_PRIV_DELETE}\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unparse_flags",
          "args": [
            "priv_flags",
            "sizeof(priv_flags) /\n\t\t\t  sizeof(struct flagval)",
            "flags"
          ],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "unparse_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "417-437",
          "snippet": "static Tcl_DString *unparse_flags(struct flagval *array, int size,\n\t\t\t\t  krb5_int32 flags)\n{\n     int i;\n     Tcl_DString *str;\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     for (i = 0; i < size; i++) {\n\t  if (flags & array[i].val) {\n\t       Tcl_DStringAppendElement(str, array[i].name);\n\t  }\n     }\n\n     return str;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_DString *unparse_flags(struct flagval *array, int size,\n\t\t\t\t  krb5_int32 flags)\n{\n     int i;\n     Tcl_DString *str;\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     for (i = 0; i < size; i++) {\n\t  if (flags & array[i].val) {\n\t       Tcl_DStringAppendElement(str, array[i].name);\n\t  }\n     }\n\n     return str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstruct flagval priv_flags[] = {\n     {\"OVSEC_KADM_PRIV_GET\", OVSEC_KADM_PRIV_GET},\n     {\"OVSEC_KADM_PRIV_ADD\", OVSEC_KADM_PRIV_ADD},\n     {\"OVSEC_KADM_PRIV_MODIFY\", OVSEC_KADM_PRIV_MODIFY},\n     {\"OVSEC_KADM_PRIV_DELETE\", OVSEC_KADM_PRIV_DELETE}\n};\n\nstatic Tcl_DString *unparse_privs(krb5_flags flags)\n{\n     return unparse_flags(priv_flags, sizeof(priv_flags) /\n\t\t\t  sizeof(struct flagval), flags);\n}"
  },
  {
    "function_name": "parse_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "440-475",
    "snippet": "static int parse_flags(Tcl_Interp *interp, Tcl_HashTable *table,\n\t\t       struct flagval *array, int size, char *str,\n\t\t       krb5_flags *flags)\n{\n     int tmp, argc, i, retcode = TCL_OK;\n     char **argv;\n     Tcl_HashEntry *entry;\n\n     if (Tcl_GetInt(interp, str, &tmp) == TCL_OK) {\n\t  *flags = tmp;\n\t  return TCL_OK;\n     }\n     Tcl_ResetResult(interp);\n\n     if (Tcl_SplitList(interp, str, &argc, &argv) != TCL_OK) {\n\t  return TCL_ERROR;\n     }\n\n     if (! table) {\n\t  table = create_flag_table(array, size);\n     }\n\n     *flags = 0;\n\n     for (i = 0; i < argc; i++) {\n\t  if (! (entry = Tcl_FindHashEntry(table, argv[i]))) {\n\t       Tcl_AppendResult(interp, \"unknown krb5 flag \", argv[i], 0);\n\t       retcode = TCL_ERROR;\n\t       break;\n\t  }\n\t  *flags |= *(krb5_flags *) Tcl_GetHashValue(entry);\n     }\n  \n     free(argv);\n     return(retcode);\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "argv"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "free_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "939-943",
          "snippet": "static void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_GetHashValue",
          "args": [
            "entry"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendResult",
          "args": [
            "interp",
            "\"unknown krb5 flag \"",
            "argv[i]",
            "0"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_FindHashEntry",
          "args": [
            "table",
            "argv[i]"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "create_flag_table",
          "args": [
            "array",
            "size"
          ],
          "line": 459
        },
        "resolved": true,
        "details": {
          "function_name": "create_flag_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "178-203",
          "snippet": "static Tcl_HashTable *create_flag_table(struct flagval *flags, int size)\n{\n     Tcl_HashTable *table;\n     Tcl_HashEntry *entry;\n     int i;\n\n     if (! (table = (Tcl_HashTable *) malloc(sizeof(Tcl_HashTable)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_InitHashTable(table, TCL_STRING_KEYS);\n\n     for (i = 0; i < size; i++) {\n\t  int newPtr;\n\t       \n\t  if (! (entry = Tcl_CreateHashEntry(table, flags[i].name, &newPtr))) {\n\t       fprintf(stderr, \"Out of memory!\\n\");\n\t       exit(1); /* XXX */\n\t  }\n\n\t  Tcl_SetHashValue(entry, &flags[i].val);\n     }\n\n     return table;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_HashTable *create_flag_table(struct flagval *flags, int size)\n{\n     Tcl_HashTable *table;\n     Tcl_HashEntry *entry;\n     int i;\n\n     if (! (table = (Tcl_HashTable *) malloc(sizeof(Tcl_HashTable)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_InitHashTable(table, TCL_STRING_KEYS);\n\n     for (i = 0; i < size; i++) {\n\t  int newPtr;\n\t       \n\t  if (! (entry = Tcl_CreateHashEntry(table, flags[i].name, &newPtr))) {\n\t       fprintf(stderr, \"Out of memory!\\n\");\n\t       exit(1); /* XXX */\n\t  }\n\n\t  Tcl_SetHashValue(entry, &flags[i].val);\n     }\n\n     return table;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_SplitList",
          "args": [
            "interp",
            "str",
            "&argc",
            "&argv"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_ResetResult",
          "args": [
            "interp"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_GetInt",
          "args": [
            "interp",
            "str",
            "&tmp"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_flags(Tcl_Interp *interp, Tcl_HashTable *table,\n\t\t       struct flagval *array, int size, char *str,\n\t\t       krb5_flags *flags)\n{\n     int tmp, argc, i, retcode = TCL_OK;\n     char **argv;\n     Tcl_HashEntry *entry;\n\n     if (Tcl_GetInt(interp, str, &tmp) == TCL_OK) {\n\t  *flags = tmp;\n\t  return TCL_OK;\n     }\n     Tcl_ResetResult(interp);\n\n     if (Tcl_SplitList(interp, str, &argc, &argv) != TCL_OK) {\n\t  return TCL_ERROR;\n     }\n\n     if (! table) {\n\t  table = create_flag_table(array, size);\n     }\n\n     *flags = 0;\n\n     for (i = 0; i < argc; i++) {\n\t  if (! (entry = Tcl_FindHashEntry(table, argv[i]))) {\n\t       Tcl_AppendResult(interp, \"unknown krb5 flag \", argv[i], 0);\n\t       retcode = TCL_ERROR;\n\t       break;\n\t  }\n\t  *flags |= *(krb5_flags *) Tcl_GetHashValue(entry);\n     }\n  \n     free(argv);\n     return(retcode);\n}"
  },
  {
    "function_name": "unparse_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "417-437",
    "snippet": "static Tcl_DString *unparse_flags(struct flagval *array, int size,\n\t\t\t\t  krb5_int32 flags)\n{\n     int i;\n     Tcl_DString *str;\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     for (i = 0; i < size; i++) {\n\t  if (flags & array[i].val) {\n\t       Tcl_DStringAppendElement(str, array[i].name);\n\t  }\n     }\n\n     return str;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "str",
            "array[i].name"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringInit",
          "args": [
            "str"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "request_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/server/ovsec_kadmd.c",
          "lines": "841-846",
          "snippet": "void request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}",
          "includes": [
            "#include    \"purify.h\"",
            "#include    \"misc.h\"",
            "#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */",
            "#include    <string.h>",
            "#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */",
            "#include    <krb5/adm_proto.h>",
            "#include    <kadm5/server_acl.h>",
            "#include    <kadm5/kadm_rpc.h>",
            "#include    <kadm5/admin.h>",
            "#include    <gssrpc/auth_gssapi.h>",
            "#include    \"gssapiP_krb5.h\" /* for kg_get_context */",
            "#include    <gssapi/gssapi.h>",
            "#include    <gssrpc/rpc.h>",
            "#include    <arpa/inet.h>  /* inet_ntoa */",
            "#include    <netinet/in.h>",
            "#include    <unistd.h>",
            "#include    <sys/socket.h>",
            "#include    <sys/time.h>",
            "#include    <sys/select.h>",
            "#include    <sys/types.h>",
            "#include    <syslog.h>",
            "#include    <signal.h>",
            "#include    <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "volatile int\tsignal_request_exit = 0;",
            "void\trequest_exit(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include    \"purify.h\"\n#include    \"misc.h\"\n#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */\n#include    <string.h>\n#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */\n#include    <krb5/adm_proto.h>\n#include    <kadm5/server_acl.h>\n#include    <kadm5/kadm_rpc.h>\n#include    <kadm5/admin.h>\n#include    <gssrpc/auth_gssapi.h>\n#include    \"gssapiP_krb5.h\" /* for kg_get_context */\n#include    <gssapi/gssapi.h>\n#include    <gssrpc/rpc.h>\n#include    <arpa/inet.h>  /* inet_ntoa */\n#include    <netinet/in.h>\n#include    <unistd.h>\n#include    <sys/socket.h>\n#include    <sys/time.h>\n#include    <sys/select.h>\n#include    <sys/types.h>\n#include    <syslog.h>\n#include    <signal.h>\n#include    <stdio.h>\n\nvolatile int\tsignal_request_exit = 0;\nvoid\trequest_exit(int);\n\nvoid request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*str)"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_DString *unparse_flags(struct flagval *array, int size,\n\t\t\t\t  krb5_int32 flags)\n{\n     int i;\n     Tcl_DString *str;\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     for (i = 0; i < size; i++) {\n\t  if (flags & array[i].val) {\n\t       Tcl_DStringAppendElement(str, array[i].name);\n\t  }\n     }\n\n     return str;\n}"
  },
  {
    "function_name": "stash_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "407-413",
    "snippet": "static void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "dstring"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "free_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "939-943",
          "snippet": "static void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_DStringFree",
          "args": [
            "dstring"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringResult",
          "args": [
            "interp",
            "dstring"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unparse_err",
          "args": [
            "code"
          ],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "unparse_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "253-403",
          "snippet": "static Tcl_DString *unparse_err(ovsec_kadm_ret_t code)\n{\n     char *code_string;\n     const char *error_string;\n     Tcl_DString *dstring;\n\n     switch (code) {\n     case OVSEC_KADM_FAILURE: code_string = \"OVSEC_KADM_FAILURE\"; break;\n     case OVSEC_KADM_AUTH_GET: code_string = \"OVSEC_KADM_AUTH_GET\"; break;\n     case OVSEC_KADM_AUTH_ADD: code_string = \"OVSEC_KADM_AUTH_ADD\"; break;\n     case OVSEC_KADM_AUTH_MODIFY:\n\t  code_string = \"OVSEC_KADM_AUTH_MODIFY\"; break;\n     case OVSEC_KADM_AUTH_DELETE:\n\t  code_string = \"OVSEC_KADM_AUTH_DELETE\"; break;\n     case OVSEC_KADM_AUTH_INSUFFICIENT:\n\t  code_string = \"OVSEC_KADM_AUTH_INSUFFICIENT\"; break;\n     case OVSEC_KADM_BAD_DB: code_string = \"OVSEC_KADM_BAD_DB\"; break;\n     case OVSEC_KADM_DUP: code_string = \"OVSEC_KADM_DUP\"; break;\n     case OVSEC_KADM_RPC_ERROR: code_string = \"OVSEC_KADM_RPC_ERROR\"; break;\n     case OVSEC_KADM_NO_SRV: code_string = \"OVSEC_KADM_NO_SRV\"; break;\n     case OVSEC_KADM_BAD_HIST_KEY:\n\t  code_string = \"OVSEC_KADM_BAD_HIST_KEY\"; break;\n     case OVSEC_KADM_NOT_INIT: code_string = \"OVSEC_KADM_NOT_INIT\"; break;\n     case OVSEC_KADM_INIT: code_string = \"OVSEC_KADM_INIT\"; break;\n     case OVSEC_KADM_BAD_PASSWORD:\n\t  code_string = \"OVSEC_KADM_BAD_PASSWORD\"; break;\n     case OVSEC_KADM_UNK_PRINC: code_string = \"OVSEC_KADM_UNK_PRINC\"; break;\n     case OVSEC_KADM_UNK_POLICY: code_string = \"OVSEC_KADM_UNK_POLICY\"; break;\n     case OVSEC_KADM_BAD_MASK: code_string = \"OVSEC_KADM_BAD_MASK\"; break;\n     case OVSEC_KADM_BAD_CLASS: code_string = \"OVSEC_KADM_BAD_CLASS\"; break;\n     case OVSEC_KADM_BAD_LENGTH: code_string = \"OVSEC_KADM_BAD_LENGTH\"; break;\n     case OVSEC_KADM_BAD_POLICY: code_string = \"OVSEC_KADM_BAD_POLICY\"; break;\n     case OVSEC_KADM_BAD_HISTORY: code_string = \"OVSEC_KADM_BAD_HISTORY\"; break;\n     case OVSEC_KADM_BAD_PRINCIPAL:\n\t  code_string = \"OVSEC_KADM_BAD_PRINCIPAL\"; break;\n     case OVSEC_KADM_BAD_AUX_ATTR:\n\t  code_string = \"OVSEC_KADM_BAD_AUX_ATTR\"; break;\n     case OVSEC_KADM_PASS_Q_TOOSHORT:\n\t  code_string = \"OVSEC_KADM_PASS_Q_TOOSHORT\"; break;\n     case OVSEC_KADM_PASS_Q_CLASS:\n\t  code_string = \"OVSEC_KADM_PASS_Q_CLASS\"; break;\n     case OVSEC_KADM_PASS_Q_DICT:\n\t  code_string = \"OVSEC_KADM_PASS_Q_DICT\"; break;\n     case OVSEC_KADM_PASS_REUSE: code_string = \"OVSEC_KADM_PASS_REUSE\"; break;\n     case OVSEC_KADM_PASS_TOOSOON:\n\t  code_string = \"OVSEC_KADM_PASS_TOOSOON\"; break;\n     case OVSEC_KADM_POLICY_REF:\n\t  code_string = \"OVSEC_KADM_POLICY_REF\"; break;\n     case OVSEC_KADM_PROTECT_PRINCIPAL:\n\t  code_string = \"OVSEC_KADM_PROTECT_PRINCIPAL\"; break;\n     case OVSEC_KADM_BAD_SERVER_HANDLE:\n\t  code_string = \"OVSEC_KADM_BAD_SERVER_HANDLE\"; break;\n     case OVSEC_KADM_BAD_STRUCT_VERSION:\n     \t  code_string = \"OVSEC_KADM_BAD_STRUCT_VERSION\"; break;\n     case OVSEC_KADM_OLD_STRUCT_VERSION:\n\t  code_string = \"OVSEC_KADM_OLD_STRUCT_VERSION\"; break;\n     case OVSEC_KADM_NEW_STRUCT_VERSION:\n\t  code_string = \"OVSEC_KADM_NEW_STRUCT_VERSION\"; break;\n     case OVSEC_KADM_BAD_API_VERSION:\n\t  code_string = \"OVSEC_KADM_BAD_API_VERSION\"; break;\n     case OVSEC_KADM_OLD_LIB_API_VERSION:\n     \t  code_string = \"OVSEC_KADM_OLD_LIB_API_VERSION\"; break;\n     case OVSEC_KADM_OLD_SERVER_API_VERSION:\n     \t  code_string = \"OVSEC_KADM_OLD_SERVER_API_VERSION\"; break;\n     case OVSEC_KADM_NEW_LIB_API_VERSION:\n     \t  code_string = \"OVSEC_KADM_NEW_LIB_API_VERSION\"; break;\n     case OVSEC_KADM_NEW_SERVER_API_VERSION:\n\t  code_string = \"OVSEC_KADM_NEW_SERVER_API_VERSION\"; break;\n     case OVSEC_KADM_SECURE_PRINC_MISSING:\n\t  code_string = \"OVSEC_KADM_SECURE_PRINC_MISSING\"; break;\n     case KADM5_NO_RENAME_SALT:\n\t  code_string = \"KADM5_NO_RENAME_SALT\"; break;\n     case KADM5_BAD_CLIENT_PARAMS:\n\t  code_string = \"KADM5_BAD_CLIENT_PARAMS\"; break;\n     case KADM5_BAD_SERVER_PARAMS:\n\t  code_string = \"KADM5_BAD_SERVER_PARAMS\"; break;\n     case KADM5_AUTH_LIST:\n\t  code_string = \"KADM5_AUTH_LIST\"; break;\n     case KADM5_AUTH_CHANGEPW:\n\t  code_string = \"KADM5_AUTH_CHANGEPW\"; break;\n     case OSA_ADB_DUP: code_string = \"OSA_ADB_DUP\"; break;\n     case OSA_ADB_NOENT: code_string = \"ENOENT\"; break;\n     case OSA_ADB_DBINIT: code_string = \"OSA_ADB_DBINIT\"; break;\n     case OSA_ADB_BAD_POLICY: code_string = \"Bad policy name\"; break;\n     case OSA_ADB_BAD_PRINC: code_string = \"Bad principal name\"; break;\n     case OSA_ADB_BAD_DB: code_string = \"Invalid database.\"; break;\n     case OSA_ADB_XDR_FAILURE: code_string = \"OSA_ADB_XDR_FAILURE\"; break;\n     case KRB5_KDB_INUSE: code_string = \"KRB5_KDB_INUSE\"; break;\n     case KRB5_KDB_UK_SERROR: code_string = \"KRB5_KDB_UK_SERROR\"; break;\n     case KRB5_KDB_UK_RERROR: code_string = \"KRB5_KDB_UK_RERROR\"; break;\n     case KRB5_KDB_UNAUTH: code_string = \"KRB5_KDB_UNAUTH\"; break;\n     case KRB5_KDB_NOENTRY: code_string = \"KRB5_KDB_NOENTRY\"; break;\n     case KRB5_KDB_ILL_WILDCARD: code_string = \"KRB5_KDB_ILL_WILDCARD\"; break;\n     case KRB5_KDB_DB_INUSE: code_string = \"KRB5_KDB_DB_INUSE\"; break;\n     case KRB5_KDB_DB_CHANGED: code_string = \"KRB5_KDB_DB_CHANGED\"; break;\n     case KRB5_KDB_TRUNCATED_RECORD:\n\t  code_string = \"KRB5_KDB_TRUNCATED_RECORD\"; break;\n     case KRB5_KDB_RECURSIVELOCK:\n\t  code_string = \"KRB5_KDB_RECURSIVELOCK\"; break;\n     case KRB5_KDB_NOTLOCKED: code_string = \"KRB5_KDB_NOTLOCKED\"; break;\n     case KRB5_KDB_BADLOCKMODE: code_string = \"KRB5_KDB_BADLOCKMODE\"; break;\n     case KRB5_KDB_DBNOTINITED: code_string = \"KRB5_KDB_DBNOTINITED\"; break;\n     case KRB5_KDB_DBINITED: code_string = \"KRB5_KDB_DBINITED\"; break;\n     case KRB5_KDB_ILLDIRECTION: code_string = \"KRB5_KDB_ILLDIRECTION\"; break;\n     case KRB5_KDB_NOMASTERKEY: code_string = \"KRB5_KDB_NOMASTERKEY\"; break;\n     case KRB5_KDB_BADMASTERKEY: code_string = \"KRB5_KDB_BADMASTERKEY\"; break;\n     case KRB5_KDB_INVALIDKEYSIZE:\n\t  code_string = \"KRB5_KDB_INVALIDKEYSIZE\"; break;\n     case KRB5_KDB_CANTREAD_STORED:\n\t  code_string = \"KRB5_KDB_CANTREAD_STORED\"; break;\n     case KRB5_KDB_BADSTORED_MKEY:\n\t  code_string = \"KRB5_KDB_BADSTORED_MKEY\"; break;\n     case KRB5_KDB_CANTLOCK_DB: code_string = \"KRB5_KDB_CANTLOCK_DB\"; break;\n     case KRB5_KDB_DB_CORRUPT: code_string = \"KRB5_KDB_DB_CORRUPT\"; break;\n     case KRB5_PARSE_ILLCHAR: code_string = \"KRB5_PARSE_ILLCHAR\"; break;\n     case KRB5_PARSE_MALFORMED: code_string = \"KRB5_PARSE_MALFORMED\"; break;\n     case KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN: code_string = \"KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN\"; break;\n     case KRB5_REALM_UNKNOWN: code_string = \"KRB5_REALM_UNKNOWN\"; break;\n     case KRB5_KDC_UNREACH: code_string = \"KRB5_KDC_UNREACH\"; break;\n     case KRB5_KDCREP_MODIFIED: code_string = \"KRB5_KDCREP_MODIFIED\"; break;\n     case KRB5KRB_AP_ERR_BAD_INTEGRITY: code_string  = \"KRB5KRB_AP_ERR_BAD_INTEGRITY\"; break;\n     case KRB5KDC_ERR_C_PRINCIPAL_UNKNOWN: code_string = \"KRB5KDC_ERR_C_PRINCIPAL_UNKNOWN\"; break;\n     case EINVAL: code_string = \"EINVAL\"; break;\n     case ENOENT: code_string = \"ENOENT\"; break;\n     default:\n\t fprintf(stderr, \"**** CODE %d (%s) ***\\n\", code,\n\t\t error_message (code));\n\t code_string = \"UNKNOWN\";\n\t break;\n     }\n\n     error_string = error_message(code);\n\n     if (! (dstring = (Tcl_DString *) malloc(sizeof(Tcl_DString)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX Do we really want to exit?  Ok if this is */\n\t\t   /* just a test program, but what about if it gets */\n\t\t   /* used for other things later? */\n     }\n\n     Tcl_DStringInit(dstring);\n\n     if (! (Tcl_DStringAppendElement(dstring, \"ERROR\") &&\n\t    Tcl_DStringAppendElement(dstring, code_string) &&\n\t    Tcl_DStringAppendElement(dstring, error_string))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n     \n     return dstring;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_DString *unparse_err(ovsec_kadm_ret_t code)\n{\n     char *code_string;\n     const char *error_string;\n     Tcl_DString *dstring;\n\n     switch (code) {\n     case OVSEC_KADM_FAILURE: code_string = \"OVSEC_KADM_FAILURE\"; break;\n     case OVSEC_KADM_AUTH_GET: code_string = \"OVSEC_KADM_AUTH_GET\"; break;\n     case OVSEC_KADM_AUTH_ADD: code_string = \"OVSEC_KADM_AUTH_ADD\"; break;\n     case OVSEC_KADM_AUTH_MODIFY:\n\t  code_string = \"OVSEC_KADM_AUTH_MODIFY\"; break;\n     case OVSEC_KADM_AUTH_DELETE:\n\t  code_string = \"OVSEC_KADM_AUTH_DELETE\"; break;\n     case OVSEC_KADM_AUTH_INSUFFICIENT:\n\t  code_string = \"OVSEC_KADM_AUTH_INSUFFICIENT\"; break;\n     case OVSEC_KADM_BAD_DB: code_string = \"OVSEC_KADM_BAD_DB\"; break;\n     case OVSEC_KADM_DUP: code_string = \"OVSEC_KADM_DUP\"; break;\n     case OVSEC_KADM_RPC_ERROR: code_string = \"OVSEC_KADM_RPC_ERROR\"; break;\n     case OVSEC_KADM_NO_SRV: code_string = \"OVSEC_KADM_NO_SRV\"; break;\n     case OVSEC_KADM_BAD_HIST_KEY:\n\t  code_string = \"OVSEC_KADM_BAD_HIST_KEY\"; break;\n     case OVSEC_KADM_NOT_INIT: code_string = \"OVSEC_KADM_NOT_INIT\"; break;\n     case OVSEC_KADM_INIT: code_string = \"OVSEC_KADM_INIT\"; break;\n     case OVSEC_KADM_BAD_PASSWORD:\n\t  code_string = \"OVSEC_KADM_BAD_PASSWORD\"; break;\n     case OVSEC_KADM_UNK_PRINC: code_string = \"OVSEC_KADM_UNK_PRINC\"; break;\n     case OVSEC_KADM_UNK_POLICY: code_string = \"OVSEC_KADM_UNK_POLICY\"; break;\n     case OVSEC_KADM_BAD_MASK: code_string = \"OVSEC_KADM_BAD_MASK\"; break;\n     case OVSEC_KADM_BAD_CLASS: code_string = \"OVSEC_KADM_BAD_CLASS\"; break;\n     case OVSEC_KADM_BAD_LENGTH: code_string = \"OVSEC_KADM_BAD_LENGTH\"; break;\n     case OVSEC_KADM_BAD_POLICY: code_string = \"OVSEC_KADM_BAD_POLICY\"; break;\n     case OVSEC_KADM_BAD_HISTORY: code_string = \"OVSEC_KADM_BAD_HISTORY\"; break;\n     case OVSEC_KADM_BAD_PRINCIPAL:\n\t  code_string = \"OVSEC_KADM_BAD_PRINCIPAL\"; break;\n     case OVSEC_KADM_BAD_AUX_ATTR:\n\t  code_string = \"OVSEC_KADM_BAD_AUX_ATTR\"; break;\n     case OVSEC_KADM_PASS_Q_TOOSHORT:\n\t  code_string = \"OVSEC_KADM_PASS_Q_TOOSHORT\"; break;\n     case OVSEC_KADM_PASS_Q_CLASS:\n\t  code_string = \"OVSEC_KADM_PASS_Q_CLASS\"; break;\n     case OVSEC_KADM_PASS_Q_DICT:\n\t  code_string = \"OVSEC_KADM_PASS_Q_DICT\"; break;\n     case OVSEC_KADM_PASS_REUSE: code_string = \"OVSEC_KADM_PASS_REUSE\"; break;\n     case OVSEC_KADM_PASS_TOOSOON:\n\t  code_string = \"OVSEC_KADM_PASS_TOOSOON\"; break;\n     case OVSEC_KADM_POLICY_REF:\n\t  code_string = \"OVSEC_KADM_POLICY_REF\"; break;\n     case OVSEC_KADM_PROTECT_PRINCIPAL:\n\t  code_string = \"OVSEC_KADM_PROTECT_PRINCIPAL\"; break;\n     case OVSEC_KADM_BAD_SERVER_HANDLE:\n\t  code_string = \"OVSEC_KADM_BAD_SERVER_HANDLE\"; break;\n     case OVSEC_KADM_BAD_STRUCT_VERSION:\n     \t  code_string = \"OVSEC_KADM_BAD_STRUCT_VERSION\"; break;\n     case OVSEC_KADM_OLD_STRUCT_VERSION:\n\t  code_string = \"OVSEC_KADM_OLD_STRUCT_VERSION\"; break;\n     case OVSEC_KADM_NEW_STRUCT_VERSION:\n\t  code_string = \"OVSEC_KADM_NEW_STRUCT_VERSION\"; break;\n     case OVSEC_KADM_BAD_API_VERSION:\n\t  code_string = \"OVSEC_KADM_BAD_API_VERSION\"; break;\n     case OVSEC_KADM_OLD_LIB_API_VERSION:\n     \t  code_string = \"OVSEC_KADM_OLD_LIB_API_VERSION\"; break;\n     case OVSEC_KADM_OLD_SERVER_API_VERSION:\n     \t  code_string = \"OVSEC_KADM_OLD_SERVER_API_VERSION\"; break;\n     case OVSEC_KADM_NEW_LIB_API_VERSION:\n     \t  code_string = \"OVSEC_KADM_NEW_LIB_API_VERSION\"; break;\n     case OVSEC_KADM_NEW_SERVER_API_VERSION:\n\t  code_string = \"OVSEC_KADM_NEW_SERVER_API_VERSION\"; break;\n     case OVSEC_KADM_SECURE_PRINC_MISSING:\n\t  code_string = \"OVSEC_KADM_SECURE_PRINC_MISSING\"; break;\n     case KADM5_NO_RENAME_SALT:\n\t  code_string = \"KADM5_NO_RENAME_SALT\"; break;\n     case KADM5_BAD_CLIENT_PARAMS:\n\t  code_string = \"KADM5_BAD_CLIENT_PARAMS\"; break;\n     case KADM5_BAD_SERVER_PARAMS:\n\t  code_string = \"KADM5_BAD_SERVER_PARAMS\"; break;\n     case KADM5_AUTH_LIST:\n\t  code_string = \"KADM5_AUTH_LIST\"; break;\n     case KADM5_AUTH_CHANGEPW:\n\t  code_string = \"KADM5_AUTH_CHANGEPW\"; break;\n     case OSA_ADB_DUP: code_string = \"OSA_ADB_DUP\"; break;\n     case OSA_ADB_NOENT: code_string = \"ENOENT\"; break;\n     case OSA_ADB_DBINIT: code_string = \"OSA_ADB_DBINIT\"; break;\n     case OSA_ADB_BAD_POLICY: code_string = \"Bad policy name\"; break;\n     case OSA_ADB_BAD_PRINC: code_string = \"Bad principal name\"; break;\n     case OSA_ADB_BAD_DB: code_string = \"Invalid database.\"; break;\n     case OSA_ADB_XDR_FAILURE: code_string = \"OSA_ADB_XDR_FAILURE\"; break;\n     case KRB5_KDB_INUSE: code_string = \"KRB5_KDB_INUSE\"; break;\n     case KRB5_KDB_UK_SERROR: code_string = \"KRB5_KDB_UK_SERROR\"; break;\n     case KRB5_KDB_UK_RERROR: code_string = \"KRB5_KDB_UK_RERROR\"; break;\n     case KRB5_KDB_UNAUTH: code_string = \"KRB5_KDB_UNAUTH\"; break;\n     case KRB5_KDB_NOENTRY: code_string = \"KRB5_KDB_NOENTRY\"; break;\n     case KRB5_KDB_ILL_WILDCARD: code_string = \"KRB5_KDB_ILL_WILDCARD\"; break;\n     case KRB5_KDB_DB_INUSE: code_string = \"KRB5_KDB_DB_INUSE\"; break;\n     case KRB5_KDB_DB_CHANGED: code_string = \"KRB5_KDB_DB_CHANGED\"; break;\n     case KRB5_KDB_TRUNCATED_RECORD:\n\t  code_string = \"KRB5_KDB_TRUNCATED_RECORD\"; break;\n     case KRB5_KDB_RECURSIVELOCK:\n\t  code_string = \"KRB5_KDB_RECURSIVELOCK\"; break;\n     case KRB5_KDB_NOTLOCKED: code_string = \"KRB5_KDB_NOTLOCKED\"; break;\n     case KRB5_KDB_BADLOCKMODE: code_string = \"KRB5_KDB_BADLOCKMODE\"; break;\n     case KRB5_KDB_DBNOTINITED: code_string = \"KRB5_KDB_DBNOTINITED\"; break;\n     case KRB5_KDB_DBINITED: code_string = \"KRB5_KDB_DBINITED\"; break;\n     case KRB5_KDB_ILLDIRECTION: code_string = \"KRB5_KDB_ILLDIRECTION\"; break;\n     case KRB5_KDB_NOMASTERKEY: code_string = \"KRB5_KDB_NOMASTERKEY\"; break;\n     case KRB5_KDB_BADMASTERKEY: code_string = \"KRB5_KDB_BADMASTERKEY\"; break;\n     case KRB5_KDB_INVALIDKEYSIZE:\n\t  code_string = \"KRB5_KDB_INVALIDKEYSIZE\"; break;\n     case KRB5_KDB_CANTREAD_STORED:\n\t  code_string = \"KRB5_KDB_CANTREAD_STORED\"; break;\n     case KRB5_KDB_BADSTORED_MKEY:\n\t  code_string = \"KRB5_KDB_BADSTORED_MKEY\"; break;\n     case KRB5_KDB_CANTLOCK_DB: code_string = \"KRB5_KDB_CANTLOCK_DB\"; break;\n     case KRB5_KDB_DB_CORRUPT: code_string = \"KRB5_KDB_DB_CORRUPT\"; break;\n     case KRB5_PARSE_ILLCHAR: code_string = \"KRB5_PARSE_ILLCHAR\"; break;\n     case KRB5_PARSE_MALFORMED: code_string = \"KRB5_PARSE_MALFORMED\"; break;\n     case KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN: code_string = \"KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN\"; break;\n     case KRB5_REALM_UNKNOWN: code_string = \"KRB5_REALM_UNKNOWN\"; break;\n     case KRB5_KDC_UNREACH: code_string = \"KRB5_KDC_UNREACH\"; break;\n     case KRB5_KDCREP_MODIFIED: code_string = \"KRB5_KDCREP_MODIFIED\"; break;\n     case KRB5KRB_AP_ERR_BAD_INTEGRITY: code_string  = \"KRB5KRB_AP_ERR_BAD_INTEGRITY\"; break;\n     case KRB5KDC_ERR_C_PRINCIPAL_UNKNOWN: code_string = \"KRB5KDC_ERR_C_PRINCIPAL_UNKNOWN\"; break;\n     case EINVAL: code_string = \"EINVAL\"; break;\n     case ENOENT: code_string = \"ENOENT\"; break;\n     default:\n\t fprintf(stderr, \"**** CODE %d (%s) ***\\n\", code,\n\t\t error_message (code));\n\t code_string = \"UNKNOWN\";\n\t break;\n     }\n\n     error_string = error_message(code);\n\n     if (! (dstring = (Tcl_DString *) malloc(sizeof(Tcl_DString)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX Do we really want to exit?  Ok if this is */\n\t\t   /* just a test program, but what about if it gets */\n\t\t   /* used for other things later? */\n     }\n\n     Tcl_DStringInit(dstring);\n\n     if (! (Tcl_DStringAppendElement(dstring, \"ERROR\") &&\n\t    Tcl_DStringAppendElement(dstring, code_string) &&\n\t    Tcl_DStringAppendElement(dstring, error_string))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n     \n     return dstring;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void stash_error(Tcl_Interp *interp, krb5_error_code code)\n{\n     Tcl_DString *dstring = unparse_err(code);\n     Tcl_DStringResult(interp, dstring);\n     Tcl_DStringFree(dstring);\n     free(dstring);\n}"
  },
  {
    "function_name": "unparse_err",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "253-403",
    "snippet": "static Tcl_DString *unparse_err(ovsec_kadm_ret_t code)\n{\n     char *code_string;\n     const char *error_string;\n     Tcl_DString *dstring;\n\n     switch (code) {\n     case OVSEC_KADM_FAILURE: code_string = \"OVSEC_KADM_FAILURE\"; break;\n     case OVSEC_KADM_AUTH_GET: code_string = \"OVSEC_KADM_AUTH_GET\"; break;\n     case OVSEC_KADM_AUTH_ADD: code_string = \"OVSEC_KADM_AUTH_ADD\"; break;\n     case OVSEC_KADM_AUTH_MODIFY:\n\t  code_string = \"OVSEC_KADM_AUTH_MODIFY\"; break;\n     case OVSEC_KADM_AUTH_DELETE:\n\t  code_string = \"OVSEC_KADM_AUTH_DELETE\"; break;\n     case OVSEC_KADM_AUTH_INSUFFICIENT:\n\t  code_string = \"OVSEC_KADM_AUTH_INSUFFICIENT\"; break;\n     case OVSEC_KADM_BAD_DB: code_string = \"OVSEC_KADM_BAD_DB\"; break;\n     case OVSEC_KADM_DUP: code_string = \"OVSEC_KADM_DUP\"; break;\n     case OVSEC_KADM_RPC_ERROR: code_string = \"OVSEC_KADM_RPC_ERROR\"; break;\n     case OVSEC_KADM_NO_SRV: code_string = \"OVSEC_KADM_NO_SRV\"; break;\n     case OVSEC_KADM_BAD_HIST_KEY:\n\t  code_string = \"OVSEC_KADM_BAD_HIST_KEY\"; break;\n     case OVSEC_KADM_NOT_INIT: code_string = \"OVSEC_KADM_NOT_INIT\"; break;\n     case OVSEC_KADM_INIT: code_string = \"OVSEC_KADM_INIT\"; break;\n     case OVSEC_KADM_BAD_PASSWORD:\n\t  code_string = \"OVSEC_KADM_BAD_PASSWORD\"; break;\n     case OVSEC_KADM_UNK_PRINC: code_string = \"OVSEC_KADM_UNK_PRINC\"; break;\n     case OVSEC_KADM_UNK_POLICY: code_string = \"OVSEC_KADM_UNK_POLICY\"; break;\n     case OVSEC_KADM_BAD_MASK: code_string = \"OVSEC_KADM_BAD_MASK\"; break;\n     case OVSEC_KADM_BAD_CLASS: code_string = \"OVSEC_KADM_BAD_CLASS\"; break;\n     case OVSEC_KADM_BAD_LENGTH: code_string = \"OVSEC_KADM_BAD_LENGTH\"; break;\n     case OVSEC_KADM_BAD_POLICY: code_string = \"OVSEC_KADM_BAD_POLICY\"; break;\n     case OVSEC_KADM_BAD_HISTORY: code_string = \"OVSEC_KADM_BAD_HISTORY\"; break;\n     case OVSEC_KADM_BAD_PRINCIPAL:\n\t  code_string = \"OVSEC_KADM_BAD_PRINCIPAL\"; break;\n     case OVSEC_KADM_BAD_AUX_ATTR:\n\t  code_string = \"OVSEC_KADM_BAD_AUX_ATTR\"; break;\n     case OVSEC_KADM_PASS_Q_TOOSHORT:\n\t  code_string = \"OVSEC_KADM_PASS_Q_TOOSHORT\"; break;\n     case OVSEC_KADM_PASS_Q_CLASS:\n\t  code_string = \"OVSEC_KADM_PASS_Q_CLASS\"; break;\n     case OVSEC_KADM_PASS_Q_DICT:\n\t  code_string = \"OVSEC_KADM_PASS_Q_DICT\"; break;\n     case OVSEC_KADM_PASS_REUSE: code_string = \"OVSEC_KADM_PASS_REUSE\"; break;\n     case OVSEC_KADM_PASS_TOOSOON:\n\t  code_string = \"OVSEC_KADM_PASS_TOOSOON\"; break;\n     case OVSEC_KADM_POLICY_REF:\n\t  code_string = \"OVSEC_KADM_POLICY_REF\"; break;\n     case OVSEC_KADM_PROTECT_PRINCIPAL:\n\t  code_string = \"OVSEC_KADM_PROTECT_PRINCIPAL\"; break;\n     case OVSEC_KADM_BAD_SERVER_HANDLE:\n\t  code_string = \"OVSEC_KADM_BAD_SERVER_HANDLE\"; break;\n     case OVSEC_KADM_BAD_STRUCT_VERSION:\n     \t  code_string = \"OVSEC_KADM_BAD_STRUCT_VERSION\"; break;\n     case OVSEC_KADM_OLD_STRUCT_VERSION:\n\t  code_string = \"OVSEC_KADM_OLD_STRUCT_VERSION\"; break;\n     case OVSEC_KADM_NEW_STRUCT_VERSION:\n\t  code_string = \"OVSEC_KADM_NEW_STRUCT_VERSION\"; break;\n     case OVSEC_KADM_BAD_API_VERSION:\n\t  code_string = \"OVSEC_KADM_BAD_API_VERSION\"; break;\n     case OVSEC_KADM_OLD_LIB_API_VERSION:\n     \t  code_string = \"OVSEC_KADM_OLD_LIB_API_VERSION\"; break;\n     case OVSEC_KADM_OLD_SERVER_API_VERSION:\n     \t  code_string = \"OVSEC_KADM_OLD_SERVER_API_VERSION\"; break;\n     case OVSEC_KADM_NEW_LIB_API_VERSION:\n     \t  code_string = \"OVSEC_KADM_NEW_LIB_API_VERSION\"; break;\n     case OVSEC_KADM_NEW_SERVER_API_VERSION:\n\t  code_string = \"OVSEC_KADM_NEW_SERVER_API_VERSION\"; break;\n     case OVSEC_KADM_SECURE_PRINC_MISSING:\n\t  code_string = \"OVSEC_KADM_SECURE_PRINC_MISSING\"; break;\n     case KADM5_NO_RENAME_SALT:\n\t  code_string = \"KADM5_NO_RENAME_SALT\"; break;\n     case KADM5_BAD_CLIENT_PARAMS:\n\t  code_string = \"KADM5_BAD_CLIENT_PARAMS\"; break;\n     case KADM5_BAD_SERVER_PARAMS:\n\t  code_string = \"KADM5_BAD_SERVER_PARAMS\"; break;\n     case KADM5_AUTH_LIST:\n\t  code_string = \"KADM5_AUTH_LIST\"; break;\n     case KADM5_AUTH_CHANGEPW:\n\t  code_string = \"KADM5_AUTH_CHANGEPW\"; break;\n     case OSA_ADB_DUP: code_string = \"OSA_ADB_DUP\"; break;\n     case OSA_ADB_NOENT: code_string = \"ENOENT\"; break;\n     case OSA_ADB_DBINIT: code_string = \"OSA_ADB_DBINIT\"; break;\n     case OSA_ADB_BAD_POLICY: code_string = \"Bad policy name\"; break;\n     case OSA_ADB_BAD_PRINC: code_string = \"Bad principal name\"; break;\n     case OSA_ADB_BAD_DB: code_string = \"Invalid database.\"; break;\n     case OSA_ADB_XDR_FAILURE: code_string = \"OSA_ADB_XDR_FAILURE\"; break;\n     case KRB5_KDB_INUSE: code_string = \"KRB5_KDB_INUSE\"; break;\n     case KRB5_KDB_UK_SERROR: code_string = \"KRB5_KDB_UK_SERROR\"; break;\n     case KRB5_KDB_UK_RERROR: code_string = \"KRB5_KDB_UK_RERROR\"; break;\n     case KRB5_KDB_UNAUTH: code_string = \"KRB5_KDB_UNAUTH\"; break;\n     case KRB5_KDB_NOENTRY: code_string = \"KRB5_KDB_NOENTRY\"; break;\n     case KRB5_KDB_ILL_WILDCARD: code_string = \"KRB5_KDB_ILL_WILDCARD\"; break;\n     case KRB5_KDB_DB_INUSE: code_string = \"KRB5_KDB_DB_INUSE\"; break;\n     case KRB5_KDB_DB_CHANGED: code_string = \"KRB5_KDB_DB_CHANGED\"; break;\n     case KRB5_KDB_TRUNCATED_RECORD:\n\t  code_string = \"KRB5_KDB_TRUNCATED_RECORD\"; break;\n     case KRB5_KDB_RECURSIVELOCK:\n\t  code_string = \"KRB5_KDB_RECURSIVELOCK\"; break;\n     case KRB5_KDB_NOTLOCKED: code_string = \"KRB5_KDB_NOTLOCKED\"; break;\n     case KRB5_KDB_BADLOCKMODE: code_string = \"KRB5_KDB_BADLOCKMODE\"; break;\n     case KRB5_KDB_DBNOTINITED: code_string = \"KRB5_KDB_DBNOTINITED\"; break;\n     case KRB5_KDB_DBINITED: code_string = \"KRB5_KDB_DBINITED\"; break;\n     case KRB5_KDB_ILLDIRECTION: code_string = \"KRB5_KDB_ILLDIRECTION\"; break;\n     case KRB5_KDB_NOMASTERKEY: code_string = \"KRB5_KDB_NOMASTERKEY\"; break;\n     case KRB5_KDB_BADMASTERKEY: code_string = \"KRB5_KDB_BADMASTERKEY\"; break;\n     case KRB5_KDB_INVALIDKEYSIZE:\n\t  code_string = \"KRB5_KDB_INVALIDKEYSIZE\"; break;\n     case KRB5_KDB_CANTREAD_STORED:\n\t  code_string = \"KRB5_KDB_CANTREAD_STORED\"; break;\n     case KRB5_KDB_BADSTORED_MKEY:\n\t  code_string = \"KRB5_KDB_BADSTORED_MKEY\"; break;\n     case KRB5_KDB_CANTLOCK_DB: code_string = \"KRB5_KDB_CANTLOCK_DB\"; break;\n     case KRB5_KDB_DB_CORRUPT: code_string = \"KRB5_KDB_DB_CORRUPT\"; break;\n     case KRB5_PARSE_ILLCHAR: code_string = \"KRB5_PARSE_ILLCHAR\"; break;\n     case KRB5_PARSE_MALFORMED: code_string = \"KRB5_PARSE_MALFORMED\"; break;\n     case KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN: code_string = \"KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN\"; break;\n     case KRB5_REALM_UNKNOWN: code_string = \"KRB5_REALM_UNKNOWN\"; break;\n     case KRB5_KDC_UNREACH: code_string = \"KRB5_KDC_UNREACH\"; break;\n     case KRB5_KDCREP_MODIFIED: code_string = \"KRB5_KDCREP_MODIFIED\"; break;\n     case KRB5KRB_AP_ERR_BAD_INTEGRITY: code_string  = \"KRB5KRB_AP_ERR_BAD_INTEGRITY\"; break;\n     case KRB5KDC_ERR_C_PRINCIPAL_UNKNOWN: code_string = \"KRB5KDC_ERR_C_PRINCIPAL_UNKNOWN\"; break;\n     case EINVAL: code_string = \"EINVAL\"; break;\n     case ENOENT: code_string = \"ENOENT\"; break;\n     default:\n\t fprintf(stderr, \"**** CODE %d (%s) ***\\n\", code,\n\t\t error_message (code));\n\t code_string = \"UNKNOWN\";\n\t break;\n     }\n\n     error_string = error_message(code);\n\n     if (! (dstring = (Tcl_DString *) malloc(sizeof(Tcl_DString)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX Do we really want to exit?  Ok if this is */\n\t\t   /* just a test program, but what about if it gets */\n\t\t   /* used for other things later? */\n     }\n\n     Tcl_DStringInit(dstring);\n\n     if (! (Tcl_DStringAppendElement(dstring, \"ERROR\") &&\n\t    Tcl_DStringAppendElement(dstring, code_string) &&\n\t    Tcl_DStringAppendElement(dstring, error_string))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n     \n     return dstring;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "request_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/server/ovsec_kadmd.c",
          "lines": "841-846",
          "snippet": "void request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}",
          "includes": [
            "#include    \"purify.h\"",
            "#include    \"misc.h\"",
            "#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */",
            "#include    <string.h>",
            "#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */",
            "#include    <krb5/adm_proto.h>",
            "#include    <kadm5/server_acl.h>",
            "#include    <kadm5/kadm_rpc.h>",
            "#include    <kadm5/admin.h>",
            "#include    <gssrpc/auth_gssapi.h>",
            "#include    \"gssapiP_krb5.h\" /* for kg_get_context */",
            "#include    <gssapi/gssapi.h>",
            "#include    <gssrpc/rpc.h>",
            "#include    <arpa/inet.h>  /* inet_ntoa */",
            "#include    <netinet/in.h>",
            "#include    <unistd.h>",
            "#include    <sys/socket.h>",
            "#include    <sys/time.h>",
            "#include    <sys/select.h>",
            "#include    <sys/types.h>",
            "#include    <syslog.h>",
            "#include    <signal.h>",
            "#include    <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "volatile int\tsignal_request_exit = 0;",
            "void\trequest_exit(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include    \"purify.h\"\n#include    \"misc.h\"\n#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */\n#include    <string.h>\n#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */\n#include    <krb5/adm_proto.h>\n#include    <kadm5/server_acl.h>\n#include    <kadm5/kadm_rpc.h>\n#include    <kadm5/admin.h>\n#include    <gssrpc/auth_gssapi.h>\n#include    \"gssapiP_krb5.h\" /* for kg_get_context */\n#include    <gssapi/gssapi.h>\n#include    <gssrpc/rpc.h>\n#include    <arpa/inet.h>  /* inet_ntoa */\n#include    <netinet/in.h>\n#include    <unistd.h>\n#include    <sys/socket.h>\n#include    <sys/time.h>\n#include    <sys/select.h>\n#include    <sys/types.h>\n#include    <syslog.h>\n#include    <signal.h>\n#include    <stdio.h>\n\nvolatile int\tsignal_request_exit = 0;\nvoid\trequest_exit(int);\n\nvoid request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "dstring",
            "error_string"
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "dstring",
            "code_string"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppendElement",
          "args": [
            "dstring",
            "\"ERROR\""
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringInit",
          "args": [
            "dstring"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(Tcl_DString)"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error_message",
          "args": [
            "code"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"**** CODE %d (%s) ***\\n\"",
            "code",
            "error_message (code)"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error_message",
          "args": [
            "code"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_DString *unparse_err(ovsec_kadm_ret_t code)\n{\n     char *code_string;\n     const char *error_string;\n     Tcl_DString *dstring;\n\n     switch (code) {\n     case OVSEC_KADM_FAILURE: code_string = \"OVSEC_KADM_FAILURE\"; break;\n     case OVSEC_KADM_AUTH_GET: code_string = \"OVSEC_KADM_AUTH_GET\"; break;\n     case OVSEC_KADM_AUTH_ADD: code_string = \"OVSEC_KADM_AUTH_ADD\"; break;\n     case OVSEC_KADM_AUTH_MODIFY:\n\t  code_string = \"OVSEC_KADM_AUTH_MODIFY\"; break;\n     case OVSEC_KADM_AUTH_DELETE:\n\t  code_string = \"OVSEC_KADM_AUTH_DELETE\"; break;\n     case OVSEC_KADM_AUTH_INSUFFICIENT:\n\t  code_string = \"OVSEC_KADM_AUTH_INSUFFICIENT\"; break;\n     case OVSEC_KADM_BAD_DB: code_string = \"OVSEC_KADM_BAD_DB\"; break;\n     case OVSEC_KADM_DUP: code_string = \"OVSEC_KADM_DUP\"; break;\n     case OVSEC_KADM_RPC_ERROR: code_string = \"OVSEC_KADM_RPC_ERROR\"; break;\n     case OVSEC_KADM_NO_SRV: code_string = \"OVSEC_KADM_NO_SRV\"; break;\n     case OVSEC_KADM_BAD_HIST_KEY:\n\t  code_string = \"OVSEC_KADM_BAD_HIST_KEY\"; break;\n     case OVSEC_KADM_NOT_INIT: code_string = \"OVSEC_KADM_NOT_INIT\"; break;\n     case OVSEC_KADM_INIT: code_string = \"OVSEC_KADM_INIT\"; break;\n     case OVSEC_KADM_BAD_PASSWORD:\n\t  code_string = \"OVSEC_KADM_BAD_PASSWORD\"; break;\n     case OVSEC_KADM_UNK_PRINC: code_string = \"OVSEC_KADM_UNK_PRINC\"; break;\n     case OVSEC_KADM_UNK_POLICY: code_string = \"OVSEC_KADM_UNK_POLICY\"; break;\n     case OVSEC_KADM_BAD_MASK: code_string = \"OVSEC_KADM_BAD_MASK\"; break;\n     case OVSEC_KADM_BAD_CLASS: code_string = \"OVSEC_KADM_BAD_CLASS\"; break;\n     case OVSEC_KADM_BAD_LENGTH: code_string = \"OVSEC_KADM_BAD_LENGTH\"; break;\n     case OVSEC_KADM_BAD_POLICY: code_string = \"OVSEC_KADM_BAD_POLICY\"; break;\n     case OVSEC_KADM_BAD_HISTORY: code_string = \"OVSEC_KADM_BAD_HISTORY\"; break;\n     case OVSEC_KADM_BAD_PRINCIPAL:\n\t  code_string = \"OVSEC_KADM_BAD_PRINCIPAL\"; break;\n     case OVSEC_KADM_BAD_AUX_ATTR:\n\t  code_string = \"OVSEC_KADM_BAD_AUX_ATTR\"; break;\n     case OVSEC_KADM_PASS_Q_TOOSHORT:\n\t  code_string = \"OVSEC_KADM_PASS_Q_TOOSHORT\"; break;\n     case OVSEC_KADM_PASS_Q_CLASS:\n\t  code_string = \"OVSEC_KADM_PASS_Q_CLASS\"; break;\n     case OVSEC_KADM_PASS_Q_DICT:\n\t  code_string = \"OVSEC_KADM_PASS_Q_DICT\"; break;\n     case OVSEC_KADM_PASS_REUSE: code_string = \"OVSEC_KADM_PASS_REUSE\"; break;\n     case OVSEC_KADM_PASS_TOOSOON:\n\t  code_string = \"OVSEC_KADM_PASS_TOOSOON\"; break;\n     case OVSEC_KADM_POLICY_REF:\n\t  code_string = \"OVSEC_KADM_POLICY_REF\"; break;\n     case OVSEC_KADM_PROTECT_PRINCIPAL:\n\t  code_string = \"OVSEC_KADM_PROTECT_PRINCIPAL\"; break;\n     case OVSEC_KADM_BAD_SERVER_HANDLE:\n\t  code_string = \"OVSEC_KADM_BAD_SERVER_HANDLE\"; break;\n     case OVSEC_KADM_BAD_STRUCT_VERSION:\n     \t  code_string = \"OVSEC_KADM_BAD_STRUCT_VERSION\"; break;\n     case OVSEC_KADM_OLD_STRUCT_VERSION:\n\t  code_string = \"OVSEC_KADM_OLD_STRUCT_VERSION\"; break;\n     case OVSEC_KADM_NEW_STRUCT_VERSION:\n\t  code_string = \"OVSEC_KADM_NEW_STRUCT_VERSION\"; break;\n     case OVSEC_KADM_BAD_API_VERSION:\n\t  code_string = \"OVSEC_KADM_BAD_API_VERSION\"; break;\n     case OVSEC_KADM_OLD_LIB_API_VERSION:\n     \t  code_string = \"OVSEC_KADM_OLD_LIB_API_VERSION\"; break;\n     case OVSEC_KADM_OLD_SERVER_API_VERSION:\n     \t  code_string = \"OVSEC_KADM_OLD_SERVER_API_VERSION\"; break;\n     case OVSEC_KADM_NEW_LIB_API_VERSION:\n     \t  code_string = \"OVSEC_KADM_NEW_LIB_API_VERSION\"; break;\n     case OVSEC_KADM_NEW_SERVER_API_VERSION:\n\t  code_string = \"OVSEC_KADM_NEW_SERVER_API_VERSION\"; break;\n     case OVSEC_KADM_SECURE_PRINC_MISSING:\n\t  code_string = \"OVSEC_KADM_SECURE_PRINC_MISSING\"; break;\n     case KADM5_NO_RENAME_SALT:\n\t  code_string = \"KADM5_NO_RENAME_SALT\"; break;\n     case KADM5_BAD_CLIENT_PARAMS:\n\t  code_string = \"KADM5_BAD_CLIENT_PARAMS\"; break;\n     case KADM5_BAD_SERVER_PARAMS:\n\t  code_string = \"KADM5_BAD_SERVER_PARAMS\"; break;\n     case KADM5_AUTH_LIST:\n\t  code_string = \"KADM5_AUTH_LIST\"; break;\n     case KADM5_AUTH_CHANGEPW:\n\t  code_string = \"KADM5_AUTH_CHANGEPW\"; break;\n     case OSA_ADB_DUP: code_string = \"OSA_ADB_DUP\"; break;\n     case OSA_ADB_NOENT: code_string = \"ENOENT\"; break;\n     case OSA_ADB_DBINIT: code_string = \"OSA_ADB_DBINIT\"; break;\n     case OSA_ADB_BAD_POLICY: code_string = \"Bad policy name\"; break;\n     case OSA_ADB_BAD_PRINC: code_string = \"Bad principal name\"; break;\n     case OSA_ADB_BAD_DB: code_string = \"Invalid database.\"; break;\n     case OSA_ADB_XDR_FAILURE: code_string = \"OSA_ADB_XDR_FAILURE\"; break;\n     case KRB5_KDB_INUSE: code_string = \"KRB5_KDB_INUSE\"; break;\n     case KRB5_KDB_UK_SERROR: code_string = \"KRB5_KDB_UK_SERROR\"; break;\n     case KRB5_KDB_UK_RERROR: code_string = \"KRB5_KDB_UK_RERROR\"; break;\n     case KRB5_KDB_UNAUTH: code_string = \"KRB5_KDB_UNAUTH\"; break;\n     case KRB5_KDB_NOENTRY: code_string = \"KRB5_KDB_NOENTRY\"; break;\n     case KRB5_KDB_ILL_WILDCARD: code_string = \"KRB5_KDB_ILL_WILDCARD\"; break;\n     case KRB5_KDB_DB_INUSE: code_string = \"KRB5_KDB_DB_INUSE\"; break;\n     case KRB5_KDB_DB_CHANGED: code_string = \"KRB5_KDB_DB_CHANGED\"; break;\n     case KRB5_KDB_TRUNCATED_RECORD:\n\t  code_string = \"KRB5_KDB_TRUNCATED_RECORD\"; break;\n     case KRB5_KDB_RECURSIVELOCK:\n\t  code_string = \"KRB5_KDB_RECURSIVELOCK\"; break;\n     case KRB5_KDB_NOTLOCKED: code_string = \"KRB5_KDB_NOTLOCKED\"; break;\n     case KRB5_KDB_BADLOCKMODE: code_string = \"KRB5_KDB_BADLOCKMODE\"; break;\n     case KRB5_KDB_DBNOTINITED: code_string = \"KRB5_KDB_DBNOTINITED\"; break;\n     case KRB5_KDB_DBINITED: code_string = \"KRB5_KDB_DBINITED\"; break;\n     case KRB5_KDB_ILLDIRECTION: code_string = \"KRB5_KDB_ILLDIRECTION\"; break;\n     case KRB5_KDB_NOMASTERKEY: code_string = \"KRB5_KDB_NOMASTERKEY\"; break;\n     case KRB5_KDB_BADMASTERKEY: code_string = \"KRB5_KDB_BADMASTERKEY\"; break;\n     case KRB5_KDB_INVALIDKEYSIZE:\n\t  code_string = \"KRB5_KDB_INVALIDKEYSIZE\"; break;\n     case KRB5_KDB_CANTREAD_STORED:\n\t  code_string = \"KRB5_KDB_CANTREAD_STORED\"; break;\n     case KRB5_KDB_BADSTORED_MKEY:\n\t  code_string = \"KRB5_KDB_BADSTORED_MKEY\"; break;\n     case KRB5_KDB_CANTLOCK_DB: code_string = \"KRB5_KDB_CANTLOCK_DB\"; break;\n     case KRB5_KDB_DB_CORRUPT: code_string = \"KRB5_KDB_DB_CORRUPT\"; break;\n     case KRB5_PARSE_ILLCHAR: code_string = \"KRB5_PARSE_ILLCHAR\"; break;\n     case KRB5_PARSE_MALFORMED: code_string = \"KRB5_PARSE_MALFORMED\"; break;\n     case KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN: code_string = \"KRB5KDC_ERR_S_PRINCIPAL_UNKNOWN\"; break;\n     case KRB5_REALM_UNKNOWN: code_string = \"KRB5_REALM_UNKNOWN\"; break;\n     case KRB5_KDC_UNREACH: code_string = \"KRB5_KDC_UNREACH\"; break;\n     case KRB5_KDCREP_MODIFIED: code_string = \"KRB5_KDCREP_MODIFIED\"; break;\n     case KRB5KRB_AP_ERR_BAD_INTEGRITY: code_string  = \"KRB5KRB_AP_ERR_BAD_INTEGRITY\"; break;\n     case KRB5KDC_ERR_C_PRINCIPAL_UNKNOWN: code_string = \"KRB5KDC_ERR_C_PRINCIPAL_UNKNOWN\"; break;\n     case EINVAL: code_string = \"EINVAL\"; break;\n     case ENOENT: code_string = \"ENOENT\"; break;\n     default:\n\t fprintf(stderr, \"**** CODE %d (%s) ***\\n\", code,\n\t\t error_message (code));\n\t code_string = \"UNKNOWN\";\n\t break;\n     }\n\n     error_string = error_message(code);\n\n     if (! (dstring = (Tcl_DString *) malloc(sizeof(Tcl_DString)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX Do we really want to exit?  Ok if this is */\n\t\t   /* just a test program, but what about if it gets */\n\t\t   /* used for other things later? */\n     }\n\n     Tcl_DStringInit(dstring);\n\n     if (! (Tcl_DStringAppendElement(dstring, \"ERROR\") &&\n\t    Tcl_DStringAppendElement(dstring, code_string) &&\n\t    Tcl_DStringAppendElement(dstring, error_string))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n     \n     return dstring;\n}"
  },
  {
    "function_name": "set_ok",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "244-249",
    "snippet": "static void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "string"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendElement",
          "args": [
            "interp",
            "\"OVSEC_KADM_OK\""
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_SetResult",
          "args": [
            "interp",
            "\"OK\"",
            "TCL_STATIC"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void set_ok(Tcl_Interp *interp, char *string)\n{\n     Tcl_SetResult(interp, \"OK\", TCL_STATIC);\n     Tcl_AppendElement(interp, \"OVSEC_KADM_OK\");\n     Tcl_AppendElement(interp, string);\n}"
  },
  {
    "function_name": "parse_str",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "229-241",
    "snippet": "static int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "in_str",
            "\"null\""
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic int parse_str(Tcl_Interp *interp, char *in_str, char **out_str)\n{\n     if (! in_str) {\n\t  *out_str = 0;\n     }\n     else if (! strcasecmp(in_str, \"null\")) {\n\t  *out_str = 0;\n     }\n     else {\n\t  *out_str = in_str;\n     }\n     return TCL_OK;\n}"
  },
  {
    "function_name": "unparse_str",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "206-225",
    "snippet": "static Tcl_DString *unparse_str(char *in_str)\n{\n     Tcl_DString *str;\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     if (! in_str) {\n\t  Tcl_DStringAppend(str, \"null\", -1);\n     }\n     else {\n\t  Tcl_DStringAppend(str, in_str, -1);\n     }\n\n     return str;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Tcl_DStringAppend",
          "args": [
            "str",
            "in_str",
            "-1"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringAppend",
          "args": [
            "str",
            "\"null\"",
            "-1"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_DStringInit",
          "args": [
            "str"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "request_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/server/ovsec_kadmd.c",
          "lines": "841-846",
          "snippet": "void request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}",
          "includes": [
            "#include    \"purify.h\"",
            "#include    \"misc.h\"",
            "#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */",
            "#include    <string.h>",
            "#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */",
            "#include    <krb5/adm_proto.h>",
            "#include    <kadm5/server_acl.h>",
            "#include    <kadm5/kadm_rpc.h>",
            "#include    <kadm5/admin.h>",
            "#include    <gssrpc/auth_gssapi.h>",
            "#include    \"gssapiP_krb5.h\" /* for kg_get_context */",
            "#include    <gssapi/gssapi.h>",
            "#include    <gssrpc/rpc.h>",
            "#include    <arpa/inet.h>  /* inet_ntoa */",
            "#include    <netinet/in.h>",
            "#include    <unistd.h>",
            "#include    <sys/socket.h>",
            "#include    <sys/time.h>",
            "#include    <sys/select.h>",
            "#include    <sys/types.h>",
            "#include    <syslog.h>",
            "#include    <signal.h>",
            "#include    <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "volatile int\tsignal_request_exit = 0;",
            "void\trequest_exit(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include    \"purify.h\"\n#include    \"misc.h\"\n#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */\n#include    <string.h>\n#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */\n#include    <krb5/adm_proto.h>\n#include    <kadm5/server_acl.h>\n#include    <kadm5/kadm_rpc.h>\n#include    <kadm5/admin.h>\n#include    <gssrpc/auth_gssapi.h>\n#include    \"gssapiP_krb5.h\" /* for kg_get_context */\n#include    <gssapi/gssapi.h>\n#include    <gssrpc/rpc.h>\n#include    <arpa/inet.h>  /* inet_ntoa */\n#include    <netinet/in.h>\n#include    <unistd.h>\n#include    <sys/socket.h>\n#include    <sys/time.h>\n#include    <sys/select.h>\n#include    <sys/types.h>\n#include    <syslog.h>\n#include    <signal.h>\n#include    <stdio.h>\n\nvolatile int\tsignal_request_exit = 0;\nvoid\trequest_exit(int);\n\nvoid request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*str)"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_DString *unparse_str(char *in_str)\n{\n     Tcl_DString *str;\n\n     if (! (str = malloc(sizeof(*str)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_DStringInit(str);\n\n     if (! in_str) {\n\t  Tcl_DStringAppend(str, \"null\", -1);\n     }\n     else {\n\t  Tcl_DStringAppend(str, in_str, -1);\n     }\n\n     return str;\n}"
  },
  {
    "function_name": "create_flag_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "178-203",
    "snippet": "static Tcl_HashTable *create_flag_table(struct flagval *flags, int size)\n{\n     Tcl_HashTable *table;\n     Tcl_HashEntry *entry;\n     int i;\n\n     if (! (table = (Tcl_HashTable *) malloc(sizeof(Tcl_HashTable)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_InitHashTable(table, TCL_STRING_KEYS);\n\n     for (i = 0; i < size; i++) {\n\t  int newPtr;\n\t       \n\t  if (! (entry = Tcl_CreateHashEntry(table, flags[i].name, &newPtr))) {\n\t       fprintf(stderr, \"Out of memory!\\n\");\n\t       exit(1); /* XXX */\n\t  }\n\n\t  Tcl_SetHashValue(entry, &flags[i].val);\n     }\n\n     return table;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Tcl_SetHashValue",
          "args": [
            "entry",
            "&flags[i].val"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "request_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/server/ovsec_kadmd.c",
          "lines": "841-846",
          "snippet": "void request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}",
          "includes": [
            "#include    \"purify.h\"",
            "#include    \"misc.h\"",
            "#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */",
            "#include    <string.h>",
            "#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */",
            "#include    <krb5/adm_proto.h>",
            "#include    <kadm5/server_acl.h>",
            "#include    <kadm5/kadm_rpc.h>",
            "#include    <kadm5/admin.h>",
            "#include    <gssrpc/auth_gssapi.h>",
            "#include    \"gssapiP_krb5.h\" /* for kg_get_context */",
            "#include    <gssapi/gssapi.h>",
            "#include    <gssrpc/rpc.h>",
            "#include    <arpa/inet.h>  /* inet_ntoa */",
            "#include    <netinet/in.h>",
            "#include    <unistd.h>",
            "#include    <sys/socket.h>",
            "#include    <sys/time.h>",
            "#include    <sys/select.h>",
            "#include    <sys/types.h>",
            "#include    <syslog.h>",
            "#include    <signal.h>",
            "#include    <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "volatile int\tsignal_request_exit = 0;",
            "void\trequest_exit(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include    \"purify.h\"\n#include    \"misc.h\"\n#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */\n#include    <string.h>\n#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */\n#include    <krb5/adm_proto.h>\n#include    <kadm5/server_acl.h>\n#include    <kadm5/kadm_rpc.h>\n#include    <kadm5/admin.h>\n#include    <gssrpc/auth_gssapi.h>\n#include    \"gssapiP_krb5.h\" /* for kg_get_context */\n#include    <gssapi/gssapi.h>\n#include    <gssrpc/rpc.h>\n#include    <arpa/inet.h>  /* inet_ntoa */\n#include    <netinet/in.h>\n#include    <unistd.h>\n#include    <sys/socket.h>\n#include    <sys/time.h>\n#include    <sys/select.h>\n#include    <sys/types.h>\n#include    <syslog.h>\n#include    <signal.h>\n#include    <stdio.h>\n\nvolatile int\tsignal_request_exit = 0;\nvoid\trequest_exit(int);\n\nvoid request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateHashEntry",
          "args": [
            "table",
            "flags[i].name",
            "&newPtr"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_InitHashTable",
          "args": [
            "table",
            "TCL_STRING_KEYS"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(Tcl_HashTable)"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_HashTable *create_flag_table(struct flagval *flags, int size)\n{\n     Tcl_HashTable *table;\n     Tcl_HashEntry *entry;\n     int i;\n\n     if (! (table = (Tcl_HashTable *) malloc(sizeof(Tcl_HashTable)))) {\n\t  fprintf(stderr, \"Out of memory!\\n\");\n\t  exit(1); /* XXX */\n     }\n\n     Tcl_InitHashTable(table, TCL_STRING_KEYS);\n\n     for (i = 0; i < size; i++) {\n\t  int newPtr;\n\t       \n\t  if (! (entry = Tcl_CreateHashEntry(table, flags[i].name, &newPtr))) {\n\t       fprintf(stderr, \"Out of memory!\\n\");\n\t       exit(1); /* XXX */\n\t  }\n\n\t  Tcl_SetHashValue(entry, &flags[i].val);\n     }\n\n     return table;\n}"
  },
  {
    "function_name": "remove_server_handle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "137-149",
    "snippet": "static int remove_server_handle(Tcl_Interp *interp, char *name) \n{\n    Tcl_HashEntry *entry;\n\n    if (! (struct_table &&\n\t   (entry = Tcl_FindHashEntry(struct_table, name)))) {\n\tTcl_AppendResult(interp, \"unknown server handle \", name, 0);\n\treturn TCL_ERROR;\n    }\n\n    Tcl_DeleteHashEntry(entry);\n    return TCL_OK;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static Tcl_HashTable *struct_table = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "Tcl_DeleteHashEntry",
          "args": [
            "entry"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendResult",
          "args": [
            "interp",
            "\"unknown server handle \"",
            "name",
            "0"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_FindHashEntry",
          "args": [
            "struct_table",
            "name"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_HashTable *struct_table = 0;\n\nstatic int remove_server_handle(Tcl_Interp *interp, char *name) \n{\n    Tcl_HashEntry *entry;\n\n    if (! (struct_table &&\n\t   (entry = Tcl_FindHashEntry(struct_table, name)))) {\n\tTcl_AppendResult(interp, \"unknown server handle \", name, 0);\n\treturn TCL_ERROR;\n    }\n\n    Tcl_DeleteHashEntry(entry);\n    return TCL_OK;\n}"
  },
  {
    "function_name": "get_server_handle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "116-135",
    "snippet": "static int get_server_handle(Tcl_Interp *interp, char *name, void **handle) \n{\n    Tcl_HashEntry *entry;\n\n    if(!strcasecmp(name, \"null\"))\n\t*handle = 0;\n    else {\n\tif (! (struct_table &&\n\t       (entry = Tcl_FindHashEntry(struct_table, name)))) {\n\t     if (strncmp(name, \"kadm5_handle\", 12) == 0)\n\t\t  Tcl_AppendResult(interp, \"kadm5 handle specified \"\n\t\t\t\t   \"for ovsec_kadm api: \", name, 0);\n\t     else \n\t\t  Tcl_AppendResult(interp, \"unknown server handle \", name, 0);\n\t    return TCL_ERROR;\n\t}\n\t*handle = (void *) Tcl_GetHashValue(entry);\n    }\n    return TCL_OK;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static Tcl_HashTable *struct_table = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "Tcl_GetHashValue",
          "args": [
            "entry"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendResult",
          "args": [
            "interp",
            "\"unknown server handle \"",
            "name",
            "0"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_AppendResult",
          "args": [
            "interp",
            "\"kadm5 handle specified \"\n\t\t\t\t   \"for ovsec_kadm api: \"",
            "name",
            "0"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "name",
            "\"kadm5_handle\"",
            "12"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_FindHashEntry",
          "args": [
            "struct_table",
            "name"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "name",
            "\"null\""
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_HashTable *struct_table = 0;\n\nstatic int get_server_handle(Tcl_Interp *interp, char *name, void **handle) \n{\n    Tcl_HashEntry *entry;\n\n    if(!strcasecmp(name, \"null\"))\n\t*handle = 0;\n    else {\n\tif (! (struct_table &&\n\t       (entry = Tcl_FindHashEntry(struct_table, name)))) {\n\t     if (strncmp(name, \"kadm5_handle\", 12) == 0)\n\t\t  Tcl_AppendResult(interp, \"kadm5 handle specified \"\n\t\t\t\t   \"for ovsec_kadm api: \", name, 0);\n\t     else \n\t\t  Tcl_AppendResult(interp, \"unknown server handle \", name, 0);\n\t    return TCL_ERROR;\n\t}\n\t*handle = (void *) Tcl_GetHashValue(entry);\n    }\n    return TCL_OK;\n}"
  },
  {
    "function_name": "put_server_handle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
    "lines": "81-114",
    "snippet": "static int put_server_handle(Tcl_Interp *interp, void *handle, char **name)\n{\n    int i = 1, newPtr = 0;\n    static char buf[20];\n    Tcl_HashEntry *entry;\n\n    if (! struct_table) {\n\tif (! (struct_table =\n\t       malloc(sizeof(*struct_table)))) {\n\t    fprintf(stderr, \"Out of memory!\\n\");\n\t    exit(1); /* XXX */\n\t}\n\tTcl_InitHashTable(struct_table, TCL_STRING_KEYS);\n    }\n\n    do {\n\t/*\n\t * Handles from ovsec_kadm_init() and kadm5_init() should not\n\t * be mixed during unit tests, but the API would happily\n\t * accept them.  Making the hash entry names different in\n\t * tcl_kadm.c and tcl_ovsec_kadm.c ensures that GET_HANDLE\n\t * will fail if presented a handle from the other API.\n\t */\n\tsprintf(buf, \"ovsec_kadm_handle%d\", i);\n\tentry = Tcl_CreateHashEntry(struct_table, buf, &newPtr);\n\ti++;\n    } while (! newPtr);\n\n    Tcl_SetHashValue(entry, handle);\n\n    *name = buf;\n\n    return TCL_OK;\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <k5-int.h>",
      "#include <com_err.h>",
      "#include <kadm5/admin.h>",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>",
      "#include <string.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static Tcl_HashTable *struct_table = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "Tcl_SetHashValue",
          "args": [
            "entry",
            "handle"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_CreateHashEntry",
          "args": [
            "struct_table",
            "buf",
            "&newPtr"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"ovsec_kadm_handle%d\"",
            "i"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tcl_InitHashTable",
          "args": [
            "struct_table",
            "TCL_STRING_KEYS"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "request_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/server/ovsec_kadmd.c",
          "lines": "841-846",
          "snippet": "void request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}",
          "includes": [
            "#include    \"purify.h\"",
            "#include    \"misc.h\"",
            "#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */",
            "#include    <string.h>",
            "#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */",
            "#include    <krb5/adm_proto.h>",
            "#include    <kadm5/server_acl.h>",
            "#include    <kadm5/kadm_rpc.h>",
            "#include    <kadm5/admin.h>",
            "#include    <gssrpc/auth_gssapi.h>",
            "#include    \"gssapiP_krb5.h\" /* for kg_get_context */",
            "#include    <gssapi/gssapi.h>",
            "#include    <gssrpc/rpc.h>",
            "#include    <arpa/inet.h>  /* inet_ntoa */",
            "#include    <netinet/in.h>",
            "#include    <unistd.h>",
            "#include    <sys/socket.h>",
            "#include    <sys/time.h>",
            "#include    <sys/select.h>",
            "#include    <sys/types.h>",
            "#include    <syslog.h>",
            "#include    <signal.h>",
            "#include    <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "volatile int\tsignal_request_exit = 0;",
            "void\trequest_exit(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include    \"purify.h\"\n#include    \"misc.h\"\n#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */\n#include    <string.h>\n#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */\n#include    <krb5/adm_proto.h>\n#include    <kadm5/server_acl.h>\n#include    <kadm5/kadm_rpc.h>\n#include    <kadm5/admin.h>\n#include    <gssrpc/auth_gssapi.h>\n#include    \"gssapiP_krb5.h\" /* for kg_get_context */\n#include    <gssapi/gssapi.h>\n#include    <gssrpc/rpc.h>\n#include    <arpa/inet.h>  /* inet_ntoa */\n#include    <netinet/in.h>\n#include    <unistd.h>\n#include    <sys/socket.h>\n#include    <sys/time.h>\n#include    <sys/select.h>\n#include    <sys/types.h>\n#include    <syslog.h>\n#include    <signal.h>\n#include    <stdio.h>\n\nvolatile int\tsignal_request_exit = 0;\nvoid\trequest_exit(int);\n\nvoid request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Out of memory!\\n\""
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*struct_table)"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic Tcl_HashTable *struct_table = 0;\n\nstatic int put_server_handle(Tcl_Interp *interp, void *handle, char **name)\n{\n    int i = 1, newPtr = 0;\n    static char buf[20];\n    Tcl_HashEntry *entry;\n\n    if (! struct_table) {\n\tif (! (struct_table =\n\t       malloc(sizeof(*struct_table)))) {\n\t    fprintf(stderr, \"Out of memory!\\n\");\n\t    exit(1); /* XXX */\n\t}\n\tTcl_InitHashTable(struct_table, TCL_STRING_KEYS);\n    }\n\n    do {\n\t/*\n\t * Handles from ovsec_kadm_init() and kadm5_init() should not\n\t * be mixed during unit tests, but the API would happily\n\t * accept them.  Making the hash entry names different in\n\t * tcl_kadm.c and tcl_ovsec_kadm.c ensures that GET_HANDLE\n\t * will fail if presented a handle from the other API.\n\t */\n\tsprintf(buf, \"ovsec_kadm_handle%d\", i);\n\tentry = Tcl_CreateHashEntry(struct_table, buf, &newPtr);\n\ti++;\n    } while (! newPtr);\n\n    Tcl_SetHashValue(entry, handle);\n\n    *name = buf;\n\n    return TCL_OK;\n}"
  }
]