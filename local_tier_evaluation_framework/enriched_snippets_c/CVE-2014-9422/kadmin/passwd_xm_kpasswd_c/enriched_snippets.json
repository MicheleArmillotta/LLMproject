[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
    "lines": "405-452",
    "snippet": "void\nmain(argc, argv)\n     int argc;\n     char *argv[];\n{\n  krb5_context context;\n  int code;\n\n  initialize_kpasswd_strings();\n\n  whoami = (whoami = strrchr(argv[0], '/')) ? whoami + 1 : argv[0];\n\n  (void) set_com_err_hook(motif_com_err);\n\n  create_widgets(&argc, argv);\n  XmProcessTraversal(prompt_text, XmTRAVERSE_CURRENT);\n\n  if (retval = krb5_init_context(&context)) {\n       com_err(whoami, retval, \"initializing krb5 context\");\n       exit(retval);\n  }\n\n  while (1)\n    {\n      retval = kpasswd(context, argc, argv);\n      SetStandardCursor();\n\n      if (!retval)\n\tcom_err(0, 0, string_text(KPW_STR_PASSWORD_CHANGED));\n\n      if (retval == 0)\t\t/* 0 is success, so presumably the user */\n\t\t\t\t/* is done. */\n\tXmProcessTraversal(quit_btn, XmTRAVERSE_CURRENT);\n\n      if ((retval == 1) ||\t/* the rest are \"fatal\", so we should */\n\t  (retval == 3) ||\t/* \"force\" the user to quit... */\n\t  (retval == 6) ||\n\t  (retval == 7))\n\t{\n\t  XtSetSensitive(prompt_text, FALSE);\n\t  XmProcessTraversal(quit_btn, XmTRAVERSE_CURRENT);\n\t  XtAppMainLoop(app_con);\n\t}\n    }\n\n  /* NOTREACHED */\n  exit(retval);\n}",
    "includes": [
      "#\tinclude <varargs.h>",
      "#\tinclude <stdarg.h>",
      "#include <X11/Shell.h>",
      "#include <X11/cursorfont.h>",
      "#include <Xm/Separator.h>",
      "#include <Xm/Label.h>",
      "#include <Xm/PushB.h>",
      "#include <Xm/Text.h>",
      "#include <Xm/Form.h>",
      "#include <Xm/ScrolledW.h>",
      "#include <Xm/MessageB.h>",
      "#include <Xm/Xm.h>",
      "#include <string.h>",
      "#include <pwd.h>",
      "#include <stdio.h>",
      "#include \"kpasswd_strings.h\"",
      "#include <krb5.h>",
      "#include <kadm5/admin.h>"
    ],
    "macros_used": [
      "#define initialize_kpasswd_strings initialize_kpws_error_table",
      "#define string_text error_message"
    ],
    "globals_used": [
      "char *whoami;",
      "Widget toplevel, scroll_text, prompt_text;",
      "XtAppContext app_con;",
      "int retval=0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "retval"
          ],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "request_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/server/ovsec_kadmd.c",
          "lines": "841-846",
          "snippet": "void request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}",
          "includes": [
            "#include    \"purify.h\"",
            "#include    \"misc.h\"",
            "#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */",
            "#include    <string.h>",
            "#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */",
            "#include    <krb5/adm_proto.h>",
            "#include    <kadm5/server_acl.h>",
            "#include    <kadm5/kadm_rpc.h>",
            "#include    <kadm5/admin.h>",
            "#include    <gssrpc/auth_gssapi.h>",
            "#include    \"gssapiP_krb5.h\" /* for kg_get_context */",
            "#include    <gssapi/gssapi.h>",
            "#include    <gssrpc/rpc.h>",
            "#include    <arpa/inet.h>  /* inet_ntoa */",
            "#include    <netinet/in.h>",
            "#include    <unistd.h>",
            "#include    <sys/socket.h>",
            "#include    <sys/time.h>",
            "#include    <sys/select.h>",
            "#include    <sys/types.h>",
            "#include    <syslog.h>",
            "#include    <signal.h>",
            "#include    <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "volatile int\tsignal_request_exit = 0;",
            "void\trequest_exit(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include    \"purify.h\"\n#include    \"misc.h\"\n#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */\n#include    <string.h>\n#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */\n#include    <krb5/adm_proto.h>\n#include    <kadm5/server_acl.h>\n#include    <kadm5/kadm_rpc.h>\n#include    <kadm5/admin.h>\n#include    <gssrpc/auth_gssapi.h>\n#include    \"gssapiP_krb5.h\" /* for kg_get_context */\n#include    <gssapi/gssapi.h>\n#include    <gssrpc/rpc.h>\n#include    <arpa/inet.h>  /* inet_ntoa */\n#include    <netinet/in.h>\n#include    <unistd.h>\n#include    <sys/socket.h>\n#include    <sys/time.h>\n#include    <sys/select.h>\n#include    <sys/types.h>\n#include    <syslog.h>\n#include    <signal.h>\n#include    <stdio.h>\n\nvolatile int\tsignal_request_exit = 0;\nvoid\trequest_exit(int);\n\nvoid request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "XtAppMainLoop",
          "args": [
            "app_con"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XmProcessTraversal",
          "args": [
            "quit_btn",
            "XmTRAVERSE_CURRENT"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtSetSensitive",
          "args": [
            "prompt_text",
            "FALSE"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XmProcessTraversal",
          "args": [
            "quit_btn",
            "XmTRAVERSE_CURRENT"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "com_err",
          "args": [
            "0",
            "0",
            "string_text(KPW_STR_PASSWORD_CHANGED)"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "string_text",
          "args": [
            "KPW_STR_PASSWORD_CHANGED"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetStandardCursor",
          "args": [],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "SetStandardCursor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
          "lines": "60-68",
          "snippet": "static void\nSetStandardCursor()\n{\n  static Cursor ArrowCursor = (Cursor)NULL;\n \n  if (ArrowCursor == (Cursor)NULL)\n    ArrowCursor = XCreateFontCursor(XtDisplay(toplevel), XC_top_left_arrow);\n  SetCursor(toplevel, ArrowCursor);\n}",
          "includes": [
            "#\tinclude <varargs.h>",
            "#\tinclude <stdarg.h>",
            "#include <X11/Shell.h>",
            "#include <X11/cursorfont.h>",
            "#include <Xm/Separator.h>",
            "#include <Xm/Label.h>",
            "#include <Xm/PushB.h>",
            "#include <Xm/Text.h>",
            "#include <Xm/Form.h>",
            "#include <Xm/ScrolledW.h>",
            "#include <Xm/MessageB.h>",
            "#include <Xm/Xm.h>",
            "#include <string.h>",
            "#include <pwd.h>",
            "#include <stdio.h>",
            "#include \"kpasswd_strings.h\"",
            "#include <krb5.h>",
            "#include <kadm5/admin.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nstatic void\nSetStandardCursor()\n{\n  static Cursor ArrowCursor = (Cursor)NULL;\n \n  if (ArrowCursor == (Cursor)NULL)\n    ArrowCursor = XCreateFontCursor(XtDisplay(toplevel), XC_top_left_arrow);\n  SetCursor(toplevel, ArrowCursor);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kpasswd",
          "args": [
            "context",
            "argc",
            "argv"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "kpasswd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/kpasswd.c",
          "lines": "73-280",
          "snippet": "int\nkpasswd(context, argc, argv)\n   krb5_context context;\n   int argc;\n   char *argv[];\n{\n  int code;\n  krb5_ccache ccache = NULL;\n  krb5_principal princ = 0;\n  char *princ_str;\n  struct passwd *pw = 0;\n  unsigned int pwsize;\n  char password[255];  /* I don't really like 255 but that's what kinit uses */\n  char msg_ret[1024], admin_realm[1024];\n  ovsec_kadm_principal_ent_t principal_entry = NULL;\n  ovsec_kadm_policy_ent_t policy_entry = NULL;\n  void *server_handle;\n\n  if (argc > 2) {\n      com_err(whoami, KPW_STR_USAGE, 0);\n      return(7);\n      /*NOTREACHED*/\n    }\n\n  /************************************\n   *  Get principal name to change    * \n   ************************************/\n\n  /* Look on the command line first, followed by the default credential\n     cache, followed by defaulting to the Unix user name */\n\n  if (argc == 2)\n    princ_str = strdup(argv[1]);\n  else {\n    code = krb5_cc_default(context, &ccache);\n    /* If we succeed, find who is in the credential cache */\n    if (code == 0) {\n      /* Get default principal from cache if one exists */\n      code = krb5_cc_get_principal(context, ccache, &princ);\n      /* if we got a principal, unparse it, otherwise get out of the if\n\t with an error code */\n      (void) krb5_cc_close(context, ccache);\n      if (code == 0) {\n\tcode = krb5_unparse_name(context, princ, &princ_str);\n\tif (code != 0) {\n\t  com_err(whoami,  code, string_text(KPW_STR_UNPARSE_NAME));\n\t  return(MISC_EXIT_STATUS);\n\t}\n      }\n    }\n\n    /* this is a crock.. we want to compare against */\n    /* \"KRB5_CC_DOESNOTEXIST\" but there is no such error code, and */\n    /* both the file and stdio types return FCC_NOFILE.  If there is */\n    /* ever another ccache type (or if the error codes are ever */\n    /* fixed), this code will have to be updated. */\n    if (code && code != KRB5_FCC_NOFILE) {\n      com_err(whoami, code, string_text(KPW_STR_WHILE_LOOKING_AT_CC));\n      return(MISC_EXIT_STATUS);\n    }\n\n    /* if either krb5_cc failed check the passwd file */\n    if (code != 0) {\n      pw = getpwuid( getuid());\n      if (pw == NULL) {\n\tcom_err(whoami, 0, string_text(KPW_STR_NOT_IN_PASSWD_FILE));\n\treturn(MISC_EXIT_STATUS);\n      }\n      princ_str = strdup(pw->pw_name);\n    }\n  }    \n  \n  display_intro_message(string_text(KPW_STR_CHANGING_PW_FOR), princ_str);\n\n  /* Need to get a krb5_principal, unless we started from with one from\n     the credential cache */\n\n  if (! princ) {\n      code = krb5_parse_name (context, princ_str, &princ);\n      if (code != 0) {\n\t  com_err(whoami, code, string_text(KPW_STR_PARSE_NAME), princ_str);\n\t  free(princ_str);\n\t  return(MISC_EXIT_STATUS);\n      }\n  }\n  \n  pwsize = sizeof(password);\n  code = read_old_password(context, password, &pwsize);\n\n  if (code != 0) {\n    memset(password, 0, sizeof(password));\n    com_err(whoami, code, string_text(KPW_STR_WHILE_READING_PASSWORD));\n    krb5_free_principal(context, princ);\n    free(princ_str);\n    return(MISC_EXIT_STATUS);\n  }\n  if (pwsize == 0) {\n    memset(password, 0, sizeof(password));\n    com_err(whoami, 0, string_text(KPW_STR_NO_PASSWORD_READ));\n    krb5_free_principal(context, princ);\n    free(princ_str);\n    return(5);\n  }\n\n  admin_realm[0] = '\\0';\n  strncat(admin_realm, krb5_princ_realm(context, princ)->data, \n\t  krb5_princ_realm(context, princ)->length);\n\n  code = ovsec_kadm_init(princ_str, password, KADM5_CHANGEPW_SERVICE,\n\t\t\t admin_realm /* we probably should take a -r */\n\t\t\t             /* someday */,\n\t\t\t OVSEC_KADM_STRUCT_VERSION,\n\t\t\t OVSEC_KADM_API_VERSION_1,\n\t\t\t &server_handle);\n  if (code != 0) {\n    if (code == OVSEC_KADM_BAD_PASSWORD)\n      com_err(whoami, 0, string_text(KPW_STR_OLD_PASSWORD_INCORRECT));\n    else \n      com_err(whoami, 0, string_text(KPW_STR_CANT_OPEN_ADMIN_SERVER), admin_realm,\n\t      error_message(code));\n    krb5_free_principal(context, princ);\n    free(princ_str);\n    return((code == OVSEC_KADM_BAD_PASSWORD)?2:3);\n  }\n\n  /* Explain policy restrictions on new password if any. */\n  /* Note: copy of this exists in login (kverify.c/get_verified_in_tkt). */\n\n  code = ovsec_kadm_get_principal(server_handle, princ, &principal_entry);\n  if (code != 0) {\n    com_err(whoami, 0,\n\t    string_text((code == OVSEC_KADM_UNK_PRINC)\n\t\t\t? KPW_STR_PRIN_UNKNOWN : KPW_STR_CANT_GET_POLICY_INFO),\n\t    princ_str);\n    krb5_free_principal(context, princ);\n    free(princ_str);\n    (void) ovsec_kadm_destroy(server_handle);\n    return((code == OVSEC_KADM_UNK_PRINC) ? 1 : MISC_EXIT_STATUS);\n  }\n  if ((principal_entry->aux_attributes & OVSEC_KADM_POLICY) != 0) {\n    code = ovsec_kadm_get_policy(server_handle,\n\t\t\t\t principal_entry->policy, &policy_entry);\n    if (code != 0) {\n      /* doesn't matter which error comes back, there's no nice recovery\n\t or need to differentiate to the user */\n      com_err(whoami, 0,\n\t      string_text(KPW_STR_CANT_GET_POLICY_INFO), princ_str);\n      (void) ovsec_kadm_free_principal_ent(server_handle, principal_entry);\n      krb5_free_principal(context, princ);\n      free(princ_str);\n      (void) ovsec_kadm_destroy(server_handle);\n      return(MISC_EXIT_STATUS);\n    }\n    com_err(whoami, 0, string_text(KPW_STR_POLICY_EXPLANATION),\n\t    princ_str, principal_entry->policy,\n\t    policy_entry->pw_min_length, policy_entry->pw_min_classes);\n\n    code = ovsec_kadm_free_principal_ent(server_handle, principal_entry);\n    if (code) {\n\t(void) ovsec_kadm_free_policy_ent(server_handle, policy_entry);\n\tkrb5_free_principal(context, princ);\n\tfree(princ_str);\n\tcom_err(whoami, code, string_text(KPW_STR_WHILE_FREEING_PRINCIPAL));\n\t(void) ovsec_kadm_destroy(server_handle);\n\treturn(MISC_EXIT_STATUS);\n    }\n\n    code = ovsec_kadm_free_policy_ent(server_handle, policy_entry);\n    if (code) {\n\tkrb5_free_principal(context, princ);\n\tfree(princ_str);\n\tcom_err(whoami, code, string_text(KPW_STR_WHILE_FREEING_POLICY));\n\t(void) ovsec_kadm_destroy(server_handle);\n\treturn(MISC_EXIT_STATUS);\n    }\n  }\n  else {\n    /* kpasswd *COULD* output something here to encourage the choice\n       of good passwords, in the absence of an enforced policy. */\n      code = ovsec_kadm_free_principal_ent(server_handle, principal_entry);\n      if (code) {\n\t  krb5_free_principal(context, princ);\n\t  free(princ_str);\n\t  com_err(whoami, code, string_text(KPW_STR_WHILE_FREEING_PRINCIPAL));\n\t  (void) ovsec_kadm_destroy(server_handle);\n\t  return(MISC_EXIT_STATUS);\n      }\n  }\n\n  pwsize = sizeof(password);\n  code = read_new_password(server_handle, password, &pwsize, msg_ret, princ);\n  memset(password, 0, sizeof(password));\n\n  if (code)\n    com_err(whoami, 0, msg_ret);\n\n  krb5_free_principal(context, princ);\n  free(princ_str);\n\n  (void) ovsec_kadm_destroy(server_handle);\n  \n  if (code == KRB5_LIBOS_CANTREADPWD)\n     return(5);\n  else if (code)\n     return(4);\n  else\n     return(0);\n}",
          "includes": [
            "#include <string.h>",
            "#include <pwd.h>",
            "#include <stdio.h>",
            "#include \"kpasswd.h\"",
            "#include \"kpasswd_strings.h\"",
            "#include <krb5.h>",
            "#include <kadm5/admin.h>"
          ],
          "macros_used": [
            "#define MISC_EXIT_STATUS 6",
            "#define string_text error_message"
          ],
          "globals_used": [
            "extern char *whoami;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd.h\"\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\n#define MISC_EXIT_STATUS 6\n#define string_text error_message\n\nextern char *whoami;\n\nint\nkpasswd(context, argc, argv)\n   krb5_context context;\n   int argc;\n   char *argv[];\n{\n  int code;\n  krb5_ccache ccache = NULL;\n  krb5_principal princ = 0;\n  char *princ_str;\n  struct passwd *pw = 0;\n  unsigned int pwsize;\n  char password[255];  /* I don't really like 255 but that's what kinit uses */\n  char msg_ret[1024], admin_realm[1024];\n  ovsec_kadm_principal_ent_t principal_entry = NULL;\n  ovsec_kadm_policy_ent_t policy_entry = NULL;\n  void *server_handle;\n\n  if (argc > 2) {\n      com_err(whoami, KPW_STR_USAGE, 0);\n      return(7);\n      /*NOTREACHED*/\n    }\n\n  /************************************\n   *  Get principal name to change    * \n   ************************************/\n\n  /* Look on the command line first, followed by the default credential\n     cache, followed by defaulting to the Unix user name */\n\n  if (argc == 2)\n    princ_str = strdup(argv[1]);\n  else {\n    code = krb5_cc_default(context, &ccache);\n    /* If we succeed, find who is in the credential cache */\n    if (code == 0) {\n      /* Get default principal from cache if one exists */\n      code = krb5_cc_get_principal(context, ccache, &princ);\n      /* if we got a principal, unparse it, otherwise get out of the if\n\t with an error code */\n      (void) krb5_cc_close(context, ccache);\n      if (code == 0) {\n\tcode = krb5_unparse_name(context, princ, &princ_str);\n\tif (code != 0) {\n\t  com_err(whoami,  code, string_text(KPW_STR_UNPARSE_NAME));\n\t  return(MISC_EXIT_STATUS);\n\t}\n      }\n    }\n\n    /* this is a crock.. we want to compare against */\n    /* \"KRB5_CC_DOESNOTEXIST\" but there is no such error code, and */\n    /* both the file and stdio types return FCC_NOFILE.  If there is */\n    /* ever another ccache type (or if the error codes are ever */\n    /* fixed), this code will have to be updated. */\n    if (code && code != KRB5_FCC_NOFILE) {\n      com_err(whoami, code, string_text(KPW_STR_WHILE_LOOKING_AT_CC));\n      return(MISC_EXIT_STATUS);\n    }\n\n    /* if either krb5_cc failed check the passwd file */\n    if (code != 0) {\n      pw = getpwuid( getuid());\n      if (pw == NULL) {\n\tcom_err(whoami, 0, string_text(KPW_STR_NOT_IN_PASSWD_FILE));\n\treturn(MISC_EXIT_STATUS);\n      }\n      princ_str = strdup(pw->pw_name);\n    }\n  }    \n  \n  display_intro_message(string_text(KPW_STR_CHANGING_PW_FOR), princ_str);\n\n  /* Need to get a krb5_principal, unless we started from with one from\n     the credential cache */\n\n  if (! princ) {\n      code = krb5_parse_name (context, princ_str, &princ);\n      if (code != 0) {\n\t  com_err(whoami, code, string_text(KPW_STR_PARSE_NAME), princ_str);\n\t  free(princ_str);\n\t  return(MISC_EXIT_STATUS);\n      }\n  }\n  \n  pwsize = sizeof(password);\n  code = read_old_password(context, password, &pwsize);\n\n  if (code != 0) {\n    memset(password, 0, sizeof(password));\n    com_err(whoami, code, string_text(KPW_STR_WHILE_READING_PASSWORD));\n    krb5_free_principal(context, princ);\n    free(princ_str);\n    return(MISC_EXIT_STATUS);\n  }\n  if (pwsize == 0) {\n    memset(password, 0, sizeof(password));\n    com_err(whoami, 0, string_text(KPW_STR_NO_PASSWORD_READ));\n    krb5_free_principal(context, princ);\n    free(princ_str);\n    return(5);\n  }\n\n  admin_realm[0] = '\\0';\n  strncat(admin_realm, krb5_princ_realm(context, princ)->data, \n\t  krb5_princ_realm(context, princ)->length);\n\n  code = ovsec_kadm_init(princ_str, password, KADM5_CHANGEPW_SERVICE,\n\t\t\t admin_realm /* we probably should take a -r */\n\t\t\t             /* someday */,\n\t\t\t OVSEC_KADM_STRUCT_VERSION,\n\t\t\t OVSEC_KADM_API_VERSION_1,\n\t\t\t &server_handle);\n  if (code != 0) {\n    if (code == OVSEC_KADM_BAD_PASSWORD)\n      com_err(whoami, 0, string_text(KPW_STR_OLD_PASSWORD_INCORRECT));\n    else \n      com_err(whoami, 0, string_text(KPW_STR_CANT_OPEN_ADMIN_SERVER), admin_realm,\n\t      error_message(code));\n    krb5_free_principal(context, princ);\n    free(princ_str);\n    return((code == OVSEC_KADM_BAD_PASSWORD)?2:3);\n  }\n\n  /* Explain policy restrictions on new password if any. */\n  /* Note: copy of this exists in login (kverify.c/get_verified_in_tkt). */\n\n  code = ovsec_kadm_get_principal(server_handle, princ, &principal_entry);\n  if (code != 0) {\n    com_err(whoami, 0,\n\t    string_text((code == OVSEC_KADM_UNK_PRINC)\n\t\t\t? KPW_STR_PRIN_UNKNOWN : KPW_STR_CANT_GET_POLICY_INFO),\n\t    princ_str);\n    krb5_free_principal(context, princ);\n    free(princ_str);\n    (void) ovsec_kadm_destroy(server_handle);\n    return((code == OVSEC_KADM_UNK_PRINC) ? 1 : MISC_EXIT_STATUS);\n  }\n  if ((principal_entry->aux_attributes & OVSEC_KADM_POLICY) != 0) {\n    code = ovsec_kadm_get_policy(server_handle,\n\t\t\t\t principal_entry->policy, &policy_entry);\n    if (code != 0) {\n      /* doesn't matter which error comes back, there's no nice recovery\n\t or need to differentiate to the user */\n      com_err(whoami, 0,\n\t      string_text(KPW_STR_CANT_GET_POLICY_INFO), princ_str);\n      (void) ovsec_kadm_free_principal_ent(server_handle, principal_entry);\n      krb5_free_principal(context, princ);\n      free(princ_str);\n      (void) ovsec_kadm_destroy(server_handle);\n      return(MISC_EXIT_STATUS);\n    }\n    com_err(whoami, 0, string_text(KPW_STR_POLICY_EXPLANATION),\n\t    princ_str, principal_entry->policy,\n\t    policy_entry->pw_min_length, policy_entry->pw_min_classes);\n\n    code = ovsec_kadm_free_principal_ent(server_handle, principal_entry);\n    if (code) {\n\t(void) ovsec_kadm_free_policy_ent(server_handle, policy_entry);\n\tkrb5_free_principal(context, princ);\n\tfree(princ_str);\n\tcom_err(whoami, code, string_text(KPW_STR_WHILE_FREEING_PRINCIPAL));\n\t(void) ovsec_kadm_destroy(server_handle);\n\treturn(MISC_EXIT_STATUS);\n    }\n\n    code = ovsec_kadm_free_policy_ent(server_handle, policy_entry);\n    if (code) {\n\tkrb5_free_principal(context, princ);\n\tfree(princ_str);\n\tcom_err(whoami, code, string_text(KPW_STR_WHILE_FREEING_POLICY));\n\t(void) ovsec_kadm_destroy(server_handle);\n\treturn(MISC_EXIT_STATUS);\n    }\n  }\n  else {\n    /* kpasswd *COULD* output something here to encourage the choice\n       of good passwords, in the absence of an enforced policy. */\n      code = ovsec_kadm_free_principal_ent(server_handle, principal_entry);\n      if (code) {\n\t  krb5_free_principal(context, princ);\n\t  free(princ_str);\n\t  com_err(whoami, code, string_text(KPW_STR_WHILE_FREEING_PRINCIPAL));\n\t  (void) ovsec_kadm_destroy(server_handle);\n\t  return(MISC_EXIT_STATUS);\n      }\n  }\n\n  pwsize = sizeof(password);\n  code = read_new_password(server_handle, password, &pwsize, msg_ret, princ);\n  memset(password, 0, sizeof(password));\n\n  if (code)\n    com_err(whoami, 0, msg_ret);\n\n  krb5_free_principal(context, princ);\n  free(princ_str);\n\n  (void) ovsec_kadm_destroy(server_handle);\n  \n  if (code == KRB5_LIBOS_CANTREADPWD)\n     return(5);\n  else if (code)\n     return(4);\n  else\n     return(0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "com_err",
          "args": [
            "whoami",
            "retval",
            "\"initializing krb5 context\""
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "krb5_init_context",
          "args": [
            "&context"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XmProcessTraversal",
          "args": [
            "prompt_text",
            "XmTRAVERSE_CURRENT"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "create_widgets",
          "args": [
            "&argc",
            "argv"
          ],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "create_widgets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
          "lines": "186-284",
          "snippet": "static void\ncreate_widgets(argc, argv)\n     int *argc;\n     char *argv[];\n{\n  Widget form, lbl_form,\n  \tsep,\n  \tscroll_win;\n  Pixel bg;\n\n  toplevel = XtAppInitialize(&app_con, \"Kpasswd\", NULL, 0, argc, argv,\n\t\t\t     NULL, NULL, 0);\n  form = XtCreateManagedWidget(\"form\", xmFormWidgetClass, toplevel, NULL, 0);\n  quit_btn = XtVaCreateManagedWidget(\"Quit\", xmPushButtonWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  XtAddCallback(quit_btn, XmNactivateCallback, quit, 0);\n  help_btn = XtVaCreateManagedWidget(\"Help\", xmPushButtonWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\t/* XmNshowAsDefault, TRUE, */\n\t\t\t\tNULL);\n  XtAddCallback(help_btn, XmNactivateCallback, help, 0);\n  sep = XtVaCreateManagedWidget(\"sep\", xmSeparatorWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNbottomWidget, quit_btn,\n\t\t\t\tNULL);\n  lbl_form = XtVaCreateManagedWidget(\"lbl_form\", xmFormWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNspacing, 0,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNbottomWidget, sep,\n\t\t\t\tNULL);\n  old_lbl = XtVaCreateManagedWidget(\"old_lbl\", xmLabelWidgetClass,\n\t\t\t\tlbl_form,\n\t\t\t\tXmNtopAttachment, XmATTACH_FORM,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  new_lbl = XtVaCreateManagedWidget(\"new_lbl\", xmLabelWidgetClass,\n\t\t\t\tlbl_form,\n\t\t\t\tXmNtopAttachment, XmATTACH_FORM,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  again_lbl = XtVaCreateManagedWidget(\"again_lbl\", xmLabelWidgetClass,\n\t\t\t\tlbl_form,\n\t\t\t\tXmNtopAttachment, XmATTACH_FORM,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  prompt_text = XtVaCreateManagedWidget(\"prompt_text\", xmTextWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNeditMode, XmSINGLE_LINE_EDIT,\n\t\t\t\tXmNleftAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNleftWidget, lbl_form,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNbottomWidget, sep,\n\t\t\t\tNULL);\n  XtAddCallback(prompt_text, XmNactivateCallback, unset_looping, 0);\n  XtVaGetValues(prompt_text, XmNbackground, &bg, NULL);\n  XtVaSetValues(prompt_text, XmNforeground, bg, NULL);\n\n  main_lbl = XtVaCreateWidget(\"main_lbl\", xmLabelWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNtopAttachment, XmATTACH_FORM,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  scroll_win = XtVaCreateManagedWidget(\"scroll_win\",\n\t\t\t\txmScrolledWindowWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNscrollingPolicy, XmAPPLICATION_DEFINED,\n\t\t\t\tXmNscrollBarDisplayPolicy, XmSTATIC,\n\t\t\t\tXmNtopAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNtopWidget, main_lbl,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNbottomWidget, prompt_text,\n\t\t\t\tNULL);\n  scroll_text = XtVaCreateManagedWidget(\"scroll_text\", xmTextWidgetClass,\n\t\t\t\tscroll_win,\n\t\t\t\tXmNeditMode, XmMULTI_LINE_EDIT,\n\t\t\t\tXmNeditable, FALSE,\n\t\t\t\tNULL);\n  XtRealizeWidget(toplevel);\n}",
          "includes": [
            "#\tinclude <varargs.h>",
            "#\tinclude <stdarg.h>",
            "#include <X11/Shell.h>",
            "#include <X11/cursorfont.h>",
            "#include <Xm/Separator.h>",
            "#include <Xm/Label.h>",
            "#include <Xm/PushB.h>",
            "#include <Xm/Text.h>",
            "#include <Xm/Form.h>",
            "#include <Xm/ScrolledW.h>",
            "#include <Xm/MessageB.h>",
            "#include <Xm/Xm.h>",
            "#include <string.h>",
            "#include <pwd.h>",
            "#include <stdio.h>",
            "#include \"kpasswd_strings.h\"",
            "#include <krb5.h>",
            "#include <kadm5/admin.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "Widget toplevel, scroll_text, prompt_text;",
            "Widget quit_btn, help_btn, old_lbl, new_lbl, again_lbl, main_lbl;",
            "XtAppContext app_con;"
          ],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nWidget toplevel, scroll_text, prompt_text;\nWidget quit_btn, help_btn, old_lbl, new_lbl, again_lbl, main_lbl;\nXtAppContext app_con;\n\nstatic void\ncreate_widgets(argc, argv)\n     int *argc;\n     char *argv[];\n{\n  Widget form, lbl_form,\n  \tsep,\n  \tscroll_win;\n  Pixel bg;\n\n  toplevel = XtAppInitialize(&app_con, \"Kpasswd\", NULL, 0, argc, argv,\n\t\t\t     NULL, NULL, 0);\n  form = XtCreateManagedWidget(\"form\", xmFormWidgetClass, toplevel, NULL, 0);\n  quit_btn = XtVaCreateManagedWidget(\"Quit\", xmPushButtonWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  XtAddCallback(quit_btn, XmNactivateCallback, quit, 0);\n  help_btn = XtVaCreateManagedWidget(\"Help\", xmPushButtonWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\t/* XmNshowAsDefault, TRUE, */\n\t\t\t\tNULL);\n  XtAddCallback(help_btn, XmNactivateCallback, help, 0);\n  sep = XtVaCreateManagedWidget(\"sep\", xmSeparatorWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNbottomWidget, quit_btn,\n\t\t\t\tNULL);\n  lbl_form = XtVaCreateManagedWidget(\"lbl_form\", xmFormWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNspacing, 0,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNbottomWidget, sep,\n\t\t\t\tNULL);\n  old_lbl = XtVaCreateManagedWidget(\"old_lbl\", xmLabelWidgetClass,\n\t\t\t\tlbl_form,\n\t\t\t\tXmNtopAttachment, XmATTACH_FORM,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  new_lbl = XtVaCreateManagedWidget(\"new_lbl\", xmLabelWidgetClass,\n\t\t\t\tlbl_form,\n\t\t\t\tXmNtopAttachment, XmATTACH_FORM,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  again_lbl = XtVaCreateManagedWidget(\"again_lbl\", xmLabelWidgetClass,\n\t\t\t\tlbl_form,\n\t\t\t\tXmNtopAttachment, XmATTACH_FORM,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  prompt_text = XtVaCreateManagedWidget(\"prompt_text\", xmTextWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNeditMode, XmSINGLE_LINE_EDIT,\n\t\t\t\tXmNleftAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNleftWidget, lbl_form,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNbottomWidget, sep,\n\t\t\t\tNULL);\n  XtAddCallback(prompt_text, XmNactivateCallback, unset_looping, 0);\n  XtVaGetValues(prompt_text, XmNbackground, &bg, NULL);\n  XtVaSetValues(prompt_text, XmNforeground, bg, NULL);\n\n  main_lbl = XtVaCreateWidget(\"main_lbl\", xmLabelWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNtopAttachment, XmATTACH_FORM,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  scroll_win = XtVaCreateManagedWidget(\"scroll_win\",\n\t\t\t\txmScrolledWindowWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNscrollingPolicy, XmAPPLICATION_DEFINED,\n\t\t\t\tXmNscrollBarDisplayPolicy, XmSTATIC,\n\t\t\t\tXmNtopAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNtopWidget, main_lbl,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNbottomWidget, prompt_text,\n\t\t\t\tNULL);\n  scroll_text = XtVaCreateManagedWidget(\"scroll_text\", xmTextWidgetClass,\n\t\t\t\tscroll_win,\n\t\t\t\tXmNeditMode, XmMULTI_LINE_EDIT,\n\t\t\t\tXmNeditable, FALSE,\n\t\t\t\tNULL);\n  XtRealizeWidget(toplevel);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_com_err_hook",
          "args": [
            "motif_com_err"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "argv[0]",
            "'/'"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initialize_kpasswd_strings",
          "args": [],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\n#define initialize_kpasswd_strings initialize_kpws_error_table\n#define string_text error_message\n\nchar *whoami;\nWidget toplevel, scroll_text, prompt_text;\nXtAppContext app_con;\nint retval=0;\n\nvoid\nmain(argc, argv)\n     int argc;\n     char *argv[];\n{\n  krb5_context context;\n  int code;\n\n  initialize_kpasswd_strings();\n\n  whoami = (whoami = strrchr(argv[0], '/')) ? whoami + 1 : argv[0];\n\n  (void) set_com_err_hook(motif_com_err);\n\n  create_widgets(&argc, argv);\n  XmProcessTraversal(prompt_text, XmTRAVERSE_CURRENT);\n\n  if (retval = krb5_init_context(&context)) {\n       com_err(whoami, retval, \"initializing krb5 context\");\n       exit(retval);\n  }\n\n  while (1)\n    {\n      retval = kpasswd(context, argc, argv);\n      SetStandardCursor();\n\n      if (!retval)\n\tcom_err(0, 0, string_text(KPW_STR_PASSWORD_CHANGED));\n\n      if (retval == 0)\t\t/* 0 is success, so presumably the user */\n\t\t\t\t/* is done. */\n\tXmProcessTraversal(quit_btn, XmTRAVERSE_CURRENT);\n\n      if ((retval == 1) ||\t/* the rest are \"fatal\", so we should */\n\t  (retval == 3) ||\t/* \"force\" the user to quit... */\n\t  (retval == 6) ||\n\t  (retval == 7))\n\t{\n\t  XtSetSensitive(prompt_text, FALSE);\n\t  XmProcessTraversal(quit_btn, XmTRAVERSE_CURRENT);\n\t  XtAppMainLoop(app_con);\n\t}\n    }\n\n  /* NOTREACHED */\n  exit(retval);\n}"
  },
  {
    "function_name": "read_new_password",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
    "lines": "354-398",
    "snippet": "long\nread_new_password(server_handle, password, pwsize, msg_ret, princ)\n     void *server_handle;\n     char *password;\n     unsigned int *pwsize;\n     char *msg_ret;\n     krb5_principal princ;\n{\n  char *password2 = (char *) malloc(*pwsize * sizeof(char));\n  int pwsize2 = *pwsize;\n\n  SetStandardCursor();\n\n  if (password2 == NULL)\n    {\n      strcpy(msg_ret, error_message(ENOMEM));\n      SetWatchCursor();\n      return(ENOMEM);\n    }\n\n  XtManageChild(new_lbl); XtUnmanageChild(old_lbl);\n  read_password(password, pwsize);\n  XtManageChild(again_lbl); XtUnmanageChild(new_lbl);\n  read_password(password2, &pwsize2);\n\n  if (strcmp(password, password2))\n    {\n      memset(password, 0, *pwsize);\n\n      memset(password2, 0, pwsize2);\n      free(password2);\n      \n      strcpy(msg_ret, string_text(CHPASS_UTIL_NEW_PASSWORD_MISMATCH));\n      SetWatchCursor();\n      return(KRB5_LIBOS_BADPWDMATCH);\n    }\n\n  memset(password2, 0, pwsize2);\n  free(password2);\n\n  SetWatchCursor();\n  return (ovsec_kadm_chpass_principal_util(server_handle, princ, password,\n                                            NULL /* don't need new pw back */,\n                                            msg_ret));\n}",
    "includes": [
      "#\tinclude <varargs.h>",
      "#\tinclude <stdarg.h>",
      "#include <X11/Shell.h>",
      "#include <X11/cursorfont.h>",
      "#include <Xm/Separator.h>",
      "#include <Xm/Label.h>",
      "#include <Xm/PushB.h>",
      "#include <Xm/Text.h>",
      "#include <Xm/Form.h>",
      "#include <Xm/ScrolledW.h>",
      "#include <Xm/MessageB.h>",
      "#include <Xm/Xm.h>",
      "#include <string.h>",
      "#include <pwd.h>",
      "#include <stdio.h>",
      "#include \"kpasswd_strings.h\"",
      "#include <krb5.h>",
      "#include <kadm5/admin.h>"
    ],
    "macros_used": [
      "#define string_text error_message"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ovsec_kadm_chpass_principal_util",
          "args": [
            "server_handle",
            "princ",
            "password",
            "NULL/* don't need new pw back */",
            "msg_ret"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetWatchCursor",
          "args": [],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "SetWatchCursor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
          "lines": "71-79",
          "snippet": "static void\nSetWatchCursor()\n{\n  static Cursor WatchCursor = (Cursor)NULL;\n\n  if (WatchCursor == (Cursor)NULL)\n    WatchCursor = XCreateFontCursor(XtDisplay(toplevel), XC_watch);\n  SetCursor(toplevel, WatchCursor);\n}",
          "includes": [
            "#\tinclude <varargs.h>",
            "#\tinclude <stdarg.h>",
            "#include <X11/Shell.h>",
            "#include <X11/cursorfont.h>",
            "#include <Xm/Separator.h>",
            "#include <Xm/Label.h>",
            "#include <Xm/PushB.h>",
            "#include <Xm/Text.h>",
            "#include <Xm/Form.h>",
            "#include <Xm/ScrolledW.h>",
            "#include <Xm/MessageB.h>",
            "#include <Xm/Xm.h>",
            "#include <string.h>",
            "#include <pwd.h>",
            "#include <stdio.h>",
            "#include \"kpasswd_strings.h\"",
            "#include <krb5.h>",
            "#include <kadm5/admin.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nstatic void\nSetWatchCursor()\n{\n  static Cursor WatchCursor = (Cursor)NULL;\n\n  if (WatchCursor == (Cursor)NULL)\n    WatchCursor = XCreateFontCursor(XtDisplay(toplevel), XC_watch);\n  SetCursor(toplevel, WatchCursor);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "password2"
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "free_policy_ent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "939-943",
          "snippet": "static void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nstatic void free_policy_ent(ovsec_kadm_policy_ent_t *policy)\n{\n     free(*policy);\n     *policy = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "password2",
            "0",
            "pwsize2"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "msg_ret",
            "string_text(CHPASS_UTIL_NEW_PASSWORD_MISMATCH)"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "string_text",
          "args": [
            "CHPASS_UTIL_NEW_PASSWORD_MISMATCH"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "password2",
            "0",
            "pwsize2"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "password",
            "0",
            "*pwsize"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "password",
            "password2"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read_password",
          "args": [
            "password2",
            "&pwsize2"
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "read_password",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
          "lines": "291-316",
          "snippet": "static long\nread_password(password, pwsize)\n     char *password;\n     int *pwsize;\n{\n  XEvent event;\n  char *text_val;\n\n  /* OK, this next part is gross...  but this is due to the fact that\t*/\n  /* this is not your traditional X program, which would be event\t*/\n  /* driven.  Instead, this program is more 'CLI' in nature, so we\t*/\n  /* handle the dialogs synchronously... \t\t\t\t*/\n\n  XtVaSetValues(prompt_text, XmNmaxLength, *pwsize, XmNvalue, \"\", NULL);\n  for (looping=1; looping; )\n    {\n      XtAppNextEvent(app_con, &event);\n      XtDispatchEvent(&event);\n    }\n  XtVaGetValues(prompt_text, XmNvalue, &text_val, NULL);\n  *pwsize = strlen(text_val);\n  strcpy(password, text_val);\n  memset(text_val, 0, *pwsize);\n  XtVaSetValues(prompt_text, XmNvalue, text_val, NULL);\n  return(0);\n}",
          "includes": [
            "#\tinclude <varargs.h>",
            "#\tinclude <stdarg.h>",
            "#include <X11/Shell.h>",
            "#include <X11/cursorfont.h>",
            "#include <Xm/Separator.h>",
            "#include <Xm/Label.h>",
            "#include <Xm/PushB.h>",
            "#include <Xm/Text.h>",
            "#include <Xm/Form.h>",
            "#include <Xm/ScrolledW.h>",
            "#include <Xm/MessageB.h>",
            "#include <Xm/Xm.h>",
            "#include <string.h>",
            "#include <pwd.h>",
            "#include <stdio.h>",
            "#include \"kpasswd_strings.h\"",
            "#include <krb5.h>",
            "#include <kadm5/admin.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "Widget toplevel, scroll_text, prompt_text;",
            "XtAppContext app_con;",
            "int looping;"
          ],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nWidget toplevel, scroll_text, prompt_text;\nXtAppContext app_con;\nint looping;\n\nstatic long\nread_password(password, pwsize)\n     char *password;\n     int *pwsize;\n{\n  XEvent event;\n  char *text_val;\n\n  /* OK, this next part is gross...  but this is due to the fact that\t*/\n  /* this is not your traditional X program, which would be event\t*/\n  /* driven.  Instead, this program is more 'CLI' in nature, so we\t*/\n  /* handle the dialogs synchronously... \t\t\t\t*/\n\n  XtVaSetValues(prompt_text, XmNmaxLength, *pwsize, XmNvalue, \"\", NULL);\n  for (looping=1; looping; )\n    {\n      XtAppNextEvent(app_con, &event);\n      XtDispatchEvent(&event);\n    }\n  XtVaGetValues(prompt_text, XmNvalue, &text_val, NULL);\n  *pwsize = strlen(text_val);\n  strcpy(password, text_val);\n  memset(text_val, 0, *pwsize);\n  XtVaSetValues(prompt_text, XmNvalue, text_val, NULL);\n  return(0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "XtUnmanageChild",
          "args": [
            "new_lbl"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtManageChild",
          "args": [
            "again_lbl"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtUnmanageChild",
          "args": [
            "old_lbl"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtManageChild",
          "args": [
            "new_lbl"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "msg_ret",
            "error_message(ENOMEM)"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error_message",
          "args": [
            "ENOMEM"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetStandardCursor",
          "args": [],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "SetStandardCursor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
          "lines": "60-68",
          "snippet": "static void\nSetStandardCursor()\n{\n  static Cursor ArrowCursor = (Cursor)NULL;\n \n  if (ArrowCursor == (Cursor)NULL)\n    ArrowCursor = XCreateFontCursor(XtDisplay(toplevel), XC_top_left_arrow);\n  SetCursor(toplevel, ArrowCursor);\n}",
          "includes": [
            "#\tinclude <varargs.h>",
            "#\tinclude <stdarg.h>",
            "#include <X11/Shell.h>",
            "#include <X11/cursorfont.h>",
            "#include <Xm/Separator.h>",
            "#include <Xm/Label.h>",
            "#include <Xm/PushB.h>",
            "#include <Xm/Text.h>",
            "#include <Xm/Form.h>",
            "#include <Xm/ScrolledW.h>",
            "#include <Xm/MessageB.h>",
            "#include <Xm/Xm.h>",
            "#include <string.h>",
            "#include <pwd.h>",
            "#include <stdio.h>",
            "#include \"kpasswd_strings.h\"",
            "#include <krb5.h>",
            "#include <kadm5/admin.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nstatic void\nSetStandardCursor()\n{\n  static Cursor ArrowCursor = (Cursor)NULL;\n \n  if (ArrowCursor == (Cursor)NULL)\n    ArrowCursor = XCreateFontCursor(XtDisplay(toplevel), XC_top_left_arrow);\n  SetCursor(toplevel, ArrowCursor);\n}"
        }
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "*pwsize * sizeof(char)"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\n#define string_text error_message\n\nlong\nread_new_password(server_handle, password, pwsize, msg_ret, princ)\n     void *server_handle;\n     char *password;\n     unsigned int *pwsize;\n     char *msg_ret;\n     krb5_principal princ;\n{\n  char *password2 = (char *) malloc(*pwsize * sizeof(char));\n  int pwsize2 = *pwsize;\n\n  SetStandardCursor();\n\n  if (password2 == NULL)\n    {\n      strcpy(msg_ret, error_message(ENOMEM));\n      SetWatchCursor();\n      return(ENOMEM);\n    }\n\n  XtManageChild(new_lbl); XtUnmanageChild(old_lbl);\n  read_password(password, pwsize);\n  XtManageChild(again_lbl); XtUnmanageChild(new_lbl);\n  read_password(password2, &pwsize2);\n\n  if (strcmp(password, password2))\n    {\n      memset(password, 0, *pwsize);\n\n      memset(password2, 0, pwsize2);\n      free(password2);\n      \n      strcpy(msg_ret, string_text(CHPASS_UTIL_NEW_PASSWORD_MISMATCH));\n      SetWatchCursor();\n      return(KRB5_LIBOS_BADPWDMATCH);\n    }\n\n  memset(password2, 0, pwsize2);\n  free(password2);\n\n  SetWatchCursor();\n  return (ovsec_kadm_chpass_principal_util(server_handle, princ, password,\n                                            NULL /* don't need new pw back */,\n                                            msg_ret));\n}"
  },
  {
    "function_name": "read_old_password",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
    "lines": "340-352",
    "snippet": "long\nread_old_password(context, password, pwsize)\n     krb5_context context;\n     char *password;\n     unsigned int *pwsize;\n{\n  long code;\n\n  XtManageChild(old_lbl);\n  code = read_password(password, pwsize);\n  SetWatchCursor();\n  return code;\n}",
    "includes": [
      "#\tinclude <varargs.h>",
      "#\tinclude <stdarg.h>",
      "#include <X11/Shell.h>",
      "#include <X11/cursorfont.h>",
      "#include <Xm/Separator.h>",
      "#include <Xm/Label.h>",
      "#include <Xm/PushB.h>",
      "#include <Xm/Text.h>",
      "#include <Xm/Form.h>",
      "#include <Xm/ScrolledW.h>",
      "#include <Xm/MessageB.h>",
      "#include <Xm/Xm.h>",
      "#include <string.h>",
      "#include <pwd.h>",
      "#include <stdio.h>",
      "#include \"kpasswd_strings.h\"",
      "#include <krb5.h>",
      "#include <kadm5/admin.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetWatchCursor",
          "args": [],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "SetWatchCursor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
          "lines": "71-79",
          "snippet": "static void\nSetWatchCursor()\n{\n  static Cursor WatchCursor = (Cursor)NULL;\n\n  if (WatchCursor == (Cursor)NULL)\n    WatchCursor = XCreateFontCursor(XtDisplay(toplevel), XC_watch);\n  SetCursor(toplevel, WatchCursor);\n}",
          "includes": [
            "#\tinclude <varargs.h>",
            "#\tinclude <stdarg.h>",
            "#include <X11/Shell.h>",
            "#include <X11/cursorfont.h>",
            "#include <Xm/Separator.h>",
            "#include <Xm/Label.h>",
            "#include <Xm/PushB.h>",
            "#include <Xm/Text.h>",
            "#include <Xm/Form.h>",
            "#include <Xm/ScrolledW.h>",
            "#include <Xm/MessageB.h>",
            "#include <Xm/Xm.h>",
            "#include <string.h>",
            "#include <pwd.h>",
            "#include <stdio.h>",
            "#include \"kpasswd_strings.h\"",
            "#include <krb5.h>",
            "#include <kadm5/admin.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nstatic void\nSetWatchCursor()\n{\n  static Cursor WatchCursor = (Cursor)NULL;\n\n  if (WatchCursor == (Cursor)NULL)\n    WatchCursor = XCreateFontCursor(XtDisplay(toplevel), XC_watch);\n  SetCursor(toplevel, WatchCursor);\n}"
        }
      },
      {
        "call_info": {
          "callee": "read_password",
          "args": [
            "password",
            "pwsize"
          ],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "read_password",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
          "lines": "291-316",
          "snippet": "static long\nread_password(password, pwsize)\n     char *password;\n     int *pwsize;\n{\n  XEvent event;\n  char *text_val;\n\n  /* OK, this next part is gross...  but this is due to the fact that\t*/\n  /* this is not your traditional X program, which would be event\t*/\n  /* driven.  Instead, this program is more 'CLI' in nature, so we\t*/\n  /* handle the dialogs synchronously... \t\t\t\t*/\n\n  XtVaSetValues(prompt_text, XmNmaxLength, *pwsize, XmNvalue, \"\", NULL);\n  for (looping=1; looping; )\n    {\n      XtAppNextEvent(app_con, &event);\n      XtDispatchEvent(&event);\n    }\n  XtVaGetValues(prompt_text, XmNvalue, &text_val, NULL);\n  *pwsize = strlen(text_val);\n  strcpy(password, text_val);\n  memset(text_val, 0, *pwsize);\n  XtVaSetValues(prompt_text, XmNvalue, text_val, NULL);\n  return(0);\n}",
          "includes": [
            "#\tinclude <varargs.h>",
            "#\tinclude <stdarg.h>",
            "#include <X11/Shell.h>",
            "#include <X11/cursorfont.h>",
            "#include <Xm/Separator.h>",
            "#include <Xm/Label.h>",
            "#include <Xm/PushB.h>",
            "#include <Xm/Text.h>",
            "#include <Xm/Form.h>",
            "#include <Xm/ScrolledW.h>",
            "#include <Xm/MessageB.h>",
            "#include <Xm/Xm.h>",
            "#include <string.h>",
            "#include <pwd.h>",
            "#include <stdio.h>",
            "#include \"kpasswd_strings.h\"",
            "#include <krb5.h>",
            "#include <kadm5/admin.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "Widget toplevel, scroll_text, prompt_text;",
            "XtAppContext app_con;",
            "int looping;"
          ],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nWidget toplevel, scroll_text, prompt_text;\nXtAppContext app_con;\nint looping;\n\nstatic long\nread_password(password, pwsize)\n     char *password;\n     int *pwsize;\n{\n  XEvent event;\n  char *text_val;\n\n  /* OK, this next part is gross...  but this is due to the fact that\t*/\n  /* this is not your traditional X program, which would be event\t*/\n  /* driven.  Instead, this program is more 'CLI' in nature, so we\t*/\n  /* handle the dialogs synchronously... \t\t\t\t*/\n\n  XtVaSetValues(prompt_text, XmNmaxLength, *pwsize, XmNvalue, \"\", NULL);\n  for (looping=1; looping; )\n    {\n      XtAppNextEvent(app_con, &event);\n      XtDispatchEvent(&event);\n    }\n  XtVaGetValues(prompt_text, XmNvalue, &text_val, NULL);\n  *pwsize = strlen(text_val);\n  strcpy(password, text_val);\n  memset(text_val, 0, *pwsize);\n  XtVaSetValues(prompt_text, XmNvalue, text_val, NULL);\n  return(0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "XtManageChild",
          "args": [
            "old_lbl"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nlong\nread_old_password(context, password, pwsize)\n     krb5_context context;\n     char *password;\n     unsigned int *pwsize;\n{\n  long code;\n\n  XtManageChild(old_lbl);\n  code = read_password(password, pwsize);\n  SetWatchCursor();\n  return code;\n}"
  },
  {
    "function_name": "display_intro_message",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
    "lines": "323-337",
    "snippet": "void\ndisplay_intro_message(fmt_string, arg_string)\n     const char *fmt_string;\n     const char *arg_string;\n{\n  XmString xmstr;\n  char buf[1024];\n\n  sprintf(buf, fmt_string, arg_string);\n\n  xmstr = XmStringCreateLtoR(buf, XmSTRING_DEFAULT_CHARSET);\n  XtVaSetValues(main_lbl, XmNlabelString, xmstr, NULL);\n  XmStringFree(xmstr);\n  XtManageChild(main_lbl);\n}",
    "includes": [
      "#\tinclude <varargs.h>",
      "#\tinclude <stdarg.h>",
      "#include <X11/Shell.h>",
      "#include <X11/cursorfont.h>",
      "#include <Xm/Separator.h>",
      "#include <Xm/Label.h>",
      "#include <Xm/PushB.h>",
      "#include <Xm/Text.h>",
      "#include <Xm/Form.h>",
      "#include <Xm/ScrolledW.h>",
      "#include <Xm/MessageB.h>",
      "#include <Xm/Xm.h>",
      "#include <string.h>",
      "#include <pwd.h>",
      "#include <stdio.h>",
      "#include \"kpasswd_strings.h\"",
      "#include <krb5.h>",
      "#include <kadm5/admin.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "Widget quit_btn, help_btn, old_lbl, new_lbl, again_lbl, main_lbl;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XtManageChild",
          "args": [
            "main_lbl"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XmStringFree",
          "args": [
            "xmstr"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtVaSetValues",
          "args": [
            "main_lbl",
            "XmNlabelString",
            "xmstr",
            "NULL"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XmStringCreateLtoR",
          "args": [
            "buf",
            "XmSTRING_DEFAULT_CHARSET"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "fmt_string",
            "arg_string"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nWidget quit_btn, help_btn, old_lbl, new_lbl, again_lbl, main_lbl;\n\nvoid\ndisplay_intro_message(fmt_string, arg_string)\n     const char *fmt_string;\n     const char *arg_string;\n{\n  XmString xmstr;\n  char buf[1024];\n\n  sprintf(buf, fmt_string, arg_string);\n\n  xmstr = XmStringCreateLtoR(buf, XmSTRING_DEFAULT_CHARSET);\n  XtVaSetValues(main_lbl, XmNlabelString, xmstr, NULL);\n  XmStringFree(xmstr);\n  XtManageChild(main_lbl);\n}"
  },
  {
    "function_name": "read_password",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
    "lines": "291-316",
    "snippet": "static long\nread_password(password, pwsize)\n     char *password;\n     int *pwsize;\n{\n  XEvent event;\n  char *text_val;\n\n  /* OK, this next part is gross...  but this is due to the fact that\t*/\n  /* this is not your traditional X program, which would be event\t*/\n  /* driven.  Instead, this program is more 'CLI' in nature, so we\t*/\n  /* handle the dialogs synchronously... \t\t\t\t*/\n\n  XtVaSetValues(prompt_text, XmNmaxLength, *pwsize, XmNvalue, \"\", NULL);\n  for (looping=1; looping; )\n    {\n      XtAppNextEvent(app_con, &event);\n      XtDispatchEvent(&event);\n    }\n  XtVaGetValues(prompt_text, XmNvalue, &text_val, NULL);\n  *pwsize = strlen(text_val);\n  strcpy(password, text_val);\n  memset(text_val, 0, *pwsize);\n  XtVaSetValues(prompt_text, XmNvalue, text_val, NULL);\n  return(0);\n}",
    "includes": [
      "#\tinclude <varargs.h>",
      "#\tinclude <stdarg.h>",
      "#include <X11/Shell.h>",
      "#include <X11/cursorfont.h>",
      "#include <Xm/Separator.h>",
      "#include <Xm/Label.h>",
      "#include <Xm/PushB.h>",
      "#include <Xm/Text.h>",
      "#include <Xm/Form.h>",
      "#include <Xm/ScrolledW.h>",
      "#include <Xm/MessageB.h>",
      "#include <Xm/Xm.h>",
      "#include <string.h>",
      "#include <pwd.h>",
      "#include <stdio.h>",
      "#include \"kpasswd_strings.h\"",
      "#include <krb5.h>",
      "#include <kadm5/admin.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "Widget toplevel, scroll_text, prompt_text;",
      "XtAppContext app_con;",
      "int looping;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XtVaSetValues",
          "args": [
            "prompt_text",
            "XmNvalue",
            "text_val",
            "NULL"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "text_val",
            "0",
            "*pwsize"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "password",
            "text_val"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "text_val"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtVaGetValues",
          "args": [
            "prompt_text",
            "XmNvalue",
            "&text_val",
            "NULL"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtDispatchEvent",
          "args": [
            "&event"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtAppNextEvent",
          "args": [
            "app_con",
            "&event"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtVaSetValues",
          "args": [
            "prompt_text",
            "XmNmaxLength",
            "*pwsize",
            "XmNvalue",
            "\"\"",
            "NULL"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nWidget toplevel, scroll_text, prompt_text;\nXtAppContext app_con;\nint looping;\n\nstatic long\nread_password(password, pwsize)\n     char *password;\n     int *pwsize;\n{\n  XEvent event;\n  char *text_val;\n\n  /* OK, this next part is gross...  but this is due to the fact that\t*/\n  /* this is not your traditional X program, which would be event\t*/\n  /* driven.  Instead, this program is more 'CLI' in nature, so we\t*/\n  /* handle the dialogs synchronously... \t\t\t\t*/\n\n  XtVaSetValues(prompt_text, XmNmaxLength, *pwsize, XmNvalue, \"\", NULL);\n  for (looping=1; looping; )\n    {\n      XtAppNextEvent(app_con, &event);\n      XtDispatchEvent(&event);\n    }\n  XtVaGetValues(prompt_text, XmNvalue, &text_val, NULL);\n  *pwsize = strlen(text_val);\n  strcpy(password, text_val);\n  memset(text_val, 0, *pwsize);\n  XtVaSetValues(prompt_text, XmNvalue, text_val, NULL);\n  return(0);\n}"
  },
  {
    "function_name": "create_widgets",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
    "lines": "186-284",
    "snippet": "static void\ncreate_widgets(argc, argv)\n     int *argc;\n     char *argv[];\n{\n  Widget form, lbl_form,\n  \tsep,\n  \tscroll_win;\n  Pixel bg;\n\n  toplevel = XtAppInitialize(&app_con, \"Kpasswd\", NULL, 0, argc, argv,\n\t\t\t     NULL, NULL, 0);\n  form = XtCreateManagedWidget(\"form\", xmFormWidgetClass, toplevel, NULL, 0);\n  quit_btn = XtVaCreateManagedWidget(\"Quit\", xmPushButtonWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  XtAddCallback(quit_btn, XmNactivateCallback, quit, 0);\n  help_btn = XtVaCreateManagedWidget(\"Help\", xmPushButtonWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\t/* XmNshowAsDefault, TRUE, */\n\t\t\t\tNULL);\n  XtAddCallback(help_btn, XmNactivateCallback, help, 0);\n  sep = XtVaCreateManagedWidget(\"sep\", xmSeparatorWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNbottomWidget, quit_btn,\n\t\t\t\tNULL);\n  lbl_form = XtVaCreateManagedWidget(\"lbl_form\", xmFormWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNspacing, 0,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNbottomWidget, sep,\n\t\t\t\tNULL);\n  old_lbl = XtVaCreateManagedWidget(\"old_lbl\", xmLabelWidgetClass,\n\t\t\t\tlbl_form,\n\t\t\t\tXmNtopAttachment, XmATTACH_FORM,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  new_lbl = XtVaCreateManagedWidget(\"new_lbl\", xmLabelWidgetClass,\n\t\t\t\tlbl_form,\n\t\t\t\tXmNtopAttachment, XmATTACH_FORM,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  again_lbl = XtVaCreateManagedWidget(\"again_lbl\", xmLabelWidgetClass,\n\t\t\t\tlbl_form,\n\t\t\t\tXmNtopAttachment, XmATTACH_FORM,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  prompt_text = XtVaCreateManagedWidget(\"prompt_text\", xmTextWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNeditMode, XmSINGLE_LINE_EDIT,\n\t\t\t\tXmNleftAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNleftWidget, lbl_form,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNbottomWidget, sep,\n\t\t\t\tNULL);\n  XtAddCallback(prompt_text, XmNactivateCallback, unset_looping, 0);\n  XtVaGetValues(prompt_text, XmNbackground, &bg, NULL);\n  XtVaSetValues(prompt_text, XmNforeground, bg, NULL);\n\n  main_lbl = XtVaCreateWidget(\"main_lbl\", xmLabelWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNtopAttachment, XmATTACH_FORM,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  scroll_win = XtVaCreateManagedWidget(\"scroll_win\",\n\t\t\t\txmScrolledWindowWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNscrollingPolicy, XmAPPLICATION_DEFINED,\n\t\t\t\tXmNscrollBarDisplayPolicy, XmSTATIC,\n\t\t\t\tXmNtopAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNtopWidget, main_lbl,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNbottomWidget, prompt_text,\n\t\t\t\tNULL);\n  scroll_text = XtVaCreateManagedWidget(\"scroll_text\", xmTextWidgetClass,\n\t\t\t\tscroll_win,\n\t\t\t\tXmNeditMode, XmMULTI_LINE_EDIT,\n\t\t\t\tXmNeditable, FALSE,\n\t\t\t\tNULL);\n  XtRealizeWidget(toplevel);\n}",
    "includes": [
      "#\tinclude <varargs.h>",
      "#\tinclude <stdarg.h>",
      "#include <X11/Shell.h>",
      "#include <X11/cursorfont.h>",
      "#include <Xm/Separator.h>",
      "#include <Xm/Label.h>",
      "#include <Xm/PushB.h>",
      "#include <Xm/Text.h>",
      "#include <Xm/Form.h>",
      "#include <Xm/ScrolledW.h>",
      "#include <Xm/MessageB.h>",
      "#include <Xm/Xm.h>",
      "#include <string.h>",
      "#include <pwd.h>",
      "#include <stdio.h>",
      "#include \"kpasswd_strings.h\"",
      "#include <krb5.h>",
      "#include <kadm5/admin.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "Widget toplevel, scroll_text, prompt_text;",
      "Widget quit_btn, help_btn, old_lbl, new_lbl, again_lbl, main_lbl;",
      "XtAppContext app_con;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XtRealizeWidget",
          "args": [
            "toplevel"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtVaCreateManagedWidget",
          "args": [
            "\"scroll_text\"",
            "xmTextWidgetClass",
            "scroll_win",
            "XmNeditMode",
            "XmMULTI_LINE_EDIT",
            "XmNeditable",
            "FALSE",
            "NULL"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtVaCreateManagedWidget",
          "args": [
            "\"scroll_win\"",
            "xmScrolledWindowWidgetClass",
            "form",
            "XmNscrollingPolicy",
            "XmAPPLICATION_DEFINED",
            "XmNscrollBarDisplayPolicy",
            "XmSTATIC",
            "XmNtopAttachment",
            "XmATTACH_WIDGET",
            "XmNtopWidget",
            "main_lbl",
            "XmNleftAttachment",
            "XmATTACH_FORM",
            "XmNrightAttachment",
            "XmATTACH_FORM",
            "XmNbottomAttachment",
            "XmATTACH_WIDGET",
            "XmNbottomWidget",
            "prompt_text",
            "NULL"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtVaCreateWidget",
          "args": [
            "\"main_lbl\"",
            "xmLabelWidgetClass",
            "form",
            "XmNtopAttachment",
            "XmATTACH_FORM",
            "XmNleftAttachment",
            "XmATTACH_FORM",
            "XmNrightAttachment",
            "XmATTACH_FORM",
            "NULL"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtVaSetValues",
          "args": [
            "prompt_text",
            "XmNforeground",
            "bg",
            "NULL"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtVaGetValues",
          "args": [
            "prompt_text",
            "XmNbackground",
            "&bg",
            "NULL"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtAddCallback",
          "args": [
            "prompt_text",
            "XmNactivateCallback",
            "unset_looping",
            "0"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtVaCreateManagedWidget",
          "args": [
            "\"prompt_text\"",
            "xmTextWidgetClass",
            "form",
            "XmNeditMode",
            "XmSINGLE_LINE_EDIT",
            "XmNleftAttachment",
            "XmATTACH_WIDGET",
            "XmNleftWidget",
            "lbl_form",
            "XmNrightAttachment",
            "XmATTACH_FORM",
            "XmNbottomAttachment",
            "XmATTACH_WIDGET",
            "XmNbottomWidget",
            "sep",
            "NULL"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtVaCreateManagedWidget",
          "args": [
            "\"again_lbl\"",
            "xmLabelWidgetClass",
            "lbl_form",
            "XmNtopAttachment",
            "XmATTACH_FORM",
            "XmNleftAttachment",
            "XmATTACH_FORM",
            "XmNrightAttachment",
            "XmATTACH_FORM",
            "XmNbottomAttachment",
            "XmATTACH_FORM",
            "NULL"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtVaCreateManagedWidget",
          "args": [
            "\"new_lbl\"",
            "xmLabelWidgetClass",
            "lbl_form",
            "XmNtopAttachment",
            "XmATTACH_FORM",
            "XmNleftAttachment",
            "XmATTACH_FORM",
            "XmNrightAttachment",
            "XmATTACH_FORM",
            "XmNbottomAttachment",
            "XmATTACH_FORM",
            "NULL"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtVaCreateManagedWidget",
          "args": [
            "\"old_lbl\"",
            "xmLabelWidgetClass",
            "lbl_form",
            "XmNtopAttachment",
            "XmATTACH_FORM",
            "XmNleftAttachment",
            "XmATTACH_FORM",
            "XmNrightAttachment",
            "XmATTACH_FORM",
            "XmNbottomAttachment",
            "XmATTACH_FORM",
            "NULL"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtVaCreateManagedWidget",
          "args": [
            "\"lbl_form\"",
            "xmFormWidgetClass",
            "form",
            "XmNspacing",
            "0",
            "XmNleftAttachment",
            "XmATTACH_FORM",
            "XmNbottomAttachment",
            "XmATTACH_WIDGET",
            "XmNbottomWidget",
            "sep",
            "NULL"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtVaCreateManagedWidget",
          "args": [
            "\"sep\"",
            "xmSeparatorWidgetClass",
            "form",
            "XmNleftAttachment",
            "XmATTACH_FORM",
            "XmNrightAttachment",
            "XmATTACH_FORM",
            "XmNbottomAttachment",
            "XmATTACH_WIDGET",
            "XmNbottomWidget",
            "quit_btn",
            "NULL"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtAddCallback",
          "args": [
            "help_btn",
            "XmNactivateCallback",
            "help",
            "0"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtVaCreateManagedWidget",
          "args": [
            "\"Help\"",
            "xmPushButtonWidgetClass",
            "form",
            "XmNrightAttachment",
            "XmATTACH_FORM",
            "XmNbottomAttachment",
            "XmATTACH_FORM",
            "/* XmNshowAsDefault, TRUE, */NULL"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtAddCallback",
          "args": [
            "quit_btn",
            "XmNactivateCallback",
            "quit",
            "0"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtVaCreateManagedWidget",
          "args": [
            "\"Quit\"",
            "xmPushButtonWidgetClass",
            "form",
            "XmNleftAttachment",
            "XmATTACH_FORM",
            "XmNbottomAttachment",
            "XmATTACH_FORM",
            "NULL"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtCreateManagedWidget",
          "args": [
            "\"form\"",
            "xmFormWidgetClass",
            "toplevel",
            "NULL",
            "0"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtAppInitialize",
          "args": [
            "&app_con",
            "\"Kpasswd\"",
            "NULL",
            "0",
            "argc",
            "argv",
            "NULL",
            "NULL",
            "0"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nWidget toplevel, scroll_text, prompt_text;\nWidget quit_btn, help_btn, old_lbl, new_lbl, again_lbl, main_lbl;\nXtAppContext app_con;\n\nstatic void\ncreate_widgets(argc, argv)\n     int *argc;\n     char *argv[];\n{\n  Widget form, lbl_form,\n  \tsep,\n  \tscroll_win;\n  Pixel bg;\n\n  toplevel = XtAppInitialize(&app_con, \"Kpasswd\", NULL, 0, argc, argv,\n\t\t\t     NULL, NULL, 0);\n  form = XtCreateManagedWidget(\"form\", xmFormWidgetClass, toplevel, NULL, 0);\n  quit_btn = XtVaCreateManagedWidget(\"Quit\", xmPushButtonWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  XtAddCallback(quit_btn, XmNactivateCallback, quit, 0);\n  help_btn = XtVaCreateManagedWidget(\"Help\", xmPushButtonWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\t/* XmNshowAsDefault, TRUE, */\n\t\t\t\tNULL);\n  XtAddCallback(help_btn, XmNactivateCallback, help, 0);\n  sep = XtVaCreateManagedWidget(\"sep\", xmSeparatorWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNbottomWidget, quit_btn,\n\t\t\t\tNULL);\n  lbl_form = XtVaCreateManagedWidget(\"lbl_form\", xmFormWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNspacing, 0,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNbottomWidget, sep,\n\t\t\t\tNULL);\n  old_lbl = XtVaCreateManagedWidget(\"old_lbl\", xmLabelWidgetClass,\n\t\t\t\tlbl_form,\n\t\t\t\tXmNtopAttachment, XmATTACH_FORM,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  new_lbl = XtVaCreateManagedWidget(\"new_lbl\", xmLabelWidgetClass,\n\t\t\t\tlbl_form,\n\t\t\t\tXmNtopAttachment, XmATTACH_FORM,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  again_lbl = XtVaCreateManagedWidget(\"again_lbl\", xmLabelWidgetClass,\n\t\t\t\tlbl_form,\n\t\t\t\tXmNtopAttachment, XmATTACH_FORM,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  prompt_text = XtVaCreateManagedWidget(\"prompt_text\", xmTextWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNeditMode, XmSINGLE_LINE_EDIT,\n\t\t\t\tXmNleftAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNleftWidget, lbl_form,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNbottomWidget, sep,\n\t\t\t\tNULL);\n  XtAddCallback(prompt_text, XmNactivateCallback, unset_looping, 0);\n  XtVaGetValues(prompt_text, XmNbackground, &bg, NULL);\n  XtVaSetValues(prompt_text, XmNforeground, bg, NULL);\n\n  main_lbl = XtVaCreateWidget(\"main_lbl\", xmLabelWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNtopAttachment, XmATTACH_FORM,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tNULL);\n  scroll_win = XtVaCreateManagedWidget(\"scroll_win\",\n\t\t\t\txmScrolledWindowWidgetClass,\n\t\t\t\tform,\n\t\t\t\tXmNscrollingPolicy, XmAPPLICATION_DEFINED,\n\t\t\t\tXmNscrollBarDisplayPolicy, XmSTATIC,\n\t\t\t\tXmNtopAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNtopWidget, main_lbl,\n\t\t\t\tXmNleftAttachment, XmATTACH_FORM,\n\t\t\t\tXmNrightAttachment, XmATTACH_FORM,\n\t\t\t\tXmNbottomAttachment, XmATTACH_WIDGET,\n\t\t\t\tXmNbottomWidget, prompt_text,\n\t\t\t\tNULL);\n  scroll_text = XtVaCreateManagedWidget(\"scroll_text\", xmTextWidgetClass,\n\t\t\t\tscroll_win,\n\t\t\t\tXmNeditMode, XmMULTI_LINE_EDIT,\n\t\t\t\tXmNeditable, FALSE,\n\t\t\t\tNULL);\n  XtRealizeWidget(toplevel);\n}"
  },
  {
    "function_name": "quit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
    "lines": "175-179",
    "snippet": "static void\nquit()\n{\n  exit(retval);\n}",
    "includes": [
      "#\tinclude <varargs.h>",
      "#\tinclude <stdarg.h>",
      "#include <X11/Shell.h>",
      "#include <X11/cursorfont.h>",
      "#include <Xm/Separator.h>",
      "#include <Xm/Label.h>",
      "#include <Xm/PushB.h>",
      "#include <Xm/Text.h>",
      "#include <Xm/Form.h>",
      "#include <Xm/ScrolledW.h>",
      "#include <Xm/MessageB.h>",
      "#include <Xm/Xm.h>",
      "#include <string.h>",
      "#include <pwd.h>",
      "#include <stdio.h>",
      "#include \"kpasswd_strings.h\"",
      "#include <krb5.h>",
      "#include <kadm5/admin.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int retval=0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "retval"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "request_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/server/ovsec_kadmd.c",
          "lines": "841-846",
          "snippet": "void request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}",
          "includes": [
            "#include    \"purify.h\"",
            "#include    \"misc.h\"",
            "#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */",
            "#include    <string.h>",
            "#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */",
            "#include    <krb5/adm_proto.h>",
            "#include    <kadm5/server_acl.h>",
            "#include    <kadm5/kadm_rpc.h>",
            "#include    <kadm5/admin.h>",
            "#include    <gssrpc/auth_gssapi.h>",
            "#include    \"gssapiP_krb5.h\" /* for kg_get_context */",
            "#include    <gssapi/gssapi.h>",
            "#include    <gssrpc/rpc.h>",
            "#include    <arpa/inet.h>  /* inet_ntoa */",
            "#include    <netinet/in.h>",
            "#include    <unistd.h>",
            "#include    <sys/socket.h>",
            "#include    <sys/time.h>",
            "#include    <sys/select.h>",
            "#include    <sys/types.h>",
            "#include    <syslog.h>",
            "#include    <signal.h>",
            "#include    <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "volatile int\tsignal_request_exit = 0;",
            "void\trequest_exit(int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include    \"purify.h\"\n#include    \"misc.h\"\n#include    \"kadm5/server_internal.h\" /* XXX for kadm5_server_handle_t */\n#include    <string.h>\n#include    \"krb5/kdb_kt.h\"\t/* for krb5_ktkdb_set_context */\n#include    <krb5/adm_proto.h>\n#include    <kadm5/server_acl.h>\n#include    <kadm5/kadm_rpc.h>\n#include    <kadm5/admin.h>\n#include    <gssrpc/auth_gssapi.h>\n#include    \"gssapiP_krb5.h\" /* for kg_get_context */\n#include    <gssapi/gssapi.h>\n#include    <gssrpc/rpc.h>\n#include    <arpa/inet.h>  /* inet_ntoa */\n#include    <netinet/in.h>\n#include    <unistd.h>\n#include    <sys/socket.h>\n#include    <sys/time.h>\n#include    <sys/select.h>\n#include    <sys/types.h>\n#include    <syslog.h>\n#include    <signal.h>\n#include    <stdio.h>\n\nvolatile int\tsignal_request_exit = 0;\nvoid\trequest_exit(int);\n\nvoid request_exit(int signum)\n{\n     krb5_klog_syslog(LOG_DEBUG, \"Got signal to request exit\");\n     signal_request_exit = 1;\n     return;\n}"
        }
      }
    ],
    "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nint retval=0;\n\nstatic void\nquit()\n{\n  exit(retval);\n}"
  },
  {
    "function_name": "unset_looping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
    "lines": "164-168",
    "snippet": "static void\nunset_looping()\n{\n  looping = 0;\n}",
    "includes": [
      "#\tinclude <varargs.h>",
      "#\tinclude <stdarg.h>",
      "#include <X11/Shell.h>",
      "#include <X11/cursorfont.h>",
      "#include <Xm/Separator.h>",
      "#include <Xm/Label.h>",
      "#include <Xm/PushB.h>",
      "#include <Xm/Text.h>",
      "#include <Xm/Form.h>",
      "#include <Xm/ScrolledW.h>",
      "#include <Xm/MessageB.h>",
      "#include <Xm/Xm.h>",
      "#include <string.h>",
      "#include <pwd.h>",
      "#include <stdio.h>",
      "#include \"kpasswd_strings.h\"",
      "#include <krb5.h>",
      "#include <kadm5/admin.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int looping;"
    ],
    "called_functions": [],
    "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nint looping;\n\nstatic void\nunset_looping()\n{\n  looping = 0;\n}"
  },
  {
    "function_name": "help",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
    "lines": "143-156",
    "snippet": "static void\nhelp()\n{\n  static Widget help_dlg = NULL;\n\n  if (!help_dlg)\n    {\n      help_dlg = XmCreateInformationDialog(toplevel, \"help_dlg\", NULL,\n\t\t\t\t\t   0);\n      XtUnmanageChild(XmMessageBoxGetChild(help_dlg, XmDIALOG_CANCEL_BUTTON));\n      XtUnmanageChild(XmMessageBoxGetChild(help_dlg, XmDIALOG_HELP_BUTTON));\n    }\n  XtManageChild(help_dlg);\n}",
    "includes": [
      "#\tinclude <varargs.h>",
      "#\tinclude <stdarg.h>",
      "#include <X11/Shell.h>",
      "#include <X11/cursorfont.h>",
      "#include <Xm/Separator.h>",
      "#include <Xm/Label.h>",
      "#include <Xm/PushB.h>",
      "#include <Xm/Text.h>",
      "#include <Xm/Form.h>",
      "#include <Xm/ScrolledW.h>",
      "#include <Xm/MessageB.h>",
      "#include <Xm/Xm.h>",
      "#include <string.h>",
      "#include <pwd.h>",
      "#include <stdio.h>",
      "#include \"kpasswd_strings.h\"",
      "#include <krb5.h>",
      "#include <kadm5/admin.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "XtManageChild",
          "args": [
            "help_dlg"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtUnmanageChild",
          "args": [
            "XmMessageBoxGetChild(help_dlg, XmDIALOG_HELP_BUTTON)"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XmMessageBoxGetChild",
          "args": [
            "help_dlg",
            "XmDIALOG_HELP_BUTTON"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtUnmanageChild",
          "args": [
            "XmMessageBoxGetChild(help_dlg, XmDIALOG_CANCEL_BUTTON)"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XmMessageBoxGetChild",
          "args": [
            "help_dlg",
            "XmDIALOG_CANCEL_BUTTON"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XmCreateInformationDialog",
          "args": [
            "toplevel",
            "\"help_dlg\"",
            "NULL",
            "0"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nstatic void\nhelp()\n{\n  static Widget help_dlg = NULL;\n\n  if (!help_dlg)\n    {\n      help_dlg = XmCreateInformationDialog(toplevel, \"help_dlg\", NULL,\n\t\t\t\t\t   0);\n      XtUnmanageChild(XmMessageBoxGetChild(help_dlg, XmDIALOG_CANCEL_BUTTON));\n      XtUnmanageChild(XmMessageBoxGetChild(help_dlg, XmDIALOG_HELP_BUTTON));\n    }\n  XtManageChild(help_dlg);\n}"
  },
  {
    "function_name": "SetWatchCursor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
    "lines": "71-79",
    "snippet": "static void\nSetWatchCursor()\n{\n  static Cursor WatchCursor = (Cursor)NULL;\n\n  if (WatchCursor == (Cursor)NULL)\n    WatchCursor = XCreateFontCursor(XtDisplay(toplevel), XC_watch);\n  SetCursor(toplevel, WatchCursor);\n}",
    "includes": [
      "#\tinclude <varargs.h>",
      "#\tinclude <stdarg.h>",
      "#include <X11/Shell.h>",
      "#include <X11/cursorfont.h>",
      "#include <Xm/Separator.h>",
      "#include <Xm/Label.h>",
      "#include <Xm/PushB.h>",
      "#include <Xm/Text.h>",
      "#include <Xm/Form.h>",
      "#include <Xm/ScrolledW.h>",
      "#include <Xm/MessageB.h>",
      "#include <Xm/Xm.h>",
      "#include <string.h>",
      "#include <pwd.h>",
      "#include <stdio.h>",
      "#include \"kpasswd_strings.h\"",
      "#include <krb5.h>",
      "#include <kadm5/admin.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetCursor",
          "args": [
            "toplevel",
            "WatchCursor"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "SetCursor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
          "lines": "47-57",
          "snippet": "static void\nSetCursor(w,c)\n     Widget w;\n     Cursor c;\n{\n  while (XtIsSubclass(w, shellWidgetClass) != True)\n    w = XtParent(w);\n\n  XDefineCursor(XtDisplay(w), XtWindow(w), c);\n  XFlush(XtDisplay(w));\n}",
          "includes": [
            "#\tinclude <varargs.h>",
            "#\tinclude <stdarg.h>",
            "#include <X11/Shell.h>",
            "#include <X11/cursorfont.h>",
            "#include <Xm/Separator.h>",
            "#include <Xm/Label.h>",
            "#include <Xm/PushB.h>",
            "#include <Xm/Text.h>",
            "#include <Xm/Form.h>",
            "#include <Xm/ScrolledW.h>",
            "#include <Xm/MessageB.h>",
            "#include <Xm/Xm.h>",
            "#include <string.h>",
            "#include <pwd.h>",
            "#include <stdio.h>",
            "#include \"kpasswd_strings.h\"",
            "#include <krb5.h>",
            "#include <kadm5/admin.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nstatic void\nSetCursor(w,c)\n     Widget w;\n     Cursor c;\n{\n  while (XtIsSubclass(w, shellWidgetClass) != True)\n    w = XtParent(w);\n\n  XDefineCursor(XtDisplay(w), XtWindow(w), c);\n  XFlush(XtDisplay(w));\n}"
        }
      },
      {
        "call_info": {
          "callee": "XCreateFontCursor",
          "args": [
            "XtDisplay(toplevel)",
            "XC_watch"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtDisplay",
          "args": [
            "toplevel"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nstatic void\nSetWatchCursor()\n{\n  static Cursor WatchCursor = (Cursor)NULL;\n\n  if (WatchCursor == (Cursor)NULL)\n    WatchCursor = XCreateFontCursor(XtDisplay(toplevel), XC_watch);\n  SetCursor(toplevel, WatchCursor);\n}"
  },
  {
    "function_name": "SetStandardCursor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
    "lines": "60-68",
    "snippet": "static void\nSetStandardCursor()\n{\n  static Cursor ArrowCursor = (Cursor)NULL;\n \n  if (ArrowCursor == (Cursor)NULL)\n    ArrowCursor = XCreateFontCursor(XtDisplay(toplevel), XC_top_left_arrow);\n  SetCursor(toplevel, ArrowCursor);\n}",
    "includes": [
      "#\tinclude <varargs.h>",
      "#\tinclude <stdarg.h>",
      "#include <X11/Shell.h>",
      "#include <X11/cursorfont.h>",
      "#include <Xm/Separator.h>",
      "#include <Xm/Label.h>",
      "#include <Xm/PushB.h>",
      "#include <Xm/Text.h>",
      "#include <Xm/Form.h>",
      "#include <Xm/ScrolledW.h>",
      "#include <Xm/MessageB.h>",
      "#include <Xm/Xm.h>",
      "#include <string.h>",
      "#include <pwd.h>",
      "#include <stdio.h>",
      "#include \"kpasswd_strings.h\"",
      "#include <krb5.h>",
      "#include <kadm5/admin.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetCursor",
          "args": [
            "toplevel",
            "ArrowCursor"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "SetCursor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
          "lines": "47-57",
          "snippet": "static void\nSetCursor(w,c)\n     Widget w;\n     Cursor c;\n{\n  while (XtIsSubclass(w, shellWidgetClass) != True)\n    w = XtParent(w);\n\n  XDefineCursor(XtDisplay(w), XtWindow(w), c);\n  XFlush(XtDisplay(w));\n}",
          "includes": [
            "#\tinclude <varargs.h>",
            "#\tinclude <stdarg.h>",
            "#include <X11/Shell.h>",
            "#include <X11/cursorfont.h>",
            "#include <Xm/Separator.h>",
            "#include <Xm/Label.h>",
            "#include <Xm/PushB.h>",
            "#include <Xm/Text.h>",
            "#include <Xm/Form.h>",
            "#include <Xm/ScrolledW.h>",
            "#include <Xm/MessageB.h>",
            "#include <Xm/Xm.h>",
            "#include <string.h>",
            "#include <pwd.h>",
            "#include <stdio.h>",
            "#include \"kpasswd_strings.h\"",
            "#include <krb5.h>",
            "#include <kadm5/admin.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nstatic void\nSetCursor(w,c)\n     Widget w;\n     Cursor c;\n{\n  while (XtIsSubclass(w, shellWidgetClass) != True)\n    w = XtParent(w);\n\n  XDefineCursor(XtDisplay(w), XtWindow(w), c);\n  XFlush(XtDisplay(w));\n}"
        }
      },
      {
        "call_info": {
          "callee": "XCreateFontCursor",
          "args": [
            "XtDisplay(toplevel)",
            "XC_top_left_arrow"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtDisplay",
          "args": [
            "toplevel"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nstatic void\nSetStandardCursor()\n{\n  static Cursor ArrowCursor = (Cursor)NULL;\n \n  if (ArrowCursor == (Cursor)NULL)\n    ArrowCursor = XCreateFontCursor(XtDisplay(toplevel), XC_top_left_arrow);\n  SetCursor(toplevel, ArrowCursor);\n}"
  },
  {
    "function_name": "SetCursor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/passwd/xm_kpasswd.c",
    "lines": "47-57",
    "snippet": "static void\nSetCursor(w,c)\n     Widget w;\n     Cursor c;\n{\n  while (XtIsSubclass(w, shellWidgetClass) != True)\n    w = XtParent(w);\n\n  XDefineCursor(XtDisplay(w), XtWindow(w), c);\n  XFlush(XtDisplay(w));\n}",
    "includes": [
      "#\tinclude <varargs.h>",
      "#\tinclude <stdarg.h>",
      "#include <X11/Shell.h>",
      "#include <X11/cursorfont.h>",
      "#include <Xm/Separator.h>",
      "#include <Xm/Label.h>",
      "#include <Xm/PushB.h>",
      "#include <Xm/Text.h>",
      "#include <Xm/Form.h>",
      "#include <Xm/ScrolledW.h>",
      "#include <Xm/MessageB.h>",
      "#include <Xm/Xm.h>",
      "#include <string.h>",
      "#include <pwd.h>",
      "#include <stdio.h>",
      "#include \"kpasswd_strings.h\"",
      "#include <krb5.h>",
      "#include <kadm5/admin.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "XFlush",
          "args": [
            "XtDisplay(w)"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtDisplay",
          "args": [
            "w"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XDefineCursor",
          "args": [
            "XtDisplay(w)",
            "XtWindow(w)",
            "c"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtWindow",
          "args": [
            "w"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtDisplay",
          "args": [
            "w"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtParent",
          "args": [
            "w"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XtIsSubclass",
          "args": [
            "w",
            "shellWidgetClass"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#\tinclude <varargs.h>\n#\tinclude <stdarg.h>\n#include <X11/Shell.h>\n#include <X11/cursorfont.h>\n#include <Xm/Separator.h>\n#include <Xm/Label.h>\n#include <Xm/PushB.h>\n#include <Xm/Text.h>\n#include <Xm/Form.h>\n#include <Xm/ScrolledW.h>\n#include <Xm/MessageB.h>\n#include <Xm/Xm.h>\n#include <string.h>\n#include <pwd.h>\n#include <stdio.h>\n#include \"kpasswd_strings.h\"\n#include <krb5.h>\n#include <kadm5/admin.h>\n\nstatic void\nSetCursor(w,c)\n     Widget w;\n     Cursor c;\n{\n  while (XtIsSubclass(w, shellWidgetClass) != True)\n    w = XtParent(w);\n\n  XDefineCursor(XtDisplay(w), XtWindow(w), c);\n  XFlush(XtDisplay(w));\n}"
  }
]