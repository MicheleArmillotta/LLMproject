[
  {
    "function_name": "Tcl_AppInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/test.c",
    "lines": "31-37",
    "snippet": "int Tcl_AppInit(Tcl_Interp *interp)\n{\n     Tcl_ovsec_kadm_init(interp);\n     Tcl_kadm5_init(interp);\n\n     return(TCL_OK);\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Tcl_kadm5_init",
          "args": [
            "interp"
          ],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "Tcl_kadm5_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_kadm5.c",
          "lines": "2494-2549",
          "snippet": "void Tcl_kadm5_init(Tcl_Interp *interp)\n{\n    char buf[20];\n\n     Tcl_SetVar(interp, \"KADM5_ADMIN_SERVICE\",\n\t\tKADM5_ADMIN_SERVICE, TCL_GLOBAL_ONLY);\n     Tcl_SetVar(interp, \"KADM5_CHANGEPW_SERVICE\",\n\t\tKADM5_CHANGEPW_SERVICE, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", KADM5_STRUCT_VERSION);\n     Tcl_SetVar(interp, \"KADM5_STRUCT_VERSION\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", KADM5_API_VERSION_1);\n     Tcl_SetVar(interp, \"KADM5_API_VERSION_1\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", KADM5_API_VERSION_2);\n     Tcl_SetVar(interp, \"KADM5_API_VERSION_2\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", KADM5_API_VERSION_MASK);\n     Tcl_SetVar(interp, \"KADM5_API_VERSION_MASK\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", KADM5_STRUCT_VERSION_MASK);\n     Tcl_SetVar(interp, \"KADM5_STRUCT_VERSION_MASK\", buf,\n\t\tTCL_GLOBAL_ONLY);\n\n     Tcl_CreateCommand(interp, \"kadm5_init\", tcl_kadm5_init, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_init_with_creds\",\n\t\t       tcl_kadm5_init_with_creds, 0, 0); \n     Tcl_CreateCommand(interp, \"kadm5_destroy\", tcl_kadm5_destroy, 0,\n\t\t       0);\n     Tcl_CreateCommand(interp, \"kadm5_create_principal\",\n\t\t       tcl_kadm5_create_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_delete_principal\",\n\t\t       tcl_kadm5_delete_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_modify_principal\",\n\t\t       tcl_kadm5_modify_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_rename_principal\",\n\t\t       tcl_kadm5_rename_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_chpass_principal\",\n\t\t       tcl_kadm5_chpass_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_chpass_principal_util\",\n\t\t       tcl_kadm5_chpass_principal_util, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_randkey_principal\",\n\t\t       tcl_kadm5_randkey_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_get_principal\",\n\t\t       tcl_kadm5_get_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_create_policy\",\n\t\t       tcl_kadm5_create_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_delete_policy\",\n\t\t       tcl_kadm5_delete_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_modify_policy\",\n\t\t       tcl_kadm5_modify_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_get_policy\",\n\t\t       tcl_kadm5_get_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_free_principal_ent\",\n\t\t       tcl_kadm5_free_principal_ent, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_free_policy_ent\",\n\t\t       tcl_kadm5_free_policy_ent, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_get_privs\",\n\t\t       tcl_kadm5_get_privs, 0, 0);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nvoid Tcl_kadm5_init(Tcl_Interp *interp)\n{\n    char buf[20];\n\n     Tcl_SetVar(interp, \"KADM5_ADMIN_SERVICE\",\n\t\tKADM5_ADMIN_SERVICE, TCL_GLOBAL_ONLY);\n     Tcl_SetVar(interp, \"KADM5_CHANGEPW_SERVICE\",\n\t\tKADM5_CHANGEPW_SERVICE, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", KADM5_STRUCT_VERSION);\n     Tcl_SetVar(interp, \"KADM5_STRUCT_VERSION\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", KADM5_API_VERSION_1);\n     Tcl_SetVar(interp, \"KADM5_API_VERSION_1\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", KADM5_API_VERSION_2);\n     Tcl_SetVar(interp, \"KADM5_API_VERSION_2\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", KADM5_API_VERSION_MASK);\n     Tcl_SetVar(interp, \"KADM5_API_VERSION_MASK\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", KADM5_STRUCT_VERSION_MASK);\n     Tcl_SetVar(interp, \"KADM5_STRUCT_VERSION_MASK\", buf,\n\t\tTCL_GLOBAL_ONLY);\n\n     Tcl_CreateCommand(interp, \"kadm5_init\", tcl_kadm5_init, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_init_with_creds\",\n\t\t       tcl_kadm5_init_with_creds, 0, 0); \n     Tcl_CreateCommand(interp, \"kadm5_destroy\", tcl_kadm5_destroy, 0,\n\t\t       0);\n     Tcl_CreateCommand(interp, \"kadm5_create_principal\",\n\t\t       tcl_kadm5_create_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_delete_principal\",\n\t\t       tcl_kadm5_delete_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_modify_principal\",\n\t\t       tcl_kadm5_modify_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_rename_principal\",\n\t\t       tcl_kadm5_rename_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_chpass_principal\",\n\t\t       tcl_kadm5_chpass_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_chpass_principal_util\",\n\t\t       tcl_kadm5_chpass_principal_util, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_randkey_principal\",\n\t\t       tcl_kadm5_randkey_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_get_principal\",\n\t\t       tcl_kadm5_get_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_create_policy\",\n\t\t       tcl_kadm5_create_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_delete_policy\",\n\t\t       tcl_kadm5_delete_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_modify_policy\",\n\t\t       tcl_kadm5_modify_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_get_policy\",\n\t\t       tcl_kadm5_get_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_free_principal_ent\",\n\t\t       tcl_kadm5_free_principal_ent, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_free_policy_ent\",\n\t\t       tcl_kadm5_free_policy_ent, 0, 0);\n     Tcl_CreateCommand(interp, \"kadm5_get_privs\",\n\t\t       tcl_kadm5_get_privs, 0, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Tcl_ovsec_kadm_init",
          "args": [
            "interp"
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "Tcl_ovsec_kadm_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/tcl_ovsec_kadm.c",
          "lines": "1978-2029",
          "snippet": "void Tcl_ovsec_kadm_init(Tcl_Interp *interp)\n{\n    char buf[20];\n\n     Tcl_SetVar(interp, \"OVSEC_KADM_ADMIN_SERVICE\",\n\t\tOVSEC_KADM_ADMIN_SERVICE, TCL_GLOBAL_ONLY);\n     Tcl_SetVar(interp, \"OVSEC_KADM_CHANGEPW_SERVICE\",\n\t\tOVSEC_KADM_CHANGEPW_SERVICE, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", OVSEC_KADM_STRUCT_VERSION);\n     Tcl_SetVar(interp, \"OVSEC_KADM_STRUCT_VERSION\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", OVSEC_KADM_API_VERSION_1);\n     Tcl_SetVar(interp, \"OVSEC_KADM_API_VERSION_1\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", OVSEC_KADM_API_VERSION_MASK);\n     Tcl_SetVar(interp, \"OVSEC_KADM_API_VERSION_MASK\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", OVSEC_KADM_STRUCT_VERSION_MASK);\n     Tcl_SetVar(interp, \"OVSEC_KADM_STRUCT_VERSION_MASK\", buf,\n\t\tTCL_GLOBAL_ONLY);\n\n     Tcl_CreateCommand(interp, \"ovsec_kadm_init\", tcl_ovsec_kadm_init, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_destroy\", tcl_ovsec_kadm_destroy, 0,\n\t\t       0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_create_principal\",\n\t\t       tcl_ovsec_kadm_create_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_delete_principal\",\n\t\t       tcl_ovsec_kadm_delete_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_modify_principal\",\n\t\t       tcl_ovsec_kadm_modify_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_rename_principal\",\n\t\t       tcl_ovsec_kadm_rename_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_chpass_principal\",\n\t\t       tcl_ovsec_kadm_chpass_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_chpass_principal_util\",\n\t\t       tcl_ovsec_kadm_chpass_principal_util, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_randkey_principal\",\n\t\t       tcl_ovsec_kadm_randkey_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_get_principal\",\n\t\t       tcl_ovsec_kadm_get_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_create_policy\",\n\t\t       tcl_ovsec_kadm_create_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_delete_policy\",\n\t\t       tcl_ovsec_kadm_delete_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_modify_policy\",\n\t\t       tcl_ovsec_kadm_modify_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_get_policy\",\n\t\t       tcl_ovsec_kadm_get_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_free_principal_ent\",\n\t\t       tcl_ovsec_kadm_free_principal_ent, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_free_policy_ent\",\n\t\t       tcl_ovsec_kadm_free_policy_ent, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_get_privs\",\n\t\t       tcl_ovsec_kadm_get_privs, 0, 0);\n}",
          "includes": [
            "#include \"tcl_kadm5.h\"",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <k5-int.h>",
            "#include <com_err.h>",
            "#include <kadm5/admin.h>",
            "#include <tcl/tcl.h>",
            "#include <tcl.h>",
            "#include <string.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <stdlib.h>\n#include <errno.h>\n#include <k5-int.h>\n#include <com_err.h>\n#include <kadm5/admin.h>\n#include <tcl/tcl.h>\n#include <tcl.h>\n#include <string.h>\n#include <stdio.h>\n\nvoid Tcl_ovsec_kadm_init(Tcl_Interp *interp)\n{\n    char buf[20];\n\n     Tcl_SetVar(interp, \"OVSEC_KADM_ADMIN_SERVICE\",\n\t\tOVSEC_KADM_ADMIN_SERVICE, TCL_GLOBAL_ONLY);\n     Tcl_SetVar(interp, \"OVSEC_KADM_CHANGEPW_SERVICE\",\n\t\tOVSEC_KADM_CHANGEPW_SERVICE, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", OVSEC_KADM_STRUCT_VERSION);\n     Tcl_SetVar(interp, \"OVSEC_KADM_STRUCT_VERSION\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", OVSEC_KADM_API_VERSION_1);\n     Tcl_SetVar(interp, \"OVSEC_KADM_API_VERSION_1\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", OVSEC_KADM_API_VERSION_MASK);\n     Tcl_SetVar(interp, \"OVSEC_KADM_API_VERSION_MASK\", buf, TCL_GLOBAL_ONLY);\n    (void) sprintf(buf, \"%d\", OVSEC_KADM_STRUCT_VERSION_MASK);\n     Tcl_SetVar(interp, \"OVSEC_KADM_STRUCT_VERSION_MASK\", buf,\n\t\tTCL_GLOBAL_ONLY);\n\n     Tcl_CreateCommand(interp, \"ovsec_kadm_init\", tcl_ovsec_kadm_init, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_destroy\", tcl_ovsec_kadm_destroy, 0,\n\t\t       0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_create_principal\",\n\t\t       tcl_ovsec_kadm_create_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_delete_principal\",\n\t\t       tcl_ovsec_kadm_delete_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_modify_principal\",\n\t\t       tcl_ovsec_kadm_modify_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_rename_principal\",\n\t\t       tcl_ovsec_kadm_rename_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_chpass_principal\",\n\t\t       tcl_ovsec_kadm_chpass_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_chpass_principal_util\",\n\t\t       tcl_ovsec_kadm_chpass_principal_util, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_randkey_principal\",\n\t\t       tcl_ovsec_kadm_randkey_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_get_principal\",\n\t\t       tcl_ovsec_kadm_get_principal, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_create_policy\",\n\t\t       tcl_ovsec_kadm_create_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_delete_policy\",\n\t\t       tcl_ovsec_kadm_delete_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_modify_policy\",\n\t\t       tcl_ovsec_kadm_modify_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_get_policy\",\n\t\t       tcl_ovsec_kadm_get_policy, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_free_principal_ent\",\n\t\t       tcl_ovsec_kadm_free_principal_ent, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_free_policy_ent\",\n\t\t       tcl_ovsec_kadm_free_policy_ent, 0, 0);\n     Tcl_CreateCommand(interp, \"ovsec_kadm_get_privs\",\n\t\t       tcl_ovsec_kadm_get_privs, 0, 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <tcl/tcl.h>\n#include <tcl.h>\n\nint Tcl_AppInit(Tcl_Interp *interp)\n{\n     Tcl_ovsec_kadm_init(interp);\n     Tcl_kadm5_init(interp);\n\n     return(TCL_OK);\n}"
  },
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp_ICV/CVE-2014-9422/repo/src/kadmin/testing/util/test.c",
    "lines": "11-18",
    "snippet": "int\nmain(argc, argv)\n    int argc;\t\t\t/* Number of command-line arguments. */\n    char **argv;\t\t/* Values of command-line arguments. */\n{\n    Tcl_Main(argc, argv, Tcl_AppInit);\n    return 0;\t\t\t/* Needed only to prevent compiler warning. */\n}",
    "includes": [
      "#include \"tcl_kadm5.h\"",
      "#include <tcl/tcl.h>",
      "#include <tcl.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Tcl_Main",
          "args": [
            "argc",
            "argv",
            "Tcl_AppInit"
          ],
          "line": 16
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"tcl_kadm5.h\"\n#include <tcl/tcl.h>\n#include <tcl.h>\n\nint\nmain(argc, argv)\n    int argc;\t\t\t/* Number of command-line arguments. */\n    char **argv;\t\t/* Values of command-line arguments. */\n{\n    Tcl_Main(argc, argv, Tcl_AppInit);\n    return 0;\t\t\t/* Needed only to prevent compiler warning. */\n}"
  }
]