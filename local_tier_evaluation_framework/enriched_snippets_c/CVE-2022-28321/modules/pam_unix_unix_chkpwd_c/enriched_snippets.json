[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_unix/unix_chkpwd.c",
    "lines": "91-210",
    "snippet": "int main(int argc, char *argv[])\n{\n\tchar pass[PAM_MAX_RESP_SIZE + 1];\n\tchar *option;\n\tint npass, nullok;\n\tint blankpass = 0;\n\tint retval = PAM_AUTH_ERR;\n\tchar *user;\n\tchar *passwords[] = { pass };\n\n\t/*\n\t * Catch or ignore as many signal as possible.\n\t */\n\tsetup_signals();\n\n\t/*\n\t * we establish that this program is running with non-tty stdin.\n\t * this is to discourage casual use. It does *NOT* prevent an\n\t * intruder from repeatadly running this program to determine the\n\t * password of the current user (brute force attack, but one for\n\t * which the attacker must already have gained access to the user's\n\t * account).\n\t */\n\n\tif (isatty(STDIN_FILENO) || argc != 3 ) {\n\t\thelper_log_err(LOG_NOTICE\n\t\t      ,\"inappropriate use of Unix helper binary [UID=%d]\"\n\t\t\t ,getuid());\n#ifdef HAVE_LIBAUDIT\n\t\t_audit_log(AUDIT_ANOM_EXEC, getuidname(getuid()), PAM_SYSTEM_ERR);\n#endif\n\t\tfprintf(stderr\n\t\t ,\"This binary is not designed for running in this way\\n\"\n\t\t      \"-- the system administrator has been informed\\n\");\n\t\tsleep(10);\t/* this should discourage/annoy the user */\n\t\treturn PAM_SYSTEM_ERR;\n\t}\n\n\t/*\n\t * Determine what the current user's name is.\n\t * We must thus skip the check if the real uid is 0.\n\t */\n\tif (getuid() == 0) {\n\t  user=argv[1];\n\t}\n\telse {\n\t  user = getuidname(getuid());\n\t  /* if the caller specifies the username, verify that user\n\t     matches it */\n\t  if (user == NULL || strcmp(user, argv[1])) {\n\t    user = argv[1];\n\t    /* no match -> permanently change to the real user and proceed */\n\t    if (setuid(getuid()) != 0)\n\t\treturn PAM_AUTH_ERR;\n\t  }\n\t}\n\n\toption=argv[2];\n\n\tif (strcmp(option, \"chkexpiry\") == 0)\n\t  /* Check account information from the shadow file */\n\t  return _check_expiry(argv[1]);\n\t/* read the nullok/nonull option */\n\telse if (strcmp(option, \"nullok\") == 0)\n\t  nullok = 1;\n\telse if (strcmp(option, \"nonull\") == 0)\n\t  nullok = 0;\n\telse {\n#ifdef HAVE_LIBAUDIT\n\t  _audit_log(AUDIT_ANOM_EXEC, getuidname(getuid()), PAM_SYSTEM_ERR);\n#endif\n\t  return PAM_SYSTEM_ERR;\n\t}\n\t/* read the password from stdin (a pipe from the pam_unix module) */\n\n\tnpass = pam_read_passwords(STDIN_FILENO, 1, passwords);\n\n\tif (npass != 1) {\t/* is it a valid password? */\n\t\thelper_log_err(LOG_DEBUG, \"no password supplied\");\n\t\t*pass = '\\0';\n\t}\n\n\tif (*pass == '\\0') {\n\t\tblankpass = 1;\n\t}\n\n\tretval = helper_verify_password(user, pass, nullok);\n\n\tmemset(pass, '\\0', PAM_MAX_RESP_SIZE);\t/* clear memory of the password */\n\n\t/* return pass or fail */\n\n\tif (retval != PAM_SUCCESS) {\n\t\tif (!nullok || !blankpass) {\n\t\t\t/* no need to log blank pass test */\n#ifdef HAVE_LIBAUDIT\n\t\t\tif (getuid() != 0)\n\t\t\t\t_audit_log(AUDIT_USER_AUTH, user, PAM_AUTH_ERR);\n#endif\n\t\t\thelper_log_err(LOG_NOTICE, \"password check failed for user (%s)\", user);\n\t\t}\n\t\t/* if helper_verify_password() returned PAM_USER_UNKNOWN, the\n\t\t   most appropriate error to propagate to\n\t\t   _unix_verify_password() is PAM_AUTHINFO_UNAVAIL; otherwise\n\t\t   return general failure */\n\t\tif (retval == PAM_USER_UNKNOWN)\n\t\t\treturn PAM_AUTHINFO_UNAVAIL;\n\t\telse\n\t\t\treturn PAM_AUTH_ERR;\n\t} else {\n\t        if (getuid() != 0) {\n#ifdef HAVE_LIBAUDIT\n\t\t\treturn _audit_log(AUDIT_USER_AUTH, user, PAM_SUCCESS);\n#else\n\t\t        return PAM_SUCCESS;\n#endif\n\t        }\n\t\treturn PAM_SUCCESS;\n\t}\n}",
    "includes": [
      "#include \"pam_inline.h\"",
      "#include \"passverify.h\"",
      "#include <security/_pam_macros.h>",
      "#include <security/_pam_types.h>",
      "#include <libaudit.h>",
      "#include <errno.h>",
      "#include <time.h>",
      "#include <signal.h>",
      "#include <shadow.h>",
      "#include <pwd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_audit_log",
          "args": [
            "AUDIT_USER_AUTH",
            "user",
            "PAM_SUCCESS"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "_audit_log",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_unix/unix_chkpwd.c",
          "lines": "63-88",
          "snippet": "static int _audit_log(int type, const char *uname, int rc)\n{\n\tint audit_fd;\n\n\taudit_fd = audit_open();\n\tif (audit_fd < 0) {\n\t\t/* You get these error codes only when the kernel doesn't have\n\t\t * audit compiled in. */\n\t\tif (errno == EINVAL || errno == EPROTONOSUPPORT ||\n\t\t\terrno == EAFNOSUPPORT)\n\t\t\treturn PAM_SUCCESS;\n\n\t\thelper_log_err(LOG_CRIT, \"audit_open() failed: %m\");\n\t\treturn PAM_AUTH_ERR;\n\t}\n\n\trc = audit_log_acct_message(audit_fd, type, NULL, \"PAM:unix_chkpwd\",\n\t\tuname, -1, NULL, NULL, NULL, rc == PAM_SUCCESS);\n\tif (rc == -EPERM && geteuid() != 0) {\n\t\trc = 0;\n\t}\n\n\taudit_close(audit_fd);\n\n\treturn rc < 0 ? PAM_AUTH_ERR : PAM_SUCCESS;\n}",
          "includes": [
            "#include \"pam_inline.h\"",
            "#include \"passverify.h\"",
            "#include <security/_pam_macros.h>",
            "#include <security/_pam_types.h>",
            "#include <libaudit.h>",
            "#include <errno.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <shadow.h>",
            "#include <pwd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pam_inline.h\"\n#include \"passverify.h\"\n#include <security/_pam_macros.h>\n#include <security/_pam_types.h>\n#include <libaudit.h>\n#include <errno.h>\n#include <time.h>\n#include <signal.h>\n#include <shadow.h>\n#include <pwd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic int _audit_log(int type, const char *uname, int rc)\n{\n\tint audit_fd;\n\n\taudit_fd = audit_open();\n\tif (audit_fd < 0) {\n\t\t/* You get these error codes only when the kernel doesn't have\n\t\t * audit compiled in. */\n\t\tif (errno == EINVAL || errno == EPROTONOSUPPORT ||\n\t\t\terrno == EAFNOSUPPORT)\n\t\t\treturn PAM_SUCCESS;\n\n\t\thelper_log_err(LOG_CRIT, \"audit_open() failed: %m\");\n\t\treturn PAM_AUTH_ERR;\n\t}\n\n\trc = audit_log_acct_message(audit_fd, type, NULL, \"PAM:unix_chkpwd\",\n\t\tuname, -1, NULL, NULL, NULL, rc == PAM_SUCCESS);\n\tif (rc == -EPERM && geteuid() != 0) {\n\t\trc = 0;\n\t}\n\n\taudit_close(audit_fd);\n\n\treturn rc < 0 ? PAM_AUTH_ERR : PAM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "helper_log_err",
          "args": [
            "LOG_NOTICE",
            "\"password check failed for user (%s)\"",
            "user"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "helper_log_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_pwhistory/opasswd.c",
          "lines": "91-101",
          "snippet": "void\nhelper_log_err(int err, const char *format, ...)\n{\n  va_list args;\n\n  va_start(args, format);\n  openlog(HELPER_COMPILE, LOG_CONS | LOG_PID, LOG_AUTHPRIV);\n  vsyslog(err, format, args);\n  va_end(args);\n  closelog();\n}",
          "includes": [
            "#include \"opasswd.h\"",
            "#include <security/pam_modules.h>",
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <crypt.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <limits.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <time.h>",
            "#include <shadow.h>",
            "#include <pwd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"opasswd.h\"\n#include <security/pam_modules.h>\n#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <crypt.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <stdlib.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <limits.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <time.h>\n#include <shadow.h>\n#include <pwd.h>\n#include <config.h>\n\nvoid\nhelper_log_err(int err, const char *format, ...)\n{\n  va_list args;\n\n  va_start(args, format);\n  openlog(HELPER_COMPILE, LOG_CONS | LOG_PID, LOG_AUTHPRIV);\n  vsyslog(err, format, args);\n  va_end(args);\n  closelog();\n}"
        }
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "pass",
            "'\\0'",
            "PAM_MAX_RESP_SIZE"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "helper_verify_password",
          "args": [
            "user",
            "pass",
            "nullok"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "helper_verify_password",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_unix/passverify.c",
          "lines": "1070-1100",
          "snippet": "int\nhelper_verify_password(const char *name, const char *p, int nullok)\n{\n\tstruct passwd *pwd = NULL;\n\tchar *hash = NULL;\n\tint retval;\n\n\tretval = get_pwd_hash(name, &pwd, &hash);\n\n\tif (pwd == NULL || hash == NULL) {\n\t\thelper_log_err(LOG_NOTICE, \"check pass; user unknown\");\n\t\tretval = PAM_USER_UNKNOWN;\n\t} else if (p[0] == '\\0' && nullok) {\n\t\tif (hash[0] == '\\0') {\n\t\t\tretval = PAM_SUCCESS;\n\t\t} else {\n\t\t\tretval = PAM_AUTH_ERR;\n\t\t}\n\t} else {\n\t\tretval = verify_pwd_hash(p, hash, nullok);\n\t}\n\n\tif (hash) {\n\t\t_pam_overwrite(hash);\n\t\t_pam_drop(hash);\n\t}\n\n\tp = NULL;\t\t/* no longer needed here */\n\n\treturn retval;\n}",
          "includes": [
            "# include \"./lckpwdf.-c\"",
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <selinux/selinux.h>",
            "#include \"passverify.h\"",
            "#include \"bigcrypt.h\"",
            "#include \"md5.h\"",
            "#include \"pam_inline.h\"",
            "#include \"pam_cc_compat.h\"",
            "#include <crypt.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <errno.h>",
            "#include <signal.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <shadow.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include \"support.h\"",
            "#include <security/pam_modules.h>",
            "#include <security/_pam_macros.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int retval;",
            "PAMH_ARG_DECL(int get_account_info,\n\tconst char *name, struct passwd **pwd, struct spwd **spwdent)\n{\n\t/* UNIX passwords area */\n\t*pwd = pam_modutil_getpwnam(pamh, name);",
            "PAMH_ARG_DECL(int get_pwd_hash,\n\tconst char *name, struct passwd **pwd, char **hash)\n{\n\tint retval;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"./lckpwdf.-c\"\n#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <selinux/selinux.h>\n#include \"passverify.h\"\n#include \"bigcrypt.h\"\n#include \"md5.h\"\n#include \"pam_inline.h\"\n#include \"pam_cc_compat.h\"\n#include <crypt.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <errno.h>\n#include <signal.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <shadow.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include \"support.h\"\n#include <security/pam_modules.h>\n#include <security/_pam_macros.h>\n#include \"config.h\"\n\nint retval;\nPAMH_ARG_DECL(int get_account_info,\n\tconst char *name, struct passwd **pwd, struct spwd **spwdent)\n{\n\t/* UNIX passwords area */\n\t*pwd = pam_modutil_getpwnam(pamh, name);\nPAMH_ARG_DECL(int get_pwd_hash,\n\tconst char *name, struct passwd **pwd, char **hash)\n{\n\tint retval;\n\nint\nhelper_verify_password(const char *name, const char *p, int nullok)\n{\n\tstruct passwd *pwd = NULL;\n\tchar *hash = NULL;\n\tint retval;\n\n\tretval = get_pwd_hash(name, &pwd, &hash);\n\n\tif (pwd == NULL || hash == NULL) {\n\t\thelper_log_err(LOG_NOTICE, \"check pass; user unknown\");\n\t\tretval = PAM_USER_UNKNOWN;\n\t} else if (p[0] == '\\0' && nullok) {\n\t\tif (hash[0] == '\\0') {\n\t\t\tretval = PAM_SUCCESS;\n\t\t} else {\n\t\t\tretval = PAM_AUTH_ERR;\n\t\t}\n\t} else {\n\t\tretval = verify_pwd_hash(p, hash, nullok);\n\t}\n\n\tif (hash) {\n\t\t_pam_overwrite(hash);\n\t\t_pam_drop(hash);\n\t}\n\n\tp = NULL;\t\t/* no longer needed here */\n\n\treturn retval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pam_read_passwords",
          "args": [
            "STDIN_FILENO",
            "1",
            "passwords"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getuidname",
          "args": [
            "getuid()"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "getuidname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_unix/passverify.c",
          "lines": "1157-1171",
          "snippet": "char *\ngetuidname(uid_t uid)\n{\n        struct passwd *pw;\n        static char username[256];\n\n        pw = getpwuid(uid);\n        if (pw == NULL)\n                return NULL;\n\n        strncpy(username, pw->pw_name, sizeof(username));\n        username[sizeof(username) - 1] = '\\0';\n\n        return username;\n}",
          "includes": [
            "# include \"./lckpwdf.-c\"",
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <selinux/selinux.h>",
            "#include \"passverify.h\"",
            "#include \"bigcrypt.h\"",
            "#include \"md5.h\"",
            "#include \"pam_inline.h\"",
            "#include \"pam_cc_compat.h\"",
            "#include <crypt.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <errno.h>",
            "#include <signal.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <shadow.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include \"support.h\"",
            "#include <security/pam_modules.h>",
            "#include <security/_pam_macros.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"./lckpwdf.-c\"\n#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <selinux/selinux.h>\n#include \"passverify.h\"\n#include \"bigcrypt.h\"\n#include \"md5.h\"\n#include \"pam_inline.h\"\n#include \"pam_cc_compat.h\"\n#include <crypt.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <errno.h>\n#include <signal.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <shadow.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include \"support.h\"\n#include <security/pam_modules.h>\n#include <security/_pam_macros.h>\n#include \"config.h\"\n\nchar *\ngetuidname(uid_t uid)\n{\n        struct passwd *pw;\n        static char username[256];\n\n        pw = getpwuid(uid);\n        if (pw == NULL)\n                return NULL;\n\n        strncpy(username, pw->pw_name, sizeof(username));\n        username[sizeof(username) - 1] = '\\0';\n\n        return username;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "option",
            "\"nonull\""
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "option",
            "\"nullok\""
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_check_expiry",
          "args": [
            "argv[1]"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "_check_expiry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_unix/unix_chkpwd.c",
          "lines": "38-60",
          "snippet": "static int _check_expiry(const char *uname)\n{\n\tstruct spwd *spent;\n\tstruct passwd *pwent;\n\tint retval;\n\tint daysleft;\n\n\tretval = get_account_info(uname, &pwent, &spent);\n\tif (retval != PAM_SUCCESS) {\n\t\thelper_log_err(LOG_ERR, \"could not obtain user info (%s)\", uname);\n\t\tprintf(\"-1\\n\");\n\t\treturn retval;\n\t}\n\n\tif (spent == NULL) {\n\t\tprintf(\"-1\\n\");\n\t\treturn retval;\n\t}\n\n\tretval = check_shadow_expiry(spent, &daysleft);\n\tprintf(\"%d\\n\", daysleft);\n\treturn retval;\n}",
          "includes": [
            "#include \"pam_inline.h\"",
            "#include \"passverify.h\"",
            "#include <security/_pam_macros.h>",
            "#include <security/_pam_types.h>",
            "#include <libaudit.h>",
            "#include <errno.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <shadow.h>",
            "#include <pwd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pam_inline.h\"\n#include \"passverify.h\"\n#include <security/_pam_macros.h>\n#include <security/_pam_types.h>\n#include <libaudit.h>\n#include <errno.h>\n#include <time.h>\n#include <signal.h>\n#include <shadow.h>\n#include <pwd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic int _check_expiry(const char *uname)\n{\n\tstruct spwd *spent;\n\tstruct passwd *pwent;\n\tint retval;\n\tint daysleft;\n\n\tretval = get_account_info(uname, &pwent, &spent);\n\tif (retval != PAM_SUCCESS) {\n\t\thelper_log_err(LOG_ERR, \"could not obtain user info (%s)\", uname);\n\t\tprintf(\"-1\\n\");\n\t\treturn retval;\n\t}\n\n\tif (spent == NULL) {\n\t\tprintf(\"-1\\n\");\n\t\treturn retval;\n\t}\n\n\tretval = check_shadow_expiry(spent, &daysleft);\n\tprintf(\"%d\\n\", daysleft);\n\treturn retval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "option",
            "\"chkexpiry\""
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setuid",
          "args": [
            "getuid()"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "user",
            "argv[1]"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sleep",
          "args": [
            "10"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"This binary is not designed for running in this way\\n\"\n\t\t      \"-- the system administrator has been informed\\n\""
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isatty",
          "args": [
            "STDIN_FILENO"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup_signals",
          "args": [],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "setup_signals",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_unix/passverify.c",
          "lines": "1132-1155",
          "snippet": "void\nsetup_signals(void)\n{\n        struct sigaction action;        /* posix signal structure */\n\n        /*\n         * Setup signal handlers\n         */\n        (void) memset((void *) &action, 0, sizeof(action));\n        action.sa_handler = su_sighandler;\n#ifdef SA_RESETHAND\n        action.sa_flags = SA_RESETHAND;\n#endif\n        (void) sigaction(SIGILL, &action, NULL);\n        (void) sigaction(SIGTRAP, &action, NULL);\n        (void) sigaction(SIGBUS, &action, NULL);\n        (void) sigaction(SIGSEGV, &action, NULL);\n        action.sa_handler = SIG_IGN;\n        action.sa_flags = 0;\n        (void) sigaction(SIGTERM, &action, NULL);\n        (void) sigaction(SIGHUP, &action, NULL);\n        (void) sigaction(SIGINT, &action, NULL);\n        (void) sigaction(SIGQUIT, &action, NULL);\n}",
          "includes": [
            "# include \"./lckpwdf.-c\"",
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <selinux/selinux.h>",
            "#include \"passverify.h\"",
            "#include \"bigcrypt.h\"",
            "#include \"md5.h\"",
            "#include \"pam_inline.h\"",
            "#include \"pam_cc_compat.h\"",
            "#include <crypt.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <errno.h>",
            "#include <signal.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <shadow.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include \"support.h\"",
            "#include <security/pam_modules.h>",
            "#include <security/_pam_macros.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"./lckpwdf.-c\"\n#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <selinux/selinux.h>\n#include \"passverify.h\"\n#include \"bigcrypt.h\"\n#include \"md5.h\"\n#include \"pam_inline.h\"\n#include \"pam_cc_compat.h\"\n#include <crypt.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <errno.h>\n#include <signal.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <shadow.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <string.h>\n#include <stdio.h>\n#include \"support.h\"\n#include <security/pam_modules.h>\n#include <security/_pam_macros.h>\n#include \"config.h\"\n\nvoid\nsetup_signals(void)\n{\n        struct sigaction action;        /* posix signal structure */\n\n        /*\n         * Setup signal handlers\n         */\n        (void) memset((void *) &action, 0, sizeof(action));\n        action.sa_handler = su_sighandler;\n#ifdef SA_RESETHAND\n        action.sa_flags = SA_RESETHAND;\n#endif\n        (void) sigaction(SIGILL, &action, NULL);\n        (void) sigaction(SIGTRAP, &action, NULL);\n        (void) sigaction(SIGBUS, &action, NULL);\n        (void) sigaction(SIGSEGV, &action, NULL);\n        action.sa_handler = SIG_IGN;\n        action.sa_flags = 0;\n        (void) sigaction(SIGTERM, &action, NULL);\n        (void) sigaction(SIGHUP, &action, NULL);\n        (void) sigaction(SIGINT, &action, NULL);\n        (void) sigaction(SIGQUIT, &action, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pam_inline.h\"\n#include \"passverify.h\"\n#include <security/_pam_macros.h>\n#include <security/_pam_types.h>\n#include <libaudit.h>\n#include <errno.h>\n#include <time.h>\n#include <signal.h>\n#include <shadow.h>\n#include <pwd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint main(int argc, char *argv[])\n{\n\tchar pass[PAM_MAX_RESP_SIZE + 1];\n\tchar *option;\n\tint npass, nullok;\n\tint blankpass = 0;\n\tint retval = PAM_AUTH_ERR;\n\tchar *user;\n\tchar *passwords[] = { pass };\n\n\t/*\n\t * Catch or ignore as many signal as possible.\n\t */\n\tsetup_signals();\n\n\t/*\n\t * we establish that this program is running with non-tty stdin.\n\t * this is to discourage casual use. It does *NOT* prevent an\n\t * intruder from repeatadly running this program to determine the\n\t * password of the current user (brute force attack, but one for\n\t * which the attacker must already have gained access to the user's\n\t * account).\n\t */\n\n\tif (isatty(STDIN_FILENO) || argc != 3 ) {\n\t\thelper_log_err(LOG_NOTICE\n\t\t      ,\"inappropriate use of Unix helper binary [UID=%d]\"\n\t\t\t ,getuid());\n#ifdef HAVE_LIBAUDIT\n\t\t_audit_log(AUDIT_ANOM_EXEC, getuidname(getuid()), PAM_SYSTEM_ERR);\n#endif\n\t\tfprintf(stderr\n\t\t ,\"This binary is not designed for running in this way\\n\"\n\t\t      \"-- the system administrator has been informed\\n\");\n\t\tsleep(10);\t/* this should discourage/annoy the user */\n\t\treturn PAM_SYSTEM_ERR;\n\t}\n\n\t/*\n\t * Determine what the current user's name is.\n\t * We must thus skip the check if the real uid is 0.\n\t */\n\tif (getuid() == 0) {\n\t  user=argv[1];\n\t}\n\telse {\n\t  user = getuidname(getuid());\n\t  /* if the caller specifies the username, verify that user\n\t     matches it */\n\t  if (user == NULL || strcmp(user, argv[1])) {\n\t    user = argv[1];\n\t    /* no match -> permanently change to the real user and proceed */\n\t    if (setuid(getuid()) != 0)\n\t\treturn PAM_AUTH_ERR;\n\t  }\n\t}\n\n\toption=argv[2];\n\n\tif (strcmp(option, \"chkexpiry\") == 0)\n\t  /* Check account information from the shadow file */\n\t  return _check_expiry(argv[1]);\n\t/* read the nullok/nonull option */\n\telse if (strcmp(option, \"nullok\") == 0)\n\t  nullok = 1;\n\telse if (strcmp(option, \"nonull\") == 0)\n\t  nullok = 0;\n\telse {\n#ifdef HAVE_LIBAUDIT\n\t  _audit_log(AUDIT_ANOM_EXEC, getuidname(getuid()), PAM_SYSTEM_ERR);\n#endif\n\t  return PAM_SYSTEM_ERR;\n\t}\n\t/* read the password from stdin (a pipe from the pam_unix module) */\n\n\tnpass = pam_read_passwords(STDIN_FILENO, 1, passwords);\n\n\tif (npass != 1) {\t/* is it a valid password? */\n\t\thelper_log_err(LOG_DEBUG, \"no password supplied\");\n\t\t*pass = '\\0';\n\t}\n\n\tif (*pass == '\\0') {\n\t\tblankpass = 1;\n\t}\n\n\tretval = helper_verify_password(user, pass, nullok);\n\n\tmemset(pass, '\\0', PAM_MAX_RESP_SIZE);\t/* clear memory of the password */\n\n\t/* return pass or fail */\n\n\tif (retval != PAM_SUCCESS) {\n\t\tif (!nullok || !blankpass) {\n\t\t\t/* no need to log blank pass test */\n#ifdef HAVE_LIBAUDIT\n\t\t\tif (getuid() != 0)\n\t\t\t\t_audit_log(AUDIT_USER_AUTH, user, PAM_AUTH_ERR);\n#endif\n\t\t\thelper_log_err(LOG_NOTICE, \"password check failed for user (%s)\", user);\n\t\t}\n\t\t/* if helper_verify_password() returned PAM_USER_UNKNOWN, the\n\t\t   most appropriate error to propagate to\n\t\t   _unix_verify_password() is PAM_AUTHINFO_UNAVAIL; otherwise\n\t\t   return general failure */\n\t\tif (retval == PAM_USER_UNKNOWN)\n\t\t\treturn PAM_AUTHINFO_UNAVAIL;\n\t\telse\n\t\t\treturn PAM_AUTH_ERR;\n\t} else {\n\t        if (getuid() != 0) {\n#ifdef HAVE_LIBAUDIT\n\t\t\treturn _audit_log(AUDIT_USER_AUTH, user, PAM_SUCCESS);\n#else\n\t\t        return PAM_SUCCESS;\n#endif\n\t        }\n\t\treturn PAM_SUCCESS;\n\t}\n}"
  },
  {
    "function_name": "_audit_log",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_unix/unix_chkpwd.c",
    "lines": "63-88",
    "snippet": "static int _audit_log(int type, const char *uname, int rc)\n{\n\tint audit_fd;\n\n\taudit_fd = audit_open();\n\tif (audit_fd < 0) {\n\t\t/* You get these error codes only when the kernel doesn't have\n\t\t * audit compiled in. */\n\t\tif (errno == EINVAL || errno == EPROTONOSUPPORT ||\n\t\t\terrno == EAFNOSUPPORT)\n\t\t\treturn PAM_SUCCESS;\n\n\t\thelper_log_err(LOG_CRIT, \"audit_open() failed: %m\");\n\t\treturn PAM_AUTH_ERR;\n\t}\n\n\trc = audit_log_acct_message(audit_fd, type, NULL, \"PAM:unix_chkpwd\",\n\t\tuname, -1, NULL, NULL, NULL, rc == PAM_SUCCESS);\n\tif (rc == -EPERM && geteuid() != 0) {\n\t\trc = 0;\n\t}\n\n\taudit_close(audit_fd);\n\n\treturn rc < 0 ? PAM_AUTH_ERR : PAM_SUCCESS;\n}",
    "includes": [
      "#include \"pam_inline.h\"",
      "#include \"passverify.h\"",
      "#include <security/_pam_macros.h>",
      "#include <security/_pam_types.h>",
      "#include <libaudit.h>",
      "#include <errno.h>",
      "#include <time.h>",
      "#include <signal.h>",
      "#include <shadow.h>",
      "#include <pwd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "audit_close",
          "args": [
            "audit_fd"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audit_log_acct_message",
          "args": [
            "audit_fd",
            "type",
            "NULL",
            "\"PAM:unix_chkpwd\"",
            "uname",
            "-1",
            "NULL",
            "NULL",
            "NULL",
            "rc == PAM_SUCCESS"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "helper_log_err",
          "args": [
            "LOG_CRIT",
            "\"audit_open() failed: %m\""
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "helper_log_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_pwhistory/opasswd.c",
          "lines": "91-101",
          "snippet": "void\nhelper_log_err(int err, const char *format, ...)\n{\n  va_list args;\n\n  va_start(args, format);\n  openlog(HELPER_COMPILE, LOG_CONS | LOG_PID, LOG_AUTHPRIV);\n  vsyslog(err, format, args);\n  va_end(args);\n  closelog();\n}",
          "includes": [
            "#include \"opasswd.h\"",
            "#include <security/pam_modules.h>",
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <crypt.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <limits.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <time.h>",
            "#include <shadow.h>",
            "#include <pwd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"opasswd.h\"\n#include <security/pam_modules.h>\n#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <crypt.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <stdlib.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <limits.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <time.h>\n#include <shadow.h>\n#include <pwd.h>\n#include <config.h>\n\nvoid\nhelper_log_err(int err, const char *format, ...)\n{\n  va_list args;\n\n  va_start(args, format);\n  openlog(HELPER_COMPILE, LOG_CONS | LOG_PID, LOG_AUTHPRIV);\n  vsyslog(err, format, args);\n  va_end(args);\n  closelog();\n}"
        }
      },
      {
        "call_info": {
          "callee": "audit_open",
          "args": [],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pam_inline.h\"\n#include \"passverify.h\"\n#include <security/_pam_macros.h>\n#include <security/_pam_types.h>\n#include <libaudit.h>\n#include <errno.h>\n#include <time.h>\n#include <signal.h>\n#include <shadow.h>\n#include <pwd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic int _audit_log(int type, const char *uname, int rc)\n{\n\tint audit_fd;\n\n\taudit_fd = audit_open();\n\tif (audit_fd < 0) {\n\t\t/* You get these error codes only when the kernel doesn't have\n\t\t * audit compiled in. */\n\t\tif (errno == EINVAL || errno == EPROTONOSUPPORT ||\n\t\t\terrno == EAFNOSUPPORT)\n\t\t\treturn PAM_SUCCESS;\n\n\t\thelper_log_err(LOG_CRIT, \"audit_open() failed: %m\");\n\t\treturn PAM_AUTH_ERR;\n\t}\n\n\trc = audit_log_acct_message(audit_fd, type, NULL, \"PAM:unix_chkpwd\",\n\t\tuname, -1, NULL, NULL, NULL, rc == PAM_SUCCESS);\n\tif (rc == -EPERM && geteuid() != 0) {\n\t\trc = 0;\n\t}\n\n\taudit_close(audit_fd);\n\n\treturn rc < 0 ? PAM_AUTH_ERR : PAM_SUCCESS;\n}"
  },
  {
    "function_name": "_check_expiry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_unix/unix_chkpwd.c",
    "lines": "38-60",
    "snippet": "static int _check_expiry(const char *uname)\n{\n\tstruct spwd *spent;\n\tstruct passwd *pwent;\n\tint retval;\n\tint daysleft;\n\n\tretval = get_account_info(uname, &pwent, &spent);\n\tif (retval != PAM_SUCCESS) {\n\t\thelper_log_err(LOG_ERR, \"could not obtain user info (%s)\", uname);\n\t\tprintf(\"-1\\n\");\n\t\treturn retval;\n\t}\n\n\tif (spent == NULL) {\n\t\tprintf(\"-1\\n\");\n\t\treturn retval;\n\t}\n\n\tretval = check_shadow_expiry(spent, &daysleft);\n\tprintf(\"%d\\n\", daysleft);\n\treturn retval;\n}",
    "includes": [
      "#include \"pam_inline.h\"",
      "#include \"passverify.h\"",
      "#include <security/_pam_macros.h>",
      "#include <security/_pam_types.h>",
      "#include <libaudit.h>",
      "#include <errno.h>",
      "#include <time.h>",
      "#include <signal.h>",
      "#include <shadow.h>",
      "#include <pwd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%d\\n\"",
            "daysleft"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_shadow_expiry",
          "args": [
            "spent",
            "&daysleft"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"-1\\n\""
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"-1\\n\""
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "helper_log_err",
          "args": [
            "LOG_ERR",
            "\"could not obtain user info (%s)\"",
            "uname"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "helper_log_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_pwhistory/opasswd.c",
          "lines": "91-101",
          "snippet": "void\nhelper_log_err(int err, const char *format, ...)\n{\n  va_list args;\n\n  va_start(args, format);\n  openlog(HELPER_COMPILE, LOG_CONS | LOG_PID, LOG_AUTHPRIV);\n  vsyslog(err, format, args);\n  va_end(args);\n  closelog();\n}",
          "includes": [
            "#include \"opasswd.h\"",
            "#include <security/pam_modules.h>",
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <crypt.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <limits.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <time.h>",
            "#include <shadow.h>",
            "#include <pwd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"opasswd.h\"\n#include <security/pam_modules.h>\n#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <crypt.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <stdlib.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <limits.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <time.h>\n#include <shadow.h>\n#include <pwd.h>\n#include <config.h>\n\nvoid\nhelper_log_err(int err, const char *format, ...)\n{\n  va_list args;\n\n  va_start(args, format);\n  openlog(HELPER_COMPILE, LOG_CONS | LOG_PID, LOG_AUTHPRIV);\n  vsyslog(err, format, args);\n  va_end(args);\n  closelog();\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_account_info",
          "args": [
            "uname",
            "&pwent",
            "&spent"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pam_inline.h\"\n#include \"passverify.h\"\n#include <security/_pam_macros.h>\n#include <security/_pam_types.h>\n#include <libaudit.h>\n#include <errno.h>\n#include <time.h>\n#include <signal.h>\n#include <shadow.h>\n#include <pwd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic int _check_expiry(const char *uname)\n{\n\tstruct spwd *spent;\n\tstruct passwd *pwent;\n\tint retval;\n\tint daysleft;\n\n\tretval = get_account_info(uname, &pwent, &spent);\n\tif (retval != PAM_SUCCESS) {\n\t\thelper_log_err(LOG_ERR, \"could not obtain user info (%s)\", uname);\n\t\tprintf(\"-1\\n\");\n\t\treturn retval;\n\t}\n\n\tif (spent == NULL) {\n\t\tprintf(\"-1\\n\");\n\t\treturn retval;\n\t}\n\n\tretval = check_shadow_expiry(spent, &daysleft);\n\tprintf(\"%d\\n\", daysleft);\n\treturn retval;\n}"
  }
]