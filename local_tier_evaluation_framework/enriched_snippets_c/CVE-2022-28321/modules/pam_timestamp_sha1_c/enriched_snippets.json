[
  {
    "function_name": "sha1_output",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/sha1.c",
    "lines": "184-253",
    "snippet": "size_t\nsha1_output(struct sha1_context *ctx, unsigned char *out)\n{\n\tstruct sha1_context ctx2;\n\n\t/* Output the sum. */\n\tif (out != NULL) {\n\t\tuint32_t c;\n\t\tmemcpy(&ctx2, ctx, sizeof(ctx2));\n\n\t\t/* Pad this block. */\n\t\tc = ctx2.pending_count;\n\t\tmemcpy(ctx2.pending.c + c,\n\t\t       padding, SHA1_BLOCK_SIZE - c);\n\n\t\t/* Do we need to process two blocks now? */\n\t\tif (c >= (SHA1_BLOCK_SIZE - (sizeof(uint32_t) * 2))) {\n\t\t\t/* Process this block. */\n\t\t\tsha1_process(&ctx2, ctx2.pending.i);\n\t\t\t/* Set up another block. */\n\t\t\tctx2.pending_count = 0;\n\t\t\tmemset(ctx2.pending.c, 0, SHA1_BLOCK_SIZE);\n                        ctx2.pending.c[0] =\n\t\t\t\t(c == SHA1_BLOCK_SIZE) ? 0x80 : 0;\n\t\t}\n\n\t\t/* Process the final block. */\n\t\tctx2.counts[1] <<= 3;\n\t\tif (ctx2.counts[0] >> 29) {\n\t\t\tctx2.counts[1] |=\n\t\t\t(ctx2.counts[0] >> 29);\n\t\t}\n\t\tctx2.counts[0] <<= 3;\n\t\tctx2.counts[0] = htonl(ctx2.counts[0]);\n\t\tctx2.counts[1] = htonl(ctx2.counts[1]);\n\t\tmemcpy(ctx2.pending.c + 56,\n\t\t       &ctx2.counts[1], sizeof(uint32_t));\n\t\tmemcpy(ctx2.pending.c + 60,\n\t\t       &ctx2.counts[0], sizeof(uint32_t));\n\t\tsha1_process(&ctx2, ctx2.pending.i);\n\n\t\t/* Output the data. */\n\t\tout[ 3] = (ctx2.a >>  0) & 0xff;\n\t\tout[ 2] = (ctx2.a >>  8) & 0xff;\n\t\tout[ 1] = (ctx2.a >> 16) & 0xff;\n\t\tout[ 0] = (ctx2.a >> 24) & 0xff;\n\n\t\tout[ 7] = (ctx2.b >>  0) & 0xff;\n\t\tout[ 6] = (ctx2.b >>  8) & 0xff;\n\t\tout[ 5] = (ctx2.b >> 16) & 0xff;\n\t\tout[ 4] = (ctx2.b >> 24) & 0xff;\n\n\t\tout[11] = (ctx2.c >>  0) & 0xff;\n\t\tout[10] = (ctx2.c >>  8) & 0xff;\n\t\tout[ 9] = (ctx2.c >> 16) & 0xff;\n\t\tout[ 8] = (ctx2.c >> 24) & 0xff;\n\n\t\tout[15] = (ctx2.d >>  0) & 0xff;\n\t\tout[14] = (ctx2.d >>  8) & 0xff;\n\t\tout[13] = (ctx2.d >> 16) & 0xff;\n\t\tout[12] = (ctx2.d >> 24) & 0xff;\n\n\t\tout[19] = (ctx2.e >>  0) & 0xff;\n\t\tout[18] = (ctx2.e >>  8) & 0xff;\n\t\tout[17] = (ctx2.e >> 16) & 0xff;\n\t\tout[16] = (ctx2.e >> 24) & 0xff;\n\t}\n\n\treturn SHA1_OUTPUT_SIZE;\n}",
    "includes": [
      "#include \"sha1.h\"",
      "#include <unistd.h>",
      "#include <endian.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <netinet/in.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned char\npadding[SHA1_BLOCK_SIZE] = {\n\t0x80, 0, 0, 0, 0, 0, 0, 0,     0, 0, 0, 0, 0, 0, 0, 0,\n\t   0, 0, 0, 0, 0, 0, 0, 0,     0, 0, 0, 0, 0, 0, 0, 0,\n\t   0, 0, 0, 0, 0, 0, 0, 0,     0, 0, 0, 0, 0, 0, 0, 0,\n\t   0, 0, 0, 0, 0, 0, 0, 0,     0, 0, 0, 0, 0, 0, 0, 0,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sha1_process",
          "args": [
            "&ctx2",
            "ctx2.pending.i"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "sha1_process",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/sha1.c",
          "lines": "102-147",
          "snippet": "static void\nsha1_process(struct sha1_context *ctx, uint32_t buffer[SHA1_BLOCK_SIZE / 4])\n{\n\tuint32_t a, b, c, d, e, temp;\n\tuint32_t data[80];\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tdata[i] = htonl(buffer[i]);\n\t}\n\tfor (i = 16; i < 80; i++) {\n\t\tdata[i] = RL(data[i - 3] ^ data[i - 8] ^ data[i - 14] ^ data[i - 16], 1);\n\t}\n\n\ta = ctx->a;\n\tb = ctx->b;\n\tc = ctx->c;\n\td = ctx->d;\n\te = ctx->e;\n\n\tfor (i =  0; i < 20; i++) {\n\t\ttemp = sha1_round(F, a, b, c, d, e, data[i], 0x5a827999);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\tfor (i = 20; i < 40; i++) {\n\t\ttemp = sha1_round(G, a, b, c, d, e, data[i], 0x6ed9eba1);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\tfor (i = 40; i < 60; i++) {\n\t\ttemp = sha1_round(H, a, b, c, d, e, data[i], 0x8f1bbcdc);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\tfor (i = 60; i < 80; i++) {\n\t\ttemp = sha1_round(G, a, b, c, d, e, data[i], 0xca62c1d6);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\n\tctx->a += a;\n\tctx->b += b;\n\tctx->c += c;\n\tctx->d += d;\n\tctx->e += e;\n\n\tmemset(buffer, 0, sizeof(buffer[0]) * SHA1_BLOCK_SIZE / 4);\n\tmemset(data, 0, sizeof(data));\n}",
          "includes": [
            "#include \"sha1.h\"",
            "#include <unistd.h>",
            "#include <endian.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <netinet/in.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sha1.h\"\n#include <unistd.h>\n#include <endian.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <netinet/in.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nstatic void\nsha1_process(struct sha1_context *ctx, uint32_t buffer[SHA1_BLOCK_SIZE / 4])\n{\n\tuint32_t a, b, c, d, e, temp;\n\tuint32_t data[80];\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tdata[i] = htonl(buffer[i]);\n\t}\n\tfor (i = 16; i < 80; i++) {\n\t\tdata[i] = RL(data[i - 3] ^ data[i - 8] ^ data[i - 14] ^ data[i - 16], 1);\n\t}\n\n\ta = ctx->a;\n\tb = ctx->b;\n\tc = ctx->c;\n\td = ctx->d;\n\te = ctx->e;\n\n\tfor (i =  0; i < 20; i++) {\n\t\ttemp = sha1_round(F, a, b, c, d, e, data[i], 0x5a827999);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\tfor (i = 20; i < 40; i++) {\n\t\ttemp = sha1_round(G, a, b, c, d, e, data[i], 0x6ed9eba1);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\tfor (i = 40; i < 60; i++) {\n\t\ttemp = sha1_round(H, a, b, c, d, e, data[i], 0x8f1bbcdc);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\tfor (i = 60; i < 80; i++) {\n\t\ttemp = sha1_round(G, a, b, c, d, e, data[i], 0xca62c1d6);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\n\tctx->a += a;\n\tctx->b += b;\n\tctx->c += c;\n\tctx->d += d;\n\tctx->e += e;\n\n\tmemset(buffer, 0, sizeof(buffer[0]) * SHA1_BLOCK_SIZE / 4);\n\tmemset(data, 0, sizeof(data));\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ctx2.pending.c + 60",
            "&ctx2.counts[0]",
            "sizeof(uint32_t)"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ctx2.pending.c + 56",
            "&ctx2.counts[1]",
            "sizeof(uint32_t)"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "ctx2.counts[1]"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "ctx2.counts[0]"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "ctx2.pending.c",
            "0",
            "SHA1_BLOCK_SIZE"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ctx2.pending.c + c",
            "padding",
            "SHA1_BLOCK_SIZE - c"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&ctx2",
            "ctx",
            "sizeof(ctx2)"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sha1.h\"\n#include <unistd.h>\n#include <endian.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <netinet/in.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nstatic unsigned char\npadding[SHA1_BLOCK_SIZE] = {\n\t0x80, 0, 0, 0, 0, 0, 0, 0,     0, 0, 0, 0, 0, 0, 0, 0,\n\t   0, 0, 0, 0, 0, 0, 0, 0,     0, 0, 0, 0, 0, 0, 0, 0,\n\t   0, 0, 0, 0, 0, 0, 0, 0,     0, 0, 0, 0, 0, 0, 0, 0,\n\t   0, 0, 0, 0, 0, 0, 0, 0,     0, 0, 0, 0, 0, 0, 0, 0,\n};\n\nsize_t\nsha1_output(struct sha1_context *ctx, unsigned char *out)\n{\n\tstruct sha1_context ctx2;\n\n\t/* Output the sum. */\n\tif (out != NULL) {\n\t\tuint32_t c;\n\t\tmemcpy(&ctx2, ctx, sizeof(ctx2));\n\n\t\t/* Pad this block. */\n\t\tc = ctx2.pending_count;\n\t\tmemcpy(ctx2.pending.c + c,\n\t\t       padding, SHA1_BLOCK_SIZE - c);\n\n\t\t/* Do we need to process two blocks now? */\n\t\tif (c >= (SHA1_BLOCK_SIZE - (sizeof(uint32_t) * 2))) {\n\t\t\t/* Process this block. */\n\t\t\tsha1_process(&ctx2, ctx2.pending.i);\n\t\t\t/* Set up another block. */\n\t\t\tctx2.pending_count = 0;\n\t\t\tmemset(ctx2.pending.c, 0, SHA1_BLOCK_SIZE);\n                        ctx2.pending.c[0] =\n\t\t\t\t(c == SHA1_BLOCK_SIZE) ? 0x80 : 0;\n\t\t}\n\n\t\t/* Process the final block. */\n\t\tctx2.counts[1] <<= 3;\n\t\tif (ctx2.counts[0] >> 29) {\n\t\t\tctx2.counts[1] |=\n\t\t\t(ctx2.counts[0] >> 29);\n\t\t}\n\t\tctx2.counts[0] <<= 3;\n\t\tctx2.counts[0] = htonl(ctx2.counts[0]);\n\t\tctx2.counts[1] = htonl(ctx2.counts[1]);\n\t\tmemcpy(ctx2.pending.c + 56,\n\t\t       &ctx2.counts[1], sizeof(uint32_t));\n\t\tmemcpy(ctx2.pending.c + 60,\n\t\t       &ctx2.counts[0], sizeof(uint32_t));\n\t\tsha1_process(&ctx2, ctx2.pending.i);\n\n\t\t/* Output the data. */\n\t\tout[ 3] = (ctx2.a >>  0) & 0xff;\n\t\tout[ 2] = (ctx2.a >>  8) & 0xff;\n\t\tout[ 1] = (ctx2.a >> 16) & 0xff;\n\t\tout[ 0] = (ctx2.a >> 24) & 0xff;\n\n\t\tout[ 7] = (ctx2.b >>  0) & 0xff;\n\t\tout[ 6] = (ctx2.b >>  8) & 0xff;\n\t\tout[ 5] = (ctx2.b >> 16) & 0xff;\n\t\tout[ 4] = (ctx2.b >> 24) & 0xff;\n\n\t\tout[11] = (ctx2.c >>  0) & 0xff;\n\t\tout[10] = (ctx2.c >>  8) & 0xff;\n\t\tout[ 9] = (ctx2.c >> 16) & 0xff;\n\t\tout[ 8] = (ctx2.c >> 24) & 0xff;\n\n\t\tout[15] = (ctx2.d >>  0) & 0xff;\n\t\tout[14] = (ctx2.d >>  8) & 0xff;\n\t\tout[13] = (ctx2.d >> 16) & 0xff;\n\t\tout[12] = (ctx2.d >> 24) & 0xff;\n\n\t\tout[19] = (ctx2.e >>  0) & 0xff;\n\t\tout[18] = (ctx2.e >>  8) & 0xff;\n\t\tout[17] = (ctx2.e >> 16) & 0xff;\n\t\tout[16] = (ctx2.e >> 24) & 0xff;\n\t}\n\n\treturn SHA1_OUTPUT_SIZE;\n}"
  },
  {
    "function_name": "sha1_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/sha1.c",
    "lines": "149-182",
    "snippet": "void\nsha1_update(struct sha1_context *ctx, const unsigned char *data, size_t length)\n{\n\tsize_t i = 0, l = length, c, t;\n\tuint32_t count = 0;\n\n\t/* Process any pending + data blocks. */\n\twhile (l + ctx->pending_count >= SHA1_BLOCK_SIZE) {\n\t\tc = ctx->pending_count;\n\t\tt = SHA1_BLOCK_SIZE - c;\n\t\tmemcpy(ctx->pending.c + c, &data[i], t);\n\t\tsha1_process(ctx, ctx->pending.i);\n\t\ti += t;\n\t\tl -= t;\n\t\tctx->pending_count = 0;\n\t}\n\n\t/* Save what's left of the data block as a pending data block. */\n\tc = ctx->pending_count;\n\tmemcpy(ctx->pending.c + c, &data[i], l);\n\tctx->pending_count += l;\n\n\t/* Update the message length. */\n\tctx->count += length;\n\n\t/* Update our internal counts. */\n\tif (length != 0) {\n\t\tcount = ctx->counts[0];\n\t\tctx->counts[0] += length;\n\t\tif (count >= ctx->counts[0]) {\n\t\t\tctx->counts[1]++;\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"sha1.h\"",
      "#include <unistd.h>",
      "#include <endian.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <netinet/in.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ctx->pending.c + c",
            "&data[i]",
            "l"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sha1_process",
          "args": [
            "ctx",
            "ctx->pending.i"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "sha1_process",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/sha1.c",
          "lines": "102-147",
          "snippet": "static void\nsha1_process(struct sha1_context *ctx, uint32_t buffer[SHA1_BLOCK_SIZE / 4])\n{\n\tuint32_t a, b, c, d, e, temp;\n\tuint32_t data[80];\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tdata[i] = htonl(buffer[i]);\n\t}\n\tfor (i = 16; i < 80; i++) {\n\t\tdata[i] = RL(data[i - 3] ^ data[i - 8] ^ data[i - 14] ^ data[i - 16], 1);\n\t}\n\n\ta = ctx->a;\n\tb = ctx->b;\n\tc = ctx->c;\n\td = ctx->d;\n\te = ctx->e;\n\n\tfor (i =  0; i < 20; i++) {\n\t\ttemp = sha1_round(F, a, b, c, d, e, data[i], 0x5a827999);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\tfor (i = 20; i < 40; i++) {\n\t\ttemp = sha1_round(G, a, b, c, d, e, data[i], 0x6ed9eba1);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\tfor (i = 40; i < 60; i++) {\n\t\ttemp = sha1_round(H, a, b, c, d, e, data[i], 0x8f1bbcdc);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\tfor (i = 60; i < 80; i++) {\n\t\ttemp = sha1_round(G, a, b, c, d, e, data[i], 0xca62c1d6);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\n\tctx->a += a;\n\tctx->b += b;\n\tctx->c += c;\n\tctx->d += d;\n\tctx->e += e;\n\n\tmemset(buffer, 0, sizeof(buffer[0]) * SHA1_BLOCK_SIZE / 4);\n\tmemset(data, 0, sizeof(data));\n}",
          "includes": [
            "#include \"sha1.h\"",
            "#include <unistd.h>",
            "#include <endian.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <netinet/in.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sha1.h\"\n#include <unistd.h>\n#include <endian.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <netinet/in.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nstatic void\nsha1_process(struct sha1_context *ctx, uint32_t buffer[SHA1_BLOCK_SIZE / 4])\n{\n\tuint32_t a, b, c, d, e, temp;\n\tuint32_t data[80];\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tdata[i] = htonl(buffer[i]);\n\t}\n\tfor (i = 16; i < 80; i++) {\n\t\tdata[i] = RL(data[i - 3] ^ data[i - 8] ^ data[i - 14] ^ data[i - 16], 1);\n\t}\n\n\ta = ctx->a;\n\tb = ctx->b;\n\tc = ctx->c;\n\td = ctx->d;\n\te = ctx->e;\n\n\tfor (i =  0; i < 20; i++) {\n\t\ttemp = sha1_round(F, a, b, c, d, e, data[i], 0x5a827999);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\tfor (i = 20; i < 40; i++) {\n\t\ttemp = sha1_round(G, a, b, c, d, e, data[i], 0x6ed9eba1);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\tfor (i = 40; i < 60; i++) {\n\t\ttemp = sha1_round(H, a, b, c, d, e, data[i], 0x8f1bbcdc);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\tfor (i = 60; i < 80; i++) {\n\t\ttemp = sha1_round(G, a, b, c, d, e, data[i], 0xca62c1d6);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\n\tctx->a += a;\n\tctx->b += b;\n\tctx->c += c;\n\tctx->d += d;\n\tctx->e += e;\n\n\tmemset(buffer, 0, sizeof(buffer[0]) * SHA1_BLOCK_SIZE / 4);\n\tmemset(data, 0, sizeof(data));\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ctx->pending.c + c",
            "&data[i]",
            "t"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sha1.h\"\n#include <unistd.h>\n#include <endian.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <netinet/in.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nvoid\nsha1_update(struct sha1_context *ctx, const unsigned char *data, size_t length)\n{\n\tsize_t i = 0, l = length, c, t;\n\tuint32_t count = 0;\n\n\t/* Process any pending + data blocks. */\n\twhile (l + ctx->pending_count >= SHA1_BLOCK_SIZE) {\n\t\tc = ctx->pending_count;\n\t\tt = SHA1_BLOCK_SIZE - c;\n\t\tmemcpy(ctx->pending.c + c, &data[i], t);\n\t\tsha1_process(ctx, ctx->pending.i);\n\t\ti += t;\n\t\tl -= t;\n\t\tctx->pending_count = 0;\n\t}\n\n\t/* Save what's left of the data block as a pending data block. */\n\tc = ctx->pending_count;\n\tmemcpy(ctx->pending.c + c, &data[i], l);\n\tctx->pending_count += l;\n\n\t/* Update the message length. */\n\tctx->count += length;\n\n\t/* Update our internal counts. */\n\tif (length != 0) {\n\t\tcount = ctx->counts[0];\n\t\tctx->counts[0] += length;\n\t\tif (count >= ctx->counts[0]) {\n\t\t\tctx->counts[1]++;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "sha1_process",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/sha1.c",
    "lines": "102-147",
    "snippet": "static void\nsha1_process(struct sha1_context *ctx, uint32_t buffer[SHA1_BLOCK_SIZE / 4])\n{\n\tuint32_t a, b, c, d, e, temp;\n\tuint32_t data[80];\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tdata[i] = htonl(buffer[i]);\n\t}\n\tfor (i = 16; i < 80; i++) {\n\t\tdata[i] = RL(data[i - 3] ^ data[i - 8] ^ data[i - 14] ^ data[i - 16], 1);\n\t}\n\n\ta = ctx->a;\n\tb = ctx->b;\n\tc = ctx->c;\n\td = ctx->d;\n\te = ctx->e;\n\n\tfor (i =  0; i < 20; i++) {\n\t\ttemp = sha1_round(F, a, b, c, d, e, data[i], 0x5a827999);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\tfor (i = 20; i < 40; i++) {\n\t\ttemp = sha1_round(G, a, b, c, d, e, data[i], 0x6ed9eba1);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\tfor (i = 40; i < 60; i++) {\n\t\ttemp = sha1_round(H, a, b, c, d, e, data[i], 0x8f1bbcdc);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\tfor (i = 60; i < 80; i++) {\n\t\ttemp = sha1_round(G, a, b, c, d, e, data[i], 0xca62c1d6);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\n\tctx->a += a;\n\tctx->b += b;\n\tctx->c += c;\n\tctx->d += d;\n\tctx->e += e;\n\n\tmemset(buffer, 0, sizeof(buffer[0]) * SHA1_BLOCK_SIZE / 4);\n\tmemset(data, 0, sizeof(data));\n}",
    "includes": [
      "#include \"sha1.h\"",
      "#include <unistd.h>",
      "#include <endian.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <netinet/in.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "data",
            "0",
            "sizeof(data)"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "buffer",
            "0",
            "sizeof(buffer[0]) * SHA1_BLOCK_SIZE / 4"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RL",
          "args": [
            "b",
            "30"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "RL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/sha1.c",
          "lines": "77-81",
          "snippet": "static uint32_t\nRL(uint32_t n, uint32_t s)\n{\n\treturn (n << s) | (n >> (32 - s));\n}",
          "includes": [
            "#include \"sha1.h\"",
            "#include <unistd.h>",
            "#include <endian.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <netinet/in.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sha1.h\"\n#include <unistd.h>\n#include <endian.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <netinet/in.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nstatic uint32_t\nRL(uint32_t n, uint32_t s)\n{\n\treturn (n << s) | (n >> (32 - s));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sha1_round",
          "args": [
            "G",
            "a",
            "b",
            "c",
            "d",
            "e",
            "data[i]",
            "0xca62c1d6"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "sha1_round",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/sha1.c",
          "lines": "83-89",
          "snippet": "static uint32_t\nsha1_round(uint32_t (*FUNC)(uint32_t, uint32_t, uint32_t),\n      uint32_t a, uint32_t b, uint32_t c, uint32_t d, uint32_t e,\n      uint32_t i, uint32_t n)\n{\n\treturn RL(a, 5) + FUNC(b, c, d) + e + i + n;\n}",
          "includes": [
            "#include \"sha1.h\"",
            "#include <unistd.h>",
            "#include <endian.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <netinet/in.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sha1.h\"\n#include <unistd.h>\n#include <endian.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <netinet/in.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nstatic uint32_t\nsha1_round(uint32_t (*FUNC)(uint32_t, uint32_t, uint32_t),\n      uint32_t a, uint32_t b, uint32_t c, uint32_t d, uint32_t e,\n      uint32_t i, uint32_t n)\n{\n\treturn RL(a, 5) + FUNC(b, c, d) + e + i + n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "buffer[i]"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sha1.h\"\n#include <unistd.h>\n#include <endian.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <netinet/in.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nstatic void\nsha1_process(struct sha1_context *ctx, uint32_t buffer[SHA1_BLOCK_SIZE / 4])\n{\n\tuint32_t a, b, c, d, e, temp;\n\tuint32_t data[80];\n\tint i;\n\n\tfor (i = 0; i < 16; i++) {\n\t\tdata[i] = htonl(buffer[i]);\n\t}\n\tfor (i = 16; i < 80; i++) {\n\t\tdata[i] = RL(data[i - 3] ^ data[i - 8] ^ data[i - 14] ^ data[i - 16], 1);\n\t}\n\n\ta = ctx->a;\n\tb = ctx->b;\n\tc = ctx->c;\n\td = ctx->d;\n\te = ctx->e;\n\n\tfor (i =  0; i < 20; i++) {\n\t\ttemp = sha1_round(F, a, b, c, d, e, data[i], 0x5a827999);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\tfor (i = 20; i < 40; i++) {\n\t\ttemp = sha1_round(G, a, b, c, d, e, data[i], 0x6ed9eba1);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\tfor (i = 40; i < 60; i++) {\n\t\ttemp = sha1_round(H, a, b, c, d, e, data[i], 0x8f1bbcdc);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\tfor (i = 60; i < 80; i++) {\n\t\ttemp = sha1_round(G, a, b, c, d, e, data[i], 0xca62c1d6);\n\t\te = d; d = c; c = RL(b, 30); b = a; a = temp;\n\t}\n\n\tctx->a += a;\n\tctx->b += b;\n\tctx->c += c;\n\tctx->d += d;\n\tctx->e += e;\n\n\tmemset(buffer, 0, sizeof(buffer[0]) * SHA1_BLOCK_SIZE / 4);\n\tmemset(data, 0, sizeof(data));\n}"
  },
  {
    "function_name": "sha1_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/sha1.c",
    "lines": "91-100",
    "snippet": "void\nsha1_init(struct sha1_context *ctx)\n{\n\tmemset(ctx, 0, sizeof(*ctx));\n\tctx->a = 0x67452301;\n\tctx->b = 0xefcdab89;\n\tctx->c = 0x98badcfe;\n\tctx->d = 0x10325476;\n\tctx->e = 0xc3d2e1f0;\n}",
    "includes": [
      "#include \"sha1.h\"",
      "#include <unistd.h>",
      "#include <endian.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <netinet/in.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "ctx",
            "0",
            "sizeof(*ctx)"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sha1.h\"\n#include <unistd.h>\n#include <endian.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <netinet/in.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nvoid\nsha1_init(struct sha1_context *ctx)\n{\n\tmemset(ctx, 0, sizeof(*ctx));\n\tctx->a = 0x67452301;\n\tctx->b = 0xefcdab89;\n\tctx->c = 0x98badcfe;\n\tctx->d = 0x10325476;\n\tctx->e = 0xc3d2e1f0;\n}"
  },
  {
    "function_name": "sha1_round",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/sha1.c",
    "lines": "83-89",
    "snippet": "static uint32_t\nsha1_round(uint32_t (*FUNC)(uint32_t, uint32_t, uint32_t),\n      uint32_t a, uint32_t b, uint32_t c, uint32_t d, uint32_t e,\n      uint32_t i, uint32_t n)\n{\n\treturn RL(a, 5) + FUNC(b, c, d) + e + i + n;\n}",
    "includes": [
      "#include \"sha1.h\"",
      "#include <unistd.h>",
      "#include <endian.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <netinet/in.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FUNC",
          "args": [
            "b",
            "c",
            "d"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RL",
          "args": [
            "a",
            "5"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "RL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/sha1.c",
          "lines": "77-81",
          "snippet": "static uint32_t\nRL(uint32_t n, uint32_t s)\n{\n\treturn (n << s) | (n >> (32 - s));\n}",
          "includes": [
            "#include \"sha1.h\"",
            "#include <unistd.h>",
            "#include <endian.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <netinet/in.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sha1.h\"\n#include <unistd.h>\n#include <endian.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <netinet/in.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nstatic uint32_t\nRL(uint32_t n, uint32_t s)\n{\n\treturn (n << s) | (n >> (32 - s));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sha1.h\"\n#include <unistd.h>\n#include <endian.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <netinet/in.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nstatic uint32_t\nsha1_round(uint32_t (*FUNC)(uint32_t, uint32_t, uint32_t),\n      uint32_t a, uint32_t b, uint32_t c, uint32_t d, uint32_t e,\n      uint32_t i, uint32_t n)\n{\n\treturn RL(a, 5) + FUNC(b, c, d) + e + i + n;\n}"
  },
  {
    "function_name": "RL",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/sha1.c",
    "lines": "77-81",
    "snippet": "static uint32_t\nRL(uint32_t n, uint32_t s)\n{\n\treturn (n << s) | (n >> (32 - s));\n}",
    "includes": [
      "#include \"sha1.h\"",
      "#include <unistd.h>",
      "#include <endian.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <netinet/in.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sha1.h\"\n#include <unistd.h>\n#include <endian.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <netinet/in.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nstatic uint32_t\nRL(uint32_t n, uint32_t s)\n{\n\treturn (n << s) | (n >> (32 - s));\n}"
  },
  {
    "function_name": "H",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/sha1.c",
    "lines": "71-75",
    "snippet": "static uint32_t\nH(uint32_t b, uint32_t c, uint32_t d)\n{\n\treturn (b & c) | (b & d) | (c & d);\n}",
    "includes": [
      "#include \"sha1.h\"",
      "#include <unistd.h>",
      "#include <endian.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <netinet/in.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sha1.h\"\n#include <unistd.h>\n#include <endian.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <netinet/in.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nstatic uint32_t\nH(uint32_t b, uint32_t c, uint32_t d)\n{\n\treturn (b & c) | (b & d) | (c & d);\n}"
  },
  {
    "function_name": "G",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/sha1.c",
    "lines": "65-69",
    "snippet": "static uint32_t\nG(uint32_t b, uint32_t c, uint32_t d)\n{\n\treturn b ^ c ^ d;\n}",
    "includes": [
      "#include \"sha1.h\"",
      "#include <unistd.h>",
      "#include <endian.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <netinet/in.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sha1.h\"\n#include <unistd.h>\n#include <endian.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <netinet/in.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nstatic uint32_t\nG(uint32_t b, uint32_t c, uint32_t d)\n{\n\treturn b ^ c ^ d;\n}"
  },
  {
    "function_name": "F",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/sha1.c",
    "lines": "59-63",
    "snippet": "static uint32_t\nF(uint32_t b, uint32_t c, uint32_t d)\n{\n\treturn (b & c) | ((~b) & d);\n}",
    "includes": [
      "#include \"sha1.h\"",
      "#include <unistd.h>",
      "#include <endian.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <netinet/in.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sha1.h\"\n#include <unistd.h>\n#include <endian.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <netinet/in.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nstatic uint32_t\nF(uint32_t b, uint32_t c, uint32_t d)\n{\n\treturn (b & c) | ((~b) & d);\n}"
  }
]