[
  {
    "function_name": "pam_sm_chauthtok",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "614-618",
    "snippet": "int\npam_sm_chauthtok(pam_handle_t *pamh, int flags, int argc, const char **argv)\n{\n\treturn pam_sm_authenticate(pamh, flags, argc, argv);\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pam_sm_authenticate",
          "args": [
            "pamh",
            "flags",
            "argc",
            "argv"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "pam_sm_authenticate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "456-587",
          "snippet": "int\npam_sm_authenticate (pam_handle_t *pamh, int flags UNUSED,\n\t\t     int argc, const char **argv)\n{\n\tconst char *user;\n\tstruct passwd *pwd = NULL;\n\tint ret, i, count, use_uid, debug;\n\tconst char *left, *right, *qual;\n\tint quiet_fail, quiet_succ, audit;\n\n\tquiet_fail = 0;\n\tquiet_succ = 0;\n\taudit = 0;\n\tfor (use_uid = 0, debug = 0, i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tdebug++;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tuse_uid++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tquiet_fail++;\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tquiet_fail++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\taudit++;\n\t\t}\n\t}\n\n\tif (use_uid) {\n\t\t/* Get information about the user. */\n\t\tpwd = pam_modutil_getpwuid(pamh, getuid());\n\t\tif (pwd == NULL) {\n\t\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\t   \"error retrieving information about user %lu\",\n\t\t\t\t   (unsigned long)getuid());\n\t\t\treturn PAM_USER_UNKNOWN;\n\t\t}\n\t\tuser = pwd->pw_name;\n\t} else {\n\t\t/* Get the user's name. */\n\t\tret = pam_get_user(pamh, &user, NULL);\n\t\tif (ret != PAM_SUCCESS) {\n\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t   \"cannot determine user name: %s\",\n\t\t\t\t   pam_strerror(pamh, ret));\n\t\t\treturn ret;\n\t\t}\n\n\t\t/* Postpone requesting password data until it is needed */\n\t}\n\n\t/* Walk the argument list. */\n\tcount = 0;\n\tleft = qual = right = NULL;\n\tfor (i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (left == NULL) {\n\t\t\tleft = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (qual == NULL) {\n\t\t\tqual = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (right == NULL) {\n\t\t\tright = argv[i];\n\t\t\tif (right == NULL)\n\t\t\t\tcontinue;\n\n\t\t\tcount++;\n\t\t\tret = evaluate(pamh, debug,\n\t\t\t\t       left, qual, right,\n\t\t\t\t       &pwd, user);\n\t\t\tif (ret == PAM_USER_UNKNOWN && audit)\n\t\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t\t   \"error retrieving information about user %s\",\n\t\t\t\t\t   user);\n\t\t\tif (ret != PAM_SUCCESS) {\n\t\t\t\tif(!quiet_fail && ret != PAM_USER_UNKNOWN)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"not met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\t\tleft = qual = right = NULL;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse\n\t\t\t\tif(!quiet_succ)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"was met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\tleft = qual = right = NULL;\n\t\t\tcontinue;\n\t\t}\n\t}\n\n\tif (left || qual || right) {\n\t\tret = PAM_SERVICE_ERR;\n\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\"incomplete condition detected\");\n\t} else if (count == 0) {\n\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\"no condition detected; module succeeded\");\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nint\npam_sm_authenticate (pam_handle_t *pamh, int flags UNUSED,\n\t\t     int argc, const char **argv)\n{\n\tconst char *user;\n\tstruct passwd *pwd = NULL;\n\tint ret, i, count, use_uid, debug;\n\tconst char *left, *right, *qual;\n\tint quiet_fail, quiet_succ, audit;\n\n\tquiet_fail = 0;\n\tquiet_succ = 0;\n\taudit = 0;\n\tfor (use_uid = 0, debug = 0, i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tdebug++;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tuse_uid++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tquiet_fail++;\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tquiet_fail++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\taudit++;\n\t\t}\n\t}\n\n\tif (use_uid) {\n\t\t/* Get information about the user. */\n\t\tpwd = pam_modutil_getpwuid(pamh, getuid());\n\t\tif (pwd == NULL) {\n\t\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\t   \"error retrieving information about user %lu\",\n\t\t\t\t   (unsigned long)getuid());\n\t\t\treturn PAM_USER_UNKNOWN;\n\t\t}\n\t\tuser = pwd->pw_name;\n\t} else {\n\t\t/* Get the user's name. */\n\t\tret = pam_get_user(pamh, &user, NULL);\n\t\tif (ret != PAM_SUCCESS) {\n\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t   \"cannot determine user name: %s\",\n\t\t\t\t   pam_strerror(pamh, ret));\n\t\t\treturn ret;\n\t\t}\n\n\t\t/* Postpone requesting password data until it is needed */\n\t}\n\n\t/* Walk the argument list. */\n\tcount = 0;\n\tleft = qual = right = NULL;\n\tfor (i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (left == NULL) {\n\t\t\tleft = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (qual == NULL) {\n\t\t\tqual = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (right == NULL) {\n\t\t\tright = argv[i];\n\t\t\tif (right == NULL)\n\t\t\t\tcontinue;\n\n\t\t\tcount++;\n\t\t\tret = evaluate(pamh, debug,\n\t\t\t\t       left, qual, right,\n\t\t\t\t       &pwd, user);\n\t\t\tif (ret == PAM_USER_UNKNOWN && audit)\n\t\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t\t   \"error retrieving information about user %s\",\n\t\t\t\t\t   user);\n\t\t\tif (ret != PAM_SUCCESS) {\n\t\t\t\tif(!quiet_fail && ret != PAM_USER_UNKNOWN)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"not met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\t\tleft = qual = right = NULL;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse\n\t\t\t\tif(!quiet_succ)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"was met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\tleft = qual = right = NULL;\n\t\t\tcontinue;\n\t\t}\n\t}\n\n\tif (left || qual || right) {\n\t\tret = PAM_SERVICE_ERR;\n\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\"incomplete condition detected\");\n\t} else if (count == 0) {\n\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\"no condition detected; module succeeded\");\n\t}\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nint\npam_sm_chauthtok(pam_handle_t *pamh, int flags, int argc, const char **argv)\n{\n\treturn pam_sm_authenticate(pamh, flags, argc, argv);\n}"
  },
  {
    "function_name": "pam_sm_close_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "608-612",
    "snippet": "int\npam_sm_close_session(pam_handle_t *pamh, int flags, int argc, const char **argv)\n{\n\treturn pam_sm_authenticate(pamh, flags, argc, argv);\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pam_sm_authenticate",
          "args": [
            "pamh",
            "flags",
            "argc",
            "argv"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "pam_sm_authenticate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "456-587",
          "snippet": "int\npam_sm_authenticate (pam_handle_t *pamh, int flags UNUSED,\n\t\t     int argc, const char **argv)\n{\n\tconst char *user;\n\tstruct passwd *pwd = NULL;\n\tint ret, i, count, use_uid, debug;\n\tconst char *left, *right, *qual;\n\tint quiet_fail, quiet_succ, audit;\n\n\tquiet_fail = 0;\n\tquiet_succ = 0;\n\taudit = 0;\n\tfor (use_uid = 0, debug = 0, i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tdebug++;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tuse_uid++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tquiet_fail++;\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tquiet_fail++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\taudit++;\n\t\t}\n\t}\n\n\tif (use_uid) {\n\t\t/* Get information about the user. */\n\t\tpwd = pam_modutil_getpwuid(pamh, getuid());\n\t\tif (pwd == NULL) {\n\t\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\t   \"error retrieving information about user %lu\",\n\t\t\t\t   (unsigned long)getuid());\n\t\t\treturn PAM_USER_UNKNOWN;\n\t\t}\n\t\tuser = pwd->pw_name;\n\t} else {\n\t\t/* Get the user's name. */\n\t\tret = pam_get_user(pamh, &user, NULL);\n\t\tif (ret != PAM_SUCCESS) {\n\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t   \"cannot determine user name: %s\",\n\t\t\t\t   pam_strerror(pamh, ret));\n\t\t\treturn ret;\n\t\t}\n\n\t\t/* Postpone requesting password data until it is needed */\n\t}\n\n\t/* Walk the argument list. */\n\tcount = 0;\n\tleft = qual = right = NULL;\n\tfor (i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (left == NULL) {\n\t\t\tleft = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (qual == NULL) {\n\t\t\tqual = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (right == NULL) {\n\t\t\tright = argv[i];\n\t\t\tif (right == NULL)\n\t\t\t\tcontinue;\n\n\t\t\tcount++;\n\t\t\tret = evaluate(pamh, debug,\n\t\t\t\t       left, qual, right,\n\t\t\t\t       &pwd, user);\n\t\t\tif (ret == PAM_USER_UNKNOWN && audit)\n\t\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t\t   \"error retrieving information about user %s\",\n\t\t\t\t\t   user);\n\t\t\tif (ret != PAM_SUCCESS) {\n\t\t\t\tif(!quiet_fail && ret != PAM_USER_UNKNOWN)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"not met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\t\tleft = qual = right = NULL;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse\n\t\t\t\tif(!quiet_succ)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"was met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\tleft = qual = right = NULL;\n\t\t\tcontinue;\n\t\t}\n\t}\n\n\tif (left || qual || right) {\n\t\tret = PAM_SERVICE_ERR;\n\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\"incomplete condition detected\");\n\t} else if (count == 0) {\n\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\"no condition detected; module succeeded\");\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nint\npam_sm_authenticate (pam_handle_t *pamh, int flags UNUSED,\n\t\t     int argc, const char **argv)\n{\n\tconst char *user;\n\tstruct passwd *pwd = NULL;\n\tint ret, i, count, use_uid, debug;\n\tconst char *left, *right, *qual;\n\tint quiet_fail, quiet_succ, audit;\n\n\tquiet_fail = 0;\n\tquiet_succ = 0;\n\taudit = 0;\n\tfor (use_uid = 0, debug = 0, i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tdebug++;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tuse_uid++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tquiet_fail++;\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tquiet_fail++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\taudit++;\n\t\t}\n\t}\n\n\tif (use_uid) {\n\t\t/* Get information about the user. */\n\t\tpwd = pam_modutil_getpwuid(pamh, getuid());\n\t\tif (pwd == NULL) {\n\t\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\t   \"error retrieving information about user %lu\",\n\t\t\t\t   (unsigned long)getuid());\n\t\t\treturn PAM_USER_UNKNOWN;\n\t\t}\n\t\tuser = pwd->pw_name;\n\t} else {\n\t\t/* Get the user's name. */\n\t\tret = pam_get_user(pamh, &user, NULL);\n\t\tif (ret != PAM_SUCCESS) {\n\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t   \"cannot determine user name: %s\",\n\t\t\t\t   pam_strerror(pamh, ret));\n\t\t\treturn ret;\n\t\t}\n\n\t\t/* Postpone requesting password data until it is needed */\n\t}\n\n\t/* Walk the argument list. */\n\tcount = 0;\n\tleft = qual = right = NULL;\n\tfor (i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (left == NULL) {\n\t\t\tleft = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (qual == NULL) {\n\t\t\tqual = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (right == NULL) {\n\t\t\tright = argv[i];\n\t\t\tif (right == NULL)\n\t\t\t\tcontinue;\n\n\t\t\tcount++;\n\t\t\tret = evaluate(pamh, debug,\n\t\t\t\t       left, qual, right,\n\t\t\t\t       &pwd, user);\n\t\t\tif (ret == PAM_USER_UNKNOWN && audit)\n\t\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t\t   \"error retrieving information about user %s\",\n\t\t\t\t\t   user);\n\t\t\tif (ret != PAM_SUCCESS) {\n\t\t\t\tif(!quiet_fail && ret != PAM_USER_UNKNOWN)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"not met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\t\tleft = qual = right = NULL;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse\n\t\t\t\tif(!quiet_succ)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"was met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\tleft = qual = right = NULL;\n\t\t\tcontinue;\n\t\t}\n\t}\n\n\tif (left || qual || right) {\n\t\tret = PAM_SERVICE_ERR;\n\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\"incomplete condition detected\");\n\t} else if (count == 0) {\n\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\"no condition detected; module succeeded\");\n\t}\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nint\npam_sm_close_session(pam_handle_t *pamh, int flags, int argc, const char **argv)\n{\n\treturn pam_sm_authenticate(pamh, flags, argc, argv);\n}"
  },
  {
    "function_name": "pam_sm_open_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "602-606",
    "snippet": "int\npam_sm_open_session(pam_handle_t *pamh, int flags, int argc, const char **argv)\n{\n\treturn pam_sm_authenticate(pamh, flags, argc, argv);\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pam_sm_authenticate",
          "args": [
            "pamh",
            "flags",
            "argc",
            "argv"
          ],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "pam_sm_authenticate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "456-587",
          "snippet": "int\npam_sm_authenticate (pam_handle_t *pamh, int flags UNUSED,\n\t\t     int argc, const char **argv)\n{\n\tconst char *user;\n\tstruct passwd *pwd = NULL;\n\tint ret, i, count, use_uid, debug;\n\tconst char *left, *right, *qual;\n\tint quiet_fail, quiet_succ, audit;\n\n\tquiet_fail = 0;\n\tquiet_succ = 0;\n\taudit = 0;\n\tfor (use_uid = 0, debug = 0, i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tdebug++;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tuse_uid++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tquiet_fail++;\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tquiet_fail++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\taudit++;\n\t\t}\n\t}\n\n\tif (use_uid) {\n\t\t/* Get information about the user. */\n\t\tpwd = pam_modutil_getpwuid(pamh, getuid());\n\t\tif (pwd == NULL) {\n\t\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\t   \"error retrieving information about user %lu\",\n\t\t\t\t   (unsigned long)getuid());\n\t\t\treturn PAM_USER_UNKNOWN;\n\t\t}\n\t\tuser = pwd->pw_name;\n\t} else {\n\t\t/* Get the user's name. */\n\t\tret = pam_get_user(pamh, &user, NULL);\n\t\tif (ret != PAM_SUCCESS) {\n\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t   \"cannot determine user name: %s\",\n\t\t\t\t   pam_strerror(pamh, ret));\n\t\t\treturn ret;\n\t\t}\n\n\t\t/* Postpone requesting password data until it is needed */\n\t}\n\n\t/* Walk the argument list. */\n\tcount = 0;\n\tleft = qual = right = NULL;\n\tfor (i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (left == NULL) {\n\t\t\tleft = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (qual == NULL) {\n\t\t\tqual = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (right == NULL) {\n\t\t\tright = argv[i];\n\t\t\tif (right == NULL)\n\t\t\t\tcontinue;\n\n\t\t\tcount++;\n\t\t\tret = evaluate(pamh, debug,\n\t\t\t\t       left, qual, right,\n\t\t\t\t       &pwd, user);\n\t\t\tif (ret == PAM_USER_UNKNOWN && audit)\n\t\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t\t   \"error retrieving information about user %s\",\n\t\t\t\t\t   user);\n\t\t\tif (ret != PAM_SUCCESS) {\n\t\t\t\tif(!quiet_fail && ret != PAM_USER_UNKNOWN)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"not met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\t\tleft = qual = right = NULL;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse\n\t\t\t\tif(!quiet_succ)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"was met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\tleft = qual = right = NULL;\n\t\t\tcontinue;\n\t\t}\n\t}\n\n\tif (left || qual || right) {\n\t\tret = PAM_SERVICE_ERR;\n\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\"incomplete condition detected\");\n\t} else if (count == 0) {\n\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\"no condition detected; module succeeded\");\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nint\npam_sm_authenticate (pam_handle_t *pamh, int flags UNUSED,\n\t\t     int argc, const char **argv)\n{\n\tconst char *user;\n\tstruct passwd *pwd = NULL;\n\tint ret, i, count, use_uid, debug;\n\tconst char *left, *right, *qual;\n\tint quiet_fail, quiet_succ, audit;\n\n\tquiet_fail = 0;\n\tquiet_succ = 0;\n\taudit = 0;\n\tfor (use_uid = 0, debug = 0, i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tdebug++;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tuse_uid++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tquiet_fail++;\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tquiet_fail++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\taudit++;\n\t\t}\n\t}\n\n\tif (use_uid) {\n\t\t/* Get information about the user. */\n\t\tpwd = pam_modutil_getpwuid(pamh, getuid());\n\t\tif (pwd == NULL) {\n\t\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\t   \"error retrieving information about user %lu\",\n\t\t\t\t   (unsigned long)getuid());\n\t\t\treturn PAM_USER_UNKNOWN;\n\t\t}\n\t\tuser = pwd->pw_name;\n\t} else {\n\t\t/* Get the user's name. */\n\t\tret = pam_get_user(pamh, &user, NULL);\n\t\tif (ret != PAM_SUCCESS) {\n\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t   \"cannot determine user name: %s\",\n\t\t\t\t   pam_strerror(pamh, ret));\n\t\t\treturn ret;\n\t\t}\n\n\t\t/* Postpone requesting password data until it is needed */\n\t}\n\n\t/* Walk the argument list. */\n\tcount = 0;\n\tleft = qual = right = NULL;\n\tfor (i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (left == NULL) {\n\t\t\tleft = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (qual == NULL) {\n\t\t\tqual = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (right == NULL) {\n\t\t\tright = argv[i];\n\t\t\tif (right == NULL)\n\t\t\t\tcontinue;\n\n\t\t\tcount++;\n\t\t\tret = evaluate(pamh, debug,\n\t\t\t\t       left, qual, right,\n\t\t\t\t       &pwd, user);\n\t\t\tif (ret == PAM_USER_UNKNOWN && audit)\n\t\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t\t   \"error retrieving information about user %s\",\n\t\t\t\t\t   user);\n\t\t\tif (ret != PAM_SUCCESS) {\n\t\t\t\tif(!quiet_fail && ret != PAM_USER_UNKNOWN)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"not met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\t\tleft = qual = right = NULL;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse\n\t\t\t\tif(!quiet_succ)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"was met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\tleft = qual = right = NULL;\n\t\t\tcontinue;\n\t\t}\n\t}\n\n\tif (left || qual || right) {\n\t\tret = PAM_SERVICE_ERR;\n\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\"incomplete condition detected\");\n\t} else if (count == 0) {\n\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\"no condition detected; module succeeded\");\n\t}\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nint\npam_sm_open_session(pam_handle_t *pamh, int flags, int argc, const char **argv)\n{\n\treturn pam_sm_authenticate(pamh, flags, argc, argv);\n}"
  },
  {
    "function_name": "pam_sm_acct_mgmt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "596-600",
    "snippet": "int\npam_sm_acct_mgmt(pam_handle_t *pamh, int flags, int argc, const char **argv)\n{\n\treturn pam_sm_authenticate(pamh, flags, argc, argv);\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pam_sm_authenticate",
          "args": [
            "pamh",
            "flags",
            "argc",
            "argv"
          ],
          "line": 599
        },
        "resolved": true,
        "details": {
          "function_name": "pam_sm_authenticate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "456-587",
          "snippet": "int\npam_sm_authenticate (pam_handle_t *pamh, int flags UNUSED,\n\t\t     int argc, const char **argv)\n{\n\tconst char *user;\n\tstruct passwd *pwd = NULL;\n\tint ret, i, count, use_uid, debug;\n\tconst char *left, *right, *qual;\n\tint quiet_fail, quiet_succ, audit;\n\n\tquiet_fail = 0;\n\tquiet_succ = 0;\n\taudit = 0;\n\tfor (use_uid = 0, debug = 0, i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tdebug++;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tuse_uid++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tquiet_fail++;\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tquiet_fail++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\taudit++;\n\t\t}\n\t}\n\n\tif (use_uid) {\n\t\t/* Get information about the user. */\n\t\tpwd = pam_modutil_getpwuid(pamh, getuid());\n\t\tif (pwd == NULL) {\n\t\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\t   \"error retrieving information about user %lu\",\n\t\t\t\t   (unsigned long)getuid());\n\t\t\treturn PAM_USER_UNKNOWN;\n\t\t}\n\t\tuser = pwd->pw_name;\n\t} else {\n\t\t/* Get the user's name. */\n\t\tret = pam_get_user(pamh, &user, NULL);\n\t\tif (ret != PAM_SUCCESS) {\n\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t   \"cannot determine user name: %s\",\n\t\t\t\t   pam_strerror(pamh, ret));\n\t\t\treturn ret;\n\t\t}\n\n\t\t/* Postpone requesting password data until it is needed */\n\t}\n\n\t/* Walk the argument list. */\n\tcount = 0;\n\tleft = qual = right = NULL;\n\tfor (i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (left == NULL) {\n\t\t\tleft = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (qual == NULL) {\n\t\t\tqual = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (right == NULL) {\n\t\t\tright = argv[i];\n\t\t\tif (right == NULL)\n\t\t\t\tcontinue;\n\n\t\t\tcount++;\n\t\t\tret = evaluate(pamh, debug,\n\t\t\t\t       left, qual, right,\n\t\t\t\t       &pwd, user);\n\t\t\tif (ret == PAM_USER_UNKNOWN && audit)\n\t\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t\t   \"error retrieving information about user %s\",\n\t\t\t\t\t   user);\n\t\t\tif (ret != PAM_SUCCESS) {\n\t\t\t\tif(!quiet_fail && ret != PAM_USER_UNKNOWN)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"not met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\t\tleft = qual = right = NULL;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse\n\t\t\t\tif(!quiet_succ)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"was met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\tleft = qual = right = NULL;\n\t\t\tcontinue;\n\t\t}\n\t}\n\n\tif (left || qual || right) {\n\t\tret = PAM_SERVICE_ERR;\n\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\"incomplete condition detected\");\n\t} else if (count == 0) {\n\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\"no condition detected; module succeeded\");\n\t}\n\n\treturn ret;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nint\npam_sm_authenticate (pam_handle_t *pamh, int flags UNUSED,\n\t\t     int argc, const char **argv)\n{\n\tconst char *user;\n\tstruct passwd *pwd = NULL;\n\tint ret, i, count, use_uid, debug;\n\tconst char *left, *right, *qual;\n\tint quiet_fail, quiet_succ, audit;\n\n\tquiet_fail = 0;\n\tquiet_succ = 0;\n\taudit = 0;\n\tfor (use_uid = 0, debug = 0, i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tdebug++;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tuse_uid++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tquiet_fail++;\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tquiet_fail++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\taudit++;\n\t\t}\n\t}\n\n\tif (use_uid) {\n\t\t/* Get information about the user. */\n\t\tpwd = pam_modutil_getpwuid(pamh, getuid());\n\t\tif (pwd == NULL) {\n\t\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\t   \"error retrieving information about user %lu\",\n\t\t\t\t   (unsigned long)getuid());\n\t\t\treturn PAM_USER_UNKNOWN;\n\t\t}\n\t\tuser = pwd->pw_name;\n\t} else {\n\t\t/* Get the user's name. */\n\t\tret = pam_get_user(pamh, &user, NULL);\n\t\tif (ret != PAM_SUCCESS) {\n\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t   \"cannot determine user name: %s\",\n\t\t\t\t   pam_strerror(pamh, ret));\n\t\t\treturn ret;\n\t\t}\n\n\t\t/* Postpone requesting password data until it is needed */\n\t}\n\n\t/* Walk the argument list. */\n\tcount = 0;\n\tleft = qual = right = NULL;\n\tfor (i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (left == NULL) {\n\t\t\tleft = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (qual == NULL) {\n\t\t\tqual = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (right == NULL) {\n\t\t\tright = argv[i];\n\t\t\tif (right == NULL)\n\t\t\t\tcontinue;\n\n\t\t\tcount++;\n\t\t\tret = evaluate(pamh, debug,\n\t\t\t\t       left, qual, right,\n\t\t\t\t       &pwd, user);\n\t\t\tif (ret == PAM_USER_UNKNOWN && audit)\n\t\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t\t   \"error retrieving information about user %s\",\n\t\t\t\t\t   user);\n\t\t\tif (ret != PAM_SUCCESS) {\n\t\t\t\tif(!quiet_fail && ret != PAM_USER_UNKNOWN)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"not met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\t\tleft = qual = right = NULL;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse\n\t\t\t\tif(!quiet_succ)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"was met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\tleft = qual = right = NULL;\n\t\t\tcontinue;\n\t\t}\n\t}\n\n\tif (left || qual || right) {\n\t\tret = PAM_SERVICE_ERR;\n\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\"incomplete condition detected\");\n\t} else if (count == 0) {\n\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\"no condition detected; module succeeded\");\n\t}\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nint\npam_sm_acct_mgmt(pam_handle_t *pamh, int flags, int argc, const char **argv)\n{\n\treturn pam_sm_authenticate(pamh, flags, argc, argv);\n}"
  },
  {
    "function_name": "pam_sm_setcred",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "589-594",
    "snippet": "int\npam_sm_setcred(pam_handle_t *pamh UNUSED, int flags UNUSED,\n               int argc UNUSED, const char **argv UNUSED)\n{\n\treturn PAM_IGNORE;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nint\npam_sm_setcred(pam_handle_t *pamh UNUSED, int flags UNUSED,\n               int argc UNUSED, const char **argv UNUSED)\n{\n\treturn PAM_IGNORE;\n}"
  },
  {
    "function_name": "pam_sm_authenticate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "456-587",
    "snippet": "int\npam_sm_authenticate (pam_handle_t *pamh, int flags UNUSED,\n\t\t     int argc, const char **argv)\n{\n\tconst char *user;\n\tstruct passwd *pwd = NULL;\n\tint ret, i, count, use_uid, debug;\n\tconst char *left, *right, *qual;\n\tint quiet_fail, quiet_succ, audit;\n\n\tquiet_fail = 0;\n\tquiet_succ = 0;\n\taudit = 0;\n\tfor (use_uid = 0, debug = 0, i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tdebug++;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tuse_uid++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tquiet_fail++;\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tquiet_fail++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\taudit++;\n\t\t}\n\t}\n\n\tif (use_uid) {\n\t\t/* Get information about the user. */\n\t\tpwd = pam_modutil_getpwuid(pamh, getuid());\n\t\tif (pwd == NULL) {\n\t\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\t   \"error retrieving information about user %lu\",\n\t\t\t\t   (unsigned long)getuid());\n\t\t\treturn PAM_USER_UNKNOWN;\n\t\t}\n\t\tuser = pwd->pw_name;\n\t} else {\n\t\t/* Get the user's name. */\n\t\tret = pam_get_user(pamh, &user, NULL);\n\t\tif (ret != PAM_SUCCESS) {\n\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t   \"cannot determine user name: %s\",\n\t\t\t\t   pam_strerror(pamh, ret));\n\t\t\treturn ret;\n\t\t}\n\n\t\t/* Postpone requesting password data until it is needed */\n\t}\n\n\t/* Walk the argument list. */\n\tcount = 0;\n\tleft = qual = right = NULL;\n\tfor (i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (left == NULL) {\n\t\t\tleft = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (qual == NULL) {\n\t\t\tqual = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (right == NULL) {\n\t\t\tright = argv[i];\n\t\t\tif (right == NULL)\n\t\t\t\tcontinue;\n\n\t\t\tcount++;\n\t\t\tret = evaluate(pamh, debug,\n\t\t\t\t       left, qual, right,\n\t\t\t\t       &pwd, user);\n\t\t\tif (ret == PAM_USER_UNKNOWN && audit)\n\t\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t\t   \"error retrieving information about user %s\",\n\t\t\t\t\t   user);\n\t\t\tif (ret != PAM_SUCCESS) {\n\t\t\t\tif(!quiet_fail && ret != PAM_USER_UNKNOWN)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"not met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\t\tleft = qual = right = NULL;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse\n\t\t\t\tif(!quiet_succ)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"was met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\tleft = qual = right = NULL;\n\t\t\tcontinue;\n\t\t}\n\t}\n\n\tif (left || qual || right) {\n\t\tret = PAM_SERVICE_ERR;\n\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\"incomplete condition detected\");\n\t} else if (count == 0) {\n\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\"no condition detected; module succeeded\");\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pam_syslog",
          "args": [
            "pamh",
            "LOG_INFO",
            "\"no condition detected; module succeeded\""
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_syslog",
          "args": [
            "pamh",
            "LOG_ERR",
            "\"incomplete condition detected\""
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_syslog",
          "args": [
            "pamh",
            "LOG_INFO",
            "\"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"was met by user \\\"%s\\\"\"",
            "left",
            "qual",
            "right",
            "user"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_syslog",
          "args": [
            "pamh",
            "LOG_INFO",
            "\"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"not met by user \\\"%s\\\"\"",
            "left",
            "qual",
            "right",
            "user"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_syslog",
          "args": [
            "pamh",
            "LOG_NOTICE",
            "\"error retrieving information about user %s\"",
            "user"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evaluate",
          "args": [
            "pamh",
            "debug",
            "left",
            "qual",
            "right",
            "&pwd",
            "user"
          ],
          "line": 550
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "290-454",
          "snippet": "static int\nevaluate(pam_handle_t *pamh, int debug,\n\t const char *left, const char *qual, const char *right,\n\t struct passwd **pwd, const char *user)\n{\n\tchar buf[LINE_MAX] = \"\";\n\tconst char *attribute = left;\n\t/* Figure out what we're evaluating here, and convert it to a string.*/\n\tif ((strcasecmp(left, \"login\") == 0) ||\n\t    (strcasecmp(left, \"name\") == 0) ||\n\t    (strcasecmp(left, \"user\") == 0)) {\n\t\tsnprintf(buf, sizeof(buf), \"%s\", user);\n\t\tleft = buf;\n\t}\n\t/* Get information about the user if needed. */\n\tif ((*pwd == NULL) &&\n\t    ((strcasecmp(left, \"uid\") == 0) ||\n\t     (strcasecmp(left, \"gid\") == 0) ||\n\t     (strcasecmp(left, \"shell\") == 0) ||\n\t     (strcasecmp(left, \"home\") == 0) ||\n\t     (strcasecmp(left, \"dir\") == 0) ||\n\t     (strcasecmp(left, \"homedir\") == 0))) {\n\t\t*pwd = pam_modutil_getpwnam(pamh, user);\n\t\tif (*pwd == NULL) {\n\t\t\treturn PAM_USER_UNKNOWN;\n\t\t}\n\t}\n\tif (strcasecmp(left, \"uid\") == 0) {\n\t\tsnprintf(buf, sizeof(buf), \"%lu\", (unsigned long) (*pwd)->pw_uid);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"gid\") == 0) {\n\t\tsnprintf(buf, sizeof(buf), \"%lu\", (unsigned long) (*pwd)->pw_gid);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"shell\") == 0) {\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (*pwd)->pw_shell);\n\t\tleft = buf;\n\t}\n\tif ((strcasecmp(left, \"home\") == 0) ||\n\t    (strcasecmp(left, \"dir\") == 0) ||\n\t    (strcasecmp(left, \"homedir\") == 0)) {\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (*pwd)->pw_dir);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"service\") == 0) {\n\t\tconst void *svc;\n\t\tif (pam_get_item(pamh, PAM_SERVICE, &svc) != PAM_SUCCESS ||\n\t\t\tsvc == NULL)\n\t\t\tsvc = \"\";\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (const char *)svc);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"ruser\") == 0) {\n\t\tconst void *ruser;\n\t\tif (pam_get_item(pamh, PAM_RUSER, &ruser) != PAM_SUCCESS ||\n\t\t\truser == NULL)\n\t\t\truser = \"\";\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (const char *)ruser);\n\t\tleft = buf;\n\t\tuser = buf;\n\t}\n\tif (strcasecmp(left, \"rhost\") == 0) {\n\t\tconst void *rhost;\n\t\tif (pam_get_item(pamh, PAM_RHOST, &rhost) != PAM_SUCCESS ||\n\t\t\trhost == NULL)\n\t\t\trhost = \"\";\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (const char *)rhost);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"tty\") == 0) {\n\t\tconst void *tty;\n\t\tif (pam_get_item(pamh, PAM_TTY, &tty) != PAM_SUCCESS ||\n\t\t\ttty == NULL)\n\t\t\ttty = \"\";\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (const char *)tty);\n\t\tleft = buf;\n\t}\n\t/* If we have no idea what's going on, return an error. */\n\tif (left != buf) {\n\t\tpam_syslog(pamh, LOG_ERR, \"unknown attribute \\\"%s\\\"\", left);\n\t\treturn PAM_SERVICE_ERR;\n\t}\n\tif (debug) {\n\t\tpam_syslog(pamh, LOG_DEBUG, \"'%s' resolves to '%s'\",\n\t\t\t   attribute, left);\n\t}\n\n\t/* Attribute value < some threshold. */\n\tif ((strcasecmp(qual, \"<\") == 0) ||\n\t    (strcasecmp(qual, \"lt\") == 0)) {\n\t\treturn evaluate_lt(pamh, left, right);\n\t}\n\t/* Attribute value <= some threshold. */\n\tif ((strcasecmp(qual, \"<=\") == 0) ||\n\t    (strcasecmp(qual, \"le\") == 0)) {\n\t\treturn evaluate_le(pamh, left, right);\n\t}\n\t/* Attribute value > some threshold. */\n\tif ((strcasecmp(qual, \">\") == 0) ||\n\t    (strcasecmp(qual, \"gt\") == 0)) {\n\t\treturn evaluate_gt(pamh, left, right);\n\t}\n\t/* Attribute value >= some threshold. */\n\tif ((strcasecmp(qual, \">=\") == 0) ||\n\t    (strcasecmp(qual, \"ge\") == 0)) {\n\t\treturn evaluate_ge(pamh, left, right);\n\t}\n\t/* Attribute value == some threshold. */\n\tif (strcasecmp(qual, \"eq\") == 0) {\n\t\treturn evaluate_eqn(pamh, left, right);\n\t}\n\t/* Attribute value = some string. */\n\tif (strcasecmp(qual, \"=\") == 0) {\n\t\treturn evaluate_eqs(left, right);\n\t}\n\t/* Attribute value != some threshold. */\n\tif (strcasecmp(qual, \"ne\") == 0) {\n\t\treturn evaluate_nen(pamh, left, right);\n\t}\n\t/* Attribute value != some string. */\n\tif (strcasecmp(qual, \"!=\") == 0) {\n\t\treturn evaluate_nes(left, right);\n\t}\n\t/* Attribute value matches some pattern. */\n\tif ((strcasecmp(qual, \"=~\") == 0) ||\n\t    (strcasecmp(qual, \"glob\") == 0)) {\n\t\treturn evaluate_glob(left, right);\n\t}\n\tif ((strcasecmp(qual, \"!~\") == 0) ||\n\t    (strcasecmp(qual, \"noglob\") == 0)) {\n\t\treturn evaluate_noglob(left, right);\n\t}\n\t/* Attribute value matches item in list. */\n\tif (strcasecmp(qual, \"in\") == 0) {\n\t\treturn evaluate_inlist(left, right);\n\t}\n\tif (strcasecmp(qual, \"notin\") == 0) {\n\t\treturn evaluate_notinlist(left, right);\n\t}\n\t/* User is in this group(s). */\n\tif (strcasecmp(qual, \"ingroup\") == 0) {\n\t\treturn evaluate_ingroup(pamh, user, right);\n\t}\n\t/* User is not in this group(s). */\n\tif (strcasecmp(qual, \"notingroup\") == 0) {\n\t\treturn evaluate_notingroup(pamh, user, right);\n\t}\n\t/* (Rhost, user) is in this netgroup. */\n\tif (strcasecmp(qual, \"innetgr\") == 0) {\n\t\tconst void *rhost;\n\t\tif (pam_get_item(pamh, PAM_RHOST, &rhost) != PAM_SUCCESS)\n\t\t\trhost = NULL;\n\t\treturn evaluate_innetgr(pamh, rhost, user, right);\n\t}\n\t/* (Rhost, user) is not in this group. */\n\tif (strcasecmp(qual, \"notinnetgr\") == 0) {\n\t\tconst void *rhost;\n\t\tif (pam_get_item(pamh, PAM_RHOST, &rhost) != PAM_SUCCESS)\n\t\t\trhost = NULL;\n\t\treturn evaluate_notinnetgr(pamh, rhost, user, right);\n\t}\n\t/* Fail closed. */\n\treturn PAM_SERVICE_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate(pam_handle_t *pamh, int debug,\n\t const char *left, const char *qual, const char *right,\n\t struct passwd **pwd, const char *user)\n{\n\tchar buf[LINE_MAX] = \"\";\n\tconst char *attribute = left;\n\t/* Figure out what we're evaluating here, and convert it to a string.*/\n\tif ((strcasecmp(left, \"login\") == 0) ||\n\t    (strcasecmp(left, \"name\") == 0) ||\n\t    (strcasecmp(left, \"user\") == 0)) {\n\t\tsnprintf(buf, sizeof(buf), \"%s\", user);\n\t\tleft = buf;\n\t}\n\t/* Get information about the user if needed. */\n\tif ((*pwd == NULL) &&\n\t    ((strcasecmp(left, \"uid\") == 0) ||\n\t     (strcasecmp(left, \"gid\") == 0) ||\n\t     (strcasecmp(left, \"shell\") == 0) ||\n\t     (strcasecmp(left, \"home\") == 0) ||\n\t     (strcasecmp(left, \"dir\") == 0) ||\n\t     (strcasecmp(left, \"homedir\") == 0))) {\n\t\t*pwd = pam_modutil_getpwnam(pamh, user);\n\t\tif (*pwd == NULL) {\n\t\t\treturn PAM_USER_UNKNOWN;\n\t\t}\n\t}\n\tif (strcasecmp(left, \"uid\") == 0) {\n\t\tsnprintf(buf, sizeof(buf), \"%lu\", (unsigned long) (*pwd)->pw_uid);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"gid\") == 0) {\n\t\tsnprintf(buf, sizeof(buf), \"%lu\", (unsigned long) (*pwd)->pw_gid);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"shell\") == 0) {\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (*pwd)->pw_shell);\n\t\tleft = buf;\n\t}\n\tif ((strcasecmp(left, \"home\") == 0) ||\n\t    (strcasecmp(left, \"dir\") == 0) ||\n\t    (strcasecmp(left, \"homedir\") == 0)) {\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (*pwd)->pw_dir);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"service\") == 0) {\n\t\tconst void *svc;\n\t\tif (pam_get_item(pamh, PAM_SERVICE, &svc) != PAM_SUCCESS ||\n\t\t\tsvc == NULL)\n\t\t\tsvc = \"\";\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (const char *)svc);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"ruser\") == 0) {\n\t\tconst void *ruser;\n\t\tif (pam_get_item(pamh, PAM_RUSER, &ruser) != PAM_SUCCESS ||\n\t\t\truser == NULL)\n\t\t\truser = \"\";\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (const char *)ruser);\n\t\tleft = buf;\n\t\tuser = buf;\n\t}\n\tif (strcasecmp(left, \"rhost\") == 0) {\n\t\tconst void *rhost;\n\t\tif (pam_get_item(pamh, PAM_RHOST, &rhost) != PAM_SUCCESS ||\n\t\t\trhost == NULL)\n\t\t\trhost = \"\";\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (const char *)rhost);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"tty\") == 0) {\n\t\tconst void *tty;\n\t\tif (pam_get_item(pamh, PAM_TTY, &tty) != PAM_SUCCESS ||\n\t\t\ttty == NULL)\n\t\t\ttty = \"\";\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (const char *)tty);\n\t\tleft = buf;\n\t}\n\t/* If we have no idea what's going on, return an error. */\n\tif (left != buf) {\n\t\tpam_syslog(pamh, LOG_ERR, \"unknown attribute \\\"%s\\\"\", left);\n\t\treturn PAM_SERVICE_ERR;\n\t}\n\tif (debug) {\n\t\tpam_syslog(pamh, LOG_DEBUG, \"'%s' resolves to '%s'\",\n\t\t\t   attribute, left);\n\t}\n\n\t/* Attribute value < some threshold. */\n\tif ((strcasecmp(qual, \"<\") == 0) ||\n\t    (strcasecmp(qual, \"lt\") == 0)) {\n\t\treturn evaluate_lt(pamh, left, right);\n\t}\n\t/* Attribute value <= some threshold. */\n\tif ((strcasecmp(qual, \"<=\") == 0) ||\n\t    (strcasecmp(qual, \"le\") == 0)) {\n\t\treturn evaluate_le(pamh, left, right);\n\t}\n\t/* Attribute value > some threshold. */\n\tif ((strcasecmp(qual, \">\") == 0) ||\n\t    (strcasecmp(qual, \"gt\") == 0)) {\n\t\treturn evaluate_gt(pamh, left, right);\n\t}\n\t/* Attribute value >= some threshold. */\n\tif ((strcasecmp(qual, \">=\") == 0) ||\n\t    (strcasecmp(qual, \"ge\") == 0)) {\n\t\treturn evaluate_ge(pamh, left, right);\n\t}\n\t/* Attribute value == some threshold. */\n\tif (strcasecmp(qual, \"eq\") == 0) {\n\t\treturn evaluate_eqn(pamh, left, right);\n\t}\n\t/* Attribute value = some string. */\n\tif (strcasecmp(qual, \"=\") == 0) {\n\t\treturn evaluate_eqs(left, right);\n\t}\n\t/* Attribute value != some threshold. */\n\tif (strcasecmp(qual, \"ne\") == 0) {\n\t\treturn evaluate_nen(pamh, left, right);\n\t}\n\t/* Attribute value != some string. */\n\tif (strcasecmp(qual, \"!=\") == 0) {\n\t\treturn evaluate_nes(left, right);\n\t}\n\t/* Attribute value matches some pattern. */\n\tif ((strcasecmp(qual, \"=~\") == 0) ||\n\t    (strcasecmp(qual, \"glob\") == 0)) {\n\t\treturn evaluate_glob(left, right);\n\t}\n\tif ((strcasecmp(qual, \"!~\") == 0) ||\n\t    (strcasecmp(qual, \"noglob\") == 0)) {\n\t\treturn evaluate_noglob(left, right);\n\t}\n\t/* Attribute value matches item in list. */\n\tif (strcasecmp(qual, \"in\") == 0) {\n\t\treturn evaluate_inlist(left, right);\n\t}\n\tif (strcasecmp(qual, \"notin\") == 0) {\n\t\treturn evaluate_notinlist(left, right);\n\t}\n\t/* User is in this group(s). */\n\tif (strcasecmp(qual, \"ingroup\") == 0) {\n\t\treturn evaluate_ingroup(pamh, user, right);\n\t}\n\t/* User is not in this group(s). */\n\tif (strcasecmp(qual, \"notingroup\") == 0) {\n\t\treturn evaluate_notingroup(pamh, user, right);\n\t}\n\t/* (Rhost, user) is in this netgroup. */\n\tif (strcasecmp(qual, \"innetgr\") == 0) {\n\t\tconst void *rhost;\n\t\tif (pam_get_item(pamh, PAM_RHOST, &rhost) != PAM_SUCCESS)\n\t\t\trhost = NULL;\n\t\treturn evaluate_innetgr(pamh, rhost, user, right);\n\t}\n\t/* (Rhost, user) is not in this group. */\n\tif (strcasecmp(qual, \"notinnetgr\") == 0) {\n\t\tconst void *rhost;\n\t\tif (pam_get_item(pamh, PAM_RHOST, &rhost) != PAM_SUCCESS)\n\t\t\trhost = NULL;\n\t\treturn evaluate_notinnetgr(pamh, rhost, user, right);\n\t}\n\t/* Fail closed. */\n\treturn PAM_SERVICE_ERR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[i]",
            "\"audit\""
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[i]",
            "\"quiet_success\""
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[i]",
            "\"quiet_fail\""
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[i]",
            "\"quiet\""
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[i]",
            "\"use_uid\""
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[i]",
            "\"debug\""
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_syslog",
          "args": [
            "pamh",
            "LOG_NOTICE",
            "\"cannot determine user name: %s\"",
            "pam_strerror(pamh, ret)"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_strerror",
          "args": [
            "pamh",
            "ret"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_get_user",
          "args": [
            "pamh",
            "&user",
            "NULL"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_syslog",
          "args": [
            "pamh",
            "LOG_ERR",
            "\"error retrieving information about user %lu\"",
            "(unsigned long)getuid()"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_modutil_getpwuid",
          "args": [
            "pamh",
            "getuid()"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[i]",
            "\"audit\""
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[i]",
            "\"quiet_success\""
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[i]",
            "\"quiet_fail\""
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[i]",
            "\"quiet\""
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[i]",
            "\"use_uid\""
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[i]",
            "\"debug\""
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nint\npam_sm_authenticate (pam_handle_t *pamh, int flags UNUSED,\n\t\t     int argc, const char **argv)\n{\n\tconst char *user;\n\tstruct passwd *pwd = NULL;\n\tint ret, i, count, use_uid, debug;\n\tconst char *left, *right, *qual;\n\tint quiet_fail, quiet_succ, audit;\n\n\tquiet_fail = 0;\n\tquiet_succ = 0;\n\taudit = 0;\n\tfor (use_uid = 0, debug = 0, i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tdebug++;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tuse_uid++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tquiet_fail++;\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tquiet_fail++;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tquiet_succ++;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\taudit++;\n\t\t}\n\t}\n\n\tif (use_uid) {\n\t\t/* Get information about the user. */\n\t\tpwd = pam_modutil_getpwuid(pamh, getuid());\n\t\tif (pwd == NULL) {\n\t\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\t   \"error retrieving information about user %lu\",\n\t\t\t\t   (unsigned long)getuid());\n\t\t\treturn PAM_USER_UNKNOWN;\n\t\t}\n\t\tuser = pwd->pw_name;\n\t} else {\n\t\t/* Get the user's name. */\n\t\tret = pam_get_user(pamh, &user, NULL);\n\t\tif (ret != PAM_SUCCESS) {\n\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t   \"cannot determine user name: %s\",\n\t\t\t\t   pam_strerror(pamh, ret));\n\t\t\treturn ret;\n\t\t}\n\n\t\t/* Postpone requesting password data until it is needed */\n\t}\n\n\t/* Walk the argument list. */\n\tcount = 0;\n\tleft = qual = right = NULL;\n\tfor (i = 0; i < argc; i++) {\n\t\tif (strcmp(argv[i], \"debug\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"use_uid\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_fail\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"quiet_success\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (strcmp(argv[i], \"audit\") == 0) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (left == NULL) {\n\t\t\tleft = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (qual == NULL) {\n\t\t\tqual = argv[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif (right == NULL) {\n\t\t\tright = argv[i];\n\t\t\tif (right == NULL)\n\t\t\t\tcontinue;\n\n\t\t\tcount++;\n\t\t\tret = evaluate(pamh, debug,\n\t\t\t\t       left, qual, right,\n\t\t\t\t       &pwd, user);\n\t\t\tif (ret == PAM_USER_UNKNOWN && audit)\n\t\t\t\tpam_syslog(pamh, LOG_NOTICE,\n\t\t\t\t\t   \"error retrieving information about user %s\",\n\t\t\t\t\t   user);\n\t\t\tif (ret != PAM_SUCCESS) {\n\t\t\t\tif(!quiet_fail && ret != PAM_USER_UNKNOWN)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"not met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\t\tleft = qual = right = NULL;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse\n\t\t\t\tif(!quiet_succ)\n\t\t\t\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\t\t\t   \"requirement \\\"%s %s %s\\\" \"\n\t\t\t\t\t\t   \"was met by user \\\"%s\\\"\",\n\t\t\t\t\t\t   left, qual, right, user);\n\t\t\tleft = qual = right = NULL;\n\t\t\tcontinue;\n\t\t}\n\t}\n\n\tif (left || qual || right) {\n\t\tret = PAM_SERVICE_ERR;\n\t\tpam_syslog(pamh, LOG_ERR,\n\t\t\t\"incomplete condition detected\");\n\t} else if (count == 0) {\n\t\tpam_syslog(pamh, LOG_INFO,\n\t\t\t\"no condition detected; module succeeded\");\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "evaluate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "290-454",
    "snippet": "static int\nevaluate(pam_handle_t *pamh, int debug,\n\t const char *left, const char *qual, const char *right,\n\t struct passwd **pwd, const char *user)\n{\n\tchar buf[LINE_MAX] = \"\";\n\tconst char *attribute = left;\n\t/* Figure out what we're evaluating here, and convert it to a string.*/\n\tif ((strcasecmp(left, \"login\") == 0) ||\n\t    (strcasecmp(left, \"name\") == 0) ||\n\t    (strcasecmp(left, \"user\") == 0)) {\n\t\tsnprintf(buf, sizeof(buf), \"%s\", user);\n\t\tleft = buf;\n\t}\n\t/* Get information about the user if needed. */\n\tif ((*pwd == NULL) &&\n\t    ((strcasecmp(left, \"uid\") == 0) ||\n\t     (strcasecmp(left, \"gid\") == 0) ||\n\t     (strcasecmp(left, \"shell\") == 0) ||\n\t     (strcasecmp(left, \"home\") == 0) ||\n\t     (strcasecmp(left, \"dir\") == 0) ||\n\t     (strcasecmp(left, \"homedir\") == 0))) {\n\t\t*pwd = pam_modutil_getpwnam(pamh, user);\n\t\tif (*pwd == NULL) {\n\t\t\treturn PAM_USER_UNKNOWN;\n\t\t}\n\t}\n\tif (strcasecmp(left, \"uid\") == 0) {\n\t\tsnprintf(buf, sizeof(buf), \"%lu\", (unsigned long) (*pwd)->pw_uid);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"gid\") == 0) {\n\t\tsnprintf(buf, sizeof(buf), \"%lu\", (unsigned long) (*pwd)->pw_gid);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"shell\") == 0) {\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (*pwd)->pw_shell);\n\t\tleft = buf;\n\t}\n\tif ((strcasecmp(left, \"home\") == 0) ||\n\t    (strcasecmp(left, \"dir\") == 0) ||\n\t    (strcasecmp(left, \"homedir\") == 0)) {\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (*pwd)->pw_dir);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"service\") == 0) {\n\t\tconst void *svc;\n\t\tif (pam_get_item(pamh, PAM_SERVICE, &svc) != PAM_SUCCESS ||\n\t\t\tsvc == NULL)\n\t\t\tsvc = \"\";\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (const char *)svc);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"ruser\") == 0) {\n\t\tconst void *ruser;\n\t\tif (pam_get_item(pamh, PAM_RUSER, &ruser) != PAM_SUCCESS ||\n\t\t\truser == NULL)\n\t\t\truser = \"\";\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (const char *)ruser);\n\t\tleft = buf;\n\t\tuser = buf;\n\t}\n\tif (strcasecmp(left, \"rhost\") == 0) {\n\t\tconst void *rhost;\n\t\tif (pam_get_item(pamh, PAM_RHOST, &rhost) != PAM_SUCCESS ||\n\t\t\trhost == NULL)\n\t\t\trhost = \"\";\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (const char *)rhost);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"tty\") == 0) {\n\t\tconst void *tty;\n\t\tif (pam_get_item(pamh, PAM_TTY, &tty) != PAM_SUCCESS ||\n\t\t\ttty == NULL)\n\t\t\ttty = \"\";\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (const char *)tty);\n\t\tleft = buf;\n\t}\n\t/* If we have no idea what's going on, return an error. */\n\tif (left != buf) {\n\t\tpam_syslog(pamh, LOG_ERR, \"unknown attribute \\\"%s\\\"\", left);\n\t\treturn PAM_SERVICE_ERR;\n\t}\n\tif (debug) {\n\t\tpam_syslog(pamh, LOG_DEBUG, \"'%s' resolves to '%s'\",\n\t\t\t   attribute, left);\n\t}\n\n\t/* Attribute value < some threshold. */\n\tif ((strcasecmp(qual, \"<\") == 0) ||\n\t    (strcasecmp(qual, \"lt\") == 0)) {\n\t\treturn evaluate_lt(pamh, left, right);\n\t}\n\t/* Attribute value <= some threshold. */\n\tif ((strcasecmp(qual, \"<=\") == 0) ||\n\t    (strcasecmp(qual, \"le\") == 0)) {\n\t\treturn evaluate_le(pamh, left, right);\n\t}\n\t/* Attribute value > some threshold. */\n\tif ((strcasecmp(qual, \">\") == 0) ||\n\t    (strcasecmp(qual, \"gt\") == 0)) {\n\t\treturn evaluate_gt(pamh, left, right);\n\t}\n\t/* Attribute value >= some threshold. */\n\tif ((strcasecmp(qual, \">=\") == 0) ||\n\t    (strcasecmp(qual, \"ge\") == 0)) {\n\t\treturn evaluate_ge(pamh, left, right);\n\t}\n\t/* Attribute value == some threshold. */\n\tif (strcasecmp(qual, \"eq\") == 0) {\n\t\treturn evaluate_eqn(pamh, left, right);\n\t}\n\t/* Attribute value = some string. */\n\tif (strcasecmp(qual, \"=\") == 0) {\n\t\treturn evaluate_eqs(left, right);\n\t}\n\t/* Attribute value != some threshold. */\n\tif (strcasecmp(qual, \"ne\") == 0) {\n\t\treturn evaluate_nen(pamh, left, right);\n\t}\n\t/* Attribute value != some string. */\n\tif (strcasecmp(qual, \"!=\") == 0) {\n\t\treturn evaluate_nes(left, right);\n\t}\n\t/* Attribute value matches some pattern. */\n\tif ((strcasecmp(qual, \"=~\") == 0) ||\n\t    (strcasecmp(qual, \"glob\") == 0)) {\n\t\treturn evaluate_glob(left, right);\n\t}\n\tif ((strcasecmp(qual, \"!~\") == 0) ||\n\t    (strcasecmp(qual, \"noglob\") == 0)) {\n\t\treturn evaluate_noglob(left, right);\n\t}\n\t/* Attribute value matches item in list. */\n\tif (strcasecmp(qual, \"in\") == 0) {\n\t\treturn evaluate_inlist(left, right);\n\t}\n\tif (strcasecmp(qual, \"notin\") == 0) {\n\t\treturn evaluate_notinlist(left, right);\n\t}\n\t/* User is in this group(s). */\n\tif (strcasecmp(qual, \"ingroup\") == 0) {\n\t\treturn evaluate_ingroup(pamh, user, right);\n\t}\n\t/* User is not in this group(s). */\n\tif (strcasecmp(qual, \"notingroup\") == 0) {\n\t\treturn evaluate_notingroup(pamh, user, right);\n\t}\n\t/* (Rhost, user) is in this netgroup. */\n\tif (strcasecmp(qual, \"innetgr\") == 0) {\n\t\tconst void *rhost;\n\t\tif (pam_get_item(pamh, PAM_RHOST, &rhost) != PAM_SUCCESS)\n\t\t\trhost = NULL;\n\t\treturn evaluate_innetgr(pamh, rhost, user, right);\n\t}\n\t/* (Rhost, user) is not in this group. */\n\tif (strcasecmp(qual, \"notinnetgr\") == 0) {\n\t\tconst void *rhost;\n\t\tif (pam_get_item(pamh, PAM_RHOST, &rhost) != PAM_SUCCESS)\n\t\t\trhost = NULL;\n\t\treturn evaluate_notinnetgr(pamh, rhost, user, right);\n\t}\n\t/* Fail closed. */\n\treturn PAM_SERVICE_ERR;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "evaluate_notinnetgr",
          "args": [
            "pamh",
            "rhost",
            "user",
            "right"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_notinnetgr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "277-287",
          "snippet": "static int\nevaluate_notinnetgr(const pam_handle_t* pamh SOMETIMES_UNUSED, const char *host, const char *user, const char *group)\n{\n#ifdef HAVE_INNETGR\n\tif (innetgr(group, host, user, NULL) == 0)\n\t\treturn PAM_SUCCESS;\n#else\n\tpam_syslog (pamh, LOG_ERR, \"pam_succeed_if does not have netgroup support\");\n#endif\n\treturn PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_notinnetgr(const pam_handle_t* pamh SOMETIMES_UNUSED, const char *host, const char *user, const char *group)\n{\n#ifdef HAVE_INNETGR\n\tif (innetgr(group, host, user, NULL) == 0)\n\t\treturn PAM_SUCCESS;\n#else\n\tpam_syslog (pamh, LOG_ERR, \"pam_succeed_if does not have netgroup support\");\n#endif\n\treturn PAM_AUTH_ERR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pam_get_item",
          "args": [
            "pamh",
            "PAM_RHOST",
            "&rhost"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"notinnetgr\""
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evaluate_innetgr",
          "args": [
            "pamh",
            "rhost",
            "user",
            "right"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_innetgr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "264-275",
          "snippet": "static int\nevaluate_innetgr(const pam_handle_t* pamh SOMETIMES_UNUSED, const char *host, const char *user, const char *group)\n{\n#ifdef HAVE_INNETGR\n\tif (innetgr(group, host, user, NULL) == 1)\n\t\treturn PAM_SUCCESS;\n#else\n\tpam_syslog (pamh, LOG_ERR, \"pam_succeed_if does not have netgroup support\");\n#endif\n\n\treturn PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_innetgr(const pam_handle_t* pamh SOMETIMES_UNUSED, const char *host, const char *user, const char *group)\n{\n#ifdef HAVE_INNETGR\n\tif (innetgr(group, host, user, NULL) == 1)\n\t\treturn PAM_SUCCESS;\n#else\n\tpam_syslog (pamh, LOG_ERR, \"pam_succeed_if does not have netgroup support\");\n#endif\n\n\treturn PAM_AUTH_ERR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pam_get_item",
          "args": [
            "pamh",
            "PAM_RHOST",
            "&rhost"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"innetgr\""
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evaluate_notingroup",
          "args": [
            "pamh",
            "user",
            "right"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_notingroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "234-255",
          "snippet": "static int\nevaluate_notingroup(pam_handle_t *pamh, const char *user, const char *grouplist)\n{\n\tchar *ptr = NULL;\n\tstatic const char delim[] = \":\";\n\tchar const *grp = NULL;\n\tchar *group = strdup(grouplist);\n\n\tif (group == NULL)\n\t\treturn PAM_BUF_ERR;\n\n\tgrp = strtok_r(group, delim, &ptr);\n\twhile(grp != NULL) {\n\t\tif (pam_modutil_user_in_group_nam_nam(pamh, user, grp) == 1) {\n\t\t\tfree(group);\n\t\t\treturn PAM_AUTH_ERR;\n\t\t}\n\t\tgrp = strtok_r(NULL, delim, &ptr);\n\t}\n\tfree(group);\n\treturn PAM_SUCCESS;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_notingroup(pam_handle_t *pamh, const char *user, const char *grouplist)\n{\n\tchar *ptr = NULL;\n\tstatic const char delim[] = \":\";\n\tchar const *grp = NULL;\n\tchar *group = strdup(grouplist);\n\n\tif (group == NULL)\n\t\treturn PAM_BUF_ERR;\n\n\tgrp = strtok_r(group, delim, &ptr);\n\twhile(grp != NULL) {\n\t\tif (pam_modutil_user_in_group_nam_nam(pamh, user, grp) == 1) {\n\t\t\tfree(group);\n\t\t\treturn PAM_AUTH_ERR;\n\t\t}\n\t\tgrp = strtok_r(NULL, delim, &ptr);\n\t}\n\tfree(group);\n\treturn PAM_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"notingroup\""
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evaluate_ingroup",
          "args": [
            "pamh",
            "user",
            "right"
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_ingroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "211-232",
          "snippet": "static int\nevaluate_ingroup(pam_handle_t *pamh, const char *user, const char *grouplist)\n{\n\tchar *ptr = NULL;\n\tstatic const char delim[] = \":\";\n\tchar const *grp = NULL;\n\tchar *group = strdup(grouplist);\n\n\tif (group == NULL)\n\t\treturn PAM_BUF_ERR;\n\n\tgrp = strtok_r(group, delim, &ptr);\n\twhile(grp != NULL) {\n\t\tif (pam_modutil_user_in_group_nam_nam(pamh, user, grp) == 1) {\n\t\t\tfree(group);\n\t\t\treturn PAM_SUCCESS;\n\t\t}\n\t\tgrp = strtok_r(NULL, delim, &ptr);\n\t}\n\tfree(group);\n\treturn PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_ingroup(pam_handle_t *pamh, const char *user, const char *grouplist)\n{\n\tchar *ptr = NULL;\n\tstatic const char delim[] = \":\";\n\tchar const *grp = NULL;\n\tchar *group = strdup(grouplist);\n\n\tif (group == NULL)\n\t\treturn PAM_BUF_ERR;\n\n\tgrp = strtok_r(group, delim, &ptr);\n\twhile(grp != NULL) {\n\t\tif (pam_modutil_user_in_group_nam_nam(pamh, user, grp) == 1) {\n\t\t\tfree(group);\n\t\t\treturn PAM_SUCCESS;\n\t\t}\n\t\tgrp = strtok_r(NULL, delim, &ptr);\n\t}\n\tfree(group);\n\treturn PAM_AUTH_ERR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"ingroup\""
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evaluate_notinlist",
          "args": [
            "left",
            "right"
          ],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_notinlist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "205-209",
          "snippet": "static int\nevaluate_notinlist(const char *left, const char *right)\n{\n\treturn evaluate_inlist(left, right) != PAM_SUCCESS ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_notinlist(const char *left, const char *right)\n{\n\treturn evaluate_inlist(left, right) != PAM_SUCCESS ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"notin\""
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evaluate_inlist",
          "args": [
            "left",
            "right"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_inlist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "184-203",
          "snippet": "static int\nevaluate_inlist(const char *left, const char *right)\n{\n\tchar *p;\n\t/* Don't care about left containing ':'. */\n\twhile ((p=strstr(right, left)) != NULL) {\n\t\tif (p == right || *(p-1) == ':') { /* ':' is a list separator */\n\t\t\tp += strlen(left);\n\t\t\tif (*p == '\\0' || *p == ':') {\n\t\t\t\treturn PAM_SUCCESS;\n\t\t\t}\n\t\t}\n\t\tright = strchr(p, ':');\n\t\tif (right == NULL)\n\t\t\tbreak;\n\t\telse\n\t\t\t++right;\n\t}\n\treturn PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_inlist(const char *left, const char *right)\n{\n\tchar *p;\n\t/* Don't care about left containing ':'. */\n\twhile ((p=strstr(right, left)) != NULL) {\n\t\tif (p == right || *(p-1) == ':') { /* ':' is a list separator */\n\t\t\tp += strlen(left);\n\t\t\tif (*p == '\\0' || *p == ':') {\n\t\t\t\treturn PAM_SUCCESS;\n\t\t\t}\n\t\t}\n\t\tright = strchr(p, ':');\n\t\tif (right == NULL)\n\t\t\tbreak;\n\t\telse\n\t\t\t++right;\n\t}\n\treturn PAM_AUTH_ERR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"in\""
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evaluate_noglob",
          "args": [
            "left",
            "right"
          ],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_noglob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "178-182",
          "snippet": "static int\nevaluate_noglob(const char *left, const char *right)\n{\n\treturn (fnmatch(right, left, 0) != 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_noglob(const char *left, const char *right)\n{\n\treturn (fnmatch(right, left, 0) != 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"noglob\""
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"!~\""
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evaluate_glob",
          "args": [
            "left",
            "right"
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_glob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "172-176",
          "snippet": "static int\nevaluate_glob(const char *left, const char *right)\n{\n\treturn (fnmatch(right, left, 0) == 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_glob(const char *left, const char *right)\n{\n\treturn (fnmatch(right, left, 0) == 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"glob\""
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"=~\""
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evaluate_nes",
          "args": [
            "left",
            "right"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_nes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "142-146",
          "snippet": "static int\nevaluate_nes(const char *left, const char *right)\n{\n\treturn (strcmp(left, right) != 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_nes(const char *left, const char *right)\n{\n\treturn (strcmp(left, right) != 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"!=\""
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evaluate_nen",
          "args": [
            "pamh",
            "left",
            "right"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_nen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "136-140",
          "snippet": "static int\nevaluate_nen(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, ne);\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_nen(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, ne);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"ne\""
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evaluate_eqs",
          "args": [
            "left",
            "right"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_eqs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "130-134",
          "snippet": "static int\nevaluate_eqs(const char *left, const char *right)\n{\n\treturn (strcmp(left, right) == 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_eqs(const char *left, const char *right)\n{\n\treturn (strcmp(left, right) == 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"=\""
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evaluate_eqn",
          "args": [
            "pamh",
            "left",
            "right"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_eqn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "124-128",
          "snippet": "static int\nevaluate_eqn(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, eq);\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_eqn(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, eq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"eq\""
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evaluate_ge",
          "args": [
            "pamh",
            "left",
            "right"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_ge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "166-170",
          "snippet": "static int\nevaluate_ge(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, ge);\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_ge(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, ge);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"ge\""
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\">=\""
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evaluate_gt",
          "args": [
            "pamh",
            "left",
            "right"
          ],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_gt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "160-164",
          "snippet": "static int\nevaluate_gt(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, gt);\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_gt(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, gt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"gt\""
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\">\""
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evaluate_le",
          "args": [
            "pamh",
            "left",
            "right"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_le",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "154-158",
          "snippet": "static int\nevaluate_le(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, le);\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_le(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, le);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"le\""
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"<=\""
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evaluate_lt",
          "args": [
            "pamh",
            "left",
            "right"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_lt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "148-152",
          "snippet": "static int\nevaluate_lt(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, lt);\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_lt(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, lt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"lt\""
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "qual",
            "\"<\""
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_syslog",
          "args": [
            "pamh",
            "LOG_DEBUG",
            "\"'%s' resolves to '%s'\"",
            "attribute",
            "left"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_syslog",
          "args": [
            "pamh",
            "LOG_ERR",
            "\"unknown attribute \\\"%s\\\"\"",
            "left"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"%s\"",
            "(const char *)tty"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_get_item",
          "args": [
            "pamh",
            "PAM_TTY",
            "&tty"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"tty\""
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"%s\"",
            "(const char *)rhost"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_get_item",
          "args": [
            "pamh",
            "PAM_RHOST",
            "&rhost"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"rhost\""
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"%s\"",
            "(const char *)ruser"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_get_item",
          "args": [
            "pamh",
            "PAM_RUSER",
            "&ruser"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"ruser\""
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"%s\"",
            "(const char *)svc"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_get_item",
          "args": [
            "pamh",
            "PAM_SERVICE",
            "&svc"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"service\""
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"%s\"",
            "(*pwd)->pw_dir"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"homedir\""
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"dir\""
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"home\""
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"%s\"",
            "(*pwd)->pw_shell"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"shell\""
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"%lu\"",
            "(unsigned long) (*pwd)->pw_gid"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"gid\""
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"%lu\"",
            "(unsigned long) (*pwd)->pw_uid"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"uid\""
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_modutil_getpwnam",
          "args": [
            "pamh",
            "user"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"homedir\""
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"dir\""
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"home\""
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"shell\""
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"gid\""
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"uid\""
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"%s\"",
            "user"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"user\""
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"name\""
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "left",
            "\"login\""
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate(pam_handle_t *pamh, int debug,\n\t const char *left, const char *qual, const char *right,\n\t struct passwd **pwd, const char *user)\n{\n\tchar buf[LINE_MAX] = \"\";\n\tconst char *attribute = left;\n\t/* Figure out what we're evaluating here, and convert it to a string.*/\n\tif ((strcasecmp(left, \"login\") == 0) ||\n\t    (strcasecmp(left, \"name\") == 0) ||\n\t    (strcasecmp(left, \"user\") == 0)) {\n\t\tsnprintf(buf, sizeof(buf), \"%s\", user);\n\t\tleft = buf;\n\t}\n\t/* Get information about the user if needed. */\n\tif ((*pwd == NULL) &&\n\t    ((strcasecmp(left, \"uid\") == 0) ||\n\t     (strcasecmp(left, \"gid\") == 0) ||\n\t     (strcasecmp(left, \"shell\") == 0) ||\n\t     (strcasecmp(left, \"home\") == 0) ||\n\t     (strcasecmp(left, \"dir\") == 0) ||\n\t     (strcasecmp(left, \"homedir\") == 0))) {\n\t\t*pwd = pam_modutil_getpwnam(pamh, user);\n\t\tif (*pwd == NULL) {\n\t\t\treturn PAM_USER_UNKNOWN;\n\t\t}\n\t}\n\tif (strcasecmp(left, \"uid\") == 0) {\n\t\tsnprintf(buf, sizeof(buf), \"%lu\", (unsigned long) (*pwd)->pw_uid);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"gid\") == 0) {\n\t\tsnprintf(buf, sizeof(buf), \"%lu\", (unsigned long) (*pwd)->pw_gid);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"shell\") == 0) {\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (*pwd)->pw_shell);\n\t\tleft = buf;\n\t}\n\tif ((strcasecmp(left, \"home\") == 0) ||\n\t    (strcasecmp(left, \"dir\") == 0) ||\n\t    (strcasecmp(left, \"homedir\") == 0)) {\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (*pwd)->pw_dir);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"service\") == 0) {\n\t\tconst void *svc;\n\t\tif (pam_get_item(pamh, PAM_SERVICE, &svc) != PAM_SUCCESS ||\n\t\t\tsvc == NULL)\n\t\t\tsvc = \"\";\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (const char *)svc);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"ruser\") == 0) {\n\t\tconst void *ruser;\n\t\tif (pam_get_item(pamh, PAM_RUSER, &ruser) != PAM_SUCCESS ||\n\t\t\truser == NULL)\n\t\t\truser = \"\";\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (const char *)ruser);\n\t\tleft = buf;\n\t\tuser = buf;\n\t}\n\tif (strcasecmp(left, \"rhost\") == 0) {\n\t\tconst void *rhost;\n\t\tif (pam_get_item(pamh, PAM_RHOST, &rhost) != PAM_SUCCESS ||\n\t\t\trhost == NULL)\n\t\t\trhost = \"\";\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (const char *)rhost);\n\t\tleft = buf;\n\t}\n\tif (strcasecmp(left, \"tty\") == 0) {\n\t\tconst void *tty;\n\t\tif (pam_get_item(pamh, PAM_TTY, &tty) != PAM_SUCCESS ||\n\t\t\ttty == NULL)\n\t\t\ttty = \"\";\n\t\tsnprintf(buf, sizeof(buf), \"%s\", (const char *)tty);\n\t\tleft = buf;\n\t}\n\t/* If we have no idea what's going on, return an error. */\n\tif (left != buf) {\n\t\tpam_syslog(pamh, LOG_ERR, \"unknown attribute \\\"%s\\\"\", left);\n\t\treturn PAM_SERVICE_ERR;\n\t}\n\tif (debug) {\n\t\tpam_syslog(pamh, LOG_DEBUG, \"'%s' resolves to '%s'\",\n\t\t\t   attribute, left);\n\t}\n\n\t/* Attribute value < some threshold. */\n\tif ((strcasecmp(qual, \"<\") == 0) ||\n\t    (strcasecmp(qual, \"lt\") == 0)) {\n\t\treturn evaluate_lt(pamh, left, right);\n\t}\n\t/* Attribute value <= some threshold. */\n\tif ((strcasecmp(qual, \"<=\") == 0) ||\n\t    (strcasecmp(qual, \"le\") == 0)) {\n\t\treturn evaluate_le(pamh, left, right);\n\t}\n\t/* Attribute value > some threshold. */\n\tif ((strcasecmp(qual, \">\") == 0) ||\n\t    (strcasecmp(qual, \"gt\") == 0)) {\n\t\treturn evaluate_gt(pamh, left, right);\n\t}\n\t/* Attribute value >= some threshold. */\n\tif ((strcasecmp(qual, \">=\") == 0) ||\n\t    (strcasecmp(qual, \"ge\") == 0)) {\n\t\treturn evaluate_ge(pamh, left, right);\n\t}\n\t/* Attribute value == some threshold. */\n\tif (strcasecmp(qual, \"eq\") == 0) {\n\t\treturn evaluate_eqn(pamh, left, right);\n\t}\n\t/* Attribute value = some string. */\n\tif (strcasecmp(qual, \"=\") == 0) {\n\t\treturn evaluate_eqs(left, right);\n\t}\n\t/* Attribute value != some threshold. */\n\tif (strcasecmp(qual, \"ne\") == 0) {\n\t\treturn evaluate_nen(pamh, left, right);\n\t}\n\t/* Attribute value != some string. */\n\tif (strcasecmp(qual, \"!=\") == 0) {\n\t\treturn evaluate_nes(left, right);\n\t}\n\t/* Attribute value matches some pattern. */\n\tif ((strcasecmp(qual, \"=~\") == 0) ||\n\t    (strcasecmp(qual, \"glob\") == 0)) {\n\t\treturn evaluate_glob(left, right);\n\t}\n\tif ((strcasecmp(qual, \"!~\") == 0) ||\n\t    (strcasecmp(qual, \"noglob\") == 0)) {\n\t\treturn evaluate_noglob(left, right);\n\t}\n\t/* Attribute value matches item in list. */\n\tif (strcasecmp(qual, \"in\") == 0) {\n\t\treturn evaluate_inlist(left, right);\n\t}\n\tif (strcasecmp(qual, \"notin\") == 0) {\n\t\treturn evaluate_notinlist(left, right);\n\t}\n\t/* User is in this group(s). */\n\tif (strcasecmp(qual, \"ingroup\") == 0) {\n\t\treturn evaluate_ingroup(pamh, user, right);\n\t}\n\t/* User is not in this group(s). */\n\tif (strcasecmp(qual, \"notingroup\") == 0) {\n\t\treturn evaluate_notingroup(pamh, user, right);\n\t}\n\t/* (Rhost, user) is in this netgroup. */\n\tif (strcasecmp(qual, \"innetgr\") == 0) {\n\t\tconst void *rhost;\n\t\tif (pam_get_item(pamh, PAM_RHOST, &rhost) != PAM_SUCCESS)\n\t\t\trhost = NULL;\n\t\treturn evaluate_innetgr(pamh, rhost, user, right);\n\t}\n\t/* (Rhost, user) is not in this group. */\n\tif (strcasecmp(qual, \"notinnetgr\") == 0) {\n\t\tconst void *rhost;\n\t\tif (pam_get_item(pamh, PAM_RHOST, &rhost) != PAM_SUCCESS)\n\t\t\trhost = NULL;\n\t\treturn evaluate_notinnetgr(pamh, rhost, user, right);\n\t}\n\t/* Fail closed. */\n\treturn PAM_SERVICE_ERR;\n}"
  },
  {
    "function_name": "evaluate_notinnetgr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "277-287",
    "snippet": "static int\nevaluate_notinnetgr(const pam_handle_t* pamh SOMETIMES_UNUSED, const char *host, const char *user, const char *group)\n{\n#ifdef HAVE_INNETGR\n\tif (innetgr(group, host, user, NULL) == 0)\n\t\treturn PAM_SUCCESS;\n#else\n\tpam_syslog (pamh, LOG_ERR, \"pam_succeed_if does not have netgroup support\");\n#endif\n\treturn PAM_AUTH_ERR;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pam_syslog",
          "args": [
            "pamh",
            "LOG_ERR",
            "\"pam_succeed_if does not have netgroup support\""
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "innetgr",
          "args": [
            "group",
            "host",
            "user",
            "NULL"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_notinnetgr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "277-287",
          "snippet": "static int\nevaluate_notinnetgr(const pam_handle_t* pamh SOMETIMES_UNUSED, const char *host, const char *user, const char *group)\n{\n#ifdef HAVE_INNETGR\n\tif (innetgr(group, host, user, NULL) == 0)\n\t\treturn PAM_SUCCESS;\n#else\n\tpam_syslog (pamh, LOG_ERR, \"pam_succeed_if does not have netgroup support\");\n#endif\n\treturn PAM_AUTH_ERR;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_notinnetgr(const pam_handle_t* pamh SOMETIMES_UNUSED, const char *host, const char *user, const char *group)\n{\n#ifdef HAVE_INNETGR\n\tif (innetgr(group, host, user, NULL) == 0)\n\t\treturn PAM_SUCCESS;\n#else\n\tpam_syslog (pamh, LOG_ERR, \"pam_succeed_if does not have netgroup support\");\n#endif\n\treturn PAM_AUTH_ERR;\n}"
  },
  {
    "function_name": "evaluate_innetgr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "264-275",
    "snippet": "static int\nevaluate_innetgr(const pam_handle_t* pamh SOMETIMES_UNUSED, const char *host, const char *user, const char *group)\n{\n#ifdef HAVE_INNETGR\n\tif (innetgr(group, host, user, NULL) == 1)\n\t\treturn PAM_SUCCESS;\n#else\n\tpam_syslog (pamh, LOG_ERR, \"pam_succeed_if does not have netgroup support\");\n#endif\n\n\treturn PAM_AUTH_ERR;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pam_syslog",
          "args": [
            "pamh",
            "LOG_ERR",
            "\"pam_succeed_if does not have netgroup support\""
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "innetgr",
          "args": [
            "group",
            "host",
            "user",
            "NULL"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_notinnetgr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "277-287",
          "snippet": "static int\nevaluate_notinnetgr(const pam_handle_t* pamh SOMETIMES_UNUSED, const char *host, const char *user, const char *group)\n{\n#ifdef HAVE_INNETGR\n\tif (innetgr(group, host, user, NULL) == 0)\n\t\treturn PAM_SUCCESS;\n#else\n\tpam_syslog (pamh, LOG_ERR, \"pam_succeed_if does not have netgroup support\");\n#endif\n\treturn PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_notinnetgr(const pam_handle_t* pamh SOMETIMES_UNUSED, const char *host, const char *user, const char *group)\n{\n#ifdef HAVE_INNETGR\n\tif (innetgr(group, host, user, NULL) == 0)\n\t\treturn PAM_SUCCESS;\n#else\n\tpam_syslog (pamh, LOG_ERR, \"pam_succeed_if does not have netgroup support\");\n#endif\n\treturn PAM_AUTH_ERR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_innetgr(const pam_handle_t* pamh SOMETIMES_UNUSED, const char *host, const char *user, const char *group)\n{\n#ifdef HAVE_INNETGR\n\tif (innetgr(group, host, user, NULL) == 1)\n\t\treturn PAM_SUCCESS;\n#else\n\tpam_syslog (pamh, LOG_ERR, \"pam_succeed_if does not have netgroup support\");\n#endif\n\n\treturn PAM_AUTH_ERR;\n}"
  },
  {
    "function_name": "evaluate_notingroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "234-255",
    "snippet": "static int\nevaluate_notingroup(pam_handle_t *pamh, const char *user, const char *grouplist)\n{\n\tchar *ptr = NULL;\n\tstatic const char delim[] = \":\";\n\tchar const *grp = NULL;\n\tchar *group = strdup(grouplist);\n\n\tif (group == NULL)\n\t\treturn PAM_BUF_ERR;\n\n\tgrp = strtok_r(group, delim, &ptr);\n\twhile(grp != NULL) {\n\t\tif (pam_modutil_user_in_group_nam_nam(pamh, user, grp) == 1) {\n\t\t\tfree(group);\n\t\t\treturn PAM_AUTH_ERR;\n\t\t}\n\t\tgrp = strtok_r(NULL, delim, &ptr);\n\t}\n\tfree(group);\n\treturn PAM_SUCCESS;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "group"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "free_module_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_selinux/pam_selinux.c",
          "lines": "386-398",
          "snippet": "static void\nfree_module_data(module_data_t *data)\n{\n  free(data->tty_path);\n  freecon(data->prev_tty_context);\n  freecon(data->tty_context);\n  freecon(data->default_user_context);\n  freecon(data->prev_exec_context);\n  if (data->exec_context != data->default_user_context)\n    freecon(data->exec_context);\n  memset(data, 0, sizeof(*data));\n  free(data);\n}",
          "includes": [
            "#include <sys/select.h>",
            "#include <libaudit.h>",
            "#include <selinux/get_default_type.h>",
            "#include <selinux/context.h>",
            "#include <selinux/get_context_list.h>",
            "#include <selinux/selinux.h>",
            "#include \"pam_inline.h\"",
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/_pam_macros.h>",
            "#include <security/pam_modules.h>",
            "#include <syslog.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/select.h>\n#include <libaudit.h>\n#include <selinux/get_default_type.h>\n#include <selinux/context.h>\n#include <selinux/get_context_list.h>\n#include <selinux/selinux.h>\n#include \"pam_inline.h\"\n#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <syslog.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <limits.h>\n#include <errno.h>\n#include \"config.h\"\n\nstatic void\nfree_module_data(module_data_t *data)\n{\n  free(data->tty_path);\n  freecon(data->prev_tty_context);\n  freecon(data->tty_context);\n  freecon(data->default_user_context);\n  freecon(data->prev_exec_context);\n  if (data->exec_context != data->default_user_context)\n    freecon(data->exec_context);\n  memset(data, 0, sizeof(*data));\n  free(data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "NULL",
            "delim",
            "&ptr"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_modutil_user_in_group_nam_nam",
          "args": [
            "pamh",
            "user",
            "grp"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "group",
            "delim",
            "&ptr"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "grouplist"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_notingroup(pam_handle_t *pamh, const char *user, const char *grouplist)\n{\n\tchar *ptr = NULL;\n\tstatic const char delim[] = \":\";\n\tchar const *grp = NULL;\n\tchar *group = strdup(grouplist);\n\n\tif (group == NULL)\n\t\treturn PAM_BUF_ERR;\n\n\tgrp = strtok_r(group, delim, &ptr);\n\twhile(grp != NULL) {\n\t\tif (pam_modutil_user_in_group_nam_nam(pamh, user, grp) == 1) {\n\t\t\tfree(group);\n\t\t\treturn PAM_AUTH_ERR;\n\t\t}\n\t\tgrp = strtok_r(NULL, delim, &ptr);\n\t}\n\tfree(group);\n\treturn PAM_SUCCESS;\n}"
  },
  {
    "function_name": "evaluate_ingroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "211-232",
    "snippet": "static int\nevaluate_ingroup(pam_handle_t *pamh, const char *user, const char *grouplist)\n{\n\tchar *ptr = NULL;\n\tstatic const char delim[] = \":\";\n\tchar const *grp = NULL;\n\tchar *group = strdup(grouplist);\n\n\tif (group == NULL)\n\t\treturn PAM_BUF_ERR;\n\n\tgrp = strtok_r(group, delim, &ptr);\n\twhile(grp != NULL) {\n\t\tif (pam_modutil_user_in_group_nam_nam(pamh, user, grp) == 1) {\n\t\t\tfree(group);\n\t\t\treturn PAM_SUCCESS;\n\t\t}\n\t\tgrp = strtok_r(NULL, delim, &ptr);\n\t}\n\tfree(group);\n\treturn PAM_AUTH_ERR;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "group"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "free_module_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_selinux/pam_selinux.c",
          "lines": "386-398",
          "snippet": "static void\nfree_module_data(module_data_t *data)\n{\n  free(data->tty_path);\n  freecon(data->prev_tty_context);\n  freecon(data->tty_context);\n  freecon(data->default_user_context);\n  freecon(data->prev_exec_context);\n  if (data->exec_context != data->default_user_context)\n    freecon(data->exec_context);\n  memset(data, 0, sizeof(*data));\n  free(data);\n}",
          "includes": [
            "#include <sys/select.h>",
            "#include <libaudit.h>",
            "#include <selinux/get_default_type.h>",
            "#include <selinux/context.h>",
            "#include <selinux/get_context_list.h>",
            "#include <selinux/selinux.h>",
            "#include \"pam_inline.h\"",
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/_pam_macros.h>",
            "#include <security/pam_modules.h>",
            "#include <syslog.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/select.h>\n#include <libaudit.h>\n#include <selinux/get_default_type.h>\n#include <selinux/context.h>\n#include <selinux/get_context_list.h>\n#include <selinux/selinux.h>\n#include \"pam_inline.h\"\n#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <syslog.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <limits.h>\n#include <errno.h>\n#include \"config.h\"\n\nstatic void\nfree_module_data(module_data_t *data)\n{\n  free(data->tty_path);\n  freecon(data->prev_tty_context);\n  freecon(data->tty_context);\n  freecon(data->default_user_context);\n  freecon(data->prev_exec_context);\n  if (data->exec_context != data->default_user_context)\n    freecon(data->exec_context);\n  memset(data, 0, sizeof(*data));\n  free(data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "NULL",
            "delim",
            "&ptr"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_modutil_user_in_group_nam_nam",
          "args": [
            "pamh",
            "user",
            "grp"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "group",
            "delim",
            "&ptr"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "grouplist"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_ingroup(pam_handle_t *pamh, const char *user, const char *grouplist)\n{\n\tchar *ptr = NULL;\n\tstatic const char delim[] = \":\";\n\tchar const *grp = NULL;\n\tchar *group = strdup(grouplist);\n\n\tif (group == NULL)\n\t\treturn PAM_BUF_ERR;\n\n\tgrp = strtok_r(group, delim, &ptr);\n\twhile(grp != NULL) {\n\t\tif (pam_modutil_user_in_group_nam_nam(pamh, user, grp) == 1) {\n\t\t\tfree(group);\n\t\t\treturn PAM_SUCCESS;\n\t\t}\n\t\tgrp = strtok_r(NULL, delim, &ptr);\n\t}\n\tfree(group);\n\treturn PAM_AUTH_ERR;\n}"
  },
  {
    "function_name": "evaluate_notinlist",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "205-209",
    "snippet": "static int\nevaluate_notinlist(const char *left, const char *right)\n{\n\treturn evaluate_inlist(left, right) != PAM_SUCCESS ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "evaluate_inlist",
          "args": [
            "left",
            "right"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_inlist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "184-203",
          "snippet": "static int\nevaluate_inlist(const char *left, const char *right)\n{\n\tchar *p;\n\t/* Don't care about left containing ':'. */\n\twhile ((p=strstr(right, left)) != NULL) {\n\t\tif (p == right || *(p-1) == ':') { /* ':' is a list separator */\n\t\t\tp += strlen(left);\n\t\t\tif (*p == '\\0' || *p == ':') {\n\t\t\t\treturn PAM_SUCCESS;\n\t\t\t}\n\t\t}\n\t\tright = strchr(p, ':');\n\t\tif (right == NULL)\n\t\t\tbreak;\n\t\telse\n\t\t\t++right;\n\t}\n\treturn PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_inlist(const char *left, const char *right)\n{\n\tchar *p;\n\t/* Don't care about left containing ':'. */\n\twhile ((p=strstr(right, left)) != NULL) {\n\t\tif (p == right || *(p-1) == ':') { /* ':' is a list separator */\n\t\t\tp += strlen(left);\n\t\t\tif (*p == '\\0' || *p == ':') {\n\t\t\t\treturn PAM_SUCCESS;\n\t\t\t}\n\t\t}\n\t\tright = strchr(p, ':');\n\t\tif (right == NULL)\n\t\t\tbreak;\n\t\telse\n\t\t\t++right;\n\t}\n\treturn PAM_AUTH_ERR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_notinlist(const char *left, const char *right)\n{\n\treturn evaluate_inlist(left, right) != PAM_SUCCESS ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
  },
  {
    "function_name": "evaluate_inlist",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "184-203",
    "snippet": "static int\nevaluate_inlist(const char *left, const char *right)\n{\n\tchar *p;\n\t/* Don't care about left containing ':'. */\n\twhile ((p=strstr(right, left)) != NULL) {\n\t\tif (p == right || *(p-1) == ':') { /* ':' is a list separator */\n\t\t\tp += strlen(left);\n\t\t\tif (*p == '\\0' || *p == ':') {\n\t\t\t\treturn PAM_SUCCESS;\n\t\t\t}\n\t\t}\n\t\tright = strchr(p, ':');\n\t\tif (right == NULL)\n\t\t\tbreak;\n\t\telse\n\t\t\t++right;\n\t}\n\treturn PAM_AUTH_ERR;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "p",
            "':'"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "left"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "right",
            "left"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_inlist(const char *left, const char *right)\n{\n\tchar *p;\n\t/* Don't care about left containing ':'. */\n\twhile ((p=strstr(right, left)) != NULL) {\n\t\tif (p == right || *(p-1) == ':') { /* ':' is a list separator */\n\t\t\tp += strlen(left);\n\t\t\tif (*p == '\\0' || *p == ':') {\n\t\t\t\treturn PAM_SUCCESS;\n\t\t\t}\n\t\t}\n\t\tright = strchr(p, ':');\n\t\tif (right == NULL)\n\t\t\tbreak;\n\t\telse\n\t\t\t++right;\n\t}\n\treturn PAM_AUTH_ERR;\n}"
  },
  {
    "function_name": "evaluate_noglob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "178-182",
    "snippet": "static int\nevaluate_noglob(const char *left, const char *right)\n{\n\treturn (fnmatch(right, left, 0) != 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fnmatch",
          "args": [
            "right",
            "left",
            "0"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_noglob(const char *left, const char *right)\n{\n\treturn (fnmatch(right, left, 0) != 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
  },
  {
    "function_name": "evaluate_glob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "172-176",
    "snippet": "static int\nevaluate_glob(const char *left, const char *right)\n{\n\treturn (fnmatch(right, left, 0) == 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fnmatch",
          "args": [
            "right",
            "left",
            "0"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_glob(const char *left, const char *right)\n{\n\treturn (fnmatch(right, left, 0) == 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
  },
  {
    "function_name": "evaluate_ge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "166-170",
    "snippet": "static int\nevaluate_ge(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, ge);\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "evaluate_num",
          "args": [
            "pamh",
            "left",
            "right",
            "ge"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_num",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "63-89",
          "snippet": "static int\nevaluate_num(const pam_handle_t *pamh, const char *left,\n\t     const char *right, int (*cmp)(long long, long long))\n{\n\tlong long l, r;\n\tchar *p;\n\tint ret = PAM_SUCCESS;\n\n\terrno = 0;\n\tl = strtoll(left, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", left);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tr = strtoll(right, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", right);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tif (ret != PAM_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\treturn cmp(l, r) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_num(const pam_handle_t *pamh, const char *left,\n\t     const char *right, int (*cmp)(long long, long long))\n{\n\tlong long l, r;\n\tchar *p;\n\tint ret = PAM_SUCCESS;\n\n\terrno = 0;\n\tl = strtoll(left, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", left);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tr = strtoll(right, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", right);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tif (ret != PAM_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\treturn cmp(l, r) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_ge(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, ge);\n}"
  },
  {
    "function_name": "evaluate_gt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "160-164",
    "snippet": "static int\nevaluate_gt(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, gt);\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "evaluate_num",
          "args": [
            "pamh",
            "left",
            "right",
            "gt"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_num",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "63-89",
          "snippet": "static int\nevaluate_num(const pam_handle_t *pamh, const char *left,\n\t     const char *right, int (*cmp)(long long, long long))\n{\n\tlong long l, r;\n\tchar *p;\n\tint ret = PAM_SUCCESS;\n\n\terrno = 0;\n\tl = strtoll(left, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", left);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tr = strtoll(right, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", right);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tif (ret != PAM_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\treturn cmp(l, r) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_num(const pam_handle_t *pamh, const char *left,\n\t     const char *right, int (*cmp)(long long, long long))\n{\n\tlong long l, r;\n\tchar *p;\n\tint ret = PAM_SUCCESS;\n\n\terrno = 0;\n\tl = strtoll(left, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", left);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tr = strtoll(right, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", right);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tif (ret != PAM_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\treturn cmp(l, r) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_gt(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, gt);\n}"
  },
  {
    "function_name": "evaluate_le",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "154-158",
    "snippet": "static int\nevaluate_le(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, le);\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "evaluate_num",
          "args": [
            "pamh",
            "left",
            "right",
            "le"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_num",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "63-89",
          "snippet": "static int\nevaluate_num(const pam_handle_t *pamh, const char *left,\n\t     const char *right, int (*cmp)(long long, long long))\n{\n\tlong long l, r;\n\tchar *p;\n\tint ret = PAM_SUCCESS;\n\n\terrno = 0;\n\tl = strtoll(left, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", left);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tr = strtoll(right, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", right);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tif (ret != PAM_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\treturn cmp(l, r) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_num(const pam_handle_t *pamh, const char *left,\n\t     const char *right, int (*cmp)(long long, long long))\n{\n\tlong long l, r;\n\tchar *p;\n\tint ret = PAM_SUCCESS;\n\n\terrno = 0;\n\tl = strtoll(left, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", left);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tr = strtoll(right, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", right);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tif (ret != PAM_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\treturn cmp(l, r) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_le(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, le);\n}"
  },
  {
    "function_name": "evaluate_lt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "148-152",
    "snippet": "static int\nevaluate_lt(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, lt);\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "evaluate_num",
          "args": [
            "pamh",
            "left",
            "right",
            "lt"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_num",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "63-89",
          "snippet": "static int\nevaluate_num(const pam_handle_t *pamh, const char *left,\n\t     const char *right, int (*cmp)(long long, long long))\n{\n\tlong long l, r;\n\tchar *p;\n\tint ret = PAM_SUCCESS;\n\n\terrno = 0;\n\tl = strtoll(left, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", left);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tr = strtoll(right, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", right);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tif (ret != PAM_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\treturn cmp(l, r) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_num(const pam_handle_t *pamh, const char *left,\n\t     const char *right, int (*cmp)(long long, long long))\n{\n\tlong long l, r;\n\tchar *p;\n\tint ret = PAM_SUCCESS;\n\n\terrno = 0;\n\tl = strtoll(left, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", left);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tr = strtoll(right, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", right);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tif (ret != PAM_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\treturn cmp(l, r) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_lt(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, lt);\n}"
  },
  {
    "function_name": "evaluate_nes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "142-146",
    "snippet": "static int\nevaluate_nes(const char *left, const char *right)\n{\n\treturn (strcmp(left, right) != 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "left",
            "right"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_nes(const char *left, const char *right)\n{\n\treturn (strcmp(left, right) != 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
  },
  {
    "function_name": "evaluate_nen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "136-140",
    "snippet": "static int\nevaluate_nen(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, ne);\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "evaluate_num",
          "args": [
            "pamh",
            "left",
            "right",
            "ne"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_num",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "63-89",
          "snippet": "static int\nevaluate_num(const pam_handle_t *pamh, const char *left,\n\t     const char *right, int (*cmp)(long long, long long))\n{\n\tlong long l, r;\n\tchar *p;\n\tint ret = PAM_SUCCESS;\n\n\terrno = 0;\n\tl = strtoll(left, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", left);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tr = strtoll(right, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", right);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tif (ret != PAM_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\treturn cmp(l, r) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_num(const pam_handle_t *pamh, const char *left,\n\t     const char *right, int (*cmp)(long long, long long))\n{\n\tlong long l, r;\n\tchar *p;\n\tint ret = PAM_SUCCESS;\n\n\terrno = 0;\n\tl = strtoll(left, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", left);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tr = strtoll(right, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", right);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tif (ret != PAM_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\treturn cmp(l, r) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_nen(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, ne);\n}"
  },
  {
    "function_name": "evaluate_eqs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "130-134",
    "snippet": "static int\nevaluate_eqs(const char *left, const char *right)\n{\n\treturn (strcmp(left, right) == 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "left",
            "right"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_eqs(const char *left, const char *right)\n{\n\treturn (strcmp(left, right) == 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
  },
  {
    "function_name": "evaluate_eqn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "124-128",
    "snippet": "static int\nevaluate_eqn(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, eq);\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "evaluate_num",
          "args": [
            "pamh",
            "left",
            "right",
            "eq"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_num",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "63-89",
          "snippet": "static int\nevaluate_num(const pam_handle_t *pamh, const char *left,\n\t     const char *right, int (*cmp)(long long, long long))\n{\n\tlong long l, r;\n\tchar *p;\n\tint ret = PAM_SUCCESS;\n\n\terrno = 0;\n\tl = strtoll(left, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", left);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tr = strtoll(right, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", right);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tif (ret != PAM_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\treturn cmp(l, r) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_num(const pam_handle_t *pamh, const char *left,\n\t     const char *right, int (*cmp)(long long, long long))\n{\n\tlong long l, r;\n\tchar *p;\n\tint ret = PAM_SUCCESS;\n\n\terrno = 0;\n\tl = strtoll(left, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", left);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tr = strtoll(right, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", right);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tif (ret != PAM_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\treturn cmp(l, r) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_eqn(const pam_handle_t *pamh, const char *left, const char *right)\n{\n\treturn evaluate_num(pamh, left, right, eq);\n}"
  },
  {
    "function_name": "ge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "117-121",
    "snippet": "static int\nge(long long i, long long j)\n{\n\treturn gt(i, j) || eq(i, j);\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "eq",
          "args": [
            "i",
            "j"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_eqs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "130-134",
          "snippet": "static int\nevaluate_eqs(const char *left, const char *right)\n{\n\treturn (strcmp(left, right) == 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_eqs(const char *left, const char *right)\n{\n\treturn (strcmp(left, right) == 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gt",
          "args": [
            "i",
            "j"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "gt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "112-116",
          "snippet": "static int\ngt(long long i, long long j)\n{\n\treturn i > j;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\ngt(long long i, long long j)\n{\n\treturn i > j;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nge(long long i, long long j)\n{\n\treturn gt(i, j) || eq(i, j);\n}"
  },
  {
    "function_name": "gt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "112-116",
    "snippet": "static int\ngt(long long i, long long j)\n{\n\treturn i > j;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\ngt(long long i, long long j)\n{\n\treturn i > j;\n}"
  },
  {
    "function_name": "le",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "107-111",
    "snippet": "static int\nle(long long i, long long j)\n{\n\treturn lt(i, j) || eq(i, j);\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "eq",
          "args": [
            "i",
            "j"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "evaluate_eqs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "130-134",
          "snippet": "static int\nevaluate_eqs(const char *left, const char *right)\n{\n\treturn (strcmp(left, right) == 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_eqs(const char *left, const char *right)\n{\n\treturn (strcmp(left, right) == 0) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lt",
          "args": [
            "i",
            "j"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "lt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
          "lines": "102-106",
          "snippet": "static int\nlt(long long i, long long j)\n{\n\treturn i < j;\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/pam_modules.h>",
            "#include <netdb.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <fnmatch.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nlt(long long i, long long j)\n{\n\treturn i < j;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nle(long long i, long long j)\n{\n\treturn lt(i, j) || eq(i, j);\n}"
  },
  {
    "function_name": "lt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "102-106",
    "snippet": "static int\nlt(long long i, long long j)\n{\n\treturn i < j;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nlt(long long i, long long j)\n{\n\treturn i < j;\n}"
  },
  {
    "function_name": "ne",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "97-101",
    "snippet": "static int\nne(long long i, long long j)\n{\n\treturn i != j;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nne(long long i, long long j)\n{\n\treturn i != j;\n}"
  },
  {
    "function_name": "eq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "92-96",
    "snippet": "static int\neq(long long i, long long j)\n{\n\treturn i == j;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\neq(long long i, long long j)\n{\n\treturn i == j;\n}"
  },
  {
    "function_name": "evaluate_num",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_succeed_if/pam_succeed_if.c",
    "lines": "63-89",
    "snippet": "static int\nevaluate_num(const pam_handle_t *pamh, const char *left,\n\t     const char *right, int (*cmp)(long long, long long))\n{\n\tlong long l, r;\n\tchar *p;\n\tint ret = PAM_SUCCESS;\n\n\terrno = 0;\n\tl = strtoll(left, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", left);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tr = strtoll(right, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", right);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tif (ret != PAM_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\treturn cmp(l, r) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modutil.h>",
      "#include <security/pam_modules.h>",
      "#include <netdb.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <syslog.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <fnmatch.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cmp",
          "args": [
            "l",
            "r"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_syslog",
          "args": [
            "pamh",
            "LOG_INFO",
            "\"\\\"%s\\\" is not a number\"",
            "right"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoll",
          "args": [
            "right",
            "&p",
            "0"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_syslog",
          "args": [
            "pamh",
            "LOG_INFO",
            "\"\\\"%s\\\" is not a number\"",
            "left"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoll",
          "args": [
            "left",
            "&p",
            "0"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/pam_modules.h>\n#include <netdb.h>\n#include <grp.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <fnmatch.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nstatic int\nevaluate_num(const pam_handle_t *pamh, const char *left,\n\t     const char *right, int (*cmp)(long long, long long))\n{\n\tlong long l, r;\n\tchar *p;\n\tint ret = PAM_SUCCESS;\n\n\terrno = 0;\n\tl = strtoll(left, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", left);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tr = strtoll(right, &p, 0);\n\tif ((p == NULL) || (*p != '\\0') || errno) {\n\t\tpam_syslog(pamh, LOG_INFO, \"\\\"%s\\\" is not a number\", right);\n\t\tret = PAM_SERVICE_ERR;\n\t}\n\n\tif (ret != PAM_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\treturn cmp(l, r) ? PAM_SUCCESS : PAM_AUTH_ERR;\n}"
  }
]