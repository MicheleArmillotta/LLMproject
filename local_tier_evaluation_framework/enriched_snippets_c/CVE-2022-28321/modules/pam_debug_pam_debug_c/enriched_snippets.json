[
  {
    "function_name": "pam_sm_close_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_debug/pam_debug.c",
    "lines": "102-106",
    "snippet": "int pam_sm_close_session(pam_handle_t *pamh, int flags UNUSED,\n\t\t\t int argc, const char **argv)\n{\n    return parse_args(PAM_SUCCESS, \"close_session\", pamh, argc, argv);\n}",
    "includes": [
      "#include \"../../libpam/pam_tokens.h\"",
      "#include <security/pam_ext.h>",
      "#include <security/_pam_macros.h>",
      "#include <security/pam_modules.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parse_args",
          "args": [
            "PAM_SUCCESS",
            "\"close_session\"",
            "pamh",
            "argc",
            "argv"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "parse_args",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_debug/pam_debug.c",
          "lines": "37-60",
          "snippet": "static int parse_args(int retval, const char *event,\n\t\t      pam_handle_t *pamh, int argc, const char **argv)\n{\n    int i;\n\n    for (i=0; i<argc; ++i) {\n\tint length = strlen(event);\n\tif (!strncmp(event, argv[i], length) && (argv[i][length] == '=')) {\n\t    int j;\n\t    const char *return_string = argv[i] + (length+1);\n\n\t    for (j=0; j<_PAM_RETURN_VALUES; ++j) {\n\t\tif (!strcmp(return_string, _pam_token_returns[j])) {\n\t\t    retval = j;\n\t\t    state(pamh, argv[i]);\n\t\t    break;\n\t\t}\n\t    }\n\t    break;\n\t}\n    }\n\n    return retval;\n}",
          "includes": [
            "#include \"../../libpam/pam_tokens.h\"",
            "#include <security/pam_ext.h>",
            "#include <security/_pam_macros.h>",
            "#include <security/pam_modules.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../../libpam/pam_tokens.h\"\n#include <security/pam_ext.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic int parse_args(int retval, const char *event,\n\t\t      pam_handle_t *pamh, int argc, const char **argv)\n{\n    int i;\n\n    for (i=0; i<argc; ++i) {\n\tint length = strlen(event);\n\tif (!strncmp(event, argv[i], length) && (argv[i][length] == '=')) {\n\t    int j;\n\t    const char *return_string = argv[i] + (length+1);\n\n\t    for (j=0; j<_PAM_RETURN_VALUES; ++j) {\n\t\tif (!strcmp(return_string, _pam_token_returns[j])) {\n\t\t    retval = j;\n\t\t    state(pamh, argv[i]);\n\t\t    break;\n\t\t}\n\t    }\n\t    break;\n\t}\n    }\n\n    return retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../../libpam/pam_tokens.h\"\n#include <security/pam_ext.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint pam_sm_close_session(pam_handle_t *pamh, int flags UNUSED,\n\t\t\t int argc, const char **argv)\n{\n    return parse_args(PAM_SUCCESS, \"close_session\", pamh, argc, argv);\n}"
  },
  {
    "function_name": "pam_sm_open_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_debug/pam_debug.c",
    "lines": "96-100",
    "snippet": "int pam_sm_open_session(pam_handle_t *pamh, int flags UNUSED,\n\t\t\tint argc, const char **argv)\n{\n    return parse_args(PAM_SUCCESS, \"open_session\", pamh, argc, argv);\n}",
    "includes": [
      "#include \"../../libpam/pam_tokens.h\"",
      "#include <security/pam_ext.h>",
      "#include <security/_pam_macros.h>",
      "#include <security/pam_modules.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parse_args",
          "args": [
            "PAM_SUCCESS",
            "\"open_session\"",
            "pamh",
            "argc",
            "argv"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "parse_args",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_debug/pam_debug.c",
          "lines": "37-60",
          "snippet": "static int parse_args(int retval, const char *event,\n\t\t      pam_handle_t *pamh, int argc, const char **argv)\n{\n    int i;\n\n    for (i=0; i<argc; ++i) {\n\tint length = strlen(event);\n\tif (!strncmp(event, argv[i], length) && (argv[i][length] == '=')) {\n\t    int j;\n\t    const char *return_string = argv[i] + (length+1);\n\n\t    for (j=0; j<_PAM_RETURN_VALUES; ++j) {\n\t\tif (!strcmp(return_string, _pam_token_returns[j])) {\n\t\t    retval = j;\n\t\t    state(pamh, argv[i]);\n\t\t    break;\n\t\t}\n\t    }\n\t    break;\n\t}\n    }\n\n    return retval;\n}",
          "includes": [
            "#include \"../../libpam/pam_tokens.h\"",
            "#include <security/pam_ext.h>",
            "#include <security/_pam_macros.h>",
            "#include <security/pam_modules.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../../libpam/pam_tokens.h\"\n#include <security/pam_ext.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic int parse_args(int retval, const char *event,\n\t\t      pam_handle_t *pamh, int argc, const char **argv)\n{\n    int i;\n\n    for (i=0; i<argc; ++i) {\n\tint length = strlen(event);\n\tif (!strncmp(event, argv[i], length) && (argv[i][length] == '=')) {\n\t    int j;\n\t    const char *return_string = argv[i] + (length+1);\n\n\t    for (j=0; j<_PAM_RETURN_VALUES; ++j) {\n\t\tif (!strcmp(return_string, _pam_token_returns[j])) {\n\t\t    retval = j;\n\t\t    state(pamh, argv[i]);\n\t\t    break;\n\t\t}\n\t    }\n\t    break;\n\t}\n    }\n\n    return retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../../libpam/pam_tokens.h\"\n#include <security/pam_ext.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint pam_sm_open_session(pam_handle_t *pamh, int flags UNUSED,\n\t\t\tint argc, const char **argv)\n{\n    return parse_args(PAM_SUCCESS, \"open_session\", pamh, argc, argv);\n}"
  },
  {
    "function_name": "pam_sm_chauthtok",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_debug/pam_debug.c",
    "lines": "84-92",
    "snippet": "int pam_sm_chauthtok(pam_handle_t *pamh, int flags UNUSED,\n\t\t     int argc, const char **argv)\n{\n    if (flags & PAM_PRELIM_CHECK) {\n\treturn parse_args(PAM_SUCCESS, \"prechauthtok\", pamh, argc, argv);\n    } else {\n\treturn parse_args(PAM_SUCCESS, \"chauthtok\", pamh, argc, argv);\n    }\n}",
    "includes": [
      "#include \"../../libpam/pam_tokens.h\"",
      "#include <security/pam_ext.h>",
      "#include <security/_pam_macros.h>",
      "#include <security/pam_modules.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parse_args",
          "args": [
            "PAM_SUCCESS",
            "\"chauthtok\"",
            "pamh",
            "argc",
            "argv"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "parse_args",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_debug/pam_debug.c",
          "lines": "37-60",
          "snippet": "static int parse_args(int retval, const char *event,\n\t\t      pam_handle_t *pamh, int argc, const char **argv)\n{\n    int i;\n\n    for (i=0; i<argc; ++i) {\n\tint length = strlen(event);\n\tif (!strncmp(event, argv[i], length) && (argv[i][length] == '=')) {\n\t    int j;\n\t    const char *return_string = argv[i] + (length+1);\n\n\t    for (j=0; j<_PAM_RETURN_VALUES; ++j) {\n\t\tif (!strcmp(return_string, _pam_token_returns[j])) {\n\t\t    retval = j;\n\t\t    state(pamh, argv[i]);\n\t\t    break;\n\t\t}\n\t    }\n\t    break;\n\t}\n    }\n\n    return retval;\n}",
          "includes": [
            "#include \"../../libpam/pam_tokens.h\"",
            "#include <security/pam_ext.h>",
            "#include <security/_pam_macros.h>",
            "#include <security/pam_modules.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../../libpam/pam_tokens.h\"\n#include <security/pam_ext.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic int parse_args(int retval, const char *event,\n\t\t      pam_handle_t *pamh, int argc, const char **argv)\n{\n    int i;\n\n    for (i=0; i<argc; ++i) {\n\tint length = strlen(event);\n\tif (!strncmp(event, argv[i], length) && (argv[i][length] == '=')) {\n\t    int j;\n\t    const char *return_string = argv[i] + (length+1);\n\n\t    for (j=0; j<_PAM_RETURN_VALUES; ++j) {\n\t\tif (!strcmp(return_string, _pam_token_returns[j])) {\n\t\t    retval = j;\n\t\t    state(pamh, argv[i]);\n\t\t    break;\n\t\t}\n\t    }\n\t    break;\n\t}\n    }\n\n    return retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../../libpam/pam_tokens.h\"\n#include <security/pam_ext.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint pam_sm_chauthtok(pam_handle_t *pamh, int flags UNUSED,\n\t\t     int argc, const char **argv)\n{\n    if (flags & PAM_PRELIM_CHECK) {\n\treturn parse_args(PAM_SUCCESS, \"prechauthtok\", pamh, argc, argv);\n    } else {\n\treturn parse_args(PAM_SUCCESS, \"chauthtok\", pamh, argc, argv);\n    }\n}"
  },
  {
    "function_name": "pam_sm_acct_mgmt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_debug/pam_debug.c",
    "lines": "76-80",
    "snippet": "int pam_sm_acct_mgmt(pam_handle_t *pamh, int flags UNUSED,\n\t\t     int argc, const char **argv)\n{\n    return parse_args(PAM_SUCCESS, \"acct\", pamh, argc, argv);\n}",
    "includes": [
      "#include \"../../libpam/pam_tokens.h\"",
      "#include <security/pam_ext.h>",
      "#include <security/_pam_macros.h>",
      "#include <security/pam_modules.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parse_args",
          "args": [
            "PAM_SUCCESS",
            "\"acct\"",
            "pamh",
            "argc",
            "argv"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "parse_args",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_debug/pam_debug.c",
          "lines": "37-60",
          "snippet": "static int parse_args(int retval, const char *event,\n\t\t      pam_handle_t *pamh, int argc, const char **argv)\n{\n    int i;\n\n    for (i=0; i<argc; ++i) {\n\tint length = strlen(event);\n\tif (!strncmp(event, argv[i], length) && (argv[i][length] == '=')) {\n\t    int j;\n\t    const char *return_string = argv[i] + (length+1);\n\n\t    for (j=0; j<_PAM_RETURN_VALUES; ++j) {\n\t\tif (!strcmp(return_string, _pam_token_returns[j])) {\n\t\t    retval = j;\n\t\t    state(pamh, argv[i]);\n\t\t    break;\n\t\t}\n\t    }\n\t    break;\n\t}\n    }\n\n    return retval;\n}",
          "includes": [
            "#include \"../../libpam/pam_tokens.h\"",
            "#include <security/pam_ext.h>",
            "#include <security/_pam_macros.h>",
            "#include <security/pam_modules.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../../libpam/pam_tokens.h\"\n#include <security/pam_ext.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic int parse_args(int retval, const char *event,\n\t\t      pam_handle_t *pamh, int argc, const char **argv)\n{\n    int i;\n\n    for (i=0; i<argc; ++i) {\n\tint length = strlen(event);\n\tif (!strncmp(event, argv[i], length) && (argv[i][length] == '=')) {\n\t    int j;\n\t    const char *return_string = argv[i] + (length+1);\n\n\t    for (j=0; j<_PAM_RETURN_VALUES; ++j) {\n\t\tif (!strcmp(return_string, _pam_token_returns[j])) {\n\t\t    retval = j;\n\t\t    state(pamh, argv[i]);\n\t\t    break;\n\t\t}\n\t    }\n\t    break;\n\t}\n    }\n\n    return retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../../libpam/pam_tokens.h\"\n#include <security/pam_ext.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint pam_sm_acct_mgmt(pam_handle_t *pamh, int flags UNUSED,\n\t\t     int argc, const char **argv)\n{\n    return parse_args(PAM_SUCCESS, \"acct\", pamh, argc, argv);\n}"
  },
  {
    "function_name": "pam_sm_setcred",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_debug/pam_debug.c",
    "lines": "68-72",
    "snippet": "int pam_sm_setcred(pam_handle_t *pamh, int flags UNUSED,\n\t\t   int argc, const char **argv)\n{\n    return parse_args(PAM_SUCCESS, \"cred\", pamh, argc, argv);\n}",
    "includes": [
      "#include \"../../libpam/pam_tokens.h\"",
      "#include <security/pam_ext.h>",
      "#include <security/_pam_macros.h>",
      "#include <security/pam_modules.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parse_args",
          "args": [
            "PAM_SUCCESS",
            "\"cred\"",
            "pamh",
            "argc",
            "argv"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "parse_args",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_debug/pam_debug.c",
          "lines": "37-60",
          "snippet": "static int parse_args(int retval, const char *event,\n\t\t      pam_handle_t *pamh, int argc, const char **argv)\n{\n    int i;\n\n    for (i=0; i<argc; ++i) {\n\tint length = strlen(event);\n\tif (!strncmp(event, argv[i], length) && (argv[i][length] == '=')) {\n\t    int j;\n\t    const char *return_string = argv[i] + (length+1);\n\n\t    for (j=0; j<_PAM_RETURN_VALUES; ++j) {\n\t\tif (!strcmp(return_string, _pam_token_returns[j])) {\n\t\t    retval = j;\n\t\t    state(pamh, argv[i]);\n\t\t    break;\n\t\t}\n\t    }\n\t    break;\n\t}\n    }\n\n    return retval;\n}",
          "includes": [
            "#include \"../../libpam/pam_tokens.h\"",
            "#include <security/pam_ext.h>",
            "#include <security/_pam_macros.h>",
            "#include <security/pam_modules.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../../libpam/pam_tokens.h\"\n#include <security/pam_ext.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic int parse_args(int retval, const char *event,\n\t\t      pam_handle_t *pamh, int argc, const char **argv)\n{\n    int i;\n\n    for (i=0; i<argc; ++i) {\n\tint length = strlen(event);\n\tif (!strncmp(event, argv[i], length) && (argv[i][length] == '=')) {\n\t    int j;\n\t    const char *return_string = argv[i] + (length+1);\n\n\t    for (j=0; j<_PAM_RETURN_VALUES; ++j) {\n\t\tif (!strcmp(return_string, _pam_token_returns[j])) {\n\t\t    retval = j;\n\t\t    state(pamh, argv[i]);\n\t\t    break;\n\t\t}\n\t    }\n\t    break;\n\t}\n    }\n\n    return retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../../libpam/pam_tokens.h\"\n#include <security/pam_ext.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint pam_sm_setcred(pam_handle_t *pamh, int flags UNUSED,\n\t\t   int argc, const char **argv)\n{\n    return parse_args(PAM_SUCCESS, \"cred\", pamh, argc, argv);\n}"
  },
  {
    "function_name": "pam_sm_authenticate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_debug/pam_debug.c",
    "lines": "62-66",
    "snippet": "int pam_sm_authenticate(pam_handle_t *pamh, int flags UNUSED,\n\t\t\tint argc, const char **argv)\n{\n    return parse_args(PAM_SUCCESS, \"auth\", pamh, argc, argv);\n}",
    "includes": [
      "#include \"../../libpam/pam_tokens.h\"",
      "#include <security/pam_ext.h>",
      "#include <security/_pam_macros.h>",
      "#include <security/pam_modules.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parse_args",
          "args": [
            "PAM_SUCCESS",
            "\"auth\"",
            "pamh",
            "argc",
            "argv"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "parse_args",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_debug/pam_debug.c",
          "lines": "37-60",
          "snippet": "static int parse_args(int retval, const char *event,\n\t\t      pam_handle_t *pamh, int argc, const char **argv)\n{\n    int i;\n\n    for (i=0; i<argc; ++i) {\n\tint length = strlen(event);\n\tif (!strncmp(event, argv[i], length) && (argv[i][length] == '=')) {\n\t    int j;\n\t    const char *return_string = argv[i] + (length+1);\n\n\t    for (j=0; j<_PAM_RETURN_VALUES; ++j) {\n\t\tif (!strcmp(return_string, _pam_token_returns[j])) {\n\t\t    retval = j;\n\t\t    state(pamh, argv[i]);\n\t\t    break;\n\t\t}\n\t    }\n\t    break;\n\t}\n    }\n\n    return retval;\n}",
          "includes": [
            "#include \"../../libpam/pam_tokens.h\"",
            "#include <security/pam_ext.h>",
            "#include <security/_pam_macros.h>",
            "#include <security/pam_modules.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../../libpam/pam_tokens.h\"\n#include <security/pam_ext.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic int parse_args(int retval, const char *event,\n\t\t      pam_handle_t *pamh, int argc, const char **argv)\n{\n    int i;\n\n    for (i=0; i<argc; ++i) {\n\tint length = strlen(event);\n\tif (!strncmp(event, argv[i], length) && (argv[i][length] == '=')) {\n\t    int j;\n\t    const char *return_string = argv[i] + (length+1);\n\n\t    for (j=0; j<_PAM_RETURN_VALUES; ++j) {\n\t\tif (!strcmp(return_string, _pam_token_returns[j])) {\n\t\t    retval = j;\n\t\t    state(pamh, argv[i]);\n\t\t    break;\n\t\t}\n\t    }\n\t    break;\n\t}\n    }\n\n    return retval;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../../libpam/pam_tokens.h\"\n#include <security/pam_ext.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint pam_sm_authenticate(pam_handle_t *pamh, int flags UNUSED,\n\t\t\tint argc, const char **argv)\n{\n    return parse_args(PAM_SUCCESS, \"auth\", pamh, argc, argv);\n}"
  },
  {
    "function_name": "parse_args",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_debug/pam_debug.c",
    "lines": "37-60",
    "snippet": "static int parse_args(int retval, const char *event,\n\t\t      pam_handle_t *pamh, int argc, const char **argv)\n{\n    int i;\n\n    for (i=0; i<argc; ++i) {\n\tint length = strlen(event);\n\tif (!strncmp(event, argv[i], length) && (argv[i][length] == '=')) {\n\t    int j;\n\t    const char *return_string = argv[i] + (length+1);\n\n\t    for (j=0; j<_PAM_RETURN_VALUES; ++j) {\n\t\tif (!strcmp(return_string, _pam_token_returns[j])) {\n\t\t    retval = j;\n\t\t    state(pamh, argv[i]);\n\t\t    break;\n\t\t}\n\t    }\n\t    break;\n\t}\n    }\n\n    return retval;\n}",
    "includes": [
      "#include \"../../libpam/pam_tokens.h\"",
      "#include <security/pam_ext.h>",
      "#include <security/_pam_macros.h>",
      "#include <security/pam_modules.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "state",
          "args": [
            "pamh",
            "argv[i]"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_debug/pam_debug.c",
          "lines": "24-35",
          "snippet": "static int state(pam_handle_t *pamh, const char *text)\n{\n    int retval;\n\n    retval = pam_info (pamh, \"%s\", text);\n\n    if (retval != PAM_SUCCESS) {\n\tD((\"pam_info failed\"));\n    }\n\n    return retval;\n}",
          "includes": [
            "#include \"../../libpam/pam_tokens.h\"",
            "#include <security/pam_ext.h>",
            "#include <security/_pam_macros.h>",
            "#include <security/pam_modules.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../../libpam/pam_tokens.h\"\n#include <security/pam_ext.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic int state(pam_handle_t *pamh, const char *text)\n{\n    int retval;\n\n    retval = pam_info (pamh, \"%s\", text);\n\n    if (retval != PAM_SUCCESS) {\n\tD((\"pam_info failed\"));\n    }\n\n    return retval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "return_string",
            "_pam_token_returns[j]"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "event",
            "argv[i]",
            "length"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "event"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../../libpam/pam_tokens.h\"\n#include <security/pam_ext.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic int parse_args(int retval, const char *event,\n\t\t      pam_handle_t *pamh, int argc, const char **argv)\n{\n    int i;\n\n    for (i=0; i<argc; ++i) {\n\tint length = strlen(event);\n\tif (!strncmp(event, argv[i], length) && (argv[i][length] == '=')) {\n\t    int j;\n\t    const char *return_string = argv[i] + (length+1);\n\n\t    for (j=0; j<_PAM_RETURN_VALUES; ++j) {\n\t\tif (!strcmp(return_string, _pam_token_returns[j])) {\n\t\t    retval = j;\n\t\t    state(pamh, argv[i]);\n\t\t    break;\n\t\t}\n\t    }\n\t    break;\n\t}\n    }\n\n    return retval;\n}"
  },
  {
    "function_name": "state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_debug/pam_debug.c",
    "lines": "24-35",
    "snippet": "static int state(pam_handle_t *pamh, const char *text)\n{\n    int retval;\n\n    retval = pam_info (pamh, \"%s\", text);\n\n    if (retval != PAM_SUCCESS) {\n\tD((\"pam_info failed\"));\n    }\n\n    return retval;\n}",
    "includes": [
      "#include \"../../libpam/pam_tokens.h\"",
      "#include <security/pam_ext.h>",
      "#include <security/_pam_macros.h>",
      "#include <security/pam_modules.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "D",
          "args": [
            "(\"pam_info failed\")"
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "MD5Name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_unix/md5.c",
          "lines": "53-62",
          "snippet": "void MD5Name(MD5Init)(struct MD5Context *ctx)\n{\n\tctx->buf.i[0] = 0x67452301U;\n\tctx->buf.i[1] = 0xefcdab89U;\n\tctx->buf.i[2] = 0x98badcfeU;\n\tctx->buf.i[3] = 0x10325476U;\n\n\tctx->bits[0] = 0;\n\tctx->bits[1] = 0;\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include <string.h>\n\nvoid MD5Name(MD5Init)(struct MD5Context *ctx)\n{\n\tctx->buf.i[0] = 0x67452301U;\n\tctx->buf.i[1] = 0xefcdab89U;\n\tctx->buf.i[2] = 0x98badcfeU;\n\tctx->buf.i[3] = 0x10325476U;\n\n\tctx->bits[0] = 0;\n\tctx->bits[1] = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pam_info",
          "args": [
            "pamh",
            "\"%s\"",
            "text"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../../libpam/pam_tokens.h\"\n#include <security/pam_ext.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic int state(pam_handle_t *pamh, const char *text)\n{\n    int retval;\n\n    retval = pam_info (pamh, \"%s\", text);\n\n    if (retval != PAM_SUCCESS) {\n\tD((\"pam_info failed\"));\n    }\n\n    return retval;\n}"
  }
]