[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_nologin/tst-pam_nologin-retval.c",
    "lines": "25-226",
    "snippet": "int\nmain(void)\n{\n\tpam_handle_t *pamh = NULL;\n\tFILE *fp;\n\tstruct passwd *pw;\n\tchar cwd[PATH_MAX];\n\n\tASSERT_NE(NULL, getcwd(cwd, sizeof(cwd)));\n\n\t/* PAM_IGNORE -> PAM_PERM_DENIED */\n\tASSERT_NE(NULL, fp = fopen(service_file, \"w\"));\n\tASSERT_LT(0, fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\",\n\t\t\t     cwd, MODULE_NAME, missing_file,\n\t\t\t     cwd, MODULE_NAME, missing_file,\n\t\t\t     cwd, MODULE_NAME, missing_file,\n\t\t\t     cwd, MODULE_NAME, missing_file));\n\tASSERT_EQ(0, fclose(fp));\n\n\tASSERT_EQ(PAM_SUCCESS,\n\t\t  pam_start_confdir(service_file, user_name, &conv, \".\", &pamh));\n\tASSERT_NE(NULL, pamh);\n\tASSERT_EQ(PAM_PERM_DENIED, pam_authenticate(pamh, 0));\n\tASSERT_EQ(PAM_PERM_DENIED, pam_setcred(pamh, 0));\n\tASSERT_EQ(PAM_PERM_DENIED, pam_acct_mgmt(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_chauthtok(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_open_session(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_close_session(pamh, 0));\n\tASSERT_EQ(PAM_SUCCESS, pam_end(pamh, 0));\n\tpamh = NULL;\n\n\t/* PAM_IGNORE -> PAM_SUCCESS */\n\tASSERT_NE(NULL, fp = fopen(service_file, \"w\"));\n\tASSERT_LT(0, fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"auth required %s/../pam_permit/.libs/pam_permit.so\\n\"\n\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"account required %s/../pam_permit/.libs/pam_permit.so\\n\"\n\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"password required %s/../pam_permit/.libs/pam_permit.so\\n\"\n\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"session required %s/../pam_permit/.libs/pam_permit.so\\n\",\n\t\t\t     cwd, MODULE_NAME, missing_file, cwd,\n\t\t\t     cwd, MODULE_NAME, missing_file, cwd,\n\t\t\t     cwd, MODULE_NAME, missing_file, cwd,\n\t\t\t     cwd, MODULE_NAME, missing_file, cwd));\n\tASSERT_EQ(0, fclose(fp));\n\n\tASSERT_EQ(PAM_SUCCESS,\n\t\t  pam_start_confdir(service_file, user_name, &conv, \".\", &pamh));\n\tASSERT_NE(NULL, pamh);\n\tASSERT_EQ(PAM_SUCCESS, pam_authenticate(pamh, 0));\n\tASSERT_EQ(PAM_SUCCESS, pam_setcred(pamh, 0));\n\tASSERT_EQ(PAM_SUCCESS, pam_acct_mgmt(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_chauthtok(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_open_session(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_close_session(pamh, 0));\n\tASSERT_EQ(PAM_SUCCESS, pam_end(pamh, 0));\n\tpamh = NULL;\n\n\t/* successok -> PAM_SUCCESS */\n\tASSERT_NE(NULL, fp = fopen(service_file, \"w\"));\n\tASSERT_LT(0, fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t     \"auth required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t     \"account required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t     \"password required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t     \"session required %s/.libs/%s.so successok file=%s\\n\",\n\t\t\t     cwd, MODULE_NAME, missing_file,\n\t\t\t     cwd, MODULE_NAME, missing_file,\n\t\t\t     cwd, MODULE_NAME, missing_file,\n\t\t\t     cwd, MODULE_NAME, missing_file));\n\tASSERT_EQ(0, fclose(fp));\n\n\tASSERT_EQ(PAM_SUCCESS,\n\t\t  pam_start_confdir(service_file, user_name, &conv, \".\", &pamh));\n\tASSERT_NE(NULL, pamh);\n\tASSERT_EQ(PAM_SUCCESS, pam_authenticate(pamh, 0));\n\tASSERT_EQ(PAM_SUCCESS, pam_setcred(pamh, 0));\n\tASSERT_EQ(PAM_SUCCESS, pam_acct_mgmt(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_chauthtok(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_open_session(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_close_session(pamh, 0));\n\tASSERT_EQ(PAM_SUCCESS, pam_end(pamh, 0));\n\tpamh = NULL;\n\n\t/* PAM_USER_UNKNOWN */\n\tASSERT_NE(NULL, fp = fopen(service_file, \"w\"));\n\tASSERT_LT(0, fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\",\n\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t     cwd, MODULE_NAME, empty_file));\n\tASSERT_EQ(0, fclose(fp));\n\n\tASSERT_EQ(PAM_SUCCESS,\n\t\t  pam_start_confdir(service_file, user_name, &conv, \".\", &pamh));\n\tASSERT_NE(NULL, pamh);\n\tASSERT_EQ(PAM_USER_UNKNOWN, pam_authenticate(pamh, 0));\n\tASSERT_EQ(PAM_PERM_DENIED, pam_setcred(pamh, 0));\n\tASSERT_EQ(PAM_USER_UNKNOWN, pam_acct_mgmt(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_chauthtok(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_open_session(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_close_session(pamh, 0));\n\tASSERT_EQ(PAM_SUCCESS, pam_end(pamh, 0));\n\tpamh = NULL;\n\n\t/* uid == 0 */\n\tif ((pw = getpwuid(0)) != NULL) {\n\t\t/* successok -> PAM_SUCCESS */\n\t\tASSERT_NE(NULL, fp = fopen(service_file, \"w\"));\n\t\tASSERT_LT(0, fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t\t     \"auth required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t\t     \"account required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t\t     \"password required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t\t     \"session required %s/.libs/%s.so successok file=%s\\n\",\n\t\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t\t     cwd, MODULE_NAME, empty_file));\n\t\tASSERT_EQ(0, fclose(fp));\n\n\t\tASSERT_EQ(PAM_SUCCESS,\n\t\t\t  pam_start_confdir(service_file, pw->pw_name,\n\t\t\t\t\t    &conv, \".\", &pamh));\n\t\tASSERT_NE(NULL, pamh);\n\t\tASSERT_EQ(PAM_SUCCESS, pam_authenticate(pamh, 0));\n\t\tASSERT_EQ(PAM_SUCCESS, pam_setcred(pamh, 0));\n\t\tASSERT_EQ(PAM_SUCCESS, pam_acct_mgmt(pamh, 0));\n\t\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_chauthtok(pamh, 0));\n\t\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_open_session(pamh, 0));\n\t\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_close_session(pamh, 0));\n\t\tASSERT_EQ(PAM_SUCCESS, pam_end(pamh, 0));\n\t\tpamh = NULL;\n\n\t\t/* PAM_SYSTEM_ERR */\n\t\tASSERT_NE(NULL, fp = fopen(service_file, \"w\"));\n\t\tASSERT_LT(0, fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\",\n\t\t\t\t     cwd, MODULE_NAME, \".\",\n\t\t\t\t     cwd, MODULE_NAME, \".\",\n\t\t\t\t     cwd, MODULE_NAME, \".\",\n\t\t\t\t     cwd, MODULE_NAME, \".\"));\n\t\tASSERT_EQ(0, fclose(fp));\n\n\t\tASSERT_EQ(PAM_SUCCESS,\n\t\t\t  pam_start_confdir(service_file, pw->pw_name,\n\t\t\t\t\t    &conv, \".\", &pamh));\n\t\tASSERT_NE(NULL, pamh);\n\t\tASSERT_EQ(PAM_SYSTEM_ERR, pam_authenticate(pamh, 0));\n\t\tASSERT_EQ(PAM_PERM_DENIED, pam_setcred(pamh, 0));\n\t\tASSERT_EQ(PAM_SYSTEM_ERR, pam_acct_mgmt(pamh, 0));\n\t\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_chauthtok(pamh, 0));\n\t\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_open_session(pamh, 0));\n\t\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_close_session(pamh, 0));\n\t\tASSERT_EQ(PAM_SUCCESS, pam_end(pamh, 0));\n\t\tpamh = NULL;\n\t}\n\n\t/* uid != 0 */\n\tif (geteuid() != 0 && (pw = getpwuid(geteuid())) != NULL) {\n\t\t/* PAM_AUTH_ERR */\n\t\tASSERT_NE(NULL, fp = fopen(service_file, \"w\"));\n\t\tASSERT_LT(0, fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\",\n\t\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t\t     cwd, MODULE_NAME, empty_file));\n\t\tASSERT_EQ(0, fclose(fp));\n\n\t\tASSERT_EQ(PAM_SUCCESS,\n\t\t\t  pam_start_confdir(service_file, pw->pw_name,\n\t\t\t\t\t    &conv, \".\", &pamh));\n\t\tASSERT_NE(NULL, pamh);\n\t\tASSERT_EQ(PAM_AUTH_ERR, pam_authenticate(pamh, 0));\n\t\tASSERT_EQ(PAM_PERM_DENIED, pam_setcred(pamh, 0));\n\t\tASSERT_EQ(PAM_AUTH_ERR, pam_acct_mgmt(pamh, 0));\n\t\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_chauthtok(pamh, 0));\n\t\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_open_session(pamh, 0));\n\t\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_close_session(pamh, 0));\n\t\tASSERT_EQ(PAM_SUCCESS, pam_end(pamh, 0));\n\t\tpamh = NULL;\n\t}\n\n\tASSERT_EQ(0, unlink(service_file));\n\n\treturn 0;\n}",
    "includes": [
      "#include <security/pam_appl.h>",
      "#include <pwd.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <limits.h>",
      "#include \"test_assert.h\""
    ],
    "macros_used": [
      "#define MODULE_NAME \"pam_nologin\""
    ],
    "globals_used": [
      "static const char service_file[] = TEST_NAME \".service\";",
      "static const char missing_file[] = TEST_NAME \".missing\";",
      "static const char empty_file[] = \"/dev/null\";",
      "static const char user_name[] = \"\";",
      "static struct pam_conv conv;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "unlink(service_file)"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "service_file"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_end(pamh, 0)"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_end",
          "args": [
            "pamh",
            "0"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_close_session(pamh, 0)"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_close_session",
          "args": [
            "pamh",
            "0"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_open_session(pamh, 0)"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_open_session",
          "args": [
            "pamh",
            "0"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_chauthtok(pamh, 0)"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_chauthtok",
          "args": [
            "pamh",
            "0"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_AUTH_ERR",
            "pam_acct_mgmt(pamh, 0)"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_acct_mgmt",
          "args": [
            "pamh",
            "0"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_PERM_DENIED",
            "pam_setcred(pamh, 0)"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_setcred",
          "args": [
            "pamh",
            "0"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_AUTH_ERR",
            "pam_authenticate(pamh, 0)"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_authenticate",
          "args": [
            "pamh",
            "0"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_NE",
          "args": [
            "NULL",
            "pamh"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_start_confdir(service_file, pw->pw_name,\n\t\t\t\t\t    &conv, \".\", &pamh)"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_start_confdir",
          "args": [
            "service_file",
            "pw->pw_name",
            "&conv",
            "\".\"",
            "&pamh"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "fclose(fp)"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "fp"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_LT",
          "args": [
            "0",
            "fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\",\n\t\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t\t     cwd, MODULE_NAME, empty_file)"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "fp",
            "\"#%%PAM-1.0\\n\"\n\t\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\"",
            "cwd",
            "MODULE_NAME",
            "empty_file",
            "cwd",
            "MODULE_NAME",
            "empty_file",
            "cwd",
            "MODULE_NAME",
            "empty_file",
            "cwd",
            "MODULE_NAME",
            "empty_file"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_NE",
          "args": [
            "NULL",
            "fp = fopen(service_file, \"w\")"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "service_file",
            "\"w\""
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpwuid",
          "args": [
            "geteuid()"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_end(pamh, 0)"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_end",
          "args": [
            "pamh",
            "0"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_close_session(pamh, 0)"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_close_session",
          "args": [
            "pamh",
            "0"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_open_session(pamh, 0)"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_open_session",
          "args": [
            "pamh",
            "0"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_chauthtok(pamh, 0)"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_chauthtok",
          "args": [
            "pamh",
            "0"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SYSTEM_ERR",
            "pam_acct_mgmt(pamh, 0)"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_acct_mgmt",
          "args": [
            "pamh",
            "0"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_PERM_DENIED",
            "pam_setcred(pamh, 0)"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_setcred",
          "args": [
            "pamh",
            "0"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SYSTEM_ERR",
            "pam_authenticate(pamh, 0)"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_authenticate",
          "args": [
            "pamh",
            "0"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_NE",
          "args": [
            "NULL",
            "pamh"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_start_confdir(service_file, pw->pw_name,\n\t\t\t\t\t    &conv, \".\", &pamh)"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_start_confdir",
          "args": [
            "service_file",
            "pw->pw_name",
            "&conv",
            "\".\"",
            "&pamh"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "fclose(fp)"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "fp"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_LT",
          "args": [
            "0",
            "fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\",\n\t\t\t\t     cwd, MODULE_NAME, \".\",\n\t\t\t\t     cwd, MODULE_NAME, \".\",\n\t\t\t\t     cwd, MODULE_NAME, \".\",\n\t\t\t\t     cwd, MODULE_NAME, \".\")"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "fp",
            "\"#%%PAM-1.0\\n\"\n\t\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\"",
            "cwd",
            "MODULE_NAME",
            "\".\"",
            "cwd",
            "MODULE_NAME",
            "\".\"",
            "cwd",
            "MODULE_NAME",
            "\".\"",
            "cwd",
            "MODULE_NAME",
            "\".\""
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_NE",
          "args": [
            "NULL",
            "fp = fopen(service_file, \"w\")"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "service_file",
            "\"w\""
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_end(pamh, 0)"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_end",
          "args": [
            "pamh",
            "0"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_close_session(pamh, 0)"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_close_session",
          "args": [
            "pamh",
            "0"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_open_session(pamh, 0)"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_open_session",
          "args": [
            "pamh",
            "0"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_chauthtok(pamh, 0)"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_chauthtok",
          "args": [
            "pamh",
            "0"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_acct_mgmt(pamh, 0)"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_acct_mgmt",
          "args": [
            "pamh",
            "0"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_setcred(pamh, 0)"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_setcred",
          "args": [
            "pamh",
            "0"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_authenticate(pamh, 0)"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_authenticate",
          "args": [
            "pamh",
            "0"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_NE",
          "args": [
            "NULL",
            "pamh"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_start_confdir(service_file, pw->pw_name,\n\t\t\t\t\t    &conv, \".\", &pamh)"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_start_confdir",
          "args": [
            "service_file",
            "pw->pw_name",
            "&conv",
            "\".\"",
            "&pamh"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "fclose(fp)"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "fp"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_LT",
          "args": [
            "0",
            "fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t\t     \"auth required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t\t     \"account required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t\t     \"password required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t\t     \"session required %s/.libs/%s.so successok file=%s\\n\",\n\t\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t\t     cwd, MODULE_NAME, empty_file)"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "fp",
            "\"#%%PAM-1.0\\n\"\n\t\t\t\t     \"auth required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t\t     \"account required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t\t     \"password required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t\t     \"session required %s/.libs/%s.so successok file=%s\\n\"",
            "cwd",
            "MODULE_NAME",
            "empty_file",
            "cwd",
            "MODULE_NAME",
            "empty_file",
            "cwd",
            "MODULE_NAME",
            "empty_file",
            "cwd",
            "MODULE_NAME",
            "empty_file"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_NE",
          "args": [
            "NULL",
            "fp = fopen(service_file, \"w\")"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "service_file",
            "\"w\""
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpwuid",
          "args": [
            "0"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_end(pamh, 0)"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_end",
          "args": [
            "pamh",
            "0"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_close_session(pamh, 0)"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_close_session",
          "args": [
            "pamh",
            "0"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_open_session(pamh, 0)"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_open_session",
          "args": [
            "pamh",
            "0"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_chauthtok(pamh, 0)"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_chauthtok",
          "args": [
            "pamh",
            "0"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_USER_UNKNOWN",
            "pam_acct_mgmt(pamh, 0)"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_acct_mgmt",
          "args": [
            "pamh",
            "0"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_PERM_DENIED",
            "pam_setcred(pamh, 0)"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_setcred",
          "args": [
            "pamh",
            "0"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_USER_UNKNOWN",
            "pam_authenticate(pamh, 0)"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_authenticate",
          "args": [
            "pamh",
            "0"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_NE",
          "args": [
            "NULL",
            "pamh"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_start_confdir(service_file, user_name, &conv, \".\", &pamh)"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_start_confdir",
          "args": [
            "service_file",
            "user_name",
            "&conv",
            "\".\"",
            "&pamh"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "fclose(fp)"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "fp"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_LT",
          "args": [
            "0",
            "fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\",\n\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t     cwd, MODULE_NAME, empty_file)"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "fp",
            "\"#%%PAM-1.0\\n\"\n\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\"",
            "cwd",
            "MODULE_NAME",
            "empty_file",
            "cwd",
            "MODULE_NAME",
            "empty_file",
            "cwd",
            "MODULE_NAME",
            "empty_file",
            "cwd",
            "MODULE_NAME",
            "empty_file"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_NE",
          "args": [
            "NULL",
            "fp = fopen(service_file, \"w\")"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "service_file",
            "\"w\""
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_end(pamh, 0)"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_end",
          "args": [
            "pamh",
            "0"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_close_session(pamh, 0)"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_close_session",
          "args": [
            "pamh",
            "0"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_open_session(pamh, 0)"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_open_session",
          "args": [
            "pamh",
            "0"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_chauthtok(pamh, 0)"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_chauthtok",
          "args": [
            "pamh",
            "0"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_acct_mgmt(pamh, 0)"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_acct_mgmt",
          "args": [
            "pamh",
            "0"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_setcred(pamh, 0)"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_setcred",
          "args": [
            "pamh",
            "0"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_authenticate(pamh, 0)"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_authenticate",
          "args": [
            "pamh",
            "0"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_NE",
          "args": [
            "NULL",
            "pamh"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_start_confdir(service_file, user_name, &conv, \".\", &pamh)"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_start_confdir",
          "args": [
            "service_file",
            "user_name",
            "&conv",
            "\".\"",
            "&pamh"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "fclose(fp)"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "fp"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_LT",
          "args": [
            "0",
            "fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t     \"auth required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t     \"account required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t     \"password required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t     \"session required %s/.libs/%s.so successok file=%s\\n\",\n\t\t\t     cwd, MODULE_NAME, missing_file,\n\t\t\t     cwd, MODULE_NAME, missing_file,\n\t\t\t     cwd, MODULE_NAME, missing_file,\n\t\t\t     cwd, MODULE_NAME, missing_file)"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "fp",
            "\"#%%PAM-1.0\\n\"\n\t\t\t     \"auth required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t     \"account required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t     \"password required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t     \"session required %s/.libs/%s.so successok file=%s\\n\"",
            "cwd",
            "MODULE_NAME",
            "missing_file",
            "cwd",
            "MODULE_NAME",
            "missing_file",
            "cwd",
            "MODULE_NAME",
            "missing_file",
            "cwd",
            "MODULE_NAME",
            "missing_file"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_NE",
          "args": [
            "NULL",
            "fp = fopen(service_file, \"w\")"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "service_file",
            "\"w\""
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_end(pamh, 0)"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_end",
          "args": [
            "pamh",
            "0"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_close_session(pamh, 0)"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_close_session",
          "args": [
            "pamh",
            "0"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_open_session(pamh, 0)"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_open_session",
          "args": [
            "pamh",
            "0"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_chauthtok(pamh, 0)"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_chauthtok",
          "args": [
            "pamh",
            "0"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_acct_mgmt(pamh, 0)"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_acct_mgmt",
          "args": [
            "pamh",
            "0"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_setcred(pamh, 0)"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_setcred",
          "args": [
            "pamh",
            "0"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_authenticate(pamh, 0)"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_authenticate",
          "args": [
            "pamh",
            "0"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_NE",
          "args": [
            "NULL",
            "pamh"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_start_confdir(service_file, user_name, &conv, \".\", &pamh)"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_start_confdir",
          "args": [
            "service_file",
            "user_name",
            "&conv",
            "\".\"",
            "&pamh"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "fclose(fp)"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "fp"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_LT",
          "args": [
            "0",
            "fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"auth required %s/../pam_permit/.libs/pam_permit.so\\n\"\n\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"account required %s/../pam_permit/.libs/pam_permit.so\\n\"\n\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"password required %s/../pam_permit/.libs/pam_permit.so\\n\"\n\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"session required %s/../pam_permit/.libs/pam_permit.so\\n\",\n\t\t\t     cwd, MODULE_NAME, missing_file, cwd,\n\t\t\t     cwd, MODULE_NAME, missing_file, cwd,\n\t\t\t     cwd, MODULE_NAME, missing_file, cwd,\n\t\t\t     cwd, MODULE_NAME, missing_file, cwd)"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "fp",
            "\"#%%PAM-1.0\\n\"\n\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"auth required %s/../pam_permit/.libs/pam_permit.so\\n\"\n\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"account required %s/../pam_permit/.libs/pam_permit.so\\n\"\n\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"password required %s/../pam_permit/.libs/pam_permit.so\\n\"\n\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"session required %s/../pam_permit/.libs/pam_permit.so\\n\"",
            "cwd",
            "MODULE_NAME",
            "missing_file",
            "cwd",
            "cwd",
            "MODULE_NAME",
            "missing_file",
            "cwd",
            "cwd",
            "MODULE_NAME",
            "missing_file",
            "cwd",
            "cwd",
            "MODULE_NAME",
            "missing_file",
            "cwd"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_NE",
          "args": [
            "NULL",
            "fp = fopen(service_file, \"w\")"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "service_file",
            "\"w\""
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_end(pamh, 0)"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_end",
          "args": [
            "pamh",
            "0"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_close_session(pamh, 0)"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_close_session",
          "args": [
            "pamh",
            "0"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_open_session(pamh, 0)"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_open_session",
          "args": [
            "pamh",
            "0"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_MODULE_UNKNOWN",
            "pam_chauthtok(pamh, 0)"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_chauthtok",
          "args": [
            "pamh",
            "0"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_PERM_DENIED",
            "pam_acct_mgmt(pamh, 0)"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_acct_mgmt",
          "args": [
            "pamh",
            "0"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_PERM_DENIED",
            "pam_setcred(pamh, 0)"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_setcred",
          "args": [
            "pamh",
            "0"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_PERM_DENIED",
            "pam_authenticate(pamh, 0)"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_authenticate",
          "args": [
            "pamh",
            "0"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_NE",
          "args": [
            "NULL",
            "pamh"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "PAM_SUCCESS",
            "pam_start_confdir(service_file, user_name, &conv, \".\", &pamh)"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_start_confdir",
          "args": [
            "service_file",
            "user_name",
            "&conv",
            "\".\"",
            "&pamh"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0",
            "fclose(fp)"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "fp"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_LT",
          "args": [
            "0",
            "fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\",\n\t\t\t     cwd, MODULE_NAME, missing_file,\n\t\t\t     cwd, MODULE_NAME, missing_file,\n\t\t\t     cwd, MODULE_NAME, missing_file,\n\t\t\t     cwd, MODULE_NAME, missing_file)"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "fp",
            "\"#%%PAM-1.0\\n\"\n\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\"",
            "cwd",
            "MODULE_NAME",
            "missing_file",
            "cwd",
            "MODULE_NAME",
            "missing_file",
            "cwd",
            "MODULE_NAME",
            "missing_file",
            "cwd",
            "MODULE_NAME",
            "missing_file"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_NE",
          "args": [
            "NULL",
            "fp = fopen(service_file, \"w\")"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "service_file",
            "\"w\""
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_NE",
          "args": [
            "NULL",
            "getcwd(cwd, sizeof(cwd))"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getcwd",
          "args": [
            "cwd",
            "sizeof(cwd)"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <security/pam_appl.h>\n#include <pwd.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdio.h>\n#include <limits.h>\n#include \"test_assert.h\"\n\n#define MODULE_NAME \"pam_nologin\"\n\nstatic const char service_file[] = TEST_NAME \".service\";\nstatic const char missing_file[] = TEST_NAME \".missing\";\nstatic const char empty_file[] = \"/dev/null\";\nstatic const char user_name[] = \"\";\nstatic struct pam_conv conv;\n\nint\nmain(void)\n{\n\tpam_handle_t *pamh = NULL;\n\tFILE *fp;\n\tstruct passwd *pw;\n\tchar cwd[PATH_MAX];\n\n\tASSERT_NE(NULL, getcwd(cwd, sizeof(cwd)));\n\n\t/* PAM_IGNORE -> PAM_PERM_DENIED */\n\tASSERT_NE(NULL, fp = fopen(service_file, \"w\"));\n\tASSERT_LT(0, fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\",\n\t\t\t     cwd, MODULE_NAME, missing_file,\n\t\t\t     cwd, MODULE_NAME, missing_file,\n\t\t\t     cwd, MODULE_NAME, missing_file,\n\t\t\t     cwd, MODULE_NAME, missing_file));\n\tASSERT_EQ(0, fclose(fp));\n\n\tASSERT_EQ(PAM_SUCCESS,\n\t\t  pam_start_confdir(service_file, user_name, &conv, \".\", &pamh));\n\tASSERT_NE(NULL, pamh);\n\tASSERT_EQ(PAM_PERM_DENIED, pam_authenticate(pamh, 0));\n\tASSERT_EQ(PAM_PERM_DENIED, pam_setcred(pamh, 0));\n\tASSERT_EQ(PAM_PERM_DENIED, pam_acct_mgmt(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_chauthtok(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_open_session(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_close_session(pamh, 0));\n\tASSERT_EQ(PAM_SUCCESS, pam_end(pamh, 0));\n\tpamh = NULL;\n\n\t/* PAM_IGNORE -> PAM_SUCCESS */\n\tASSERT_NE(NULL, fp = fopen(service_file, \"w\"));\n\tASSERT_LT(0, fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"auth required %s/../pam_permit/.libs/pam_permit.so\\n\"\n\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"account required %s/../pam_permit/.libs/pam_permit.so\\n\"\n\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"password required %s/../pam_permit/.libs/pam_permit.so\\n\"\n\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"session required %s/../pam_permit/.libs/pam_permit.so\\n\",\n\t\t\t     cwd, MODULE_NAME, missing_file, cwd,\n\t\t\t     cwd, MODULE_NAME, missing_file, cwd,\n\t\t\t     cwd, MODULE_NAME, missing_file, cwd,\n\t\t\t     cwd, MODULE_NAME, missing_file, cwd));\n\tASSERT_EQ(0, fclose(fp));\n\n\tASSERT_EQ(PAM_SUCCESS,\n\t\t  pam_start_confdir(service_file, user_name, &conv, \".\", &pamh));\n\tASSERT_NE(NULL, pamh);\n\tASSERT_EQ(PAM_SUCCESS, pam_authenticate(pamh, 0));\n\tASSERT_EQ(PAM_SUCCESS, pam_setcred(pamh, 0));\n\tASSERT_EQ(PAM_SUCCESS, pam_acct_mgmt(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_chauthtok(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_open_session(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_close_session(pamh, 0));\n\tASSERT_EQ(PAM_SUCCESS, pam_end(pamh, 0));\n\tpamh = NULL;\n\n\t/* successok -> PAM_SUCCESS */\n\tASSERT_NE(NULL, fp = fopen(service_file, \"w\"));\n\tASSERT_LT(0, fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t     \"auth required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t     \"account required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t     \"password required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t     \"session required %s/.libs/%s.so successok file=%s\\n\",\n\t\t\t     cwd, MODULE_NAME, missing_file,\n\t\t\t     cwd, MODULE_NAME, missing_file,\n\t\t\t     cwd, MODULE_NAME, missing_file,\n\t\t\t     cwd, MODULE_NAME, missing_file));\n\tASSERT_EQ(0, fclose(fp));\n\n\tASSERT_EQ(PAM_SUCCESS,\n\t\t  pam_start_confdir(service_file, user_name, &conv, \".\", &pamh));\n\tASSERT_NE(NULL, pamh);\n\tASSERT_EQ(PAM_SUCCESS, pam_authenticate(pamh, 0));\n\tASSERT_EQ(PAM_SUCCESS, pam_setcred(pamh, 0));\n\tASSERT_EQ(PAM_SUCCESS, pam_acct_mgmt(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_chauthtok(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_open_session(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_close_session(pamh, 0));\n\tASSERT_EQ(PAM_SUCCESS, pam_end(pamh, 0));\n\tpamh = NULL;\n\n\t/* PAM_USER_UNKNOWN */\n\tASSERT_NE(NULL, fp = fopen(service_file, \"w\"));\n\tASSERT_LT(0, fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\",\n\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t     cwd, MODULE_NAME, empty_file));\n\tASSERT_EQ(0, fclose(fp));\n\n\tASSERT_EQ(PAM_SUCCESS,\n\t\t  pam_start_confdir(service_file, user_name, &conv, \".\", &pamh));\n\tASSERT_NE(NULL, pamh);\n\tASSERT_EQ(PAM_USER_UNKNOWN, pam_authenticate(pamh, 0));\n\tASSERT_EQ(PAM_PERM_DENIED, pam_setcred(pamh, 0));\n\tASSERT_EQ(PAM_USER_UNKNOWN, pam_acct_mgmt(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_chauthtok(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_open_session(pamh, 0));\n\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_close_session(pamh, 0));\n\tASSERT_EQ(PAM_SUCCESS, pam_end(pamh, 0));\n\tpamh = NULL;\n\n\t/* uid == 0 */\n\tif ((pw = getpwuid(0)) != NULL) {\n\t\t/* successok -> PAM_SUCCESS */\n\t\tASSERT_NE(NULL, fp = fopen(service_file, \"w\"));\n\t\tASSERT_LT(0, fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t\t     \"auth required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t\t     \"account required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t\t     \"password required %s/.libs/%s.so successok file=%s\\n\"\n\t\t\t\t     \"session required %s/.libs/%s.so successok file=%s\\n\",\n\t\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t\t     cwd, MODULE_NAME, empty_file));\n\t\tASSERT_EQ(0, fclose(fp));\n\n\t\tASSERT_EQ(PAM_SUCCESS,\n\t\t\t  pam_start_confdir(service_file, pw->pw_name,\n\t\t\t\t\t    &conv, \".\", &pamh));\n\t\tASSERT_NE(NULL, pamh);\n\t\tASSERT_EQ(PAM_SUCCESS, pam_authenticate(pamh, 0));\n\t\tASSERT_EQ(PAM_SUCCESS, pam_setcred(pamh, 0));\n\t\tASSERT_EQ(PAM_SUCCESS, pam_acct_mgmt(pamh, 0));\n\t\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_chauthtok(pamh, 0));\n\t\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_open_session(pamh, 0));\n\t\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_close_session(pamh, 0));\n\t\tASSERT_EQ(PAM_SUCCESS, pam_end(pamh, 0));\n\t\tpamh = NULL;\n\n\t\t/* PAM_SYSTEM_ERR */\n\t\tASSERT_NE(NULL, fp = fopen(service_file, \"w\"));\n\t\tASSERT_LT(0, fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\",\n\t\t\t\t     cwd, MODULE_NAME, \".\",\n\t\t\t\t     cwd, MODULE_NAME, \".\",\n\t\t\t\t     cwd, MODULE_NAME, \".\",\n\t\t\t\t     cwd, MODULE_NAME, \".\"));\n\t\tASSERT_EQ(0, fclose(fp));\n\n\t\tASSERT_EQ(PAM_SUCCESS,\n\t\t\t  pam_start_confdir(service_file, pw->pw_name,\n\t\t\t\t\t    &conv, \".\", &pamh));\n\t\tASSERT_NE(NULL, pamh);\n\t\tASSERT_EQ(PAM_SYSTEM_ERR, pam_authenticate(pamh, 0));\n\t\tASSERT_EQ(PAM_PERM_DENIED, pam_setcred(pamh, 0));\n\t\tASSERT_EQ(PAM_SYSTEM_ERR, pam_acct_mgmt(pamh, 0));\n\t\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_chauthtok(pamh, 0));\n\t\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_open_session(pamh, 0));\n\t\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_close_session(pamh, 0));\n\t\tASSERT_EQ(PAM_SUCCESS, pam_end(pamh, 0));\n\t\tpamh = NULL;\n\t}\n\n\t/* uid != 0 */\n\tif (geteuid() != 0 && (pw = getpwuid(geteuid())) != NULL) {\n\t\t/* PAM_AUTH_ERR */\n\t\tASSERT_NE(NULL, fp = fopen(service_file, \"w\"));\n\t\tASSERT_LT(0, fprintf(fp, \"#%%PAM-1.0\\n\"\n\t\t\t\t     \"auth required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"account required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"password required %s/.libs/%s.so file=%s\\n\"\n\t\t\t\t     \"session required %s/.libs/%s.so file=%s\\n\",\n\t\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t\t     cwd, MODULE_NAME, empty_file,\n\t\t\t\t     cwd, MODULE_NAME, empty_file));\n\t\tASSERT_EQ(0, fclose(fp));\n\n\t\tASSERT_EQ(PAM_SUCCESS,\n\t\t\t  pam_start_confdir(service_file, pw->pw_name,\n\t\t\t\t\t    &conv, \".\", &pamh));\n\t\tASSERT_NE(NULL, pamh);\n\t\tASSERT_EQ(PAM_AUTH_ERR, pam_authenticate(pamh, 0));\n\t\tASSERT_EQ(PAM_PERM_DENIED, pam_setcred(pamh, 0));\n\t\tASSERT_EQ(PAM_AUTH_ERR, pam_acct_mgmt(pamh, 0));\n\t\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_chauthtok(pamh, 0));\n\t\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_open_session(pamh, 0));\n\t\tASSERT_EQ(PAM_MODULE_UNKNOWN, pam_close_session(pamh, 0));\n\t\tASSERT_EQ(PAM_SUCCESS, pam_end(pamh, 0));\n\t\tpamh = NULL;\n\t}\n\n\tASSERT_EQ(0, unlink(service_file));\n\n\treturn 0;\n}"
  }
]