[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/hmacfile.c",
    "lines": "138-163",
    "snippet": "int\nmain(int argc, char **argv)\n{\n\tvoid *hmac;\n\tsize_t maclen;\n\tconst char *keyfile;\n\tint i;\n\tsize_t j;\n\n\ttestvectors();\n\n\tkeyfile = argv[1];\n\tfor (i = 2; i < argc; i++) {\n\t\thmac_sha1_generate_file(NULL, &hmac, &maclen, keyfile, -1, -1,\n\t\t\t\t\targv[i], strlen(argv[i]));\n\t\tif (hmac != NULL) {\n\t\t\tunsigned char *hmacc = hmac;\n\t\t\tfor (j = 0; j < maclen; j++) {\n\t\t\t\tprintf(\"%02x\", hmacc[j] & 0xff);\n\t\t\t}\n\t\t\tprintf(\"  %s\\n\", argv[i]);\n\t\t\tfree(hmac);\n\t\t}\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"hmacsha1.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include \"pam_inline.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "hmac"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "free_module_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_selinux/pam_selinux.c",
          "lines": "386-398",
          "snippet": "static void\nfree_module_data(module_data_t *data)\n{\n  free(data->tty_path);\n  freecon(data->prev_tty_context);\n  freecon(data->tty_context);\n  freecon(data->default_user_context);\n  freecon(data->prev_exec_context);\n  if (data->exec_context != data->default_user_context)\n    freecon(data->exec_context);\n  memset(data, 0, sizeof(*data));\n  free(data);\n}",
          "includes": [
            "#include <sys/select.h>",
            "#include <libaudit.h>",
            "#include <selinux/get_default_type.h>",
            "#include <selinux/context.h>",
            "#include <selinux/get_context_list.h>",
            "#include <selinux/selinux.h>",
            "#include \"pam_inline.h\"",
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/_pam_macros.h>",
            "#include <security/pam_modules.h>",
            "#include <syslog.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/select.h>\n#include <libaudit.h>\n#include <selinux/get_default_type.h>\n#include <selinux/context.h>\n#include <selinux/get_context_list.h>\n#include <selinux/selinux.h>\n#include \"pam_inline.h\"\n#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <syslog.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <limits.h>\n#include <errno.h>\n#include \"config.h\"\n\nstatic void\nfree_module_data(module_data_t *data)\n{\n  free(data->tty_path);\n  freecon(data->prev_tty_context);\n  freecon(data->tty_context);\n  freecon(data->default_user_context);\n  freecon(data->prev_exec_context);\n  if (data->exec_context != data->default_user_context)\n    freecon(data->exec_context);\n  memset(data, 0, sizeof(*data));\n  free(data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"  %s\\n\"",
            "argv[i]"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%02x\"",
            "hmacc[j] & 0xff"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hmac_sha1_generate_file",
          "args": [
            "NULL",
            "&hmac",
            "&maclen",
            "keyfile",
            "-1",
            "-1",
            "argv[i]",
            "strlen(argv[i])"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "hmac_sha1_generate_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/hmacsha1.c",
          "lines": "268-289",
          "snippet": "void\nhmac_sha1_generate_file(pam_handle_t *pamh, void **mac, size_t *mac_length,\n\t\t\tconst char *keyfile, uid_t owner, gid_t group,\n\t\t\tconst void *text, size_t text_length)\n{\n\tvoid *key;\n\tsize_t key_length;\n\n\thmac_key_read(pamh, keyfile,\n\t\t      MAXIMUM_KEY_SIZE, owner, group,\n\t\t      &key, &key_length);\n\tif (key == NULL) {\n\t\t*mac = NULL;\n\t\t*mac_length = 0;\n\t\treturn;\n\t}\n\thmac_sha1_generate(mac, mac_length,\n\t\t\t   key, key_length,\n\t\t\t   text, text_length);\n\tmemset(key, 0, key_length);\n\tfree(key);\n}",
          "includes": [
            "#include \"sha1.h\"",
            "#include \"hmacsha1.h\"",
            "#include <security/pam_ext.h>",
            "#include <syslog.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [
            "#define MAXIMUM_KEY_SIZE SHA1_BLOCK_SIZE"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sha1.h\"\n#include \"hmacsha1.h\"\n#include <security/pam_ext.h>\n#include <syslog.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pwd.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"config.h\"\n\n#define MAXIMUM_KEY_SIZE SHA1_BLOCK_SIZE\n\nvoid\nhmac_sha1_generate_file(pam_handle_t *pamh, void **mac, size_t *mac_length,\n\t\t\tconst char *keyfile, uid_t owner, gid_t group,\n\t\t\tconst void *text, size_t text_length)\n{\n\tvoid *key;\n\tsize_t key_length;\n\n\thmac_key_read(pamh, keyfile,\n\t\t      MAXIMUM_KEY_SIZE, owner, group,\n\t\t      &key, &key_length);\n\tif (key == NULL) {\n\t\t*mac = NULL;\n\t\t*mac_length = 0;\n\t\treturn;\n\t}\n\thmac_sha1_generate(mac, mac_length,\n\t\t\t   key, key_length,\n\t\t\t   text, text_length);\n\tmemset(key, 0, key_length);\n\tfree(key);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "argv[i]"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "testvectors",
          "args": [],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "testvectors",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/hmacfile.c",
          "lines": "48-136",
          "snippet": "static void\ntestvectors(void)\n{\n\tvoid *hmac;\n\tsize_t hmac_len;\n\tsize_t i, j;\n\tchar hex[3];\n\tstruct vector {\n\t\tconst char *key;\n\t\tint key_len;\n\t\tconst char *data;\n\t\tint data_len;\n\t\tconst char *hmac;\n\t} vectors[] = {\n\t\t{\n\t\t\"\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\", 20,\n\t\t\"Hi There\", 8,\n\t\t\"b617318655057264e28bc0b6fb378c8ef146be00\",\n\t\t},\n\n#ifdef HMAC_ALLOW_SHORT_KEYS\n\t\t{\n\t\t\"Jefe\", 4,\n\t\t\"what do ya want for nothing?\", 28,\n\t\t\"effcdf6ae5eb2fa2d27416d5f184df9c259a7c79\",\n\t\t},\n#endif\n\n\t\t{\n\t\t\"\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\", 20,\n\t\t\"\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\", 50,\n\t\t\"125d7342b9ac11cd91a39af48aa17b4f63f175d3\",\n\t\t},\n\n\t\t{\n\t\t\"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\", 25,\n\t\t\"\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\",\n\t\t50,\n\t\t\"4c9007f4026250c6bc8414f9bf50c86c2d7235da\",\n\t\t},\n\n\t\t{\n\t\t\"\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\", 20,\n\t\t\"Test With Truncation\", 20,\n\t\t\"4c1a03424b55e07fe7f27be1d58bb9324a9a5a04\",\n\t\t},\n\n\t\t{\n\t\t\"\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\",\n\t\t80,\n\t\t\"Test Using Larger Than Block-Size Key - Hash Key First\", 54,\n\t\t\"aa4ae5e15272d00e95705637ce8a3b55ed402112\",\n\t\t},\n\n\t\t{\n\t\t\"\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\",\n\t\t80,\n\t\t\"Test Using Larger Than Block-Size Key and Larger Than One Block-Size Data\", 73,\n\t\t\"e8e99d0f45237d786d6bbaa7965c7808bbff1a91\",\n\t\t},\n\t};\n\tfor (i = 0; i < PAM_ARRAY_SIZE(vectors); i++) {\n\t\thmac = NULL;\n\t\thmac_len = 0;\n\t\thmac_sha1_generate(&hmac, &hmac_len,\n\t\t\t\t   vectors[i].key, vectors[i].key_len,\n\t\t\t\t   vectors[i].data, vectors[i].data_len);\n\t\tif (hmac != NULL) {\n\t\t\tunsigned char *hmacc = hmac;\n\t\t\tfor (j = 0; j < hmac_len; j++) {\n\t\t\t\tsnprintf(hex, sizeof(hex), \"%02x\",\n\t\t\t\t\t hmacc[j] & 0xff);\n\t\t\t\tif (strncasecmp(hex,\n\t\t\t\t\t\tvectors[i].hmac + 2 * j,\n\t\t\t\t\t\t2) != 0) {\n\t\t\t\t\tprintf(\"Incorrect result for vector %lu\\n\",\n\t\t\t\t\t       (unsigned long) i + 1);\n\t\t\t\t\texit(1);\n\n\t\t\t\t}\n\t\t\t}\n\t\t\tfree(hmac);\n\t\t} else {\n\t\t\tprintf(\"Error in vector %lu.\\n\",\n\t\t\t       (unsigned long) i + 1);\n\t\t\texit(1);\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"hmacsha1.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"pam_inline.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hmacsha1.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"pam_inline.h\"\n\nstatic void\ntestvectors(void)\n{\n\tvoid *hmac;\n\tsize_t hmac_len;\n\tsize_t i, j;\n\tchar hex[3];\n\tstruct vector {\n\t\tconst char *key;\n\t\tint key_len;\n\t\tconst char *data;\n\t\tint data_len;\n\t\tconst char *hmac;\n\t} vectors[] = {\n\t\t{\n\t\t\"\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\", 20,\n\t\t\"Hi There\", 8,\n\t\t\"b617318655057264e28bc0b6fb378c8ef146be00\",\n\t\t},\n\n#ifdef HMAC_ALLOW_SHORT_KEYS\n\t\t{\n\t\t\"Jefe\", 4,\n\t\t\"what do ya want for nothing?\", 28,\n\t\t\"effcdf6ae5eb2fa2d27416d5f184df9c259a7c79\",\n\t\t},\n#endif\n\n\t\t{\n\t\t\"\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\", 20,\n\t\t\"\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\", 50,\n\t\t\"125d7342b9ac11cd91a39af48aa17b4f63f175d3\",\n\t\t},\n\n\t\t{\n\t\t\"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\", 25,\n\t\t\"\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\",\n\t\t50,\n\t\t\"4c9007f4026250c6bc8414f9bf50c86c2d7235da\",\n\t\t},\n\n\t\t{\n\t\t\"\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\", 20,\n\t\t\"Test With Truncation\", 20,\n\t\t\"4c1a03424b55e07fe7f27be1d58bb9324a9a5a04\",\n\t\t},\n\n\t\t{\n\t\t\"\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\",\n\t\t80,\n\t\t\"Test Using Larger Than Block-Size Key - Hash Key First\", 54,\n\t\t\"aa4ae5e15272d00e95705637ce8a3b55ed402112\",\n\t\t},\n\n\t\t{\n\t\t\"\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\",\n\t\t80,\n\t\t\"Test Using Larger Than Block-Size Key and Larger Than One Block-Size Data\", 73,\n\t\t\"e8e99d0f45237d786d6bbaa7965c7808bbff1a91\",\n\t\t},\n\t};\n\tfor (i = 0; i < PAM_ARRAY_SIZE(vectors); i++) {\n\t\thmac = NULL;\n\t\thmac_len = 0;\n\t\thmac_sha1_generate(&hmac, &hmac_len,\n\t\t\t\t   vectors[i].key, vectors[i].key_len,\n\t\t\t\t   vectors[i].data, vectors[i].data_len);\n\t\tif (hmac != NULL) {\n\t\t\tunsigned char *hmacc = hmac;\n\t\t\tfor (j = 0; j < hmac_len; j++) {\n\t\t\t\tsnprintf(hex, sizeof(hex), \"%02x\",\n\t\t\t\t\t hmacc[j] & 0xff);\n\t\t\t\tif (strncasecmp(hex,\n\t\t\t\t\t\tvectors[i].hmac + 2 * j,\n\t\t\t\t\t\t2) != 0) {\n\t\t\t\t\tprintf(\"Incorrect result for vector %lu\\n\",\n\t\t\t\t\t       (unsigned long) i + 1);\n\t\t\t\t\texit(1);\n\n\t\t\t\t}\n\t\t\t}\n\t\t\tfree(hmac);\n\t\t} else {\n\t\t\tprintf(\"Error in vector %lu.\\n\",\n\t\t\t       (unsigned long) i + 1);\n\t\t\texit(1);\n\t\t}\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hmacsha1.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"pam_inline.h\"\n\nint\nmain(int argc, char **argv)\n{\n\tvoid *hmac;\n\tsize_t maclen;\n\tconst char *keyfile;\n\tint i;\n\tsize_t j;\n\n\ttestvectors();\n\n\tkeyfile = argv[1];\n\tfor (i = 2; i < argc; i++) {\n\t\thmac_sha1_generate_file(NULL, &hmac, &maclen, keyfile, -1, -1,\n\t\t\t\t\targv[i], strlen(argv[i]));\n\t\tif (hmac != NULL) {\n\t\t\tunsigned char *hmacc = hmac;\n\t\t\tfor (j = 0; j < maclen; j++) {\n\t\t\t\tprintf(\"%02x\", hmacc[j] & 0xff);\n\t\t\t}\n\t\t\tprintf(\"  %s\\n\", argv[i]);\n\t\t\tfree(hmac);\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "testvectors",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/hmacfile.c",
    "lines": "48-136",
    "snippet": "static void\ntestvectors(void)\n{\n\tvoid *hmac;\n\tsize_t hmac_len;\n\tsize_t i, j;\n\tchar hex[3];\n\tstruct vector {\n\t\tconst char *key;\n\t\tint key_len;\n\t\tconst char *data;\n\t\tint data_len;\n\t\tconst char *hmac;\n\t} vectors[] = {\n\t\t{\n\t\t\"\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\", 20,\n\t\t\"Hi There\", 8,\n\t\t\"b617318655057264e28bc0b6fb378c8ef146be00\",\n\t\t},\n\n#ifdef HMAC_ALLOW_SHORT_KEYS\n\t\t{\n\t\t\"Jefe\", 4,\n\t\t\"what do ya want for nothing?\", 28,\n\t\t\"effcdf6ae5eb2fa2d27416d5f184df9c259a7c79\",\n\t\t},\n#endif\n\n\t\t{\n\t\t\"\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\", 20,\n\t\t\"\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\", 50,\n\t\t\"125d7342b9ac11cd91a39af48aa17b4f63f175d3\",\n\t\t},\n\n\t\t{\n\t\t\"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\", 25,\n\t\t\"\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\",\n\t\t50,\n\t\t\"4c9007f4026250c6bc8414f9bf50c86c2d7235da\",\n\t\t},\n\n\t\t{\n\t\t\"\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\", 20,\n\t\t\"Test With Truncation\", 20,\n\t\t\"4c1a03424b55e07fe7f27be1d58bb9324a9a5a04\",\n\t\t},\n\n\t\t{\n\t\t\"\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\",\n\t\t80,\n\t\t\"Test Using Larger Than Block-Size Key - Hash Key First\", 54,\n\t\t\"aa4ae5e15272d00e95705637ce8a3b55ed402112\",\n\t\t},\n\n\t\t{\n\t\t\"\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\",\n\t\t80,\n\t\t\"Test Using Larger Than Block-Size Key and Larger Than One Block-Size Data\", 73,\n\t\t\"e8e99d0f45237d786d6bbaa7965c7808bbff1a91\",\n\t\t},\n\t};\n\tfor (i = 0; i < PAM_ARRAY_SIZE(vectors); i++) {\n\t\thmac = NULL;\n\t\thmac_len = 0;\n\t\thmac_sha1_generate(&hmac, &hmac_len,\n\t\t\t\t   vectors[i].key, vectors[i].key_len,\n\t\t\t\t   vectors[i].data, vectors[i].data_len);\n\t\tif (hmac != NULL) {\n\t\t\tunsigned char *hmacc = hmac;\n\t\t\tfor (j = 0; j < hmac_len; j++) {\n\t\t\t\tsnprintf(hex, sizeof(hex), \"%02x\",\n\t\t\t\t\t hmacc[j] & 0xff);\n\t\t\t\tif (strncasecmp(hex,\n\t\t\t\t\t\tvectors[i].hmac + 2 * j,\n\t\t\t\t\t\t2) != 0) {\n\t\t\t\t\tprintf(\"Incorrect result for vector %lu\\n\",\n\t\t\t\t\t       (unsigned long) i + 1);\n\t\t\t\t\texit(1);\n\n\t\t\t\t}\n\t\t\t}\n\t\t\tfree(hmac);\n\t\t} else {\n\t\t\tprintf(\"Error in vector %lu.\\n\",\n\t\t\t       (unsigned long) i + 1);\n\t\t\texit(1);\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"hmacsha1.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include \"pam_inline.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Error in vector %lu.\\n\"",
            "(unsigned long) i + 1"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "hmac"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "free_module_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_selinux/pam_selinux.c",
          "lines": "386-398",
          "snippet": "static void\nfree_module_data(module_data_t *data)\n{\n  free(data->tty_path);\n  freecon(data->prev_tty_context);\n  freecon(data->tty_context);\n  freecon(data->default_user_context);\n  freecon(data->prev_exec_context);\n  if (data->exec_context != data->default_user_context)\n    freecon(data->exec_context);\n  memset(data, 0, sizeof(*data));\n  free(data);\n}",
          "includes": [
            "#include <sys/select.h>",
            "#include <libaudit.h>",
            "#include <selinux/get_default_type.h>",
            "#include <selinux/context.h>",
            "#include <selinux/get_context_list.h>",
            "#include <selinux/selinux.h>",
            "#include \"pam_inline.h\"",
            "#include <security/pam_ext.h>",
            "#include <security/pam_modutil.h>",
            "#include <security/_pam_macros.h>",
            "#include <security/pam_modules.h>",
            "#include <syslog.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/select.h>\n#include <libaudit.h>\n#include <selinux/get_default_type.h>\n#include <selinux/context.h>\n#include <selinux/get_context_list.h>\n#include <selinux/selinux.h>\n#include \"pam_inline.h\"\n#include <security/pam_ext.h>\n#include <security/pam_modutil.h>\n#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <syslog.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <limits.h>\n#include <errno.h>\n#include \"config.h\"\n\nstatic void\nfree_module_data(module_data_t *data)\n{\n  free(data->tty_path);\n  freecon(data->prev_tty_context);\n  freecon(data->tty_context);\n  freecon(data->default_user_context);\n  freecon(data->prev_exec_context);\n  if (data->exec_context != data->default_user_context)\n    freecon(data->exec_context);\n  memset(data, 0, sizeof(*data));\n  free(data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Incorrect result for vector %lu\\n\"",
            "(unsigned long) i + 1"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncasecmp",
          "args": [
            "hex",
            "vectors[i].hmac + 2 * j",
            "2"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "hex",
            "sizeof(hex)",
            "\"%02x\"",
            "hmacc[j] & 0xff"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hmac_sha1_generate",
          "args": [
            "&hmac",
            "&hmac_len",
            "vectors[i].key",
            "vectors[i].key_len",
            "vectors[i].data",
            "vectors[i].data_len"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "hmac_sha1_generate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_timestamp/hmacsha1.c",
          "lines": "202-266",
          "snippet": "void\nhmac_sha1_generate(void **mac, size_t *mac_length,\n\t\t   const void *raw_key, size_t raw_key_size,\n\t\t   const void *text, size_t text_length)\n{\n\tunsigned char key[MAXIMUM_KEY_SIZE], tmp_key[MAXIMUM_KEY_SIZE];\n\tsize_t maximum_key_size = SHA1_BLOCK_SIZE,\n\t       minimum_key_size = SHA1_OUTPUT_SIZE;\n\tconst unsigned char ipad = 0x36, opad = 0x5c;\n\tstruct sha1_context sha1;\n\tunsigned char inner[SHA1_OUTPUT_SIZE], outer[SHA1_OUTPUT_SIZE];\n\n\t*mac = NULL;\n\t*mac_length = 0;\n\n#ifndef HMAC_ALLOW_SHORT_KEYS\n\t/* If the key is too short, don't bother. */\n\tif (raw_key_size < minimum_key_size) {\n\t\treturn;\n\t}\n#endif\n\n\t/* If the key is too long, \"compress\" it, else copy it and pad it\n\t * out with zero bytes. */\n\tmemset(key, 0, sizeof(key));\n\tif (raw_key_size > maximum_key_size) {\n\t\tsha1_init(&sha1);\n\t\tsha1_update(&sha1, raw_key, raw_key_size);\n\t\tsha1_output(&sha1, key);\n\t} else {\n\t\tmemmove(key, raw_key, raw_key_size);\n\t}\n\n\t/* Generate the inner sum. */\n\tmemcpy(tmp_key, key, sizeof(tmp_key));\n\txor_block(tmp_key, ipad, sizeof(tmp_key));\n\n\tsha1_init(&sha1);\n\tsha1_update(&sha1, tmp_key, sizeof(tmp_key));\n\tsha1_update(&sha1, text, text_length);\n\tsha1_output(&sha1, inner);\n\n\t/* Generate the outer sum. */\n\tmemcpy(tmp_key, key, sizeof(tmp_key));\n\txor_block(tmp_key, opad, sizeof(tmp_key));\n\n\tsha1_init(&sha1);\n\tsha1_update(&sha1, tmp_key, sizeof(tmp_key));\n\tsha1_update(&sha1, inner, sizeof(inner));\n\tsha1_output(&sha1, outer);\n\n\t/* We don't need any of the keys any more. */\n\tmemset(key, 0, sizeof(key));\n\tmemset(tmp_key, 0, sizeof(tmp_key));\n\n\t/* Allocate space to store the output. */\n\t*mac_length = sizeof(outer);\n\t*mac = malloc(*mac_length);\n\tif (*mac == NULL) {\n\t\t*mac_length = 0;\n\t\treturn;\n\t}\n\n\tmemcpy(*mac, outer, *mac_length);\n}",
          "includes": [
            "#include \"sha1.h\"",
            "#include \"hmacsha1.h\"",
            "#include <security/pam_ext.h>",
            "#include <syslog.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [
            "#define MAXIMUM_KEY_SIZE SHA1_BLOCK_SIZE"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sha1.h\"\n#include \"hmacsha1.h\"\n#include <security/pam_ext.h>\n#include <syslog.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pwd.h>\n#include <grp.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"config.h\"\n\n#define MAXIMUM_KEY_SIZE SHA1_BLOCK_SIZE\n\nvoid\nhmac_sha1_generate(void **mac, size_t *mac_length,\n\t\t   const void *raw_key, size_t raw_key_size,\n\t\t   const void *text, size_t text_length)\n{\n\tunsigned char key[MAXIMUM_KEY_SIZE], tmp_key[MAXIMUM_KEY_SIZE];\n\tsize_t maximum_key_size = SHA1_BLOCK_SIZE,\n\t       minimum_key_size = SHA1_OUTPUT_SIZE;\n\tconst unsigned char ipad = 0x36, opad = 0x5c;\n\tstruct sha1_context sha1;\n\tunsigned char inner[SHA1_OUTPUT_SIZE], outer[SHA1_OUTPUT_SIZE];\n\n\t*mac = NULL;\n\t*mac_length = 0;\n\n#ifndef HMAC_ALLOW_SHORT_KEYS\n\t/* If the key is too short, don't bother. */\n\tif (raw_key_size < minimum_key_size) {\n\t\treturn;\n\t}\n#endif\n\n\t/* If the key is too long, \"compress\" it, else copy it and pad it\n\t * out with zero bytes. */\n\tmemset(key, 0, sizeof(key));\n\tif (raw_key_size > maximum_key_size) {\n\t\tsha1_init(&sha1);\n\t\tsha1_update(&sha1, raw_key, raw_key_size);\n\t\tsha1_output(&sha1, key);\n\t} else {\n\t\tmemmove(key, raw_key, raw_key_size);\n\t}\n\n\t/* Generate the inner sum. */\n\tmemcpy(tmp_key, key, sizeof(tmp_key));\n\txor_block(tmp_key, ipad, sizeof(tmp_key));\n\n\tsha1_init(&sha1);\n\tsha1_update(&sha1, tmp_key, sizeof(tmp_key));\n\tsha1_update(&sha1, text, text_length);\n\tsha1_output(&sha1, inner);\n\n\t/* Generate the outer sum. */\n\tmemcpy(tmp_key, key, sizeof(tmp_key));\n\txor_block(tmp_key, opad, sizeof(tmp_key));\n\n\tsha1_init(&sha1);\n\tsha1_update(&sha1, tmp_key, sizeof(tmp_key));\n\tsha1_update(&sha1, inner, sizeof(inner));\n\tsha1_output(&sha1, outer);\n\n\t/* We don't need any of the keys any more. */\n\tmemset(key, 0, sizeof(key));\n\tmemset(tmp_key, 0, sizeof(tmp_key));\n\n\t/* Allocate space to store the output. */\n\t*mac_length = sizeof(outer);\n\t*mac = malloc(*mac_length);\n\tif (*mac == NULL) {\n\t\t*mac_length = 0;\n\t\treturn;\n\t}\n\n\tmemcpy(*mac, outer, *mac_length);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PAM_ARRAY_SIZE",
          "args": [
            "vectors"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"hmacsha1.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"pam_inline.h\"\n\nstatic void\ntestvectors(void)\n{\n\tvoid *hmac;\n\tsize_t hmac_len;\n\tsize_t i, j;\n\tchar hex[3];\n\tstruct vector {\n\t\tconst char *key;\n\t\tint key_len;\n\t\tconst char *data;\n\t\tint data_len;\n\t\tconst char *hmac;\n\t} vectors[] = {\n\t\t{\n\t\t\"\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\\x0b\", 20,\n\t\t\"Hi There\", 8,\n\t\t\"b617318655057264e28bc0b6fb378c8ef146be00\",\n\t\t},\n\n#ifdef HMAC_ALLOW_SHORT_KEYS\n\t\t{\n\t\t\"Jefe\", 4,\n\t\t\"what do ya want for nothing?\", 28,\n\t\t\"effcdf6ae5eb2fa2d27416d5f184df9c259a7c79\",\n\t\t},\n#endif\n\n\t\t{\n\t\t\"\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\", 20,\n\t\t\"\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\\xdd\", 50,\n\t\t\"125d7342b9ac11cd91a39af48aa17b4f63f175d3\",\n\t\t},\n\n\t\t{\n\t\t\"\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\", 25,\n\t\t\"\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\\xcd\",\n\t\t50,\n\t\t\"4c9007f4026250c6bc8414f9bf50c86c2d7235da\",\n\t\t},\n\n\t\t{\n\t\t\"\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\\x0c\", 20,\n\t\t\"Test With Truncation\", 20,\n\t\t\"4c1a03424b55e07fe7f27be1d58bb9324a9a5a04\",\n\t\t},\n\n\t\t{\n\t\t\"\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\",\n\t\t80,\n\t\t\"Test Using Larger Than Block-Size Key - Hash Key First\", 54,\n\t\t\"aa4ae5e15272d00e95705637ce8a3b55ed402112\",\n\t\t},\n\n\t\t{\n\t\t\"\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\\xaa\",\n\t\t80,\n\t\t\"Test Using Larger Than Block-Size Key and Larger Than One Block-Size Data\", 73,\n\t\t\"e8e99d0f45237d786d6bbaa7965c7808bbff1a91\",\n\t\t},\n\t};\n\tfor (i = 0; i < PAM_ARRAY_SIZE(vectors); i++) {\n\t\thmac = NULL;\n\t\thmac_len = 0;\n\t\thmac_sha1_generate(&hmac, &hmac_len,\n\t\t\t\t   vectors[i].key, vectors[i].key_len,\n\t\t\t\t   vectors[i].data, vectors[i].data_len);\n\t\tif (hmac != NULL) {\n\t\t\tunsigned char *hmacc = hmac;\n\t\t\tfor (j = 0; j < hmac_len; j++) {\n\t\t\t\tsnprintf(hex, sizeof(hex), \"%02x\",\n\t\t\t\t\t hmacc[j] & 0xff);\n\t\t\t\tif (strncasecmp(hex,\n\t\t\t\t\t\tvectors[i].hmac + 2 * j,\n\t\t\t\t\t\t2) != 0) {\n\t\t\t\t\tprintf(\"Incorrect result for vector %lu\\n\",\n\t\t\t\t\t       (unsigned long) i + 1);\n\t\t\t\t\texit(1);\n\n\t\t\t\t}\n\t\t\t}\n\t\t\tfree(hmac);\n\t\t} else {\n\t\t\tprintf(\"Error in vector %lu.\\n\",\n\t\t\t       (unsigned long) i + 1);\n\t\t\texit(1);\n\t\t}\n\t}\n}"
  }
]