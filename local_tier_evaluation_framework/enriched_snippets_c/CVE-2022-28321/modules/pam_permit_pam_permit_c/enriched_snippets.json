[
  {
    "function_name": "pam_sm_close_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_permit/pam_permit.c",
    "lines": "77-82",
    "snippet": "int\npam_sm_close_session(pam_handle_t *pamh UNUSED, int flags UNUSED,\n\t\t     int argc UNUSED, const char **argv UNUSED)\n{\n     return PAM_SUCCESS;\n}",
    "includes": [
      "#include <security/_pam_macros.h>",
      "#include <security/pam_modules.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint\npam_sm_close_session(pam_handle_t *pamh UNUSED, int flags UNUSED,\n\t\t     int argc UNUSED, const char **argv UNUSED)\n{\n     return PAM_SUCCESS;\n}"
  },
  {
    "function_name": "pam_sm_open_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_permit/pam_permit.c",
    "lines": "70-75",
    "snippet": "int\npam_sm_open_session(pam_handle_t *pamh UNUSED, int flags UNUSED,\n\t\t    int argc UNUSED, const char **argv UNUSED)\n{\n    return PAM_SUCCESS;\n}",
    "includes": [
      "#include <security/_pam_macros.h>",
      "#include <security/pam_modules.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint\npam_sm_open_session(pam_handle_t *pamh UNUSED, int flags UNUSED,\n\t\t    int argc UNUSED, const char **argv UNUSED)\n{\n    return PAM_SUCCESS;\n}"
  },
  {
    "function_name": "pam_sm_chauthtok",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_permit/pam_permit.c",
    "lines": "61-66",
    "snippet": "int\npam_sm_chauthtok(pam_handle_t *pamh UNUSED, int flags UNUSED,\n\t\t int argc UNUSED, const char **argv UNUSED)\n{\n     return PAM_SUCCESS;\n}",
    "includes": [
      "#include <security/_pam_macros.h>",
      "#include <security/pam_modules.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint\npam_sm_chauthtok(pam_handle_t *pamh UNUSED, int flags UNUSED,\n\t\t int argc UNUSED, const char **argv UNUSED)\n{\n     return PAM_SUCCESS;\n}"
  },
  {
    "function_name": "pam_sm_acct_mgmt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_permit/pam_permit.c",
    "lines": "52-57",
    "snippet": "int\npam_sm_acct_mgmt(pam_handle_t *pamh UNUSED, int flags UNUSED,\n\t\t int argc UNUSED, const char **argv UNUSED)\n{\n     return PAM_SUCCESS;\n}",
    "includes": [
      "#include <security/_pam_macros.h>",
      "#include <security/pam_modules.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint\npam_sm_acct_mgmt(pam_handle_t *pamh UNUSED, int flags UNUSED,\n\t\t int argc UNUSED, const char **argv UNUSED)\n{\n     return PAM_SUCCESS;\n}"
  },
  {
    "function_name": "pam_sm_setcred",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_permit/pam_permit.c",
    "lines": "43-48",
    "snippet": "int\npam_sm_setcred(pam_handle_t *pamh UNUSED, int flags UNUSED,\n\t       int argc UNUSED, const char **argv UNUSED)\n{\n     return PAM_SUCCESS;\n}",
    "includes": [
      "#include <security/_pam_macros.h>",
      "#include <security/pam_modules.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint\npam_sm_setcred(pam_handle_t *pamh UNUSED, int flags UNUSED,\n\t       int argc UNUSED, const char **argv UNUSED)\n{\n     return PAM_SUCCESS;\n}"
  },
  {
    "function_name": "pam_sm_authenticate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_permit/pam_permit.c",
    "lines": "17-41",
    "snippet": "int\npam_sm_authenticate(pam_handle_t *pamh, int flags UNUSED,\n\t\t    int argc UNUSED, const char **argv UNUSED)\n{\n    int retval;\n    const char *user=NULL;\n\n    /*\n     * authentication requires we know who the user wants to be\n     */\n    retval = pam_get_user(pamh, &user, NULL);\n    if (retval != PAM_SUCCESS) {\n\tD((\"get user returned error: %s\", pam_strerror(pamh,retval)));\n\treturn retval;\n    }\n    if (*user == '\\0') {\n\tD((\"username not known\"));\n\tretval = pam_set_item(pamh, PAM_USER, (const void *) DEFAULT_USER);\n\tif (retval != PAM_SUCCESS)\n\t    return PAM_USER_UNKNOWN;\n    }\n    user = NULL;                                            /* clean up */\n\n    return PAM_SUCCESS;\n}",
    "includes": [
      "#include <security/_pam_macros.h>",
      "#include <security/pam_modules.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [
      "#define DEFAULT_USER \"nobody\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pam_set_item",
          "args": [
            "pamh",
            "PAM_USER",
            "(const void *) DEFAULT_USER"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "D",
          "args": [
            "(\"username not known\")"
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "MD5Name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_unix/md5.c",
          "lines": "53-62",
          "snippet": "void MD5Name(MD5Init)(struct MD5Context *ctx)\n{\n\tctx->buf.i[0] = 0x67452301U;\n\tctx->buf.i[1] = 0xefcdab89U;\n\tctx->buf.i[2] = 0x98badcfeU;\n\tctx->buf.i[3] = 0x10325476U;\n\n\tctx->bits[0] = 0;\n\tctx->bits[1] = 0;\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include <string.h>\n\nvoid MD5Name(MD5Init)(struct MD5Context *ctx)\n{\n\tctx->buf.i[0] = 0x67452301U;\n\tctx->buf.i[1] = 0xefcdab89U;\n\tctx->buf.i[2] = 0x98badcfeU;\n\tctx->buf.i[3] = 0x10325476U;\n\n\tctx->bits[0] = 0;\n\tctx->bits[1] = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pam_strerror",
          "args": [
            "pamh",
            "retval"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pam_get_user",
          "args": [
            "pamh",
            "&user",
            "NULL"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <security/_pam_macros.h>\n#include <security/pam_modules.h>\n#include <stdio.h>\n#include \"config.h\"\n\n#define DEFAULT_USER \"nobody\"\n\nint\npam_sm_authenticate(pam_handle_t *pamh, int flags UNUSED,\n\t\t    int argc UNUSED, const char **argv UNUSED)\n{\n    int retval;\n    const char *user=NULL;\n\n    /*\n     * authentication requires we know who the user wants to be\n     */\n    retval = pam_get_user(pamh, &user, NULL);\n    if (retval != PAM_SUCCESS) {\n\tD((\"get user returned error: %s\", pam_strerror(pamh,retval)));\n\treturn retval;\n    }\n    if (*user == '\\0') {\n\tD((\"username not known\"));\n\tretval = pam_set_item(pamh, PAM_USER, (const void *) DEFAULT_USER);\n\tif (retval != PAM_SUCCESS)\n\t    return PAM_USER_UNKNOWN;\n    }\n    user = NULL;                                            /* clean up */\n\n    return PAM_SUCCESS;\n}"
  }
]