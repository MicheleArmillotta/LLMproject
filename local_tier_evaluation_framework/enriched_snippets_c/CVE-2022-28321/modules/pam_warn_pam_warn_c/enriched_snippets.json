[
  {
    "function_name": "pam_sm_close_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_warn/pam_warn.c",
    "lines": "84-90",
    "snippet": "int\npam_sm_close_session(pam_handle_t *pamh, int flags,\n\t\t     int argc UNUSED, const char **argv UNUSED)\n{\n    log_items(pamh, __FUNCTION__, flags);\n    return PAM_IGNORE;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modules.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_items",
          "args": [
            "pamh",
            "__FUNCTION__",
            "flags"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "log_items",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_warn/pam_warn.c",
          "lines": "24-41",
          "snippet": "static void log_items(pam_handle_t *pamh, const char *function, int flags)\n{\n     const void *service=NULL, *user=NULL, *terminal=NULL,\n\t *rhost=NULL, *ruser=NULL;\n\n     OBTAIN(PAM_SERVICE, service, \"<unknown>\");\n     OBTAIN(PAM_TTY, terminal, \"<unknown>\");\n     OBTAIN(PAM_USER, user, \"<unknown>\");\n     OBTAIN(PAM_RUSER, ruser, \"<unknown>\");\n     OBTAIN(PAM_RHOST, rhost, \"<unknown>\");\n\n     pam_syslog(pamh, LOG_NOTICE,\n\t\t\"function=[%s] flags=%#x service=[%s] terminal=[%s] user=[%s]\"\n\t\t\" ruser=[%s] rhost=[%s]\\n\", function, flags,\n\t\t(const char *) service, (const char *) terminal,\n\t\t(const char *) user, (const char *) ruser,\n\t\t(const char *) rhost);\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modules.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modules.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <unistd.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic void log_items(pam_handle_t *pamh, const char *function, int flags)\n{\n     const void *service=NULL, *user=NULL, *terminal=NULL,\n\t *rhost=NULL, *ruser=NULL;\n\n     OBTAIN(PAM_SERVICE, service, \"<unknown>\");\n     OBTAIN(PAM_TTY, terminal, \"<unknown>\");\n     OBTAIN(PAM_USER, user, \"<unknown>\");\n     OBTAIN(PAM_RUSER, ruser, \"<unknown>\");\n     OBTAIN(PAM_RHOST, rhost, \"<unknown>\");\n\n     pam_syslog(pamh, LOG_NOTICE,\n\t\t\"function=[%s] flags=%#x service=[%s] terminal=[%s] user=[%s]\"\n\t\t\" ruser=[%s] rhost=[%s]\\n\", function, flags,\n\t\t(const char *) service, (const char *) terminal,\n\t\t(const char *) user, (const char *) ruser,\n\t\t(const char *) rhost);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modules.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <unistd.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint\npam_sm_close_session(pam_handle_t *pamh, int flags,\n\t\t     int argc UNUSED, const char **argv UNUSED)\n{\n    log_items(pamh, __FUNCTION__, flags);\n    return PAM_IGNORE;\n}"
  },
  {
    "function_name": "pam_sm_open_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_warn/pam_warn.c",
    "lines": "76-82",
    "snippet": "int\npam_sm_open_session(pam_handle_t *pamh, int flags,\n\t\t    int argc UNUSED, const char **argv UNUSED)\n{\n    log_items(pamh, __FUNCTION__, flags);\n    return PAM_IGNORE;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modules.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_items",
          "args": [
            "pamh",
            "__FUNCTION__",
            "flags"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "log_items",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_warn/pam_warn.c",
          "lines": "24-41",
          "snippet": "static void log_items(pam_handle_t *pamh, const char *function, int flags)\n{\n     const void *service=NULL, *user=NULL, *terminal=NULL,\n\t *rhost=NULL, *ruser=NULL;\n\n     OBTAIN(PAM_SERVICE, service, \"<unknown>\");\n     OBTAIN(PAM_TTY, terminal, \"<unknown>\");\n     OBTAIN(PAM_USER, user, \"<unknown>\");\n     OBTAIN(PAM_RUSER, ruser, \"<unknown>\");\n     OBTAIN(PAM_RHOST, rhost, \"<unknown>\");\n\n     pam_syslog(pamh, LOG_NOTICE,\n\t\t\"function=[%s] flags=%#x service=[%s] terminal=[%s] user=[%s]\"\n\t\t\" ruser=[%s] rhost=[%s]\\n\", function, flags,\n\t\t(const char *) service, (const char *) terminal,\n\t\t(const char *) user, (const char *) ruser,\n\t\t(const char *) rhost);\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modules.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modules.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <unistd.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic void log_items(pam_handle_t *pamh, const char *function, int flags)\n{\n     const void *service=NULL, *user=NULL, *terminal=NULL,\n\t *rhost=NULL, *ruser=NULL;\n\n     OBTAIN(PAM_SERVICE, service, \"<unknown>\");\n     OBTAIN(PAM_TTY, terminal, \"<unknown>\");\n     OBTAIN(PAM_USER, user, \"<unknown>\");\n     OBTAIN(PAM_RUSER, ruser, \"<unknown>\");\n     OBTAIN(PAM_RHOST, rhost, \"<unknown>\");\n\n     pam_syslog(pamh, LOG_NOTICE,\n\t\t\"function=[%s] flags=%#x service=[%s] terminal=[%s] user=[%s]\"\n\t\t\" ruser=[%s] rhost=[%s]\\n\", function, flags,\n\t\t(const char *) service, (const char *) terminal,\n\t\t(const char *) user, (const char *) ruser,\n\t\t(const char *) rhost);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modules.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <unistd.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint\npam_sm_open_session(pam_handle_t *pamh, int flags,\n\t\t    int argc UNUSED, const char **argv UNUSED)\n{\n    log_items(pamh, __FUNCTION__, flags);\n    return PAM_IGNORE;\n}"
  },
  {
    "function_name": "pam_sm_acct_mgmt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_warn/pam_warn.c",
    "lines": "68-74",
    "snippet": "int\npam_sm_acct_mgmt(pam_handle_t *pamh, int flags,\n\t\t int argc UNUSED, const char **argv UNUSED)\n{\n    log_items(pamh, __FUNCTION__, flags);\n    return PAM_IGNORE;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modules.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_items",
          "args": [
            "pamh",
            "__FUNCTION__",
            "flags"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "log_items",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_warn/pam_warn.c",
          "lines": "24-41",
          "snippet": "static void log_items(pam_handle_t *pamh, const char *function, int flags)\n{\n     const void *service=NULL, *user=NULL, *terminal=NULL,\n\t *rhost=NULL, *ruser=NULL;\n\n     OBTAIN(PAM_SERVICE, service, \"<unknown>\");\n     OBTAIN(PAM_TTY, terminal, \"<unknown>\");\n     OBTAIN(PAM_USER, user, \"<unknown>\");\n     OBTAIN(PAM_RUSER, ruser, \"<unknown>\");\n     OBTAIN(PAM_RHOST, rhost, \"<unknown>\");\n\n     pam_syslog(pamh, LOG_NOTICE,\n\t\t\"function=[%s] flags=%#x service=[%s] terminal=[%s] user=[%s]\"\n\t\t\" ruser=[%s] rhost=[%s]\\n\", function, flags,\n\t\t(const char *) service, (const char *) terminal,\n\t\t(const char *) user, (const char *) ruser,\n\t\t(const char *) rhost);\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modules.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modules.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <unistd.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic void log_items(pam_handle_t *pamh, const char *function, int flags)\n{\n     const void *service=NULL, *user=NULL, *terminal=NULL,\n\t *rhost=NULL, *ruser=NULL;\n\n     OBTAIN(PAM_SERVICE, service, \"<unknown>\");\n     OBTAIN(PAM_TTY, terminal, \"<unknown>\");\n     OBTAIN(PAM_USER, user, \"<unknown>\");\n     OBTAIN(PAM_RUSER, ruser, \"<unknown>\");\n     OBTAIN(PAM_RHOST, rhost, \"<unknown>\");\n\n     pam_syslog(pamh, LOG_NOTICE,\n\t\t\"function=[%s] flags=%#x service=[%s] terminal=[%s] user=[%s]\"\n\t\t\" ruser=[%s] rhost=[%s]\\n\", function, flags,\n\t\t(const char *) service, (const char *) terminal,\n\t\t(const char *) user, (const char *) ruser,\n\t\t(const char *) rhost);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modules.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <unistd.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint\npam_sm_acct_mgmt(pam_handle_t *pamh, int flags,\n\t\t int argc UNUSED, const char **argv UNUSED)\n{\n    log_items(pamh, __FUNCTION__, flags);\n    return PAM_IGNORE;\n}"
  },
  {
    "function_name": "pam_sm_chauthtok",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_warn/pam_warn.c",
    "lines": "61-66",
    "snippet": "int pam_sm_chauthtok(pam_handle_t *pamh, int flags,\n\t\t     int argc UNUSED, const char **argv UNUSED)\n{\n    log_items(pamh, __FUNCTION__, flags);\n    return PAM_IGNORE;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modules.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_items",
          "args": [
            "pamh",
            "__FUNCTION__",
            "flags"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "log_items",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_warn/pam_warn.c",
          "lines": "24-41",
          "snippet": "static void log_items(pam_handle_t *pamh, const char *function, int flags)\n{\n     const void *service=NULL, *user=NULL, *terminal=NULL,\n\t *rhost=NULL, *ruser=NULL;\n\n     OBTAIN(PAM_SERVICE, service, \"<unknown>\");\n     OBTAIN(PAM_TTY, terminal, \"<unknown>\");\n     OBTAIN(PAM_USER, user, \"<unknown>\");\n     OBTAIN(PAM_RUSER, ruser, \"<unknown>\");\n     OBTAIN(PAM_RHOST, rhost, \"<unknown>\");\n\n     pam_syslog(pamh, LOG_NOTICE,\n\t\t\"function=[%s] flags=%#x service=[%s] terminal=[%s] user=[%s]\"\n\t\t\" ruser=[%s] rhost=[%s]\\n\", function, flags,\n\t\t(const char *) service, (const char *) terminal,\n\t\t(const char *) user, (const char *) ruser,\n\t\t(const char *) rhost);\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modules.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modules.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <unistd.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic void log_items(pam_handle_t *pamh, const char *function, int flags)\n{\n     const void *service=NULL, *user=NULL, *terminal=NULL,\n\t *rhost=NULL, *ruser=NULL;\n\n     OBTAIN(PAM_SERVICE, service, \"<unknown>\");\n     OBTAIN(PAM_TTY, terminal, \"<unknown>\");\n     OBTAIN(PAM_USER, user, \"<unknown>\");\n     OBTAIN(PAM_RUSER, ruser, \"<unknown>\");\n     OBTAIN(PAM_RHOST, rhost, \"<unknown>\");\n\n     pam_syslog(pamh, LOG_NOTICE,\n\t\t\"function=[%s] flags=%#x service=[%s] terminal=[%s] user=[%s]\"\n\t\t\" ruser=[%s] rhost=[%s]\\n\", function, flags,\n\t\t(const char *) service, (const char *) terminal,\n\t\t(const char *) user, (const char *) ruser,\n\t\t(const char *) rhost);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modules.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <unistd.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint pam_sm_chauthtok(pam_handle_t *pamh, int flags,\n\t\t     int argc UNUSED, const char **argv UNUSED)\n{\n    log_items(pamh, __FUNCTION__, flags);\n    return PAM_IGNORE;\n}"
  },
  {
    "function_name": "pam_sm_setcred",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_warn/pam_warn.c",
    "lines": "52-57",
    "snippet": "int pam_sm_setcred(pam_handle_t *pamh, int flags,\n\t\t   int argc UNUSED, const char **argv UNUSED)\n{\n    log_items(pamh, __FUNCTION__, flags);\n    return PAM_IGNORE;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modules.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_items",
          "args": [
            "pamh",
            "__FUNCTION__",
            "flags"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "log_items",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_warn/pam_warn.c",
          "lines": "24-41",
          "snippet": "static void log_items(pam_handle_t *pamh, const char *function, int flags)\n{\n     const void *service=NULL, *user=NULL, *terminal=NULL,\n\t *rhost=NULL, *ruser=NULL;\n\n     OBTAIN(PAM_SERVICE, service, \"<unknown>\");\n     OBTAIN(PAM_TTY, terminal, \"<unknown>\");\n     OBTAIN(PAM_USER, user, \"<unknown>\");\n     OBTAIN(PAM_RUSER, ruser, \"<unknown>\");\n     OBTAIN(PAM_RHOST, rhost, \"<unknown>\");\n\n     pam_syslog(pamh, LOG_NOTICE,\n\t\t\"function=[%s] flags=%#x service=[%s] terminal=[%s] user=[%s]\"\n\t\t\" ruser=[%s] rhost=[%s]\\n\", function, flags,\n\t\t(const char *) service, (const char *) terminal,\n\t\t(const char *) user, (const char *) ruser,\n\t\t(const char *) rhost);\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modules.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modules.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <unistd.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic void log_items(pam_handle_t *pamh, const char *function, int flags)\n{\n     const void *service=NULL, *user=NULL, *terminal=NULL,\n\t *rhost=NULL, *ruser=NULL;\n\n     OBTAIN(PAM_SERVICE, service, \"<unknown>\");\n     OBTAIN(PAM_TTY, terminal, \"<unknown>\");\n     OBTAIN(PAM_USER, user, \"<unknown>\");\n     OBTAIN(PAM_RUSER, ruser, \"<unknown>\");\n     OBTAIN(PAM_RHOST, rhost, \"<unknown>\");\n\n     pam_syslog(pamh, LOG_NOTICE,\n\t\t\"function=[%s] flags=%#x service=[%s] terminal=[%s] user=[%s]\"\n\t\t\" ruser=[%s] rhost=[%s]\\n\", function, flags,\n\t\t(const char *) service, (const char *) terminal,\n\t\t(const char *) user, (const char *) ruser,\n\t\t(const char *) rhost);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modules.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <unistd.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint pam_sm_setcred(pam_handle_t *pamh, int flags,\n\t\t   int argc UNUSED, const char **argv UNUSED)\n{\n    log_items(pamh, __FUNCTION__, flags);\n    return PAM_IGNORE;\n}"
  },
  {
    "function_name": "pam_sm_authenticate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_warn/pam_warn.c",
    "lines": "45-50",
    "snippet": "int pam_sm_authenticate(pam_handle_t *pamh, int flags,\n\t\t\tint argc UNUSED, const char **argv UNUSED)\n{\n    log_items(pamh, __FUNCTION__, flags);\n    return PAM_IGNORE;\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modules.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_items",
          "args": [
            "pamh",
            "__FUNCTION__",
            "flags"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "log_items",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_warn/pam_warn.c",
          "lines": "24-41",
          "snippet": "static void log_items(pam_handle_t *pamh, const char *function, int flags)\n{\n     const void *service=NULL, *user=NULL, *terminal=NULL,\n\t *rhost=NULL, *ruser=NULL;\n\n     OBTAIN(PAM_SERVICE, service, \"<unknown>\");\n     OBTAIN(PAM_TTY, terminal, \"<unknown>\");\n     OBTAIN(PAM_USER, user, \"<unknown>\");\n     OBTAIN(PAM_RUSER, ruser, \"<unknown>\");\n     OBTAIN(PAM_RHOST, rhost, \"<unknown>\");\n\n     pam_syslog(pamh, LOG_NOTICE,\n\t\t\"function=[%s] flags=%#x service=[%s] terminal=[%s] user=[%s]\"\n\t\t\" ruser=[%s] rhost=[%s]\\n\", function, flags,\n\t\t(const char *) service, (const char *) terminal,\n\t\t(const char *) user, (const char *) ruser,\n\t\t(const char *) rhost);\n}",
          "includes": [
            "#include <security/pam_ext.h>",
            "#include <security/pam_modules.h>",
            "#include <stdarg.h>",
            "#include <syslog.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modules.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <unistd.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic void log_items(pam_handle_t *pamh, const char *function, int flags)\n{\n     const void *service=NULL, *user=NULL, *terminal=NULL,\n\t *rhost=NULL, *ruser=NULL;\n\n     OBTAIN(PAM_SERVICE, service, \"<unknown>\");\n     OBTAIN(PAM_TTY, terminal, \"<unknown>\");\n     OBTAIN(PAM_USER, user, \"<unknown>\");\n     OBTAIN(PAM_RUSER, ruser, \"<unknown>\");\n     OBTAIN(PAM_RHOST, rhost, \"<unknown>\");\n\n     pam_syslog(pamh, LOG_NOTICE,\n\t\t\"function=[%s] flags=%#x service=[%s] terminal=[%s] user=[%s]\"\n\t\t\" ruser=[%s] rhost=[%s]\\n\", function, flags,\n\t\t(const char *) service, (const char *) terminal,\n\t\t(const char *) user, (const char *) ruser,\n\t\t(const char *) rhost);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modules.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <unistd.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint pam_sm_authenticate(pam_handle_t *pamh, int flags,\n\t\t\tint argc UNUSED, const char **argv UNUSED)\n{\n    log_items(pamh, __FUNCTION__, flags);\n    return PAM_IGNORE;\n}"
  },
  {
    "function_name": "log_items",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2022-28321/repo/modules/pam_warn/pam_warn.c",
    "lines": "24-41",
    "snippet": "static void log_items(pam_handle_t *pamh, const char *function, int flags)\n{\n     const void *service=NULL, *user=NULL, *terminal=NULL,\n\t *rhost=NULL, *ruser=NULL;\n\n     OBTAIN(PAM_SERVICE, service, \"<unknown>\");\n     OBTAIN(PAM_TTY, terminal, \"<unknown>\");\n     OBTAIN(PAM_USER, user, \"<unknown>\");\n     OBTAIN(PAM_RUSER, ruser, \"<unknown>\");\n     OBTAIN(PAM_RHOST, rhost, \"<unknown>\");\n\n     pam_syslog(pamh, LOG_NOTICE,\n\t\t\"function=[%s] flags=%#x service=[%s] terminal=[%s] user=[%s]\"\n\t\t\" ruser=[%s] rhost=[%s]\\n\", function, flags,\n\t\t(const char *) service, (const char *) terminal,\n\t\t(const char *) user, (const char *) ruser,\n\t\t(const char *) rhost);\n}",
    "includes": [
      "#include <security/pam_ext.h>",
      "#include <security/pam_modules.h>",
      "#include <stdarg.h>",
      "#include <syslog.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pam_syslog",
          "args": [
            "pamh",
            "LOG_NOTICE",
            "\"function=[%s] flags=%#x service=[%s] terminal=[%s] user=[%s]\"\n\t\t\" ruser=[%s] rhost=[%s]\\n\"",
            "function",
            "flags",
            "(const char *) service",
            "(const char *) terminal",
            "(const char *) user",
            "(const char *) ruser",
            "(const char *) rhost"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OBTAIN",
          "args": [
            "PAM_RHOST",
            "rhost",
            "\"<unknown>\""
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OBTAIN",
          "args": [
            "PAM_RUSER",
            "ruser",
            "\"<unknown>\""
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OBTAIN",
          "args": [
            "PAM_USER",
            "user",
            "\"<unknown>\""
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OBTAIN",
          "args": [
            "PAM_TTY",
            "terminal",
            "\"<unknown>\""
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OBTAIN",
          "args": [
            "PAM_SERVICE",
            "service",
            "\"<unknown>\""
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <security/pam_ext.h>\n#include <security/pam_modules.h>\n#include <stdarg.h>\n#include <syslog.h>\n#include <unistd.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic void log_items(pam_handle_t *pamh, const char *function, int flags)\n{\n     const void *service=NULL, *user=NULL, *terminal=NULL,\n\t *rhost=NULL, *ruser=NULL;\n\n     OBTAIN(PAM_SERVICE, service, \"<unknown>\");\n     OBTAIN(PAM_TTY, terminal, \"<unknown>\");\n     OBTAIN(PAM_USER, user, \"<unknown>\");\n     OBTAIN(PAM_RUSER, ruser, \"<unknown>\");\n     OBTAIN(PAM_RHOST, rhost, \"<unknown>\");\n\n     pam_syslog(pamh, LOG_NOTICE,\n\t\t\"function=[%s] flags=%#x service=[%s] terminal=[%s] user=[%s]\"\n\t\t\" ruser=[%s] rhost=[%s]\\n\", function, flags,\n\t\t(const char *) service, (const char *) terminal,\n\t\t(const char *) user, (const char *) ruser,\n\t\t(const char *) rhost);\n}"
  }
]