[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
    "lines": "378-497",
    "snippet": "int main(int argc, char **argv)\n{\n\tchar *argv0 = argv[0];\n\tstatic const struct option long_options[] = {\n\t\t{ \"help\",\tno_argument,\t\tNULL, 'h' },\n\t\t{ \"verbose\",\tno_argument,\t\tNULL, 'v' },\n\t\t{ \"msg-type\",\trequired_argument,\tNULL, 't' },\n\t\t{ \"ifname\",\trequired_argument,\tNULL, 'i' },\n\t\t{ \"unsolicited\",no_argument,\t\tNULL, 'U' },\n\t\t{ NULL, 0, NULL, 0 }\n\t};\n\tint opt;\n\tstruct ndp *ndp;\n\tchar *msgtypestr = NULL;\n\tenum ndp_msg_type msg_type;\n\tchar *ifname = NULL;\n\tuint32_t ifindex;\n\tchar *cmd_name;\n\tint err;\n\tint res = EXIT_FAILURE;\n\n\twhile ((opt = getopt_long(argc, argv, \"hvt:i:U\",\n\t\t\t\t  long_options, NULL)) >= 0) {\n\n\t\tswitch(opt) {\n\t\tcase 'h':\n\t\t\tprint_help(argv0);\n\t\t\treturn EXIT_SUCCESS;\n\t\tcase 'v':\n\t\t\tg_verbosity++;\n\t\t\tbreak;\n\t\tcase 't':\n\t\t\tfree(msgtypestr);\n\t\t\tmsgtypestr = strdup(optarg);\n\t\t\tbreak;\n\t\tcase 'i':\n\t\t\tfree(ifname);\n\t\t\tifname = strdup(optarg);\n\t\t\tbreak;\n\t\tcase 'U':\n\t\t\tflags |= ND_OPT_NA_UNSOL;\n\t\t\tbreak;\n\t\tcase '?':\n\t\t\tpr_err(\"unknown option.\\n\");\n\t\t\tprint_help(argv0);\n\t\t\treturn EXIT_FAILURE;\n\t\tdefault:\n\t\t\tpr_err(\"unknown option \\\"%c\\\".\\n\", opt);\n\t\t\tprint_help(argv0);\n\t\t\treturn EXIT_FAILURE;\n\t\t}\n\t}\n\n\tif (optind >= argc) {\n\t\tpr_err(\"No command specified.\\n\");\n\t\tprint_help(argv0);\n\t\tgoto errout;\n\t}\n\n\targv += optind;\n\tcmd_name = *argv++;\n\targc -= optind + 1;\n\n\tifindex = 0;\n\tif (ifname) {\n\t\tifindex = if_nametoindex(ifname);\n\t\tif (!ifindex) {\n\t\t\tpr_err(\"Interface \\\"%s\\\" does not exist\\n\", ifname);\n\t\t\tgoto errout;\n\t\t}\n\t}\n\n\terr = get_msg_type(&msg_type, msgtypestr);\n\tif (err) {\n\t\tpr_err(\"Invalid message type \\\"%s\\\" selected\\n\", msgtypestr);\n\t\tprint_help(argv0);\n\t\tgoto errout;\n\t}\n\n\terr = ndp_open(&ndp);\n\tif (err) {\n\t\tpr_err(\"Failed to open ndp: %s\\n\", strerror(-err));\n\t\tgoto errout;\n\t}\n\n\tif (!strncmp(cmd_name, \"monitor\", strlen(cmd_name))) {\n\t\terr = run_cmd_monitor(ndp, msg_type, ifindex);\n\t} else if (!strncmp(cmd_name, \"send\", strlen(cmd_name))) {\n\t\tbool all_ok = true;\n\n\t\tif (msg_type == NDP_MSG_ALL) {\n\t\t\tpr_err(\"Message type must be selected\\n\");\n\t\t\tall_ok = false;\n\t\t}\n\t\tif (!ifindex) {\n\t\t\tpr_err(\"Interface name must be selected\\n\");\n\t\t\tall_ok = false;\n\t\t}\n\t\tif (!all_ok) {\n\t\t\tprint_help(argv0);\n\t\t\tgoto errout;\n\t\t}\n\t\terr = run_cmd_send(ndp, msg_type, ifindex);\n\t} else {\n\t\tpr_err(\"Unknown command \\\"%s\\\"\\n\", cmd_name);\n\t\tgoto ndp_close;\n\t}\n\n\tif (err) {\n\t\tpr_err(\"Command failed \\\"%s\\\"\\n\", strerror(-err));\n\t\tgoto ndp_close;\n\t}\n\n\tres = EXIT_SUCCESS;\n\nndp_close:\n\tndp_close(ndp);\nerrout:\n\treturn res;\n}",
    "includes": [
      "#include <ndp.h>",
      "#include <errno.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <net/if.h>",
      "#include <getopt.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int g_verbosity = DEFAULT_VERB;",
      "static uint8_t flags = ND_OPT_NORMAL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_close",
          "args": [
            "ndp"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1978-1983",
          "snippet": "NDP_EXPORT\nvoid ndp_close(struct ndp *ndp)\n{\n\tndp_sock_close(ndp);\n\tfree(ndp);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_close(struct ndp *ndp)\n{\n\tndp_sock_close(ndp);\n\tfree(ndp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Command failed \\\"%s\\\"\\n\"",
            "strerror(-err)"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "-err"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Unknown command \\\"%s\\\"\\n\"",
            "cmd_name"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "run_cmd_send",
          "args": [
            "ndp",
            "msg_type",
            "ifindex"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "run_cmd_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
          "lines": "334-356",
          "snippet": "static int run_cmd_send(struct ndp *ndp, enum ndp_msg_type msg_type,\n\t\t\tuint32_t ifindex)\n{\n\tstruct ndp_msg *msg;\n\tint err;\n\n\terr = ndp_msg_new(&msg, msg_type);\n\tif (err) {\n\t\tpr_err(\"Failed to create message\\n\");\n\t\treturn err;\n\t}\n\tndp_msg_ifindex_set(msg, ifindex);\n\n\terr = ndp_msg_send_with_flags(ndp, msg, flags);\n\tif (err) {\n\t\tpr_err(\"Failed to send message\\n\");\n\t\tgoto msg_destroy;\n\t}\n\nmsg_destroy:\n\tndp_msg_destroy(msg);\n\treturn err;\n}",
          "includes": [
            "#include <ndp.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <getopt.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static uint8_t flags = ND_OPT_NORMAL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic uint8_t flags = ND_OPT_NORMAL;\n\nstatic int run_cmd_send(struct ndp *ndp, enum ndp_msg_type msg_type,\n\t\t\tuint32_t ifindex)\n{\n\tstruct ndp_msg *msg;\n\tint err;\n\n\terr = ndp_msg_new(&msg, msg_type);\n\tif (err) {\n\t\tpr_err(\"Failed to create message\\n\");\n\t\treturn err;\n\t}\n\tndp_msg_ifindex_set(msg, ifindex);\n\n\terr = ndp_msg_send_with_flags(ndp, msg, flags);\n\tif (err) {\n\t\tpr_err(\"Failed to send message\\n\");\n\t\tgoto msg_destroy;\n\t}\n\nmsg_destroy:\n\tndp_msg_destroy(msg);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "print_help",
          "args": [
            "argv0"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "print_help",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
          "lines": "130-143",
          "snippet": "static void print_help(const char *argv0) {\n\tpr_out(\n            \"%s [options] command\\n\"\n            \"\\t-h --help                Show this help\\n\"\n            \"\\t-v --verbose             Increase output verbosity\\n\"\n            \"\\t-t --msg-type=TYPE       Specify message type\\n\"\n\t    \"\\t                         (\\\"rs\\\", \\\"ra\\\", \\\"ns\\\", \\\"na\\\")\\n\"\n            \"\\t-i --ifname=IFNAME       Specify interface name\\n\"\n            \"\\t-U --unsolicited         Send Unsolicited NA\\n\"\n\t    \"Available commands:\\n\"\n\t    \"\\tmonitor\\n\"\n\t    \"\\tsend\\n\",\n            argv0);\n}",
          "includes": [
            "#include <ndp.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <getopt.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void print_help(const char *argv0) {\n\tpr_out(\n            \"%s [options] command\\n\"\n            \"\\t-h --help                Show this help\\n\"\n            \"\\t-v --verbose             Increase output verbosity\\n\"\n            \"\\t-t --msg-type=TYPE       Specify message type\\n\"\n\t    \"\\t                         (\\\"rs\\\", \\\"ra\\\", \\\"ns\\\", \\\"na\\\")\\n\"\n            \"\\t-i --ifname=IFNAME       Specify interface name\\n\"\n            \"\\t-U --unsolicited         Send Unsolicited NA\\n\"\n\t    \"Available commands:\\n\"\n\t    \"\\tmonitor\\n\"\n\t    \"\\tsend\\n\",\n            argv0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Interface name must be selected\\n\""
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Message type must be selected\\n\""
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "cmd_name",
            "\"send\"",
            "strlen(cmd_name)"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "cmd_name"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "run_cmd_monitor",
          "args": [
            "ndp",
            "msg_type",
            "ifindex"
          ],
          "line": 464
        },
        "resolved": true,
        "details": {
          "function_name": "run_cmd_monitor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
          "lines": "317-332",
          "snippet": "static int run_cmd_monitor(struct ndp *ndp, enum ndp_msg_type msg_type,\n\t\t\t   uint32_t ifindex)\n{\n\tint err;\n\n\terr = ndp_msgrcv_handler_register(ndp, &msgrcv_handler_func, msg_type,\n\t\t\t\t\t  ifindex, NULL);\n\tif (err) {\n\t\tpr_err(\"Failed to register msgrcv handler\\n\");\n\t\treturn err;\n\t}\n\terr = run_main_loop(ndp);\n\tndp_msgrcv_handler_unregister(ndp, &msgrcv_handler_func, msg_type,\n\t\t\t\t      ifindex, NULL);\n\treturn err;\n}",
          "includes": [
            "#include <ndp.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <getopt.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int run_cmd_monitor(struct ndp *ndp, enum ndp_msg_type msg_type,\n\t\t\t   uint32_t ifindex)\n{\n\tint err;\n\n\terr = ndp_msgrcv_handler_register(ndp, &msgrcv_handler_func, msg_type,\n\t\t\t\t\t  ifindex, NULL);\n\tif (err) {\n\t\tpr_err(\"Failed to register msgrcv handler\\n\");\n\t\treturn err;\n\t}\n\terr = run_main_loop(ndp);\n\tndp_msgrcv_handler_unregister(ndp, &msgrcv_handler_func, msg_type,\n\t\t\t\t      ifindex, NULL);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "cmd_name",
            "\"monitor\"",
            "strlen(cmd_name)"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "cmd_name"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Failed to open ndp: %s\\n\"",
            "strerror(-err)"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "-err"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_open",
          "args": [
            "&ndp"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1940-1970",
          "snippet": "NDP_EXPORT\nint ndp_open(struct ndp **p_ndp)\n{\n\tstruct ndp *ndp;\n\tconst char *env;\n\tint err;\n\n\tndp = myzalloc(sizeof(*ndp));\n\tif (!ndp)\n\t\treturn -ENOMEM;\n\tndp->log_fn = log_stderr;\n\tndp->log_priority = LOG_ERR;\n\t/* environment overwrites config */\n\tenv = getenv(\"NDP_LOG\");\n\tif (env != NULL)\n\t\tndp_set_log_priority(ndp, log_priority(env));\n\n\tdbg(ndp, \"ndp context %p created.\", ndp);\n\tdbg(ndp, \"log_priority=%d\", ndp->log_priority);\n\n\tlist_init(&ndp->msgrcv_handler_list);\n\terr = ndp_sock_open(ndp);\n\tif (err)\n\t\tgoto free_ndp;\n\n\t*p_ndp = ndp;\n\treturn 0;\nfree_ndp:\n\tfree(ndp);\n\treturn err;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nint ndp_open(struct ndp **p_ndp)\n{\n\tstruct ndp *ndp;\n\tconst char *env;\n\tint err;\n\n\tndp = myzalloc(sizeof(*ndp));\n\tif (!ndp)\n\t\treturn -ENOMEM;\n\tndp->log_fn = log_stderr;\n\tndp->log_priority = LOG_ERR;\n\t/* environment overwrites config */\n\tenv = getenv(\"NDP_LOG\");\n\tif (env != NULL)\n\t\tndp_set_log_priority(ndp, log_priority(env));\n\n\tdbg(ndp, \"ndp context %p created.\", ndp);\n\tdbg(ndp, \"log_priority=%d\", ndp->log_priority);\n\n\tlist_init(&ndp->msgrcv_handler_list);\n\terr = ndp_sock_open(ndp);\n\tif (err)\n\t\tgoto free_ndp;\n\n\t*p_ndp = ndp;\n\treturn 0;\nfree_ndp:\n\tfree(ndp);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Invalid message type \\\"%s\\\" selected\\n\"",
            "msgtypestr"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_msg_type",
          "args": [
            "&msg_type",
            "msgtypestr"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "get_msg_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
          "lines": "359-376",
          "snippet": "static int get_msg_type(enum ndp_msg_type *p_msg_type, char *msgtypestr)\n{\n\tif (!msgtypestr)\n\t\t*p_msg_type = NDP_MSG_ALL;\n\telse if (!strcmp(msgtypestr, \"rs\"))\n\t\t*p_msg_type = NDP_MSG_RS;\n\telse if (!strcmp(msgtypestr, \"ra\"))\n\t\t*p_msg_type = NDP_MSG_RA;\n\telse if (!strcmp(msgtypestr, \"ns\"))\n\t\t*p_msg_type = NDP_MSG_NS;\n\telse if (!strcmp(msgtypestr, \"na\"))\n\t\t*p_msg_type = NDP_MSG_NA;\n\telse if (!strcmp(msgtypestr, \"r\"))\n\t\t*p_msg_type = NDP_MSG_R;\n\telse\n\t\treturn -EINVAL;\n\treturn 0;\n}",
          "includes": [
            "#include <ndp.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <getopt.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int get_msg_type(enum ndp_msg_type *p_msg_type, char *msgtypestr)\n{\n\tif (!msgtypestr)\n\t\t*p_msg_type = NDP_MSG_ALL;\n\telse if (!strcmp(msgtypestr, \"rs\"))\n\t\t*p_msg_type = NDP_MSG_RS;\n\telse if (!strcmp(msgtypestr, \"ra\"))\n\t\t*p_msg_type = NDP_MSG_RA;\n\telse if (!strcmp(msgtypestr, \"ns\"))\n\t\t*p_msg_type = NDP_MSG_NS;\n\telse if (!strcmp(msgtypestr, \"na\"))\n\t\t*p_msg_type = NDP_MSG_NA;\n\telse if (!strcmp(msgtypestr, \"r\"))\n\t\t*p_msg_type = NDP_MSG_R;\n\telse\n\t\treturn -EINVAL;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Interface \\\"%s\\\" does not exist\\n\"",
            "ifname"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "if_nametoindex",
          "args": [
            "ifname"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"No command specified.\\n\""
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"unknown option \\\"%c\\\".\\n\"",
            "opt"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"unknown option.\\n\""
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "optarg"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "ifname"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "optarg"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "msgtypestr"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getopt_long",
          "args": [
            "argc",
            "argv",
            "\"hvt:i:U\"",
            "long_options",
            "NULL"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int g_verbosity = DEFAULT_VERB;\nstatic uint8_t flags = ND_OPT_NORMAL;\n\nint main(int argc, char **argv)\n{\n\tchar *argv0 = argv[0];\n\tstatic const struct option long_options[] = {\n\t\t{ \"help\",\tno_argument,\t\tNULL, 'h' },\n\t\t{ \"verbose\",\tno_argument,\t\tNULL, 'v' },\n\t\t{ \"msg-type\",\trequired_argument,\tNULL, 't' },\n\t\t{ \"ifname\",\trequired_argument,\tNULL, 'i' },\n\t\t{ \"unsolicited\",no_argument,\t\tNULL, 'U' },\n\t\t{ NULL, 0, NULL, 0 }\n\t};\n\tint opt;\n\tstruct ndp *ndp;\n\tchar *msgtypestr = NULL;\n\tenum ndp_msg_type msg_type;\n\tchar *ifname = NULL;\n\tuint32_t ifindex;\n\tchar *cmd_name;\n\tint err;\n\tint res = EXIT_FAILURE;\n\n\twhile ((opt = getopt_long(argc, argv, \"hvt:i:U\",\n\t\t\t\t  long_options, NULL)) >= 0) {\n\n\t\tswitch(opt) {\n\t\tcase 'h':\n\t\t\tprint_help(argv0);\n\t\t\treturn EXIT_SUCCESS;\n\t\tcase 'v':\n\t\t\tg_verbosity++;\n\t\t\tbreak;\n\t\tcase 't':\n\t\t\tfree(msgtypestr);\n\t\t\tmsgtypestr = strdup(optarg);\n\t\t\tbreak;\n\t\tcase 'i':\n\t\t\tfree(ifname);\n\t\t\tifname = strdup(optarg);\n\t\t\tbreak;\n\t\tcase 'U':\n\t\t\tflags |= ND_OPT_NA_UNSOL;\n\t\t\tbreak;\n\t\tcase '?':\n\t\t\tpr_err(\"unknown option.\\n\");\n\t\t\tprint_help(argv0);\n\t\t\treturn EXIT_FAILURE;\n\t\tdefault:\n\t\t\tpr_err(\"unknown option \\\"%c\\\".\\n\", opt);\n\t\t\tprint_help(argv0);\n\t\t\treturn EXIT_FAILURE;\n\t\t}\n\t}\n\n\tif (optind >= argc) {\n\t\tpr_err(\"No command specified.\\n\");\n\t\tprint_help(argv0);\n\t\tgoto errout;\n\t}\n\n\targv += optind;\n\tcmd_name = *argv++;\n\targc -= optind + 1;\n\n\tifindex = 0;\n\tif (ifname) {\n\t\tifindex = if_nametoindex(ifname);\n\t\tif (!ifindex) {\n\t\t\tpr_err(\"Interface \\\"%s\\\" does not exist\\n\", ifname);\n\t\t\tgoto errout;\n\t\t}\n\t}\n\n\terr = get_msg_type(&msg_type, msgtypestr);\n\tif (err) {\n\t\tpr_err(\"Invalid message type \\\"%s\\\" selected\\n\", msgtypestr);\n\t\tprint_help(argv0);\n\t\tgoto errout;\n\t}\n\n\terr = ndp_open(&ndp);\n\tif (err) {\n\t\tpr_err(\"Failed to open ndp: %s\\n\", strerror(-err));\n\t\tgoto errout;\n\t}\n\n\tif (!strncmp(cmd_name, \"monitor\", strlen(cmd_name))) {\n\t\terr = run_cmd_monitor(ndp, msg_type, ifindex);\n\t} else if (!strncmp(cmd_name, \"send\", strlen(cmd_name))) {\n\t\tbool all_ok = true;\n\n\t\tif (msg_type == NDP_MSG_ALL) {\n\t\t\tpr_err(\"Message type must be selected\\n\");\n\t\t\tall_ok = false;\n\t\t}\n\t\tif (!ifindex) {\n\t\t\tpr_err(\"Interface name must be selected\\n\");\n\t\t\tall_ok = false;\n\t\t}\n\t\tif (!all_ok) {\n\t\t\tprint_help(argv0);\n\t\t\tgoto errout;\n\t\t}\n\t\terr = run_cmd_send(ndp, msg_type, ifindex);\n\t} else {\n\t\tpr_err(\"Unknown command \\\"%s\\\"\\n\", cmd_name);\n\t\tgoto ndp_close;\n\t}\n\n\tif (err) {\n\t\tpr_err(\"Command failed \\\"%s\\\"\\n\", strerror(-err));\n\t\tgoto ndp_close;\n\t}\n\n\tres = EXIT_SUCCESS;\n\nndp_close:\n\tndp_close(ndp);\nerrout:\n\treturn res;\n}"
  },
  {
    "function_name": "get_msg_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
    "lines": "359-376",
    "snippet": "static int get_msg_type(enum ndp_msg_type *p_msg_type, char *msgtypestr)\n{\n\tif (!msgtypestr)\n\t\t*p_msg_type = NDP_MSG_ALL;\n\telse if (!strcmp(msgtypestr, \"rs\"))\n\t\t*p_msg_type = NDP_MSG_RS;\n\telse if (!strcmp(msgtypestr, \"ra\"))\n\t\t*p_msg_type = NDP_MSG_RA;\n\telse if (!strcmp(msgtypestr, \"ns\"))\n\t\t*p_msg_type = NDP_MSG_NS;\n\telse if (!strcmp(msgtypestr, \"na\"))\n\t\t*p_msg_type = NDP_MSG_NA;\n\telse if (!strcmp(msgtypestr, \"r\"))\n\t\t*p_msg_type = NDP_MSG_R;\n\telse\n\t\treturn -EINVAL;\n\treturn 0;\n}",
    "includes": [
      "#include <ndp.h>",
      "#include <errno.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <net/if.h>",
      "#include <getopt.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "msgtypestr",
            "\"r\""
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "msgtypestr",
            "\"na\""
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "msgtypestr",
            "\"ns\""
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "msgtypestr",
            "\"ra\""
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "msgtypestr",
            "\"rs\""
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int get_msg_type(enum ndp_msg_type *p_msg_type, char *msgtypestr)\n{\n\tif (!msgtypestr)\n\t\t*p_msg_type = NDP_MSG_ALL;\n\telse if (!strcmp(msgtypestr, \"rs\"))\n\t\t*p_msg_type = NDP_MSG_RS;\n\telse if (!strcmp(msgtypestr, \"ra\"))\n\t\t*p_msg_type = NDP_MSG_RA;\n\telse if (!strcmp(msgtypestr, \"ns\"))\n\t\t*p_msg_type = NDP_MSG_NS;\n\telse if (!strcmp(msgtypestr, \"na\"))\n\t\t*p_msg_type = NDP_MSG_NA;\n\telse if (!strcmp(msgtypestr, \"r\"))\n\t\t*p_msg_type = NDP_MSG_R;\n\telse\n\t\treturn -EINVAL;\n\treturn 0;\n}"
  },
  {
    "function_name": "run_cmd_send",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
    "lines": "334-356",
    "snippet": "static int run_cmd_send(struct ndp *ndp, enum ndp_msg_type msg_type,\n\t\t\tuint32_t ifindex)\n{\n\tstruct ndp_msg *msg;\n\tint err;\n\n\terr = ndp_msg_new(&msg, msg_type);\n\tif (err) {\n\t\tpr_err(\"Failed to create message\\n\");\n\t\treturn err;\n\t}\n\tndp_msg_ifindex_set(msg, ifindex);\n\n\terr = ndp_msg_send_with_flags(ndp, msg, flags);\n\tif (err) {\n\t\tpr_err(\"Failed to send message\\n\");\n\t\tgoto msg_destroy;\n\t}\n\nmsg_destroy:\n\tndp_msg_destroy(msg);\n\treturn err;\n}",
    "includes": [
      "#include <ndp.h>",
      "#include <errno.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <net/if.h>",
      "#include <getopt.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static uint8_t flags = ND_OPT_NORMAL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_destroy",
          "args": [
            "msg"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "457-461",
          "snippet": "NDP_EXPORT\nvoid ndp_msg_destroy(struct ndp_msg *msg)\n{\n\tfree(msg);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nvoid ndp_msg_destroy(struct ndp_msg *msg)\n{\n\tfree(msg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Failed to send message\\n\""
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_send_with_flags",
          "args": [
            "ndp",
            "msg",
            "flags"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_send_with_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "724-748",
          "snippet": "NDP_EXPORT\nint ndp_msg_send_with_flags(struct ndp *ndp, struct ndp_msg *msg, uint8_t flags)\n{\n\tenum ndp_msg_type msg_type = ndp_msg_type(msg);\n\n\tif (ndp_msg_type_info(msg_type)->addrto_adjust)\n\t\tndp_msg_type_info(msg_type)->addrto_adjust(&msg->addrto);\n\n\tswitch (msg_type) {\n\t\tcase NDP_MSG_NA:\n\t\t\tif (flags & ND_OPT_NA_UNSOL) {\n\t\t\t\tndp_msgna_flag_override_set((struct ndp_msgna*)&msg->nd_msg, true);\n\t\t\t\tndp_msgna_flag_solicited_set((struct ndp_msgna*)&msg->nd_msg, false);\n\t\t\t\tndp_msg_addrto_adjust_all_nodes(&msg->addrto);\n\t\t\t} else {\n\t\t\t\tndp_msgna_flag_solicited_set((struct ndp_msgna*)&msg->nd_msg, true);\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\treturn mysendto6(ndp->sock, msg->buf, msg->len, 0,\n\t\t\t &msg->addrto, msg->ifindex);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nint ndp_msg_send_with_flags(struct ndp *ndp, struct ndp_msg *msg, uint8_t flags)\n{\n\tenum ndp_msg_type msg_type = ndp_msg_type(msg);\n\n\tif (ndp_msg_type_info(msg_type)->addrto_adjust)\n\t\tndp_msg_type_info(msg_type)->addrto_adjust(&msg->addrto);\n\n\tswitch (msg_type) {\n\t\tcase NDP_MSG_NA:\n\t\t\tif (flags & ND_OPT_NA_UNSOL) {\n\t\t\t\tndp_msgna_flag_override_set((struct ndp_msgna*)&msg->nd_msg, true);\n\t\t\t\tndp_msgna_flag_solicited_set((struct ndp_msgna*)&msg->nd_msg, false);\n\t\t\t\tndp_msg_addrto_adjust_all_nodes(&msg->addrto);\n\t\t\t} else {\n\t\t\t\tndp_msgna_flag_solicited_set((struct ndp_msgna*)&msg->nd_msg, true);\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\treturn mysendto6(ndp->sock, msg->buf, msg->len, 0,\n\t\t\t &msg->addrto, msg->ifindex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_ifindex_set",
          "args": [
            "msg",
            "ifindex"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_ifindex_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "693-697",
          "snippet": "NDP_EXPORT\nvoid ndp_msg_ifindex_set(struct ndp_msg *msg, uint32_t ifindex)\n{\n\tmsg->ifindex = ifindex;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nvoid ndp_msg_ifindex_set(struct ndp_msg *msg, uint32_t ifindex)\n{\n\tmsg->ifindex = ifindex;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Failed to create message\\n\""
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_new",
          "args": [
            "&msg",
            "msg_type"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "437-450",
          "snippet": "NDP_EXPORT\nint ndp_msg_new(struct ndp_msg **p_msg, enum ndp_msg_type msg_type)\n{\n\tstruct ndp_msg *msg;\n\n\tif (msg_type == NDP_MSG_ALL)\n\t\treturn -EINVAL;\n\tmsg = ndp_msg_alloc();\n\tif (!msg)\n\t\treturn -ENOMEM;\n\tndp_msg_init(msg, msg_type);\n\t*p_msg = msg;\n\treturn 0;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nint ndp_msg_new(struct ndp_msg **p_msg, enum ndp_msg_type msg_type)\n{\n\tstruct ndp_msg *msg;\n\n\tif (msg_type == NDP_MSG_ALL)\n\t\treturn -EINVAL;\n\tmsg = ndp_msg_alloc();\n\tif (!msg)\n\t\treturn -ENOMEM;\n\tndp_msg_init(msg, msg_type);\n\t*p_msg = msg;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic uint8_t flags = ND_OPT_NORMAL;\n\nstatic int run_cmd_send(struct ndp *ndp, enum ndp_msg_type msg_type,\n\t\t\tuint32_t ifindex)\n{\n\tstruct ndp_msg *msg;\n\tint err;\n\n\terr = ndp_msg_new(&msg, msg_type);\n\tif (err) {\n\t\tpr_err(\"Failed to create message\\n\");\n\t\treturn err;\n\t}\n\tndp_msg_ifindex_set(msg, ifindex);\n\n\terr = ndp_msg_send_with_flags(ndp, msg, flags);\n\tif (err) {\n\t\tpr_err(\"Failed to send message\\n\");\n\t\tgoto msg_destroy;\n\t}\n\nmsg_destroy:\n\tndp_msg_destroy(msg);\n\treturn err;\n}"
  },
  {
    "function_name": "run_cmd_monitor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
    "lines": "317-332",
    "snippet": "static int run_cmd_monitor(struct ndp *ndp, enum ndp_msg_type msg_type,\n\t\t\t   uint32_t ifindex)\n{\n\tint err;\n\n\terr = ndp_msgrcv_handler_register(ndp, &msgrcv_handler_func, msg_type,\n\t\t\t\t\t  ifindex, NULL);\n\tif (err) {\n\t\tpr_err(\"Failed to register msgrcv handler\\n\");\n\t\treturn err;\n\t}\n\terr = run_main_loop(ndp);\n\tndp_msgrcv_handler_unregister(ndp, &msgrcv_handler_func, msg_type,\n\t\t\t\t      ifindex, NULL);\n\treturn err;\n}",
    "includes": [
      "#include <ndp.h>",
      "#include <errno.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <net/if.h>",
      "#include <getopt.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msgrcv_handler_unregister",
          "args": [
            "ndp",
            "&msgrcv_handler_func",
            "msg_type",
            "ifindex",
            "NULL"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msgrcv_handler_unregister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1844-1857",
          "snippet": "NDP_EXPORT\nvoid ndp_msgrcv_handler_unregister(struct ndp *ndp, ndp_msgrcv_handler_func_t func,\n\t\t\t\t   enum ndp_msg_type msg_type, uint32_t ifindex,\n\t\t\t\t   void *priv)\n{\n\tstruct ndp_msgrcv_handler_item *handler_item;\n\n\thandler_item = ndp_find_msgrcv_handler_item(ndp, func, msg_type,\n\t\t\t\t\t\t    ifindex, priv);\n\tif (!handler_item)\n\t\treturn;\n\tlist_del(&handler_item->list);\n\tfree(handler_item);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_msgrcv_handler_unregister(struct ndp *ndp, ndp_msgrcv_handler_func_t func,\n\t\t\t\t   enum ndp_msg_type msg_type, uint32_t ifindex,\n\t\t\t\t   void *priv)\n{\n\tstruct ndp_msgrcv_handler_item *handler_item;\n\n\thandler_item = ndp_find_msgrcv_handler_item(ndp, func, msg_type,\n\t\t\t\t\t\t    ifindex, priv);\n\tif (!handler_item)\n\t\treturn;\n\tlist_del(&handler_item->list);\n\tfree(handler_item);\n}"
        }
      },
      {
        "call_info": {
          "callee": "run_main_loop",
          "args": [
            "ndp"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "run_main_loop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
          "lines": "59-128",
          "snippet": "static int run_main_loop(struct ndp *ndp)\n{\n\tfd_set rfds;\n\tfd_set rfds_tmp;\n\tint fdmax;\n\tint ret;\n\tstruct sigaction siginfo;\n\tsigset_t mask;\n\tint ndp_fd;\n\tint err = 0;\n\n\tsigemptyset(&siginfo.sa_mask);\n\tsiginfo.sa_flags = 0;\n\tsiginfo.sa_handler = empty_signal_handler;\n\tret = sigaction(SIGINT, &siginfo, NULL);\n\tif (ret == -1) {\n\t\tpr_err(\"Failed to set SIGINT handler\\n\");\n\t\treturn -errno;\n\t}\n\tret = sigaction(SIGQUIT, &siginfo, NULL);\n\tif (ret == -1) {\n\t\tpr_err(\"Failed to set SIGQUIT handler\\n\");\n\t\treturn -errno;\n\t}\n\tret = sigaction(SIGTERM, &siginfo, NULL);\n\tif (ret == -1) {\n\t\tpr_err(\"Failed to set SIGTERM handler\\n\");\n\t\treturn -errno;\n\t}\n\n\tsigemptyset(&mask);\n\tsigaddset(&mask, SIGINT);\n\tsigaddset(&mask, SIGQUIT);\n\tsigaddset(&mask, SIGTERM);\n\n\tret = sigprocmask(SIG_BLOCK, &mask, NULL);\n\tif (ret == -1) {\n\t\tpr_err(\"Failed to set blocked signals\\n\");\n\t\treturn -errno;\n\t}\n\n\tsigemptyset(&mask);\n\n\tFD_ZERO(&rfds);\n\tndp_fd = ndp_get_eventfd(ndp);\n\tFD_SET(ndp_fd, &rfds);\n\tfdmax = ndp_fd + 1;\n\n\tfor (;;) {\n\t\trfds_tmp = rfds;\n\t\tret = pselect(fdmax, &rfds_tmp, NULL, NULL, NULL, &mask);\n\t\tif (ret == -1) {\n\t\t\tif (errno == EINTR) {\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t\tpr_err(\"Select failed\\n\");\n\t\t\terr = -errno;\n\t\t\tgoto out;\n\t\t}\n\t\tif (FD_ISSET(ndp_fd, &rfds_tmp)) {\n\t\t\terr = ndp_call_eventfd_handler(ndp);\n\t\t\tif (err) {\n\t\t\t\tpr_err(\"ndp eventfd handler call failed\\n\");\n\t\t\t\treturn err;\n\t\t\t}\n\t\t}\n\t}\nout:\n\treturn err;\n}",
          "includes": [
            "#include <ndp.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <getopt.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int run_main_loop(struct ndp *ndp)\n{\n\tfd_set rfds;\n\tfd_set rfds_tmp;\n\tint fdmax;\n\tint ret;\n\tstruct sigaction siginfo;\n\tsigset_t mask;\n\tint ndp_fd;\n\tint err = 0;\n\n\tsigemptyset(&siginfo.sa_mask);\n\tsiginfo.sa_flags = 0;\n\tsiginfo.sa_handler = empty_signal_handler;\n\tret = sigaction(SIGINT, &siginfo, NULL);\n\tif (ret == -1) {\n\t\tpr_err(\"Failed to set SIGINT handler\\n\");\n\t\treturn -errno;\n\t}\n\tret = sigaction(SIGQUIT, &siginfo, NULL);\n\tif (ret == -1) {\n\t\tpr_err(\"Failed to set SIGQUIT handler\\n\");\n\t\treturn -errno;\n\t}\n\tret = sigaction(SIGTERM, &siginfo, NULL);\n\tif (ret == -1) {\n\t\tpr_err(\"Failed to set SIGTERM handler\\n\");\n\t\treturn -errno;\n\t}\n\n\tsigemptyset(&mask);\n\tsigaddset(&mask, SIGINT);\n\tsigaddset(&mask, SIGQUIT);\n\tsigaddset(&mask, SIGTERM);\n\n\tret = sigprocmask(SIG_BLOCK, &mask, NULL);\n\tif (ret == -1) {\n\t\tpr_err(\"Failed to set blocked signals\\n\");\n\t\treturn -errno;\n\t}\n\n\tsigemptyset(&mask);\n\n\tFD_ZERO(&rfds);\n\tndp_fd = ndp_get_eventfd(ndp);\n\tFD_SET(ndp_fd, &rfds);\n\tfdmax = ndp_fd + 1;\n\n\tfor (;;) {\n\t\trfds_tmp = rfds;\n\t\tret = pselect(fdmax, &rfds_tmp, NULL, NULL, NULL, &mask);\n\t\tif (ret == -1) {\n\t\t\tif (errno == EINTR) {\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t\tpr_err(\"Select failed\\n\");\n\t\t\terr = -errno;\n\t\t\tgoto out;\n\t\t}\n\t\tif (FD_ISSET(ndp_fd, &rfds_tmp)) {\n\t\t\terr = ndp_call_eventfd_handler(ndp);\n\t\t\tif (err) {\n\t\t\t\tpr_err(\"ndp eventfd handler call failed\\n\");\n\t\t\t\treturn err;\n\t\t\t}\n\t\t}\n\t}\nout:\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Failed to register msgrcv handler\\n\""
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msgrcv_handler_register",
          "args": [
            "ndp",
            "&msgrcv_handler_func",
            "msg_type",
            "ifindex",
            "NULL"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msgrcv_handler_register",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1810-1831",
          "snippet": "NDP_EXPORT\nint ndp_msgrcv_handler_register(struct ndp *ndp, ndp_msgrcv_handler_func_t func,\n\t\t\t\tenum ndp_msg_type msg_type, uint32_t ifindex,\n\t\t\t\tvoid *priv)\n{\n\tstruct ndp_msgrcv_handler_item *handler_item;\n\n\tif (ndp_find_msgrcv_handler_item(ndp, func, msg_type,\n\t\t\t\t\t ifindex, priv))\n\t\treturn -EEXIST;\n\tif (!func)\n\t\treturn -EINVAL;\n\thandler_item = malloc(sizeof(*handler_item));\n\tif (!handler_item)\n\t\treturn -ENOMEM;\n\thandler_item->func = func;\n\thandler_item->msg_type = msg_type;\n\thandler_item->ifindex = ifindex;\n\thandler_item->priv = priv;\n\tlist_add_tail(&ndp->msgrcv_handler_list, &handler_item->list);\n\treturn 0;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nint ndp_msgrcv_handler_register(struct ndp *ndp, ndp_msgrcv_handler_func_t func,\n\t\t\t\tenum ndp_msg_type msg_type, uint32_t ifindex,\n\t\t\t\tvoid *priv)\n{\n\tstruct ndp_msgrcv_handler_item *handler_item;\n\n\tif (ndp_find_msgrcv_handler_item(ndp, func, msg_type,\n\t\t\t\t\t ifindex, priv))\n\t\treturn -EEXIST;\n\tif (!func)\n\t\treturn -EINVAL;\n\thandler_item = malloc(sizeof(*handler_item));\n\tif (!handler_item)\n\t\treturn -ENOMEM;\n\thandler_item->func = func;\n\thandler_item->msg_type = msg_type;\n\thandler_item->ifindex = ifindex;\n\thandler_item->priv = priv;\n\tlist_add_tail(&ndp->msgrcv_handler_list, &handler_item->list);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int run_cmd_monitor(struct ndp *ndp, enum ndp_msg_type msg_type,\n\t\t\t   uint32_t ifindex)\n{\n\tint err;\n\n\terr = ndp_msgrcv_handler_register(ndp, &msgrcv_handler_func, msg_type,\n\t\t\t\t\t  ifindex, NULL);\n\tif (err) {\n\t\tpr_err(\"Failed to register msgrcv handler\\n\");\n\t\treturn err;\n\t}\n\terr = run_main_loop(ndp);\n\tndp_msgrcv_handler_unregister(ndp, &msgrcv_handler_func, msg_type,\n\t\t\t\t      ifindex, NULL);\n\treturn err;\n}"
  },
  {
    "function_name": "msgrcv_handler_func",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
    "lines": "187-315",
    "snippet": "static int msgrcv_handler_func(struct ndp *ndp, struct ndp_msg *msg, void *priv)\n{\n\tchar ifname[IF_NAMESIZE];\n\tenum ndp_msg_type msg_type = ndp_msg_type(msg);\n\tint offset;\n\n\tif_indextoname(ndp_msg_ifindex(msg), ifname);\n\tpr_out(\"NDP payload len %zu, from addr: %s, iface: %s\\n\",\n\t       ndp_msg_payload_len(msg),\n\t       str_in6_addr(ndp_msg_addrto(msg)), ifname);\n\tif (msg_type == NDP_MSG_RS) {\n\t\tpr_out(\"  Type: RS\\n\");\n\t} else if (msg_type == NDP_MSG_RA) {\n\t\tstruct ndp_msgra *msgra = ndp_msgra(msg);\n\n\t\tpr_out(\"  Type: RA\\n\");\n\t\tpr_out(\"  Hop limit: %u\\n\", ndp_msgra_curhoplimit(msgra));\n\t\tpr_out(\"  Managed address configuration: %s\\n\",\n\t\t       ndp_msgra_flag_managed(msgra) ? \"yes\" : \"no\");\n\t\tpr_out(\"  Other configuration: %s\\n\",\n\t\t       ndp_msgra_flag_other(msgra) ? \"yes\" : \"no\");\n\t\tpr_out(\"  Default router preference: \");\n\t\tpr_out_route_preference(ndp_msgra_route_preference(msgra));\n\t\tpr_out(\"\\n\");\n\t\tpr_out(\"  Router lifetime: %us\\n\",\n\t\t       ndp_msgra_router_lifetime(msgra));\n\t\tpr_out(\"  Reachable time: \");\n\t\tif (ndp_msgra_reachable_time(msgra)) {\n\t\t\tpr_out(\"%ums\\n\",\n\t\t\t       ndp_msgra_reachable_time(msgra));\n\t\t} else {\n\t\t\tpr_out(\"unspecified\\n\");\n\t\t}\n\t\tpr_out(\"  Retransmit time: \");\n\t\tif (ndp_msgra_retransmit_time(msgra)) {\n\t\t\tpr_out(\"%ums\\n\",\n\t\t\t       ndp_msgra_retransmit_time(msgra));\n\t\t} else {\n\t\t\tpr_out(\"unspecified\\n\");\n\t\t}\n\n\t\tndp_msg_opt_for_each_offset(offset, msg, NDP_MSG_OPT_SLLADDR) {\n\t\t\tpr_out(\"  Source linkaddr: \");\n\t\t\tpr_out_hwaddr(ndp_msg_opt_slladdr(msg, offset),\n\t\t\t\t      ndp_msg_opt_slladdr_len(msg, offset));\n\t\t}\n\t\tndp_msg_opt_for_each_offset(offset, msg, NDP_MSG_OPT_TLLADDR) {\n\t\t\tpr_out(\"  Target linkaddr: \");\n\t\t\tpr_out_hwaddr(ndp_msg_opt_tlladdr(msg, offset),\n\t\t\t\t      ndp_msg_opt_tlladdr_len(msg, offset));\n\t\t}\n\t\tndp_msg_opt_for_each_offset(offset, msg, NDP_MSG_OPT_PREFIX) {\n\t\t\tuint32_t valid_time;\n\t\t\tuint32_t preferred_time;\n\n\t\t\tvalid_time = ndp_msg_opt_prefix_valid_time(msg, offset);\n\t\t\tpreferred_time = ndp_msg_opt_prefix_preferred_time(msg, offset);\n\t\t\tpr_out(\"  Prefix: %s/%u\",\n\t\t\t       str_in6_addr(ndp_msg_opt_prefix(msg, offset)),\n\t\t\t       ndp_msg_opt_prefix_len(msg, offset));\n\t\t\tpr_out(\", valid_time: \");\n\t\t\tif (valid_time == (uint32_t) -1)\n\t\t\t\tpr_out(\"infinity\");\n\t\t\telse\n\t\t\t\tpr_out(\"%us\", valid_time);\n\t\t\tpr_out(\", preferred_time: \");\n\t\t\tif (preferred_time == (uint32_t) -1)\n\t\t\t\tpr_out(\"infinity\");\n\t\t\telse\n\t\t\t\tpr_out(\"%us\", preferred_time);\n\t\t\tpr_out(\", on_link: %s\",\n\t\t\t       ndp_msg_opt_prefix_flag_on_link(msg, offset) ? \"yes\" : \"no\");\n\t\t\tpr_out(\", autonomous_addr_conf: %s\",\n\t\t\t       ndp_msg_opt_prefix_flag_auto_addr_conf(msg, offset) ? \"yes\" : \"no\");\n\t\t\tpr_out(\", router_addr: %s\",\n\t\t\t       ndp_msg_opt_prefix_flag_router_addr(msg, offset) ? \"yes\" : \"no\");\n\t\t\tpr_out(\"\\n\");\n\t\t}\n\t\tndp_msg_opt_for_each_offset(offset, msg, NDP_MSG_OPT_MTU)\n\t\t\tpr_out(\"  MTU: %u\\n\", ndp_msg_opt_mtu(msg, offset));\n\t\tndp_msg_opt_for_each_offset(offset, msg, NDP_MSG_OPT_ROUTE) {\n\t\t\tpr_out(\"  Route: %s/%u\",\n\t\t\t       str_in6_addr(ndp_msg_opt_route_prefix(msg, offset)),\n\t\t\t       ndp_msg_opt_route_prefix_len(msg, offset));\n\t\t\tpr_out(\", lifetime: \");\n\t\t\tpr_out_lft(ndp_msg_opt_route_lifetime(msg, offset));\n\t\t\tpr_out(\", preference: \");\n\t\t\tpr_out_route_preference(ndp_msg_opt_route_preference(msg, offset));\n\t\t\tpr_out(\"\\n\");\n\t\t}\n\t\tndp_msg_opt_for_each_offset(offset, msg, NDP_MSG_OPT_RDNSS) {\n\t\t\tstatic struct in6_addr *addr;\n\t\t\tint addr_index;\n\n\t\t\tpr_out(\"  Recursive DNS Servers: \");\n\t\t\tndp_msg_opt_rdnss_for_each_addr(addr, addr_index, msg, offset) {\n\t\t\t\tif (addr_index != 0)\n\t\t\t\t\tpr_out(\", \");\n\t\t\t\tpr_out(\"%s\", str_in6_addr(addr));\n\t\t\t}\n\t\t\tpr_out(\", lifetime: \");\n\t\t\tpr_out_lft(ndp_msg_opt_rdnss_lifetime(msg, offset));\n\t\t\tpr_out(\"\\n\");\n\t\t}\n\t\tndp_msg_opt_for_each_offset(offset, msg, NDP_MSG_OPT_DNSSL) {\n\t\t\tchar *domain;\n\t\t\tint domain_index;\n\n\t\t\tpr_out(\"  DNS Search List: \");\n\t\t\tndp_msg_opt_dnssl_for_each_domain(domain, domain_index, msg, offset) {\n\t\t\t\tif (domain_index != 0)\n\t\t\t\t\tpr_out(\" \");\n\t\t\t\tpr_out(\"%s\", domain);\n\t\t\t}\n\t\t\tpr_out(\", lifetime: \");\n\t\t\tpr_out_lft(ndp_msg_opt_rdnss_lifetime(msg, offset));\n\t\t\tpr_out(\"\\n\");\n\t\t}\n\t} else if (msg_type == NDP_MSG_NS) {\n\t\tpr_out(\"  Type: NS\\n\");\n\t} else if (msg_type == NDP_MSG_NA) {\n\t\tpr_out(\"  Type: NA\\n\");\n\t} else if (msg_type == NDP_MSG_R) {\n\t\tpr_out(\"  Type: R\\n\");\n\t} else {\n\t\treturn 0;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <ndp.h>",
      "#include <errno.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <net/if.h>",
      "#include <getopt.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_out",
          "args": [
            "\"  Type: R\\n\""
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "pr_out_lft",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
          "lines": "179-185",
          "snippet": "static void pr_out_lft(uint32_t lifetime)\n{\n\tif (lifetime == (uint32_t) -1)\n\t\tpr_out(\"infinity\");\n\telse\n\t\tpr_out(\"%us\", lifetime);\n}",
          "includes": [
            "#include <ndp.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <getopt.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void pr_out_lft(uint32_t lifetime)\n{\n\tif (lifetime == (uint32_t) -1)\n\t\tpr_out(\"infinity\");\n\telse\n\t\tpr_out(\"%us\", lifetime);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_rdnss_lifetime",
          "args": [
            "msg",
            "offset"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_opt_rdnss_lifetime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1569-1576",
          "snippet": "NDP_EXPORT\nuint32_t ndp_msg_opt_rdnss_lifetime(struct ndp_msg *msg, int offset)\n{\n\tstruct __nd_opt_rdnss *rdnss =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(rdnss->nd_opt_rdnss_lifetime);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint32_t ndp_msg_opt_rdnss_lifetime(struct ndp_msg *msg, int offset)\n{\n\tstruct __nd_opt_rdnss *rdnss =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(rdnss->nd_opt_rdnss_lifetime);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_out",
          "args": [
            "\"%s\"",
            "domain"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "pr_out_hwaddr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
          "lines": "152-162",
          "snippet": "static void pr_out_hwaddr(unsigned char *hwaddr, size_t len)\n{\n\tint i;\n\n\tfor (i = 0; i < len; i++) {\n\t\tif (i)\n\t\t\tpr_out(\":\");\n\t\tpr_out(\"%02x\", hwaddr[i]);\n\t}\n\tpr_out(\"\\n\");\n}",
          "includes": [
            "#include <ndp.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <getopt.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void pr_out_hwaddr(unsigned char *hwaddr, size_t len)\n{\n\tint i;\n\n\tfor (i = 0; i < len; i++) {\n\t\tif (i)\n\t\t\tpr_out(\":\");\n\t\tpr_out(\"%02x\", hwaddr[i]);\n\t}\n\tpr_out(\"\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_dnssl_for_each_domain",
          "args": [
            "domain",
            "domain_index",
            "msg",
            "offset"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_for_each_offset",
          "args": [
            "offset",
            "msg",
            "NDP_MSG_OPT_DNSSL"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str_in6_addr",
          "args": [
            "addr"
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "str_in6_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
          "lines": "145-150",
          "snippet": "static const char *str_in6_addr(struct in6_addr *addr)\n{\n\tstatic char buf[INET6_ADDRSTRLEN];\n\n\treturn inet_ntop(AF_INET6, addr, buf, sizeof(buf));\n}",
          "includes": [
            "#include <ndp.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <getopt.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic const char *str_in6_addr(struct in6_addr *addr)\n{\n\tstatic char buf[INET6_ADDRSTRLEN];\n\n\treturn inet_ntop(AF_INET6, addr, buf, sizeof(buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_rdnss_for_each_addr",
          "args": [
            "addr",
            "addr_index",
            "msg",
            "offset"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_for_each_offset",
          "args": [
            "offset",
            "msg",
            "NDP_MSG_OPT_RDNSS"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_out_route_preference",
          "args": [
            "ndp_msg_opt_route_preference(msg, offset)"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "pr_out_route_preference",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
          "lines": "164-177",
          "snippet": "static void pr_out_route_preference(enum ndp_route_preference pref)\n{\n\tswitch (pref) {\n\tcase NDP_ROUTE_PREF_LOW:\n\t\tpr_out(\"low\");\n\t\tbreak;\n\tcase NDP_ROUTE_PREF_MEDIUM:\n\t\tpr_out(\"medium\");\n\t\tbreak;\n\tcase NDP_ROUTE_PREF_HIGH:\n\t\tpr_out(\"high\");\n\t\tbreak;\n\t}\n}",
          "includes": [
            "#include <ndp.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <getopt.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void pr_out_route_preference(enum ndp_route_preference pref)\n{\n\tswitch (pref) {\n\tcase NDP_ROUTE_PREF_LOW:\n\t\tpr_out(\"low\");\n\t\tbreak;\n\tcase NDP_ROUTE_PREF_MEDIUM:\n\t\tpr_out(\"medium\");\n\t\tbreak;\n\tcase NDP_ROUTE_PREF_HIGH:\n\t\tpr_out(\"high\");\n\t\tbreak;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_route_preference",
          "args": [
            "msg",
            "offset"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_opt_route_preference",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1549-1556",
          "snippet": "ndp_route_preference\nndp_msg_opt_route_preference(struct ndp_msg *msg, int offset)\n{\n\tstruct __nd_opt_route_info *ri =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn (ri->nd_opt_ri_prf_reserved >> 3) & 3;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nndp_route_preference\nndp_msg_opt_route_preference(struct ndp_msg *msg, int offset)\n{\n\tstruct __nd_opt_route_info *ri =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn (ri->nd_opt_ri_prf_reserved >> 3) & 3;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_route_lifetime",
          "args": [
            "msg",
            "offset"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_opt_route_lifetime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1528-1535",
          "snippet": "NDP_EXPORT\nuint32_t ndp_msg_opt_route_lifetime(struct ndp_msg *msg, int offset)\n{\n\tstruct __nd_opt_route_info *ri =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(ri->nd_opt_ri_lifetime);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint32_t ndp_msg_opt_route_lifetime(struct ndp_msg *msg, int offset)\n{\n\tstruct __nd_opt_route_info *ri =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(ri->nd_opt_ri_lifetime);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_out",
          "args": [
            "\"  Route: %s/%u\"",
            "str_in6_addr(ndp_msg_opt_route_prefix(msg, offset))",
            "ndp_msg_opt_route_prefix_len(msg, offset)"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_route_prefix_len",
          "args": [
            "msg",
            "offset"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_opt_route_prefix_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1508-1515",
          "snippet": "NDP_EXPORT\nuint8_t ndp_msg_opt_route_prefix_len(struct ndp_msg *msg, int offset)\n{\n\tstruct __nd_opt_route_info *ri =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ri->nd_opt_ri_prefix_len;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint8_t ndp_msg_opt_route_prefix_len(struct ndp_msg *msg, int offset)\n{\n\tstruct __nd_opt_route_info *ri =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ri->nd_opt_ri_prefix_len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_for_each_offset",
          "args": [
            "offset",
            "msg",
            "NDP_MSG_OPT_ROUTE"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_mtu",
          "args": [
            "msg",
            "offset"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_opt_mtu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1466-1472",
          "snippet": "NDP_EXPORT\nuint32_t ndp_msg_opt_mtu(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_mtu *mtu = ndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(mtu->nd_opt_mtu_mtu);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint32_t ndp_msg_opt_mtu(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_mtu *mtu = ndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(mtu->nd_opt_mtu_mtu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_for_each_offset",
          "args": [
            "offset",
            "msg",
            "NDP_MSG_OPT_MTU"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_prefix_flag_router_addr",
          "args": [
            "msg",
            "offset"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_opt_prefix_flag_router_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1448-1455",
          "snippet": "NDP_EXPORT\nbool ndp_msg_opt_prefix_flag_router_addr(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn pi->nd_opt_pi_flags_reserved & ND_OPT_PI_FLAG_RADDR;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nbool ndp_msg_opt_prefix_flag_router_addr(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn pi->nd_opt_pi_flags_reserved & ND_OPT_PI_FLAG_RADDR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_prefix_flag_auto_addr_conf",
          "args": [
            "msg",
            "offset"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_opt_prefix_flag_auto_addr_conf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1428-1435",
          "snippet": "NDP_EXPORT\nbool ndp_msg_opt_prefix_flag_auto_addr_conf(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn pi->nd_opt_pi_flags_reserved & ND_OPT_PI_FLAG_AUTO;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nbool ndp_msg_opt_prefix_flag_auto_addr_conf(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn pi->nd_opt_pi_flags_reserved & ND_OPT_PI_FLAG_AUTO;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_prefix_flag_on_link",
          "args": [
            "msg",
            "offset"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_opt_prefix_flag_on_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1408-1415",
          "snippet": "NDP_EXPORT\nbool ndp_msg_opt_prefix_flag_on_link(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn pi->nd_opt_pi_flags_reserved & ND_OPT_PI_FLAG_ONLINK;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nbool ndp_msg_opt_prefix_flag_on_link(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn pi->nd_opt_pi_flags_reserved & ND_OPT_PI_FLAG_ONLINK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_out",
          "args": [
            "\"  Prefix: %s/%u\"",
            "str_in6_addr(ndp_msg_opt_prefix(msg, offset))",
            "ndp_msg_opt_prefix_len(msg, offset)"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_prefix_len",
          "args": [
            "msg",
            "offset"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_opt_prefix_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1348-1355",
          "snippet": "NDP_EXPORT\nuint8_t ndp_msg_opt_prefix_len(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn pi->nd_opt_pi_prefix_len;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint8_t ndp_msg_opt_prefix_len(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn pi->nd_opt_pi_prefix_len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_prefix_preferred_time",
          "args": [
            "msg",
            "offset"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_opt_prefix_preferred_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1388-1395",
          "snippet": "NDP_EXPORT\nuint32_t ndp_msg_opt_prefix_preferred_time(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(pi->nd_opt_pi_preferred_time);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint32_t ndp_msg_opt_prefix_preferred_time(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(pi->nd_opt_pi_preferred_time);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_prefix_valid_time",
          "args": [
            "msg",
            "offset"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_opt_prefix_valid_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1368-1375",
          "snippet": "NDP_EXPORT\nuint32_t ndp_msg_opt_prefix_valid_time(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(pi->nd_opt_pi_valid_time);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint32_t ndp_msg_opt_prefix_valid_time(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(pi->nd_opt_pi_valid_time);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_for_each_offset",
          "args": [
            "offset",
            "msg",
            "NDP_MSG_OPT_PREFIX"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_tlladdr_len",
          "args": [
            "msg",
            "offset"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_opt_tlladdr_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1311-1315",
          "snippet": "NDP_EXPORT\nsize_t ndp_msg_opt_tlladdr_len(struct ndp_msg *msg, int offset)\n{\n\treturn ETH_ALEN;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nsize_t ndp_msg_opt_tlladdr_len(struct ndp_msg *msg, int offset)\n{\n\treturn ETH_ALEN;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_for_each_offset",
          "args": [
            "offset",
            "msg",
            "NDP_MSG_OPT_TLLADDR"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_slladdr_len",
          "args": [
            "msg",
            "offset"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_opt_slladdr_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1275-1279",
          "snippet": "NDP_EXPORT\nsize_t ndp_msg_opt_slladdr_len(struct ndp_msg *msg, int offset)\n{\n\treturn ETH_ALEN;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nsize_t ndp_msg_opt_slladdr_len(struct ndp_msg *msg, int offset)\n{\n\treturn ETH_ALEN;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_for_each_offset",
          "args": [
            "offset",
            "msg",
            "NDP_MSG_OPT_SLLADDR"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msgra_retransmit_time",
          "args": [
            "msgra"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msgra_retransmit_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "971-975",
          "snippet": "NDP_EXPORT\nuint32_t ndp_msgra_retransmit_time(struct ndp_msgra *msgra)\n{\n\treturn ntohl(msgra->ra->nd_ra_retransmit);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nuint32_t ndp_msgra_retransmit_time(struct ndp_msgra *msgra)\n{\n\treturn ntohl(msgra->ra->nd_ra_retransmit);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msgra_reachable_time",
          "args": [
            "msgra"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msgra_reachable_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "944-948",
          "snippet": "NDP_EXPORT\nuint32_t ndp_msgra_reachable_time(struct ndp_msgra *msgra)\n{\n\treturn ntohl(msgra->ra->nd_ra_reachable);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nuint32_t ndp_msgra_reachable_time(struct ndp_msgra *msgra)\n{\n\treturn ntohl(msgra->ra->nd_ra_reachable);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msgra_router_lifetime",
          "args": [
            "msgra"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msgra_router_lifetime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "917-921",
          "snippet": "NDP_EXPORT\nuint16_t ndp_msgra_router_lifetime(struct ndp_msgra *msgra)\n{\n\treturn ntohs(msgra->ra->nd_ra_router_lifetime);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nuint16_t ndp_msgra_router_lifetime(struct ndp_msgra *msgra)\n{\n\treturn ntohs(msgra->ra->nd_ra_router_lifetime);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msgra_route_preference",
          "args": [
            "msgra"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msgra_route_preference",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "879-892",
          "snippet": "ndp_route_preference ndp_msgra_route_preference(struct ndp_msgra *msgra)\n{\n\tuint8_t prf = (msgra->ra->nd_ra_flags_reserved >> 3) & 3;\n\n\t/* rfc4191 says:\n\t * If the Router Lifetime is zero, the preference value MUST be set to\n\t * (00) by the sender and MUST be ignored by the receiver.\n\t * If the Reserved (10) value is received, the receiver MUST treat the\n\t * value as if it were (00).\n\t */\n\tif (prf == 2 || !ndp_msgra_router_lifetime(msgra))\n\t\tprf = 0;\n\treturn prf;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nndp_route_preference ndp_msgra_route_preference(struct ndp_msgra *msgra)\n{\n\tuint8_t prf = (msgra->ra->nd_ra_flags_reserved >> 3) & 3;\n\n\t/* rfc4191 says:\n\t * If the Router Lifetime is zero, the preference value MUST be set to\n\t * (00) by the sender and MUST be ignored by the receiver.\n\t * If the Reserved (10) value is received, the receiver MUST treat the\n\t * value as if it were (00).\n\t */\n\tif (prf == 2 || !ndp_msgra_router_lifetime(msgra))\n\t\tprf = 0;\n\treturn prf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msgra_flag_other",
          "args": [
            "msgra"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msgra_flag_other",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "819-823",
          "snippet": "NDP_EXPORT\nbool ndp_msgra_flag_other(struct ndp_msgra *msgra)\n{\n\treturn msgra->ra->nd_ra_flags_reserved & ND_RA_FLAG_OTHER;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nbool ndp_msgra_flag_other(struct ndp_msgra *msgra)\n{\n\treturn msgra->ra->nd_ra_flags_reserved & ND_RA_FLAG_OTHER;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msgra_flag_managed",
          "args": [
            "msgra"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msgra_flag_managed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "790-794",
          "snippet": "NDP_EXPORT\nbool ndp_msgra_flag_managed(struct ndp_msgra *msgra)\n{\n\treturn msgra->ra->nd_ra_flags_reserved & ND_RA_FLAG_MANAGED;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nbool ndp_msgra_flag_managed(struct ndp_msgra *msgra)\n{\n\treturn msgra->ra->nd_ra_flags_reserved & ND_RA_FLAG_MANAGED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msgra_curhoplimit",
          "args": [
            "msgra"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msgra_curhoplimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "764-768",
          "snippet": "NDP_EXPORT\nuint8_t ndp_msgra_curhoplimit(struct ndp_msgra *msgra)\n{\n\treturn msgra->ra->nd_ra_curhoplimit;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nuint8_t ndp_msgra_curhoplimit(struct ndp_msgra *msgra)\n{\n\treturn msgra->ra->nd_ra_curhoplimit;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_out",
          "args": [
            "\"NDP payload len %zu, from addr: %s, iface: %s\\n\"",
            "ndp_msg_payload_len(msg)",
            "str_in6_addr(ndp_msg_addrto(msg))",
            "ifname"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_addrto",
          "args": [
            "msg"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_addrto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "668-671",
          "snippet": "in6_addr *ndp_msg_addrto(struct ndp_msg *msg)\n{\n\treturn &msg->addrto;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nin6_addr *ndp_msg_addrto(struct ndp_msg *msg)\n{\n\treturn &msg->addrto;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_payload_len",
          "args": [
            "msg"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "499-503",
          "snippet": "NDP_EXPORT\nsize_t ndp_msg_payload_len(struct ndp_msg *msg)\n{\n\treturn msg->len;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nsize_t ndp_msg_payload_len(struct ndp_msg *msg)\n{\n\treturn msg->len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "if_indextoname",
          "args": [
            "ndp_msg_ifindex(msg)",
            "ifname"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_ifindex",
          "args": [
            "msg"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_ifindex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "681-685",
          "snippet": "NDP_EXPORT\nuint32_t ndp_msg_ifindex(struct ndp_msg *msg)\n{\n\treturn msg->ifindex;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint32_t ndp_msg_ifindex(struct ndp_msg *msg)\n{\n\treturn msg->ifindex;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_type",
          "args": [
            "msg"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "643-652",
          "snippet": "ndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int msgrcv_handler_func(struct ndp *ndp, struct ndp_msg *msg, void *priv)\n{\n\tchar ifname[IF_NAMESIZE];\n\tenum ndp_msg_type msg_type = ndp_msg_type(msg);\n\tint offset;\n\n\tif_indextoname(ndp_msg_ifindex(msg), ifname);\n\tpr_out(\"NDP payload len %zu, from addr: %s, iface: %s\\n\",\n\t       ndp_msg_payload_len(msg),\n\t       str_in6_addr(ndp_msg_addrto(msg)), ifname);\n\tif (msg_type == NDP_MSG_RS) {\n\t\tpr_out(\"  Type: RS\\n\");\n\t} else if (msg_type == NDP_MSG_RA) {\n\t\tstruct ndp_msgra *msgra = ndp_msgra(msg);\n\n\t\tpr_out(\"  Type: RA\\n\");\n\t\tpr_out(\"  Hop limit: %u\\n\", ndp_msgra_curhoplimit(msgra));\n\t\tpr_out(\"  Managed address configuration: %s\\n\",\n\t\t       ndp_msgra_flag_managed(msgra) ? \"yes\" : \"no\");\n\t\tpr_out(\"  Other configuration: %s\\n\",\n\t\t       ndp_msgra_flag_other(msgra) ? \"yes\" : \"no\");\n\t\tpr_out(\"  Default router preference: \");\n\t\tpr_out_route_preference(ndp_msgra_route_preference(msgra));\n\t\tpr_out(\"\\n\");\n\t\tpr_out(\"  Router lifetime: %us\\n\",\n\t\t       ndp_msgra_router_lifetime(msgra));\n\t\tpr_out(\"  Reachable time: \");\n\t\tif (ndp_msgra_reachable_time(msgra)) {\n\t\t\tpr_out(\"%ums\\n\",\n\t\t\t       ndp_msgra_reachable_time(msgra));\n\t\t} else {\n\t\t\tpr_out(\"unspecified\\n\");\n\t\t}\n\t\tpr_out(\"  Retransmit time: \");\n\t\tif (ndp_msgra_retransmit_time(msgra)) {\n\t\t\tpr_out(\"%ums\\n\",\n\t\t\t       ndp_msgra_retransmit_time(msgra));\n\t\t} else {\n\t\t\tpr_out(\"unspecified\\n\");\n\t\t}\n\n\t\tndp_msg_opt_for_each_offset(offset, msg, NDP_MSG_OPT_SLLADDR) {\n\t\t\tpr_out(\"  Source linkaddr: \");\n\t\t\tpr_out_hwaddr(ndp_msg_opt_slladdr(msg, offset),\n\t\t\t\t      ndp_msg_opt_slladdr_len(msg, offset));\n\t\t}\n\t\tndp_msg_opt_for_each_offset(offset, msg, NDP_MSG_OPT_TLLADDR) {\n\t\t\tpr_out(\"  Target linkaddr: \");\n\t\t\tpr_out_hwaddr(ndp_msg_opt_tlladdr(msg, offset),\n\t\t\t\t      ndp_msg_opt_tlladdr_len(msg, offset));\n\t\t}\n\t\tndp_msg_opt_for_each_offset(offset, msg, NDP_MSG_OPT_PREFIX) {\n\t\t\tuint32_t valid_time;\n\t\t\tuint32_t preferred_time;\n\n\t\t\tvalid_time = ndp_msg_opt_prefix_valid_time(msg, offset);\n\t\t\tpreferred_time = ndp_msg_opt_prefix_preferred_time(msg, offset);\n\t\t\tpr_out(\"  Prefix: %s/%u\",\n\t\t\t       str_in6_addr(ndp_msg_opt_prefix(msg, offset)),\n\t\t\t       ndp_msg_opt_prefix_len(msg, offset));\n\t\t\tpr_out(\", valid_time: \");\n\t\t\tif (valid_time == (uint32_t) -1)\n\t\t\t\tpr_out(\"infinity\");\n\t\t\telse\n\t\t\t\tpr_out(\"%us\", valid_time);\n\t\t\tpr_out(\", preferred_time: \");\n\t\t\tif (preferred_time == (uint32_t) -1)\n\t\t\t\tpr_out(\"infinity\");\n\t\t\telse\n\t\t\t\tpr_out(\"%us\", preferred_time);\n\t\t\tpr_out(\", on_link: %s\",\n\t\t\t       ndp_msg_opt_prefix_flag_on_link(msg, offset) ? \"yes\" : \"no\");\n\t\t\tpr_out(\", autonomous_addr_conf: %s\",\n\t\t\t       ndp_msg_opt_prefix_flag_auto_addr_conf(msg, offset) ? \"yes\" : \"no\");\n\t\t\tpr_out(\", router_addr: %s\",\n\t\t\t       ndp_msg_opt_prefix_flag_router_addr(msg, offset) ? \"yes\" : \"no\");\n\t\t\tpr_out(\"\\n\");\n\t\t}\n\t\tndp_msg_opt_for_each_offset(offset, msg, NDP_MSG_OPT_MTU)\n\t\t\tpr_out(\"  MTU: %u\\n\", ndp_msg_opt_mtu(msg, offset));\n\t\tndp_msg_opt_for_each_offset(offset, msg, NDP_MSG_OPT_ROUTE) {\n\t\t\tpr_out(\"  Route: %s/%u\",\n\t\t\t       str_in6_addr(ndp_msg_opt_route_prefix(msg, offset)),\n\t\t\t       ndp_msg_opt_route_prefix_len(msg, offset));\n\t\t\tpr_out(\", lifetime: \");\n\t\t\tpr_out_lft(ndp_msg_opt_route_lifetime(msg, offset));\n\t\t\tpr_out(\", preference: \");\n\t\t\tpr_out_route_preference(ndp_msg_opt_route_preference(msg, offset));\n\t\t\tpr_out(\"\\n\");\n\t\t}\n\t\tndp_msg_opt_for_each_offset(offset, msg, NDP_MSG_OPT_RDNSS) {\n\t\t\tstatic struct in6_addr *addr;\n\t\t\tint addr_index;\n\n\t\t\tpr_out(\"  Recursive DNS Servers: \");\n\t\t\tndp_msg_opt_rdnss_for_each_addr(addr, addr_index, msg, offset) {\n\t\t\t\tif (addr_index != 0)\n\t\t\t\t\tpr_out(\", \");\n\t\t\t\tpr_out(\"%s\", str_in6_addr(addr));\n\t\t\t}\n\t\t\tpr_out(\", lifetime: \");\n\t\t\tpr_out_lft(ndp_msg_opt_rdnss_lifetime(msg, offset));\n\t\t\tpr_out(\"\\n\");\n\t\t}\n\t\tndp_msg_opt_for_each_offset(offset, msg, NDP_MSG_OPT_DNSSL) {\n\t\t\tchar *domain;\n\t\t\tint domain_index;\n\n\t\t\tpr_out(\"  DNS Search List: \");\n\t\t\tndp_msg_opt_dnssl_for_each_domain(domain, domain_index, msg, offset) {\n\t\t\t\tif (domain_index != 0)\n\t\t\t\t\tpr_out(\" \");\n\t\t\t\tpr_out(\"%s\", domain);\n\t\t\t}\n\t\t\tpr_out(\", lifetime: \");\n\t\t\tpr_out_lft(ndp_msg_opt_rdnss_lifetime(msg, offset));\n\t\t\tpr_out(\"\\n\");\n\t\t}\n\t} else if (msg_type == NDP_MSG_NS) {\n\t\tpr_out(\"  Type: NS\\n\");\n\t} else if (msg_type == NDP_MSG_NA) {\n\t\tpr_out(\"  Type: NA\\n\");\n\t} else if (msg_type == NDP_MSG_R) {\n\t\tpr_out(\"  Type: R\\n\");\n\t} else {\n\t\treturn 0;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "pr_out_lft",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
    "lines": "179-185",
    "snippet": "static void pr_out_lft(uint32_t lifetime)\n{\n\tif (lifetime == (uint32_t) -1)\n\t\tpr_out(\"infinity\");\n\telse\n\t\tpr_out(\"%us\", lifetime);\n}",
    "includes": [
      "#include <ndp.h>",
      "#include <errno.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <net/if.h>",
      "#include <getopt.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_out",
          "args": [
            "\"%us\"",
            "lifetime"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "pr_out_hwaddr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
          "lines": "152-162",
          "snippet": "static void pr_out_hwaddr(unsigned char *hwaddr, size_t len)\n{\n\tint i;\n\n\tfor (i = 0; i < len; i++) {\n\t\tif (i)\n\t\t\tpr_out(\":\");\n\t\tpr_out(\"%02x\", hwaddr[i]);\n\t}\n\tpr_out(\"\\n\");\n}",
          "includes": [
            "#include <ndp.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <getopt.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void pr_out_hwaddr(unsigned char *hwaddr, size_t len)\n{\n\tint i;\n\n\tfor (i = 0; i < len; i++) {\n\t\tif (i)\n\t\t\tpr_out(\":\");\n\t\tpr_out(\"%02x\", hwaddr[i]);\n\t}\n\tpr_out(\"\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_out",
          "args": [
            "\"infinity\""
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "pr_out_lft",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
          "lines": "179-185",
          "snippet": "static void pr_out_lft(uint32_t lifetime)\n{\n\tif (lifetime == (uint32_t) -1)\n\t\tpr_out(\"infinity\");\n\telse\n\t\tpr_out(\"%us\", lifetime);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void pr_out_lft(uint32_t lifetime)\n{\n\tif (lifetime == (uint32_t) -1)\n\t\tpr_out(\"infinity\");\n\telse\n\t\tpr_out(\"%us\", lifetime);\n}"
  },
  {
    "function_name": "pr_out_route_preference",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
    "lines": "164-177",
    "snippet": "static void pr_out_route_preference(enum ndp_route_preference pref)\n{\n\tswitch (pref) {\n\tcase NDP_ROUTE_PREF_LOW:\n\t\tpr_out(\"low\");\n\t\tbreak;\n\tcase NDP_ROUTE_PREF_MEDIUM:\n\t\tpr_out(\"medium\");\n\t\tbreak;\n\tcase NDP_ROUTE_PREF_HIGH:\n\t\tpr_out(\"high\");\n\t\tbreak;\n\t}\n}",
    "includes": [
      "#include <ndp.h>",
      "#include <errno.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <net/if.h>",
      "#include <getopt.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_out",
          "args": [
            "\"high\""
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "pr_out_lft",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
          "lines": "179-185",
          "snippet": "static void pr_out_lft(uint32_t lifetime)\n{\n\tif (lifetime == (uint32_t) -1)\n\t\tpr_out(\"infinity\");\n\telse\n\t\tpr_out(\"%us\", lifetime);\n}",
          "includes": [
            "#include <ndp.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <getopt.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void pr_out_lft(uint32_t lifetime)\n{\n\tif (lifetime == (uint32_t) -1)\n\t\tpr_out(\"infinity\");\n\telse\n\t\tpr_out(\"%us\", lifetime);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void pr_out_route_preference(enum ndp_route_preference pref)\n{\n\tswitch (pref) {\n\tcase NDP_ROUTE_PREF_LOW:\n\t\tpr_out(\"low\");\n\t\tbreak;\n\tcase NDP_ROUTE_PREF_MEDIUM:\n\t\tpr_out(\"medium\");\n\t\tbreak;\n\tcase NDP_ROUTE_PREF_HIGH:\n\t\tpr_out(\"high\");\n\t\tbreak;\n\t}\n}"
  },
  {
    "function_name": "pr_out_hwaddr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
    "lines": "152-162",
    "snippet": "static void pr_out_hwaddr(unsigned char *hwaddr, size_t len)\n{\n\tint i;\n\n\tfor (i = 0; i < len; i++) {\n\t\tif (i)\n\t\t\tpr_out(\":\");\n\t\tpr_out(\"%02x\", hwaddr[i]);\n\t}\n\tpr_out(\"\\n\");\n}",
    "includes": [
      "#include <ndp.h>",
      "#include <errno.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <net/if.h>",
      "#include <getopt.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_out",
          "args": [
            "\"\\n\""
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "pr_out_lft",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
          "lines": "179-185",
          "snippet": "static void pr_out_lft(uint32_t lifetime)\n{\n\tif (lifetime == (uint32_t) -1)\n\t\tpr_out(\"infinity\");\n\telse\n\t\tpr_out(\"%us\", lifetime);\n}",
          "includes": [
            "#include <ndp.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <getopt.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void pr_out_lft(uint32_t lifetime)\n{\n\tif (lifetime == (uint32_t) -1)\n\t\tpr_out(\"infinity\");\n\telse\n\t\tpr_out(\"%us\", lifetime);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_out",
          "args": [
            "\"%02x\"",
            "hwaddr[i]"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "pr_out_hwaddr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
          "lines": "152-162",
          "snippet": "static void pr_out_hwaddr(unsigned char *hwaddr, size_t len)\n{\n\tint i;\n\n\tfor (i = 0; i < len; i++) {\n\t\tif (i)\n\t\t\tpr_out(\":\");\n\t\tpr_out(\"%02x\", hwaddr[i]);\n\t}\n\tpr_out(\"\\n\");\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void pr_out_hwaddr(unsigned char *hwaddr, size_t len)\n{\n\tint i;\n\n\tfor (i = 0; i < len; i++) {\n\t\tif (i)\n\t\t\tpr_out(\":\");\n\t\tpr_out(\"%02x\", hwaddr[i]);\n\t}\n\tpr_out(\"\\n\");\n}"
  },
  {
    "function_name": "str_in6_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
    "lines": "145-150",
    "snippet": "static const char *str_in6_addr(struct in6_addr *addr)\n{\n\tstatic char buf[INET6_ADDRSTRLEN];\n\n\treturn inet_ntop(AF_INET6, addr, buf, sizeof(buf));\n}",
    "includes": [
      "#include <ndp.h>",
      "#include <errno.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <net/if.h>",
      "#include <getopt.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "inet_ntop",
          "args": [
            "AF_INET6",
            "addr",
            "buf",
            "sizeof(buf)"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic const char *str_in6_addr(struct in6_addr *addr)\n{\n\tstatic char buf[INET6_ADDRSTRLEN];\n\n\treturn inet_ntop(AF_INET6, addr, buf, sizeof(buf));\n}"
  },
  {
    "function_name": "print_help",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
    "lines": "130-143",
    "snippet": "static void print_help(const char *argv0) {\n\tpr_out(\n            \"%s [options] command\\n\"\n            \"\\t-h --help                Show this help\\n\"\n            \"\\t-v --verbose             Increase output verbosity\\n\"\n            \"\\t-t --msg-type=TYPE       Specify message type\\n\"\n\t    \"\\t                         (\\\"rs\\\", \\\"ra\\\", \\\"ns\\\", \\\"na\\\")\\n\"\n            \"\\t-i --ifname=IFNAME       Specify interface name\\n\"\n            \"\\t-U --unsolicited         Send Unsolicited NA\\n\"\n\t    \"Available commands:\\n\"\n\t    \"\\tmonitor\\n\"\n\t    \"\\tsend\\n\",\n            argv0);\n}",
    "includes": [
      "#include <ndp.h>",
      "#include <errno.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <net/if.h>",
      "#include <getopt.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_out",
          "args": [
            "\"%s [options] command\\n\"\n            \"\\t-h --help                Show this help\\n\"\n            \"\\t-v --verbose             Increase output verbosity\\n\"\n            \"\\t-t --msg-type=TYPE       Specify message type\\n\"\n\t    \"\\t                         (\\\"rs\\\", \\\"ra\\\", \\\"ns\\\", \\\"na\\\")\\n\"\n            \"\\t-i --ifname=IFNAME       Specify interface name\\n\"\n            \"\\t-U --unsolicited         Send Unsolicited NA\\n\"\n\t    \"Available commands:\\n\"\n\t    \"\\tmonitor\\n\"\n\t    \"\\tsend\\n\"",
            "argv0"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "pr_out_hwaddr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
          "lines": "152-162",
          "snippet": "static void pr_out_hwaddr(unsigned char *hwaddr, size_t len)\n{\n\tint i;\n\n\tfor (i = 0; i < len; i++) {\n\t\tif (i)\n\t\t\tpr_out(\":\");\n\t\tpr_out(\"%02x\", hwaddr[i]);\n\t}\n\tpr_out(\"\\n\");\n}",
          "includes": [
            "#include <ndp.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <getopt.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void pr_out_hwaddr(unsigned char *hwaddr, size_t len)\n{\n\tint i;\n\n\tfor (i = 0; i < len; i++) {\n\t\tif (i)\n\t\t\tpr_out(\":\");\n\t\tpr_out(\"%02x\", hwaddr[i]);\n\t}\n\tpr_out(\"\\n\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void print_help(const char *argv0) {\n\tpr_out(\n            \"%s [options] command\\n\"\n            \"\\t-h --help                Show this help\\n\"\n            \"\\t-v --verbose             Increase output verbosity\\n\"\n            \"\\t-t --msg-type=TYPE       Specify message type\\n\"\n\t    \"\\t                         (\\\"rs\\\", \\\"ra\\\", \\\"ns\\\", \\\"na\\\")\\n\"\n            \"\\t-i --ifname=IFNAME       Specify interface name\\n\"\n            \"\\t-U --unsolicited         Send Unsolicited NA\\n\"\n\t    \"Available commands:\\n\"\n\t    \"\\tmonitor\\n\"\n\t    \"\\tsend\\n\",\n            argv0);\n}"
  },
  {
    "function_name": "run_main_loop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
    "lines": "59-128",
    "snippet": "static int run_main_loop(struct ndp *ndp)\n{\n\tfd_set rfds;\n\tfd_set rfds_tmp;\n\tint fdmax;\n\tint ret;\n\tstruct sigaction siginfo;\n\tsigset_t mask;\n\tint ndp_fd;\n\tint err = 0;\n\n\tsigemptyset(&siginfo.sa_mask);\n\tsiginfo.sa_flags = 0;\n\tsiginfo.sa_handler = empty_signal_handler;\n\tret = sigaction(SIGINT, &siginfo, NULL);\n\tif (ret == -1) {\n\t\tpr_err(\"Failed to set SIGINT handler\\n\");\n\t\treturn -errno;\n\t}\n\tret = sigaction(SIGQUIT, &siginfo, NULL);\n\tif (ret == -1) {\n\t\tpr_err(\"Failed to set SIGQUIT handler\\n\");\n\t\treturn -errno;\n\t}\n\tret = sigaction(SIGTERM, &siginfo, NULL);\n\tif (ret == -1) {\n\t\tpr_err(\"Failed to set SIGTERM handler\\n\");\n\t\treturn -errno;\n\t}\n\n\tsigemptyset(&mask);\n\tsigaddset(&mask, SIGINT);\n\tsigaddset(&mask, SIGQUIT);\n\tsigaddset(&mask, SIGTERM);\n\n\tret = sigprocmask(SIG_BLOCK, &mask, NULL);\n\tif (ret == -1) {\n\t\tpr_err(\"Failed to set blocked signals\\n\");\n\t\treturn -errno;\n\t}\n\n\tsigemptyset(&mask);\n\n\tFD_ZERO(&rfds);\n\tndp_fd = ndp_get_eventfd(ndp);\n\tFD_SET(ndp_fd, &rfds);\n\tfdmax = ndp_fd + 1;\n\n\tfor (;;) {\n\t\trfds_tmp = rfds;\n\t\tret = pselect(fdmax, &rfds_tmp, NULL, NULL, NULL, &mask);\n\t\tif (ret == -1) {\n\t\t\tif (errno == EINTR) {\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t\tpr_err(\"Select failed\\n\");\n\t\t\terr = -errno;\n\t\t\tgoto out;\n\t\t}\n\t\tif (FD_ISSET(ndp_fd, &rfds_tmp)) {\n\t\t\terr = ndp_call_eventfd_handler(ndp);\n\t\t\tif (err) {\n\t\t\t\tpr_err(\"ndp eventfd handler call failed\\n\");\n\t\t\t\treturn err;\n\t\t\t}\n\t\t}\n\t}\nout:\n\treturn err;\n}",
    "includes": [
      "#include <ndp.h>",
      "#include <errno.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <net/if.h>",
      "#include <getopt.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"ndp eventfd handler call failed\\n\""
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_call_eventfd_handler",
          "args": [
            "ndp"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_call_eventfd_handler",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1887-1891",
          "snippet": "NDP_EXPORT\nint ndp_call_eventfd_handler(struct ndp *ndp)\n{\n\treturn ndp_sock_recv(ndp);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nint ndp_call_eventfd_handler(struct ndp *ndp)\n{\n\treturn ndp_sock_recv(ndp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "FD_ISSET",
          "args": [
            "ndp_fd",
            "&rfds_tmp"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Select failed\\n\""
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pselect",
          "args": [
            "fdmax",
            "&rfds_tmp",
            "NULL",
            "NULL",
            "NULL",
            "&mask"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FD_SET",
          "args": [
            "ndp_fd",
            "&rfds"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_get_eventfd",
          "args": [
            "ndp"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_get_eventfd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1873-1877",
          "snippet": "NDP_EXPORT\nint ndp_get_eventfd(struct ndp *ndp)\n{\n\treturn ndp->sock;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nint ndp_get_eventfd(struct ndp *ndp)\n{\n\treturn ndp->sock;\n}"
        }
      },
      {
        "call_info": {
          "callee": "FD_ZERO",
          "args": [
            "&rfds"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigemptyset",
          "args": [
            "&mask"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Failed to set blocked signals\\n\""
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigprocmask",
          "args": [
            "SIG_BLOCK",
            "&mask",
            "NULL"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigaddset",
          "args": [
            "&mask",
            "SIGTERM"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigaddset",
          "args": [
            "&mask",
            "SIGQUIT"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigaddset",
          "args": [
            "&mask",
            "SIGINT"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigemptyset",
          "args": [
            "&mask"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Failed to set SIGTERM handler\\n\""
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigaction",
          "args": [
            "SIGTERM",
            "&siginfo",
            "NULL"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Failed to set SIGQUIT handler\\n\""
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigaction",
          "args": [
            "SIGQUIT",
            "&siginfo",
            "NULL"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Failed to set SIGINT handler\\n\""
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigaction",
          "args": [
            "SIGINT",
            "&siginfo",
            "NULL"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigemptyset",
          "args": [
            "&siginfo.sa_mask"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int run_main_loop(struct ndp *ndp)\n{\n\tfd_set rfds;\n\tfd_set rfds_tmp;\n\tint fdmax;\n\tint ret;\n\tstruct sigaction siginfo;\n\tsigset_t mask;\n\tint ndp_fd;\n\tint err = 0;\n\n\tsigemptyset(&siginfo.sa_mask);\n\tsiginfo.sa_flags = 0;\n\tsiginfo.sa_handler = empty_signal_handler;\n\tret = sigaction(SIGINT, &siginfo, NULL);\n\tif (ret == -1) {\n\t\tpr_err(\"Failed to set SIGINT handler\\n\");\n\t\treturn -errno;\n\t}\n\tret = sigaction(SIGQUIT, &siginfo, NULL);\n\tif (ret == -1) {\n\t\tpr_err(\"Failed to set SIGQUIT handler\\n\");\n\t\treturn -errno;\n\t}\n\tret = sigaction(SIGTERM, &siginfo, NULL);\n\tif (ret == -1) {\n\t\tpr_err(\"Failed to set SIGTERM handler\\n\");\n\t\treturn -errno;\n\t}\n\n\tsigemptyset(&mask);\n\tsigaddset(&mask, SIGINT);\n\tsigaddset(&mask, SIGQUIT);\n\tsigaddset(&mask, SIGTERM);\n\n\tret = sigprocmask(SIG_BLOCK, &mask, NULL);\n\tif (ret == -1) {\n\t\tpr_err(\"Failed to set blocked signals\\n\");\n\t\treturn -errno;\n\t}\n\n\tsigemptyset(&mask);\n\n\tFD_ZERO(&rfds);\n\tndp_fd = ndp_get_eventfd(ndp);\n\tFD_SET(ndp_fd, &rfds);\n\tfdmax = ndp_fd + 1;\n\n\tfor (;;) {\n\t\trfds_tmp = rfds;\n\t\tret = pselect(fdmax, &rfds_tmp, NULL, NULL, NULL, &mask);\n\t\tif (ret == -1) {\n\t\t\tif (errno == EINTR) {\n\t\t\t\tgoto out;\n\t\t\t}\n\t\t\tpr_err(\"Select failed\\n\");\n\t\t\terr = -errno;\n\t\t\tgoto out;\n\t\t}\n\t\tif (FD_ISSET(ndp_fd, &rfds_tmp)) {\n\t\t\terr = ndp_call_eventfd_handler(ndp);\n\t\t\tif (err) {\n\t\t\t\tpr_err(\"ndp eventfd handler call failed\\n\");\n\t\t\t\treturn err;\n\t\t\t}\n\t\t}\n\t}\nout:\n\treturn err;\n}"
  },
  {
    "function_name": "empty_signal_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/utils/ndptool.c",
    "lines": "55-57",
    "snippet": "static void empty_signal_handler(int signal)\n{\n}",
    "includes": [
      "#include <ndp.h>",
      "#include <errno.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/in.h>",
      "#include <net/if.h>",
      "#include <getopt.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <ndp.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <getopt.h>\n#include <signal.h>\n#include <string.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void empty_signal_handler(int signal)\n{\n}"
  }
]