[
  {
    "function_name": "ndp_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1978-1983",
    "snippet": "NDP_EXPORT\nvoid ndp_close(struct ndp *ndp)\n{\n\tndp_sock_close(ndp);\n\tfree(ndp);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "ndp"
          ],
          "line": 1982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_sock_close",
          "args": [
            "ndp"
          ],
          "line": 1981
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_sock_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "259-262",
          "snippet": "static void ndp_sock_close(struct ndp *ndp)\n{\n\tclose(ndp->sock);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nstatic void ndp_sock_close(struct ndp *ndp)\n{\n\tclose(ndp->sock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_close(struct ndp *ndp)\n{\n\tndp_sock_close(ndp);\n\tfree(ndp);\n}"
  },
  {
    "function_name": "ndp_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1940-1970",
    "snippet": "NDP_EXPORT\nint ndp_open(struct ndp **p_ndp)\n{\n\tstruct ndp *ndp;\n\tconst char *env;\n\tint err;\n\n\tndp = myzalloc(sizeof(*ndp));\n\tif (!ndp)\n\t\treturn -ENOMEM;\n\tndp->log_fn = log_stderr;\n\tndp->log_priority = LOG_ERR;\n\t/* environment overwrites config */\n\tenv = getenv(\"NDP_LOG\");\n\tif (env != NULL)\n\t\tndp_set_log_priority(ndp, log_priority(env));\n\n\tdbg(ndp, \"ndp context %p created.\", ndp);\n\tdbg(ndp, \"log_priority=%d\", ndp->log_priority);\n\n\tlist_init(&ndp->msgrcv_handler_list);\n\terr = ndp_sock_open(ndp);\n\tif (err)\n\t\tgoto free_ndp;\n\n\t*p_ndp = ndp;\n\treturn 0;\nfree_ndp:\n\tfree(ndp);\n\treturn err;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "ndp"
          ],
          "line": 1968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_sock_open",
          "args": [
            "ndp"
          ],
          "line": 1961
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_sock_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "220-257",
          "snippet": "static int ndp_sock_open(struct ndp *ndp)\n{\n\tint sock;\n\t//struct icmp6_filter flt;\n\tint ret;\n\tint err;\n\tint val;\n\n\tsock = socket(PF_INET6, SOCK_RAW, IPPROTO_ICMPV6);\n\tif (sock == -1) {\n\t\terr(ndp, \"Failed to create ICMP6 socket.\");\n\t\treturn -errno;\n\t}\n\n\tval = 1;\n\tret = setsockopt(sock, IPPROTO_IPV6, IPV6_RECVPKTINFO,\n\t\t\t &val, sizeof(val));\n\tif (ret == -1) {\n\t\terr(ndp, \"Failed to setsockopt IPV6_RECVPKTINFO.\");\n\t\terr = -errno;\n\t\tgoto close_sock;\n\t}\n\n\tval = 255;\n\tret = setsockopt(sock, IPPROTO_IPV6, IPV6_MULTICAST_HOPS,\n\t\t\t &val, sizeof(val));\n\tif (ret == -1) {\n\t\terr(ndp, \"Failed to setsockopt IPV6_MULTICAST_HOPS.\");\n\t\terr = -errno;\n\t\tgoto close_sock;\n\t}\n\n\tndp->sock = sock;\n\treturn 0;\nclose_sock:\n\tclose(sock);\n\treturn err;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nstatic int ndp_sock_open(struct ndp *ndp)\n{\n\tint sock;\n\t//struct icmp6_filter flt;\n\tint ret;\n\tint err;\n\tint val;\n\n\tsock = socket(PF_INET6, SOCK_RAW, IPPROTO_ICMPV6);\n\tif (sock == -1) {\n\t\terr(ndp, \"Failed to create ICMP6 socket.\");\n\t\treturn -errno;\n\t}\n\n\tval = 1;\n\tret = setsockopt(sock, IPPROTO_IPV6, IPV6_RECVPKTINFO,\n\t\t\t &val, sizeof(val));\n\tif (ret == -1) {\n\t\terr(ndp, \"Failed to setsockopt IPV6_RECVPKTINFO.\");\n\t\terr = -errno;\n\t\tgoto close_sock;\n\t}\n\n\tval = 255;\n\tret = setsockopt(sock, IPPROTO_IPV6, IPV6_MULTICAST_HOPS,\n\t\t\t &val, sizeof(val));\n\tif (ret == -1) {\n\t\terr(ndp, \"Failed to setsockopt IPV6_MULTICAST_HOPS.\");\n\t\terr = -errno;\n\t\tgoto close_sock;\n\t}\n\n\tndp->sock = sock;\n\treturn 0;\nclose_sock:\n\tclose(sock);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_init",
          "args": [
            "&ndp->msgrcv_handler_list"
          ],
          "line": 1960
        },
        "resolved": true,
        "details": {
          "function_name": "list_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/list.h",
          "lines": "30-34",
          "snippet": "static inline void list_init(struct list_item *head)\n{\n\thead->prev = head;\n\thead->next = head;\n}",
          "includes": [
            "#include <stdbool.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdbool.h>\n\nstatic inline void list_init(struct list_item *head)\n{\n\thead->prev = head;\n\thead->next = head;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbg",
          "args": [
            "ndp",
            "\"log_priority=%d\"",
            "ndp->log_priority"
          ],
          "line": 1958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbg",
          "args": [
            "ndp",
            "\"ndp context %p created.\"",
            "ndp"
          ],
          "line": 1957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_set_log_priority",
          "args": [
            "ndp",
            "log_priority(env)"
          ],
          "line": 1955
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_set_log_priority",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "119-123",
          "snippet": "NDP_EXPORT\nvoid ndp_set_log_priority(struct ndp *ndp, int priority)\n{\n\tndp->log_priority = priority;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_set_log_priority(struct ndp *ndp, int priority)\n{\n\tndp->log_priority = priority;\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_priority",
          "args": [
            "env"
          ],
          "line": 1955
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_get_log_priority",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "105-109",
          "snippet": "NDP_EXPORT\nint ndp_get_log_priority(struct ndp *ndp)\n{\n\treturn ndp->log_priority;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nint ndp_get_log_priority(struct ndp *ndp)\n{\n\treturn ndp->log_priority;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"NDP_LOG\""
          ],
          "line": 1953
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "myzalloc",
          "args": [
            "sizeof(*ndp)"
          ],
          "line": 1947
        },
        "resolved": true,
        "details": {
          "function_name": "myzalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "134-137",
          "snippet": "static void *myzalloc(size_t size)\n{\n\treturn calloc(1, size);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void *myzalloc(size_t size)\n{\n\treturn calloc(1, size);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nint ndp_open(struct ndp **p_ndp)\n{\n\tstruct ndp *ndp;\n\tconst char *env;\n\tint err;\n\n\tndp = myzalloc(sizeof(*ndp));\n\tif (!ndp)\n\t\treturn -ENOMEM;\n\tndp->log_fn = log_stderr;\n\tndp->log_priority = LOG_ERR;\n\t/* environment overwrites config */\n\tenv = getenv(\"NDP_LOG\");\n\tif (env != NULL)\n\t\tndp_set_log_priority(ndp, log_priority(env));\n\n\tdbg(ndp, \"ndp context %p created.\", ndp);\n\tdbg(ndp, \"log_priority=%d\", ndp->log_priority);\n\n\tlist_init(&ndp->msgrcv_handler_list);\n\terr = ndp_sock_open(ndp);\n\tif (err)\n\t\tgoto free_ndp;\n\n\t*p_ndp = ndp;\n\treturn 0;\nfree_ndp:\n\tfree(ndp);\n\treturn err;\n}"
  },
  {
    "function_name": "ndp_callall_eventfd_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1901-1925",
    "snippet": "NDP_EXPORT\nint ndp_callall_eventfd_handler(struct ndp *ndp)\n{\n\tfd_set rfds;\n\tint fdmax;\n\tstruct timeval tv;\n\tint fd = ndp_get_eventfd(ndp);\n\tint ret;\n\tint err;\n\n\tmemset(&tv, 0, sizeof(tv));\n\tFD_ZERO(&rfds);\n\tFD_SET(fd, &rfds);\n\tfdmax = fd + 1;\n\twhile (true) {\n\t\tret = select(fdmax, &rfds, NULL, NULL, &tv);\n\t\tif (ret == -1)\n\t\t\treturn -errno;\n\t\tif (!FD_ISSET(fd, &rfds))\n\t\t\treturn 0;\n\t\terr = ndp_call_eventfd_handler(ndp);\n\t\tif (err)\n\t\t\treturn err;\n\t}\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_call_eventfd_handler",
          "args": [
            "ndp"
          ],
          "line": 1921
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_call_eventfd_handler",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1887-1891",
          "snippet": "NDP_EXPORT\nint ndp_call_eventfd_handler(struct ndp *ndp)\n{\n\treturn ndp_sock_recv(ndp);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nint ndp_call_eventfd_handler(struct ndp *ndp)\n{\n\treturn ndp_sock_recv(ndp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "FD_ISSET",
          "args": [
            "fd",
            "&rfds"
          ],
          "line": 1919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "select",
          "args": [
            "fdmax",
            "&rfds",
            "NULL",
            "NULL",
            "&tv"
          ],
          "line": 1916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FD_SET",
          "args": [
            "fd",
            "&rfds"
          ],
          "line": 1913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FD_ZERO",
          "args": [
            "&rfds"
          ],
          "line": 1912
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&tv",
            "0",
            "sizeof(tv)"
          ],
          "line": 1911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_get_eventfd",
          "args": [
            "ndp"
          ],
          "line": 1907
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_get_eventfd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1873-1877",
          "snippet": "NDP_EXPORT\nint ndp_get_eventfd(struct ndp *ndp)\n{\n\treturn ndp->sock;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nint ndp_get_eventfd(struct ndp *ndp)\n{\n\treturn ndp->sock;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nint ndp_callall_eventfd_handler(struct ndp *ndp)\n{\n\tfd_set rfds;\n\tint fdmax;\n\tstruct timeval tv;\n\tint fd = ndp_get_eventfd(ndp);\n\tint ret;\n\tint err;\n\n\tmemset(&tv, 0, sizeof(tv));\n\tFD_ZERO(&rfds);\n\tFD_SET(fd, &rfds);\n\tfdmax = fd + 1;\n\twhile (true) {\n\t\tret = select(fdmax, &rfds, NULL, NULL, &tv);\n\t\tif (ret == -1)\n\t\t\treturn -errno;\n\t\tif (!FD_ISSET(fd, &rfds))\n\t\t\treturn 0;\n\t\terr = ndp_call_eventfd_handler(ndp);\n\t\tif (err)\n\t\t\treturn err;\n\t}\n}"
  },
  {
    "function_name": "ndp_call_eventfd_handler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1887-1891",
    "snippet": "NDP_EXPORT\nint ndp_call_eventfd_handler(struct ndp *ndp)\n{\n\treturn ndp_sock_recv(ndp);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_sock_recv",
          "args": [
            "ndp"
          ],
          "line": 1890
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_sock_recv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1687-1740",
          "snippet": "static int ndp_sock_recv(struct ndp *ndp)\n{\n\tstruct ndp_msg *msg;\n\tenum ndp_msg_type msg_type;\n\tsize_t len;\n\tint err;\n\n\tmsg = ndp_msg_alloc();\n\tif (!msg)\n\t\treturn -ENOMEM;\n\n\tlen = ndp_msg_payload_maxlen(msg);\n\terr = myrecvfrom6(ndp->sock, msg->buf, &len, 0,\n\t\t\t  &msg->addrto, &msg->ifindex);\n\tif (err) {\n\t\terr(ndp, \"Failed to receive message\");\n\t\tgoto free_msg;\n\t}\n\tdbg(ndp, \"rcvd from: %s, ifindex: %u\",\n\t\t str_in6_addr(&msg->addrto), msg->ifindex);\n\n\tif (len < sizeof(*msg->icmp6_hdr)) {\n\t\twarn(ndp, \"rcvd icmp6 packet too short (%luB)\", len);\n\t\terr = 0;\n\t\tgoto free_msg;\n\t}\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\tif (err) {\n\t\terr = 0;\n\t\tgoto free_msg;\n\t}\n\tndp_msg_init(msg, msg_type);\n\tndp_msg_payload_len_set(msg, len);\n\n\tif (!ndp_msg_check_valid(msg)) {\n\t\twarn(ndp, \"rcvd invalid ND message\");\n\t\terr = 0;\n\t\tgoto free_msg;\n\t}\n\n\tdbg(ndp, \"rcvd %s, len: %zuB\",\n\t\t ndp_msg_type_info(msg_type)->strabbr, len);\n\n\tif (!ndp_msg_check_opts(msg)) {\n\t\terr = 0;\n\t\tgoto free_msg;\n\t}\n\n\terr = ndp_call_handlers(ndp, msg);;\n\nfree_msg:\n\tndp_msg_destroy(msg);\n\treturn err;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic int ndp_sock_recv(struct ndp *ndp)\n{\n\tstruct ndp_msg *msg;\n\tenum ndp_msg_type msg_type;\n\tsize_t len;\n\tint err;\n\n\tmsg = ndp_msg_alloc();\n\tif (!msg)\n\t\treturn -ENOMEM;\n\n\tlen = ndp_msg_payload_maxlen(msg);\n\terr = myrecvfrom6(ndp->sock, msg->buf, &len, 0,\n\t\t\t  &msg->addrto, &msg->ifindex);\n\tif (err) {\n\t\terr(ndp, \"Failed to receive message\");\n\t\tgoto free_msg;\n\t}\n\tdbg(ndp, \"rcvd from: %s, ifindex: %u\",\n\t\t str_in6_addr(&msg->addrto), msg->ifindex);\n\n\tif (len < sizeof(*msg->icmp6_hdr)) {\n\t\twarn(ndp, \"rcvd icmp6 packet too short (%luB)\", len);\n\t\terr = 0;\n\t\tgoto free_msg;\n\t}\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\tif (err) {\n\t\terr = 0;\n\t\tgoto free_msg;\n\t}\n\tndp_msg_init(msg, msg_type);\n\tndp_msg_payload_len_set(msg, len);\n\n\tif (!ndp_msg_check_valid(msg)) {\n\t\twarn(ndp, \"rcvd invalid ND message\");\n\t\terr = 0;\n\t\tgoto free_msg;\n\t}\n\n\tdbg(ndp, \"rcvd %s, len: %zuB\",\n\t\t ndp_msg_type_info(msg_type)->strabbr, len);\n\n\tif (!ndp_msg_check_opts(msg)) {\n\t\terr = 0;\n\t\tgoto free_msg;\n\t}\n\n\terr = ndp_call_handlers(ndp, msg);;\n\nfree_msg:\n\tndp_msg_destroy(msg);\n\treturn err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nint ndp_call_eventfd_handler(struct ndp *ndp)\n{\n\treturn ndp_sock_recv(ndp);\n}"
  },
  {
    "function_name": "ndp_get_eventfd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1873-1877",
    "snippet": "NDP_EXPORT\nint ndp_get_eventfd(struct ndp *ndp)\n{\n\treturn ndp->sock;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nint ndp_get_eventfd(struct ndp *ndp)\n{\n\treturn ndp->sock;\n}"
  },
  {
    "function_name": "ndp_msgrcv_handler_unregister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1844-1857",
    "snippet": "NDP_EXPORT\nvoid ndp_msgrcv_handler_unregister(struct ndp *ndp, ndp_msgrcv_handler_func_t func,\n\t\t\t\t   enum ndp_msg_type msg_type, uint32_t ifindex,\n\t\t\t\t   void *priv)\n{\n\tstruct ndp_msgrcv_handler_item *handler_item;\n\n\thandler_item = ndp_find_msgrcv_handler_item(ndp, func, msg_type,\n\t\t\t\t\t\t    ifindex, priv);\n\tif (!handler_item)\n\t\treturn;\n\tlist_del(&handler_item->list);\n\tfree(handler_item);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "handler_item"
          ],
          "line": 1856
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&handler_item->list"
          ],
          "line": 1855
        },
        "resolved": true,
        "details": {
          "function_name": "list_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/list.h",
          "lines": "61-65",
          "snippet": "static inline void list_del(struct list_item *node)\n{\n\tnode->prev->next = node->next;\n\tnode->next->prev = node->prev;\n}",
          "includes": [
            "#include <stdbool.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdbool.h>\n\nstatic inline void list_del(struct list_item *node)\n{\n\tnode->prev->next = node->next;\n\tnode->next->prev = node->prev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_find_msgrcv_handler_item",
          "args": [
            "ndp",
            "func",
            "msg_type",
            "ifindex",
            "priv"
          ],
          "line": 1851
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_find_msgrcv_handler_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1756-1771",
          "snippet": "static struct ndp_msgrcv_handler_item *\nndp_find_msgrcv_handler_item(struct ndp *ndp,\n\t\t\t     ndp_msgrcv_handler_func_t func,\n\t\t\t     enum ndp_msg_type msg_type, uint32_t ifindex,\n\t\t\t     void *priv)\n{\n\tstruct ndp_msgrcv_handler_item *handler_item;\n\n\tlist_for_each_node_entry(handler_item, &ndp->msgrcv_handler_list, list)\n\t\tif (handler_item->func == func &&\n\t\t    handler_item->msg_type == msg_type &&\n\t\t    handler_item->ifindex == ifindex &&\n\t\t    handler_item->priv == priv)\n\t\t\treturn handler_item;\n\treturn NULL;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\n\nstatic struct ndp_msgrcv_handler_item *\nndp_find_msgrcv_handler_item(struct ndp *ndp,\n\t\t\t     ndp_msgrcv_handler_func_t func,\n\t\t\t     enum ndp_msg_type msg_type, uint32_t ifindex,\n\t\t\t     void *priv)\n{\n\tstruct ndp_msgrcv_handler_item *handler_item;\n\n\tlist_for_each_node_entry(handler_item, &ndp->msgrcv_handler_list, list)\n\t\tif (handler_item->func == func &&\n\t\t    handler_item->msg_type == msg_type &&\n\t\t    handler_item->ifindex == ifindex &&\n\t\t    handler_item->priv == priv)\n\t\t\treturn handler_item;\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_msgrcv_handler_unregister(struct ndp *ndp, ndp_msgrcv_handler_func_t func,\n\t\t\t\t   enum ndp_msg_type msg_type, uint32_t ifindex,\n\t\t\t\t   void *priv)\n{\n\tstruct ndp_msgrcv_handler_item *handler_item;\n\n\thandler_item = ndp_find_msgrcv_handler_item(ndp, func, msg_type,\n\t\t\t\t\t\t    ifindex, priv);\n\tif (!handler_item)\n\t\treturn;\n\tlist_del(&handler_item->list);\n\tfree(handler_item);\n}"
  },
  {
    "function_name": "ndp_msgrcv_handler_register",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1810-1831",
    "snippet": "NDP_EXPORT\nint ndp_msgrcv_handler_register(struct ndp *ndp, ndp_msgrcv_handler_func_t func,\n\t\t\t\tenum ndp_msg_type msg_type, uint32_t ifindex,\n\t\t\t\tvoid *priv)\n{\n\tstruct ndp_msgrcv_handler_item *handler_item;\n\n\tif (ndp_find_msgrcv_handler_item(ndp, func, msg_type,\n\t\t\t\t\t ifindex, priv))\n\t\treturn -EEXIST;\n\tif (!func)\n\t\treturn -EINVAL;\n\thandler_item = malloc(sizeof(*handler_item));\n\tif (!handler_item)\n\t\treturn -ENOMEM;\n\thandler_item->func = func;\n\thandler_item->msg_type = msg_type;\n\thandler_item->ifindex = ifindex;\n\thandler_item->priv = priv;\n\tlist_add_tail(&ndp->msgrcv_handler_list, &handler_item->list);\n\treturn 0;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&ndp->msgrcv_handler_list",
            "&handler_item->list"
          ],
          "line": 1829
        },
        "resolved": true,
        "details": {
          "function_name": "list_add_tail",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/list.h",
          "lines": "56-59",
          "snippet": "static inline void list_add_tail(struct list_item *head, struct list_item *node)\n{\n\t__list_add(node, head->prev, head);\n}",
          "includes": [
            "#include <stdbool.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdbool.h>\n\nstatic inline void list_add_tail(struct list_item *head, struct list_item *node)\n{\n\t__list_add(node, head->prev, head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(*handler_item)"
          ],
          "line": 1822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_find_msgrcv_handler_item",
          "args": [
            "ndp",
            "func",
            "msg_type",
            "ifindex",
            "priv"
          ],
          "line": 1817
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_find_msgrcv_handler_item",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1756-1771",
          "snippet": "static struct ndp_msgrcv_handler_item *\nndp_find_msgrcv_handler_item(struct ndp *ndp,\n\t\t\t     ndp_msgrcv_handler_func_t func,\n\t\t\t     enum ndp_msg_type msg_type, uint32_t ifindex,\n\t\t\t     void *priv)\n{\n\tstruct ndp_msgrcv_handler_item *handler_item;\n\n\tlist_for_each_node_entry(handler_item, &ndp->msgrcv_handler_list, list)\n\t\tif (handler_item->func == func &&\n\t\t    handler_item->msg_type == msg_type &&\n\t\t    handler_item->ifindex == ifindex &&\n\t\t    handler_item->priv == priv)\n\t\t\treturn handler_item;\n\treturn NULL;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\n\nstatic struct ndp_msgrcv_handler_item *\nndp_find_msgrcv_handler_item(struct ndp *ndp,\n\t\t\t     ndp_msgrcv_handler_func_t func,\n\t\t\t     enum ndp_msg_type msg_type, uint32_t ifindex,\n\t\t\t     void *priv)\n{\n\tstruct ndp_msgrcv_handler_item *handler_item;\n\n\tlist_for_each_node_entry(handler_item, &ndp->msgrcv_handler_list, list)\n\t\tif (handler_item->func == func &&\n\t\t    handler_item->msg_type == msg_type &&\n\t\t    handler_item->ifindex == ifindex &&\n\t\t    handler_item->priv == priv)\n\t\t\treturn handler_item;\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nint ndp_msgrcv_handler_register(struct ndp *ndp, ndp_msgrcv_handler_func_t func,\n\t\t\t\tenum ndp_msg_type msg_type, uint32_t ifindex,\n\t\t\t\tvoid *priv)\n{\n\tstruct ndp_msgrcv_handler_item *handler_item;\n\n\tif (ndp_find_msgrcv_handler_item(ndp, func, msg_type,\n\t\t\t\t\t ifindex, priv))\n\t\treturn -EEXIST;\n\tif (!func)\n\t\treturn -EINVAL;\n\thandler_item = malloc(sizeof(*handler_item));\n\tif (!handler_item)\n\t\treturn -ENOMEM;\n\thandler_item->func = func;\n\thandler_item->msg_type = msg_type;\n\thandler_item->ifindex = ifindex;\n\thandler_item->priv = priv;\n\tlist_add_tail(&ndp->msgrcv_handler_list, &handler_item->list);\n\treturn 0;\n}"
  },
  {
    "function_name": "ndp_call_handlers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1773-1791",
    "snippet": "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg)\n{\n\tstruct ndp_msgrcv_handler_item *handler_item;\n\tint err;\n\n\tlist_for_each_node_entry(handler_item,\n\t\t\t\t &ndp->msgrcv_handler_list, list) {\n\t\tif (handler_item->msg_type != NDP_MSG_ALL &&\n\t\t    handler_item->msg_type != ndp_msg_type(msg))\n\t\t\tcontinue;\n\t\tif (handler_item->ifindex &&\n\t\t    handler_item->ifindex != msg->ifindex)\n\t\t\tcontinue;\n\t\terr = handler_item->func(ndp, msg, handler_item->priv);\n\t\tif (err)\n\t\t\treturn err;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "handler_item->func",
          "args": [
            "ndp",
            "msg",
            "handler_item->priv"
          ],
          "line": 1786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_type",
          "args": [
            "msg"
          ],
          "line": 1781
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "643-652",
          "snippet": "ndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_node_entry",
          "args": [
            "handler_item",
            "&ndp->msgrcv_handler_list",
            "list"
          ],
          "line": 1778
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg)\n{\n\tstruct ndp_msgrcv_handler_item *handler_item;\n\tint err;\n\n\tlist_for_each_node_entry(handler_item,\n\t\t\t\t &ndp->msgrcv_handler_list, list) {\n\t\tif (handler_item->msg_type != NDP_MSG_ALL &&\n\t\t    handler_item->msg_type != ndp_msg_type(msg))\n\t\t\tcontinue;\n\t\tif (handler_item->ifindex &&\n\t\t    handler_item->ifindex != msg->ifindex)\n\t\t\tcontinue;\n\t\terr = handler_item->func(ndp, msg, handler_item->priv);\n\t\tif (err)\n\t\t\treturn err;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "ndp_find_msgrcv_handler_item",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1756-1771",
    "snippet": "static struct ndp_msgrcv_handler_item *\nndp_find_msgrcv_handler_item(struct ndp *ndp,\n\t\t\t     ndp_msgrcv_handler_func_t func,\n\t\t\t     enum ndp_msg_type msg_type, uint32_t ifindex,\n\t\t\t     void *priv)\n{\n\tstruct ndp_msgrcv_handler_item *handler_item;\n\n\tlist_for_each_node_entry(handler_item, &ndp->msgrcv_handler_list, list)\n\t\tif (handler_item->func == func &&\n\t\t    handler_item->msg_type == msg_type &&\n\t\t    handler_item->ifindex == ifindex &&\n\t\t    handler_item->priv == priv)\n\t\t\treturn handler_item;\n\treturn NULL;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_for_each_node_entry",
          "args": [
            "handler_item",
            "&ndp->msgrcv_handler_list",
            "list"
          ],
          "line": 1764
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\n\nstatic struct ndp_msgrcv_handler_item *\nndp_find_msgrcv_handler_item(struct ndp *ndp,\n\t\t\t     ndp_msgrcv_handler_func_t func,\n\t\t\t     enum ndp_msg_type msg_type, uint32_t ifindex,\n\t\t\t     void *priv)\n{\n\tstruct ndp_msgrcv_handler_item *handler_item;\n\n\tlist_for_each_node_entry(handler_item, &ndp->msgrcv_handler_list, list)\n\t\tif (handler_item->func == func &&\n\t\t    handler_item->msg_type == msg_type &&\n\t\t    handler_item->ifindex == ifindex &&\n\t\t    handler_item->priv == priv)\n\t\t\treturn handler_item;\n\treturn NULL;\n}"
  },
  {
    "function_name": "ndp_sock_recv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1687-1740",
    "snippet": "static int ndp_sock_recv(struct ndp *ndp)\n{\n\tstruct ndp_msg *msg;\n\tenum ndp_msg_type msg_type;\n\tsize_t len;\n\tint err;\n\n\tmsg = ndp_msg_alloc();\n\tif (!msg)\n\t\treturn -ENOMEM;\n\n\tlen = ndp_msg_payload_maxlen(msg);\n\terr = myrecvfrom6(ndp->sock, msg->buf, &len, 0,\n\t\t\t  &msg->addrto, &msg->ifindex);\n\tif (err) {\n\t\terr(ndp, \"Failed to receive message\");\n\t\tgoto free_msg;\n\t}\n\tdbg(ndp, \"rcvd from: %s, ifindex: %u\",\n\t\t str_in6_addr(&msg->addrto), msg->ifindex);\n\n\tif (len < sizeof(*msg->icmp6_hdr)) {\n\t\twarn(ndp, \"rcvd icmp6 packet too short (%luB)\", len);\n\t\terr = 0;\n\t\tgoto free_msg;\n\t}\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\tif (err) {\n\t\terr = 0;\n\t\tgoto free_msg;\n\t}\n\tndp_msg_init(msg, msg_type);\n\tndp_msg_payload_len_set(msg, len);\n\n\tif (!ndp_msg_check_valid(msg)) {\n\t\twarn(ndp, \"rcvd invalid ND message\");\n\t\terr = 0;\n\t\tgoto free_msg;\n\t}\n\n\tdbg(ndp, \"rcvd %s, len: %zuB\",\n\t\t ndp_msg_type_info(msg_type)->strabbr, len);\n\n\tif (!ndp_msg_check_opts(msg)) {\n\t\terr = 0;\n\t\tgoto free_msg;\n\t}\n\n\terr = ndp_call_handlers(ndp, msg);;\n\nfree_msg:\n\tndp_msg_destroy(msg);\n\treturn err;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_destroy",
          "args": [
            "msg"
          ],
          "line": 1738
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "457-461",
          "snippet": "NDP_EXPORT\nvoid ndp_msg_destroy(struct ndp_msg *msg)\n{\n\tfree(msg);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nvoid ndp_msg_destroy(struct ndp_msg *msg)\n{\n\tfree(msg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_call_handlers",
          "args": [
            "ndp",
            "msg"
          ],
          "line": 1735
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_call_handlers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1773-1791",
          "snippet": "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg)\n{\n\tstruct ndp_msgrcv_handler_item *handler_item;\n\tint err;\n\n\tlist_for_each_node_entry(handler_item,\n\t\t\t\t &ndp->msgrcv_handler_list, list) {\n\t\tif (handler_item->msg_type != NDP_MSG_ALL &&\n\t\t    handler_item->msg_type != ndp_msg_type(msg))\n\t\t\tcontinue;\n\t\tif (handler_item->ifindex &&\n\t\t    handler_item->ifindex != msg->ifindex)\n\t\t\tcontinue;\n\t\terr = handler_item->func(ndp, msg, handler_item->priv);\n\t\tif (err)\n\t\t\treturn err;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg)\n{\n\tstruct ndp_msgrcv_handler_item *handler_item;\n\tint err;\n\n\tlist_for_each_node_entry(handler_item,\n\t\t\t\t &ndp->msgrcv_handler_list, list) {\n\t\tif (handler_item->msg_type != NDP_MSG_ALL &&\n\t\t    handler_item->msg_type != ndp_msg_type(msg))\n\t\t\tcontinue;\n\t\tif (handler_item->ifindex &&\n\t\t    handler_item->ifindex != msg->ifindex)\n\t\t\tcontinue;\n\t\terr = handler_item->func(ndp, msg, handler_item->priv);\n\t\tif (err)\n\t\t\treturn err;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_check_opts",
          "args": [
            "msg"
          ],
          "line": 1730
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_check_opts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1213-1238",
          "snippet": "static bool ndp_msg_check_opts(struct ndp_msg *msg)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\tsize_t len = ndp_msg_payload_opts_len(msg);\n\tstruct ndp_msg_opt_type_info *info;\n\n\twhile (len > 0) {\n\t\tuint8_t cur_opt_raw_type = ptr[0];\n\t\tunsigned int cur_opt_len = ptr[1] << 3; /* convert to bytes */\n\n\t\tif (!cur_opt_len)\n\t\t\treturn false;\n\t\tif (len < cur_opt_len)\n\t\t\tbreak;\n\t\tinfo = ndp_msg_opt_type_info_by_raw_type(cur_opt_raw_type);\n\t\tif (info) {\n\t\t\tif (cur_opt_len < info->raw_struct_size ||\n\t\t\t    (info->check_valid && !info->check_valid(ptr)))\n\t\t\t\tptr[0] = __INVALID_OPT_TYPE_MAGIC;\n\t\t}\n\t\tptr += cur_opt_len;\n\t\tlen -= cur_opt_len;\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define __INVALID_OPT_TYPE_MAGIC 0xff"
          ],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define __INVALID_OPT_TYPE_MAGIC 0xff\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic bool ndp_msg_check_opts(struct ndp_msg *msg)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\tsize_t len = ndp_msg_payload_opts_len(msg);\n\tstruct ndp_msg_opt_type_info *info;\n\n\twhile (len > 0) {\n\t\tuint8_t cur_opt_raw_type = ptr[0];\n\t\tunsigned int cur_opt_len = ptr[1] << 3; /* convert to bytes */\n\n\t\tif (!cur_opt_len)\n\t\t\treturn false;\n\t\tif (len < cur_opt_len)\n\t\t\tbreak;\n\t\tinfo = ndp_msg_opt_type_info_by_raw_type(cur_opt_raw_type);\n\t\tif (info) {\n\t\t\tif (cur_opt_len < info->raw_struct_size ||\n\t\t\t    (info->check_valid && !info->check_valid(ptr)))\n\t\t\t\tptr[0] = __INVALID_OPT_TYPE_MAGIC;\n\t\t}\n\t\tptr += cur_opt_len;\n\t\tlen -= cur_opt_len;\n\t}\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dbg",
          "args": [
            "ndp",
            "\"rcvd %s, len: %zuB\"",
            "ndp_msg_type_info(msg_type)->strabbr",
            "len"
          ],
          "line": 1727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_type_info",
          "args": [
            "msg_type"
          ],
          "line": 1728
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_type_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "372-375",
          "snippet": "struct ndp_msg_type_info *ndp_msg_type_info(enum ndp_msg_type msg_type)\n{\n\treturn &ndp_msg_type_info_list[msg_type];\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct ndp_msg_type_info ndp_msg_type_info_list[] =\n{\n\t[NDP_MSG_RS] = {\n\t\t.strabbr = \"RS\",\n\t\t.raw_type = ND_ROUTER_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_router_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_routers,\n\t},\n\t[NDP_MSG_RA] = {\n\t\t.strabbr = \"RA\",\n\t\t.raw_type = ND_ROUTER_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_router_advert),\n\t},\n\t[NDP_MSG_NS] = {\n\t\t.strabbr = \"NS\",\n\t\t.raw_type = ND_NEIGHBOR_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_nodes,\n\t},\n\t[NDP_MSG_NA] = {\n\t\t.strabbr = \"NA\",\n\t\t.raw_type = ND_NEIGHBOR_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_advert),\n\t},\n\t[NDP_MSG_R] = {\n\t\t.strabbr = \"R\",\n\t\t.raw_type = ND_REDIRECT,\n\t\t.raw_struct_size = sizeof(struct nd_redirect),\n\t},\n};",
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct ndp_msg_type_info ndp_msg_type_info_list[] =\n{\n\t[NDP_MSG_RS] = {\n\t\t.strabbr = \"RS\",\n\t\t.raw_type = ND_ROUTER_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_router_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_routers,\n\t},\n\t[NDP_MSG_RA] = {\n\t\t.strabbr = \"RA\",\n\t\t.raw_type = ND_ROUTER_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_router_advert),\n\t},\n\t[NDP_MSG_NS] = {\n\t\t.strabbr = \"NS\",\n\t\t.raw_type = ND_NEIGHBOR_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_nodes,\n\t},\n\t[NDP_MSG_NA] = {\n\t\t.strabbr = \"NA\",\n\t\t.raw_type = ND_NEIGHBOR_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_advert),\n\t},\n\t[NDP_MSG_R] = {\n\t\t.strabbr = \"R\",\n\t\t.raw_type = ND_REDIRECT,\n\t\t.raw_struct_size = sizeof(struct nd_redirect),\n\t},\n};\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\n\nstruct ndp_msg_type_info *ndp_msg_type_info(enum ndp_msg_type msg_type)\n{\n\treturn &ndp_msg_type_info_list[msg_type];\n}"
        }
      },
      {
        "call_info": {
          "callee": "warn",
          "args": [
            "ndp",
            "\"rcvd invalid ND message\""
          ],
          "line": 1722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_check_valid",
          "args": [
            "msg"
          ],
          "line": 1721
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_check_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "391-399",
          "snippet": "static bool ndp_msg_check_valid(struct ndp_msg *msg)\n{\n\tsize_t len = ndp_msg_payload_len(msg);\n\tenum ndp_msg_type msg_type = ndp_msg_type(msg);\n\n\tif (len < ndp_msg_type_info(msg_type)->raw_struct_size)\n\t\treturn false;\n\treturn true;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic bool ndp_msg_check_valid(struct ndp_msg *msg)\n{\n\tsize_t len = ndp_msg_payload_len(msg);\n\tenum ndp_msg_type msg_type = ndp_msg_type(msg);\n\n\tif (len < ndp_msg_type_info(msg_type)->raw_struct_size)\n\t\treturn false;\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_payload_len_set",
          "args": [
            "msg",
            "len"
          ],
          "line": 1719
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_len_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "511-517",
          "snippet": "NDP_EXPORT\nvoid ndp_msg_payload_len_set(struct ndp_msg *msg, size_t len)\n{\n\tif (len > sizeof(msg->buf))\n\t\tlen = sizeof(msg->buf);\n\tmsg->len = len;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nvoid ndp_msg_payload_len_set(struct ndp_msg *msg, size_t len)\n{\n\tif (len > sizeof(msg->buf))\n\t\tlen = sizeof(msg->buf);\n\tmsg->len = len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_init",
          "args": [
            "msg",
            "msg_type"
          ],
          "line": 1718
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "414-426",
          "snippet": "static void ndp_msg_init(struct ndp_msg *msg, enum ndp_msg_type msg_type)\n{\n\tsize_t raw_struct_size = ndp_msg_type_info(msg_type)->raw_struct_size;\n\n\tndp_msg_type_set(msg, msg_type);\n\tmsg->len = raw_struct_size;\n\tmsg->opts_start = msg->buf + raw_struct_size;\n\n\t/* Set-up \"first pointers\" in all ndp_msgrs, ndp_msgra, ndp_msgns,\n\t * ndp_msgna, ndp_msgr structures.\n\t */\n\tmsg->nd_msg.generic.dataptr = ndp_msg_payload(msg);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void ndp_msg_init(struct ndp_msg *msg, enum ndp_msg_type msg_type)\n{\n\tsize_t raw_struct_size = ndp_msg_type_info(msg_type)->raw_struct_size;\n\n\tndp_msg_type_set(msg, msg_type);\n\tmsg->len = raw_struct_size;\n\tmsg->opts_start = msg->buf + raw_struct_size;\n\n\t/* Set-up \"first pointers\" in all ndp_msgrs, ndp_msgra, ndp_msgns,\n\t * ndp_msgna, ndp_msgr structures.\n\t */\n\tmsg->nd_msg.generic.dataptr = ndp_msg_payload(msg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_type_by_raw_type",
          "args": [
            "&msg_type",
            "msg->icmp6_hdr->icmp6_type"
          ],
          "line": 1713
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_type_by_raw_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "377-389",
          "snippet": "static int ndp_msg_type_by_raw_type(enum ndp_msg_type *p_msg_type,\n\t\t\t\t    uint8_t raw_type)\n{\n\tint i;\n\n\tfor (i = 0; i < NDP_MSG_TYPE_LIST_SIZE; i++) {\n\t\tif (ndp_msg_type_info(i)->raw_type == raw_type) {\n\t\t\t*p_msg_type = i;\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn -ENOENT;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define NDP_MSG_TYPE_LIST_SIZE ARRAY_SIZE(ndp_msg_type_info_list)"
          ],
          "globals_used": [
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nenum"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define NDP_MSG_TYPE_LIST_SIZE ARRAY_SIZE(ndp_msg_type_info_list)\n\nNDP_EXPORT\nenum;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nenum;\n\nstatic int ndp_msg_type_by_raw_type(enum ndp_msg_type *p_msg_type,\n\t\t\t\t    uint8_t raw_type)\n{\n\tint i;\n\n\tfor (i = 0; i < NDP_MSG_TYPE_LIST_SIZE; i++) {\n\t\tif (ndp_msg_type_info(i)->raw_type == raw_type) {\n\t\t\t*p_msg_type = i;\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn -ENOENT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "warn",
          "args": [
            "ndp",
            "\"rcvd icmp6 packet too short (%luB)\"",
            "len"
          ],
          "line": 1709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbg",
          "args": [
            "ndp",
            "\"rcvd from: %s, ifindex: %u\"",
            "str_in6_addr(&msg->addrto)",
            "msg->ifindex"
          ],
          "line": 1705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str_in6_addr",
          "args": [
            "&msg->addrto"
          ],
          "line": 1706
        },
        "resolved": true,
        "details": {
          "function_name": "str_in6_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "207-212",
          "snippet": "static const char *str_in6_addr(struct in6_addr *addr)\n{\n\tstatic char buf[INET6_ADDRSTRLEN];\n\n\treturn inet_ntop(AF_INET6, addr, buf, sizeof(buf));\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nstatic const char *str_in6_addr(struct in6_addr *addr)\n{\n\tstatic char buf[INET6_ADDRSTRLEN];\n\n\treturn inet_ntop(AF_INET6, addr, buf, sizeof(buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "err",
          "args": [
            "ndp",
            "\"Failed to receive message\""
          ],
          "line": 1702
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_opt_prefix_preferred_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1388-1395",
          "snippet": "NDP_EXPORT\nuint32_t ndp_msg_opt_prefix_preferred_time(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(pi->nd_opt_pi_preferred_time);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint32_t ndp_msg_opt_prefix_preferred_time(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(pi->nd_opt_pi_preferred_time);\n}"
        }
      },
      {
        "call_info": {
          "callee": "myrecvfrom6",
          "args": [
            "ndp->sock",
            "msg->buf",
            "&len",
            "0",
            "&msg->addrto",
            "&msg->ifindex"
          ],
          "line": 1699
        },
        "resolved": true,
        "details": {
          "function_name": "myrecvfrom6",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "139-183",
          "snippet": "static int myrecvfrom6(int sockfd, void *buf, size_t *buflen, int flags,\n\t\t       struct in6_addr *addr, uint32_t *ifindex)\n{\n\tstruct sockaddr_in6 sin6;\n\tunsigned char cbuf[CMSG_SPACE(sizeof(struct in6_pktinfo))];\n\tstruct iovec iovec;\n\tstruct msghdr msghdr;\n\tstruct cmsghdr *cmsghdr;\n\tssize_t len;\n\n\tiovec.iov_len = *buflen;\n\tiovec.iov_base = buf;\n\tmemset(&msghdr, 0, sizeof(msghdr));\n\tmsghdr.msg_name = &sin6;\n\tmsghdr.msg_namelen = sizeof(sin6);\n\tmsghdr.msg_iov = &iovec;\n\tmsghdr.msg_iovlen = 1;\n\tmsghdr.msg_control = cbuf;\n\tmsghdr.msg_controllen = sizeof(cbuf);\n\n\tlen = recvmsg(sockfd, &msghdr, flags);\n\tif (len == -1)\n\t\treturn -errno;\n\t*buflen = len;\n\n\t/* Set ifindex to scope_id now. But since scope_id gets not\n\t * set by kernel for linklocal addresses, use pktinfo to obtain that\n\t * value right after.\n\t */\n\t*ifindex = sin6.sin6_scope_id;\n        for (cmsghdr = CMSG_FIRSTHDR(&msghdr); cmsghdr;\n\t     cmsghdr = CMSG_NXTHDR(&msghdr, cmsghdr)) {\n\t\tif (cmsghdr->cmsg_level == IPPROTO_IPV6 &&\n\t\t    cmsghdr->cmsg_type == IPV6_PKTINFO &&\n\t\t    cmsghdr->cmsg_len == CMSG_LEN(sizeof(struct in6_pktinfo))) {\n\t\t\tstruct in6_pktinfo *pktinfo;\n\n\t\t\tpktinfo = (struct in6_pktinfo *) CMSG_DATA(cmsghdr);\n\t\t\t*ifindex = pktinfo->ipi6_ifindex;\n\t\t}\n\t}\n\t*addr = sin6.sin6_addr;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nstatic int myrecvfrom6(int sockfd, void *buf, size_t *buflen, int flags,\n\t\t       struct in6_addr *addr, uint32_t *ifindex)\n{\n\tstruct sockaddr_in6 sin6;\n\tunsigned char cbuf[CMSG_SPACE(sizeof(struct in6_pktinfo))];\n\tstruct iovec iovec;\n\tstruct msghdr msghdr;\n\tstruct cmsghdr *cmsghdr;\n\tssize_t len;\n\n\tiovec.iov_len = *buflen;\n\tiovec.iov_base = buf;\n\tmemset(&msghdr, 0, sizeof(msghdr));\n\tmsghdr.msg_name = &sin6;\n\tmsghdr.msg_namelen = sizeof(sin6);\n\tmsghdr.msg_iov = &iovec;\n\tmsghdr.msg_iovlen = 1;\n\tmsghdr.msg_control = cbuf;\n\tmsghdr.msg_controllen = sizeof(cbuf);\n\n\tlen = recvmsg(sockfd, &msghdr, flags);\n\tif (len == -1)\n\t\treturn -errno;\n\t*buflen = len;\n\n\t/* Set ifindex to scope_id now. But since scope_id gets not\n\t * set by kernel for linklocal addresses, use pktinfo to obtain that\n\t * value right after.\n\t */\n\t*ifindex = sin6.sin6_scope_id;\n        for (cmsghdr = CMSG_FIRSTHDR(&msghdr); cmsghdr;\n\t     cmsghdr = CMSG_NXTHDR(&msghdr, cmsghdr)) {\n\t\tif (cmsghdr->cmsg_level == IPPROTO_IPV6 &&\n\t\t    cmsghdr->cmsg_type == IPV6_PKTINFO &&\n\t\t    cmsghdr->cmsg_len == CMSG_LEN(sizeof(struct in6_pktinfo))) {\n\t\t\tstruct in6_pktinfo *pktinfo;\n\n\t\t\tpktinfo = (struct in6_pktinfo *) CMSG_DATA(cmsghdr);\n\t\t\t*ifindex = pktinfo->ipi6_ifindex;\n\t\t}\n\t}\n\t*addr = sin6.sin6_addr;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_payload_maxlen",
          "args": [
            "msg"
          ],
          "line": 1698
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_maxlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "485-489",
          "snippet": "NDP_EXPORT\nsize_t ndp_msg_payload_maxlen(struct ndp_msg *msg)\n{\n\treturn sizeof(msg->buf);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nsize_t ndp_msg_payload_maxlen(struct ndp_msg *msg)\n{\n\treturn sizeof(msg->buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_alloc",
          "args": [],
          "line": 1694
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "401-410",
          "snippet": "static struct ndp_msg *ndp_msg_alloc(void)\n{\n\tstruct ndp_msg *msg;\n\n\tmsg = myzalloc(sizeof(*msg));\n\tif (!msg)\n\t\treturn NULL;\n\tmsg->icmp6_hdr = (struct icmp6_hdr *) msg->buf;\n\treturn msg;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic struct ndp_msg *ndp_msg_alloc(void)\n{\n\tstruct ndp_msg *msg;\n\n\tmsg = myzalloc(sizeof(*msg));\n\tif (!msg)\n\t\treturn NULL;\n\tmsg->icmp6_hdr = (struct icmp6_hdr *) msg->buf;\n\treturn msg;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic int ndp_sock_recv(struct ndp *ndp)\n{\n\tstruct ndp_msg *msg;\n\tenum ndp_msg_type msg_type;\n\tsize_t len;\n\tint err;\n\n\tmsg = ndp_msg_alloc();\n\tif (!msg)\n\t\treturn -ENOMEM;\n\n\tlen = ndp_msg_payload_maxlen(msg);\n\terr = myrecvfrom6(ndp->sock, msg->buf, &len, 0,\n\t\t\t  &msg->addrto, &msg->ifindex);\n\tif (err) {\n\t\terr(ndp, \"Failed to receive message\");\n\t\tgoto free_msg;\n\t}\n\tdbg(ndp, \"rcvd from: %s, ifindex: %u\",\n\t\t str_in6_addr(&msg->addrto), msg->ifindex);\n\n\tif (len < sizeof(*msg->icmp6_hdr)) {\n\t\twarn(ndp, \"rcvd icmp6 packet too short (%luB)\", len);\n\t\terr = 0;\n\t\tgoto free_msg;\n\t}\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\tif (err) {\n\t\terr = 0;\n\t\tgoto free_msg;\n\t}\n\tndp_msg_init(msg, msg_type);\n\tndp_msg_payload_len_set(msg, len);\n\n\tif (!ndp_msg_check_valid(msg)) {\n\t\twarn(ndp, \"rcvd invalid ND message\");\n\t\terr = 0;\n\t\tgoto free_msg;\n\t}\n\n\tdbg(ndp, \"rcvd %s, len: %zuB\",\n\t\t ndp_msg_type_info(msg_type)->strabbr, len);\n\n\tif (!ndp_msg_check_opts(msg)) {\n\t\terr = 0;\n\t\tgoto free_msg;\n\t}\n\n\terr = ndp_call_handlers(ndp, msg);;\n\nfree_msg:\n\tndp_msg_destroy(msg);\n\treturn err;\n}"
  },
  {
    "function_name": "ndp_msg_opt_dnssl_domain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1639-1683",
    "snippet": "NDP_EXPORT\nchar *ndp_msg_opt_dnssl_domain(struct ndp_msg *msg, int offset,\n\t\t\t       int domain_index)\n{\n\tint i;\n\tstatic char buf[256];\n\tstruct __nd_opt_dnssl *dnssl =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\tsize_t len = dnssl->nd_opt_dnssl_len << 3; /* convert to bytes */\n\tchar *ptr;\n\n\tlen -= in_struct_offset(struct __nd_opt_dnssl, nd_opt_dnssl_domains);\n\tptr = dnssl->nd_opt_dnssl_domains;\n\n\ti = 0;\n\twhile (len > 0) {\n\t\tsize_t buf_len = 0;\n\t\twhile (len > 0) {\n\t\t\tuint8_t dom_len = *ptr;\n\n\t\t\tptr++;\n\t\t\tlen--;\n\t\t\tif (!dom_len)\n\t\t\t\tbreak;\n\n\t\t\tif (dom_len > len)\n\t\t\t\treturn NULL;\n\n\t\t\tif (buf_len + dom_len + 1 > sizeof(buf))\n\t\t\t\treturn NULL;\n\n\t\t\tmemcpy(buf + buf_len, ptr, dom_len);\n\t\t\tbuf[buf_len + dom_len] = '.';\n\t\t\tptr += dom_len;\n\t\t\tlen -= dom_len;\n\t\t\tbuf_len += dom_len + 1;\n\t\t}\n\t\tif (!buf_len)\n\t\t\tbreak;\n\t\tbuf[buf_len - 1] = '\\0'; /* overwrite final '.' */\n\t\tif (i++ == domain_index)\n\t\t\treturn buf;\n\t}\n\treturn NULL;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buf + buf_len",
            "ptr",
            "dom_len"
          ],
          "line": 1670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in_struct_offset",
          "args": [
            "struct__nd_opt_dnssl",
            "nd_opt_dnssl_domains"
          ],
          "line": 1650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_offset",
          "args": [
            "msg",
            "offset"
          ],
          "line": 1646
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "533-538",
          "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nchar *ndp_msg_opt_dnssl_domain(struct ndp_msg *msg, int offset,\n\t\t\t       int domain_index)\n{\n\tint i;\n\tstatic char buf[256];\n\tstruct __nd_opt_dnssl *dnssl =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\tsize_t len = dnssl->nd_opt_dnssl_len << 3; /* convert to bytes */\n\tchar *ptr;\n\n\tlen -= in_struct_offset(struct __nd_opt_dnssl, nd_opt_dnssl_domains);\n\tptr = dnssl->nd_opt_dnssl_domains;\n\n\ti = 0;\n\twhile (len > 0) {\n\t\tsize_t buf_len = 0;\n\t\twhile (len > 0) {\n\t\t\tuint8_t dom_len = *ptr;\n\n\t\t\tptr++;\n\t\t\tlen--;\n\t\t\tif (!dom_len)\n\t\t\t\tbreak;\n\n\t\t\tif (dom_len > len)\n\t\t\t\treturn NULL;\n\n\t\t\tif (buf_len + dom_len + 1 > sizeof(buf))\n\t\t\t\treturn NULL;\n\n\t\t\tmemcpy(buf + buf_len, ptr, dom_len);\n\t\t\tbuf[buf_len + dom_len] = '.';\n\t\t\tptr += dom_len;\n\t\t\tlen -= dom_len;\n\t\t\tbuf_len += dom_len + 1;\n\t\t}\n\t\tif (!buf_len)\n\t\t\tbreak;\n\t\tbuf[buf_len - 1] = '\\0'; /* overwrite final '.' */\n\t\tif (i++ == domain_index)\n\t\t\treturn buf;\n\t}\n\treturn NULL;\n}"
  },
  {
    "function_name": "ndp_msg_opt_dnssl_lifetime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1618-1625",
    "snippet": "NDP_EXPORT\nuint32_t ndp_msg_opt_dnssl_lifetime(struct ndp_msg *msg, int offset)\n{\n\tstruct __nd_opt_dnssl *dnssl =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(dnssl->nd_opt_dnssl_lifetime);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "dnssl->nd_opt_dnssl_lifetime"
          ],
          "line": 1624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_offset",
          "args": [
            "msg",
            "offset"
          ],
          "line": 1622
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "533-538",
          "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint32_t ndp_msg_opt_dnssl_lifetime(struct ndp_msg *msg, int offset)\n{\n\tstruct __nd_opt_dnssl *dnssl =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(dnssl->nd_opt_dnssl_lifetime);\n}"
  },
  {
    "function_name": "ndp_msg_opt_rdnss_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1591-1605",
    "snippet": "in6_addr *ndp_msg_opt_rdnss_addr(struct ndp_msg *msg, int offset,\n\t\t\t\t\tint addr_index)\n{\n\tstatic struct in6_addr addr;\n\tstruct __nd_opt_rdnss *rdnss =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\tsize_t len = rdnss->nd_opt_rdnss_len << 3; /* convert to bytes */\n\n\tlen -= in_struct_offset(struct __nd_opt_rdnss, nd_opt_rdnss_addresses);\n\tif ((addr_index + 1) * sizeof(addr) > len)\n\t\treturn NULL;\n\tmemcpy(&addr, &rdnss->nd_opt_rdnss_addresses[addr_index * sizeof(addr)],\n\t       sizeof(addr));\n\treturn &addr;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&addr",
            "&rdnss->nd_opt_rdnss_addresses[addr_index * sizeof(addr)]",
            "sizeof(addr)"
          ],
          "line": 1602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in_struct_offset",
          "args": [
            "struct__nd_opt_rdnss",
            "nd_opt_rdnss_addresses"
          ],
          "line": 1599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_offset",
          "args": [
            "msg",
            "offset"
          ],
          "line": 1596
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "533-538",
          "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nin6_addr *ndp_msg_opt_rdnss_addr(struct ndp_msg *msg, int offset,\n\t\t\t\t\tint addr_index)\n{\n\tstatic struct in6_addr addr;\n\tstruct __nd_opt_rdnss *rdnss =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\tsize_t len = rdnss->nd_opt_rdnss_len << 3; /* convert to bytes */\n\n\tlen -= in_struct_offset(struct __nd_opt_rdnss, nd_opt_rdnss_addresses);\n\tif ((addr_index + 1) * sizeof(addr) > len)\n\t\treturn NULL;\n\tmemcpy(&addr, &rdnss->nd_opt_rdnss_addresses[addr_index * sizeof(addr)],\n\t       sizeof(addr));\n\treturn &addr;\n}"
  },
  {
    "function_name": "ndp_msg_opt_rdnss_lifetime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1569-1576",
    "snippet": "NDP_EXPORT\nuint32_t ndp_msg_opt_rdnss_lifetime(struct ndp_msg *msg, int offset)\n{\n\tstruct __nd_opt_rdnss *rdnss =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(rdnss->nd_opt_rdnss_lifetime);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "rdnss->nd_opt_rdnss_lifetime"
          ],
          "line": 1575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_offset",
          "args": [
            "msg",
            "offset"
          ],
          "line": 1573
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "533-538",
          "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint32_t ndp_msg_opt_rdnss_lifetime(struct ndp_msg *msg, int offset)\n{\n\tstruct __nd_opt_rdnss *rdnss =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(rdnss->nd_opt_rdnss_lifetime);\n}"
  },
  {
    "function_name": "ndp_msg_opt_route_preference",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1549-1556",
    "snippet": "ndp_route_preference\nndp_msg_opt_route_preference(struct ndp_msg *msg, int offset)\n{\n\tstruct __nd_opt_route_info *ri =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn (ri->nd_opt_ri_prf_reserved >> 3) & 3;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_offset",
          "args": [
            "msg",
            "offset"
          ],
          "line": 1553
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "533-538",
          "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nndp_route_preference\nndp_msg_opt_route_preference(struct ndp_msg *msg, int offset)\n{\n\tstruct __nd_opt_route_info *ri =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn (ri->nd_opt_ri_prf_reserved >> 3) & 3;\n}"
  },
  {
    "function_name": "ndp_msg_opt_route_lifetime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1528-1535",
    "snippet": "NDP_EXPORT\nuint32_t ndp_msg_opt_route_lifetime(struct ndp_msg *msg, int offset)\n{\n\tstruct __nd_opt_route_info *ri =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(ri->nd_opt_ri_lifetime);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "ri->nd_opt_ri_lifetime"
          ],
          "line": 1534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_offset",
          "args": [
            "msg",
            "offset"
          ],
          "line": 1532
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "533-538",
          "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint32_t ndp_msg_opt_route_lifetime(struct ndp_msg *msg, int offset)\n{\n\tstruct __nd_opt_route_info *ri =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(ri->nd_opt_ri_lifetime);\n}"
  },
  {
    "function_name": "ndp_msg_opt_route_prefix_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1508-1515",
    "snippet": "NDP_EXPORT\nuint8_t ndp_msg_opt_route_prefix_len(struct ndp_msg *msg, int offset)\n{\n\tstruct __nd_opt_route_info *ri =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ri->nd_opt_ri_prefix_len;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_offset",
          "args": [
            "msg",
            "offset"
          ],
          "line": 1512
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "533-538",
          "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint8_t ndp_msg_opt_route_prefix_len(struct ndp_msg *msg, int offset)\n{\n\tstruct __nd_opt_route_info *ri =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ri->nd_opt_ri_prefix_len;\n}"
  },
  {
    "function_name": "ndp_msg_opt_route_prefix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1486-1495",
    "snippet": "in6_addr *ndp_msg_opt_route_prefix(struct ndp_msg *msg, int offset)\n{\n\tstatic struct in6_addr prefix;\n\tstruct __nd_opt_route_info *ri =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\tmemset(&prefix, 0, sizeof(prefix));\n\tmemcpy(&prefix, &ri->nd_opt_ri_prefix, (ri->nd_opt_ri_len - 1) << 3);\n\treturn &prefix;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&prefix",
            "&ri->nd_opt_ri_prefix",
            "(ri->nd_opt_ri_len - 1) << 3"
          ],
          "line": 1493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&prefix",
            "0",
            "sizeof(prefix)"
          ],
          "line": 1492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_offset",
          "args": [
            "msg",
            "offset"
          ],
          "line": 1490
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "533-538",
          "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nin6_addr *ndp_msg_opt_route_prefix(struct ndp_msg *msg, int offset)\n{\n\tstatic struct in6_addr prefix;\n\tstruct __nd_opt_route_info *ri =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\tmemset(&prefix, 0, sizeof(prefix));\n\tmemcpy(&prefix, &ri->nd_opt_ri_prefix, (ri->nd_opt_ri_len - 1) << 3);\n\treturn &prefix;\n}"
  },
  {
    "function_name": "ndp_msg_opt_mtu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1466-1472",
    "snippet": "NDP_EXPORT\nuint32_t ndp_msg_opt_mtu(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_mtu *mtu = ndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(mtu->nd_opt_mtu_mtu);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "mtu->nd_opt_mtu_mtu"
          ],
          "line": 1471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_offset",
          "args": [
            "msg",
            "offset"
          ],
          "line": 1469
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "533-538",
          "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint32_t ndp_msg_opt_mtu(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_mtu *mtu = ndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(mtu->nd_opt_mtu_mtu);\n}"
  },
  {
    "function_name": "ndp_msg_opt_prefix_flag_router_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1448-1455",
    "snippet": "NDP_EXPORT\nbool ndp_msg_opt_prefix_flag_router_addr(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn pi->nd_opt_pi_flags_reserved & ND_OPT_PI_FLAG_RADDR;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_offset",
          "args": [
            "msg",
            "offset"
          ],
          "line": 1452
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "533-538",
          "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nbool ndp_msg_opt_prefix_flag_router_addr(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn pi->nd_opt_pi_flags_reserved & ND_OPT_PI_FLAG_RADDR;\n}"
  },
  {
    "function_name": "ndp_msg_opt_prefix_flag_auto_addr_conf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1428-1435",
    "snippet": "NDP_EXPORT\nbool ndp_msg_opt_prefix_flag_auto_addr_conf(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn pi->nd_opt_pi_flags_reserved & ND_OPT_PI_FLAG_AUTO;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_offset",
          "args": [
            "msg",
            "offset"
          ],
          "line": 1432
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "533-538",
          "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nbool ndp_msg_opt_prefix_flag_auto_addr_conf(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn pi->nd_opt_pi_flags_reserved & ND_OPT_PI_FLAG_AUTO;\n}"
  },
  {
    "function_name": "ndp_msg_opt_prefix_flag_on_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1408-1415",
    "snippet": "NDP_EXPORT\nbool ndp_msg_opt_prefix_flag_on_link(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn pi->nd_opt_pi_flags_reserved & ND_OPT_PI_FLAG_ONLINK;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_offset",
          "args": [
            "msg",
            "offset"
          ],
          "line": 1412
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "533-538",
          "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nbool ndp_msg_opt_prefix_flag_on_link(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn pi->nd_opt_pi_flags_reserved & ND_OPT_PI_FLAG_ONLINK;\n}"
  },
  {
    "function_name": "ndp_msg_opt_prefix_preferred_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1388-1395",
    "snippet": "NDP_EXPORT\nuint32_t ndp_msg_opt_prefix_preferred_time(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(pi->nd_opt_pi_preferred_time);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "pi->nd_opt_pi_preferred_time"
          ],
          "line": 1394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_offset",
          "args": [
            "msg",
            "offset"
          ],
          "line": 1392
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "533-538",
          "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint32_t ndp_msg_opt_prefix_preferred_time(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(pi->nd_opt_pi_preferred_time);\n}"
  },
  {
    "function_name": "ndp_msg_opt_prefix_valid_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1368-1375",
    "snippet": "NDP_EXPORT\nuint32_t ndp_msg_opt_prefix_valid_time(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(pi->nd_opt_pi_valid_time);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "pi->nd_opt_pi_valid_time"
          ],
          "line": 1374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_offset",
          "args": [
            "msg",
            "offset"
          ],
          "line": 1372
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "533-538",
          "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint32_t ndp_msg_opt_prefix_valid_time(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(pi->nd_opt_pi_valid_time);\n}"
  },
  {
    "function_name": "ndp_msg_opt_prefix_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1348-1355",
    "snippet": "NDP_EXPORT\nuint8_t ndp_msg_opt_prefix_len(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn pi->nd_opt_pi_prefix_len;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_offset",
          "args": [
            "msg",
            "offset"
          ],
          "line": 1352
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "533-538",
          "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint8_t ndp_msg_opt_prefix_len(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn pi->nd_opt_pi_prefix_len;\n}"
  },
  {
    "function_name": "ndp_msg_opt_prefix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1329-1335",
    "snippet": "in6_addr *ndp_msg_opt_prefix(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn &pi->nd_opt_pi_prefix;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_offset",
          "args": [
            "msg",
            "offset"
          ],
          "line": 1332
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "533-538",
          "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nin6_addr *ndp_msg_opt_prefix(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn &pi->nd_opt_pi_prefix;\n}"
  },
  {
    "function_name": "ndp_msg_opt_tlladdr_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1311-1315",
    "snippet": "NDP_EXPORT\nsize_t ndp_msg_opt_tlladdr_len(struct ndp_msg *msg, int offset)\n{\n\treturn ETH_ALEN;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nsize_t ndp_msg_opt_tlladdr_len(struct ndp_msg *msg, int offset)\n{\n\treturn ETH_ALEN;\n}"
  },
  {
    "function_name": "ndp_msg_opt_tlladdr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1292-1298",
    "snippet": "NDP_EXPORT\nunsigned char *ndp_msg_opt_tlladdr(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *opt_data = ndp_msg_payload_opts_offset(msg, offset);\n\n\treturn &opt_data[2];\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_offset",
          "args": [
            "msg",
            "offset"
          ],
          "line": 1295
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "533-538",
          "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nunsigned char *ndp_msg_opt_tlladdr(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *opt_data = ndp_msg_payload_opts_offset(msg, offset);\n\n\treturn &opt_data[2];\n}"
  },
  {
    "function_name": "ndp_msg_opt_slladdr_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1275-1279",
    "snippet": "NDP_EXPORT\nsize_t ndp_msg_opt_slladdr_len(struct ndp_msg *msg, int offset)\n{\n\treturn ETH_ALEN;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nsize_t ndp_msg_opt_slladdr_len(struct ndp_msg *msg, int offset)\n{\n\treturn ETH_ALEN;\n}"
  },
  {
    "function_name": "ndp_msg_opt_slladdr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1256-1262",
    "snippet": "NDP_EXPORT\nunsigned char *ndp_msg_opt_slladdr(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *opt_data = ndp_msg_payload_opts_offset(msg, offset);\n\n\treturn &opt_data[2];\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_offset",
          "args": [
            "msg",
            "offset"
          ],
          "line": 1259
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "533-538",
          "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nunsigned char *ndp_msg_opt_slladdr(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *opt_data = ndp_msg_payload_opts_offset(msg, offset);\n\n\treturn &opt_data[2];\n}"
  },
  {
    "function_name": "ndp_msg_check_opts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1213-1238",
    "snippet": "static bool ndp_msg_check_opts(struct ndp_msg *msg)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\tsize_t len = ndp_msg_payload_opts_len(msg);\n\tstruct ndp_msg_opt_type_info *info;\n\n\twhile (len > 0) {\n\t\tuint8_t cur_opt_raw_type = ptr[0];\n\t\tunsigned int cur_opt_len = ptr[1] << 3; /* convert to bytes */\n\n\t\tif (!cur_opt_len)\n\t\t\treturn false;\n\t\tif (len < cur_opt_len)\n\t\t\tbreak;\n\t\tinfo = ndp_msg_opt_type_info_by_raw_type(cur_opt_raw_type);\n\t\tif (info) {\n\t\t\tif (cur_opt_len < info->raw_struct_size ||\n\t\t\t    (info->check_valid && !info->check_valid(ptr)))\n\t\t\t\tptr[0] = __INVALID_OPT_TYPE_MAGIC;\n\t\t}\n\t\tptr += cur_opt_len;\n\t\tlen -= cur_opt_len;\n\t}\n\n\treturn true;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [
      "#define __INVALID_OPT_TYPE_MAGIC 0xff"
    ],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "info->check_valid",
          "args": [
            "ptr"
          ],
          "line": 1230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_opt_type_info_by_raw_type",
          "args": [
            "cur_opt_raw_type"
          ],
          "line": 1227
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_opt_type_info_by_raw_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1150-1161",
          "snippet": "struct ndp_msg_opt_type_info *ndp_msg_opt_type_info_by_raw_type(uint8_t raw_type)\n{\n\tstruct ndp_msg_opt_type_info *info;\n\tint i;\n\n\tfor (i = 0; i < NDP_MSG_OPT_TYPE_LIST_SIZE; i++) {\n\t\tinfo = &ndp_msg_opt_type_info_list[i];\n\t\tif (info->raw_type == raw_type)\n\t\t\treturn info;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define NDP_MSG_OPT_TYPE_LIST_SIZE ARRAY_SIZE(ndp_msg_opt_type_info_list)"
          ],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static struct ndp_msg_opt_type_info ndp_msg_opt_type_info_list[] =\n{\n\t[NDP_MSG_OPT_SLLADDR] = {\n\t\t.raw_type = ND_OPT_SOURCE_LINKADDR,\n\t},\n\t[NDP_MSG_OPT_TLLADDR] = {\n\t\t.raw_type = ND_OPT_TARGET_LINKADDR,\n\t},\n\t[NDP_MSG_OPT_PREFIX] = {\n\t\t.raw_type = ND_OPT_PREFIX_INFORMATION,\n\t\t.raw_struct_size = sizeof(struct nd_opt_prefix_info),\n\t},\n\t[NDP_MSG_OPT_REDIR] = {\n\t\t.raw_type = ND_OPT_REDIRECTED_HEADER,\n\t},\n\t[NDP_MSG_OPT_MTU] = {\n\t\t.raw_type = ND_OPT_MTU,\n\t\t.raw_struct_size = sizeof(struct nd_opt_mtu),\n\t},\n\t[NDP_MSG_OPT_ROUTE] = {\n\t\t.raw_type = __ND_OPT_ROUTE_INFO,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_route_info),\n\t\t.check_valid = ndp_msg_opt_route_check_valid,\n\t},\n\t[NDP_MSG_OPT_RDNSS] = {\n\t\t.raw_type = __ND_OPT_RDNSS,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_rdnss),\n\t},\n\t[NDP_MSG_OPT_DNSSL] = {\n\t\t.raw_type = __ND_OPT_DNSSL,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_dnssl),\n\t},\n};",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define NDP_MSG_OPT_TYPE_LIST_SIZE ARRAY_SIZE(ndp_msg_opt_type_info_list)\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic struct ndp_msg_opt_type_info ndp_msg_opt_type_info_list[] =\n{\n\t[NDP_MSG_OPT_SLLADDR] = {\n\t\t.raw_type = ND_OPT_SOURCE_LINKADDR,\n\t},\n\t[NDP_MSG_OPT_TLLADDR] = {\n\t\t.raw_type = ND_OPT_TARGET_LINKADDR,\n\t},\n\t[NDP_MSG_OPT_PREFIX] = {\n\t\t.raw_type = ND_OPT_PREFIX_INFORMATION,\n\t\t.raw_struct_size = sizeof(struct nd_opt_prefix_info),\n\t},\n\t[NDP_MSG_OPT_REDIR] = {\n\t\t.raw_type = ND_OPT_REDIRECTED_HEADER,\n\t},\n\t[NDP_MSG_OPT_MTU] = {\n\t\t.raw_type = ND_OPT_MTU,\n\t\t.raw_struct_size = sizeof(struct nd_opt_mtu),\n\t},\n\t[NDP_MSG_OPT_ROUTE] = {\n\t\t.raw_type = __ND_OPT_ROUTE_INFO,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_route_info),\n\t\t.check_valid = ndp_msg_opt_route_check_valid,\n\t},\n\t[NDP_MSG_OPT_RDNSS] = {\n\t\t.raw_type = __ND_OPT_RDNSS,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_rdnss),\n\t},\n\t[NDP_MSG_OPT_DNSSL] = {\n\t\t.raw_type = __ND_OPT_DNSSL,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_dnssl),\n\t},\n};\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nstruct ndp_msg_opt_type_info *ndp_msg_opt_type_info_by_raw_type(uint8_t raw_type)\n{\n\tstruct ndp_msg_opt_type_info *info;\n\tint i;\n\n\tfor (i = 0; i < NDP_MSG_OPT_TYPE_LIST_SIZE; i++) {\n\t\tinfo = &ndp_msg_opt_type_info_list[i];\n\t\tif (info->raw_type == raw_type)\n\t\t\treturn info;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_len",
          "args": [
            "msg"
          ],
          "line": 1216
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "548-552",
          "snippet": "NDP_EXPORT\nsize_t ndp_msg_payload_opts_len(struct ndp_msg *msg)\n{\n\treturn msg->len - (msg->opts_start - msg->buf);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nsize_t ndp_msg_payload_opts_len(struct ndp_msg *msg)\n{\n\treturn msg->len - (msg->opts_start - msg->buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define __INVALID_OPT_TYPE_MAGIC 0xff\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic bool ndp_msg_check_opts(struct ndp_msg *msg)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\tsize_t len = ndp_msg_payload_opts_len(msg);\n\tstruct ndp_msg_opt_type_info *info;\n\n\twhile (len > 0) {\n\t\tuint8_t cur_opt_raw_type = ptr[0];\n\t\tunsigned int cur_opt_len = ptr[1] << 3; /* convert to bytes */\n\n\t\tif (!cur_opt_len)\n\t\t\treturn false;\n\t\tif (len < cur_opt_len)\n\t\t\tbreak;\n\t\tinfo = ndp_msg_opt_type_info_by_raw_type(cur_opt_raw_type);\n\t\tif (info) {\n\t\t\tif (cur_opt_len < info->raw_struct_size ||\n\t\t\t    (info->check_valid && !info->check_valid(ptr)))\n\t\t\t\tptr[0] = __INVALID_OPT_TYPE_MAGIC;\n\t\t}\n\t\tptr += cur_opt_len;\n\t\tlen -= cur_opt_len;\n\t}\n\n\treturn true;\n}"
  },
  {
    "function_name": "ndp_msg_next_opt_offset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1175-1205",
    "snippet": "NDP_EXPORT\nint ndp_msg_next_opt_offset(struct ndp_msg *msg, int offset,\n\t\t\t    enum ndp_msg_opt_type opt_type)\n{\n\tunsigned char *opts_start = ndp_msg_payload_opts(msg);\n\tunsigned char *ptr = opts_start;\n\tsize_t len = ndp_msg_payload_opts_len(msg);\n\tuint8_t opt_raw_type = ndp_msg_opt_type_info(opt_type)->raw_type;\n\tbool ignore = true;\n\n\tif (offset == -1) {\n\t\toffset = 0;\n\t\tignore = false;\n\t}\n\n\tptr += offset;\n\tlen -= offset;\n\twhile (len > 0) {\n\t\tuint8_t cur_opt_raw_type = ptr[0];\n\t\tunsigned int cur_opt_len = ptr[1] << 3; /* convert to bytes */\n\n\t\tif (!cur_opt_len || len < cur_opt_len)\n\t\t\tbreak;\n\t\tif (cur_opt_raw_type == opt_raw_type && !ignore)\n\t\t\treturn ptr - opts_start;\n\t\tptr += cur_opt_len;\n\t\tlen -= cur_opt_len;\n\t\tignore = false;\n\t}\n\treturn -1;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_opt_type_info",
          "args": [
            "opt_type"
          ],
          "line": 1182
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_opt_type_info_by_raw_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1150-1161",
          "snippet": "struct ndp_msg_opt_type_info *ndp_msg_opt_type_info_by_raw_type(uint8_t raw_type)\n{\n\tstruct ndp_msg_opt_type_info *info;\n\tint i;\n\n\tfor (i = 0; i < NDP_MSG_OPT_TYPE_LIST_SIZE; i++) {\n\t\tinfo = &ndp_msg_opt_type_info_list[i];\n\t\tif (info->raw_type == raw_type)\n\t\t\treturn info;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define NDP_MSG_OPT_TYPE_LIST_SIZE ARRAY_SIZE(ndp_msg_opt_type_info_list)"
          ],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static struct ndp_msg_opt_type_info ndp_msg_opt_type_info_list[] =\n{\n\t[NDP_MSG_OPT_SLLADDR] = {\n\t\t.raw_type = ND_OPT_SOURCE_LINKADDR,\n\t},\n\t[NDP_MSG_OPT_TLLADDR] = {\n\t\t.raw_type = ND_OPT_TARGET_LINKADDR,\n\t},\n\t[NDP_MSG_OPT_PREFIX] = {\n\t\t.raw_type = ND_OPT_PREFIX_INFORMATION,\n\t\t.raw_struct_size = sizeof(struct nd_opt_prefix_info),\n\t},\n\t[NDP_MSG_OPT_REDIR] = {\n\t\t.raw_type = ND_OPT_REDIRECTED_HEADER,\n\t},\n\t[NDP_MSG_OPT_MTU] = {\n\t\t.raw_type = ND_OPT_MTU,\n\t\t.raw_struct_size = sizeof(struct nd_opt_mtu),\n\t},\n\t[NDP_MSG_OPT_ROUTE] = {\n\t\t.raw_type = __ND_OPT_ROUTE_INFO,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_route_info),\n\t\t.check_valid = ndp_msg_opt_route_check_valid,\n\t},\n\t[NDP_MSG_OPT_RDNSS] = {\n\t\t.raw_type = __ND_OPT_RDNSS,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_rdnss),\n\t},\n\t[NDP_MSG_OPT_DNSSL] = {\n\t\t.raw_type = __ND_OPT_DNSSL,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_dnssl),\n\t},\n};",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define NDP_MSG_OPT_TYPE_LIST_SIZE ARRAY_SIZE(ndp_msg_opt_type_info_list)\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic struct ndp_msg_opt_type_info ndp_msg_opt_type_info_list[] =\n{\n\t[NDP_MSG_OPT_SLLADDR] = {\n\t\t.raw_type = ND_OPT_SOURCE_LINKADDR,\n\t},\n\t[NDP_MSG_OPT_TLLADDR] = {\n\t\t.raw_type = ND_OPT_TARGET_LINKADDR,\n\t},\n\t[NDP_MSG_OPT_PREFIX] = {\n\t\t.raw_type = ND_OPT_PREFIX_INFORMATION,\n\t\t.raw_struct_size = sizeof(struct nd_opt_prefix_info),\n\t},\n\t[NDP_MSG_OPT_REDIR] = {\n\t\t.raw_type = ND_OPT_REDIRECTED_HEADER,\n\t},\n\t[NDP_MSG_OPT_MTU] = {\n\t\t.raw_type = ND_OPT_MTU,\n\t\t.raw_struct_size = sizeof(struct nd_opt_mtu),\n\t},\n\t[NDP_MSG_OPT_ROUTE] = {\n\t\t.raw_type = __ND_OPT_ROUTE_INFO,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_route_info),\n\t\t.check_valid = ndp_msg_opt_route_check_valid,\n\t},\n\t[NDP_MSG_OPT_RDNSS] = {\n\t\t.raw_type = __ND_OPT_RDNSS,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_rdnss),\n\t},\n\t[NDP_MSG_OPT_DNSSL] = {\n\t\t.raw_type = __ND_OPT_DNSSL,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_dnssl),\n\t},\n};\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nstruct ndp_msg_opt_type_info *ndp_msg_opt_type_info_by_raw_type(uint8_t raw_type)\n{\n\tstruct ndp_msg_opt_type_info *info;\n\tint i;\n\n\tfor (i = 0; i < NDP_MSG_OPT_TYPE_LIST_SIZE; i++) {\n\t\tinfo = &ndp_msg_opt_type_info_list[i];\n\t\tif (info->raw_type == raw_type)\n\t\t\treturn info;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts_len",
          "args": [
            "msg"
          ],
          "line": 1181
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "548-552",
          "snippet": "NDP_EXPORT\nsize_t ndp_msg_payload_opts_len(struct ndp_msg *msg)\n{\n\treturn msg->len - (msg->opts_start - msg->buf);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nsize_t ndp_msg_payload_opts_len(struct ndp_msg *msg)\n{\n\treturn msg->len - (msg->opts_start - msg->buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nint ndp_msg_next_opt_offset(struct ndp_msg *msg, int offset,\n\t\t\t    enum ndp_msg_opt_type opt_type)\n{\n\tunsigned char *opts_start = ndp_msg_payload_opts(msg);\n\tunsigned char *ptr = opts_start;\n\tsize_t len = ndp_msg_payload_opts_len(msg);\n\tuint8_t opt_raw_type = ndp_msg_opt_type_info(opt_type)->raw_type;\n\tbool ignore = true;\n\n\tif (offset == -1) {\n\t\toffset = 0;\n\t\tignore = false;\n\t}\n\n\tptr += offset;\n\tlen -= offset;\n\twhile (len > 0) {\n\t\tuint8_t cur_opt_raw_type = ptr[0];\n\t\tunsigned int cur_opt_len = ptr[1] << 3; /* convert to bytes */\n\n\t\tif (!cur_opt_len || len < cur_opt_len)\n\t\t\tbreak;\n\t\tif (cur_opt_raw_type == opt_raw_type && !ignore)\n\t\t\treturn ptr - opts_start;\n\t\tptr += cur_opt_len;\n\t\tlen -= cur_opt_len;\n\t\tignore = false;\n\t}\n\treturn -1;\n}"
  },
  {
    "function_name": "ndp_msg_opt_type_info_by_raw_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1150-1161",
    "snippet": "struct ndp_msg_opt_type_info *ndp_msg_opt_type_info_by_raw_type(uint8_t raw_type)\n{\n\tstruct ndp_msg_opt_type_info *info;\n\tint i;\n\n\tfor (i = 0; i < NDP_MSG_OPT_TYPE_LIST_SIZE; i++) {\n\t\tinfo = &ndp_msg_opt_type_info_list[i];\n\t\tif (info->raw_type == raw_type)\n\t\t\treturn info;\n\t}\n\treturn NULL;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [
      "#define NDP_MSG_OPT_TYPE_LIST_SIZE ARRAY_SIZE(ndp_msg_opt_type_info_list)"
    ],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static struct ndp_msg_opt_type_info ndp_msg_opt_type_info_list[] =\n{\n\t[NDP_MSG_OPT_SLLADDR] = {\n\t\t.raw_type = ND_OPT_SOURCE_LINKADDR,\n\t},\n\t[NDP_MSG_OPT_TLLADDR] = {\n\t\t.raw_type = ND_OPT_TARGET_LINKADDR,\n\t},\n\t[NDP_MSG_OPT_PREFIX] = {\n\t\t.raw_type = ND_OPT_PREFIX_INFORMATION,\n\t\t.raw_struct_size = sizeof(struct nd_opt_prefix_info),\n\t},\n\t[NDP_MSG_OPT_REDIR] = {\n\t\t.raw_type = ND_OPT_REDIRECTED_HEADER,\n\t},\n\t[NDP_MSG_OPT_MTU] = {\n\t\t.raw_type = ND_OPT_MTU,\n\t\t.raw_struct_size = sizeof(struct nd_opt_mtu),\n\t},\n\t[NDP_MSG_OPT_ROUTE] = {\n\t\t.raw_type = __ND_OPT_ROUTE_INFO,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_route_info),\n\t\t.check_valid = ndp_msg_opt_route_check_valid,\n\t},\n\t[NDP_MSG_OPT_RDNSS] = {\n\t\t.raw_type = __ND_OPT_RDNSS,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_rdnss),\n\t},\n\t[NDP_MSG_OPT_DNSSL] = {\n\t\t.raw_type = __ND_OPT_DNSSL,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_dnssl),\n\t},\n};",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define NDP_MSG_OPT_TYPE_LIST_SIZE ARRAY_SIZE(ndp_msg_opt_type_info_list)\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic struct ndp_msg_opt_type_info ndp_msg_opt_type_info_list[] =\n{\n\t[NDP_MSG_OPT_SLLADDR] = {\n\t\t.raw_type = ND_OPT_SOURCE_LINKADDR,\n\t},\n\t[NDP_MSG_OPT_TLLADDR] = {\n\t\t.raw_type = ND_OPT_TARGET_LINKADDR,\n\t},\n\t[NDP_MSG_OPT_PREFIX] = {\n\t\t.raw_type = ND_OPT_PREFIX_INFORMATION,\n\t\t.raw_struct_size = sizeof(struct nd_opt_prefix_info),\n\t},\n\t[NDP_MSG_OPT_REDIR] = {\n\t\t.raw_type = ND_OPT_REDIRECTED_HEADER,\n\t},\n\t[NDP_MSG_OPT_MTU] = {\n\t\t.raw_type = ND_OPT_MTU,\n\t\t.raw_struct_size = sizeof(struct nd_opt_mtu),\n\t},\n\t[NDP_MSG_OPT_ROUTE] = {\n\t\t.raw_type = __ND_OPT_ROUTE_INFO,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_route_info),\n\t\t.check_valid = ndp_msg_opt_route_check_valid,\n\t},\n\t[NDP_MSG_OPT_RDNSS] = {\n\t\t.raw_type = __ND_OPT_RDNSS,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_rdnss),\n\t},\n\t[NDP_MSG_OPT_DNSSL] = {\n\t\t.raw_type = __ND_OPT_DNSSL,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_dnssl),\n\t},\n};\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nstruct ndp_msg_opt_type_info *ndp_msg_opt_type_info_by_raw_type(uint8_t raw_type)\n{\n\tstruct ndp_msg_opt_type_info *info;\n\tint i;\n\n\tfor (i = 0; i < NDP_MSG_OPT_TYPE_LIST_SIZE; i++) {\n\t\tinfo = &ndp_msg_opt_type_info_list[i];\n\t\tif (info->raw_type == raw_type)\n\t\t\treturn info;\n\t}\n\treturn NULL;\n}"
  },
  {
    "function_name": "ndp_msg_opt_type_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1145-1148",
    "snippet": "struct ndp_msg_opt_type_info *ndp_msg_opt_type_info(enum ndp_msg_opt_type msg_opt_type)\n{\n\treturn &ndp_msg_opt_type_info_list[msg_opt_type];\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "static struct ndp_msg_opt_type_info ndp_msg_opt_type_info_list[] =\n{\n\t[NDP_MSG_OPT_SLLADDR] = {\n\t\t.raw_type = ND_OPT_SOURCE_LINKADDR,\n\t},\n\t[NDP_MSG_OPT_TLLADDR] = {\n\t\t.raw_type = ND_OPT_TARGET_LINKADDR,\n\t},\n\t[NDP_MSG_OPT_PREFIX] = {\n\t\t.raw_type = ND_OPT_PREFIX_INFORMATION,\n\t\t.raw_struct_size = sizeof(struct nd_opt_prefix_info),\n\t},\n\t[NDP_MSG_OPT_REDIR] = {\n\t\t.raw_type = ND_OPT_REDIRECTED_HEADER,\n\t},\n\t[NDP_MSG_OPT_MTU] = {\n\t\t.raw_type = ND_OPT_MTU,\n\t\t.raw_struct_size = sizeof(struct nd_opt_mtu),\n\t},\n\t[NDP_MSG_OPT_ROUTE] = {\n\t\t.raw_type = __ND_OPT_ROUTE_INFO,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_route_info),\n\t\t.check_valid = ndp_msg_opt_route_check_valid,\n\t},\n\t[NDP_MSG_OPT_RDNSS] = {\n\t\t.raw_type = __ND_OPT_RDNSS,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_rdnss),\n\t},\n\t[NDP_MSG_OPT_DNSSL] = {\n\t\t.raw_type = __ND_OPT_DNSSL,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_dnssl),\n\t},\n};",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nstatic struct ndp_msg_opt_type_info ndp_msg_opt_type_info_list[] =\n{\n\t[NDP_MSG_OPT_SLLADDR] = {\n\t\t.raw_type = ND_OPT_SOURCE_LINKADDR,\n\t},\n\t[NDP_MSG_OPT_TLLADDR] = {\n\t\t.raw_type = ND_OPT_TARGET_LINKADDR,\n\t},\n\t[NDP_MSG_OPT_PREFIX] = {\n\t\t.raw_type = ND_OPT_PREFIX_INFORMATION,\n\t\t.raw_struct_size = sizeof(struct nd_opt_prefix_info),\n\t},\n\t[NDP_MSG_OPT_REDIR] = {\n\t\t.raw_type = ND_OPT_REDIRECTED_HEADER,\n\t},\n\t[NDP_MSG_OPT_MTU] = {\n\t\t.raw_type = ND_OPT_MTU,\n\t\t.raw_struct_size = sizeof(struct nd_opt_mtu),\n\t},\n\t[NDP_MSG_OPT_ROUTE] = {\n\t\t.raw_type = __ND_OPT_ROUTE_INFO,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_route_info),\n\t\t.check_valid = ndp_msg_opt_route_check_valid,\n\t},\n\t[NDP_MSG_OPT_RDNSS] = {\n\t\t.raw_type = __ND_OPT_RDNSS,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_rdnss),\n\t},\n\t[NDP_MSG_OPT_DNSSL] = {\n\t\t.raw_type = __ND_OPT_DNSSL,\n\t\t.raw_struct_size = sizeof(struct __nd_opt_dnssl),\n\t},\n};\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\n\nstruct ndp_msg_opt_type_info *ndp_msg_opt_type_info(enum ndp_msg_opt_type msg_opt_type)\n{\n\treturn &ndp_msg_opt_type_info_list[msg_opt_type];\n}"
  },
  {
    "function_name": "ndp_msg_opt_route_check_valid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1096-1107",
    "snippet": "static bool ndp_msg_opt_route_check_valid(void *opt_data)\n{\n\tstruct __nd_opt_route_info *ri = opt_data;\n\n\t/* rfc4191 says:\n\t * If the Reserved (10) value is received, the Route Information Option\n\t * MUST be ignored.\n\t */\n\tif (((ri->nd_opt_ri_prf_reserved >> 3) & 3) == 2)\n\t\treturn false;\n\treturn true;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nstatic bool ndp_msg_opt_route_check_valid(void *opt_data)\n{\n\tstruct __nd_opt_route_info *ri = opt_data;\n\n\t/* rfc4191 says:\n\t * If the Reserved (10) value is received, the Route Information Option\n\t * MUST be ignored.\n\t */\n\tif (((ri->nd_opt_ri_prf_reserved >> 3) & 3) == 2)\n\t\treturn false;\n\treturn true;\n}"
  },
  {
    "function_name": "ndp_msgna_flag_override_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1075-1082",
    "snippet": "NDP_EXPORT\nvoid ndp_msgna_flag_override_set(struct ndp_msgna *msgna, bool flag_override)\n{\n\tif (flag_override)\n\t\tmsgna->na->nd_na_flags_reserved |= ND_NA_FLAG_OVERRIDE;\n\telse\n\t\tmsgna->na->nd_na_flags_reserved &= ~ND_NA_FLAG_OVERRIDE;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_msgna_flag_override_set(struct ndp_msgna *msgna, bool flag_override)\n{\n\tif (flag_override)\n\t\tmsgna->na->nd_na_flags_reserved |= ND_NA_FLAG_OVERRIDE;\n\telse\n\t\tmsgna->na->nd_na_flags_reserved &= ~ND_NA_FLAG_OVERRIDE;\n}"
  },
  {
    "function_name": "ndp_msgna_flag_override",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1062-1066",
    "snippet": "NDP_EXPORT\nbool ndp_msgna_flag_override(struct ndp_msgna *msgna)\n{\n\treturn msgna->na->nd_na_flags_reserved & ND_NA_FLAG_OVERRIDE;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nbool ndp_msgna_flag_override(struct ndp_msgna *msgna)\n{\n\treturn msgna->na->nd_na_flags_reserved & ND_NA_FLAG_OVERRIDE;\n}"
  },
  {
    "function_name": "ndp_msgna_flag_solicited_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1045-1052",
    "snippet": "NDP_EXPORT\nvoid ndp_msgna_flag_solicited_set(struct ndp_msgna *msgna, bool flag_solicited)\n{\n\tif (flag_solicited)\n\t\tmsgna->na->nd_na_flags_reserved |= ND_NA_FLAG_SOLICITED;\n\telse\n\t\tmsgna->na->nd_na_flags_reserved &= ~ND_NA_FLAG_SOLICITED;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_msgna_flag_solicited_set(struct ndp_msgna *msgna, bool flag_solicited)\n{\n\tif (flag_solicited)\n\t\tmsgna->na->nd_na_flags_reserved |= ND_NA_FLAG_SOLICITED;\n\telse\n\t\tmsgna->na->nd_na_flags_reserved &= ~ND_NA_FLAG_SOLICITED;\n}"
  },
  {
    "function_name": "ndp_msgna_flag_solicited",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1033-1037",
    "snippet": "NDP_EXPORT\nbool ndp_msgna_flag_solicited(struct ndp_msgna *msgna)\n{\n\treturn msgna->na->nd_na_flags_reserved & ND_NA_FLAG_SOLICITED;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nbool ndp_msgna_flag_solicited(struct ndp_msgna *msgna)\n{\n\treturn msgna->na->nd_na_flags_reserved & ND_NA_FLAG_SOLICITED;\n}"
  },
  {
    "function_name": "ndp_msgna_flag_router_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1016-1023",
    "snippet": "NDP_EXPORT\nvoid ndp_msgna_flag_router_set(struct ndp_msgna *msgna, bool flag_router)\n{\n\tif (flag_router)\n\t\tmsgna->na->nd_na_flags_reserved |= ND_NA_FLAG_ROUTER;\n\telse\n\t\tmsgna->na->nd_na_flags_reserved &= ~ND_NA_FLAG_ROUTER;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_msgna_flag_router_set(struct ndp_msgna *msgna, bool flag_router)\n{\n\tif (flag_router)\n\t\tmsgna->na->nd_na_flags_reserved |= ND_NA_FLAG_ROUTER;\n\telse\n\t\tmsgna->na->nd_na_flags_reserved &= ~ND_NA_FLAG_ROUTER;\n}"
  },
  {
    "function_name": "ndp_msgna_flag_router",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "1004-1008",
    "snippet": "NDP_EXPORT\nbool ndp_msgna_flag_router(struct ndp_msgna *msgna)\n{\n\treturn msgna->na->nd_na_flags_reserved & ND_NA_FLAG_ROUTER;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nbool ndp_msgna_flag_router(struct ndp_msgna *msgna)\n{\n\treturn msgna->na->nd_na_flags_reserved & ND_NA_FLAG_ROUTER;\n}"
  },
  {
    "function_name": "ndp_msgra_retransmit_time_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "983-988",
    "snippet": "NDP_EXPORT\nvoid ndp_msgra_retransmit_time_set(struct ndp_msgra *msgra,\n\t\t\t\t   uint32_t retransmit_time)\n{\n\tmsgra->ra->nd_ra_retransmit = htonl(retransmit_time);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "retransmit_time"
          ],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_msgra_retransmit_time_set(struct ndp_msgra *msgra,\n\t\t\t\t   uint32_t retransmit_time)\n{\n\tmsgra->ra->nd_ra_retransmit = htonl(retransmit_time);\n}"
  },
  {
    "function_name": "ndp_msgra_retransmit_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "971-975",
    "snippet": "NDP_EXPORT\nuint32_t ndp_msgra_retransmit_time(struct ndp_msgra *msgra)\n{\n\treturn ntohl(msgra->ra->nd_ra_retransmit);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "msgra->ra->nd_ra_retransmit"
          ],
          "line": 974
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nuint32_t ndp_msgra_retransmit_time(struct ndp_msgra *msgra)\n{\n\treturn ntohl(msgra->ra->nd_ra_retransmit);\n}"
  },
  {
    "function_name": "ndp_msgra_reachable_time_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "956-961",
    "snippet": "NDP_EXPORT\nvoid ndp_msgra_reachable_time_set(struct ndp_msgra *msgra,\n\t\t\t\t  uint32_t reachable_time)\n{\n\tmsgra->ra->nd_ra_reachable = htonl(reachable_time);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "reachable_time"
          ],
          "line": 960
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_msgra_reachable_time_set(struct ndp_msgra *msgra,\n\t\t\t\t  uint32_t reachable_time)\n{\n\tmsgra->ra->nd_ra_reachable = htonl(reachable_time);\n}"
  },
  {
    "function_name": "ndp_msgra_reachable_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "944-948",
    "snippet": "NDP_EXPORT\nuint32_t ndp_msgra_reachable_time(struct ndp_msgra *msgra)\n{\n\treturn ntohl(msgra->ra->nd_ra_reachable);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ntohl",
          "args": [
            "msgra->ra->nd_ra_reachable"
          ],
          "line": 947
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nuint32_t ndp_msgra_reachable_time(struct ndp_msgra *msgra)\n{\n\treturn ntohl(msgra->ra->nd_ra_reachable);\n}"
  },
  {
    "function_name": "ndp_msgra_router_lifetime_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "929-934",
    "snippet": "NDP_EXPORT\nvoid ndp_msgra_router_lifetime_set(struct ndp_msgra *msgra,\n\t\t\t\t   uint16_t router_lifetime)\n{\n\tmsgra->ra->nd_ra_router_lifetime = htons(router_lifetime);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "htons",
          "args": [
            "router_lifetime"
          ],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_msgra_router_lifetime_set(struct ndp_msgra *msgra,\n\t\t\t\t   uint16_t router_lifetime)\n{\n\tmsgra->ra->nd_ra_router_lifetime = htons(router_lifetime);\n}"
  },
  {
    "function_name": "ndp_msgra_router_lifetime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "917-921",
    "snippet": "NDP_EXPORT\nuint16_t ndp_msgra_router_lifetime(struct ndp_msgra *msgra)\n{\n\treturn ntohs(msgra->ra->nd_ra_router_lifetime);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ntohs",
          "args": [
            "msgra->ra->nd_ra_router_lifetime"
          ],
          "line": 920
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nuint16_t ndp_msgra_router_lifetime(struct ndp_msgra *msgra)\n{\n\treturn ntohs(msgra->ra->nd_ra_router_lifetime);\n}"
  },
  {
    "function_name": "ndp_msgra_route_preference_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "901-907",
    "snippet": "NDP_EXPORT\nvoid ndp_msgra_route_preference_set(struct ndp_msgra *msgra,\n\t\t\t\t    enum ndp_route_preference pref)\n{\n\tmsgra->ra->nd_ra_flags_reserved &= ~(3 << 3);\n\tmsgra->ra->nd_ra_flags_reserved |= (pref << 3);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_msgra_route_preference_set(struct ndp_msgra *msgra,\n\t\t\t\t    enum ndp_route_preference pref)\n{\n\tmsgra->ra->nd_ra_flags_reserved &= ~(3 << 3);\n\tmsgra->ra->nd_ra_flags_reserved |= (pref << 3);\n}"
  },
  {
    "function_name": "ndp_msgra_route_preference",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "879-892",
    "snippet": "ndp_route_preference ndp_msgra_route_preference(struct ndp_msgra *msgra)\n{\n\tuint8_t prf = (msgra->ra->nd_ra_flags_reserved >> 3) & 3;\n\n\t/* rfc4191 says:\n\t * If the Router Lifetime is zero, the preference value MUST be set to\n\t * (00) by the sender and MUST be ignored by the receiver.\n\t * If the Reserved (10) value is received, the receiver MUST treat the\n\t * value as if it were (00).\n\t */\n\tif (prf == 2 || !ndp_msgra_router_lifetime(msgra))\n\t\tprf = 0;\n\treturn prf;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msgra_router_lifetime",
          "args": [
            "msgra"
          ],
          "line": 889
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msgra_router_lifetime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "917-921",
          "snippet": "NDP_EXPORT\nuint16_t ndp_msgra_router_lifetime(struct ndp_msgra *msgra)\n{\n\treturn ntohs(msgra->ra->nd_ra_router_lifetime);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nuint16_t ndp_msgra_router_lifetime(struct ndp_msgra *msgra)\n{\n\treturn ntohs(msgra->ra->nd_ra_router_lifetime);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nndp_route_preference ndp_msgra_route_preference(struct ndp_msgra *msgra)\n{\n\tuint8_t prf = (msgra->ra->nd_ra_flags_reserved >> 3) & 3;\n\n\t/* rfc4191 says:\n\t * If the Router Lifetime is zero, the preference value MUST be set to\n\t * (00) by the sender and MUST be ignored by the receiver.\n\t * If the Reserved (10) value is received, the receiver MUST treat the\n\t * value as if it were (00).\n\t */\n\tif (prf == 2 || !ndp_msgra_router_lifetime(msgra))\n\t\tprf = 0;\n\treturn prf;\n}"
  },
  {
    "function_name": "ndp_msgra_flag_home_agent_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "860-868",
    "snippet": "NDP_EXPORT\nvoid ndp_msgra_flag_home_agent_set(struct ndp_msgra *msgra,\n\t\t\t\t   bool flag_home_agent)\n{\n\tif (flag_home_agent)\n\t\tmsgra->ra->nd_ra_flags_reserved |= ND_RA_FLAG_HOME_AGENT;\n\telse\n\t\tmsgra->ra->nd_ra_flags_reserved &= ~ND_RA_FLAG_HOME_AGENT;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_msgra_flag_home_agent_set(struct ndp_msgra *msgra,\n\t\t\t\t   bool flag_home_agent)\n{\n\tif (flag_home_agent)\n\t\tmsgra->ra->nd_ra_flags_reserved |= ND_RA_FLAG_HOME_AGENT;\n\telse\n\t\tmsgra->ra->nd_ra_flags_reserved &= ~ND_RA_FLAG_HOME_AGENT;\n}"
  },
  {
    "function_name": "ndp_msgra_flag_home_agent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "848-852",
    "snippet": "NDP_EXPORT\nbool ndp_msgra_flag_home_agent(struct ndp_msgra *msgra)\n{\n\treturn msgra->ra->nd_ra_flags_reserved & ND_RA_FLAG_HOME_AGENT;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nbool ndp_msgra_flag_home_agent(struct ndp_msgra *msgra)\n{\n\treturn msgra->ra->nd_ra_flags_reserved & ND_RA_FLAG_HOME_AGENT;\n}"
  },
  {
    "function_name": "ndp_msgra_flag_other_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "831-838",
    "snippet": "NDP_EXPORT\nvoid ndp_msgra_flag_other_set(struct ndp_msgra *msgra, bool flag_other)\n{\n\tif (flag_other)\n\t\tmsgra->ra->nd_ra_flags_reserved |= ND_RA_FLAG_OTHER;\n\telse\n\t\tmsgra->ra->nd_ra_flags_reserved &= ~ND_RA_FLAG_OTHER;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_msgra_flag_other_set(struct ndp_msgra *msgra, bool flag_other)\n{\n\tif (flag_other)\n\t\tmsgra->ra->nd_ra_flags_reserved |= ND_RA_FLAG_OTHER;\n\telse\n\t\tmsgra->ra->nd_ra_flags_reserved &= ~ND_RA_FLAG_OTHER;\n}"
  },
  {
    "function_name": "ndp_msgra_flag_other",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "819-823",
    "snippet": "NDP_EXPORT\nbool ndp_msgra_flag_other(struct ndp_msgra *msgra)\n{\n\treturn msgra->ra->nd_ra_flags_reserved & ND_RA_FLAG_OTHER;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nbool ndp_msgra_flag_other(struct ndp_msgra *msgra)\n{\n\treturn msgra->ra->nd_ra_flags_reserved & ND_RA_FLAG_OTHER;\n}"
  },
  {
    "function_name": "ndp_msgra_flag_managed_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "802-809",
    "snippet": "NDP_EXPORT\nvoid ndp_msgra_flag_managed_set(struct ndp_msgra *msgra, bool flag_managed)\n{\n\tif (flag_managed)\n\t\tmsgra->ra->nd_ra_flags_reserved |= ND_RA_FLAG_MANAGED;\n\telse\n\t\tmsgra->ra->nd_ra_flags_reserved &= ~ND_RA_FLAG_MANAGED;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_msgra_flag_managed_set(struct ndp_msgra *msgra, bool flag_managed)\n{\n\tif (flag_managed)\n\t\tmsgra->ra->nd_ra_flags_reserved |= ND_RA_FLAG_MANAGED;\n\telse\n\t\tmsgra->ra->nd_ra_flags_reserved &= ~ND_RA_FLAG_MANAGED;\n}"
  },
  {
    "function_name": "ndp_msgra_flag_managed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "790-794",
    "snippet": "NDP_EXPORT\nbool ndp_msgra_flag_managed(struct ndp_msgra *msgra)\n{\n\treturn msgra->ra->nd_ra_flags_reserved & ND_RA_FLAG_MANAGED;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nbool ndp_msgra_flag_managed(struct ndp_msgra *msgra)\n{\n\treturn msgra->ra->nd_ra_flags_reserved & ND_RA_FLAG_MANAGED;\n}"
  },
  {
    "function_name": "ndp_msgra_curhoplimit_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "776-780",
    "snippet": "NDP_EXPORT\nvoid ndp_msgra_curhoplimit_set(struct ndp_msgra *msgra, uint8_t curhoplimit)\n{\n\tmsgra->ra->nd_ra_curhoplimit = curhoplimit;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_msgra_curhoplimit_set(struct ndp_msgra *msgra, uint8_t curhoplimit)\n{\n\tmsgra->ra->nd_ra_curhoplimit = curhoplimit;\n}"
  },
  {
    "function_name": "ndp_msgra_curhoplimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "764-768",
    "snippet": "NDP_EXPORT\nuint8_t ndp_msgra_curhoplimit(struct ndp_msgra *msgra)\n{\n\treturn msgra->ra->nd_ra_curhoplimit;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nuint8_t ndp_msgra_curhoplimit(struct ndp_msgra *msgra)\n{\n\treturn msgra->ra->nd_ra_curhoplimit;\n}"
  },
  {
    "function_name": "ndp_msg_send_with_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "724-748",
    "snippet": "NDP_EXPORT\nint ndp_msg_send_with_flags(struct ndp *ndp, struct ndp_msg *msg, uint8_t flags)\n{\n\tenum ndp_msg_type msg_type = ndp_msg_type(msg);\n\n\tif (ndp_msg_type_info(msg_type)->addrto_adjust)\n\t\tndp_msg_type_info(msg_type)->addrto_adjust(&msg->addrto);\n\n\tswitch (msg_type) {\n\t\tcase NDP_MSG_NA:\n\t\t\tif (flags & ND_OPT_NA_UNSOL) {\n\t\t\t\tndp_msgna_flag_override_set((struct ndp_msgna*)&msg->nd_msg, true);\n\t\t\t\tndp_msgna_flag_solicited_set((struct ndp_msgna*)&msg->nd_msg, false);\n\t\t\t\tndp_msg_addrto_adjust_all_nodes(&msg->addrto);\n\t\t\t} else {\n\t\t\t\tndp_msgna_flag_solicited_set((struct ndp_msgna*)&msg->nd_msg, true);\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\treturn mysendto6(ndp->sock, msg->buf, msg->len, 0,\n\t\t\t &msg->addrto, msg->ifindex);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mysendto6",
          "args": [
            "ndp->sock",
            "msg->buf",
            "msg->len",
            "0",
            "&msg->addrto",
            "msg->ifindex"
          ],
          "line": 746
        },
        "resolved": true,
        "details": {
          "function_name": "mysendto6",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "185-205",
          "snippet": "static int mysendto6(int sockfd, void *buf, size_t buflen, int flags,\n\t\t     struct in6_addr *addr, uint32_t ifindex)\n{\n\tstruct sockaddr_in6 sin6;\n\tssize_t ret;\n\n\tmemset(&sin6, 0, sizeof(sin6));\n\tmemcpy(&sin6.sin6_addr, addr, sizeof(sin6.sin6_addr));\n\tsin6.sin6_scope_id = ifindex;\nresend:\n\tret = sendto(sockfd, buf, buflen, flags, &sin6, sizeof(sin6));\n\tif (ret == -1) {\n\t\tswitch(errno) {\n\t\tcase EINTR:\n\t\t\tgoto resend;\n\t\tdefault:\n\t\t\treturn -errno;\n\t\t}\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nstatic int mysendto6(int sockfd, void *buf, size_t buflen, int flags,\n\t\t     struct in6_addr *addr, uint32_t ifindex)\n{\n\tstruct sockaddr_in6 sin6;\n\tssize_t ret;\n\n\tmemset(&sin6, 0, sizeof(sin6));\n\tmemcpy(&sin6.sin6_addr, addr, sizeof(sin6.sin6_addr));\n\tsin6.sin6_scope_id = ifindex;\nresend:\n\tret = sendto(sockfd, buf, buflen, flags, &sin6, sizeof(sin6));\n\tif (ret == -1) {\n\t\tswitch(errno) {\n\t\tcase EINTR:\n\t\t\tgoto resend;\n\t\tdefault:\n\t\t\treturn -errno;\n\t\t}\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msgna_flag_solicited_set",
          "args": [
            "(struct ndp_msgna*)&msg->nd_msg",
            "true"
          ],
          "line": 739
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msgna_flag_solicited_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1045-1052",
          "snippet": "NDP_EXPORT\nvoid ndp_msgna_flag_solicited_set(struct ndp_msgna *msgna, bool flag_solicited)\n{\n\tif (flag_solicited)\n\t\tmsgna->na->nd_na_flags_reserved |= ND_NA_FLAG_SOLICITED;\n\telse\n\t\tmsgna->na->nd_na_flags_reserved &= ~ND_NA_FLAG_SOLICITED;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_msgna_flag_solicited_set(struct ndp_msgna *msgna, bool flag_solicited)\n{\n\tif (flag_solicited)\n\t\tmsgna->na->nd_na_flags_reserved |= ND_NA_FLAG_SOLICITED;\n\telse\n\t\tmsgna->na->nd_na_flags_reserved &= ~ND_NA_FLAG_SOLICITED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_addrto_adjust_all_nodes",
          "args": [
            "&msg->addrto"
          ],
          "line": 737
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_addrto_adjust_all_nodes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "315-325",
          "snippet": "static void ndp_msg_addrto_adjust_all_nodes(struct in6_addr *addr)\n{\n\tstruct in6_addr any = IN6ADDR_ANY_INIT;\n\n\tif (memcmp(addr, &any, sizeof(any)))\n\t\treturn;\n\taddr->s6_addr32[0] = htonl(0xFF020000);\n\taddr->s6_addr32[1] = 0;\n\taddr->s6_addr32[2] = 0;\n\taddr->s6_addr32[3] = htonl(0x1);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nstatic void ndp_msg_addrto_adjust_all_nodes(struct in6_addr *addr)\n{\n\tstruct in6_addr any = IN6ADDR_ANY_INIT;\n\n\tif (memcmp(addr, &any, sizeof(any)))\n\t\treturn;\n\taddr->s6_addr32[0] = htonl(0xFF020000);\n\taddr->s6_addr32[1] = 0;\n\taddr->s6_addr32[2] = 0;\n\taddr->s6_addr32[3] = htonl(0x1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msgna_flag_override_set",
          "args": [
            "(struct ndp_msgna*)&msg->nd_msg",
            "true"
          ],
          "line": 735
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msgna_flag_override_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1075-1082",
          "snippet": "NDP_EXPORT\nvoid ndp_msgna_flag_override_set(struct ndp_msgna *msgna, bool flag_override)\n{\n\tif (flag_override)\n\t\tmsgna->na->nd_na_flags_reserved |= ND_NA_FLAG_OVERRIDE;\n\telse\n\t\tmsgna->na->nd_na_flags_reserved &= ~ND_NA_FLAG_OVERRIDE;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_msgna_flag_override_set(struct ndp_msgna *msgna, bool flag_override)\n{\n\tif (flag_override)\n\t\tmsgna->na->nd_na_flags_reserved |= ND_NA_FLAG_OVERRIDE;\n\telse\n\t\tmsgna->na->nd_na_flags_reserved &= ~ND_NA_FLAG_OVERRIDE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_type_info",
          "args": [
            "&msg->addrto"
          ],
          "line": 730
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_type_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "372-375",
          "snippet": "struct ndp_msg_type_info *ndp_msg_type_info(enum ndp_msg_type msg_type)\n{\n\treturn &ndp_msg_type_info_list[msg_type];\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct ndp_msg_type_info ndp_msg_type_info_list[] =\n{\n\t[NDP_MSG_RS] = {\n\t\t.strabbr = \"RS\",\n\t\t.raw_type = ND_ROUTER_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_router_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_routers,\n\t},\n\t[NDP_MSG_RA] = {\n\t\t.strabbr = \"RA\",\n\t\t.raw_type = ND_ROUTER_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_router_advert),\n\t},\n\t[NDP_MSG_NS] = {\n\t\t.strabbr = \"NS\",\n\t\t.raw_type = ND_NEIGHBOR_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_nodes,\n\t},\n\t[NDP_MSG_NA] = {\n\t\t.strabbr = \"NA\",\n\t\t.raw_type = ND_NEIGHBOR_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_advert),\n\t},\n\t[NDP_MSG_R] = {\n\t\t.strabbr = \"R\",\n\t\t.raw_type = ND_REDIRECT,\n\t\t.raw_struct_size = sizeof(struct nd_redirect),\n\t},\n};",
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct ndp_msg_type_info ndp_msg_type_info_list[] =\n{\n\t[NDP_MSG_RS] = {\n\t\t.strabbr = \"RS\",\n\t\t.raw_type = ND_ROUTER_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_router_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_routers,\n\t},\n\t[NDP_MSG_RA] = {\n\t\t.strabbr = \"RA\",\n\t\t.raw_type = ND_ROUTER_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_router_advert),\n\t},\n\t[NDP_MSG_NS] = {\n\t\t.strabbr = \"NS\",\n\t\t.raw_type = ND_NEIGHBOR_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_nodes,\n\t},\n\t[NDP_MSG_NA] = {\n\t\t.strabbr = \"NA\",\n\t\t.raw_type = ND_NEIGHBOR_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_advert),\n\t},\n\t[NDP_MSG_R] = {\n\t\t.strabbr = \"R\",\n\t\t.raw_type = ND_REDIRECT,\n\t\t.raw_struct_size = sizeof(struct nd_redirect),\n\t},\n};\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\n\nstruct ndp_msg_type_info *ndp_msg_type_info(enum ndp_msg_type msg_type)\n{\n\treturn &ndp_msg_type_info_list[msg_type];\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_type",
          "args": [
            "msg"
          ],
          "line": 727
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "643-652",
          "snippet": "ndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nint ndp_msg_send_with_flags(struct ndp *ndp, struct ndp_msg *msg, uint8_t flags)\n{\n\tenum ndp_msg_type msg_type = ndp_msg_type(msg);\n\n\tif (ndp_msg_type_info(msg_type)->addrto_adjust)\n\t\tndp_msg_type_info(msg_type)->addrto_adjust(&msg->addrto);\n\n\tswitch (msg_type) {\n\t\tcase NDP_MSG_NA:\n\t\t\tif (flags & ND_OPT_NA_UNSOL) {\n\t\t\t\tndp_msgna_flag_override_set((struct ndp_msgna*)&msg->nd_msg, true);\n\t\t\t\tndp_msgna_flag_solicited_set((struct ndp_msgna*)&msg->nd_msg, false);\n\t\t\t\tndp_msg_addrto_adjust_all_nodes(&msg->addrto);\n\t\t\t} else {\n\t\t\t\tndp_msgna_flag_solicited_set((struct ndp_msgna*)&msg->nd_msg, true);\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\treturn mysendto6(ndp->sock, msg->buf, msg->len, 0,\n\t\t\t &msg->addrto, msg->ifindex);\n}"
  },
  {
    "function_name": "ndp_msg_send",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "708-712",
    "snippet": "NDP_EXPORT\nint ndp_msg_send(struct ndp *ndp, struct ndp_msg *msg)\n{\n\treturn ndp_msg_send_with_flags(ndp, msg, ND_OPT_NORMAL);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_send_with_flags",
          "args": [
            "ndp",
            "msg",
            "ND_OPT_NORMAL"
          ],
          "line": 711
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_send_with_flags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "724-748",
          "snippet": "NDP_EXPORT\nint ndp_msg_send_with_flags(struct ndp *ndp, struct ndp_msg *msg, uint8_t flags)\n{\n\tenum ndp_msg_type msg_type = ndp_msg_type(msg);\n\n\tif (ndp_msg_type_info(msg_type)->addrto_adjust)\n\t\tndp_msg_type_info(msg_type)->addrto_adjust(&msg->addrto);\n\n\tswitch (msg_type) {\n\t\tcase NDP_MSG_NA:\n\t\t\tif (flags & ND_OPT_NA_UNSOL) {\n\t\t\t\tndp_msgna_flag_override_set((struct ndp_msgna*)&msg->nd_msg, true);\n\t\t\t\tndp_msgna_flag_solicited_set((struct ndp_msgna*)&msg->nd_msg, false);\n\t\t\t\tndp_msg_addrto_adjust_all_nodes(&msg->addrto);\n\t\t\t} else {\n\t\t\t\tndp_msgna_flag_solicited_set((struct ndp_msgna*)&msg->nd_msg, true);\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\treturn mysendto6(ndp->sock, msg->buf, msg->len, 0,\n\t\t\t &msg->addrto, msg->ifindex);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nint ndp_msg_send_with_flags(struct ndp *ndp, struct ndp_msg *msg, uint8_t flags)\n{\n\tenum ndp_msg_type msg_type = ndp_msg_type(msg);\n\n\tif (ndp_msg_type_info(msg_type)->addrto_adjust)\n\t\tndp_msg_type_info(msg_type)->addrto_adjust(&msg->addrto);\n\n\tswitch (msg_type) {\n\t\tcase NDP_MSG_NA:\n\t\t\tif (flags & ND_OPT_NA_UNSOL) {\n\t\t\t\tndp_msgna_flag_override_set((struct ndp_msgna*)&msg->nd_msg, true);\n\t\t\t\tndp_msgna_flag_solicited_set((struct ndp_msgna*)&msg->nd_msg, false);\n\t\t\t\tndp_msg_addrto_adjust_all_nodes(&msg->addrto);\n\t\t\t} else {\n\t\t\t\tndp_msgna_flag_solicited_set((struct ndp_msgna*)&msg->nd_msg, true);\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\treturn mysendto6(ndp->sock, msg->buf, msg->len, 0,\n\t\t\t &msg->addrto, msg->ifindex);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nint ndp_msg_send(struct ndp *ndp, struct ndp_msg *msg)\n{\n\treturn ndp_msg_send_with_flags(ndp, msg, ND_OPT_NORMAL);\n}"
  },
  {
    "function_name": "ndp_msg_ifindex_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "693-697",
    "snippet": "NDP_EXPORT\nvoid ndp_msg_ifindex_set(struct ndp_msg *msg, uint32_t ifindex)\n{\n\tmsg->ifindex = ifindex;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nvoid ndp_msg_ifindex_set(struct ndp_msg *msg, uint32_t ifindex)\n{\n\tmsg->ifindex = ifindex;\n}"
  },
  {
    "function_name": "ndp_msg_ifindex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "681-685",
    "snippet": "NDP_EXPORT\nuint32_t ndp_msg_ifindex(struct ndp_msg *msg)\n{\n\treturn msg->ifindex;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint32_t ndp_msg_ifindex(struct ndp_msg *msg)\n{\n\treturn msg->ifindex;\n}"
  },
  {
    "function_name": "ndp_msg_addrto",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "668-671",
    "snippet": "in6_addr *ndp_msg_addrto(struct ndp_msg *msg)\n{\n\treturn &msg->addrto;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nin6_addr *ndp_msg_addrto(struct ndp_msg *msg)\n{\n\treturn &msg->addrto;\n}"
  },
  {
    "function_name": "ndp_msg_type_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "654-657",
    "snippet": "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type)\n{\n\tmsg->icmp6_hdr->icmp6_type = ndp_msg_type_info(msg_type)->raw_type;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_type_info",
          "args": [
            "msg_type"
          ],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_type_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "372-375",
          "snippet": "struct ndp_msg_type_info *ndp_msg_type_info(enum ndp_msg_type msg_type)\n{\n\treturn &ndp_msg_type_info_list[msg_type];\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct ndp_msg_type_info ndp_msg_type_info_list[] =\n{\n\t[NDP_MSG_RS] = {\n\t\t.strabbr = \"RS\",\n\t\t.raw_type = ND_ROUTER_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_router_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_routers,\n\t},\n\t[NDP_MSG_RA] = {\n\t\t.strabbr = \"RA\",\n\t\t.raw_type = ND_ROUTER_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_router_advert),\n\t},\n\t[NDP_MSG_NS] = {\n\t\t.strabbr = \"NS\",\n\t\t.raw_type = ND_NEIGHBOR_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_nodes,\n\t},\n\t[NDP_MSG_NA] = {\n\t\t.strabbr = \"NA\",\n\t\t.raw_type = ND_NEIGHBOR_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_advert),\n\t},\n\t[NDP_MSG_R] = {\n\t\t.strabbr = \"R\",\n\t\t.raw_type = ND_REDIRECT,\n\t\t.raw_struct_size = sizeof(struct nd_redirect),\n\t},\n};",
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct ndp_msg_type_info ndp_msg_type_info_list[] =\n{\n\t[NDP_MSG_RS] = {\n\t\t.strabbr = \"RS\",\n\t\t.raw_type = ND_ROUTER_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_router_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_routers,\n\t},\n\t[NDP_MSG_RA] = {\n\t\t.strabbr = \"RA\",\n\t\t.raw_type = ND_ROUTER_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_router_advert),\n\t},\n\t[NDP_MSG_NS] = {\n\t\t.strabbr = \"NS\",\n\t\t.raw_type = ND_NEIGHBOR_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_nodes,\n\t},\n\t[NDP_MSG_NA] = {\n\t\t.strabbr = \"NA\",\n\t\t.raw_type = ND_NEIGHBOR_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_advert),\n\t},\n\t[NDP_MSG_R] = {\n\t\t.strabbr = \"R\",\n\t\t.raw_type = ND_REDIRECT,\n\t\t.raw_struct_size = sizeof(struct nd_redirect),\n\t},\n};\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\n\nstruct ndp_msg_type_info *ndp_msg_type_info(enum ndp_msg_type msg_type)\n{\n\treturn &ndp_msg_type_info_list[msg_type];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type)\n{\n\tmsg->icmp6_hdr->icmp6_type = ndp_msg_type_info(msg_type)->raw_type;\n}"
  },
  {
    "function_name": "ndp_msg_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "643-652",
    "snippet": "ndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "err"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp_msg_type_by_raw_type",
          "args": [
            "&msg_type",
            "msg->icmp6_hdr->icmp6_type"
          ],
          "line": 648
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_type_by_raw_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "377-389",
          "snippet": "static int ndp_msg_type_by_raw_type(enum ndp_msg_type *p_msg_type,\n\t\t\t\t    uint8_t raw_type)\n{\n\tint i;\n\n\tfor (i = 0; i < NDP_MSG_TYPE_LIST_SIZE; i++) {\n\t\tif (ndp_msg_type_info(i)->raw_type == raw_type) {\n\t\t\t*p_msg_type = i;\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn -ENOENT;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [
            "#define NDP_MSG_TYPE_LIST_SIZE ARRAY_SIZE(ndp_msg_type_info_list)"
          ],
          "globals_used": [
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nenum"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define NDP_MSG_TYPE_LIST_SIZE ARRAY_SIZE(ndp_msg_type_info_list)\n\nNDP_EXPORT\nenum;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nenum;\n\nstatic int ndp_msg_type_by_raw_type(enum ndp_msg_type *p_msg_type,\n\t\t\t\t    uint8_t raw_type)\n{\n\tint i;\n\n\tfor (i = 0; i < NDP_MSG_TYPE_LIST_SIZE; i++) {\n\t\tif (ndp_msg_type_info(i)->raw_type == raw_type) {\n\t\t\t*p_msg_type = i;\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn -ENOENT;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}"
  },
  {
    "function_name": "ndp_msgr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "627-632",
    "snippet": "ndp_msgr *ndp_msgr(struct ndp_msg *msg)\n{\n\tif (ndp_msg_type(msg) != NDP_MSG_R)\n\t\treturn NULL;\n\treturn &msg->nd_msg.r;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_type",
          "args": [
            "msg"
          ],
          "line": 629
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "643-652",
          "snippet": "ndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nndp_msgr *ndp_msgr(struct ndp_msg *msg)\n{\n\tif (ndp_msg_type(msg) != NDP_MSG_R)\n\t\treturn NULL;\n\treturn &msg->nd_msg.r;\n}"
  },
  {
    "function_name": "ndp_msgna",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "611-616",
    "snippet": "ndp_msgna *ndp_msgna(struct ndp_msg *msg)\n{\n\tif (ndp_msg_type(msg) != NDP_MSG_NA)\n\t\treturn NULL;\n\treturn &msg->nd_msg.na;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_type",
          "args": [
            "msg"
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "643-652",
          "snippet": "ndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nndp_msgna *ndp_msgna(struct ndp_msg *msg)\n{\n\tif (ndp_msg_type(msg) != NDP_MSG_NA)\n\t\treturn NULL;\n\treturn &msg->nd_msg.na;\n}"
  },
  {
    "function_name": "ndp_msgns",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "595-600",
    "snippet": "ndp_msgns *ndp_msgns(struct ndp_msg *msg)\n{\n\tif (ndp_msg_type(msg) != NDP_MSG_NS)\n\t\treturn NULL;\n\treturn &msg->nd_msg.ns;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_type",
          "args": [
            "msg"
          ],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "643-652",
          "snippet": "ndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nndp_msgns *ndp_msgns(struct ndp_msg *msg)\n{\n\tif (ndp_msg_type(msg) != NDP_MSG_NS)\n\t\treturn NULL;\n\treturn &msg->nd_msg.ns;\n}"
  },
  {
    "function_name": "ndp_msgra",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "579-584",
    "snippet": "ndp_msgra *ndp_msgra(struct ndp_msg *msg)\n{\n\tif (ndp_msg_type(msg) != NDP_MSG_RA)\n\t\treturn NULL;\n\treturn &msg->nd_msg.ra;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_type",
          "args": [
            "msg"
          ],
          "line": 581
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "643-652",
          "snippet": "ndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nndp_msgra *ndp_msgra(struct ndp_msg *msg)\n{\n\tif (ndp_msg_type(msg) != NDP_MSG_RA)\n\t\treturn NULL;\n\treturn &msg->nd_msg.ra;\n}"
  },
  {
    "function_name": "ndp_msgrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "563-568",
    "snippet": "ndp_msgrs *ndp_msgrs(struct ndp_msg *msg)\n{\n\tif (ndp_msg_type(msg) != NDP_MSG_RS)\n\t\treturn NULL;\n\treturn &msg->nd_msg.rs;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_type",
          "args": [
            "msg"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "643-652",
          "snippet": "ndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nndp_msgrs *ndp_msgrs(struct ndp_msg *msg)\n{\n\tif (ndp_msg_type(msg) != NDP_MSG_RS)\n\t\treturn NULL;\n\treturn &msg->nd_msg.rs;\n}"
  },
  {
    "function_name": "ndp_msg_payload_opts_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "548-552",
    "snippet": "NDP_EXPORT\nsize_t ndp_msg_payload_opts_len(struct ndp_msg *msg)\n{\n\treturn msg->len - (msg->opts_start - msg->buf);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nsize_t ndp_msg_payload_opts_len(struct ndp_msg *msg)\n{\n\treturn msg->len - (msg->opts_start - msg->buf);\n}"
  },
  {
    "function_name": "ndp_msg_payload_opts_offset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "533-538",
    "snippet": "static void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_payload_opts",
          "args": [
            "msg"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "548-552",
          "snippet": "NDP_EXPORT\nsize_t ndp_msg_payload_opts_len(struct ndp_msg *msg)\n{\n\treturn msg->len - (msg->opts_start - msg->buf);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nsize_t ndp_msg_payload_opts_len(struct ndp_msg *msg)\n{\n\treturn msg->len - (msg->opts_start - msg->buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void *ndp_msg_payload_opts_offset(struct ndp_msg *msg, int offset)\n{\n\tunsigned char *ptr = ndp_msg_payload_opts(msg);\n\n\treturn ptr + offset;\n}"
  },
  {
    "function_name": "ndp_msg_payload_opts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "527-531",
    "snippet": "NDP_EXPORT\nvoid *ndp_msg_payload_opts(struct ndp_msg *msg)\n{\n\treturn msg->opts_start;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nvoid *ndp_msg_payload_opts(struct ndp_msg *msg)\n{\n\treturn msg->opts_start;\n}"
  },
  {
    "function_name": "ndp_msg_payload_len_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "511-517",
    "snippet": "NDP_EXPORT\nvoid ndp_msg_payload_len_set(struct ndp_msg *msg, size_t len)\n{\n\tif (len > sizeof(msg->buf))\n\t\tlen = sizeof(msg->buf);\n\tmsg->len = len;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nvoid ndp_msg_payload_len_set(struct ndp_msg *msg, size_t len)\n{\n\tif (len > sizeof(msg->buf))\n\t\tlen = sizeof(msg->buf);\n\tmsg->len = len;\n}"
  },
  {
    "function_name": "ndp_msg_payload_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "499-503",
    "snippet": "NDP_EXPORT\nsize_t ndp_msg_payload_len(struct ndp_msg *msg)\n{\n\treturn msg->len;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nsize_t ndp_msg_payload_len(struct ndp_msg *msg)\n{\n\treturn msg->len;\n}"
  },
  {
    "function_name": "ndp_msg_payload_maxlen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "485-489",
    "snippet": "NDP_EXPORT\nsize_t ndp_msg_payload_maxlen(struct ndp_msg *msg)\n{\n\treturn sizeof(msg->buf);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nsize_t ndp_msg_payload_maxlen(struct ndp_msg *msg)\n{\n\treturn sizeof(msg->buf);\n}"
  },
  {
    "function_name": "ndp_msg_payload",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "471-475",
    "snippet": "NDP_EXPORT\nvoid *ndp_msg_payload(struct ndp_msg *msg)\n{\n\treturn msg->buf;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nvoid *ndp_msg_payload(struct ndp_msg *msg)\n{\n\treturn msg->buf;\n}"
  },
  {
    "function_name": "ndp_msg_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "457-461",
    "snippet": "NDP_EXPORT\nvoid ndp_msg_destroy(struct ndp_msg *msg)\n{\n\tfree(msg);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "msg"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nvoid ndp_msg_destroy(struct ndp_msg *msg)\n{\n\tfree(msg);\n}"
  },
  {
    "function_name": "ndp_msg_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "437-450",
    "snippet": "NDP_EXPORT\nint ndp_msg_new(struct ndp_msg **p_msg, enum ndp_msg_type msg_type)\n{\n\tstruct ndp_msg *msg;\n\n\tif (msg_type == NDP_MSG_ALL)\n\t\treturn -EINVAL;\n\tmsg = ndp_msg_alloc();\n\tif (!msg)\n\t\treturn -ENOMEM;\n\tndp_msg_init(msg, msg_type);\n\t*p_msg = msg;\n\treturn 0;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_init",
          "args": [
            "msg",
            "msg_type"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "414-426",
          "snippet": "static void ndp_msg_init(struct ndp_msg *msg, enum ndp_msg_type msg_type)\n{\n\tsize_t raw_struct_size = ndp_msg_type_info(msg_type)->raw_struct_size;\n\n\tndp_msg_type_set(msg, msg_type);\n\tmsg->len = raw_struct_size;\n\tmsg->opts_start = msg->buf + raw_struct_size;\n\n\t/* Set-up \"first pointers\" in all ndp_msgrs, ndp_msgra, ndp_msgns,\n\t * ndp_msgna, ndp_msgr structures.\n\t */\n\tmsg->nd_msg.generic.dataptr = ndp_msg_payload(msg);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void ndp_msg_init(struct ndp_msg *msg, enum ndp_msg_type msg_type)\n{\n\tsize_t raw_struct_size = ndp_msg_type_info(msg_type)->raw_struct_size;\n\n\tndp_msg_type_set(msg, msg_type);\n\tmsg->len = raw_struct_size;\n\tmsg->opts_start = msg->buf + raw_struct_size;\n\n\t/* Set-up \"first pointers\" in all ndp_msgrs, ndp_msgra, ndp_msgns,\n\t * ndp_msgna, ndp_msgr structures.\n\t */\n\tmsg->nd_msg.generic.dataptr = ndp_msg_payload(msg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_alloc",
          "args": [],
          "line": 444
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "401-410",
          "snippet": "static struct ndp_msg *ndp_msg_alloc(void)\n{\n\tstruct ndp_msg *msg;\n\n\tmsg = myzalloc(sizeof(*msg));\n\tif (!msg)\n\t\treturn NULL;\n\tmsg->icmp6_hdr = (struct icmp6_hdr *) msg->buf;\n\treturn msg;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic struct ndp_msg *ndp_msg_alloc(void)\n{\n\tstruct ndp_msg *msg;\n\n\tmsg = myzalloc(sizeof(*msg));\n\tif (!msg)\n\t\treturn NULL;\n\tmsg->icmp6_hdr = (struct icmp6_hdr *) msg->buf;\n\treturn msg;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nint ndp_msg_new(struct ndp_msg **p_msg, enum ndp_msg_type msg_type)\n{\n\tstruct ndp_msg *msg;\n\n\tif (msg_type == NDP_MSG_ALL)\n\t\treturn -EINVAL;\n\tmsg = ndp_msg_alloc();\n\tif (!msg)\n\t\treturn -ENOMEM;\n\tndp_msg_init(msg, msg_type);\n\t*p_msg = msg;\n\treturn 0;\n}"
  },
  {
    "function_name": "ndp_msg_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "414-426",
    "snippet": "static void ndp_msg_init(struct ndp_msg *msg, enum ndp_msg_type msg_type)\n{\n\tsize_t raw_struct_size = ndp_msg_type_info(msg_type)->raw_struct_size;\n\n\tndp_msg_type_set(msg, msg_type);\n\tmsg->len = raw_struct_size;\n\tmsg->opts_start = msg->buf + raw_struct_size;\n\n\t/* Set-up \"first pointers\" in all ndp_msgrs, ndp_msgra, ndp_msgns,\n\t * ndp_msgna, ndp_msgr structures.\n\t */\n\tmsg->nd_msg.generic.dataptr = ndp_msg_payload(msg);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_payload",
          "args": [
            "msg"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_opts_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "548-552",
          "snippet": "NDP_EXPORT\nsize_t ndp_msg_payload_opts_len(struct ndp_msg *msg)\n{\n\treturn msg->len - (msg->opts_start - msg->buf);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nsize_t ndp_msg_payload_opts_len(struct ndp_msg *msg)\n{\n\treturn msg->len - (msg->opts_start - msg->buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_type_set",
          "args": [
            "msg",
            "msg_type"
          ],
          "line": 418
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_type_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "654-657",
          "snippet": "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type)\n{\n\tmsg->icmp6_hdr->icmp6_type = ndp_msg_type_info(msg_type)->raw_type;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type)\n{\n\tmsg->icmp6_hdr->icmp6_type = ndp_msg_type_info(msg_type)->raw_type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_type_info",
          "args": [
            "msg_type"
          ],
          "line": 416
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_type_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "372-375",
          "snippet": "struct ndp_msg_type_info *ndp_msg_type_info(enum ndp_msg_type msg_type)\n{\n\treturn &ndp_msg_type_info_list[msg_type];\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct ndp_msg_type_info ndp_msg_type_info_list[] =\n{\n\t[NDP_MSG_RS] = {\n\t\t.strabbr = \"RS\",\n\t\t.raw_type = ND_ROUTER_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_router_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_routers,\n\t},\n\t[NDP_MSG_RA] = {\n\t\t.strabbr = \"RA\",\n\t\t.raw_type = ND_ROUTER_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_router_advert),\n\t},\n\t[NDP_MSG_NS] = {\n\t\t.strabbr = \"NS\",\n\t\t.raw_type = ND_NEIGHBOR_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_nodes,\n\t},\n\t[NDP_MSG_NA] = {\n\t\t.strabbr = \"NA\",\n\t\t.raw_type = ND_NEIGHBOR_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_advert),\n\t},\n\t[NDP_MSG_R] = {\n\t\t.strabbr = \"R\",\n\t\t.raw_type = ND_REDIRECT,\n\t\t.raw_struct_size = sizeof(struct nd_redirect),\n\t},\n};",
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct ndp_msg_type_info ndp_msg_type_info_list[] =\n{\n\t[NDP_MSG_RS] = {\n\t\t.strabbr = \"RS\",\n\t\t.raw_type = ND_ROUTER_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_router_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_routers,\n\t},\n\t[NDP_MSG_RA] = {\n\t\t.strabbr = \"RA\",\n\t\t.raw_type = ND_ROUTER_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_router_advert),\n\t},\n\t[NDP_MSG_NS] = {\n\t\t.strabbr = \"NS\",\n\t\t.raw_type = ND_NEIGHBOR_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_nodes,\n\t},\n\t[NDP_MSG_NA] = {\n\t\t.strabbr = \"NA\",\n\t\t.raw_type = ND_NEIGHBOR_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_advert),\n\t},\n\t[NDP_MSG_R] = {\n\t\t.strabbr = \"R\",\n\t\t.raw_type = ND_REDIRECT,\n\t\t.raw_struct_size = sizeof(struct nd_redirect),\n\t},\n};\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\n\nstruct ndp_msg_type_info *ndp_msg_type_info(enum ndp_msg_type msg_type)\n{\n\treturn &ndp_msg_type_info_list[msg_type];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic void ndp_msg_init(struct ndp_msg *msg, enum ndp_msg_type msg_type)\n{\n\tsize_t raw_struct_size = ndp_msg_type_info(msg_type)->raw_struct_size;\n\n\tndp_msg_type_set(msg, msg_type);\n\tmsg->len = raw_struct_size;\n\tmsg->opts_start = msg->buf + raw_struct_size;\n\n\t/* Set-up \"first pointers\" in all ndp_msgrs, ndp_msgra, ndp_msgns,\n\t * ndp_msgna, ndp_msgr structures.\n\t */\n\tmsg->nd_msg.generic.dataptr = ndp_msg_payload(msg);\n}"
  },
  {
    "function_name": "ndp_msg_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "401-410",
    "snippet": "static struct ndp_msg *ndp_msg_alloc(void)\n{\n\tstruct ndp_msg *msg;\n\n\tmsg = myzalloc(sizeof(*msg));\n\tif (!msg)\n\t\treturn NULL;\n\tmsg->icmp6_hdr = (struct icmp6_hdr *) msg->buf;\n\treturn msg;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "myzalloc",
          "args": [
            "sizeof(*msg)"
          ],
          "line": 405
        },
        "resolved": true,
        "details": {
          "function_name": "myzalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "134-137",
          "snippet": "static void *myzalloc(size_t size)\n{\n\treturn calloc(1, size);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void *myzalloc(size_t size)\n{\n\treturn calloc(1, size);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic struct ndp_msg *ndp_msg_alloc(void)\n{\n\tstruct ndp_msg *msg;\n\n\tmsg = myzalloc(sizeof(*msg));\n\tif (!msg)\n\t\treturn NULL;\n\tmsg->icmp6_hdr = (struct icmp6_hdr *) msg->buf;\n\treturn msg;\n}"
  },
  {
    "function_name": "ndp_msg_check_valid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "391-399",
    "snippet": "static bool ndp_msg_check_valid(struct ndp_msg *msg)\n{\n\tsize_t len = ndp_msg_payload_len(msg);\n\tenum ndp_msg_type msg_type = ndp_msg_type(msg);\n\n\tif (len < ndp_msg_type_info(msg_type)->raw_struct_size)\n\t\treturn false;\n\treturn true;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_type_info",
          "args": [
            "msg_type"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_type_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "372-375",
          "snippet": "struct ndp_msg_type_info *ndp_msg_type_info(enum ndp_msg_type msg_type)\n{\n\treturn &ndp_msg_type_info_list[msg_type];\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct ndp_msg_type_info ndp_msg_type_info_list[] =\n{\n\t[NDP_MSG_RS] = {\n\t\t.strabbr = \"RS\",\n\t\t.raw_type = ND_ROUTER_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_router_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_routers,\n\t},\n\t[NDP_MSG_RA] = {\n\t\t.strabbr = \"RA\",\n\t\t.raw_type = ND_ROUTER_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_router_advert),\n\t},\n\t[NDP_MSG_NS] = {\n\t\t.strabbr = \"NS\",\n\t\t.raw_type = ND_NEIGHBOR_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_nodes,\n\t},\n\t[NDP_MSG_NA] = {\n\t\t.strabbr = \"NA\",\n\t\t.raw_type = ND_NEIGHBOR_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_advert),\n\t},\n\t[NDP_MSG_R] = {\n\t\t.strabbr = \"R\",\n\t\t.raw_type = ND_REDIRECT,\n\t\t.raw_struct_size = sizeof(struct nd_redirect),\n\t},\n};",
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct ndp_msg_type_info ndp_msg_type_info_list[] =\n{\n\t[NDP_MSG_RS] = {\n\t\t.strabbr = \"RS\",\n\t\t.raw_type = ND_ROUTER_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_router_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_routers,\n\t},\n\t[NDP_MSG_RA] = {\n\t\t.strabbr = \"RA\",\n\t\t.raw_type = ND_ROUTER_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_router_advert),\n\t},\n\t[NDP_MSG_NS] = {\n\t\t.strabbr = \"NS\",\n\t\t.raw_type = ND_NEIGHBOR_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_nodes,\n\t},\n\t[NDP_MSG_NA] = {\n\t\t.strabbr = \"NA\",\n\t\t.raw_type = ND_NEIGHBOR_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_advert),\n\t},\n\t[NDP_MSG_R] = {\n\t\t.strabbr = \"R\",\n\t\t.raw_type = ND_REDIRECT,\n\t\t.raw_struct_size = sizeof(struct nd_redirect),\n\t},\n};\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\n\nstruct ndp_msg_type_info *ndp_msg_type_info(enum ndp_msg_type msg_type)\n{\n\treturn &ndp_msg_type_info_list[msg_type];\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_type",
          "args": [
            "msg"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "643-652",
          "snippet": "ndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nndp_msg_type ndp_msg_type(struct ndp_msg *msg)\n{\n\tenum ndp_msg_type msg_type;\n\tint err;\n\n\terr = ndp_msg_type_by_raw_type(&msg_type, msg->icmp6_hdr->icmp6_type);\n\t/* Type should be always set correctly (ensured by ndp_msg_init) */\n\tBUG_ON(err);\n\treturn msg_type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndp_msg_payload_len",
          "args": [
            "msg"
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_payload_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "499-503",
          "snippet": "NDP_EXPORT\nsize_t ndp_msg_payload_len(struct ndp_msg *msg)\n{\n\treturn msg->len;\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nsize_t ndp_msg_payload_len(struct ndp_msg *msg)\n{\n\treturn msg->len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nstatic bool ndp_msg_check_valid(struct ndp_msg *msg)\n{\n\tsize_t len = ndp_msg_payload_len(msg);\n\tenum ndp_msg_type msg_type = ndp_msg_type(msg);\n\n\tif (len < ndp_msg_type_info(msg_type)->raw_struct_size)\n\t\treturn false;\n\treturn true;\n}"
  },
  {
    "function_name": "ndp_msg_type_by_raw_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "377-389",
    "snippet": "static int ndp_msg_type_by_raw_type(enum ndp_msg_type *p_msg_type,\n\t\t\t\t    uint8_t raw_type)\n{\n\tint i;\n\n\tfor (i = 0; i < NDP_MSG_TYPE_LIST_SIZE; i++) {\n\t\tif (ndp_msg_type_info(i)->raw_type == raw_type) {\n\t\t\t*p_msg_type = i;\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn -ENOENT;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [
      "#define NDP_MSG_TYPE_LIST_SIZE ARRAY_SIZE(ndp_msg_type_info_list)"
    ],
    "globals_used": [
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nenum"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndp_msg_type_info",
          "args": [
            "i"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_type_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "372-375",
          "snippet": "struct ndp_msg_type_info *ndp_msg_type_info(enum ndp_msg_type msg_type)\n{\n\treturn &ndp_msg_type_info_list[msg_type];\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct ndp_msg_type_info ndp_msg_type_info_list[] =\n{\n\t[NDP_MSG_RS] = {\n\t\t.strabbr = \"RS\",\n\t\t.raw_type = ND_ROUTER_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_router_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_routers,\n\t},\n\t[NDP_MSG_RA] = {\n\t\t.strabbr = \"RA\",\n\t\t.raw_type = ND_ROUTER_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_router_advert),\n\t},\n\t[NDP_MSG_NS] = {\n\t\t.strabbr = \"NS\",\n\t\t.raw_type = ND_NEIGHBOR_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_nodes,\n\t},\n\t[NDP_MSG_NA] = {\n\t\t.strabbr = \"NA\",\n\t\t.raw_type = ND_NEIGHBOR_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_advert),\n\t},\n\t[NDP_MSG_R] = {\n\t\t.strabbr = \"R\",\n\t\t.raw_type = ND_REDIRECT,\n\t\t.raw_struct_size = sizeof(struct nd_redirect),\n\t},\n};",
            "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nenum",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct ndp_msg_type_info ndp_msg_type_info_list[] =\n{\n\t[NDP_MSG_RS] = {\n\t\t.strabbr = \"RS\",\n\t\t.raw_type = ND_ROUTER_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_router_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_routers,\n\t},\n\t[NDP_MSG_RA] = {\n\t\t.strabbr = \"RA\",\n\t\t.raw_type = ND_ROUTER_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_router_advert),\n\t},\n\t[NDP_MSG_NS] = {\n\t\t.strabbr = \"NS\",\n\t\t.raw_type = ND_NEIGHBOR_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_nodes,\n\t},\n\t[NDP_MSG_NA] = {\n\t\t.strabbr = \"NA\",\n\t\t.raw_type = ND_NEIGHBOR_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_advert),\n\t},\n\t[NDP_MSG_R] = {\n\t\t.strabbr = \"R\",\n\t\t.raw_type = ND_REDIRECT,\n\t\t.raw_struct_size = sizeof(struct nd_redirect),\n\t},\n};\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\n\nstruct ndp_msg_type_info *ndp_msg_type_info(enum ndp_msg_type msg_type)\n{\n\treturn &ndp_msg_type_info_list[msg_type];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\n#define NDP_MSG_TYPE_LIST_SIZE ARRAY_SIZE(ndp_msg_type_info_list)\n\nNDP_EXPORT\nenum;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nenum;\n\nstatic int ndp_msg_type_by_raw_type(enum ndp_msg_type *p_msg_type,\n\t\t\t\t    uint8_t raw_type)\n{\n\tint i;\n\n\tfor (i = 0; i < NDP_MSG_TYPE_LIST_SIZE; i++) {\n\t\tif (ndp_msg_type_info(i)->raw_type == raw_type) {\n\t\t\t*p_msg_type = i;\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn -ENOENT;\n}"
  },
  {
    "function_name": "ndp_msg_type_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "372-375",
    "snippet": "struct ndp_msg_type_info *ndp_msg_type_info(enum ndp_msg_type msg_type)\n{\n\treturn &ndp_msg_type_info_list[msg_type];\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ndp_msg_type_info ndp_msg_type_info_list[] =\n{\n\t[NDP_MSG_RS] = {\n\t\t.strabbr = \"RS\",\n\t\t.raw_type = ND_ROUTER_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_router_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_routers,\n\t},\n\t[NDP_MSG_RA] = {\n\t\t.strabbr = \"RA\",\n\t\t.raw_type = ND_ROUTER_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_router_advert),\n\t},\n\t[NDP_MSG_NS] = {\n\t\t.strabbr = \"NS\",\n\t\t.raw_type = ND_NEIGHBOR_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_nodes,\n\t},\n\t[NDP_MSG_NA] = {\n\t\t.strabbr = \"NA\",\n\t\t.raw_type = ND_NEIGHBOR_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_advert),\n\t},\n\t[NDP_MSG_R] = {\n\t\t.strabbr = \"R\",\n\t\t.raw_type = ND_REDIRECT,\n\t\t.raw_struct_size = sizeof(struct nd_redirect),\n\t},\n};",
      "static void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nenum",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic struct ndp_msg_type_info ndp_msg_type_info_list[] =\n{\n\t[NDP_MSG_RS] = {\n\t\t.strabbr = \"RS\",\n\t\t.raw_type = ND_ROUTER_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_router_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_routers,\n\t},\n\t[NDP_MSG_RA] = {\n\t\t.strabbr = \"RA\",\n\t\t.raw_type = ND_ROUTER_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_router_advert),\n\t},\n\t[NDP_MSG_NS] = {\n\t\t.strabbr = \"NS\",\n\t\t.raw_type = ND_NEIGHBOR_SOLICIT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_solicit),\n\t\t.addrto_adjust = ndp_msg_addrto_adjust_all_nodes,\n\t},\n\t[NDP_MSG_NA] = {\n\t\t.strabbr = \"NA\",\n\t\t.raw_type = ND_NEIGHBOR_ADVERT,\n\t\t.raw_struct_size = sizeof(struct nd_neighbor_advert),\n\t},\n\t[NDP_MSG_R] = {\n\t\t.strabbr = \"R\",\n\t\t.raw_type = ND_REDIRECT,\n\t\t.raw_struct_size = sizeof(struct nd_redirect),\n\t},\n};\nstatic void ndp_msg_type_set(struct ndp_msg *msg, enum ndp_msg_type msg_type);\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nenum;\nNDP_EXPORT\nstruct;\n\nstruct ndp_msg_type_info *ndp_msg_type_info(enum ndp_msg_type msg_type)\n{\n\treturn &ndp_msg_type_info_list[msg_type];\n}"
  },
  {
    "function_name": "ndp_msg_addrto_adjust_all_routers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "327-337",
    "snippet": "static void ndp_msg_addrto_adjust_all_routers(struct in6_addr *addr)\n{\n\tstruct in6_addr any = IN6ADDR_ANY_INIT;\n\n\tif (memcmp(addr, &any, sizeof(any)))\n\t\treturn;\n\taddr->s6_addr32[0] = htonl(0xFF020000);\n\taddr->s6_addr32[1] = 0;\n\taddr->s6_addr32[2] = 0;\n\taddr->s6_addr32[3] = htonl(0x2);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "0x2"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "0xFF020000"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "addr",
            "&any",
            "sizeof(any)"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nstatic void ndp_msg_addrto_adjust_all_routers(struct in6_addr *addr)\n{\n\tstruct in6_addr any = IN6ADDR_ANY_INIT;\n\n\tif (memcmp(addr, &any, sizeof(any)))\n\t\treturn;\n\taddr->s6_addr32[0] = htonl(0xFF020000);\n\taddr->s6_addr32[1] = 0;\n\taddr->s6_addr32[2] = 0;\n\taddr->s6_addr32[3] = htonl(0x2);\n}"
  },
  {
    "function_name": "ndp_msg_addrto_adjust_all_nodes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "315-325",
    "snippet": "static void ndp_msg_addrto_adjust_all_nodes(struct in6_addr *addr)\n{\n\tstruct in6_addr any = IN6ADDR_ANY_INIT;\n\n\tif (memcmp(addr, &any, sizeof(any)))\n\t\treturn;\n\taddr->s6_addr32[0] = htonl(0xFF020000);\n\taddr->s6_addr32[1] = 0;\n\taddr->s6_addr32[2] = 0;\n\taddr->s6_addr32[3] = htonl(0x1);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "0x1"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "0xFF020000"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "addr",
            "&any",
            "sizeof(any)"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nstatic void ndp_msg_addrto_adjust_all_nodes(struct in6_addr *addr)\n{\n\tstruct in6_addr any = IN6ADDR_ANY_INIT;\n\n\tif (memcmp(addr, &any, sizeof(any)))\n\t\treturn;\n\taddr->s6_addr32[0] = htonl(0xFF020000);\n\taddr->s6_addr32[1] = 0;\n\taddr->s6_addr32[2] = 0;\n\taddr->s6_addr32[3] = htonl(0x1);\n}"
  },
  {
    "function_name": "ndp_sock_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "259-262",
    "snippet": "static void ndp_sock_close(struct ndp *ndp)\n{\n\tclose(ndp->sock);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "ndp->sock"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1978-1983",
          "snippet": "NDP_EXPORT\nvoid ndp_close(struct ndp *ndp)\n{\n\tndp_sock_close(ndp);\n\tfree(ndp);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_close(struct ndp *ndp)\n{\n\tndp_sock_close(ndp);\n\tfree(ndp);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nstatic void ndp_sock_close(struct ndp *ndp)\n{\n\tclose(ndp->sock);\n}"
  },
  {
    "function_name": "ndp_sock_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "220-257",
    "snippet": "static int ndp_sock_open(struct ndp *ndp)\n{\n\tint sock;\n\t//struct icmp6_filter flt;\n\tint ret;\n\tint err;\n\tint val;\n\n\tsock = socket(PF_INET6, SOCK_RAW, IPPROTO_ICMPV6);\n\tif (sock == -1) {\n\t\terr(ndp, \"Failed to create ICMP6 socket.\");\n\t\treturn -errno;\n\t}\n\n\tval = 1;\n\tret = setsockopt(sock, IPPROTO_IPV6, IPV6_RECVPKTINFO,\n\t\t\t &val, sizeof(val));\n\tif (ret == -1) {\n\t\terr(ndp, \"Failed to setsockopt IPV6_RECVPKTINFO.\");\n\t\terr = -errno;\n\t\tgoto close_sock;\n\t}\n\n\tval = 255;\n\tret = setsockopt(sock, IPPROTO_IPV6, IPV6_MULTICAST_HOPS,\n\t\t\t &val, sizeof(val));\n\tif (ret == -1) {\n\t\terr(ndp, \"Failed to setsockopt IPV6_MULTICAST_HOPS.\");\n\t\terr = -errno;\n\t\tgoto close_sock;\n\t}\n\n\tndp->sock = sock;\n\treturn 0;\nclose_sock:\n\tclose(sock);\n\treturn err;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "sock"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1978-1983",
          "snippet": "NDP_EXPORT\nvoid ndp_close(struct ndp *ndp)\n{\n\tndp_sock_close(ndp);\n\tfree(ndp);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_close(struct ndp *ndp)\n{\n\tndp_sock_close(ndp);\n\tfree(ndp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "err",
          "args": [
            "ndp",
            "\"Failed to setsockopt IPV6_MULTICAST_HOPS.\""
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "ndp_msg_opt_prefix_preferred_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "1388-1395",
          "snippet": "NDP_EXPORT\nuint32_t ndp_msg_opt_prefix_preferred_time(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(pi->nd_opt_pi_preferred_time);\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"ndp_private.h\"",
            "#include <ndp.h>",
            "#include <assert.h>",
            "#include <net/ethernet.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/icmp6.h>",
            "#include <netinet/in.h>",
            "#include <sys/select.h>",
            "#include <sys/socket.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "NDP_EXPORT\nstruct",
            "static int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nstatic int ndp_call_handlers(struct ndp *ndp, struct ndp_msg *msg);\n\nNDP_EXPORT\nuint32_t ndp_msg_opt_prefix_preferred_time(struct ndp_msg *msg, int offset)\n{\n\tstruct nd_opt_prefix_info *pi =\n\t\t\tndp_msg_payload_opts_offset(msg, offset);\n\n\treturn ntohl(pi->nd_opt_pi_preferred_time);\n}"
        }
      },
      {
        "call_info": {
          "callee": "setsockopt",
          "args": [
            "sock",
            "IPPROTO_IPV6",
            "IPV6_MULTICAST_HOPS",
            "&val",
            "sizeof(val)"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setsockopt",
          "args": [
            "sock",
            "IPPROTO_IPV6",
            "IPV6_RECVPKTINFO",
            "&val",
            "sizeof(val)"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket",
          "args": [
            "PF_INET6",
            "SOCK_RAW",
            "IPPROTO_ICMPV6"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nstatic int ndp_sock_open(struct ndp *ndp)\n{\n\tint sock;\n\t//struct icmp6_filter flt;\n\tint ret;\n\tint err;\n\tint val;\n\n\tsock = socket(PF_INET6, SOCK_RAW, IPPROTO_ICMPV6);\n\tif (sock == -1) {\n\t\terr(ndp, \"Failed to create ICMP6 socket.\");\n\t\treturn -errno;\n\t}\n\n\tval = 1;\n\tret = setsockopt(sock, IPPROTO_IPV6, IPV6_RECVPKTINFO,\n\t\t\t &val, sizeof(val));\n\tif (ret == -1) {\n\t\terr(ndp, \"Failed to setsockopt IPV6_RECVPKTINFO.\");\n\t\terr = -errno;\n\t\tgoto close_sock;\n\t}\n\n\tval = 255;\n\tret = setsockopt(sock, IPPROTO_IPV6, IPV6_MULTICAST_HOPS,\n\t\t\t &val, sizeof(val));\n\tif (ret == -1) {\n\t\terr(ndp, \"Failed to setsockopt IPV6_MULTICAST_HOPS.\");\n\t\terr = -errno;\n\t\tgoto close_sock;\n\t}\n\n\tndp->sock = sock;\n\treturn 0;\nclose_sock:\n\tclose(sock);\n\treturn err;\n}"
  },
  {
    "function_name": "str_in6_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "207-212",
    "snippet": "static const char *str_in6_addr(struct in6_addr *addr)\n{\n\tstatic char buf[INET6_ADDRSTRLEN];\n\n\treturn inet_ntop(AF_INET6, addr, buf, sizeof(buf));\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "inet_ntop",
          "args": [
            "AF_INET6",
            "addr",
            "buf",
            "sizeof(buf)"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nstatic const char *str_in6_addr(struct in6_addr *addr)\n{\n\tstatic char buf[INET6_ADDRSTRLEN];\n\n\treturn inet_ntop(AF_INET6, addr, buf, sizeof(buf));\n}"
  },
  {
    "function_name": "mysendto6",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "185-205",
    "snippet": "static int mysendto6(int sockfd, void *buf, size_t buflen, int flags,\n\t\t     struct in6_addr *addr, uint32_t ifindex)\n{\n\tstruct sockaddr_in6 sin6;\n\tssize_t ret;\n\n\tmemset(&sin6, 0, sizeof(sin6));\n\tmemcpy(&sin6.sin6_addr, addr, sizeof(sin6.sin6_addr));\n\tsin6.sin6_scope_id = ifindex;\nresend:\n\tret = sendto(sockfd, buf, buflen, flags, &sin6, sizeof(sin6));\n\tif (ret == -1) {\n\t\tswitch(errno) {\n\t\tcase EINTR:\n\t\t\tgoto resend;\n\t\tdefault:\n\t\t\treturn -errno;\n\t\t}\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sendto",
          "args": [
            "sockfd",
            "buf",
            "buflen",
            "flags",
            "&sin6",
            "sizeof(sin6)"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "mysendto6",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
          "lines": "185-205",
          "snippet": "static int mysendto6(int sockfd, void *buf, size_t buflen, int flags,\n\t\t     struct in6_addr *addr, uint32_t ifindex)\n{\n\tstruct sockaddr_in6 sin6;\n\tssize_t ret;\n\n\tmemset(&sin6, 0, sizeof(sin6));\n\tmemcpy(&sin6.sin6_addr, addr, sizeof(sin6.sin6_addr));\n\tsin6.sin6_scope_id = ifindex;\nresend:\n\tret = sendto(sockfd, buf, buflen, flags, &sin6, sizeof(sin6));\n\tif (ret == -1) {\n\t\tswitch(errno) {\n\t\tcase EINTR:\n\t\t\tgoto resend;\n\t\tdefault:\n\t\t\treturn -errno;\n\t\t}\n\t}\n\treturn 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&sin6.sin6_addr",
            "addr",
            "sizeof(sin6.sin6_addr)"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&sin6",
            "0",
            "sizeof(sin6)"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nstatic int mysendto6(int sockfd, void *buf, size_t buflen, int flags,\n\t\t     struct in6_addr *addr, uint32_t ifindex)\n{\n\tstruct sockaddr_in6 sin6;\n\tssize_t ret;\n\n\tmemset(&sin6, 0, sizeof(sin6));\n\tmemcpy(&sin6.sin6_addr, addr, sizeof(sin6.sin6_addr));\n\tsin6.sin6_scope_id = ifindex;\nresend:\n\tret = sendto(sockfd, buf, buflen, flags, &sin6, sizeof(sin6));\n\tif (ret == -1) {\n\t\tswitch(errno) {\n\t\tcase EINTR:\n\t\t\tgoto resend;\n\t\tdefault:\n\t\t\treturn -errno;\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "myrecvfrom6",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "139-183",
    "snippet": "static int myrecvfrom6(int sockfd, void *buf, size_t *buflen, int flags,\n\t\t       struct in6_addr *addr, uint32_t *ifindex)\n{\n\tstruct sockaddr_in6 sin6;\n\tunsigned char cbuf[CMSG_SPACE(sizeof(struct in6_pktinfo))];\n\tstruct iovec iovec;\n\tstruct msghdr msghdr;\n\tstruct cmsghdr *cmsghdr;\n\tssize_t len;\n\n\tiovec.iov_len = *buflen;\n\tiovec.iov_base = buf;\n\tmemset(&msghdr, 0, sizeof(msghdr));\n\tmsghdr.msg_name = &sin6;\n\tmsghdr.msg_namelen = sizeof(sin6);\n\tmsghdr.msg_iov = &iovec;\n\tmsghdr.msg_iovlen = 1;\n\tmsghdr.msg_control = cbuf;\n\tmsghdr.msg_controllen = sizeof(cbuf);\n\n\tlen = recvmsg(sockfd, &msghdr, flags);\n\tif (len == -1)\n\t\treturn -errno;\n\t*buflen = len;\n\n\t/* Set ifindex to scope_id now. But since scope_id gets not\n\t * set by kernel for linklocal addresses, use pktinfo to obtain that\n\t * value right after.\n\t */\n\t*ifindex = sin6.sin6_scope_id;\n        for (cmsghdr = CMSG_FIRSTHDR(&msghdr); cmsghdr;\n\t     cmsghdr = CMSG_NXTHDR(&msghdr, cmsghdr)) {\n\t\tif (cmsghdr->cmsg_level == IPPROTO_IPV6 &&\n\t\t    cmsghdr->cmsg_type == IPV6_PKTINFO &&\n\t\t    cmsghdr->cmsg_len == CMSG_LEN(sizeof(struct in6_pktinfo))) {\n\t\t\tstruct in6_pktinfo *pktinfo;\n\n\t\t\tpktinfo = (struct in6_pktinfo *) CMSG_DATA(cmsghdr);\n\t\t\t*ifindex = pktinfo->ipi6_ifindex;\n\t\t}\n\t}\n\t*addr = sin6.sin6_addr;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "CMSG_DATA",
          "args": [
            "cmsghdr"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CMSG_LEN",
          "args": [
            "sizeof(struct in6_pktinfo)"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CMSG_NXTHDR",
          "args": [
            "&msghdr",
            "cmsghdr"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CMSG_FIRSTHDR",
          "args": [
            "&msghdr"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "recvmsg",
          "args": [
            "sockfd",
            "&msghdr",
            "flags"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&msghdr",
            "0",
            "sizeof(msghdr)"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CMSG_SPACE",
          "args": [
            "sizeof(struct in6_pktinfo)"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nstatic int myrecvfrom6(int sockfd, void *buf, size_t *buflen, int flags,\n\t\t       struct in6_addr *addr, uint32_t *ifindex)\n{\n\tstruct sockaddr_in6 sin6;\n\tunsigned char cbuf[CMSG_SPACE(sizeof(struct in6_pktinfo))];\n\tstruct iovec iovec;\n\tstruct msghdr msghdr;\n\tstruct cmsghdr *cmsghdr;\n\tssize_t len;\n\n\tiovec.iov_len = *buflen;\n\tiovec.iov_base = buf;\n\tmemset(&msghdr, 0, sizeof(msghdr));\n\tmsghdr.msg_name = &sin6;\n\tmsghdr.msg_namelen = sizeof(sin6);\n\tmsghdr.msg_iov = &iovec;\n\tmsghdr.msg_iovlen = 1;\n\tmsghdr.msg_control = cbuf;\n\tmsghdr.msg_controllen = sizeof(cbuf);\n\n\tlen = recvmsg(sockfd, &msghdr, flags);\n\tif (len == -1)\n\t\treturn -errno;\n\t*buflen = len;\n\n\t/* Set ifindex to scope_id now. But since scope_id gets not\n\t * set by kernel for linklocal addresses, use pktinfo to obtain that\n\t * value right after.\n\t */\n\t*ifindex = sin6.sin6_scope_id;\n        for (cmsghdr = CMSG_FIRSTHDR(&msghdr); cmsghdr;\n\t     cmsghdr = CMSG_NXTHDR(&msghdr, cmsghdr)) {\n\t\tif (cmsghdr->cmsg_level == IPPROTO_IPV6 &&\n\t\t    cmsghdr->cmsg_type == IPV6_PKTINFO &&\n\t\t    cmsghdr->cmsg_len == CMSG_LEN(sizeof(struct in6_pktinfo))) {\n\t\t\tstruct in6_pktinfo *pktinfo;\n\n\t\t\tpktinfo = (struct in6_pktinfo *) CMSG_DATA(cmsghdr);\n\t\t\t*ifindex = pktinfo->ipi6_ifindex;\n\t\t}\n\t}\n\t*addr = sin6.sin6_addr;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "myzalloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "134-137",
    "snippet": "static void *myzalloc(size_t size)\n{\n\treturn calloc(1, size);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "calloc",
          "args": [
            "1",
            "size"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic void *myzalloc(size_t size)\n{\n\treturn calloc(1, size);\n}"
  },
  {
    "function_name": "ndp_set_log_priority",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "119-123",
    "snippet": "NDP_EXPORT\nvoid ndp_set_log_priority(struct ndp *ndp, int priority)\n{\n\tndp->log_priority = priority;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_set_log_priority(struct ndp *ndp, int priority)\n{\n\tndp->log_priority = priority;\n}"
  },
  {
    "function_name": "ndp_get_log_priority",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "105-109",
    "snippet": "NDP_EXPORT\nint ndp_get_log_priority(struct ndp *ndp)\n{\n\treturn ndp->log_priority;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nint ndp_get_log_priority(struct ndp *ndp)\n{\n\treturn ndp->log_priority;\n}"
  },
  {
    "function_name": "ndp_set_log_fn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "89-97",
    "snippet": "NDP_EXPORT\nvoid ndp_set_log_fn(struct ndp *ndp,\n\t\t    void (*log_fn)(struct ndp *ndp, int priority,\n\t\t\t\t   const char *file, int line, const char *fn,\n\t\t\t\t   const char *format, va_list args))\n{\n\tndp->log_fn = log_fn;\n\tdbg(ndp, \"Custom logging function %p registered.\", log_fn);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "dbg",
          "args": [
            "ndp",
            "\"Custom logging function %p registered.\"",
            "log_fn"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nNDP_EXPORT\nvoid ndp_set_log_fn(struct ndp *ndp,\n\t\t    void (*log_fn)(struct ndp *ndp, int priority,\n\t\t\t\t   const char *file, int line, const char *fn,\n\t\t\t\t   const char *format, va_list args))\n{\n\tndp->log_fn = log_fn;\n\tdbg(ndp, \"Custom logging function %p registered.\", log_fn);\n}"
  },
  {
    "function_name": "log_priority",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "63-78",
    "snippet": "static int log_priority(const char *priority)\n{\n\tchar *endptr;\n\tint prio;\n\n\tprio = strtol(priority, &endptr, 10);\n\tif (endptr[0] == '\\0' || isspace(endptr[0]))\n\t\treturn prio;\n\tif (strncmp(priority, \"err\", 3) == 0)\n\t\treturn LOG_ERR;\n\tif (strncmp(priority, \"info\", 4) == 0)\n\t\treturn LOG_INFO;\n\tif (strncmp(priority, \"debug\", 5) == 0)\n\t\treturn LOG_DEBUG;\n\treturn 0;\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "priority",
            "\"debug\"",
            "5"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "priority",
            "\"info\"",
            "4"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "priority",
            "\"err\"",
            "3"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "endptr[0]"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtol",
          "args": [
            "priority",
            "&endptr",
            "10"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nstatic int log_priority(const char *priority)\n{\n\tchar *endptr;\n\tint prio;\n\n\tprio = strtol(priority, &endptr, 10);\n\tif (endptr[0] == '\\0' || isspace(endptr[0]))\n\t\treturn prio;\n\tif (strncmp(priority, \"err\", 3) == 0)\n\t\treturn LOG_ERR;\n\tif (strncmp(priority, \"info\", 4) == 0)\n\t\treturn LOG_INFO;\n\tif (strncmp(priority, \"debug\", 5) == 0)\n\t\treturn LOG_DEBUG;\n\treturn 0;\n}"
  },
  {
    "function_name": "log_stderr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "54-61",
    "snippet": "static void log_stderr(struct ndp *ndp, int priority,\n\t\t       const char *file, int line, const char *fn,\n\t\t       const char *format, va_list args)\n{\n\tfprintf(stderr, \"libndp: %s: \", fn);\n\tvfprintf(stderr, format, args);\n\tfprintf(stderr, \"\\n\");\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"\\n\""
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vfprintf",
          "args": [
            "stderr",
            "format",
            "args"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"libndp: %s: \"",
            "fn"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nstatic void log_stderr(struct ndp *ndp, int priority,\n\t\t       const char *file, int line, const char *fn,\n\t\t       const char *format, va_list args)\n{\n\tfprintf(stderr, \"libndp: %s: \", fn);\n\tvfprintf(stderr, format, args);\n\tfprintf(stderr, \"\\n\");\n}"
  },
  {
    "function_name": "ndp_log",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-3698/repo/libndp/libndp.c",
    "lines": "43-52",
    "snippet": "void ndp_log(struct ndp *ndp, int priority,\n\t     const char *file, int line, const char *fn,\n\t     const char *format, ...)\n{\n\tva_list args;\n\n\tva_start(args, format);\n\tndp->log_fn(ndp, priority, file, line, fn, format, args);\n\tva_end(args);\n}",
    "includes": [
      "#include \"list.h\"",
      "#include \"ndp_private.h\"",
      "#include <ndp.h>",
      "#include <assert.h>",
      "#include <net/ethernet.h>",
      "#include <arpa/inet.h>",
      "#include <netinet/icmp6.h>",
      "#include <netinet/in.h>",
      "#include <sys/select.h>",
      "#include <sys/socket.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct",
      "NDP_EXPORT\nstruct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndp->log_fn",
          "args": [
            "ndp",
            "priority",
            "file",
            "line",
            "fn",
            "format",
            "args"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "format"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"list.h\"\n#include \"ndp_private.h\"\n#include <ndp.h>\n#include <assert.h>\n#include <net/ethernet.h>\n#include <arpa/inet.h>\n#include <netinet/icmp6.h>\n#include <netinet/in.h>\n#include <sys/select.h>\n#include <sys/socket.h>\n#include <ctype.h>\n#include <errno.h>\n#include <string.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <stdio.h>\n\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\nNDP_EXPORT\nstruct;\n\nvoid ndp_log(struct ndp *ndp, int priority,\n\t     const char *file, int line, const char *fn,\n\t     const char *format, ...)\n{\n\tva_list args;\n\n\tva_start(args, format);\n\tndp->log_fn(ndp, priority, file, line, fn, format, args);\n\tva_end(args);\n}"
  }
]