[
  {
    "function_name": "kvm_cpu_cap_check_and_set",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "300-304",
    "snippet": "static __always_inline void kvm_cpu_cap_check_and_set(unsigned int x86_feature)\n{\n\tif (boot_cpu_has(x86_feature))\n\t\tkvm_cpu_cap_set(x86_feature);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_cpu_cap_set",
          "args": [
            "x86_feature"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_cpu_cap_set",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "279-285",
          "snippet": "static __always_inline void kvm_cpu_cap_set(unsigned int x86_feature)\n{\n\tunsigned int x86_leaf = x86_feature / 32;\n\n\treverse_cpuid_check(x86_leaf);\n\tkvm_cpu_caps[x86_leaf] |= __feature_bit(x86_feature);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline void kvm_cpu_cap_set(unsigned int x86_feature)\n{\n\tunsigned int x86_leaf = x86_feature / 32;\n\n\treverse_cpuid_check(x86_leaf);\n\tkvm_cpu_caps[x86_leaf] |= __feature_bit(x86_feature);\n}"
        }
      },
      {
        "call_info": {
          "callee": "boot_cpu_has",
          "args": [
            "x86_feature"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline void kvm_cpu_cap_check_and_set(unsigned int x86_feature)\n{\n\tif (boot_cpu_has(x86_feature))\n\t\tkvm_cpu_cap_set(x86_feature);\n}"
  },
  {
    "function_name": "kvm_cpu_cap_has",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "295-298",
    "snippet": "static __always_inline bool kvm_cpu_cap_has(unsigned int x86_feature)\n{\n\treturn !!kvm_cpu_cap_get(x86_feature);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_cpu_cap_get",
          "args": [
            "x86_feature"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_cpu_cap_get",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "287-293",
          "snippet": "static __always_inline u32 kvm_cpu_cap_get(unsigned int x86_feature)\n{\n\tunsigned int x86_leaf = x86_feature / 32;\n\n\treverse_cpuid_check(x86_leaf);\n\treturn kvm_cpu_caps[x86_leaf] & __feature_bit(x86_feature);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 kvm_cpu_cap_get(unsigned int x86_feature)\n{\n\tunsigned int x86_leaf = x86_feature / 32;\n\n\treverse_cpuid_check(x86_leaf);\n\treturn kvm_cpu_caps[x86_leaf] & __feature_bit(x86_feature);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline bool kvm_cpu_cap_has(unsigned int x86_feature)\n{\n\treturn !!kvm_cpu_cap_get(x86_feature);\n}"
  },
  {
    "function_name": "kvm_cpu_cap_get",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "287-293",
    "snippet": "static __always_inline u32 kvm_cpu_cap_get(unsigned int x86_feature)\n{\n\tunsigned int x86_leaf = x86_feature / 32;\n\n\treverse_cpuid_check(x86_leaf);\n\treturn kvm_cpu_caps[x86_leaf] & __feature_bit(x86_feature);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__feature_bit",
          "args": [
            "x86_feature"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "__feature_bit",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "85-89",
          "snippet": "static __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reverse_cpuid_check",
          "args": [
            "x86_leaf"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "reverse_cpuid_check",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "69-77",
          "snippet": "static __always_inline void reverse_cpuid_check(unsigned int x86_leaf)\n{\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_1);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_2);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_3);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_4);\n\tBUILD_BUG_ON(x86_leaf >= ARRAY_SIZE(reverse_cpuid));\n\tBUILD_BUG_ON(reverse_cpuid[x86_leaf].function == 0);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline void reverse_cpuid_check(unsigned int x86_leaf)\n{\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_1);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_2);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_3);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_4);\n\tBUILD_BUG_ON(x86_leaf >= ARRAY_SIZE(reverse_cpuid));\n\tBUILD_BUG_ON(reverse_cpuid[x86_leaf].function == 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 kvm_cpu_cap_get(unsigned int x86_feature)\n{\n\tunsigned int x86_leaf = x86_feature / 32;\n\n\treverse_cpuid_check(x86_leaf);\n\treturn kvm_cpu_caps[x86_leaf] & __feature_bit(x86_feature);\n}"
  },
  {
    "function_name": "kvm_cpu_cap_set",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "279-285",
    "snippet": "static __always_inline void kvm_cpu_cap_set(unsigned int x86_feature)\n{\n\tunsigned int x86_leaf = x86_feature / 32;\n\n\treverse_cpuid_check(x86_leaf);\n\tkvm_cpu_caps[x86_leaf] |= __feature_bit(x86_feature);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__feature_bit",
          "args": [
            "x86_feature"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "__feature_bit",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "85-89",
          "snippet": "static __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reverse_cpuid_check",
          "args": [
            "x86_leaf"
          ],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "reverse_cpuid_check",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "69-77",
          "snippet": "static __always_inline void reverse_cpuid_check(unsigned int x86_leaf)\n{\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_1);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_2);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_3);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_4);\n\tBUILD_BUG_ON(x86_leaf >= ARRAY_SIZE(reverse_cpuid));\n\tBUILD_BUG_ON(reverse_cpuid[x86_leaf].function == 0);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline void reverse_cpuid_check(unsigned int x86_leaf)\n{\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_1);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_2);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_3);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_4);\n\tBUILD_BUG_ON(x86_leaf >= ARRAY_SIZE(reverse_cpuid));\n\tBUILD_BUG_ON(reverse_cpuid[x86_leaf].function == 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline void kvm_cpu_cap_set(unsigned int x86_feature)\n{\n\tunsigned int x86_leaf = x86_feature / 32;\n\n\treverse_cpuid_check(x86_leaf);\n\tkvm_cpu_caps[x86_leaf] |= __feature_bit(x86_feature);\n}"
  },
  {
    "function_name": "kvm_cpu_cap_clear",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "271-277",
    "snippet": "static __always_inline void kvm_cpu_cap_clear(unsigned int x86_feature)\n{\n\tunsigned int x86_leaf = x86_feature / 32;\n\n\treverse_cpuid_check(x86_leaf);\n\tkvm_cpu_caps[x86_leaf] &= ~__feature_bit(x86_feature);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__feature_bit",
          "args": [
            "x86_feature"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "__feature_bit",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "85-89",
          "snippet": "static __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reverse_cpuid_check",
          "args": [
            "x86_leaf"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "reverse_cpuid_check",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "69-77",
          "snippet": "static __always_inline void reverse_cpuid_check(unsigned int x86_leaf)\n{\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_1);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_2);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_3);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_4);\n\tBUILD_BUG_ON(x86_leaf >= ARRAY_SIZE(reverse_cpuid));\n\tBUILD_BUG_ON(reverse_cpuid[x86_leaf].function == 0);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline void reverse_cpuid_check(unsigned int x86_leaf)\n{\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_1);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_2);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_3);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_4);\n\tBUILD_BUG_ON(x86_leaf >= ARRAY_SIZE(reverse_cpuid));\n\tBUILD_BUG_ON(reverse_cpuid[x86_leaf].function == 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline void kvm_cpu_cap_clear(unsigned int x86_feature)\n{\n\tunsigned int x86_leaf = x86_feature / 32;\n\n\treverse_cpuid_check(x86_leaf);\n\tkvm_cpu_caps[x86_leaf] &= ~__feature_bit(x86_feature);\n}"
  },
  {
    "function_name": "cpuid_fault_enabled",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "265-269",
    "snippet": "static inline bool cpuid_fault_enabled(struct kvm_vcpu *vcpu)\n{\n\treturn vcpu->arch.msr_misc_features_enables &\n\t\t  MSR_MISC_FEATURES_ENABLES_CPUID_FAULT;\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic inline bool cpuid_fault_enabled(struct kvm_vcpu *vcpu)\n{\n\treturn vcpu->arch.msr_misc_features_enables &\n\t\t  MSR_MISC_FEATURES_ENABLES_CPUID_FAULT;\n}"
  },
  {
    "function_name": "supports_cpuid_fault",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "260-263",
    "snippet": "static inline bool supports_cpuid_fault(struct kvm_vcpu *vcpu)\n{\n\treturn vcpu->arch.msr_platform_info & MSR_PLATFORM_INFO_CPUID_FAULT;\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic inline bool supports_cpuid_fault(struct kvm_vcpu *vcpu)\n{\n\treturn vcpu->arch.msr_platform_info & MSR_PLATFORM_INFO_CPUID_FAULT;\n}"
  },
  {
    "function_name": "guest_cpuid_stepping",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "249-258",
    "snippet": "static inline int guest_cpuid_stepping(struct kvm_vcpu *vcpu)\n{\n\tstruct kvm_cpuid_entry2 *best;\n\n\tbest = kvm_find_cpuid_entry(vcpu, 0x1, 0);\n\tif (!best)\n\t\treturn -1;\n\n\treturn x86_stepping(best->eax);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "x86_stepping",
          "args": [
            "best->eax"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kvm_find_cpuid_entry",
          "args": [
            "vcpu",
            "0x1",
            "0"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_find_cpuid_entry",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.c",
          "lines": "903-917",
          "snippet": "struct kvm_cpuid_entry2 *kvm_find_cpuid_entry(struct kvm_vcpu *vcpu,\n\t\t\t\t\t      u32 function, u32 index)\n{\n\tstruct kvm_cpuid_entry2 *e;\n\tint i;\n\n\tfor (i = 0; i < vcpu->arch.cpuid_nent; ++i) {\n\t\te = &vcpu->arch.cpuid_entries[i];\n\n\t\tif (e->function == function && (e->index == index ||\n\t\t    !(e->flags & KVM_CPUID_FLAG_SIGNIFCANT_INDEX)))\n\t\t\treturn e;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"pmu.h\"",
            "#include \"trace.h\"",
            "#include \"mmu.h\"",
            "#include \"lapic.h\"",
            "#include \"cpuid.h\"",
            "#include <asm/fpu/xstate.h>",
            "#include <asm/user.h>",
            "#include <asm/processor.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/export.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pmu.h\"\n#include \"trace.h\"\n#include \"mmu.h\"\n#include \"lapic.h\"\n#include \"cpuid.h\"\n#include <asm/fpu/xstate.h>\n#include <asm/user.h>\n#include <asm/processor.h>\n#include <linux/sched/stat.h>\n#include <linux/uaccess.h>\n#include <linux/vmalloc.h>\n#include <linux/export.h>\n#include <linux/kvm_host.h>\n\nstruct kvm_cpuid_entry2 *kvm_find_cpuid_entry(struct kvm_vcpu *vcpu,\n\t\t\t\t\t      u32 function, u32 index)\n{\n\tstruct kvm_cpuid_entry2 *e;\n\tint i;\n\n\tfor (i = 0; i < vcpu->arch.cpuid_nent; ++i) {\n\t\te = &vcpu->arch.cpuid_entries[i];\n\n\t\tif (e->function == function && (e->index == index ||\n\t\t    !(e->flags & KVM_CPUID_FLAG_SIGNIFCANT_INDEX)))\n\t\t\treturn e;\n\t}\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic inline int guest_cpuid_stepping(struct kvm_vcpu *vcpu)\n{\n\tstruct kvm_cpuid_entry2 *best;\n\n\tbest = kvm_find_cpuid_entry(vcpu, 0x1, 0);\n\tif (!best)\n\t\treturn -1;\n\n\treturn x86_stepping(best->eax);\n}"
  },
  {
    "function_name": "guest_cpuid_model",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "238-247",
    "snippet": "static inline int guest_cpuid_model(struct kvm_vcpu *vcpu)\n{\n\tstruct kvm_cpuid_entry2 *best;\n\n\tbest = kvm_find_cpuid_entry(vcpu, 0x1, 0);\n\tif (!best)\n\t\treturn -1;\n\n\treturn x86_model(best->eax);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "x86_model",
          "args": [
            "best->eax"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kvm_find_cpuid_entry",
          "args": [
            "vcpu",
            "0x1",
            "0"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_find_cpuid_entry",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.c",
          "lines": "903-917",
          "snippet": "struct kvm_cpuid_entry2 *kvm_find_cpuid_entry(struct kvm_vcpu *vcpu,\n\t\t\t\t\t      u32 function, u32 index)\n{\n\tstruct kvm_cpuid_entry2 *e;\n\tint i;\n\n\tfor (i = 0; i < vcpu->arch.cpuid_nent; ++i) {\n\t\te = &vcpu->arch.cpuid_entries[i];\n\n\t\tif (e->function == function && (e->index == index ||\n\t\t    !(e->flags & KVM_CPUID_FLAG_SIGNIFCANT_INDEX)))\n\t\t\treturn e;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"pmu.h\"",
            "#include \"trace.h\"",
            "#include \"mmu.h\"",
            "#include \"lapic.h\"",
            "#include \"cpuid.h\"",
            "#include <asm/fpu/xstate.h>",
            "#include <asm/user.h>",
            "#include <asm/processor.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/export.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pmu.h\"\n#include \"trace.h\"\n#include \"mmu.h\"\n#include \"lapic.h\"\n#include \"cpuid.h\"\n#include <asm/fpu/xstate.h>\n#include <asm/user.h>\n#include <asm/processor.h>\n#include <linux/sched/stat.h>\n#include <linux/uaccess.h>\n#include <linux/vmalloc.h>\n#include <linux/export.h>\n#include <linux/kvm_host.h>\n\nstruct kvm_cpuid_entry2 *kvm_find_cpuid_entry(struct kvm_vcpu *vcpu,\n\t\t\t\t\t      u32 function, u32 index)\n{\n\tstruct kvm_cpuid_entry2 *e;\n\tint i;\n\n\tfor (i = 0; i < vcpu->arch.cpuid_nent; ++i) {\n\t\te = &vcpu->arch.cpuid_entries[i];\n\n\t\tif (e->function == function && (e->index == index ||\n\t\t    !(e->flags & KVM_CPUID_FLAG_SIGNIFCANT_INDEX)))\n\t\t\treturn e;\n\t}\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic inline int guest_cpuid_model(struct kvm_vcpu *vcpu)\n{\n\tstruct kvm_cpuid_entry2 *best;\n\n\tbest = kvm_find_cpuid_entry(vcpu, 0x1, 0);\n\tif (!best)\n\t\treturn -1;\n\n\treturn x86_model(best->eax);\n}"
  },
  {
    "function_name": "guest_cpuid_family",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "227-236",
    "snippet": "static inline int guest_cpuid_family(struct kvm_vcpu *vcpu)\n{\n\tstruct kvm_cpuid_entry2 *best;\n\n\tbest = kvm_find_cpuid_entry(vcpu, 0x1, 0);\n\tif (!best)\n\t\treturn -1;\n\n\treturn x86_family(best->eax);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "x86_family",
          "args": [
            "best->eax"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kvm_find_cpuid_entry",
          "args": [
            "vcpu",
            "0x1",
            "0"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_find_cpuid_entry",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.c",
          "lines": "903-917",
          "snippet": "struct kvm_cpuid_entry2 *kvm_find_cpuid_entry(struct kvm_vcpu *vcpu,\n\t\t\t\t\t      u32 function, u32 index)\n{\n\tstruct kvm_cpuid_entry2 *e;\n\tint i;\n\n\tfor (i = 0; i < vcpu->arch.cpuid_nent; ++i) {\n\t\te = &vcpu->arch.cpuid_entries[i];\n\n\t\tif (e->function == function && (e->index == index ||\n\t\t    !(e->flags & KVM_CPUID_FLAG_SIGNIFCANT_INDEX)))\n\t\t\treturn e;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"pmu.h\"",
            "#include \"trace.h\"",
            "#include \"mmu.h\"",
            "#include \"lapic.h\"",
            "#include \"cpuid.h\"",
            "#include <asm/fpu/xstate.h>",
            "#include <asm/user.h>",
            "#include <asm/processor.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/export.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pmu.h\"\n#include \"trace.h\"\n#include \"mmu.h\"\n#include \"lapic.h\"\n#include \"cpuid.h\"\n#include <asm/fpu/xstate.h>\n#include <asm/user.h>\n#include <asm/processor.h>\n#include <linux/sched/stat.h>\n#include <linux/uaccess.h>\n#include <linux/vmalloc.h>\n#include <linux/export.h>\n#include <linux/kvm_host.h>\n\nstruct kvm_cpuid_entry2 *kvm_find_cpuid_entry(struct kvm_vcpu *vcpu,\n\t\t\t\t\t      u32 function, u32 index)\n{\n\tstruct kvm_cpuid_entry2 *e;\n\tint i;\n\n\tfor (i = 0; i < vcpu->arch.cpuid_nent; ++i) {\n\t\te = &vcpu->arch.cpuid_entries[i];\n\n\t\tif (e->function == function && (e->index == index ||\n\t\t    !(e->flags & KVM_CPUID_FLAG_SIGNIFCANT_INDEX)))\n\t\t\treturn e;\n\t}\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic inline int guest_cpuid_family(struct kvm_vcpu *vcpu)\n{\n\tstruct kvm_cpuid_entry2 *best;\n\n\tbest = kvm_find_cpuid_entry(vcpu, 0x1, 0);\n\tif (!best)\n\t\treturn -1;\n\n\treturn x86_family(best->eax);\n}"
  },
  {
    "function_name": "guest_cpuid_is_amd_or_hygon",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "217-225",
    "snippet": "static inline bool guest_cpuid_is_amd_or_hygon(struct kvm_vcpu *vcpu)\n{\n\tstruct kvm_cpuid_entry2 *best;\n\n\tbest = kvm_find_cpuid_entry(vcpu, 0, 0);\n\treturn best &&\n\t       (is_guest_vendor_amd(best->ebx, best->ecx, best->edx) ||\n\t\tis_guest_vendor_hygon(best->ebx, best->ecx, best->edx));\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "is_guest_vendor_hygon",
          "args": [
            "best->ebx",
            "best->ecx",
            "best->edx"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "is_guest_vendor_hygon",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_emulate.h",
          "lines": "419-424",
          "snippet": "static inline bool is_guest_vendor_hygon(u32 ebx, u32 ecx, u32 edx)\n{\n\treturn ebx == X86EMUL_CPUID_VENDOR_HygonGenuine_ebx &&\n\t       ecx == X86EMUL_CPUID_VENDOR_HygonGenuine_ecx &&\n\t       edx == X86EMUL_CPUID_VENDOR_HygonGenuine_edx;\n}",
          "includes": [
            "#include <asm/desc_defs.h>"
          ],
          "macros_used": [
            "#define X86EMUL_CPUID_VENDOR_HygonGenuine_edx 0x6e65476e",
            "#define X86EMUL_CPUID_VENDOR_HygonGenuine_ecx 0x656e6975",
            "#define X86EMUL_CPUID_VENDOR_HygonGenuine_ebx 0x6f677948"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/desc_defs.h>\n\n#define X86EMUL_CPUID_VENDOR_HygonGenuine_edx 0x6e65476e\n#define X86EMUL_CPUID_VENDOR_HygonGenuine_ecx 0x656e6975\n#define X86EMUL_CPUID_VENDOR_HygonGenuine_ebx 0x6f677948\n\nstatic inline bool is_guest_vendor_hygon(u32 ebx, u32 ecx, u32 edx)\n{\n\treturn ebx == X86EMUL_CPUID_VENDOR_HygonGenuine_ebx &&\n\t       ecx == X86EMUL_CPUID_VENDOR_HygonGenuine_ecx &&\n\t       edx == X86EMUL_CPUID_VENDOR_HygonGenuine_edx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_guest_vendor_amd",
          "args": [
            "best->ebx",
            "best->ecx",
            "best->edx"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "is_guest_vendor_amd",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_emulate.h",
          "lines": "409-417",
          "snippet": "static inline bool is_guest_vendor_amd(u32 ebx, u32 ecx, u32 edx)\n{\n\treturn (ebx == X86EMUL_CPUID_VENDOR_AuthenticAMD_ebx &&\n\t\tecx == X86EMUL_CPUID_VENDOR_AuthenticAMD_ecx &&\n\t\tedx == X86EMUL_CPUID_VENDOR_AuthenticAMD_edx) ||\n\t       (ebx == X86EMUL_CPUID_VENDOR_AMDisbetterI_ebx &&\n\t\tecx == X86EMUL_CPUID_VENDOR_AMDisbetterI_ecx &&\n\t\tedx == X86EMUL_CPUID_VENDOR_AMDisbetterI_edx);\n}",
          "includes": [
            "#include <asm/desc_defs.h>"
          ],
          "macros_used": [
            "#define X86EMUL_CPUID_VENDOR_AMDisbetterI_edx 0x74656273",
            "#define X86EMUL_CPUID_VENDOR_AMDisbetterI_ecx 0x21726574",
            "#define X86EMUL_CPUID_VENDOR_AMDisbetterI_ebx 0x69444d41",
            "#define X86EMUL_CPUID_VENDOR_AuthenticAMD_edx 0x69746e65",
            "#define X86EMUL_CPUID_VENDOR_AuthenticAMD_ecx 0x444d4163",
            "#define X86EMUL_CPUID_VENDOR_AuthenticAMD_ebx 0x68747541"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/desc_defs.h>\n\n#define X86EMUL_CPUID_VENDOR_AMDisbetterI_edx 0x74656273\n#define X86EMUL_CPUID_VENDOR_AMDisbetterI_ecx 0x21726574\n#define X86EMUL_CPUID_VENDOR_AMDisbetterI_ebx 0x69444d41\n#define X86EMUL_CPUID_VENDOR_AuthenticAMD_edx 0x69746e65\n#define X86EMUL_CPUID_VENDOR_AuthenticAMD_ecx 0x444d4163\n#define X86EMUL_CPUID_VENDOR_AuthenticAMD_ebx 0x68747541\n\nstatic inline bool is_guest_vendor_amd(u32 ebx, u32 ecx, u32 edx)\n{\n\treturn (ebx == X86EMUL_CPUID_VENDOR_AuthenticAMD_ebx &&\n\t\tecx == X86EMUL_CPUID_VENDOR_AuthenticAMD_ecx &&\n\t\tedx == X86EMUL_CPUID_VENDOR_AuthenticAMD_edx) ||\n\t       (ebx == X86EMUL_CPUID_VENDOR_AMDisbetterI_ebx &&\n\t\tecx == X86EMUL_CPUID_VENDOR_AMDisbetterI_ecx &&\n\t\tedx == X86EMUL_CPUID_VENDOR_AMDisbetterI_edx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kvm_find_cpuid_entry",
          "args": [
            "vcpu",
            "0",
            "0"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_find_cpuid_entry",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.c",
          "lines": "903-917",
          "snippet": "struct kvm_cpuid_entry2 *kvm_find_cpuid_entry(struct kvm_vcpu *vcpu,\n\t\t\t\t\t      u32 function, u32 index)\n{\n\tstruct kvm_cpuid_entry2 *e;\n\tint i;\n\n\tfor (i = 0; i < vcpu->arch.cpuid_nent; ++i) {\n\t\te = &vcpu->arch.cpuid_entries[i];\n\n\t\tif (e->function == function && (e->index == index ||\n\t\t    !(e->flags & KVM_CPUID_FLAG_SIGNIFCANT_INDEX)))\n\t\t\treturn e;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"pmu.h\"",
            "#include \"trace.h\"",
            "#include \"mmu.h\"",
            "#include \"lapic.h\"",
            "#include \"cpuid.h\"",
            "#include <asm/fpu/xstate.h>",
            "#include <asm/user.h>",
            "#include <asm/processor.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/export.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pmu.h\"\n#include \"trace.h\"\n#include \"mmu.h\"\n#include \"lapic.h\"\n#include \"cpuid.h\"\n#include <asm/fpu/xstate.h>\n#include <asm/user.h>\n#include <asm/processor.h>\n#include <linux/sched/stat.h>\n#include <linux/uaccess.h>\n#include <linux/vmalloc.h>\n#include <linux/export.h>\n#include <linux/kvm_host.h>\n\nstruct kvm_cpuid_entry2 *kvm_find_cpuid_entry(struct kvm_vcpu *vcpu,\n\t\t\t\t\t      u32 function, u32 index)\n{\n\tstruct kvm_cpuid_entry2 *e;\n\tint i;\n\n\tfor (i = 0; i < vcpu->arch.cpuid_nent; ++i) {\n\t\te = &vcpu->arch.cpuid_entries[i];\n\n\t\tif (e->function == function && (e->index == index ||\n\t\t    !(e->flags & KVM_CPUID_FLAG_SIGNIFCANT_INDEX)))\n\t\t\treturn e;\n\t}\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic inline bool guest_cpuid_is_amd_or_hygon(struct kvm_vcpu *vcpu)\n{\n\tstruct kvm_cpuid_entry2 *best;\n\n\tbest = kvm_find_cpuid_entry(vcpu, 0, 0);\n\treturn best &&\n\t       (is_guest_vendor_amd(best->ebx, best->ecx, best->edx) ||\n\t\tis_guest_vendor_hygon(best->ebx, best->ecx, best->edx));\n}"
  },
  {
    "function_name": "guest_cpuid_clear",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "207-215",
    "snippet": "static __always_inline void guest_cpuid_clear(struct kvm_vcpu *vcpu,\n\t\t\t\t\t      unsigned int x86_feature)\n{\n\tu32 *reg;\n\n\treg = guest_cpuid_get_register(vcpu, x86_feature);\n\tif (reg)\n\t\t*reg &= ~__feature_bit(x86_feature);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__feature_bit",
          "args": [
            "x86_feature"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "__feature_bit",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "85-89",
          "snippet": "static __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}"
        }
      },
      {
        "call_info": {
          "callee": "guest_cpuid_get_register",
          "args": [
            "vcpu",
            "x86_feature"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "guest_cpuid_get_register",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "182-193",
          "snippet": "static __always_inline u32 *guest_cpuid_get_register(struct kvm_vcpu *vcpu,\n\t\t\t\t\t\t     unsigned int x86_feature)\n{\n\tconst struct cpuid_reg cpuid = x86_feature_cpuid(x86_feature);\n\tstruct kvm_cpuid_entry2 *entry;\n\n\tentry = kvm_find_cpuid_entry(vcpu, cpuid.function, cpuid.index);\n\tif (!entry)\n\t\treturn NULL;\n\n\treturn __cpuid_entry_get_reg(entry, cpuid.reg);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 *guest_cpuid_get_register(struct kvm_vcpu *vcpu,\n\t\t\t\t\t\t     unsigned int x86_feature)\n{\n\tconst struct cpuid_reg cpuid = x86_feature_cpuid(x86_feature);\n\tstruct kvm_cpuid_entry2 *entry;\n\n\tentry = kvm_find_cpuid_entry(vcpu, cpuid.function, cpuid.index);\n\tif (!entry)\n\t\treturn NULL;\n\n\treturn __cpuid_entry_get_reg(entry, cpuid.reg);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline void guest_cpuid_clear(struct kvm_vcpu *vcpu,\n\t\t\t\t\t      unsigned int x86_feature)\n{\n\tu32 *reg;\n\n\treg = guest_cpuid_get_register(vcpu, x86_feature);\n\tif (reg)\n\t\t*reg &= ~__feature_bit(x86_feature);\n}"
  },
  {
    "function_name": "guest_cpuid_has",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "195-205",
    "snippet": "static __always_inline bool guest_cpuid_has(struct kvm_vcpu *vcpu,\n\t\t\t\t\t    unsigned int x86_feature)\n{\n\tu32 *reg;\n\n\treg = guest_cpuid_get_register(vcpu, x86_feature);\n\tif (!reg)\n\t\treturn false;\n\n\treturn *reg & __feature_bit(x86_feature);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__feature_bit",
          "args": [
            "x86_feature"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "__feature_bit",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "85-89",
          "snippet": "static __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}"
        }
      },
      {
        "call_info": {
          "callee": "guest_cpuid_get_register",
          "args": [
            "vcpu",
            "x86_feature"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "guest_cpuid_get_register",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "182-193",
          "snippet": "static __always_inline u32 *guest_cpuid_get_register(struct kvm_vcpu *vcpu,\n\t\t\t\t\t\t     unsigned int x86_feature)\n{\n\tconst struct cpuid_reg cpuid = x86_feature_cpuid(x86_feature);\n\tstruct kvm_cpuid_entry2 *entry;\n\n\tentry = kvm_find_cpuid_entry(vcpu, cpuid.function, cpuid.index);\n\tif (!entry)\n\t\treturn NULL;\n\n\treturn __cpuid_entry_get_reg(entry, cpuid.reg);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 *guest_cpuid_get_register(struct kvm_vcpu *vcpu,\n\t\t\t\t\t\t     unsigned int x86_feature)\n{\n\tconst struct cpuid_reg cpuid = x86_feature_cpuid(x86_feature);\n\tstruct kvm_cpuid_entry2 *entry;\n\n\tentry = kvm_find_cpuid_entry(vcpu, cpuid.function, cpuid.index);\n\tif (!entry)\n\t\treturn NULL;\n\n\treturn __cpuid_entry_get_reg(entry, cpuid.reg);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline bool guest_cpuid_has(struct kvm_vcpu *vcpu,\n\t\t\t\t\t    unsigned int x86_feature)\n{\n\tu32 *reg;\n\n\treg = guest_cpuid_get_register(vcpu, x86_feature);\n\tif (!reg)\n\t\treturn false;\n\n\treturn *reg & __feature_bit(x86_feature);\n}"
  },
  {
    "function_name": "guest_cpuid_get_register",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "182-193",
    "snippet": "static __always_inline u32 *guest_cpuid_get_register(struct kvm_vcpu *vcpu,\n\t\t\t\t\t\t     unsigned int x86_feature)\n{\n\tconst struct cpuid_reg cpuid = x86_feature_cpuid(x86_feature);\n\tstruct kvm_cpuid_entry2 *entry;\n\n\tentry = kvm_find_cpuid_entry(vcpu, cpuid.function, cpuid.index);\n\tif (!entry)\n\t\treturn NULL;\n\n\treturn __cpuid_entry_get_reg(entry, cpuid.reg);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__cpuid_entry_get_reg",
          "args": [
            "entry",
            "cpuid.reg"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "__cpuid_entry_get_reg",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "101-117",
          "snippet": "static __always_inline u32 *__cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\t  u32 reg)\n{\n\tswitch (reg) {\n\tcase CPUID_EAX:\n\t\treturn &entry->eax;\n\tcase CPUID_EBX:\n\t\treturn &entry->ebx;\n\tcase CPUID_ECX:\n\t\treturn &entry->ecx;\n\tcase CPUID_EDX:\n\t\treturn &entry->edx;\n\tdefault:\n\t\tBUILD_BUG();\n\t\treturn NULL;\n\t}\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 *__cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\t  u32 reg)\n{\n\tswitch (reg) {\n\tcase CPUID_EAX:\n\t\treturn &entry->eax;\n\tcase CPUID_EBX:\n\t\treturn &entry->ebx;\n\tcase CPUID_ECX:\n\t\treturn &entry->ecx;\n\tcase CPUID_EDX:\n\t\treturn &entry->edx;\n\tdefault:\n\t\tBUILD_BUG();\n\t\treturn NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kvm_find_cpuid_entry",
          "args": [
            "vcpu",
            "cpuid.function",
            "cpuid.index"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_find_cpuid_entry",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.c",
          "lines": "903-917",
          "snippet": "struct kvm_cpuid_entry2 *kvm_find_cpuid_entry(struct kvm_vcpu *vcpu,\n\t\t\t\t\t      u32 function, u32 index)\n{\n\tstruct kvm_cpuid_entry2 *e;\n\tint i;\n\n\tfor (i = 0; i < vcpu->arch.cpuid_nent; ++i) {\n\t\te = &vcpu->arch.cpuid_entries[i];\n\n\t\tif (e->function == function && (e->index == index ||\n\t\t    !(e->flags & KVM_CPUID_FLAG_SIGNIFCANT_INDEX)))\n\t\t\treturn e;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"pmu.h\"",
            "#include \"trace.h\"",
            "#include \"mmu.h\"",
            "#include \"lapic.h\"",
            "#include \"cpuid.h\"",
            "#include <asm/fpu/xstate.h>",
            "#include <asm/user.h>",
            "#include <asm/processor.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/export.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pmu.h\"\n#include \"trace.h\"\n#include \"mmu.h\"\n#include \"lapic.h\"\n#include \"cpuid.h\"\n#include <asm/fpu/xstate.h>\n#include <asm/user.h>\n#include <asm/processor.h>\n#include <linux/sched/stat.h>\n#include <linux/uaccess.h>\n#include <linux/vmalloc.h>\n#include <linux/export.h>\n#include <linux/kvm_host.h>\n\nstruct kvm_cpuid_entry2 *kvm_find_cpuid_entry(struct kvm_vcpu *vcpu,\n\t\t\t\t\t      u32 function, u32 index)\n{\n\tstruct kvm_cpuid_entry2 *e;\n\tint i;\n\n\tfor (i = 0; i < vcpu->arch.cpuid_nent; ++i) {\n\t\te = &vcpu->arch.cpuid_entries[i];\n\n\t\tif (e->function == function && (e->index == index ||\n\t\t    !(e->flags & KVM_CPUID_FLAG_SIGNIFCANT_INDEX)))\n\t\t\treturn e;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "x86_feature_cpuid",
          "args": [
            "x86_feature"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "x86_feature_cpuid",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "93-99",
          "snippet": "cpuid_reg x86_feature_cpuid(unsigned int x86_feature)\n{\n\tunsigned int x86_leaf = x86_feature / 32;\n\n\treverse_cpuid_check(x86_leaf);\n\treturn reverse_cpuid[x86_leaf];\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\ncpuid_reg x86_feature_cpuid(unsigned int x86_feature)\n{\n\tunsigned int x86_leaf = x86_feature / 32;\n\n\treverse_cpuid_check(x86_leaf);\n\treturn reverse_cpuid[x86_leaf];\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 *guest_cpuid_get_register(struct kvm_vcpu *vcpu,\n\t\t\t\t\t\t     unsigned int x86_feature)\n{\n\tconst struct cpuid_reg cpuid = x86_feature_cpuid(x86_feature);\n\tstruct kvm_cpuid_entry2 *entry;\n\n\tentry = kvm_find_cpuid_entry(vcpu, cpuid.function, cpuid.index);\n\tif (!entry)\n\t\treturn NULL;\n\n\treturn __cpuid_entry_get_reg(entry, cpuid.reg);\n}"
  },
  {
    "function_name": "cpuid_entry_override",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "173-180",
    "snippet": "static __always_inline void cpuid_entry_override(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\t enum cpuid_leafs leaf)\n{\n\tu32 *reg = cpuid_entry_get_reg(entry, leaf * 32);\n\n\tBUILD_BUG_ON(leaf >= ARRAY_SIZE(kvm_cpu_caps));\n\t*reg = kvm_cpu_caps[leaf];\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "leaf >= ARRAY_SIZE(kvm_cpu_caps)"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "kvm_cpu_caps"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpuid_entry_get_reg",
          "args": [
            "entry",
            "leaf * 32"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "cpuid_entry_get_reg",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "119-125",
          "snippet": "static __always_inline u32 *cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\tunsigned int x86_feature)\n{\n\tconst struct cpuid_reg cpuid = x86_feature_cpuid(x86_feature);\n\n\treturn __cpuid_entry_get_reg(entry, cpuid.reg);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 *cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\tunsigned int x86_feature)\n{\n\tconst struct cpuid_reg cpuid = x86_feature_cpuid(x86_feature);\n\n\treturn __cpuid_entry_get_reg(entry, cpuid.reg);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline void cpuid_entry_override(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\t enum cpuid_leafs leaf)\n{\n\tu32 *reg = cpuid_entry_get_reg(entry, leaf * 32);\n\n\tBUILD_BUG_ON(leaf >= ARRAY_SIZE(kvm_cpu_caps));\n\t*reg = kvm_cpu_caps[leaf];\n}"
  },
  {
    "function_name": "cpuid_entry_change",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "157-171",
    "snippet": "static __always_inline void cpuid_entry_change(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t       unsigned int x86_feature,\n\t\t\t\t\t       bool set)\n{\n\tu32 *reg = cpuid_entry_get_reg(entry, x86_feature);\n\n\t/*\n\t * Open coded instead of using cpuid_entry_{clear,set}() to coerce the\n\t * compiler into using CMOV instead of Jcc when possible.\n\t */\n\tif (set)\n\t\t*reg |= __feature_bit(x86_feature);\n\telse\n\t\t*reg &= ~__feature_bit(x86_feature);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__feature_bit",
          "args": [
            "x86_feature"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "__feature_bit",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "85-89",
          "snippet": "static __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpuid_entry_get_reg",
          "args": [
            "entry",
            "x86_feature"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "cpuid_entry_get_reg",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "119-125",
          "snippet": "static __always_inline u32 *cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\tunsigned int x86_feature)\n{\n\tconst struct cpuid_reg cpuid = x86_feature_cpuid(x86_feature);\n\n\treturn __cpuid_entry_get_reg(entry, cpuid.reg);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 *cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\tunsigned int x86_feature)\n{\n\tconst struct cpuid_reg cpuid = x86_feature_cpuid(x86_feature);\n\n\treturn __cpuid_entry_get_reg(entry, cpuid.reg);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline void cpuid_entry_change(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t       unsigned int x86_feature,\n\t\t\t\t\t       bool set)\n{\n\tu32 *reg = cpuid_entry_get_reg(entry, x86_feature);\n\n\t/*\n\t * Open coded instead of using cpuid_entry_{clear,set}() to coerce the\n\t * compiler into using CMOV instead of Jcc when possible.\n\t */\n\tif (set)\n\t\t*reg |= __feature_bit(x86_feature);\n\telse\n\t\t*reg &= ~__feature_bit(x86_feature);\n}"
  },
  {
    "function_name": "cpuid_entry_set",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "149-155",
    "snippet": "static __always_inline void cpuid_entry_set(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t    unsigned int x86_feature)\n{\n\tu32 *reg = cpuid_entry_get_reg(entry, x86_feature);\n\n\t*reg |= __feature_bit(x86_feature);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__feature_bit",
          "args": [
            "x86_feature"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "__feature_bit",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "85-89",
          "snippet": "static __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpuid_entry_get_reg",
          "args": [
            "entry",
            "x86_feature"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "cpuid_entry_get_reg",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "119-125",
          "snippet": "static __always_inline u32 *cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\tunsigned int x86_feature)\n{\n\tconst struct cpuid_reg cpuid = x86_feature_cpuid(x86_feature);\n\n\treturn __cpuid_entry_get_reg(entry, cpuid.reg);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 *cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\tunsigned int x86_feature)\n{\n\tconst struct cpuid_reg cpuid = x86_feature_cpuid(x86_feature);\n\n\treturn __cpuid_entry_get_reg(entry, cpuid.reg);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline void cpuid_entry_set(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t    unsigned int x86_feature)\n{\n\tu32 *reg = cpuid_entry_get_reg(entry, x86_feature);\n\n\t*reg |= __feature_bit(x86_feature);\n}"
  },
  {
    "function_name": "cpuid_entry_clear",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "141-147",
    "snippet": "static __always_inline void cpuid_entry_clear(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t      unsigned int x86_feature)\n{\n\tu32 *reg = cpuid_entry_get_reg(entry, x86_feature);\n\n\t*reg &= ~__feature_bit(x86_feature);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__feature_bit",
          "args": [
            "x86_feature"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "__feature_bit",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "85-89",
          "snippet": "static __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpuid_entry_get_reg",
          "args": [
            "entry",
            "x86_feature"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "cpuid_entry_get_reg",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "119-125",
          "snippet": "static __always_inline u32 *cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\tunsigned int x86_feature)\n{\n\tconst struct cpuid_reg cpuid = x86_feature_cpuid(x86_feature);\n\n\treturn __cpuid_entry_get_reg(entry, cpuid.reg);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 *cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\tunsigned int x86_feature)\n{\n\tconst struct cpuid_reg cpuid = x86_feature_cpuid(x86_feature);\n\n\treturn __cpuid_entry_get_reg(entry, cpuid.reg);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline void cpuid_entry_clear(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t      unsigned int x86_feature)\n{\n\tu32 *reg = cpuid_entry_get_reg(entry, x86_feature);\n\n\t*reg &= ~__feature_bit(x86_feature);\n}"
  },
  {
    "function_name": "cpuid_entry_has",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "135-139",
    "snippet": "static __always_inline bool cpuid_entry_has(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t    unsigned int x86_feature)\n{\n\treturn cpuid_entry_get(entry, x86_feature);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpuid_entry_get",
          "args": [
            "entry",
            "x86_feature"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "cpuid_entry_get",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "127-133",
          "snippet": "static __always_inline u32 cpuid_entry_get(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t   unsigned int x86_feature)\n{\n\tu32 *reg = cpuid_entry_get_reg(entry, x86_feature);\n\n\treturn *reg & __feature_bit(x86_feature);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 cpuid_entry_get(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t   unsigned int x86_feature)\n{\n\tu32 *reg = cpuid_entry_get_reg(entry, x86_feature);\n\n\treturn *reg & __feature_bit(x86_feature);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline bool cpuid_entry_has(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t    unsigned int x86_feature)\n{\n\treturn cpuid_entry_get(entry, x86_feature);\n}"
  },
  {
    "function_name": "cpuid_entry_get",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "127-133",
    "snippet": "static __always_inline u32 cpuid_entry_get(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t   unsigned int x86_feature)\n{\n\tu32 *reg = cpuid_entry_get_reg(entry, x86_feature);\n\n\treturn *reg & __feature_bit(x86_feature);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__feature_bit",
          "args": [
            "x86_feature"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "__feature_bit",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "85-89",
          "snippet": "static __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpuid_entry_get_reg",
          "args": [
            "entry",
            "x86_feature"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "cpuid_entry_get_reg",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "119-125",
          "snippet": "static __always_inline u32 *cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\tunsigned int x86_feature)\n{\n\tconst struct cpuid_reg cpuid = x86_feature_cpuid(x86_feature);\n\n\treturn __cpuid_entry_get_reg(entry, cpuid.reg);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 *cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\tunsigned int x86_feature)\n{\n\tconst struct cpuid_reg cpuid = x86_feature_cpuid(x86_feature);\n\n\treturn __cpuid_entry_get_reg(entry, cpuid.reg);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 cpuid_entry_get(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t   unsigned int x86_feature)\n{\n\tu32 *reg = cpuid_entry_get_reg(entry, x86_feature);\n\n\treturn *reg & __feature_bit(x86_feature);\n}"
  },
  {
    "function_name": "cpuid_entry_get_reg",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "119-125",
    "snippet": "static __always_inline u32 *cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\tunsigned int x86_feature)\n{\n\tconst struct cpuid_reg cpuid = x86_feature_cpuid(x86_feature);\n\n\treturn __cpuid_entry_get_reg(entry, cpuid.reg);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__cpuid_entry_get_reg",
          "args": [
            "entry",
            "cpuid.reg"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "__cpuid_entry_get_reg",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "101-117",
          "snippet": "static __always_inline u32 *__cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\t  u32 reg)\n{\n\tswitch (reg) {\n\tcase CPUID_EAX:\n\t\treturn &entry->eax;\n\tcase CPUID_EBX:\n\t\treturn &entry->ebx;\n\tcase CPUID_ECX:\n\t\treturn &entry->ecx;\n\tcase CPUID_EDX:\n\t\treturn &entry->edx;\n\tdefault:\n\t\tBUILD_BUG();\n\t\treturn NULL;\n\t}\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 *__cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\t  u32 reg)\n{\n\tswitch (reg) {\n\tcase CPUID_EAX:\n\t\treturn &entry->eax;\n\tcase CPUID_EBX:\n\t\treturn &entry->ebx;\n\tcase CPUID_ECX:\n\t\treturn &entry->ecx;\n\tcase CPUID_EDX:\n\t\treturn &entry->edx;\n\tdefault:\n\t\tBUILD_BUG();\n\t\treturn NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "x86_feature_cpuid",
          "args": [
            "x86_feature"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "x86_feature_cpuid",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "93-99",
          "snippet": "cpuid_reg x86_feature_cpuid(unsigned int x86_feature)\n{\n\tunsigned int x86_leaf = x86_feature / 32;\n\n\treverse_cpuid_check(x86_leaf);\n\treturn reverse_cpuid[x86_leaf];\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\ncpuid_reg x86_feature_cpuid(unsigned int x86_feature)\n{\n\tunsigned int x86_leaf = x86_feature / 32;\n\n\treverse_cpuid_check(x86_leaf);\n\treturn reverse_cpuid[x86_leaf];\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 *cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\tunsigned int x86_feature)\n{\n\tconst struct cpuid_reg cpuid = x86_feature_cpuid(x86_feature);\n\n\treturn __cpuid_entry_get_reg(entry, cpuid.reg);\n}"
  },
  {
    "function_name": "__cpuid_entry_get_reg",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "101-117",
    "snippet": "static __always_inline u32 *__cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\t  u32 reg)\n{\n\tswitch (reg) {\n\tcase CPUID_EAX:\n\t\treturn &entry->eax;\n\tcase CPUID_EBX:\n\t\treturn &entry->ebx;\n\tcase CPUID_ECX:\n\t\treturn &entry->ecx;\n\tcase CPUID_EDX:\n\t\treturn &entry->edx;\n\tdefault:\n\t\tBUILD_BUG();\n\t\treturn NULL;\n\t}\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUILD_BUG",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 *__cpuid_entry_get_reg(struct kvm_cpuid_entry2 *entry,\n\t\t\t\t\t\t  u32 reg)\n{\n\tswitch (reg) {\n\tcase CPUID_EAX:\n\t\treturn &entry->eax;\n\tcase CPUID_EBX:\n\t\treturn &entry->ebx;\n\tcase CPUID_ECX:\n\t\treturn &entry->ecx;\n\tcase CPUID_EDX:\n\t\treturn &entry->edx;\n\tdefault:\n\t\tBUILD_BUG();\n\t\treturn NULL;\n\t}\n}"
  },
  {
    "function_name": "x86_feature_cpuid",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "93-99",
    "snippet": "cpuid_reg x86_feature_cpuid(unsigned int x86_feature)\n{\n\tunsigned int x86_leaf = x86_feature / 32;\n\n\treverse_cpuid_check(x86_leaf);\n\treturn reverse_cpuid[x86_leaf];\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reverse_cpuid_check",
          "args": [
            "x86_leaf"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "reverse_cpuid_check",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "69-77",
          "snippet": "static __always_inline void reverse_cpuid_check(unsigned int x86_leaf)\n{\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_1);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_2);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_3);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_4);\n\tBUILD_BUG_ON(x86_leaf >= ARRAY_SIZE(reverse_cpuid));\n\tBUILD_BUG_ON(reverse_cpuid[x86_leaf].function == 0);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline void reverse_cpuid_check(unsigned int x86_leaf)\n{\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_1);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_2);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_3);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_4);\n\tBUILD_BUG_ON(x86_leaf >= ARRAY_SIZE(reverse_cpuid));\n\tBUILD_BUG_ON(reverse_cpuid[x86_leaf].function == 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\ncpuid_reg x86_feature_cpuid(unsigned int x86_feature)\n{\n\tunsigned int x86_leaf = x86_feature / 32;\n\n\treverse_cpuid_check(x86_leaf);\n\treturn reverse_cpuid[x86_leaf];\n}"
  },
  {
    "function_name": "__feature_bit",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "85-89",
    "snippet": "static __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reverse_cpuid_check",
          "args": [
            "x86_feature / 32"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "reverse_cpuid_check",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
          "lines": "69-77",
          "snippet": "static __always_inline void reverse_cpuid_check(unsigned int x86_leaf)\n{\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_1);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_2);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_3);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_4);\n\tBUILD_BUG_ON(x86_leaf >= ARRAY_SIZE(reverse_cpuid));\n\tBUILD_BUG_ON(reverse_cpuid[x86_leaf].function == 0);\n}",
          "includes": [
            "#include <asm/processor.h>",
            "#include <asm/cpu.h>",
            "#include \"x86.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline void reverse_cpuid_check(unsigned int x86_leaf)\n{\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_1);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_2);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_3);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_4);\n\tBUILD_BUG_ON(x86_leaf >= ARRAY_SIZE(reverse_cpuid));\n\tBUILD_BUG_ON(reverse_cpuid[x86_leaf].function == 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline u32 __feature_bit(int x86_feature)\n{\n\treverse_cpuid_check(x86_feature / 32);\n\treturn 1 << (x86_feature & 31);\n}"
  },
  {
    "function_name": "reverse_cpuid_check",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "69-77",
    "snippet": "static __always_inline void reverse_cpuid_check(unsigned int x86_leaf)\n{\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_1);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_2);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_3);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_4);\n\tBUILD_BUG_ON(x86_leaf >= ARRAY_SIZE(reverse_cpuid));\n\tBUILD_BUG_ON(reverse_cpuid[x86_leaf].function == 0);\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "reverse_cpuid[x86_leaf].function == 0"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "x86_leaf >= ARRAY_SIZE(reverse_cpuid)"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "reverse_cpuid"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "x86_leaf == CPUID_LNX_4"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "x86_leaf == CPUID_LNX_3"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "x86_leaf == CPUID_LNX_2"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "x86_leaf == CPUID_LNX_1"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic __always_inline void reverse_cpuid_check(unsigned int x86_leaf)\n{\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_1);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_2);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_3);\n\tBUILD_BUG_ON(x86_leaf == CPUID_LNX_4);\n\tBUILD_BUG_ON(x86_leaf >= ARRAY_SIZE(reverse_cpuid));\n\tBUILD_BUG_ON(reverse_cpuid[x86_leaf].function == 0);\n}"
  },
  {
    "function_name": "cpuid_maxphyaddr",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/cpuid.h",
    "lines": "32-35",
    "snippet": "static inline int cpuid_maxphyaddr(struct kvm_vcpu *vcpu)\n{\n\treturn vcpu->arch.maxphyaddr;\n}",
    "includes": [
      "#include <asm/processor.h>",
      "#include <asm/cpu.h>",
      "#include \"x86.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/processor.h>\n#include <asm/cpu.h>\n#include \"x86.h\"\n\nstatic inline int cpuid_maxphyaddr(struct kvm_vcpu *vcpu)\n{\n\treturn vcpu->arch.maxphyaddr;\n}"
  }
]