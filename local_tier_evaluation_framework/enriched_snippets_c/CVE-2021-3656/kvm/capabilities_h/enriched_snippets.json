[
  {
    "function_name": "vmx_pt_mode_is_host_guest",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "365-368",
    "snippet": "static inline bool vmx_pt_mode_is_host_guest(void)\n{\n\treturn pt_mode == PT_MODE_HOST_GUEST;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [
      "#define PT_MODE_HOST_GUEST\t1"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\n#define PT_MODE_HOST_GUEST\t1\n\nstatic inline bool vmx_pt_mode_is_host_guest(void)\n{\n\treturn pt_mode == PT_MODE_HOST_GUEST;\n}"
  },
  {
    "function_name": "vmx_pt_mode_is_system",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "361-364",
    "snippet": "static inline bool vmx_pt_mode_is_system(void)\n{\n\treturn pt_mode == PT_MODE_SYSTEM;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [
      "#define PT_MODE_SYSTEM\t\t0"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\n#define PT_MODE_SYSTEM\t\t0\n\nstatic inline bool vmx_pt_mode_is_system(void)\n{\n\treturn pt_mode == PT_MODE_SYSTEM;\n}"
  },
  {
    "function_name": "cpu_has_vmx_intel_pt",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "341-350",
    "snippet": "static inline bool cpu_has_vmx_intel_pt(void)\n{\n\tu64 vmx_msr;\n\n\trdmsrl(MSR_IA32_VMX_MISC, vmx_msr);\n\treturn (vmx_msr & MSR_IA32_VMX_MISC_INTEL_PT) &&\n\t\t(vmcs_config.cpu_based_2nd_exec_ctrl & SECONDARY_EXEC_PT_USE_GPA) &&\n\t\t(vmcs_config.vmexit_ctrl & VM_EXIT_CLEAR_IA32_RTIT_CTL) &&\n\t\t(vmcs_config.vmentry_ctrl & VM_ENTRY_LOAD_IA32_RTIT_CTL);\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rdmsrl",
          "args": [
            "MSR_IA32_VMX_MISC",
            "vmx_msr"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_intel_pt(void)\n{\n\tu64 vmx_msr;\n\n\trdmsrl(MSR_IA32_VMX_MISC, vmx_msr);\n\treturn (vmx_msr & MSR_IA32_VMX_MISC_INTEL_PT) &&\n\t\t(vmcs_config.cpu_based_2nd_exec_ctrl & SECONDARY_EXEC_PT_USE_GPA) &&\n\t\t(vmcs_config.vmexit_ctrl & VM_EXIT_CLEAR_IA32_RTIT_CTL) &&\n\t\t(vmcs_config.vmentry_ctrl & VM_ENTRY_LOAD_IA32_RTIT_CTL);\n}"
  },
  {
    "function_name": "cpu_has_vmx_invvpid_global",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "336-339",
    "snippet": "static inline bool cpu_has_vmx_invvpid_global(void)\n{\n\treturn vmx_capability.vpid & VMX_VPID_EXTENT_GLOBAL_CONTEXT_BIT;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_invvpid_global(void)\n{\n\treturn vmx_capability.vpid & VMX_VPID_EXTENT_GLOBAL_CONTEXT_BIT;\n}"
  },
  {
    "function_name": "cpu_has_vmx_invvpid_single",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "331-334",
    "snippet": "static inline bool cpu_has_vmx_invvpid_single(void)\n{\n\treturn vmx_capability.vpid & VMX_VPID_EXTENT_SINGLE_CONTEXT_BIT;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_invvpid_single(void)\n{\n\treturn vmx_capability.vpid & VMX_VPID_EXTENT_SINGLE_CONTEXT_BIT;\n}"
  },
  {
    "function_name": "cpu_has_vmx_invvpid_individual_addr",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "326-329",
    "snippet": "static inline bool cpu_has_vmx_invvpid_individual_addr(void)\n{\n\treturn vmx_capability.vpid & VMX_VPID_EXTENT_INDIVIDUAL_ADDR_BIT;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_invvpid_individual_addr(void)\n{\n\treturn vmx_capability.vpid & VMX_VPID_EXTENT_INDIVIDUAL_ADDR_BIT;\n}"
  },
  {
    "function_name": "cpu_has_vmx_invvpid",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "321-324",
    "snippet": "static inline bool cpu_has_vmx_invvpid(void)\n{\n\treturn vmx_capability.vpid & VMX_VPID_INVVPID_BIT;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_invvpid(void)\n{\n\treturn vmx_capability.vpid & VMX_VPID_INVVPID_BIT;\n}"
  },
  {
    "function_name": "cpu_has_vmx_invept_global",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "316-319",
    "snippet": "static inline bool cpu_has_vmx_invept_global(void)\n{\n\treturn vmx_capability.ept & VMX_EPT_EXTENT_GLOBAL_BIT;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_invept_global(void)\n{\n\treturn vmx_capability.ept & VMX_EPT_EXTENT_GLOBAL_BIT;\n}"
  },
  {
    "function_name": "cpu_has_vmx_invept_context",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "311-314",
    "snippet": "static inline bool cpu_has_vmx_invept_context(void)\n{\n\treturn vmx_capability.ept & VMX_EPT_EXTENT_CONTEXT_BIT;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_invept_context(void)\n{\n\treturn vmx_capability.ept & VMX_EPT_EXTENT_CONTEXT_BIT;\n}"
  },
  {
    "function_name": "cpu_has_vmx_ept_ad_bits",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "306-309",
    "snippet": "static inline bool cpu_has_vmx_ept_ad_bits(void)\n{\n\treturn vmx_capability.ept & VMX_EPT_AD_BIT;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_ept_ad_bits(void)\n{\n\treturn vmx_capability.ept & VMX_EPT_AD_BIT;\n}"
  },
  {
    "function_name": "cpu_has_vmx_ept_1g_page",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "301-304",
    "snippet": "static inline bool cpu_has_vmx_ept_1g_page(void)\n{\n\treturn vmx_capability.ept & VMX_EPT_1GB_PAGE_BIT;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_ept_1g_page(void)\n{\n\treturn vmx_capability.ept & VMX_EPT_1GB_PAGE_BIT;\n}"
  },
  {
    "function_name": "cpu_has_vmx_ept_2m_page",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "296-299",
    "snippet": "static inline bool cpu_has_vmx_ept_2m_page(void)\n{\n\treturn vmx_capability.ept & VMX_EPT_2MB_PAGE_BIT;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_ept_2m_page(void)\n{\n\treturn vmx_capability.ept & VMX_EPT_2MB_PAGE_BIT;\n}"
  },
  {
    "function_name": "cpu_has_vmx_ept_mt_wb",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "291-294",
    "snippet": "static inline bool cpu_has_vmx_ept_mt_wb(void)\n{\n\treturn vmx_capability.ept & VMX_EPTP_WB_BIT;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_ept_mt_wb(void)\n{\n\treturn vmx_capability.ept & VMX_EPTP_WB_BIT;\n}"
  },
  {
    "function_name": "cpu_has_vmx_ept_5levels",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "286-289",
    "snippet": "static inline bool cpu_has_vmx_ept_5levels(void)\n{\n\treturn vmx_capability.ept & VMX_EPT_PAGE_WALK_5_BIT;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_ept_5levels(void)\n{\n\treturn vmx_capability.ept & VMX_EPT_PAGE_WALK_5_BIT;\n}"
  },
  {
    "function_name": "cpu_has_vmx_ept_4levels",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "281-284",
    "snippet": "static inline bool cpu_has_vmx_ept_4levels(void)\n{\n\treturn vmx_capability.ept & VMX_EPT_PAGE_WALK_4_BIT;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_ept_4levels(void)\n{\n\treturn vmx_capability.ept & VMX_EPT_PAGE_WALK_4_BIT;\n}"
  },
  {
    "function_name": "cpu_has_vmx_ept_execute_only",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "276-279",
    "snippet": "static inline bool cpu_has_vmx_ept_execute_only(void)\n{\n\treturn vmx_capability.ept & VMX_EPT_EXECUTE_ONLY_BIT;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_ept_execute_only(void)\n{\n\treturn vmx_capability.ept & VMX_EPT_EXECUTE_ONLY_BIT;\n}"
  },
  {
    "function_name": "cpu_has_vmx_flexpriority",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "270-274",
    "snippet": "static inline bool cpu_has_vmx_flexpriority(void)\n{\n\treturn cpu_has_vmx_tpr_shadow() &&\n\t\tcpu_has_vmx_virtualize_apic_accesses();\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_has_vmx_virtualize_apic_accesses",
          "args": [],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_has_vmx_virtualize_apic_accesses",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
          "lines": "131-135",
          "snippet": "static inline bool cpu_has_vmx_virtualize_apic_accesses(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_VIRTUALIZE_APIC_ACCESSES;\n}",
          "includes": [
            "#include \"lapic.h\"",
            "#include <asm/vmx.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_virtualize_apic_accesses(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_VIRTUALIZE_APIC_ACCESSES;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_has_vmx_tpr_shadow",
          "args": [],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_has_vmx_tpr_shadow",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
          "lines": "110-113",
          "snippet": "static inline bool cpu_has_vmx_tpr_shadow(void)\n{\n\treturn vmcs_config.cpu_based_exec_ctrl & CPU_BASED_TPR_SHADOW;\n}",
          "includes": [
            "#include \"lapic.h\"",
            "#include <asm/vmx.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_tpr_shadow(void)\n{\n\treturn vmcs_config.cpu_based_exec_ctrl & CPU_BASED_TPR_SHADOW;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_flexpriority(void)\n{\n\treturn cpu_has_vmx_tpr_shadow() &&\n\t\tcpu_has_vmx_virtualize_apic_accesses();\n}"
  },
  {
    "function_name": "cpu_has_vmx_apicv",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "263-268",
    "snippet": "static inline bool cpu_has_vmx_apicv(void)\n{\n\treturn cpu_has_vmx_apic_register_virt() &&\n\t\tcpu_has_vmx_virtual_intr_delivery() &&\n\t\tcpu_has_vmx_posted_intr();\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_has_vmx_posted_intr",
          "args": [],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_has_vmx_posted_intr",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
          "lines": "86-90",
          "snippet": "static inline bool cpu_has_vmx_posted_intr(void)\n{\n\treturn IS_ENABLED(CONFIG_X86_LOCAL_APIC) &&\n\t\tvmcs_config.pin_based_exec_ctrl & PIN_BASED_POSTED_INTR;\n}",
          "includes": [
            "#include \"lapic.h\"",
            "#include <asm/vmx.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_posted_intr(void)\n{\n\treturn IS_ENABLED(CONFIG_X86_LOCAL_APIC) &&\n\t\tvmcs_config.pin_based_exec_ctrl & PIN_BASED_POSTED_INTR;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_has_vmx_virtual_intr_delivery",
          "args": [],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_has_vmx_virtual_intr_delivery",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
          "lines": "185-189",
          "snippet": "static inline bool cpu_has_vmx_virtual_intr_delivery(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_VIRTUAL_INTR_DELIVERY;\n}",
          "includes": [
            "#include \"lapic.h\"",
            "#include <asm/vmx.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_virtual_intr_delivery(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_VIRTUAL_INTR_DELIVERY;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_has_vmx_apic_register_virt",
          "args": [],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_has_vmx_apic_register_virt",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
          "lines": "179-183",
          "snippet": "static inline bool cpu_has_vmx_apic_register_virt(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_APIC_REGISTER_VIRT;\n}",
          "includes": [
            "#include \"lapic.h\"",
            "#include <asm/vmx.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_apic_register_virt(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_APIC_REGISTER_VIRT;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_apicv(void)\n{\n\treturn cpu_has_vmx_apic_register_virt() &&\n\t\tcpu_has_vmx_virtual_intr_delivery() &&\n\t\tcpu_has_vmx_posted_intr();\n}"
  },
  {
    "function_name": "cpu_has_vmx_tsc_scaling",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "257-261",
    "snippet": "static inline bool cpu_has_vmx_tsc_scaling(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_TSC_SCALING;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_tsc_scaling(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_TSC_SCALING;\n}"
  },
  {
    "function_name": "vmx_waitpkg_supported",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "251-255",
    "snippet": "static inline bool vmx_waitpkg_supported(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_ENABLE_USR_WAIT_PAUSE;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool vmx_waitpkg_supported(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_ENABLE_USR_WAIT_PAUSE;\n}"
  },
  {
    "function_name": "vmx_xsaves_supported",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "245-249",
    "snippet": "static inline bool vmx_xsaves_supported(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_XSAVES;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool vmx_xsaves_supported(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_XSAVES;\n}"
  },
  {
    "function_name": "cpu_has_vmx_pml",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "240-243",
    "snippet": "static inline bool cpu_has_vmx_pml(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl & SECONDARY_EXEC_ENABLE_PML;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_pml(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl & SECONDARY_EXEC_ENABLE_PML;\n}"
  },
  {
    "function_name": "vmx_rdseed_supported",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "234-238",
    "snippet": "static inline bool vmx_rdseed_supported(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_RDSEED_EXITING;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool vmx_rdseed_supported(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_RDSEED_EXITING;\n}"
  },
  {
    "function_name": "cpu_has_vmx_encls_vmexit",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "228-232",
    "snippet": "static inline bool cpu_has_vmx_encls_vmexit(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_ENCLS_EXITING;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_encls_vmexit(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_ENCLS_EXITING;\n}"
  },
  {
    "function_name": "cpu_has_vmx_shadow_vmcs",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "215-226",
    "snippet": "static inline bool cpu_has_vmx_shadow_vmcs(void)\n{\n\tu64 vmx_msr;\n\n\t/* check if the cpu supports writing r/o exit information fields */\n\trdmsrl(MSR_IA32_VMX_MISC, vmx_msr);\n\tif (!(vmx_msr & MSR_IA32_VMX_MISC_VMWRITE_SHADOW_RO_FIELDS))\n\t\treturn false;\n\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_SHADOW_VMCS;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rdmsrl",
          "args": [
            "MSR_IA32_VMX_MISC",
            "vmx_msr"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_shadow_vmcs(void)\n{\n\tu64 vmx_msr;\n\n\t/* check if the cpu supports writing r/o exit information fields */\n\trdmsrl(MSR_IA32_VMX_MISC, vmx_msr);\n\tif (!(vmx_msr & MSR_IA32_VMX_MISC_VMWRITE_SHADOW_RO_FIELDS))\n\t\treturn false;\n\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_SHADOW_VMCS;\n}"
  },
  {
    "function_name": "cpu_has_vmx_vmfunc",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "209-213",
    "snippet": "static inline bool cpu_has_vmx_vmfunc(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_ENABLE_VMFUNC;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_vmfunc(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_ENABLE_VMFUNC;\n}"
  },
  {
    "function_name": "cpu_has_vmx_invpcid",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "203-207",
    "snippet": "static inline bool cpu_has_vmx_invpcid(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_ENABLE_INVPCID;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_invpcid(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_ENABLE_INVPCID;\n}"
  },
  {
    "function_name": "vmx_rdrand_supported",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "197-201",
    "snippet": "static inline bool vmx_rdrand_supported(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_RDRAND_EXITING;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool vmx_rdrand_supported(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_RDRAND_EXITING;\n}"
  },
  {
    "function_name": "cpu_has_vmx_ple",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "191-195",
    "snippet": "static inline bool cpu_has_vmx_ple(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_PAUSE_LOOP_EXITING;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_ple(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_PAUSE_LOOP_EXITING;\n}"
  },
  {
    "function_name": "cpu_has_vmx_virtual_intr_delivery",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "185-189",
    "snippet": "static inline bool cpu_has_vmx_virtual_intr_delivery(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_VIRTUAL_INTR_DELIVERY;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_virtual_intr_delivery(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_VIRTUAL_INTR_DELIVERY;\n}"
  },
  {
    "function_name": "cpu_has_vmx_apic_register_virt",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "179-183",
    "snippet": "static inline bool cpu_has_vmx_apic_register_virt(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_APIC_REGISTER_VIRT;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_apic_register_virt(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_APIC_REGISTER_VIRT;\n}"
  },
  {
    "function_name": "cpu_has_vmx_unrestricted_guest",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "173-177",
    "snippet": "static inline bool cpu_has_vmx_unrestricted_guest(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_UNRESTRICTED_GUEST;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_unrestricted_guest(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_UNRESTRICTED_GUEST;\n}"
  },
  {
    "function_name": "cpu_has_vmx_wbinvd_exit",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "167-171",
    "snippet": "static inline bool cpu_has_vmx_wbinvd_exit(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_WBINVD_EXITING;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_wbinvd_exit(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_WBINVD_EXITING;\n}"
  },
  {
    "function_name": "cpu_has_vmx_vpid",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "161-165",
    "snippet": "static inline bool cpu_has_vmx_vpid(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_ENABLE_VPID;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_vpid(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_ENABLE_VPID;\n}"
  },
  {
    "function_name": "cpu_has_vmx_virtualize_x2apic_mode",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "155-159",
    "snippet": "static inline bool cpu_has_vmx_virtualize_x2apic_mode(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_VIRTUALIZE_X2APIC_MODE;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_virtualize_x2apic_mode(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_VIRTUALIZE_X2APIC_MODE;\n}"
  },
  {
    "function_name": "cpu_has_vmx_rdtscp",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "149-153",
    "snippet": "static inline bool cpu_has_vmx_rdtscp(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_RDTSCP;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_rdtscp(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_RDTSCP;\n}"
  },
  {
    "function_name": "vmx_umip_emulated",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "143-147",
    "snippet": "static inline bool vmx_umip_emulated(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_DESC;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool vmx_umip_emulated(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_DESC;\n}"
  },
  {
    "function_name": "cpu_has_vmx_ept",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "137-141",
    "snippet": "static inline bool cpu_has_vmx_ept(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_ENABLE_EPT;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_ept(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_ENABLE_EPT;\n}"
  },
  {
    "function_name": "cpu_has_vmx_virtualize_apic_accesses",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "131-135",
    "snippet": "static inline bool cpu_has_vmx_virtualize_apic_accesses(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_VIRTUALIZE_APIC_ACCESSES;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_virtualize_apic_accesses(void)\n{\n\treturn vmcs_config.cpu_based_2nd_exec_ctrl &\n\t\tSECONDARY_EXEC_VIRTUALIZE_APIC_ACCESSES;\n}"
  },
  {
    "function_name": "cpu_has_secondary_exec_ctrls",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "125-129",
    "snippet": "static inline bool cpu_has_secondary_exec_ctrls(void)\n{\n\treturn vmcs_config.cpu_based_exec_ctrl &\n\t\tCPU_BASED_ACTIVATE_SECONDARY_CONTROLS;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_secondary_exec_ctrls(void)\n{\n\treturn vmcs_config.cpu_based_exec_ctrl &\n\t\tCPU_BASED_ACTIVATE_SECONDARY_CONTROLS;\n}"
  },
  {
    "function_name": "cpu_has_vmx_msr_bitmap",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "120-123",
    "snippet": "static inline bool cpu_has_vmx_msr_bitmap(void)\n{\n\treturn vmcs_config.cpu_based_exec_ctrl & CPU_BASED_USE_MSR_BITMAPS;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_msr_bitmap(void)\n{\n\treturn vmcs_config.cpu_based_exec_ctrl & CPU_BASED_USE_MSR_BITMAPS;\n}"
  },
  {
    "function_name": "cpu_need_tpr_shadow",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "115-118",
    "snippet": "static inline bool cpu_need_tpr_shadow(struct kvm_vcpu *vcpu)\n{\n\treturn cpu_has_vmx_tpr_shadow() && lapic_in_kernel(vcpu);\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lapic_in_kernel",
          "args": [
            "vcpu"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "lapic_in_kernel",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/lapic.h",
          "lines": "168-173",
          "snippet": "static inline bool lapic_in_kernel(struct kvm_vcpu *vcpu)\n{\n\tif (static_key_false(&kvm_no_apic_vcpu))\n\t\treturn vcpu->arch.apic;\n\treturn true;\n}",
          "includes": [
            "#include <linux/kvm_host.h>",
            "#include <kvm/iodev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_host.h>\n#include <kvm/iodev.h>\n\nstatic inline bool lapic_in_kernel(struct kvm_vcpu *vcpu)\n{\n\tif (static_key_false(&kvm_no_apic_vcpu))\n\t\treturn vcpu->arch.apic;\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_has_vmx_tpr_shadow",
          "args": [],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_has_vmx_tpr_shadow",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
          "lines": "110-113",
          "snippet": "static inline bool cpu_has_vmx_tpr_shadow(void)\n{\n\treturn vmcs_config.cpu_based_exec_ctrl & CPU_BASED_TPR_SHADOW;\n}",
          "includes": [
            "#include \"lapic.h\"",
            "#include <asm/vmx.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_tpr_shadow(void)\n{\n\treturn vmcs_config.cpu_based_exec_ctrl & CPU_BASED_TPR_SHADOW;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_need_tpr_shadow(struct kvm_vcpu *vcpu)\n{\n\treturn cpu_has_vmx_tpr_shadow() && lapic_in_kernel(vcpu);\n}"
  },
  {
    "function_name": "cpu_has_vmx_tpr_shadow",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "110-113",
    "snippet": "static inline bool cpu_has_vmx_tpr_shadow(void)\n{\n\treturn vmcs_config.cpu_based_exec_ctrl & CPU_BASED_TPR_SHADOW;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_tpr_shadow(void)\n{\n\treturn vmcs_config.cpu_based_exec_ctrl & CPU_BASED_TPR_SHADOW;\n}"
  },
  {
    "function_name": "cpu_has_vmx_mpx",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "104-108",
    "snippet": "static inline bool cpu_has_vmx_mpx(void)\n{\n\treturn (vmcs_config.vmexit_ctrl & VM_EXIT_CLEAR_BNDCFGS) &&\n\t\t(vmcs_config.vmentry_ctrl & VM_ENTRY_LOAD_BNDCFGS);\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_mpx(void)\n{\n\treturn (vmcs_config.vmexit_ctrl & VM_EXIT_CLEAR_BNDCFGS) &&\n\t\t(vmcs_config.vmentry_ctrl & VM_ENTRY_LOAD_BNDCFGS);\n}"
  },
  {
    "function_name": "cpu_has_load_perf_global_ctrl",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "98-102",
    "snippet": "static inline bool cpu_has_load_perf_global_ctrl(void)\n{\n\treturn (vmcs_config.vmentry_ctrl & VM_ENTRY_LOAD_IA32_PERF_GLOBAL_CTRL) &&\n\t       (vmcs_config.vmexit_ctrl & VM_EXIT_LOAD_IA32_PERF_GLOBAL_CTRL);\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_load_perf_global_ctrl(void)\n{\n\treturn (vmcs_config.vmentry_ctrl & VM_ENTRY_LOAD_IA32_PERF_GLOBAL_CTRL) &&\n\t       (vmcs_config.vmexit_ctrl & VM_EXIT_LOAD_IA32_PERF_GLOBAL_CTRL);\n}"
  },
  {
    "function_name": "cpu_has_load_ia32_efer",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "92-96",
    "snippet": "static inline bool cpu_has_load_ia32_efer(void)\n{\n\treturn (vmcs_config.vmentry_ctrl & VM_ENTRY_LOAD_IA32_EFER) &&\n\t       (vmcs_config.vmexit_ctrl & VM_EXIT_LOAD_IA32_EFER);\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_load_ia32_efer(void)\n{\n\treturn (vmcs_config.vmentry_ctrl & VM_ENTRY_LOAD_IA32_EFER) &&\n\t       (vmcs_config.vmexit_ctrl & VM_EXIT_LOAD_IA32_EFER);\n}"
  },
  {
    "function_name": "cpu_has_vmx_posted_intr",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "86-90",
    "snippet": "static inline bool cpu_has_vmx_posted_intr(void)\n{\n\treturn IS_ENABLED(CONFIG_X86_LOCAL_APIC) &&\n\t\tvmcs_config.pin_based_exec_ctrl & PIN_BASED_POSTED_INTR;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_X86_LOCAL_APIC"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_posted_intr(void)\n{\n\treturn IS_ENABLED(CONFIG_X86_LOCAL_APIC) &&\n\t\tvmcs_config.pin_based_exec_ctrl & PIN_BASED_POSTED_INTR;\n}"
  },
  {
    "function_name": "cpu_has_vmx_preemption_timer",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "80-84",
    "snippet": "static inline bool cpu_has_vmx_preemption_timer(void)\n{\n\treturn vmcs_config.pin_based_exec_ctrl &\n\t\tPIN_BASED_VMX_PREEMPTION_TIMER;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_preemption_timer(void)\n{\n\treturn vmcs_config.pin_based_exec_ctrl &\n\t\tPIN_BASED_VMX_PREEMPTION_TIMER;\n}"
  },
  {
    "function_name": "cpu_has_virtual_nmis",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "75-78",
    "snippet": "static inline bool cpu_has_virtual_nmis(void)\n{\n\treturn vmcs_config.pin_based_exec_ctrl & PIN_BASED_VIRTUAL_NMIS;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_virtual_nmis(void)\n{\n\treturn vmcs_config.pin_based_exec_ctrl & PIN_BASED_VIRTUAL_NMIS;\n}"
  },
  {
    "function_name": "cpu_has_vmx_basic_inout",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/capabilities.h",
    "lines": "70-73",
    "snippet": "static inline bool cpu_has_vmx_basic_inout(void)\n{\n\treturn\t(((u64)vmcs_config.basic_cap << 32) & VMX_BASIC_INOUT);\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <asm/vmx.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <asm/vmx.h>\n\nstatic inline bool cpu_has_vmx_basic_inout(void)\n{\n\treturn\t(((u64)vmcs_config.basic_cap << 32) & VMX_BASIC_INOUT);\n}"
  }
]