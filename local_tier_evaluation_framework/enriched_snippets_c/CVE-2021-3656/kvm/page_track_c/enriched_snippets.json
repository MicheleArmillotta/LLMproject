[
  {
    "function_name": "kvm_page_track_flush_slot",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
    "lines": "245-261",
    "snippet": "void kvm_page_track_flush_slot(struct kvm *kvm, struct kvm_memory_slot *slot)\n{\n\tstruct kvm_page_track_notifier_head *head;\n\tstruct kvm_page_track_notifier_node *n;\n\tint idx;\n\n\thead = &kvm->arch.track_notifier_head;\n\n\tif (hlist_empty(&head->track_notifier_list))\n\t\treturn;\n\n\tidx = srcu_read_lock(&head->track_srcu);\n\thlist_for_each_entry_rcu(n, &head->track_notifier_list, node)\n\t\tif (n->track_flush_slot)\n\t\t\tn->track_flush_slot(kvm, slot, n);\n\tsrcu_read_unlock(&head->track_srcu, idx);\n}",
    "includes": [
      "#include \"mmu.h\"",
      "#include <asm/kvm_page_track.h>",
      "#include <linux/rculist.h>",
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "srcu_read_unlock",
          "args": [
            "&head->track_srcu",
            "idx"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "n->track_flush_slot",
          "args": [
            "kvm",
            "slot",
            "n"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_for_each_entry_rcu",
          "args": [
            "n",
            "&head->track_notifier_list",
            "node"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "srcu_read_lock",
          "args": [
            "&head->track_srcu"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_empty",
          "args": [
            "&head->track_notifier_list"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nvoid kvm_page_track_flush_slot(struct kvm *kvm, struct kvm_memory_slot *slot)\n{\n\tstruct kvm_page_track_notifier_head *head;\n\tstruct kvm_page_track_notifier_node *n;\n\tint idx;\n\n\thead = &kvm->arch.track_notifier_head;\n\n\tif (hlist_empty(&head->track_notifier_list))\n\t\treturn;\n\n\tidx = srcu_read_lock(&head->track_srcu);\n\thlist_for_each_entry_rcu(n, &head->track_notifier_list, node)\n\t\tif (n->track_flush_slot)\n\t\t\tn->track_flush_slot(kvm, slot, n);\n\tsrcu_read_unlock(&head->track_srcu, idx);\n}"
  },
  {
    "function_name": "kvm_page_track_write",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
    "lines": "219-236",
    "snippet": "void kvm_page_track_write(struct kvm_vcpu *vcpu, gpa_t gpa, const u8 *new,\n\t\t\t  int bytes)\n{\n\tstruct kvm_page_track_notifier_head *head;\n\tstruct kvm_page_track_notifier_node *n;\n\tint idx;\n\n\thead = &vcpu->kvm->arch.track_notifier_head;\n\n\tif (hlist_empty(&head->track_notifier_list))\n\t\treturn;\n\n\tidx = srcu_read_lock(&head->track_srcu);\n\thlist_for_each_entry_rcu(n, &head->track_notifier_list, node)\n\t\tif (n->track_write)\n\t\t\tn->track_write(vcpu, gpa, new, bytes, n);\n\tsrcu_read_unlock(&head->track_srcu, idx);\n}",
    "includes": [
      "#include \"mmu.h\"",
      "#include <asm/kvm_page_track.h>",
      "#include <linux/rculist.h>",
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "srcu_read_unlock",
          "args": [
            "&head->track_srcu",
            "idx"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "n->track_write",
          "args": [
            "vcpu",
            "gpa",
            "new",
            "bytes",
            "n"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_for_each_entry_rcu",
          "args": [
            "n",
            "&head->track_notifier_list",
            "node"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "srcu_read_lock",
          "args": [
            "&head->track_srcu"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_empty",
          "args": [
            "&head->track_notifier_list"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nvoid kvm_page_track_write(struct kvm_vcpu *vcpu, gpa_t gpa, const u8 *new,\n\t\t\t  int bytes)\n{\n\tstruct kvm_page_track_notifier_head *head;\n\tstruct kvm_page_track_notifier_node *n;\n\tint idx;\n\n\thead = &vcpu->kvm->arch.track_notifier_head;\n\n\tif (hlist_empty(&head->track_notifier_list))\n\t\treturn;\n\n\tidx = srcu_read_lock(&head->track_srcu);\n\thlist_for_each_entry_rcu(n, &head->track_notifier_list, node)\n\t\tif (n->track_write)\n\t\t\tn->track_write(vcpu, gpa, new, bytes, n);\n\tsrcu_read_unlock(&head->track_srcu, idx);\n}"
  },
  {
    "function_name": "kvm_page_track_unregister_notifier",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
    "lines": "197-209",
    "snippet": "void\nkvm_page_track_unregister_notifier(struct kvm *kvm,\n\t\t\t\t   struct kvm_page_track_notifier_node *n)\n{\n\tstruct kvm_page_track_notifier_head *head;\n\n\thead = &kvm->arch.track_notifier_head;\n\n\tspin_lock(&kvm->mmu_lock);\n\thlist_del_rcu(&n->node);\n\tspin_unlock(&kvm->mmu_lock);\n\tsynchronize_srcu(&head->track_srcu);\n}",
    "includes": [
      "#include \"mmu.h\"",
      "#include <asm/kvm_page_track.h>",
      "#include <linux/rculist.h>",
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "synchronize_srcu",
          "args": [
            "&head->track_srcu"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&kvm->mmu_lock"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_del_rcu",
          "args": [
            "&n->node"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&kvm->mmu_lock"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nvoid\nkvm_page_track_unregister_notifier(struct kvm *kvm,\n\t\t\t\t   struct kvm_page_track_notifier_node *n)\n{\n\tstruct kvm_page_track_notifier_head *head;\n\n\thead = &kvm->arch.track_notifier_head;\n\n\tspin_lock(&kvm->mmu_lock);\n\thlist_del_rcu(&n->node);\n\tspin_unlock(&kvm->mmu_lock);\n\tsynchronize_srcu(&head->track_srcu);\n}"
  },
  {
    "function_name": "kvm_page_track_register_notifier",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
    "lines": "179-190",
    "snippet": "void\nkvm_page_track_register_notifier(struct kvm *kvm,\n\t\t\t\t struct kvm_page_track_notifier_node *n)\n{\n\tstruct kvm_page_track_notifier_head *head;\n\n\thead = &kvm->arch.track_notifier_head;\n\n\tspin_lock(&kvm->mmu_lock);\n\thlist_add_head_rcu(&n->node, &head->track_notifier_list);\n\tspin_unlock(&kvm->mmu_lock);\n}",
    "includes": [
      "#include \"mmu.h\"",
      "#include <asm/kvm_page_track.h>",
      "#include <linux/rculist.h>",
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&kvm->mmu_lock"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_add_head_rcu",
          "args": [
            "&n->node",
            "&head->track_notifier_list"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&kvm->mmu_lock"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nvoid\nkvm_page_track_register_notifier(struct kvm *kvm,\n\t\t\t\t struct kvm_page_track_notifier_node *n)\n{\n\tstruct kvm_page_track_notifier_head *head;\n\n\thead = &kvm->arch.track_notifier_head;\n\n\tspin_lock(&kvm->mmu_lock);\n\thlist_add_head_rcu(&n->node, &head->track_notifier_list);\n\tspin_unlock(&kvm->mmu_lock);\n}"
  },
  {
    "function_name": "kvm_page_track_init",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
    "lines": "166-173",
    "snippet": "void kvm_page_track_init(struct kvm *kvm)\n{\n\tstruct kvm_page_track_notifier_head *head;\n\n\thead = &kvm->arch.track_notifier_head;\n\tinit_srcu_struct(&head->track_srcu);\n\tINIT_HLIST_HEAD(&head->track_notifier_list);\n}",
    "includes": [
      "#include \"mmu.h\"",
      "#include <asm/kvm_page_track.h>",
      "#include <linux/rculist.h>",
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_HLIST_HEAD",
          "args": [
            "&head->track_notifier_list"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_srcu_struct",
          "args": [
            "&head->track_srcu"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nvoid kvm_page_track_init(struct kvm *kvm)\n{\n\tstruct kvm_page_track_notifier_head *head;\n\n\thead = &kvm->arch.track_notifier_head;\n\tinit_srcu_struct(&head->track_srcu);\n\tINIT_HLIST_HEAD(&head->track_notifier_list);\n}"
  },
  {
    "function_name": "kvm_page_track_cleanup",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
    "lines": "158-164",
    "snippet": "void kvm_page_track_cleanup(struct kvm *kvm)\n{\n\tstruct kvm_page_track_notifier_head *head;\n\n\thead = &kvm->arch.track_notifier_head;\n\tcleanup_srcu_struct(&head->track_srcu);\n}",
    "includes": [
      "#include \"mmu.h\"",
      "#include <asm/kvm_page_track.h>",
      "#include <linux/rculist.h>",
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cleanup_srcu_struct",
          "args": [
            "&head->track_srcu"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nvoid kvm_page_track_cleanup(struct kvm *kvm)\n{\n\tstruct kvm_page_track_notifier_head *head;\n\n\thead = &kvm->arch.track_notifier_head;\n\tcleanup_srcu_struct(&head->track_srcu);\n}"
  },
  {
    "function_name": "kvm_page_track_is_active",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
    "lines": "141-156",
    "snippet": "bool kvm_page_track_is_active(struct kvm_vcpu *vcpu, gfn_t gfn,\n\t\t\t      enum kvm_page_track_mode mode)\n{\n\tstruct kvm_memory_slot *slot;\n\tint index;\n\n\tif (WARN_ON(!page_track_mode_is_valid(mode)))\n\t\treturn false;\n\n\tslot = kvm_vcpu_gfn_to_memslot(vcpu, gfn);\n\tif (!slot)\n\t\treturn false;\n\n\tindex = gfn_to_index(gfn, slot->base_gfn, PT_PAGE_TABLE_LEVEL);\n\treturn !!READ_ONCE(slot->arch.gfn_track[mode][index]);\n}",
    "includes": [
      "#include \"mmu.h\"",
      "#include <asm/kvm_page_track.h>",
      "#include <linux/rculist.h>",
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "slot->arch.gfn_track[mode][index]"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfn_to_index",
          "args": [
            "gfn",
            "slot->base_gfn",
            "PT_PAGE_TABLE_LEVEL"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kvm_vcpu_gfn_to_memslot",
          "args": [
            "vcpu",
            "gfn"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!page_track_mode_is_valid(mode)"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_track_mode_is_valid",
          "args": [
            "mode"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "page_track_mode_is_valid",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
          "lines": "51-57",
          "snippet": "static inline bool page_track_mode_is_valid(enum kvm_page_track_mode mode)\n{\n\tif (mode < 0 || mode >= KVM_PAGE_TRACK_MAX)\n\t\treturn false;\n\n\treturn true;\n}",
          "includes": [
            "#include \"mmu.h\"",
            "#include <asm/kvm_page_track.h>",
            "#include <linux/rculist.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nstatic inline bool page_track_mode_is_valid(enum kvm_page_track_mode mode)\n{\n\tif (mode < 0 || mode >= KVM_PAGE_TRACK_MAX)\n\t\treturn false;\n\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nbool kvm_page_track_is_active(struct kvm_vcpu *vcpu, gfn_t gfn,\n\t\t\t      enum kvm_page_track_mode mode)\n{\n\tstruct kvm_memory_slot *slot;\n\tint index;\n\n\tif (WARN_ON(!page_track_mode_is_valid(mode)))\n\t\treturn false;\n\n\tslot = kvm_vcpu_gfn_to_memslot(vcpu, gfn);\n\tif (!slot)\n\t\treturn false;\n\n\tindex = gfn_to_index(gfn, slot->base_gfn, PT_PAGE_TABLE_LEVEL);\n\treturn !!READ_ONCE(slot->arch.gfn_track[mode][index]);\n}"
  },
  {
    "function_name": "kvm_slot_page_track_remove_page",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
    "lines": "121-135",
    "snippet": "void kvm_slot_page_track_remove_page(struct kvm *kvm,\n\t\t\t\t     struct kvm_memory_slot *slot, gfn_t gfn,\n\t\t\t\t     enum kvm_page_track_mode mode)\n{\n\tif (WARN_ON(!page_track_mode_is_valid(mode)))\n\t\treturn;\n\n\tupdate_gfn_track(slot, gfn, mode, -1);\n\n\t/*\n\t * allow large page mapping for the tracked page\n\t * after the tracker is gone.\n\t */\n\tkvm_mmu_gfn_allow_lpage(slot, gfn);\n}",
    "includes": [
      "#include \"mmu.h\"",
      "#include <asm/kvm_page_track.h>",
      "#include <linux/rculist.h>",
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_mmu_gfn_allow_lpage",
          "args": [
            "slot",
            "gfn"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_mmu_gfn_allow_lpage",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/mmu.c",
          "lines": "1211-1214",
          "snippet": "void kvm_mmu_gfn_allow_lpage(struct kvm_memory_slot *slot, gfn_t gfn)\n{\n\tupdate_gfn_disallow_lpage_count(slot, gfn, -1);\n}",
          "includes": [
            "#include \"paging_tmpl.h\"",
            "#include \"paging_tmpl.h\"",
            "#include \"paging_tmpl.h\"",
            "#include \"mmu_audit.c\"",
            "#include \"mmutrace.h\"",
            "#include <trace/events/kvm.h>",
            "#include \"trace.h\"",
            "#include <asm/kvm_page_track.h>",
            "#include <asm/vmx.h>",
            "#include <asm/io.h>",
            "#include <asm/e820/api.h>",
            "#include <asm/cmpxchg.h>",
            "#include <asm/memtype.h>",
            "#include <asm/page.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kern_levels.h>",
            "#include <linux/hash.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/srcu.h>",
            "#include <linux/compiler.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/kvm_host.h>",
            "#include \"cpuid.h\"",
            "#include \"kvm_emulate.h\"",
            "#include \"kvm_cache_regs.h\"",
            "#include \"x86.h\"",
            "#include \"mmu.h\"",
            "#include \"irq.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"paging_tmpl.h\"\n#include \"paging_tmpl.h\"\n#include \"paging_tmpl.h\"\n#include \"mmu_audit.c\"\n#include \"mmutrace.h\"\n#include <trace/events/kvm.h>\n#include \"trace.h\"\n#include <asm/kvm_page_track.h>\n#include <asm/vmx.h>\n#include <asm/io.h>\n#include <asm/e820/api.h>\n#include <asm/cmpxchg.h>\n#include <asm/memtype.h>\n#include <asm/page.h>\n#include <linux/kthread.h>\n#include <linux/kern_levels.h>\n#include <linux/hash.h>\n#include <linux/uaccess.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/srcu.h>\n#include <linux/compiler.h>\n#include <linux/hugetlb.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/moduleparam.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/kvm_host.h>\n#include \"cpuid.h\"\n#include \"kvm_emulate.h\"\n#include \"kvm_cache_regs.h\"\n#include \"x86.h\"\n#include \"mmu.h\"\n#include \"irq.h\"\n\nvoid kvm_mmu_gfn_allow_lpage(struct kvm_memory_slot *slot, gfn_t gfn)\n{\n\tupdate_gfn_disallow_lpage_count(slot, gfn, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "update_gfn_track",
          "args": [
            "slot",
            "gfn",
            "mode",
            "-1"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "update_gfn_track",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
          "lines": "59-72",
          "snippet": "static void update_gfn_track(struct kvm_memory_slot *slot, gfn_t gfn,\n\t\t\t     enum kvm_page_track_mode mode, short count)\n{\n\tint index, val;\n\n\tindex = gfn_to_index(gfn, slot->base_gfn, PT_PAGE_TABLE_LEVEL);\n\n\tval = slot->arch.gfn_track[mode][index];\n\n\tif (WARN_ON(val + count < 0 || val + count > USHRT_MAX))\n\t\treturn;\n\n\tslot->arch.gfn_track[mode][index] += count;\n}",
          "includes": [
            "#include \"mmu.h\"",
            "#include <asm/kvm_page_track.h>",
            "#include <linux/rculist.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nstatic void update_gfn_track(struct kvm_memory_slot *slot, gfn_t gfn,\n\t\t\t     enum kvm_page_track_mode mode, short count)\n{\n\tint index, val;\n\n\tindex = gfn_to_index(gfn, slot->base_gfn, PT_PAGE_TABLE_LEVEL);\n\n\tval = slot->arch.gfn_track[mode][index];\n\n\tif (WARN_ON(val + count < 0 || val + count > USHRT_MAX))\n\t\treturn;\n\n\tslot->arch.gfn_track[mode][index] += count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!page_track_mode_is_valid(mode)"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_track_mode_is_valid",
          "args": [
            "mode"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "page_track_mode_is_valid",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
          "lines": "51-57",
          "snippet": "static inline bool page_track_mode_is_valid(enum kvm_page_track_mode mode)\n{\n\tif (mode < 0 || mode >= KVM_PAGE_TRACK_MAX)\n\t\treturn false;\n\n\treturn true;\n}",
          "includes": [
            "#include \"mmu.h\"",
            "#include <asm/kvm_page_track.h>",
            "#include <linux/rculist.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nstatic inline bool page_track_mode_is_valid(enum kvm_page_track_mode mode)\n{\n\tif (mode < 0 || mode >= KVM_PAGE_TRACK_MAX)\n\t\treturn false;\n\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nvoid kvm_slot_page_track_remove_page(struct kvm *kvm,\n\t\t\t\t     struct kvm_memory_slot *slot, gfn_t gfn,\n\t\t\t\t     enum kvm_page_track_mode mode)\n{\n\tif (WARN_ON(!page_track_mode_is_valid(mode)))\n\t\treturn;\n\n\tupdate_gfn_track(slot, gfn, mode, -1);\n\n\t/*\n\t * allow large page mapping for the tracked page\n\t * after the tracker is gone.\n\t */\n\tkvm_mmu_gfn_allow_lpage(slot, gfn);\n}"
  },
  {
    "function_name": "kvm_slot_page_track_add_page",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
    "lines": "86-105",
    "snippet": "void kvm_slot_page_track_add_page(struct kvm *kvm,\n\t\t\t\t  struct kvm_memory_slot *slot, gfn_t gfn,\n\t\t\t\t  enum kvm_page_track_mode mode)\n{\n\n\tif (WARN_ON(!page_track_mode_is_valid(mode)))\n\t\treturn;\n\n\tupdate_gfn_track(slot, gfn, mode, 1);\n\n\t/*\n\t * new track stops large page mapping for the\n\t * tracked page.\n\t */\n\tkvm_mmu_gfn_disallow_lpage(slot, gfn);\n\n\tif (mode == KVM_PAGE_TRACK_WRITE)\n\t\tif (kvm_mmu_slot_gfn_write_protect(kvm, slot, gfn))\n\t\t\tkvm_flush_remote_tlbs(kvm);\n}",
    "includes": [
      "#include \"mmu.h\"",
      "#include <asm/kvm_page_track.h>",
      "#include <linux/rculist.h>",
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_flush_remote_tlbs",
          "args": [
            "kvm"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kvm_mmu_slot_gfn_write_protect",
          "args": [
            "kvm",
            "slot",
            "gfn"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_mmu_slot_gfn_write_protect",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/mmu.c",
          "lines": "1756-1769",
          "snippet": "bool kvm_mmu_slot_gfn_write_protect(struct kvm *kvm,\n\t\t\t\t    struct kvm_memory_slot *slot, u64 gfn)\n{\n\tstruct kvm_rmap_head *rmap_head;\n\tint i;\n\tbool write_protected = false;\n\n\tfor (i = PT_PAGE_TABLE_LEVEL; i <= PT_MAX_HUGEPAGE_LEVEL; ++i) {\n\t\trmap_head = __gfn_to_rmap(gfn, i, slot);\n\t\twrite_protected |= __rmap_write_protect(kvm, rmap_head, true);\n\t}\n\n\treturn write_protected;\n}",
          "includes": [
            "#include \"paging_tmpl.h\"",
            "#include \"paging_tmpl.h\"",
            "#include \"paging_tmpl.h\"",
            "#include \"mmu_audit.c\"",
            "#include \"mmutrace.h\"",
            "#include <trace/events/kvm.h>",
            "#include \"trace.h\"",
            "#include <asm/kvm_page_track.h>",
            "#include <asm/vmx.h>",
            "#include <asm/io.h>",
            "#include <asm/e820/api.h>",
            "#include <asm/cmpxchg.h>",
            "#include <asm/memtype.h>",
            "#include <asm/page.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kern_levels.h>",
            "#include <linux/hash.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/srcu.h>",
            "#include <linux/compiler.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/kvm_host.h>",
            "#include \"cpuid.h\"",
            "#include \"kvm_emulate.h\"",
            "#include \"kvm_cache_regs.h\"",
            "#include \"x86.h\"",
            "#include \"mmu.h\"",
            "#include \"irq.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"paging_tmpl.h\"\n#include \"paging_tmpl.h\"\n#include \"paging_tmpl.h\"\n#include \"mmu_audit.c\"\n#include \"mmutrace.h\"\n#include <trace/events/kvm.h>\n#include \"trace.h\"\n#include <asm/kvm_page_track.h>\n#include <asm/vmx.h>\n#include <asm/io.h>\n#include <asm/e820/api.h>\n#include <asm/cmpxchg.h>\n#include <asm/memtype.h>\n#include <asm/page.h>\n#include <linux/kthread.h>\n#include <linux/kern_levels.h>\n#include <linux/hash.h>\n#include <linux/uaccess.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/srcu.h>\n#include <linux/compiler.h>\n#include <linux/hugetlb.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/moduleparam.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/kvm_host.h>\n#include \"cpuid.h\"\n#include \"kvm_emulate.h\"\n#include \"kvm_cache_regs.h\"\n#include \"x86.h\"\n#include \"mmu.h\"\n#include \"irq.h\"\n\nbool kvm_mmu_slot_gfn_write_protect(struct kvm *kvm,\n\t\t\t\t    struct kvm_memory_slot *slot, u64 gfn)\n{\n\tstruct kvm_rmap_head *rmap_head;\n\tint i;\n\tbool write_protected = false;\n\n\tfor (i = PT_PAGE_TABLE_LEVEL; i <= PT_MAX_HUGEPAGE_LEVEL; ++i) {\n\t\trmap_head = __gfn_to_rmap(gfn, i, slot);\n\t\twrite_protected |= __rmap_write_protect(kvm, rmap_head, true);\n\t}\n\n\treturn write_protected;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kvm_mmu_gfn_disallow_lpage",
          "args": [
            "slot",
            "gfn"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_mmu_gfn_disallow_lpage",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/mmu.c",
          "lines": "1206-1209",
          "snippet": "void kvm_mmu_gfn_disallow_lpage(struct kvm_memory_slot *slot, gfn_t gfn)\n{\n\tupdate_gfn_disallow_lpage_count(slot, gfn, 1);\n}",
          "includes": [
            "#include \"paging_tmpl.h\"",
            "#include \"paging_tmpl.h\"",
            "#include \"paging_tmpl.h\"",
            "#include \"mmu_audit.c\"",
            "#include \"mmutrace.h\"",
            "#include <trace/events/kvm.h>",
            "#include \"trace.h\"",
            "#include <asm/kvm_page_track.h>",
            "#include <asm/vmx.h>",
            "#include <asm/io.h>",
            "#include <asm/e820/api.h>",
            "#include <asm/cmpxchg.h>",
            "#include <asm/memtype.h>",
            "#include <asm/page.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kern_levels.h>",
            "#include <linux/hash.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/srcu.h>",
            "#include <linux/compiler.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/string.h>",
            "#include <linux/types.h>",
            "#include <linux/kvm_host.h>",
            "#include \"cpuid.h\"",
            "#include \"kvm_emulate.h\"",
            "#include \"kvm_cache_regs.h\"",
            "#include \"x86.h\"",
            "#include \"mmu.h\"",
            "#include \"irq.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"paging_tmpl.h\"\n#include \"paging_tmpl.h\"\n#include \"paging_tmpl.h\"\n#include \"mmu_audit.c\"\n#include \"mmutrace.h\"\n#include <trace/events/kvm.h>\n#include \"trace.h\"\n#include <asm/kvm_page_track.h>\n#include <asm/vmx.h>\n#include <asm/io.h>\n#include <asm/e820/api.h>\n#include <asm/cmpxchg.h>\n#include <asm/memtype.h>\n#include <asm/page.h>\n#include <linux/kthread.h>\n#include <linux/kern_levels.h>\n#include <linux/hash.h>\n#include <linux/uaccess.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/srcu.h>\n#include <linux/compiler.h>\n#include <linux/hugetlb.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/moduleparam.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/string.h>\n#include <linux/types.h>\n#include <linux/kvm_host.h>\n#include \"cpuid.h\"\n#include \"kvm_emulate.h\"\n#include \"kvm_cache_regs.h\"\n#include \"x86.h\"\n#include \"mmu.h\"\n#include \"irq.h\"\n\nvoid kvm_mmu_gfn_disallow_lpage(struct kvm_memory_slot *slot, gfn_t gfn)\n{\n\tupdate_gfn_disallow_lpage_count(slot, gfn, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "update_gfn_track",
          "args": [
            "slot",
            "gfn",
            "mode",
            "1"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "update_gfn_track",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
          "lines": "59-72",
          "snippet": "static void update_gfn_track(struct kvm_memory_slot *slot, gfn_t gfn,\n\t\t\t     enum kvm_page_track_mode mode, short count)\n{\n\tint index, val;\n\n\tindex = gfn_to_index(gfn, slot->base_gfn, PT_PAGE_TABLE_LEVEL);\n\n\tval = slot->arch.gfn_track[mode][index];\n\n\tif (WARN_ON(val + count < 0 || val + count > USHRT_MAX))\n\t\treturn;\n\n\tslot->arch.gfn_track[mode][index] += count;\n}",
          "includes": [
            "#include \"mmu.h\"",
            "#include <asm/kvm_page_track.h>",
            "#include <linux/rculist.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nstatic void update_gfn_track(struct kvm_memory_slot *slot, gfn_t gfn,\n\t\t\t     enum kvm_page_track_mode mode, short count)\n{\n\tint index, val;\n\n\tindex = gfn_to_index(gfn, slot->base_gfn, PT_PAGE_TABLE_LEVEL);\n\n\tval = slot->arch.gfn_track[mode][index];\n\n\tif (WARN_ON(val + count < 0 || val + count > USHRT_MAX))\n\t\treturn;\n\n\tslot->arch.gfn_track[mode][index] += count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!page_track_mode_is_valid(mode)"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_track_mode_is_valid",
          "args": [
            "mode"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "page_track_mode_is_valid",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
          "lines": "51-57",
          "snippet": "static inline bool page_track_mode_is_valid(enum kvm_page_track_mode mode)\n{\n\tif (mode < 0 || mode >= KVM_PAGE_TRACK_MAX)\n\t\treturn false;\n\n\treturn true;\n}",
          "includes": [
            "#include \"mmu.h\"",
            "#include <asm/kvm_page_track.h>",
            "#include <linux/rculist.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nstatic inline bool page_track_mode_is_valid(enum kvm_page_track_mode mode)\n{\n\tif (mode < 0 || mode >= KVM_PAGE_TRACK_MAX)\n\t\treturn false;\n\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nvoid kvm_slot_page_track_add_page(struct kvm *kvm,\n\t\t\t\t  struct kvm_memory_slot *slot, gfn_t gfn,\n\t\t\t\t  enum kvm_page_track_mode mode)\n{\n\n\tif (WARN_ON(!page_track_mode_is_valid(mode)))\n\t\treturn;\n\n\tupdate_gfn_track(slot, gfn, mode, 1);\n\n\t/*\n\t * new track stops large page mapping for the\n\t * tracked page.\n\t */\n\tkvm_mmu_gfn_disallow_lpage(slot, gfn);\n\n\tif (mode == KVM_PAGE_TRACK_WRITE)\n\t\tif (kvm_mmu_slot_gfn_write_protect(kvm, slot, gfn))\n\t\t\tkvm_flush_remote_tlbs(kvm);\n}"
  },
  {
    "function_name": "update_gfn_track",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
    "lines": "59-72",
    "snippet": "static void update_gfn_track(struct kvm_memory_slot *slot, gfn_t gfn,\n\t\t\t     enum kvm_page_track_mode mode, short count)\n{\n\tint index, val;\n\n\tindex = gfn_to_index(gfn, slot->base_gfn, PT_PAGE_TABLE_LEVEL);\n\n\tval = slot->arch.gfn_track[mode][index];\n\n\tif (WARN_ON(val + count < 0 || val + count > USHRT_MAX))\n\t\treturn;\n\n\tslot->arch.gfn_track[mode][index] += count;\n}",
    "includes": [
      "#include \"mmu.h\"",
      "#include <asm/kvm_page_track.h>",
      "#include <linux/rculist.h>",
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "val + count < 0 || val + count > USHRT_MAX"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfn_to_index",
          "args": [
            "gfn",
            "slot->base_gfn",
            "PT_PAGE_TABLE_LEVEL"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nstatic void update_gfn_track(struct kvm_memory_slot *slot, gfn_t gfn,\n\t\t\t     enum kvm_page_track_mode mode, short count)\n{\n\tint index, val;\n\n\tindex = gfn_to_index(gfn, slot->base_gfn, PT_PAGE_TABLE_LEVEL);\n\n\tval = slot->arch.gfn_track[mode][index];\n\n\tif (WARN_ON(val + count < 0 || val + count > USHRT_MAX))\n\t\treturn;\n\n\tslot->arch.gfn_track[mode][index] += count;\n}"
  },
  {
    "function_name": "page_track_mode_is_valid",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
    "lines": "51-57",
    "snippet": "static inline bool page_track_mode_is_valid(enum kvm_page_track_mode mode)\n{\n\tif (mode < 0 || mode >= KVM_PAGE_TRACK_MAX)\n\t\treturn false;\n\n\treturn true;\n}",
    "includes": [
      "#include \"mmu.h\"",
      "#include <asm/kvm_page_track.h>",
      "#include <linux/rculist.h>",
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nstatic inline bool page_track_mode_is_valid(enum kvm_page_track_mode mode)\n{\n\tif (mode < 0 || mode >= KVM_PAGE_TRACK_MAX)\n\t\treturn false;\n\n\treturn true;\n}"
  },
  {
    "function_name": "kvm_page_track_create_memslot",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
    "lines": "31-49",
    "snippet": "int kvm_page_track_create_memslot(struct kvm_memory_slot *slot,\n\t\t\t\t  unsigned long npages)\n{\n\tint  i;\n\n\tfor (i = 0; i < KVM_PAGE_TRACK_MAX; i++) {\n\t\tslot->arch.gfn_track[i] =\n\t\t\tkvcalloc(npages, sizeof(*slot->arch.gfn_track[i]),\n\t\t\t\t GFP_KERNEL_ACCOUNT);\n\t\tif (!slot->arch.gfn_track[i])\n\t\t\tgoto track_free;\n\t}\n\n\treturn 0;\n\ntrack_free:\n\tkvm_page_track_free_memslot(slot);\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"mmu.h\"",
      "#include <asm/kvm_page_track.h>",
      "#include <linux/rculist.h>",
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_page_track_free_memslot",
          "args": [
            "slot"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_page_track_free_memslot",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
          "lines": "21-29",
          "snippet": "void kvm_page_track_free_memslot(struct kvm_memory_slot *slot)\n{\n\tint i;\n\n\tfor (i = 0; i < KVM_PAGE_TRACK_MAX; i++) {\n\t\tkvfree(slot->arch.gfn_track[i]);\n\t\tslot->arch.gfn_track[i] = NULL;\n\t}\n}",
          "includes": [
            "#include \"mmu.h\"",
            "#include <asm/kvm_page_track.h>",
            "#include <linux/rculist.h>",
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nvoid kvm_page_track_free_memslot(struct kvm_memory_slot *slot)\n{\n\tint i;\n\n\tfor (i = 0; i < KVM_PAGE_TRACK_MAX; i++) {\n\t\tkvfree(slot->arch.gfn_track[i]);\n\t\tslot->arch.gfn_track[i] = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kvcalloc",
          "args": [
            "npages",
            "sizeof(*slot->arch.gfn_track[i])",
            "GFP_KERNEL_ACCOUNT"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nint kvm_page_track_create_memslot(struct kvm_memory_slot *slot,\n\t\t\t\t  unsigned long npages)\n{\n\tint  i;\n\n\tfor (i = 0; i < KVM_PAGE_TRACK_MAX; i++) {\n\t\tslot->arch.gfn_track[i] =\n\t\t\tkvcalloc(npages, sizeof(*slot->arch.gfn_track[i]),\n\t\t\t\t GFP_KERNEL_ACCOUNT);\n\t\tif (!slot->arch.gfn_track[i])\n\t\t\tgoto track_free;\n\t}\n\n\treturn 0;\n\ntrack_free:\n\tkvm_page_track_free_memslot(slot);\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "kvm_page_track_free_memslot",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/mmu/page_track.c",
    "lines": "21-29",
    "snippet": "void kvm_page_track_free_memslot(struct kvm_memory_slot *slot)\n{\n\tint i;\n\n\tfor (i = 0; i < KVM_PAGE_TRACK_MAX; i++) {\n\t\tkvfree(slot->arch.gfn_track[i]);\n\t\tslot->arch.gfn_track[i] = NULL;\n\t}\n}",
    "includes": [
      "#include \"mmu.h\"",
      "#include <asm/kvm_page_track.h>",
      "#include <linux/rculist.h>",
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvfree",
          "args": [
            "slot->arch.gfn_track[i]"
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"mmu.h\"\n#include <asm/kvm_page_track.h>\n#include <linux/rculist.h>\n#include <linux/kvm_host.h>\n\nvoid kvm_page_track_free_memslot(struct kvm_memory_slot *slot)\n{\n\tint i;\n\n\tfor (i = 0; i < KVM_PAGE_TRACK_MAX; i++) {\n\t\tkvfree(slot->arch.gfn_track[i]);\n\t\tslot->arch.gfn_track[i] = NULL;\n\t}\n}"
  }
]