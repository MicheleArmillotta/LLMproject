[
  {
    "function_name": "kvm_arch_create_vcpu_debugfs",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/debugfs.c",
    "lines": "46-64",
    "snippet": "void kvm_arch_create_vcpu_debugfs(struct kvm_vcpu *vcpu)\n{\n\tdebugfs_create_file(\"tsc-offset\", 0444, vcpu->debugfs_dentry, vcpu,\n\t\t\t    &vcpu_tsc_offset_fops);\n\n\tif (lapic_in_kernel(vcpu))\n\t\tdebugfs_create_file(\"lapic_timer_advance_ns\", 0444,\n\t\t\t\t    vcpu->debugfs_dentry, vcpu,\n\t\t\t\t    &vcpu_timer_advance_ns_fops);\n\n\tif (kvm_has_tsc_control) {\n\t\tdebugfs_create_file(\"tsc-scaling-ratio\", 0444,\n\t\t\t\t    vcpu->debugfs_dentry, vcpu,\n\t\t\t\t    &vcpu_tsc_scaling_fops);\n\t\tdebugfs_create_file(\"tsc-scaling-ratio-frac-bits\", 0444,\n\t\t\t\t    vcpu->debugfs_dentry, vcpu,\n\t\t\t\t    &vcpu_tsc_scaling_frac_fops);\n\t}\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "\"tsc-scaling-ratio-frac-bits\"",
            "0444",
            "vcpu->debugfs_dentry",
            "vcpu",
            "&vcpu_tsc_scaling_frac_fops"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "\"tsc-scaling-ratio\"",
            "0444",
            "vcpu->debugfs_dentry",
            "vcpu",
            "&vcpu_tsc_scaling_fops"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "\"lapic_timer_advance_ns\"",
            "0444",
            "vcpu->debugfs_dentry",
            "vcpu",
            "&vcpu_timer_advance_ns_fops"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lapic_in_kernel",
          "args": [
            "vcpu"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "lapic_in_kernel",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/lapic.h",
          "lines": "168-173",
          "snippet": "static inline bool lapic_in_kernel(struct kvm_vcpu *vcpu)\n{\n\tif (static_key_false(&kvm_no_apic_vcpu))\n\t\treturn vcpu->arch.apic;\n\treturn true;\n}",
          "includes": [
            "#include <linux/kvm_host.h>",
            "#include <kvm/iodev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_host.h>\n#include <kvm/iodev.h>\n\nstatic inline bool lapic_in_kernel(struct kvm_vcpu *vcpu)\n{\n\tif (static_key_false(&kvm_no_apic_vcpu))\n\t\treturn vcpu->arch.apic;\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "\"tsc-offset\"",
            "0444",
            "vcpu->debugfs_dentry",
            "vcpu",
            "&vcpu_tsc_offset_fops"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lapic.h\"\n#include <linux/debugfs.h>\n#include <linux/kvm_host.h>\n\nvoid kvm_arch_create_vcpu_debugfs(struct kvm_vcpu *vcpu)\n{\n\tdebugfs_create_file(\"tsc-offset\", 0444, vcpu->debugfs_dentry, vcpu,\n\t\t\t    &vcpu_tsc_offset_fops);\n\n\tif (lapic_in_kernel(vcpu))\n\t\tdebugfs_create_file(\"lapic_timer_advance_ns\", 0444,\n\t\t\t\t    vcpu->debugfs_dentry, vcpu,\n\t\t\t\t    &vcpu_timer_advance_ns_fops);\n\n\tif (kvm_has_tsc_control) {\n\t\tdebugfs_create_file(\"tsc-scaling-ratio\", 0444,\n\t\t\t\t    vcpu->debugfs_dentry, vcpu,\n\t\t\t\t    &vcpu_tsc_scaling_fops);\n\t\tdebugfs_create_file(\"tsc-scaling-ratio-frac-bits\", 0444,\n\t\t\t\t    vcpu->debugfs_dentry, vcpu,\n\t\t\t\t    &vcpu_tsc_scaling_frac_fops);\n\t}\n}"
  },
  {
    "function_name": "vcpu_get_tsc_scaling_frac_bits",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/debugfs.c",
    "lines": "38-42",
    "snippet": "static int vcpu_get_tsc_scaling_frac_bits(void *data, u64 *val)\n{\n\t*val = kvm_tsc_scaling_ratio_frac_bits;\n\treturn 0;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <linux/debugfs.h>\n#include <linux/kvm_host.h>\n\nstatic int vcpu_get_tsc_scaling_frac_bits(void *data, u64 *val)\n{\n\t*val = kvm_tsc_scaling_ratio_frac_bits;\n\treturn 0;\n}"
  },
  {
    "function_name": "vcpu_get_tsc_scaling_ratio",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/debugfs.c",
    "lines": "29-34",
    "snippet": "static int vcpu_get_tsc_scaling_ratio(void *data, u64 *val)\n{\n\tstruct kvm_vcpu *vcpu = (struct kvm_vcpu *) data;\n\t*val = vcpu->arch.tsc_scaling_ratio;\n\treturn 0;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <linux/debugfs.h>\n#include <linux/kvm_host.h>\n\nstatic int vcpu_get_tsc_scaling_ratio(void *data, u64 *val)\n{\n\tstruct kvm_vcpu *vcpu = (struct kvm_vcpu *) data;\n\t*val = vcpu->arch.tsc_scaling_ratio;\n\treturn 0;\n}"
  },
  {
    "function_name": "vcpu_get_tsc_offset",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/debugfs.c",
    "lines": "20-25",
    "snippet": "static int vcpu_get_tsc_offset(void *data, u64 *val)\n{\n\tstruct kvm_vcpu *vcpu = (struct kvm_vcpu *) data;\n\t*val = vcpu->arch.tsc_offset;\n\treturn 0;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <linux/debugfs.h>\n#include <linux/kvm_host.h>\n\nstatic int vcpu_get_tsc_offset(void *data, u64 *val)\n{\n\tstruct kvm_vcpu *vcpu = (struct kvm_vcpu *) data;\n\t*val = vcpu->arch.tsc_offset;\n\treturn 0;\n}"
  },
  {
    "function_name": "vcpu_get_timer_advance_ns",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/debugfs.c",
    "lines": "11-16",
    "snippet": "static int vcpu_get_timer_advance_ns(void *data, u64 *val)\n{\n\tstruct kvm_vcpu *vcpu = (struct kvm_vcpu *) data;\n\t*val = vcpu->arch.apic->lapic_timer.timer_advance_ns;\n\treturn 0;\n}",
    "includes": [
      "#include \"lapic.h\"",
      "#include <linux/debugfs.h>",
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"lapic.h\"\n#include <linux/debugfs.h>\n#include <linux/kvm_host.h>\n\nstatic int vcpu_get_timer_advance_ns(void *data, u64 *val)\n{\n\tstruct kvm_vcpu *vcpu = (struct kvm_vcpu *) data;\n\t*val = vcpu->arch.apic->lapic_timer.timer_advance_ns;\n\treturn 0;\n}"
  }
]