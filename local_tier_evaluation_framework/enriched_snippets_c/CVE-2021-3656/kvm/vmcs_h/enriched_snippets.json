[
  {
    "function_name": "vmcs_field_readonly",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/vmcs.h",
    "lines": "147-150",
    "snippet": "static inline int vmcs_field_readonly(unsigned long field)\n{\n\treturn (((field >> 10) & 0x3) == 1);\n}",
    "includes": [
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/kvm.h>",
      "#include <linux/nospec.h>",
      "#include <linux/list.h>",
      "#include <linux/ktime.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/kvm.h>\n#include <linux/nospec.h>\n#include <linux/list.h>\n#include <linux/ktime.h>\n\nstatic inline int vmcs_field_readonly(unsigned long field)\n{\n\treturn (((field >> 10) & 0x3) == 1);\n}"
  },
  {
    "function_name": "vmcs_field_width",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/vmcs.h",
    "lines": "140-145",
    "snippet": "static inline int vmcs_field_width(unsigned long field)\n{\n\tif (0x1 & field)\t/* the *_HIGH fields are all 32 bit */\n\t\treturn VMCS_FIELD_WIDTH_U32;\n\treturn (field >> 13) & 0x3;\n}",
    "includes": [
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/kvm.h>",
      "#include <linux/nospec.h>",
      "#include <linux/list.h>",
      "#include <linux/ktime.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/kvm.h>\n#include <linux/nospec.h>\n#include <linux/list.h>\n#include <linux/ktime.h>\n\nstatic inline int vmcs_field_width(unsigned long field)\n{\n\tif (0x1 & field)\t/* the *_HIGH fields are all 32 bit */\n\t\treturn VMCS_FIELD_WIDTH_U32;\n\treturn (field >> 13) & 0x3;\n}"
  },
  {
    "function_name": "is_external_intr",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/vmcs.h",
    "lines": "127-131",
    "snippet": "static inline bool is_external_intr(u32 intr_info)\n{\n\treturn (intr_info & (INTR_INFO_VALID_MASK | INTR_INFO_INTR_TYPE_MASK))\n\t\t== (INTR_INFO_VALID_MASK | INTR_TYPE_EXT_INTR);\n}",
    "includes": [
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/kvm.h>",
      "#include <linux/nospec.h>",
      "#include <linux/list.h>",
      "#include <linux/ktime.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/kvm.h>\n#include <linux/nospec.h>\n#include <linux/list.h>\n#include <linux/ktime.h>\n\nstatic inline bool is_external_intr(u32 intr_info)\n{\n\treturn (intr_info & (INTR_INFO_VALID_MASK | INTR_INFO_INTR_TYPE_MASK))\n\t\t== (INTR_INFO_VALID_MASK | INTR_TYPE_EXT_INTR);\n}"
  },
  {
    "function_name": "is_nmi",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/vmcs.h",
    "lines": "121-125",
    "snippet": "static inline bool is_nmi(u32 intr_info)\n{\n\treturn (intr_info & (INTR_INFO_INTR_TYPE_MASK | INTR_INFO_VALID_MASK))\n\t\t== (INTR_TYPE_NMI_INTR | INTR_INFO_VALID_MASK);\n}",
    "includes": [
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/kvm.h>",
      "#include <linux/nospec.h>",
      "#include <linux/list.h>",
      "#include <linux/ktime.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/kvm.h>\n#include <linux/nospec.h>\n#include <linux/list.h>\n#include <linux/ktime.h>\n\nstatic inline bool is_nmi(u32 intr_info)\n{\n\treturn (intr_info & (INTR_INFO_INTR_TYPE_MASK | INTR_INFO_VALID_MASK))\n\t\t== (INTR_TYPE_NMI_INTR | INTR_INFO_VALID_MASK);\n}"
  },
  {
    "function_name": "is_icebp",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/vmcs.h",
    "lines": "115-119",
    "snippet": "static inline bool is_icebp(u32 intr_info)\n{\n\treturn (intr_info & (INTR_INFO_INTR_TYPE_MASK | INTR_INFO_VALID_MASK))\n\t\t== (INTR_TYPE_PRIV_SW_EXCEPTION | INTR_INFO_VALID_MASK);\n}",
    "includes": [
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/kvm.h>",
      "#include <linux/nospec.h>",
      "#include <linux/list.h>",
      "#include <linux/ktime.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/kvm.h>\n#include <linux/nospec.h>\n#include <linux/list.h>\n#include <linux/ktime.h>\n\nstatic inline bool is_icebp(u32 intr_info)\n{\n\treturn (intr_info & (INTR_INFO_INTR_TYPE_MASK | INTR_INFO_VALID_MASK))\n\t\t== (INTR_TYPE_PRIV_SW_EXCEPTION | INTR_INFO_VALID_MASK);\n}"
  },
  {
    "function_name": "is_machine_check",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/vmcs.h",
    "lines": "107-112",
    "snippet": "static inline bool is_machine_check(u32 intr_info)\n{\n\treturn (intr_info & (INTR_INFO_INTR_TYPE_MASK | INTR_INFO_VECTOR_MASK |\n\t\t\t     INTR_INFO_VALID_MASK)) ==\n\t\t(INTR_TYPE_HARD_EXCEPTION | MC_VECTOR | INTR_INFO_VALID_MASK);\n}",
    "includes": [
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/kvm.h>",
      "#include <linux/nospec.h>",
      "#include <linux/list.h>",
      "#include <linux/ktime.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/kvm.h>\n#include <linux/nospec.h>\n#include <linux/list.h>\n#include <linux/ktime.h>\n\nstatic inline bool is_machine_check(u32 intr_info)\n{\n\treturn (intr_info & (INTR_INFO_INTR_TYPE_MASK | INTR_INFO_VECTOR_MASK |\n\t\t\t     INTR_INFO_VALID_MASK)) ==\n\t\t(INTR_TYPE_HARD_EXCEPTION | MC_VECTOR | INTR_INFO_VALID_MASK);\n}"
  },
  {
    "function_name": "is_gp_fault",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/vmcs.h",
    "lines": "102-105",
    "snippet": "static inline bool is_gp_fault(u32 intr_info)\n{\n\treturn is_exception_n(intr_info, GP_VECTOR);\n}",
    "includes": [
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/kvm.h>",
      "#include <linux/nospec.h>",
      "#include <linux/list.h>",
      "#include <linux/ktime.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "is_exception_n",
          "args": [
            "intr_info",
            "GP_VECTOR"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "is_exception_n",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/vmcs.h",
          "lines": "75-80",
          "snippet": "static inline bool is_exception_n(u32 intr_info, u8 vector)\n{\n\treturn (intr_info & (INTR_INFO_INTR_TYPE_MASK | INTR_INFO_VECTOR_MASK |\n\t\t\t     INTR_INFO_VALID_MASK)) ==\n\t\t(INTR_TYPE_HARD_EXCEPTION | vector | INTR_INFO_VALID_MASK);\n}",
          "includes": [
            "#include \"capabilities.h\"",
            "#include <asm/vmx.h>",
            "#include <asm/kvm.h>",
            "#include <linux/nospec.h>",
            "#include <linux/list.h>",
            "#include <linux/ktime.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/kvm.h>\n#include <linux/nospec.h>\n#include <linux/list.h>\n#include <linux/ktime.h>\n\nstatic inline bool is_exception_n(u32 intr_info, u8 vector)\n{\n\treturn (intr_info & (INTR_INFO_INTR_TYPE_MASK | INTR_INFO_VECTOR_MASK |\n\t\t\t     INTR_INFO_VALID_MASK)) ==\n\t\t(INTR_TYPE_HARD_EXCEPTION | vector | INTR_INFO_VALID_MASK);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/kvm.h>\n#include <linux/nospec.h>\n#include <linux/list.h>\n#include <linux/ktime.h>\n\nstatic inline bool is_gp_fault(u32 intr_info)\n{\n\treturn is_exception_n(intr_info, GP_VECTOR);\n}"
  },
  {
    "function_name": "is_invalid_opcode",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/vmcs.h",
    "lines": "97-100",
    "snippet": "static inline bool is_invalid_opcode(u32 intr_info)\n{\n\treturn is_exception_n(intr_info, UD_VECTOR);\n}",
    "includes": [
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/kvm.h>",
      "#include <linux/nospec.h>",
      "#include <linux/list.h>",
      "#include <linux/ktime.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "is_exception_n",
          "args": [
            "intr_info",
            "UD_VECTOR"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "is_exception_n",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/vmcs.h",
          "lines": "75-80",
          "snippet": "static inline bool is_exception_n(u32 intr_info, u8 vector)\n{\n\treturn (intr_info & (INTR_INFO_INTR_TYPE_MASK | INTR_INFO_VECTOR_MASK |\n\t\t\t     INTR_INFO_VALID_MASK)) ==\n\t\t(INTR_TYPE_HARD_EXCEPTION | vector | INTR_INFO_VALID_MASK);\n}",
          "includes": [
            "#include \"capabilities.h\"",
            "#include <asm/vmx.h>",
            "#include <asm/kvm.h>",
            "#include <linux/nospec.h>",
            "#include <linux/list.h>",
            "#include <linux/ktime.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/kvm.h>\n#include <linux/nospec.h>\n#include <linux/list.h>\n#include <linux/ktime.h>\n\nstatic inline bool is_exception_n(u32 intr_info, u8 vector)\n{\n\treturn (intr_info & (INTR_INFO_INTR_TYPE_MASK | INTR_INFO_VECTOR_MASK |\n\t\t\t     INTR_INFO_VALID_MASK)) ==\n\t\t(INTR_TYPE_HARD_EXCEPTION | vector | INTR_INFO_VALID_MASK);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/kvm.h>\n#include <linux/nospec.h>\n#include <linux/list.h>\n#include <linux/ktime.h>\n\nstatic inline bool is_invalid_opcode(u32 intr_info)\n{\n\treturn is_exception_n(intr_info, UD_VECTOR);\n}"
  },
  {
    "function_name": "is_page_fault",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/vmcs.h",
    "lines": "92-95",
    "snippet": "static inline bool is_page_fault(u32 intr_info)\n{\n\treturn is_exception_n(intr_info, PF_VECTOR);\n}",
    "includes": [
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/kvm.h>",
      "#include <linux/nospec.h>",
      "#include <linux/list.h>",
      "#include <linux/ktime.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "is_exception_n",
          "args": [
            "intr_info",
            "PF_VECTOR"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "is_exception_n",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/vmcs.h",
          "lines": "75-80",
          "snippet": "static inline bool is_exception_n(u32 intr_info, u8 vector)\n{\n\treturn (intr_info & (INTR_INFO_INTR_TYPE_MASK | INTR_INFO_VECTOR_MASK |\n\t\t\t     INTR_INFO_VALID_MASK)) ==\n\t\t(INTR_TYPE_HARD_EXCEPTION | vector | INTR_INFO_VALID_MASK);\n}",
          "includes": [
            "#include \"capabilities.h\"",
            "#include <asm/vmx.h>",
            "#include <asm/kvm.h>",
            "#include <linux/nospec.h>",
            "#include <linux/list.h>",
            "#include <linux/ktime.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/kvm.h>\n#include <linux/nospec.h>\n#include <linux/list.h>\n#include <linux/ktime.h>\n\nstatic inline bool is_exception_n(u32 intr_info, u8 vector)\n{\n\treturn (intr_info & (INTR_INFO_INTR_TYPE_MASK | INTR_INFO_VECTOR_MASK |\n\t\t\t     INTR_INFO_VALID_MASK)) ==\n\t\t(INTR_TYPE_HARD_EXCEPTION | vector | INTR_INFO_VALID_MASK);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/kvm.h>\n#include <linux/nospec.h>\n#include <linux/list.h>\n#include <linux/ktime.h>\n\nstatic inline bool is_page_fault(u32 intr_info)\n{\n\treturn is_exception_n(intr_info, PF_VECTOR);\n}"
  },
  {
    "function_name": "is_breakpoint",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/vmcs.h",
    "lines": "87-90",
    "snippet": "static inline bool is_breakpoint(u32 intr_info)\n{\n\treturn is_exception_n(intr_info, BP_VECTOR);\n}",
    "includes": [
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/kvm.h>",
      "#include <linux/nospec.h>",
      "#include <linux/list.h>",
      "#include <linux/ktime.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "is_exception_n",
          "args": [
            "intr_info",
            "BP_VECTOR"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "is_exception_n",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/vmcs.h",
          "lines": "75-80",
          "snippet": "static inline bool is_exception_n(u32 intr_info, u8 vector)\n{\n\treturn (intr_info & (INTR_INFO_INTR_TYPE_MASK | INTR_INFO_VECTOR_MASK |\n\t\t\t     INTR_INFO_VALID_MASK)) ==\n\t\t(INTR_TYPE_HARD_EXCEPTION | vector | INTR_INFO_VALID_MASK);\n}",
          "includes": [
            "#include \"capabilities.h\"",
            "#include <asm/vmx.h>",
            "#include <asm/kvm.h>",
            "#include <linux/nospec.h>",
            "#include <linux/list.h>",
            "#include <linux/ktime.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/kvm.h>\n#include <linux/nospec.h>\n#include <linux/list.h>\n#include <linux/ktime.h>\n\nstatic inline bool is_exception_n(u32 intr_info, u8 vector)\n{\n\treturn (intr_info & (INTR_INFO_INTR_TYPE_MASK | INTR_INFO_VECTOR_MASK |\n\t\t\t     INTR_INFO_VALID_MASK)) ==\n\t\t(INTR_TYPE_HARD_EXCEPTION | vector | INTR_INFO_VALID_MASK);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/kvm.h>\n#include <linux/nospec.h>\n#include <linux/list.h>\n#include <linux/ktime.h>\n\nstatic inline bool is_breakpoint(u32 intr_info)\n{\n\treturn is_exception_n(intr_info, BP_VECTOR);\n}"
  },
  {
    "function_name": "is_debug",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/vmcs.h",
    "lines": "82-85",
    "snippet": "static inline bool is_debug(u32 intr_info)\n{\n\treturn is_exception_n(intr_info, DB_VECTOR);\n}",
    "includes": [
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/kvm.h>",
      "#include <linux/nospec.h>",
      "#include <linux/list.h>",
      "#include <linux/ktime.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "is_exception_n",
          "args": [
            "intr_info",
            "DB_VECTOR"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "is_exception_n",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/vmcs.h",
          "lines": "75-80",
          "snippet": "static inline bool is_exception_n(u32 intr_info, u8 vector)\n{\n\treturn (intr_info & (INTR_INFO_INTR_TYPE_MASK | INTR_INFO_VECTOR_MASK |\n\t\t\t     INTR_INFO_VALID_MASK)) ==\n\t\t(INTR_TYPE_HARD_EXCEPTION | vector | INTR_INFO_VALID_MASK);\n}",
          "includes": [
            "#include \"capabilities.h\"",
            "#include <asm/vmx.h>",
            "#include <asm/kvm.h>",
            "#include <linux/nospec.h>",
            "#include <linux/list.h>",
            "#include <linux/ktime.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/kvm.h>\n#include <linux/nospec.h>\n#include <linux/list.h>\n#include <linux/ktime.h>\n\nstatic inline bool is_exception_n(u32 intr_info, u8 vector)\n{\n\treturn (intr_info & (INTR_INFO_INTR_TYPE_MASK | INTR_INFO_VECTOR_MASK |\n\t\t\t     INTR_INFO_VALID_MASK)) ==\n\t\t(INTR_TYPE_HARD_EXCEPTION | vector | INTR_INFO_VALID_MASK);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/kvm.h>\n#include <linux/nospec.h>\n#include <linux/list.h>\n#include <linux/ktime.h>\n\nstatic inline bool is_debug(u32 intr_info)\n{\n\treturn is_exception_n(intr_info, DB_VECTOR);\n}"
  },
  {
    "function_name": "is_exception_n",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/vmcs.h",
    "lines": "75-80",
    "snippet": "static inline bool is_exception_n(u32 intr_info, u8 vector)\n{\n\treturn (intr_info & (INTR_INFO_INTR_TYPE_MASK | INTR_INFO_VECTOR_MASK |\n\t\t\t     INTR_INFO_VALID_MASK)) ==\n\t\t(INTR_TYPE_HARD_EXCEPTION | vector | INTR_INFO_VALID_MASK);\n}",
    "includes": [
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/kvm.h>",
      "#include <linux/nospec.h>",
      "#include <linux/list.h>",
      "#include <linux/ktime.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/kvm.h>\n#include <linux/nospec.h>\n#include <linux/list.h>\n#include <linux/ktime.h>\n\nstatic inline bool is_exception_n(u32 intr_info, u8 vector)\n{\n\treturn (intr_info & (INTR_INFO_INTR_TYPE_MASK | INTR_INFO_VECTOR_MASK |\n\t\t\t     INTR_INFO_VALID_MASK)) ==\n\t\t(INTR_TYPE_HARD_EXCEPTION | vector | INTR_INFO_VALID_MASK);\n}"
  }
]