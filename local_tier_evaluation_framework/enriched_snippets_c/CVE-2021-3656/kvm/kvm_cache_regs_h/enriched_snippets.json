[
  {
    "function_name": "is_smm",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "175-178",
    "snippet": "static inline bool is_smm(struct kvm_vcpu *vcpu)\n{\n\treturn vcpu->arch.hflags & HF_SMM_MASK;\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline bool is_smm(struct kvm_vcpu *vcpu)\n{\n\treturn vcpu->arch.hflags & HF_SMM_MASK;\n}"
  },
  {
    "function_name": "is_guest_mode",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "170-173",
    "snippet": "static inline bool is_guest_mode(struct kvm_vcpu *vcpu)\n{\n\treturn vcpu->arch.hflags & HF_GUEST_MASK;\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline bool is_guest_mode(struct kvm_vcpu *vcpu)\n{\n\treturn vcpu->arch.hflags & HF_GUEST_MASK;\n}"
  },
  {
    "function_name": "leave_guest_mode",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "160-168",
    "snippet": "static inline void leave_guest_mode(struct kvm_vcpu *vcpu)\n{\n\tvcpu->arch.hflags &= ~HF_GUEST_MASK;\n\n\tif (vcpu->arch.load_eoi_exitmap_pending) {\n\t\tvcpu->arch.load_eoi_exitmap_pending = false;\n\t\tkvm_make_request(KVM_REQ_LOAD_EOI_EXITMAP, vcpu);\n\t}\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_make_request",
          "args": [
            "KVM_REQ_LOAD_EOI_EXITMAP",
            "vcpu"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline void leave_guest_mode(struct kvm_vcpu *vcpu)\n{\n\tvcpu->arch.hflags &= ~HF_GUEST_MASK;\n\n\tif (vcpu->arch.load_eoi_exitmap_pending) {\n\t\tvcpu->arch.load_eoi_exitmap_pending = false;\n\t\tkvm_make_request(KVM_REQ_LOAD_EOI_EXITMAP, vcpu);\n\t}\n}"
  },
  {
    "function_name": "enter_guest_mode",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "155-158",
    "snippet": "static inline void enter_guest_mode(struct kvm_vcpu *vcpu)\n{\n\tvcpu->arch.hflags |= HF_GUEST_MASK;\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline void enter_guest_mode(struct kvm_vcpu *vcpu)\n{\n\tvcpu->arch.hflags |= HF_GUEST_MASK;\n}"
  },
  {
    "function_name": "kvm_read_edx_eax",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "149-153",
    "snippet": "static inline u64 kvm_read_edx_eax(struct kvm_vcpu *vcpu)\n{\n\treturn (kvm_rax_read(vcpu) & -1u)\n\t\t| ((u64)(kvm_rdx_read(vcpu) & -1u) << 32);\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "kvm_rdx_read(vcpu) & -1u"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kvm_rdx_read",
          "args": [
            "vcpu"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kvm_rax_read",
          "args": [
            "vcpu"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline u64 kvm_read_edx_eax(struct kvm_vcpu *vcpu)\n{\n\treturn (kvm_rax_read(vcpu) & -1u)\n\t\t| ((u64)(kvm_rdx_read(vcpu) & -1u) << 32);\n}"
  },
  {
    "function_name": "kvm_read_cr4",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "144-147",
    "snippet": "static inline ulong kvm_read_cr4(struct kvm_vcpu *vcpu)\n{\n\treturn kvm_read_cr4_bits(vcpu, ~0UL);\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_read_cr4_bits",
          "args": [
            "vcpu",
            "~0UL"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_read_cr4_bits",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
          "lines": "129-135",
          "snippet": "static inline ulong kvm_read_cr4_bits(struct kvm_vcpu *vcpu, ulong mask)\n{\n\tulong tmask = mask & KVM_POSSIBLE_CR4_GUEST_BITS;\n\tif (tmask & vcpu->arch.cr4_guest_owned_bits)\n\t\tkvm_x86_ops.decache_cr4_guest_bits(vcpu);\n\treturn vcpu->arch.cr4 & mask;\n}",
          "includes": [
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [
            "#define KVM_POSSIBLE_CR4_GUEST_BITS\t\t\t\t  \\\n\t(X86_CR4_PVI | X86_CR4_DE | X86_CR4_PCE | X86_CR4_OSFXSR  \\\n\t | X86_CR4_OSXMMEXCPT | X86_CR4_LA57 | X86_CR4_PGE)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_host.h>\n\n#define KVM_POSSIBLE_CR4_GUEST_BITS\t\t\t\t  \\\n\t(X86_CR4_PVI | X86_CR4_DE | X86_CR4_PCE | X86_CR4_OSFXSR  \\\n\t | X86_CR4_OSXMMEXCPT | X86_CR4_LA57 | X86_CR4_PGE)\n\nstatic inline ulong kvm_read_cr4_bits(struct kvm_vcpu *vcpu, ulong mask)\n{\n\tulong tmask = mask & KVM_POSSIBLE_CR4_GUEST_BITS;\n\tif (tmask & vcpu->arch.cr4_guest_owned_bits)\n\t\tkvm_x86_ops.decache_cr4_guest_bits(vcpu);\n\treturn vcpu->arch.cr4 & mask;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline ulong kvm_read_cr4(struct kvm_vcpu *vcpu)\n{\n\treturn kvm_read_cr4_bits(vcpu, ~0UL);\n}"
  },
  {
    "function_name": "kvm_read_cr3",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "137-142",
    "snippet": "static inline ulong kvm_read_cr3(struct kvm_vcpu *vcpu)\n{\n\tif (!kvm_register_is_available(vcpu, VCPU_EXREG_CR3))\n\t\tkvm_x86_ops.cache_reg(vcpu, VCPU_EXREG_CR3);\n\treturn vcpu->arch.cr3;\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_x86_ops.cache_reg",
          "args": [
            "vcpu",
            "VCPU_EXREG_CR3"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kvm_register_is_available",
          "args": [
            "vcpu",
            "VCPU_EXREG_CR3"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_register_is_available",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
          "lines": "40-44",
          "snippet": "static inline bool kvm_register_is_available(struct kvm_vcpu *vcpu,\n\t\t\t\t\t     enum kvm_reg reg)\n{\n\treturn test_bit(reg, (unsigned long *)&vcpu->arch.regs_avail);\n}",
          "includes": [
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline bool kvm_register_is_available(struct kvm_vcpu *vcpu,\n\t\t\t\t\t     enum kvm_reg reg)\n{\n\treturn test_bit(reg, (unsigned long *)&vcpu->arch.regs_avail);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline ulong kvm_read_cr3(struct kvm_vcpu *vcpu)\n{\n\tif (!kvm_register_is_available(vcpu, VCPU_EXREG_CR3))\n\t\tkvm_x86_ops.cache_reg(vcpu, VCPU_EXREG_CR3);\n\treturn vcpu->arch.cr3;\n}"
  },
  {
    "function_name": "kvm_read_cr4_bits",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "129-135",
    "snippet": "static inline ulong kvm_read_cr4_bits(struct kvm_vcpu *vcpu, ulong mask)\n{\n\tulong tmask = mask & KVM_POSSIBLE_CR4_GUEST_BITS;\n\tif (tmask & vcpu->arch.cr4_guest_owned_bits)\n\t\tkvm_x86_ops.decache_cr4_guest_bits(vcpu);\n\treturn vcpu->arch.cr4 & mask;\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [
      "#define KVM_POSSIBLE_CR4_GUEST_BITS\t\t\t\t  \\\n\t(X86_CR4_PVI | X86_CR4_DE | X86_CR4_PCE | X86_CR4_OSFXSR  \\\n\t | X86_CR4_OSXMMEXCPT | X86_CR4_LA57 | X86_CR4_PGE)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_x86_ops.decache_cr4_guest_bits",
          "args": [
            "vcpu"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\n#define KVM_POSSIBLE_CR4_GUEST_BITS\t\t\t\t  \\\n\t(X86_CR4_PVI | X86_CR4_DE | X86_CR4_PCE | X86_CR4_OSFXSR  \\\n\t | X86_CR4_OSXMMEXCPT | X86_CR4_LA57 | X86_CR4_PGE)\n\nstatic inline ulong kvm_read_cr4_bits(struct kvm_vcpu *vcpu, ulong mask)\n{\n\tulong tmask = mask & KVM_POSSIBLE_CR4_GUEST_BITS;\n\tif (tmask & vcpu->arch.cr4_guest_owned_bits)\n\t\tkvm_x86_ops.decache_cr4_guest_bits(vcpu);\n\treturn vcpu->arch.cr4 & mask;\n}"
  },
  {
    "function_name": "kvm_read_cr0",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "124-127",
    "snippet": "static inline ulong kvm_read_cr0(struct kvm_vcpu *vcpu)\n{\n\treturn kvm_read_cr0_bits(vcpu, ~0UL);\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_read_cr0_bits",
          "args": [
            "vcpu",
            "~0UL"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_read_cr0_bits",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
          "lines": "116-122",
          "snippet": "static inline ulong kvm_read_cr0_bits(struct kvm_vcpu *vcpu, ulong mask)\n{\n\tulong tmask = mask & KVM_POSSIBLE_CR0_GUEST_BITS;\n\tif (tmask & vcpu->arch.cr0_guest_owned_bits)\n\t\tkvm_x86_ops.decache_cr0_guest_bits(vcpu);\n\treturn vcpu->arch.cr0 & mask;\n}",
          "includes": [
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [
            "#define KVM_POSSIBLE_CR0_GUEST_BITS X86_CR0_TS"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_host.h>\n\n#define KVM_POSSIBLE_CR0_GUEST_BITS X86_CR0_TS\n\nstatic inline ulong kvm_read_cr0_bits(struct kvm_vcpu *vcpu, ulong mask)\n{\n\tulong tmask = mask & KVM_POSSIBLE_CR0_GUEST_BITS;\n\tif (tmask & vcpu->arch.cr0_guest_owned_bits)\n\t\tkvm_x86_ops.decache_cr0_guest_bits(vcpu);\n\treturn vcpu->arch.cr0 & mask;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline ulong kvm_read_cr0(struct kvm_vcpu *vcpu)\n{\n\treturn kvm_read_cr0_bits(vcpu, ~0UL);\n}"
  },
  {
    "function_name": "kvm_read_cr0_bits",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "116-122",
    "snippet": "static inline ulong kvm_read_cr0_bits(struct kvm_vcpu *vcpu, ulong mask)\n{\n\tulong tmask = mask & KVM_POSSIBLE_CR0_GUEST_BITS;\n\tif (tmask & vcpu->arch.cr0_guest_owned_bits)\n\t\tkvm_x86_ops.decache_cr0_guest_bits(vcpu);\n\treturn vcpu->arch.cr0 & mask;\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [
      "#define KVM_POSSIBLE_CR0_GUEST_BITS X86_CR0_TS"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_x86_ops.decache_cr0_guest_bits",
          "args": [
            "vcpu"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\n#define KVM_POSSIBLE_CR0_GUEST_BITS X86_CR0_TS\n\nstatic inline ulong kvm_read_cr0_bits(struct kvm_vcpu *vcpu, ulong mask)\n{\n\tulong tmask = mask & KVM_POSSIBLE_CR0_GUEST_BITS;\n\tif (tmask & vcpu->arch.cr0_guest_owned_bits)\n\t\tkvm_x86_ops.decache_cr0_guest_bits(vcpu);\n\treturn vcpu->arch.cr0 & mask;\n}"
  },
  {
    "function_name": "kvm_pdptr_read",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "106-114",
    "snippet": "static inline u64 kvm_pdptr_read(struct kvm_vcpu *vcpu, int index)\n{\n\tmight_sleep();  /* on svm */\n\n\tif (!kvm_register_is_available(vcpu, VCPU_EXREG_PDPTR))\n\t\tkvm_x86_ops.cache_reg(vcpu, VCPU_EXREG_PDPTR);\n\n\treturn vcpu->arch.walk_mmu->pdptrs[index];\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_x86_ops.cache_reg",
          "args": [
            "vcpu",
            "VCPU_EXREG_PDPTR"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kvm_register_is_available",
          "args": [
            "vcpu",
            "VCPU_EXREG_PDPTR"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_register_is_available",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
          "lines": "40-44",
          "snippet": "static inline bool kvm_register_is_available(struct kvm_vcpu *vcpu,\n\t\t\t\t\t     enum kvm_reg reg)\n{\n\treturn test_bit(reg, (unsigned long *)&vcpu->arch.regs_avail);\n}",
          "includes": [
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline bool kvm_register_is_available(struct kvm_vcpu *vcpu,\n\t\t\t\t\t     enum kvm_reg reg)\n{\n\treturn test_bit(reg, (unsigned long *)&vcpu->arch.regs_avail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "might_sleep",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline u64 kvm_pdptr_read(struct kvm_vcpu *vcpu, int index)\n{\n\tmight_sleep();  /* on svm */\n\n\tif (!kvm_register_is_available(vcpu, VCPU_EXREG_PDPTR))\n\t\tkvm_x86_ops.cache_reg(vcpu, VCPU_EXREG_PDPTR);\n\n\treturn vcpu->arch.walk_mmu->pdptrs[index];\n}"
  },
  {
    "function_name": "kvm_rsp_write",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "101-104",
    "snippet": "static inline void kvm_rsp_write(struct kvm_vcpu *vcpu, unsigned long val)\n{\n\tkvm_register_write(vcpu, VCPU_REGS_RSP, val);\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_register_write",
          "args": [
            "vcpu",
            "VCPU_REGS_RSP",
            "val"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_register_write",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
          "lines": "76-84",
          "snippet": "static inline void kvm_register_write(struct kvm_vcpu *vcpu, int reg,\n\t\t\t\t      unsigned long val)\n{\n\tif (WARN_ON_ONCE((unsigned int)reg >= NR_VCPU_REGS))\n\t\treturn;\n\n\tvcpu->arch.regs[reg] = val;\n\tkvm_register_mark_dirty(vcpu, reg);\n}",
          "includes": [
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline void kvm_register_write(struct kvm_vcpu *vcpu, int reg,\n\t\t\t\t      unsigned long val)\n{\n\tif (WARN_ON_ONCE((unsigned int)reg >= NR_VCPU_REGS))\n\t\treturn;\n\n\tvcpu->arch.regs[reg] = val;\n\tkvm_register_mark_dirty(vcpu, reg);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline void kvm_rsp_write(struct kvm_vcpu *vcpu, unsigned long val)\n{\n\tkvm_register_write(vcpu, VCPU_REGS_RSP, val);\n}"
  },
  {
    "function_name": "kvm_rsp_read",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "96-99",
    "snippet": "static inline unsigned long kvm_rsp_read(struct kvm_vcpu *vcpu)\n{\n\treturn kvm_register_read(vcpu, VCPU_REGS_RSP);\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_register_read",
          "args": [
            "vcpu",
            "VCPU_REGS_RSP"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_register_read",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
          "lines": "65-74",
          "snippet": "static inline unsigned long kvm_register_read(struct kvm_vcpu *vcpu, int reg)\n{\n\tif (WARN_ON_ONCE((unsigned int)reg >= NR_VCPU_REGS))\n\t\treturn 0;\n\n\tif (!kvm_register_is_available(vcpu, reg))\n\t\tkvm_x86_ops.cache_reg(vcpu, reg);\n\n\treturn vcpu->arch.regs[reg];\n}",
          "includes": [
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline unsigned long kvm_register_read(struct kvm_vcpu *vcpu, int reg)\n{\n\tif (WARN_ON_ONCE((unsigned int)reg >= NR_VCPU_REGS))\n\t\treturn 0;\n\n\tif (!kvm_register_is_available(vcpu, reg))\n\t\tkvm_x86_ops.cache_reg(vcpu, reg);\n\n\treturn vcpu->arch.regs[reg];\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline unsigned long kvm_rsp_read(struct kvm_vcpu *vcpu)\n{\n\treturn kvm_register_read(vcpu, VCPU_REGS_RSP);\n}"
  },
  {
    "function_name": "kvm_rip_write",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "91-94",
    "snippet": "static inline void kvm_rip_write(struct kvm_vcpu *vcpu, unsigned long val)\n{\n\tkvm_register_write(vcpu, VCPU_REGS_RIP, val);\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_register_write",
          "args": [
            "vcpu",
            "VCPU_REGS_RIP",
            "val"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_register_write",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
          "lines": "76-84",
          "snippet": "static inline void kvm_register_write(struct kvm_vcpu *vcpu, int reg,\n\t\t\t\t      unsigned long val)\n{\n\tif (WARN_ON_ONCE((unsigned int)reg >= NR_VCPU_REGS))\n\t\treturn;\n\n\tvcpu->arch.regs[reg] = val;\n\tkvm_register_mark_dirty(vcpu, reg);\n}",
          "includes": [
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline void kvm_register_write(struct kvm_vcpu *vcpu, int reg,\n\t\t\t\t      unsigned long val)\n{\n\tif (WARN_ON_ONCE((unsigned int)reg >= NR_VCPU_REGS))\n\t\treturn;\n\n\tvcpu->arch.regs[reg] = val;\n\tkvm_register_mark_dirty(vcpu, reg);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline void kvm_rip_write(struct kvm_vcpu *vcpu, unsigned long val)\n{\n\tkvm_register_write(vcpu, VCPU_REGS_RIP, val);\n}"
  },
  {
    "function_name": "kvm_rip_read",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "86-89",
    "snippet": "static inline unsigned long kvm_rip_read(struct kvm_vcpu *vcpu)\n{\n\treturn kvm_register_read(vcpu, VCPU_REGS_RIP);\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_register_read",
          "args": [
            "vcpu",
            "VCPU_REGS_RIP"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_register_read",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
          "lines": "65-74",
          "snippet": "static inline unsigned long kvm_register_read(struct kvm_vcpu *vcpu, int reg)\n{\n\tif (WARN_ON_ONCE((unsigned int)reg >= NR_VCPU_REGS))\n\t\treturn 0;\n\n\tif (!kvm_register_is_available(vcpu, reg))\n\t\tkvm_x86_ops.cache_reg(vcpu, reg);\n\n\treturn vcpu->arch.regs[reg];\n}",
          "includes": [
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline unsigned long kvm_register_read(struct kvm_vcpu *vcpu, int reg)\n{\n\tif (WARN_ON_ONCE((unsigned int)reg >= NR_VCPU_REGS))\n\t\treturn 0;\n\n\tif (!kvm_register_is_available(vcpu, reg))\n\t\tkvm_x86_ops.cache_reg(vcpu, reg);\n\n\treturn vcpu->arch.regs[reg];\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline unsigned long kvm_rip_read(struct kvm_vcpu *vcpu)\n{\n\treturn kvm_register_read(vcpu, VCPU_REGS_RIP);\n}"
  },
  {
    "function_name": "kvm_register_write",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "76-84",
    "snippet": "static inline void kvm_register_write(struct kvm_vcpu *vcpu, int reg,\n\t\t\t\t      unsigned long val)\n{\n\tif (WARN_ON_ONCE((unsigned int)reg >= NR_VCPU_REGS))\n\t\treturn;\n\n\tvcpu->arch.regs[reg] = val;\n\tkvm_register_mark_dirty(vcpu, reg);\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_register_mark_dirty",
          "args": [
            "vcpu",
            "reg"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_register_mark_dirty",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
          "lines": "58-63",
          "snippet": "static inline void kvm_register_mark_dirty(struct kvm_vcpu *vcpu,\n\t\t\t\t\t   enum kvm_reg reg)\n{\n\t__set_bit(reg, (unsigned long *)&vcpu->arch.regs_avail);\n\t__set_bit(reg, (unsigned long *)&vcpu->arch.regs_dirty);\n}",
          "includes": [
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline void kvm_register_mark_dirty(struct kvm_vcpu *vcpu,\n\t\t\t\t\t   enum kvm_reg reg)\n{\n\t__set_bit(reg, (unsigned long *)&vcpu->arch.regs_avail);\n\t__set_bit(reg, (unsigned long *)&vcpu->arch.regs_dirty);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "(unsigned int)reg >= NR_VCPU_REGS"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline void kvm_register_write(struct kvm_vcpu *vcpu, int reg,\n\t\t\t\t      unsigned long val)\n{\n\tif (WARN_ON_ONCE((unsigned int)reg >= NR_VCPU_REGS))\n\t\treturn;\n\n\tvcpu->arch.regs[reg] = val;\n\tkvm_register_mark_dirty(vcpu, reg);\n}"
  },
  {
    "function_name": "kvm_register_read",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "65-74",
    "snippet": "static inline unsigned long kvm_register_read(struct kvm_vcpu *vcpu, int reg)\n{\n\tif (WARN_ON_ONCE((unsigned int)reg >= NR_VCPU_REGS))\n\t\treturn 0;\n\n\tif (!kvm_register_is_available(vcpu, reg))\n\t\tkvm_x86_ops.cache_reg(vcpu, reg);\n\n\treturn vcpu->arch.regs[reg];\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvm_x86_ops.cache_reg",
          "args": [
            "vcpu",
            "reg"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kvm_register_is_available",
          "args": [
            "vcpu",
            "reg"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "kvm_register_is_available",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
          "lines": "40-44",
          "snippet": "static inline bool kvm_register_is_available(struct kvm_vcpu *vcpu,\n\t\t\t\t\t     enum kvm_reg reg)\n{\n\treturn test_bit(reg, (unsigned long *)&vcpu->arch.regs_avail);\n}",
          "includes": [
            "#include <linux/kvm_host.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline bool kvm_register_is_available(struct kvm_vcpu *vcpu,\n\t\t\t\t\t     enum kvm_reg reg)\n{\n\treturn test_bit(reg, (unsigned long *)&vcpu->arch.regs_avail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "(unsigned int)reg >= NR_VCPU_REGS"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline unsigned long kvm_register_read(struct kvm_vcpu *vcpu, int reg)\n{\n\tif (WARN_ON_ONCE((unsigned int)reg >= NR_VCPU_REGS))\n\t\treturn 0;\n\n\tif (!kvm_register_is_available(vcpu, reg))\n\t\tkvm_x86_ops.cache_reg(vcpu, reg);\n\n\treturn vcpu->arch.regs[reg];\n}"
  },
  {
    "function_name": "kvm_register_mark_dirty",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "58-63",
    "snippet": "static inline void kvm_register_mark_dirty(struct kvm_vcpu *vcpu,\n\t\t\t\t\t   enum kvm_reg reg)\n{\n\t__set_bit(reg, (unsigned long *)&vcpu->arch.regs_avail);\n\t__set_bit(reg, (unsigned long *)&vcpu->arch.regs_dirty);\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__set_bit",
          "args": [
            "reg",
            "(unsigned long *)&vcpu->arch.regs_dirty"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__set_bit",
          "args": [
            "reg",
            "(unsigned long *)&vcpu->arch.regs_avail"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline void kvm_register_mark_dirty(struct kvm_vcpu *vcpu,\n\t\t\t\t\t   enum kvm_reg reg)\n{\n\t__set_bit(reg, (unsigned long *)&vcpu->arch.regs_avail);\n\t__set_bit(reg, (unsigned long *)&vcpu->arch.regs_dirty);\n}"
  },
  {
    "function_name": "kvm_register_mark_available",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "52-56",
    "snippet": "static inline void kvm_register_mark_available(struct kvm_vcpu *vcpu,\n\t\t\t\t\t       enum kvm_reg reg)\n{\n\t__set_bit(reg, (unsigned long *)&vcpu->arch.regs_avail);\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__set_bit",
          "args": [
            "reg",
            "(unsigned long *)&vcpu->arch.regs_avail"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline void kvm_register_mark_available(struct kvm_vcpu *vcpu,\n\t\t\t\t\t       enum kvm_reg reg)\n{\n\t__set_bit(reg, (unsigned long *)&vcpu->arch.regs_avail);\n}"
  },
  {
    "function_name": "kvm_register_is_dirty",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "46-50",
    "snippet": "static inline bool kvm_register_is_dirty(struct kvm_vcpu *vcpu,\n\t\t\t\t\t enum kvm_reg reg)\n{\n\treturn test_bit(reg, (unsigned long *)&vcpu->arch.regs_dirty);\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "reg",
            "(unsigned long *)&vcpu->arch.regs_dirty"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline bool kvm_register_is_dirty(struct kvm_vcpu *vcpu,\n\t\t\t\t\t enum kvm_reg reg)\n{\n\treturn test_bit(reg, (unsigned long *)&vcpu->arch.regs_dirty);\n}"
  },
  {
    "function_name": "kvm_register_is_available",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/kvm_cache_regs.h",
    "lines": "40-44",
    "snippet": "static inline bool kvm_register_is_available(struct kvm_vcpu *vcpu,\n\t\t\t\t\t     enum kvm_reg reg)\n{\n\treturn test_bit(reg, (unsigned long *)&vcpu->arch.regs_avail);\n}",
    "includes": [
      "#include <linux/kvm_host.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "reg",
            "(unsigned long *)&vcpu->arch.regs_avail"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kvm_host.h>\n\nstatic inline bool kvm_register_is_available(struct kvm_vcpu *vcpu,\n\t\t\t\t\t     enum kvm_reg reg)\n{\n\treturn test_bit(reg, (unsigned long *)&vcpu->arch.regs_avail);\n}"
  }
]