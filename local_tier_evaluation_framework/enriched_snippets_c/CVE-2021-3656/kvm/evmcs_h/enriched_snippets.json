[
  {
    "function_name": "evmcs_touch_msr_bitmap",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
    "lines": "198-198",
    "snippet": "static inline void evmcs_touch_msr_bitmap(void) {}",
    "includes": [
      "#include \"vmcs12.h\"",
      "#include \"vmcs.h\"",
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/mshyperv.h>",
      "#include <asm/hyperv-tlfs.h>",
      "#include <linux/jump_label.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\nstatic inline void evmcs_touch_msr_bitmap(void) {}"
  },
  {
    "function_name": "evmcs_sanitize_exec_ctrls",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
    "lines": "197-197",
    "snippet": "static inline void evmcs_sanitize_exec_ctrls(struct vmcs_config *vmcs_conf) {}",
    "includes": [
      "#include \"vmcs12.h\"",
      "#include \"vmcs.h\"",
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/mshyperv.h>",
      "#include <asm/hyperv-tlfs.h>",
      "#include <linux/jump_label.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\nstatic inline void evmcs_sanitize_exec_ctrls(struct vmcs_config *vmcs_conf) {}"
  },
  {
    "function_name": "evmcs_load",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
    "lines": "196-196",
    "snippet": "static inline void evmcs_load(u64 phys_addr) {}",
    "includes": [
      "#include \"vmcs12.h\"",
      "#include \"vmcs.h\"",
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/mshyperv.h>",
      "#include <asm/hyperv-tlfs.h>",
      "#include <linux/jump_label.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\nstatic inline void evmcs_load(u64 phys_addr) {}"
  },
  {
    "function_name": "evmcs_read16",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
    "lines": "195-195",
    "snippet": "static inline u16 evmcs_read16(unsigned long field) { return 0; }",
    "includes": [
      "#include \"vmcs12.h\"",
      "#include \"vmcs.h\"",
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/mshyperv.h>",
      "#include <asm/hyperv-tlfs.h>",
      "#include <linux/jump_label.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\nstatic inline u16 evmcs_read16(unsigned long field) { return 0; }"
  },
  {
    "function_name": "evmcs_read32",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
    "lines": "194-194",
    "snippet": "static inline u32 evmcs_read32(unsigned long field) { return 0; }",
    "includes": [
      "#include \"vmcs12.h\"",
      "#include \"vmcs.h\"",
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/mshyperv.h>",
      "#include <asm/hyperv-tlfs.h>",
      "#include <linux/jump_label.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\nstatic inline u32 evmcs_read32(unsigned long field) { return 0; }"
  },
  {
    "function_name": "evmcs_read64",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
    "lines": "193-193",
    "snippet": "static inline u64 evmcs_read64(unsigned long field) { return 0; }",
    "includes": [
      "#include \"vmcs12.h\"",
      "#include \"vmcs.h\"",
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/mshyperv.h>",
      "#include <asm/hyperv-tlfs.h>",
      "#include <linux/jump_label.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\nstatic inline u64 evmcs_read64(unsigned long field) { return 0; }"
  },
  {
    "function_name": "evmcs_write16",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
    "lines": "192-192",
    "snippet": "static inline void evmcs_write16(unsigned long field, u16 value) {}",
    "includes": [
      "#include \"vmcs12.h\"",
      "#include \"vmcs.h\"",
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/mshyperv.h>",
      "#include <asm/hyperv-tlfs.h>",
      "#include <linux/jump_label.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\nstatic inline void evmcs_write16(unsigned long field, u16 value) {}"
  },
  {
    "function_name": "evmcs_write32",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
    "lines": "191-191",
    "snippet": "static inline void evmcs_write32(unsigned long field, u32 value) {}",
    "includes": [
      "#include \"vmcs12.h\"",
      "#include \"vmcs.h\"",
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/mshyperv.h>",
      "#include <asm/hyperv-tlfs.h>",
      "#include <linux/jump_label.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\nstatic inline void evmcs_write32(unsigned long field, u32 value) {}"
  },
  {
    "function_name": "evmcs_write64",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
    "lines": "190-190",
    "snippet": "static inline void evmcs_write64(unsigned long field, u64 value) {}",
    "includes": [
      "#include \"vmcs12.h\"",
      "#include \"vmcs.h\"",
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/mshyperv.h>",
      "#include <asm/hyperv-tlfs.h>",
      "#include <linux/jump_label.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\nstatic inline void evmcs_write64(unsigned long field, u64 value) {}"
  },
  {
    "function_name": "evmcs_load",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
    "lines": "177-186",
    "snippet": "static inline void evmcs_load(u64 phys_addr)\n{\n\tstruct hv_vp_assist_page *vp_ap =\n\t\thv_get_vp_assist_page(smp_processor_id());\n\n\tif (current_evmcs->hv_enlightenments_control.nested_flush_hypercall)\n\t\tvp_ap->nested_control.features.directhypercall = 1;\n\tvp_ap->current_nested_vmcs = phys_addr;\n\tvp_ap->enlighten_vmentry = 1;\n}",
    "includes": [
      "#include \"vmcs12.h\"",
      "#include \"vmcs.h\"",
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/mshyperv.h>",
      "#include <asm/hyperv-tlfs.h>",
      "#include <linux/jump_label.h>"
    ],
    "macros_used": [
      "#define current_evmcs ((struct hv_enlightened_vmcs *)this_cpu_read(current_vmcs))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hv_get_vp_assist_page",
          "args": [
            "smp_processor_id()"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\n#define current_evmcs ((struct hv_enlightened_vmcs *)this_cpu_read(current_vmcs))\n\nstatic inline void evmcs_load(u64 phys_addr)\n{\n\tstruct hv_vp_assist_page *vp_ap =\n\t\thv_get_vp_assist_page(smp_processor_id());\n\n\tif (current_evmcs->hv_enlightenments_control.nested_flush_hypercall)\n\t\tvp_ap->nested_control.features.directhypercall = 1;\n\tvp_ap->current_nested_vmcs = phys_addr;\n\tvp_ap->enlighten_vmentry = 1;\n}"
  },
  {
    "function_name": "evmcs_touch_msr_bitmap",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
    "lines": "167-175",
    "snippet": "static inline void evmcs_touch_msr_bitmap(void)\n{\n\tif (unlikely(!current_evmcs))\n\t\treturn;\n\n\tif (current_evmcs->hv_enlightenments_control.msr_bitmap)\n\t\tcurrent_evmcs->hv_clean_fields &=\n\t\t\t~HV_VMX_ENLIGHTENED_CLEAN_FIELD_MSR_BITMAP;\n}",
    "includes": [
      "#include \"vmcs12.h\"",
      "#include \"vmcs.h\"",
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/mshyperv.h>",
      "#include <asm/hyperv-tlfs.h>",
      "#include <linux/jump_label.h>"
    ],
    "macros_used": [
      "#define current_evmcs ((struct hv_enlightened_vmcs *)this_cpu_read(current_vmcs))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!current_evmcs"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\n#define current_evmcs ((struct hv_enlightened_vmcs *)this_cpu_read(current_vmcs))\n\nstatic inline void evmcs_touch_msr_bitmap(void)\n{\n\tif (unlikely(!current_evmcs))\n\t\treturn;\n\n\tif (current_evmcs->hv_enlightenments_control.msr_bitmap)\n\t\tcurrent_evmcs->hv_clean_fields &=\n\t\t\t~HV_VMX_ENLIGHTENED_CLEAN_FIELD_MSR_BITMAP;\n}"
  },
  {
    "function_name": "evmcs_read16",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
    "lines": "157-165",
    "snippet": "static inline u16 evmcs_read16(unsigned long field)\n{\n\tint offset = get_evmcs_offset(field, NULL);\n\n\tif (offset < 0)\n\t\treturn 0;\n\n\treturn *(u16 *)((char *)current_evmcs + offset);\n}",
    "includes": [
      "#include \"vmcs12.h\"",
      "#include \"vmcs.h\"",
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/mshyperv.h>",
      "#include <asm/hyperv-tlfs.h>",
      "#include <linux/jump_label.h>"
    ],
    "macros_used": [
      "#define current_evmcs ((struct hv_enlightened_vmcs *)this_cpu_read(current_vmcs))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_evmcs_offset",
          "args": [
            "field",
            "NULL"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "get_evmcs_offset",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
          "lines": "78-96",
          "snippet": "static __always_inline int get_evmcs_offset(unsigned long field,\n\t\t\t\t\t    u16 *clean_field)\n{\n\tunsigned int index = ROL16(field, 6);\n\tconst struct evmcs_field *evmcs_field;\n\n\tif (unlikely(index >= nr_evmcs_1_fields)) {\n\t\tWARN_ONCE(1, \"KVM: accessing unsupported EVMCS field %lx\\n\",\n\t\t\t  field);\n\t\treturn -ENOENT;\n\t}\n\n\tevmcs_field = &vmcs_field_to_evmcs_1[index];\n\n\tif (clean_field)\n\t\t*clean_field = evmcs_field->clean_field;\n\n\treturn evmcs_field->offset;\n}",
          "includes": [
            "#include \"vmcs12.h\"",
            "#include \"vmcs.h\"",
            "#include \"capabilities.h\"",
            "#include <asm/vmx.h>",
            "#include <asm/mshyperv.h>",
            "#include <asm/hyperv-tlfs.h>",
            "#include <linux/jump_label.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\nstatic __always_inline int get_evmcs_offset(unsigned long field,\n\t\t\t\t\t    u16 *clean_field)\n{\n\tunsigned int index = ROL16(field, 6);\n\tconst struct evmcs_field *evmcs_field;\n\n\tif (unlikely(index >= nr_evmcs_1_fields)) {\n\t\tWARN_ONCE(1, \"KVM: accessing unsupported EVMCS field %lx\\n\",\n\t\t\t  field);\n\t\treturn -ENOENT;\n\t}\n\n\tevmcs_field = &vmcs_field_to_evmcs_1[index];\n\n\tif (clean_field)\n\t\t*clean_field = evmcs_field->clean_field;\n\n\treturn evmcs_field->offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\n#define current_evmcs ((struct hv_enlightened_vmcs *)this_cpu_read(current_vmcs))\n\nstatic inline u16 evmcs_read16(unsigned long field)\n{\n\tint offset = get_evmcs_offset(field, NULL);\n\n\tif (offset < 0)\n\t\treturn 0;\n\n\treturn *(u16 *)((char *)current_evmcs + offset);\n}"
  },
  {
    "function_name": "evmcs_read32",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
    "lines": "147-155",
    "snippet": "static inline u32 evmcs_read32(unsigned long field)\n{\n\tint offset = get_evmcs_offset(field, NULL);\n\n\tif (offset < 0)\n\t\treturn 0;\n\n\treturn *(u32 *)((char *)current_evmcs + offset);\n}",
    "includes": [
      "#include \"vmcs12.h\"",
      "#include \"vmcs.h\"",
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/mshyperv.h>",
      "#include <asm/hyperv-tlfs.h>",
      "#include <linux/jump_label.h>"
    ],
    "macros_used": [
      "#define current_evmcs ((struct hv_enlightened_vmcs *)this_cpu_read(current_vmcs))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_evmcs_offset",
          "args": [
            "field",
            "NULL"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "get_evmcs_offset",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
          "lines": "78-96",
          "snippet": "static __always_inline int get_evmcs_offset(unsigned long field,\n\t\t\t\t\t    u16 *clean_field)\n{\n\tunsigned int index = ROL16(field, 6);\n\tconst struct evmcs_field *evmcs_field;\n\n\tif (unlikely(index >= nr_evmcs_1_fields)) {\n\t\tWARN_ONCE(1, \"KVM: accessing unsupported EVMCS field %lx\\n\",\n\t\t\t  field);\n\t\treturn -ENOENT;\n\t}\n\n\tevmcs_field = &vmcs_field_to_evmcs_1[index];\n\n\tif (clean_field)\n\t\t*clean_field = evmcs_field->clean_field;\n\n\treturn evmcs_field->offset;\n}",
          "includes": [
            "#include \"vmcs12.h\"",
            "#include \"vmcs.h\"",
            "#include \"capabilities.h\"",
            "#include <asm/vmx.h>",
            "#include <asm/mshyperv.h>",
            "#include <asm/hyperv-tlfs.h>",
            "#include <linux/jump_label.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\nstatic __always_inline int get_evmcs_offset(unsigned long field,\n\t\t\t\t\t    u16 *clean_field)\n{\n\tunsigned int index = ROL16(field, 6);\n\tconst struct evmcs_field *evmcs_field;\n\n\tif (unlikely(index >= nr_evmcs_1_fields)) {\n\t\tWARN_ONCE(1, \"KVM: accessing unsupported EVMCS field %lx\\n\",\n\t\t\t  field);\n\t\treturn -ENOENT;\n\t}\n\n\tevmcs_field = &vmcs_field_to_evmcs_1[index];\n\n\tif (clean_field)\n\t\t*clean_field = evmcs_field->clean_field;\n\n\treturn evmcs_field->offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\n#define current_evmcs ((struct hv_enlightened_vmcs *)this_cpu_read(current_vmcs))\n\nstatic inline u32 evmcs_read32(unsigned long field)\n{\n\tint offset = get_evmcs_offset(field, NULL);\n\n\tif (offset < 0)\n\t\treturn 0;\n\n\treturn *(u32 *)((char *)current_evmcs + offset);\n}"
  },
  {
    "function_name": "evmcs_read64",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
    "lines": "137-145",
    "snippet": "static inline u64 evmcs_read64(unsigned long field)\n{\n\tint offset = get_evmcs_offset(field, NULL);\n\n\tif (offset < 0)\n\t\treturn 0;\n\n\treturn *(u64 *)((char *)current_evmcs + offset);\n}",
    "includes": [
      "#include \"vmcs12.h\"",
      "#include \"vmcs.h\"",
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/mshyperv.h>",
      "#include <asm/hyperv-tlfs.h>",
      "#include <linux/jump_label.h>"
    ],
    "macros_used": [
      "#define current_evmcs ((struct hv_enlightened_vmcs *)this_cpu_read(current_vmcs))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_evmcs_offset",
          "args": [
            "field",
            "NULL"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "get_evmcs_offset",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
          "lines": "78-96",
          "snippet": "static __always_inline int get_evmcs_offset(unsigned long field,\n\t\t\t\t\t    u16 *clean_field)\n{\n\tunsigned int index = ROL16(field, 6);\n\tconst struct evmcs_field *evmcs_field;\n\n\tif (unlikely(index >= nr_evmcs_1_fields)) {\n\t\tWARN_ONCE(1, \"KVM: accessing unsupported EVMCS field %lx\\n\",\n\t\t\t  field);\n\t\treturn -ENOENT;\n\t}\n\n\tevmcs_field = &vmcs_field_to_evmcs_1[index];\n\n\tif (clean_field)\n\t\t*clean_field = evmcs_field->clean_field;\n\n\treturn evmcs_field->offset;\n}",
          "includes": [
            "#include \"vmcs12.h\"",
            "#include \"vmcs.h\"",
            "#include \"capabilities.h\"",
            "#include <asm/vmx.h>",
            "#include <asm/mshyperv.h>",
            "#include <asm/hyperv-tlfs.h>",
            "#include <linux/jump_label.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\nstatic __always_inline int get_evmcs_offset(unsigned long field,\n\t\t\t\t\t    u16 *clean_field)\n{\n\tunsigned int index = ROL16(field, 6);\n\tconst struct evmcs_field *evmcs_field;\n\n\tif (unlikely(index >= nr_evmcs_1_fields)) {\n\t\tWARN_ONCE(1, \"KVM: accessing unsupported EVMCS field %lx\\n\",\n\t\t\t  field);\n\t\treturn -ENOENT;\n\t}\n\n\tevmcs_field = &vmcs_field_to_evmcs_1[index];\n\n\tif (clean_field)\n\t\t*clean_field = evmcs_field->clean_field;\n\n\treturn evmcs_field->offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\n#define current_evmcs ((struct hv_enlightened_vmcs *)this_cpu_read(current_vmcs))\n\nstatic inline u64 evmcs_read64(unsigned long field)\n{\n\tint offset = get_evmcs_offset(field, NULL);\n\n\tif (offset < 0)\n\t\treturn 0;\n\n\treturn *(u64 *)((char *)current_evmcs + offset);\n}"
  },
  {
    "function_name": "evmcs_write16",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
    "lines": "125-135",
    "snippet": "static inline void evmcs_write16(unsigned long field, u16 value)\n{\n\tu16 clean_field;\n\tint offset = get_evmcs_offset(field, &clean_field);\n\n\tif (offset < 0)\n\t\treturn;\n\n\t*(u16 *)((char *)current_evmcs + offset) = value;\n\tcurrent_evmcs->hv_clean_fields &= ~clean_field;\n}",
    "includes": [
      "#include \"vmcs12.h\"",
      "#include \"vmcs.h\"",
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/mshyperv.h>",
      "#include <asm/hyperv-tlfs.h>",
      "#include <linux/jump_label.h>"
    ],
    "macros_used": [
      "#define current_evmcs ((struct hv_enlightened_vmcs *)this_cpu_read(current_vmcs))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_evmcs_offset",
          "args": [
            "field",
            "&clean_field"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "get_evmcs_offset",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
          "lines": "78-96",
          "snippet": "static __always_inline int get_evmcs_offset(unsigned long field,\n\t\t\t\t\t    u16 *clean_field)\n{\n\tunsigned int index = ROL16(field, 6);\n\tconst struct evmcs_field *evmcs_field;\n\n\tif (unlikely(index >= nr_evmcs_1_fields)) {\n\t\tWARN_ONCE(1, \"KVM: accessing unsupported EVMCS field %lx\\n\",\n\t\t\t  field);\n\t\treturn -ENOENT;\n\t}\n\n\tevmcs_field = &vmcs_field_to_evmcs_1[index];\n\n\tif (clean_field)\n\t\t*clean_field = evmcs_field->clean_field;\n\n\treturn evmcs_field->offset;\n}",
          "includes": [
            "#include \"vmcs12.h\"",
            "#include \"vmcs.h\"",
            "#include \"capabilities.h\"",
            "#include <asm/vmx.h>",
            "#include <asm/mshyperv.h>",
            "#include <asm/hyperv-tlfs.h>",
            "#include <linux/jump_label.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\nstatic __always_inline int get_evmcs_offset(unsigned long field,\n\t\t\t\t\t    u16 *clean_field)\n{\n\tunsigned int index = ROL16(field, 6);\n\tconst struct evmcs_field *evmcs_field;\n\n\tif (unlikely(index >= nr_evmcs_1_fields)) {\n\t\tWARN_ONCE(1, \"KVM: accessing unsupported EVMCS field %lx\\n\",\n\t\t\t  field);\n\t\treturn -ENOENT;\n\t}\n\n\tevmcs_field = &vmcs_field_to_evmcs_1[index];\n\n\tif (clean_field)\n\t\t*clean_field = evmcs_field->clean_field;\n\n\treturn evmcs_field->offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\n#define current_evmcs ((struct hv_enlightened_vmcs *)this_cpu_read(current_vmcs))\n\nstatic inline void evmcs_write16(unsigned long field, u16 value)\n{\n\tu16 clean_field;\n\tint offset = get_evmcs_offset(field, &clean_field);\n\n\tif (offset < 0)\n\t\treturn;\n\n\t*(u16 *)((char *)current_evmcs + offset) = value;\n\tcurrent_evmcs->hv_clean_fields &= ~clean_field;\n}"
  },
  {
    "function_name": "evmcs_write32",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
    "lines": "113-123",
    "snippet": "static inline void evmcs_write32(unsigned long field, u32 value)\n{\n\tu16 clean_field;\n\tint offset = get_evmcs_offset(field, &clean_field);\n\n\tif (offset < 0)\n\t\treturn;\n\n\t*(u32 *)((char *)current_evmcs + offset) = value;\n\tcurrent_evmcs->hv_clean_fields &= ~clean_field;\n}",
    "includes": [
      "#include \"vmcs12.h\"",
      "#include \"vmcs.h\"",
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/mshyperv.h>",
      "#include <asm/hyperv-tlfs.h>",
      "#include <linux/jump_label.h>"
    ],
    "macros_used": [
      "#define current_evmcs ((struct hv_enlightened_vmcs *)this_cpu_read(current_vmcs))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_evmcs_offset",
          "args": [
            "field",
            "&clean_field"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "get_evmcs_offset",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
          "lines": "78-96",
          "snippet": "static __always_inline int get_evmcs_offset(unsigned long field,\n\t\t\t\t\t    u16 *clean_field)\n{\n\tunsigned int index = ROL16(field, 6);\n\tconst struct evmcs_field *evmcs_field;\n\n\tif (unlikely(index >= nr_evmcs_1_fields)) {\n\t\tWARN_ONCE(1, \"KVM: accessing unsupported EVMCS field %lx\\n\",\n\t\t\t  field);\n\t\treturn -ENOENT;\n\t}\n\n\tevmcs_field = &vmcs_field_to_evmcs_1[index];\n\n\tif (clean_field)\n\t\t*clean_field = evmcs_field->clean_field;\n\n\treturn evmcs_field->offset;\n}",
          "includes": [
            "#include \"vmcs12.h\"",
            "#include \"vmcs.h\"",
            "#include \"capabilities.h\"",
            "#include <asm/vmx.h>",
            "#include <asm/mshyperv.h>",
            "#include <asm/hyperv-tlfs.h>",
            "#include <linux/jump_label.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\nstatic __always_inline int get_evmcs_offset(unsigned long field,\n\t\t\t\t\t    u16 *clean_field)\n{\n\tunsigned int index = ROL16(field, 6);\n\tconst struct evmcs_field *evmcs_field;\n\n\tif (unlikely(index >= nr_evmcs_1_fields)) {\n\t\tWARN_ONCE(1, \"KVM: accessing unsupported EVMCS field %lx\\n\",\n\t\t\t  field);\n\t\treturn -ENOENT;\n\t}\n\n\tevmcs_field = &vmcs_field_to_evmcs_1[index];\n\n\tif (clean_field)\n\t\t*clean_field = evmcs_field->clean_field;\n\n\treturn evmcs_field->offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\n#define current_evmcs ((struct hv_enlightened_vmcs *)this_cpu_read(current_vmcs))\n\nstatic inline void evmcs_write32(unsigned long field, u32 value)\n{\n\tu16 clean_field;\n\tint offset = get_evmcs_offset(field, &clean_field);\n\n\tif (offset < 0)\n\t\treturn;\n\n\t*(u32 *)((char *)current_evmcs + offset) = value;\n\tcurrent_evmcs->hv_clean_fields &= ~clean_field;\n}"
  },
  {
    "function_name": "evmcs_write64",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
    "lines": "100-111",
    "snippet": "static inline void evmcs_write64(unsigned long field, u64 value)\n{\n\tu16 clean_field;\n\tint offset = get_evmcs_offset(field, &clean_field);\n\n\tif (offset < 0)\n\t\treturn;\n\n\t*(u64 *)((char *)current_evmcs + offset) = value;\n\n\tcurrent_evmcs->hv_clean_fields &= ~clean_field;\n}",
    "includes": [
      "#include \"vmcs12.h\"",
      "#include \"vmcs.h\"",
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/mshyperv.h>",
      "#include <asm/hyperv-tlfs.h>",
      "#include <linux/jump_label.h>"
    ],
    "macros_used": [
      "#define current_evmcs ((struct hv_enlightened_vmcs *)this_cpu_read(current_vmcs))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_evmcs_offset",
          "args": [
            "field",
            "&clean_field"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "get_evmcs_offset",
          "container": null,
          "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
          "lines": "78-96",
          "snippet": "static __always_inline int get_evmcs_offset(unsigned long field,\n\t\t\t\t\t    u16 *clean_field)\n{\n\tunsigned int index = ROL16(field, 6);\n\tconst struct evmcs_field *evmcs_field;\n\n\tif (unlikely(index >= nr_evmcs_1_fields)) {\n\t\tWARN_ONCE(1, \"KVM: accessing unsupported EVMCS field %lx\\n\",\n\t\t\t  field);\n\t\treturn -ENOENT;\n\t}\n\n\tevmcs_field = &vmcs_field_to_evmcs_1[index];\n\n\tif (clean_field)\n\t\t*clean_field = evmcs_field->clean_field;\n\n\treturn evmcs_field->offset;\n}",
          "includes": [
            "#include \"vmcs12.h\"",
            "#include \"vmcs.h\"",
            "#include \"capabilities.h\"",
            "#include <asm/vmx.h>",
            "#include <asm/mshyperv.h>",
            "#include <asm/hyperv-tlfs.h>",
            "#include <linux/jump_label.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\nstatic __always_inline int get_evmcs_offset(unsigned long field,\n\t\t\t\t\t    u16 *clean_field)\n{\n\tunsigned int index = ROL16(field, 6);\n\tconst struct evmcs_field *evmcs_field;\n\n\tif (unlikely(index >= nr_evmcs_1_fields)) {\n\t\tWARN_ONCE(1, \"KVM: accessing unsupported EVMCS field %lx\\n\",\n\t\t\t  field);\n\t\treturn -ENOENT;\n\t}\n\n\tevmcs_field = &vmcs_field_to_evmcs_1[index];\n\n\tif (clean_field)\n\t\t*clean_field = evmcs_field->clean_field;\n\n\treturn evmcs_field->offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\n#define current_evmcs ((struct hv_enlightened_vmcs *)this_cpu_read(current_vmcs))\n\nstatic inline void evmcs_write64(unsigned long field, u64 value)\n{\n\tu16 clean_field;\n\tint offset = get_evmcs_offset(field, &clean_field);\n\n\tif (offset < 0)\n\t\treturn;\n\n\t*(u64 *)((char *)current_evmcs + offset) = value;\n\n\tcurrent_evmcs->hv_clean_fields &= ~clean_field;\n}"
  },
  {
    "function_name": "get_evmcs_offset",
    "container": null,
    "file": "output_repos_c_ICV/CVE-2021-3656/repo/arch/x86/kvm/vmx/evmcs.h",
    "lines": "78-96",
    "snippet": "static __always_inline int get_evmcs_offset(unsigned long field,\n\t\t\t\t\t    u16 *clean_field)\n{\n\tunsigned int index = ROL16(field, 6);\n\tconst struct evmcs_field *evmcs_field;\n\n\tif (unlikely(index >= nr_evmcs_1_fields)) {\n\t\tWARN_ONCE(1, \"KVM: accessing unsupported EVMCS field %lx\\n\",\n\t\t\t  field);\n\t\treturn -ENOENT;\n\t}\n\n\tevmcs_field = &vmcs_field_to_evmcs_1[index];\n\n\tif (clean_field)\n\t\t*clean_field = evmcs_field->clean_field;\n\n\treturn evmcs_field->offset;\n}",
    "includes": [
      "#include \"vmcs12.h\"",
      "#include \"vmcs.h\"",
      "#include \"capabilities.h\"",
      "#include <asm/vmx.h>",
      "#include <asm/mshyperv.h>",
      "#include <asm/hyperv-tlfs.h>",
      "#include <linux/jump_label.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "1",
            "\"KVM: accessing unsupported EVMCS field %lx\\n\"",
            "field"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "index >= nr_evmcs_1_fields"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ROL16",
          "args": [
            "field",
            "6"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vmcs12.h\"\n#include \"vmcs.h\"\n#include \"capabilities.h\"\n#include <asm/vmx.h>\n#include <asm/mshyperv.h>\n#include <asm/hyperv-tlfs.h>\n#include <linux/jump_label.h>\n\nstatic __always_inline int get_evmcs_offset(unsigned long field,\n\t\t\t\t\t    u16 *clean_field)\n{\n\tunsigned int index = ROL16(field, 6);\n\tconst struct evmcs_field *evmcs_field;\n\n\tif (unlikely(index >= nr_evmcs_1_fields)) {\n\t\tWARN_ONCE(1, \"KVM: accessing unsupported EVMCS field %lx\\n\",\n\t\t\t  field);\n\t\treturn -ENOENT;\n\t}\n\n\tevmcs_field = &vmcs_field_to_evmcs_1[index];\n\n\tif (clean_field)\n\t\t*clean_field = evmcs_field->clean_field;\n\n\treturn evmcs_field->offset;\n}"
  }
]