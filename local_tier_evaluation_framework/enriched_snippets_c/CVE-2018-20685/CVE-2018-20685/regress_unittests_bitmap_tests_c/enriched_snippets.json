[
  {
    "function_name": "tests",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/bitmap/tests.c",
    "lines": "27-134",
    "snippet": "void\ntests(void)\n{\n\tstruct bitmap *b;\n\tBIGNUM *bn;\n\tsize_t len;\n\tint i, j, k, n;\n\tu_char bbuf[1024], bnbuf[1024];\n\tint r;\n\n\tTEST_START(\"bitmap_new\");\n\tb = bitmap_new();\n\tASSERT_PTR_NE(b, NULL);\n\tbn = BN_new();\n\tASSERT_PTR_NE(bn, NULL);\n\tTEST_DONE();\n\n\tTEST_START(\"bitmap_set_bit / bitmap_test_bit\");\n\tfor (i = -1; i < NTESTS; i++) {\n\t\tfor (j = -1; j < NTESTS; j++) {\n\t\t\tfor (k = -1; k < NTESTS; k++) {\n\t\t\t\tbitmap_zero(b);\n\t\t\t\tBN_clear(bn);\n\n\t\t\t\ttest_subtest_info(\"set %d/%d/%d\", i, j, k);\n\t\t\t\t/* Set bits */\n\t\t\t\tif (i >= 0) {\n\t\t\t\t\tASSERT_INT_EQ(bitmap_set_bit(b, i), 0);\n\t\t\t\t\tASSERT_INT_EQ(BN_set_bit(bn, i), 1);\n\t\t\t\t}\n\t\t\t\tif (j >= 0) {\n\t\t\t\t\tASSERT_INT_EQ(bitmap_set_bit(b, j), 0);\n\t\t\t\t\tASSERT_INT_EQ(BN_set_bit(bn, j), 1);\n\t\t\t\t}\n\t\t\t\tif (k >= 0) {\n\t\t\t\t\tASSERT_INT_EQ(bitmap_set_bit(b, k), 0);\n\t\t\t\t\tASSERT_INT_EQ(BN_set_bit(bn, k), 1);\n\t\t\t\t}\n\n\t\t\t\t/* Check perfect match between bitmap and bn */\n\t\t\t\ttest_subtest_info(\"match %d/%d/%d\", i, j, k);\n\t\t\t\tfor (n = 0; n < NTESTS; n++) {\n\t\t\t\t\tASSERT_INT_EQ(BN_is_bit_set(bn, n),\n\t\t\t\t\t    bitmap_test_bit(b, n));\n\t\t\t\t}\n\n\t\t\t\t/* Test length calculations */\n\t\t\t\ttest_subtest_info(\"length %d/%d/%d\", i, j, k);\n\t\t\t\tASSERT_INT_EQ(BN_num_bits(bn),\n\t\t\t\t    (int)bitmap_nbits(b));\n\t\t\t\tASSERT_INT_EQ(BN_num_bytes(bn),\n\t\t\t\t    (int)bitmap_nbytes(b));\n\n\t\t\t\t/* Test serialisation */\n\t\t\t\ttest_subtest_info(\"serialise %d/%d/%d\",\n\t\t\t\t    i, j, k);\n\t\t\t\tlen = bitmap_nbytes(b);\n\t\t\t\tmemset(bbuf, 0xfc, sizeof(bbuf));\n\t\t\t\tASSERT_INT_EQ(bitmap_to_string(b, bbuf,\n\t\t\t\t    sizeof(bbuf)), 0);\n\t\t\t\tfor (n = len; n < (int)sizeof(bbuf); n++)\n\t\t\t\t\tASSERT_U8_EQ(bbuf[n], 0xfc);\n\t\t\t\tr = BN_bn2bin(bn, bnbuf);\n\t\t\t\tASSERT_INT_GE(r, 0);\n\t\t\t\tASSERT_INT_EQ(r, (int)len);\n\t\t\t\tASSERT_MEM_EQ(bbuf, bnbuf, len);\n\n\t\t\t\t/* Test deserialisation */\n\t\t\t\ttest_subtest_info(\"deserialise %d/%d/%d\",\n\t\t\t\t    i, j, k);\n\t\t\t\tbitmap_zero(b);\n\t\t\t\tASSERT_INT_EQ(bitmap_from_string(b, bnbuf,\n\t\t\t\t    len), 0);\n\t\t\t\tfor (n = 0; n < NTESTS; n++) {\n\t\t\t\t\tASSERT_INT_EQ(BN_is_bit_set(bn, n),\n\t\t\t\t\t    bitmap_test_bit(b, n));\n\t\t\t\t}\n\n\t\t\t\t/* Test clearing bits */\n\t\t\t\ttest_subtest_info(\"clear %d/%d/%d\",\n\t\t\t\t    i, j, k);\n\t\t\t\tfor (n = 0; n < NTESTS; n++) {\n\t\t\t\t\tASSERT_INT_EQ(bitmap_set_bit(b, n), 0);\n\t\t\t\t\tASSERT_INT_EQ(BN_set_bit(bn, n), 1);\n\t\t\t\t}\n\t\t\t\tif (i >= 0) {\n\t\t\t\t\tbitmap_clear_bit(b, i);\n\t\t\t\t\tBN_clear_bit(bn, i);\n\t\t\t\t}\n\t\t\t\tif (j >= 0) {\n\t\t\t\t\tbitmap_clear_bit(b, j);\n\t\t\t\t\tBN_clear_bit(bn, j);\n\t\t\t\t}\n\t\t\t\tif (k >= 0) {\n\t\t\t\t\tbitmap_clear_bit(b, k);\n\t\t\t\t\tBN_clear_bit(bn, k);\n\t\t\t\t}\n\t\t\t\tfor (n = 0; n < NTESTS; n++) {\n\t\t\t\t\tASSERT_INT_EQ(BN_is_bit_set(bn, n),\n\t\t\t\t\t    bitmap_test_bit(b, n));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tbitmap_free(b);\n\tBN_free(bn);\n\tTEST_DONE();\n}",
    "includes": [
      "#include \"bitmap.h\"",
      "#include \"../test_helper/test_helper.h\"",
      "#include <openssl/bn.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define NTESTS 131"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitmap_free",
          "args": [
            "b"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "bitmap_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "53-62",
          "snippet": "void\nbitmap_free(struct bitmap *b)\n{\n\tif (b != NULL && b->d != NULL) {\n\t\tbitmap_zero(b);\n\t\tfree(b->d);\n\t\tb->d = NULL;\n\t}\n\tfree(b);\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nbitmap_free(struct bitmap *b)\n{\n\tif (b != NULL && b->d != NULL) {\n\t\tbitmap_zero(b);\n\t\tfree(b->d);\n\t\tb->d = NULL;\n\t}\n\tfree(b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "BN_is_bit_set(bn, n)",
            "bitmap_test_bit(b, n)"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitmap_test_bit",
          "args": [
            "b",
            "n"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "bitmap_test_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "71-79",
          "snippet": "int\nbitmap_test_bit(struct bitmap *b, u_int n)\n{\n\tif (b->top >= b->len)\n\t\treturn 0; /* invalid */\n\tif (b->len == 0 || (n / BITMAP_BITS) > b->top)\n\t\treturn 0;\n\treturn (b->d[n / BITMAP_BITS] >> (n & BITMAP_WMASK)) & 1;\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define BITMAP_WMASK\t((BITMAP_WTYPE)BITMAP_BITS - 1)",
            "#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_WMASK\t((BITMAP_WTYPE)BITMAP_BITS - 1)\n#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)\n\nint\nbitmap_test_bit(struct bitmap *b, u_int n)\n{\n\tif (b->top >= b->len)\n\t\treturn 0; /* invalid */\n\tif (b->len == 0 || (n / BITMAP_BITS) > b->top)\n\t\treturn 0;\n\treturn (b->d[n / BITMAP_BITS] >> (n & BITMAP_WMASK)) & 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_is_bit_set",
          "args": [
            "bn",
            "n"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_clear_bit",
          "args": [
            "bn",
            "k"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitmap_clear_bit",
          "args": [
            "b",
            "k"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "bitmap_clear_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "125-138",
          "snippet": "void\nbitmap_clear_bit(struct bitmap *b, u_int n)\n{\n\tsize_t offset;\n\n\tif (b->top >= b->len || n > BITMAP_MAX)\n\t\treturn; /* invalid */\n\toffset = n / BITMAP_BITS;\n\tif (offset > b->top)\n\t\treturn;\n\tb->d[offset] &= ~((BITMAP_WTYPE)1 << (n & BITMAP_WMASK));\n\t/* The top may have changed as a result of the clear */\n\tretop(b);\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define BITMAP_WMASK\t((BITMAP_WTYPE)BITMAP_BITS - 1)",
            "#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)",
            "#define BITMAP_MAX\t(1<<24)",
            "#define BITMAP_WTYPE\tu_int"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_WMASK\t((BITMAP_WTYPE)BITMAP_BITS - 1)\n#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)\n#define BITMAP_MAX\t(1<<24)\n#define BITMAP_WTYPE\tu_int\n\nvoid\nbitmap_clear_bit(struct bitmap *b, u_int n)\n{\n\tsize_t offset;\n\n\tif (b->top >= b->len || n > BITMAP_MAX)\n\t\treturn; /* invalid */\n\toffset = n / BITMAP_BITS;\n\tif (offset > b->top)\n\t\treturn;\n\tb->d[offset] &= ~((BITMAP_WTYPE)1 << (n & BITMAP_WMASK));\n\t/* The top may have changed as a result of the clear */\n\tretop(b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_clear_bit",
          "args": [
            "bn",
            "j"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_clear_bit",
          "args": [
            "bn",
            "i"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "BN_set_bit(bn, n)",
            "1"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_set_bit",
          "args": [
            "bn",
            "n"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "bitmap_set_bit(b, n)",
            "0"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitmap_set_bit",
          "args": [
            "b",
            "n"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "bitmap_set_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "100-113",
          "snippet": "int\nbitmap_set_bit(struct bitmap *b, u_int n)\n{\n\tint r;\n\tsize_t offset;\n\n\tif ((r = reserve(b, n)) != 0)\n\t\treturn r;\n\toffset = n / BITMAP_BITS;\n\tif (offset > b->top)\n\t\tb->top = offset;\n\tb->d[offset] |= (BITMAP_WTYPE)1 << (n & BITMAP_WMASK);\n\treturn 0;\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define BITMAP_WMASK\t((BITMAP_WTYPE)BITMAP_BITS - 1)",
            "#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)",
            "#define BITMAP_WTYPE\tu_int"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_WMASK\t((BITMAP_WTYPE)BITMAP_BITS - 1)\n#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)\n#define BITMAP_WTYPE\tu_int\n\nint\nbitmap_set_bit(struct bitmap *b, u_int n)\n{\n\tint r;\n\tsize_t offset;\n\n\tif ((r = reserve(b, n)) != 0)\n\t\treturn r;\n\toffset = n / BITMAP_BITS;\n\tif (offset > b->top)\n\t\tb->top = offset;\n\tb->d[offset] |= (BITMAP_WTYPE)1 << (n & BITMAP_WMASK);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_subtest_info",
          "args": [
            "\"clear %d/%d/%d\"",
            "i",
            "j",
            "k"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "test_subtest_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "252-260",
          "snippet": "void\ntest_subtest_info(const char *fmt, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tvsnprintf(subtest_info, sizeof(subtest_info), fmt, ap);\n\tva_end(ap);\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static char subtest_info[512];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char subtest_info[512];\n\nvoid\ntest_subtest_info(const char *fmt, ...)\n{\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tvsnprintf(subtest_info, sizeof(subtest_info), fmt, ap);\n\tva_end(ap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "BN_is_bit_set(bn, n)",
            "bitmap_test_bit(b, n)"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_is_bit_set",
          "args": [
            "bn",
            "n"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "bitmap_from_string(b, bnbuf,\n\t\t\t\t    len)",
            "0"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitmap_from_string",
          "args": [
            "b",
            "bnbuf",
            "len"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "bitmap_from_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "188-214",
          "snippet": "int\nbitmap_from_string(struct bitmap *b, const void *p, size_t l)\n{\n\tint r;\n\tsize_t i, offset, shift;\n\tconst u_char *s = (const u_char *)p;\n\n\tif (l > BITMAP_MAX / 8)\n\t\treturn -1;\n\tif ((r = reserve(b, l * 8)) != 0)\n\t\treturn r;\n\tbitmap_zero(b);\n\tif (l == 0)\n\t\treturn 0;\n\tb->top = offset = ((l + (BITMAP_BYTES - 1)) / BITMAP_BYTES) - 1;\n\tshift = ((l + (BITMAP_BYTES - 1)) % BITMAP_BYTES) * 8;\n\tfor (i = 0; i < l; i++) {\n\t\tb->d[offset] |= (BITMAP_WTYPE)s[i] << shift;\n\t\tif (shift == 0) {\n\t\t\toffset--;\n\t\t\tshift = BITMAP_BITS - 8;\n\t\t} else\n\t\t\tshift -= 8;\n\t}\n\tretop(b);\n\treturn 0;\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)",
            "#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))",
            "#define BITMAP_MAX\t(1<<24)",
            "#define BITMAP_WTYPE\tu_int"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)\n#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))\n#define BITMAP_MAX\t(1<<24)\n#define BITMAP_WTYPE\tu_int\n\nint\nbitmap_from_string(struct bitmap *b, const void *p, size_t l)\n{\n\tint r;\n\tsize_t i, offset, shift;\n\tconst u_char *s = (const u_char *)p;\n\n\tif (l > BITMAP_MAX / 8)\n\t\treturn -1;\n\tif ((r = reserve(b, l * 8)) != 0)\n\t\treturn r;\n\tbitmap_zero(b);\n\tif (l == 0)\n\t\treturn 0;\n\tb->top = offset = ((l + (BITMAP_BYTES - 1)) / BITMAP_BYTES) - 1;\n\tshift = ((l + (BITMAP_BYTES - 1)) % BITMAP_BYTES) * 8;\n\tfor (i = 0; i < l; i++) {\n\t\tb->d[offset] |= (BITMAP_WTYPE)s[i] << shift;\n\t\tif (shift == 0) {\n\t\t\toffset--;\n\t\t\tshift = BITMAP_BITS - 8;\n\t\t} else\n\t\t\tshift -= 8;\n\t}\n\tretop(b);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bitmap_zero",
          "args": [
            "b"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "bitmap_zero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "64-69",
          "snippet": "void\nbitmap_zero(struct bitmap *b)\n{\n\tmemset(b->d, 0, b->len * BITMAP_BYTES);\n\tb->top = 0;\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))\n\nvoid\nbitmap_zero(struct bitmap *b)\n{\n\tmemset(b->d, 0, b->len * BITMAP_BYTES);\n\tb->top = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_MEM_EQ",
          "args": [
            "bbuf",
            "bnbuf",
            "len"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "r",
            "(int)len"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_GE",
          "args": [
            "r",
            "0"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_bn2bin",
          "args": [
            "bn",
            "bnbuf"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_U8_EQ",
          "args": [
            "bbuf[n]",
            "0xfc"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "bitmap_to_string(b, bbuf,\n\t\t\t\t    sizeof(bbuf))",
            "0"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitmap_to_string",
          "args": [
            "b",
            "bbuf",
            "sizeof(bbuf)"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "bitmap_to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "167-186",
          "snippet": "int\nbitmap_to_string(struct bitmap *b, void *p, size_t l)\n{\n\tu_char *s = (u_char *)p;\n\tsize_t i, j, k, need = bitmap_nbytes(b);\n\n\tif (l < need || b->top >= b->len)\n\t\treturn -1;\n\tif (l > need)\n\t\tl = need;\n\t/* Put the bytes from LSB backwards */\n\tfor (i = k = 0; i < b->top + 1; i++) {\n\t\tfor (j = 0; j < BITMAP_BYTES; j++) {\n\t\t\tif (k >= l)\n\t\t\t\tbreak;\n\t\t\ts[need - 1 - k++] = (b->d[i] >> (j * 8)) & 0xff;\n\t\t}\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))\n\nint\nbitmap_to_string(struct bitmap *b, void *p, size_t l)\n{\n\tu_char *s = (u_char *)p;\n\tsize_t i, j, k, need = bitmap_nbytes(b);\n\n\tif (l < need || b->top >= b->len)\n\t\treturn -1;\n\tif (l > need)\n\t\tl = need;\n\t/* Put the bytes from LSB backwards */\n\tfor (i = k = 0; i < b->top + 1; i++) {\n\t\tfor (j = 0; j < BITMAP_BYTES; j++) {\n\t\t\tif (k >= l)\n\t\t\t\tbreak;\n\t\t\ts[need - 1 - k++] = (b->d[i] >> (j * 8)) & 0xff;\n\t\t}\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "bbuf",
            "0xfc",
            "sizeof(bbuf)"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitmap_nbytes",
          "args": [
            "b"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "bitmap_nbytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "161-165",
          "snippet": "size_t\nbitmap_nbytes(struct bitmap *b)\n{\n\treturn (bitmap_nbits(b) + 7) / 8;\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nbitmap_nbytes(struct bitmap *b)\n{\n\treturn (bitmap_nbits(b) + 7) / 8;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "BN_num_bytes(bn)",
            "(int)bitmap_nbytes(b)"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_num_bytes",
          "args": [
            "bn"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "BN_num_bits(bn)",
            "(int)bitmap_nbits(b)"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitmap_nbits",
          "args": [
            "b"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "bitmap_nbits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "140-159",
          "snippet": "size_t\nbitmap_nbits(struct bitmap *b)\n{\n\tsize_t bits;\n\tBITMAP_WTYPE w;\n\n\tretop(b);\n\tif (b->top >= b->len)\n\t\treturn 0; /* invalid */\n\tif (b->len == 0 || (b->top == 0 && b->d[0] == 0))\n\t\treturn 0;\n\t/* Find MSB set */\n\tw = b->d[b->top];\n\tbits = (b->top + 1) * BITMAP_BITS;\n\twhile (!(w & ((BITMAP_WTYPE)1 << (BITMAP_BITS - 1)))) {\n\t\tw <<= 1;\n\t\tbits--;\n\t}\n\treturn bits;\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)",
            "#define BITMAP_WTYPE\tu_int"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)\n#define BITMAP_WTYPE\tu_int\n\nsize_t\nbitmap_nbits(struct bitmap *b)\n{\n\tsize_t bits;\n\tBITMAP_WTYPE w;\n\n\tretop(b);\n\tif (b->top >= b->len)\n\t\treturn 0; /* invalid */\n\tif (b->len == 0 || (b->top == 0 && b->d[0] == 0))\n\t\treturn 0;\n\t/* Find MSB set */\n\tw = b->d[b->top];\n\tbits = (b->top + 1) * BITMAP_BITS;\n\twhile (!(w & ((BITMAP_WTYPE)1 << (BITMAP_BITS - 1)))) {\n\t\tw <<= 1;\n\t\tbits--;\n\t}\n\treturn bits;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_num_bits",
          "args": [
            "bn"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "BN_is_bit_set(bn, n)",
            "bitmap_test_bit(b, n)"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_is_bit_set",
          "args": [
            "bn",
            "n"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "BN_set_bit(bn, k)",
            "1"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_set_bit",
          "args": [
            "bn",
            "k"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "bitmap_set_bit(b, k)",
            "0"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "BN_set_bit(bn, j)",
            "1"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_set_bit",
          "args": [
            "bn",
            "j"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "bitmap_set_bit(b, j)",
            "0"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "BN_set_bit(bn, i)",
            "1"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_set_bit",
          "args": [
            "bn",
            "i"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "bitmap_set_bit(b, i)",
            "0"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_clear",
          "args": [
            "bn"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"bitmap_set_bit / bitmap_test_bit\""
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "bn",
            "NULL"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "b",
            "NULL"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bitmap_new",
          "args": [],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "bitmap_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "37-51",
          "snippet": "struct bitmap *\nbitmap_new(void)\n{\n\tstruct bitmap *ret;\n\n\tif ((ret = calloc(1, sizeof(*ret))) == NULL)\n\t\treturn NULL;\n\tif ((ret->d = calloc(1, BITMAP_BYTES)) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\tret->len = 1;\n\tret->top = 0;\n\treturn ret;\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))\n\nstruct bitmap *\nbitmap_new(void)\n{\n\tstruct bitmap *ret;\n\n\tif ((ret = calloc(1, sizeof(*ret))) == NULL)\n\t\treturn NULL;\n\tif ((ret->d = calloc(1, BITMAP_BYTES)) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\tret->len = 1;\n\tret->top = 0;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"bitmap_new\""
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bitmap.h\"\n#include \"../test_helper/test_helper.h\"\n#include <openssl/bn.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define NTESTS 131\n\nvoid\ntests(void)\n{\n\tstruct bitmap *b;\n\tBIGNUM *bn;\n\tsize_t len;\n\tint i, j, k, n;\n\tu_char bbuf[1024], bnbuf[1024];\n\tint r;\n\n\tTEST_START(\"bitmap_new\");\n\tb = bitmap_new();\n\tASSERT_PTR_NE(b, NULL);\n\tbn = BN_new();\n\tASSERT_PTR_NE(bn, NULL);\n\tTEST_DONE();\n\n\tTEST_START(\"bitmap_set_bit / bitmap_test_bit\");\n\tfor (i = -1; i < NTESTS; i++) {\n\t\tfor (j = -1; j < NTESTS; j++) {\n\t\t\tfor (k = -1; k < NTESTS; k++) {\n\t\t\t\tbitmap_zero(b);\n\t\t\t\tBN_clear(bn);\n\n\t\t\t\ttest_subtest_info(\"set %d/%d/%d\", i, j, k);\n\t\t\t\t/* Set bits */\n\t\t\t\tif (i >= 0) {\n\t\t\t\t\tASSERT_INT_EQ(bitmap_set_bit(b, i), 0);\n\t\t\t\t\tASSERT_INT_EQ(BN_set_bit(bn, i), 1);\n\t\t\t\t}\n\t\t\t\tif (j >= 0) {\n\t\t\t\t\tASSERT_INT_EQ(bitmap_set_bit(b, j), 0);\n\t\t\t\t\tASSERT_INT_EQ(BN_set_bit(bn, j), 1);\n\t\t\t\t}\n\t\t\t\tif (k >= 0) {\n\t\t\t\t\tASSERT_INT_EQ(bitmap_set_bit(b, k), 0);\n\t\t\t\t\tASSERT_INT_EQ(BN_set_bit(bn, k), 1);\n\t\t\t\t}\n\n\t\t\t\t/* Check perfect match between bitmap and bn */\n\t\t\t\ttest_subtest_info(\"match %d/%d/%d\", i, j, k);\n\t\t\t\tfor (n = 0; n < NTESTS; n++) {\n\t\t\t\t\tASSERT_INT_EQ(BN_is_bit_set(bn, n),\n\t\t\t\t\t    bitmap_test_bit(b, n));\n\t\t\t\t}\n\n\t\t\t\t/* Test length calculations */\n\t\t\t\ttest_subtest_info(\"length %d/%d/%d\", i, j, k);\n\t\t\t\tASSERT_INT_EQ(BN_num_bits(bn),\n\t\t\t\t    (int)bitmap_nbits(b));\n\t\t\t\tASSERT_INT_EQ(BN_num_bytes(bn),\n\t\t\t\t    (int)bitmap_nbytes(b));\n\n\t\t\t\t/* Test serialisation */\n\t\t\t\ttest_subtest_info(\"serialise %d/%d/%d\",\n\t\t\t\t    i, j, k);\n\t\t\t\tlen = bitmap_nbytes(b);\n\t\t\t\tmemset(bbuf, 0xfc, sizeof(bbuf));\n\t\t\t\tASSERT_INT_EQ(bitmap_to_string(b, bbuf,\n\t\t\t\t    sizeof(bbuf)), 0);\n\t\t\t\tfor (n = len; n < (int)sizeof(bbuf); n++)\n\t\t\t\t\tASSERT_U8_EQ(bbuf[n], 0xfc);\n\t\t\t\tr = BN_bn2bin(bn, bnbuf);\n\t\t\t\tASSERT_INT_GE(r, 0);\n\t\t\t\tASSERT_INT_EQ(r, (int)len);\n\t\t\t\tASSERT_MEM_EQ(bbuf, bnbuf, len);\n\n\t\t\t\t/* Test deserialisation */\n\t\t\t\ttest_subtest_info(\"deserialise %d/%d/%d\",\n\t\t\t\t    i, j, k);\n\t\t\t\tbitmap_zero(b);\n\t\t\t\tASSERT_INT_EQ(bitmap_from_string(b, bnbuf,\n\t\t\t\t    len), 0);\n\t\t\t\tfor (n = 0; n < NTESTS; n++) {\n\t\t\t\t\tASSERT_INT_EQ(BN_is_bit_set(bn, n),\n\t\t\t\t\t    bitmap_test_bit(b, n));\n\t\t\t\t}\n\n\t\t\t\t/* Test clearing bits */\n\t\t\t\ttest_subtest_info(\"clear %d/%d/%d\",\n\t\t\t\t    i, j, k);\n\t\t\t\tfor (n = 0; n < NTESTS; n++) {\n\t\t\t\t\tASSERT_INT_EQ(bitmap_set_bit(b, n), 0);\n\t\t\t\t\tASSERT_INT_EQ(BN_set_bit(bn, n), 1);\n\t\t\t\t}\n\t\t\t\tif (i >= 0) {\n\t\t\t\t\tbitmap_clear_bit(b, i);\n\t\t\t\t\tBN_clear_bit(bn, i);\n\t\t\t\t}\n\t\t\t\tif (j >= 0) {\n\t\t\t\t\tbitmap_clear_bit(b, j);\n\t\t\t\t\tBN_clear_bit(bn, j);\n\t\t\t\t}\n\t\t\t\tif (k >= 0) {\n\t\t\t\t\tbitmap_clear_bit(b, k);\n\t\t\t\t\tBN_clear_bit(bn, k);\n\t\t\t\t}\n\t\t\t\tfor (n = 0; n < NTESTS; n++) {\n\t\t\t\t\tASSERT_INT_EQ(BN_is_bit_set(bn, n),\n\t\t\t\t\t    bitmap_test_bit(b, n));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tbitmap_free(b);\n\tBN_free(bn);\n\tTEST_DONE();\n}"
  }
]