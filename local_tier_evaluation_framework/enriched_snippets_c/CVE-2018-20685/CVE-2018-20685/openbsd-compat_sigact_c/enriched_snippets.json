[
  {
    "function_name": "sigismember",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/sigact.c",
    "lines": "122-130",
    "snippet": "int\nsigismember (sigset_t *mask, int sig)\n{\n\tif (!mask) {\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\treturn (*mask & sigmask(sig)) != 0;\n}",
    "includes": [
      "#include \"sigact.h\"",
      "#include <signal.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sigmask",
          "args": [
            "sig"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sigact.h\"\n#include <signal.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\nsigismember (sigset_t *mask, int sig)\n{\n\tif (!mask) {\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\treturn (*mask & sigmask(sig)) != 0;\n}"
  },
  {
    "function_name": "sigaddset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/sigact.c",
    "lines": "111-120",
    "snippet": "int\nsigaddset (sigset_t *mask, int sig)\n{\n\tif (!mask) {\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\t*mask |= sigmask(sig);\n\treturn 0;\n}",
    "includes": [
      "#include \"sigact.h\"",
      "#include <signal.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sigmask",
          "args": [
            "sig"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sigact.h\"\n#include <signal.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\nsigaddset (sigset_t *mask, int sig)\n{\n\tif (!mask) {\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\t*mask |= sigmask(sig);\n\treturn 0;\n}"
  },
  {
    "function_name": "sigdelset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/sigact.c",
    "lines": "100-109",
    "snippet": "int\nsigdelset (sigset_t *mask, int sig)\n{\n\tif (!mask) {\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\t*mask &= ~sigmask(sig);\n\treturn 0;\n}",
    "includes": [
      "#include \"sigact.h\"",
      "#include <signal.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sigmask",
          "args": [
            "sig"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sigact.h\"\n#include <signal.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\nsigdelset (sigset_t *mask, int sig)\n{\n\tif (!mask) {\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\t*mask &= ~sigmask(sig);\n\treturn 0;\n}"
  },
  {
    "function_name": "sigsuspend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/sigact.c",
    "lines": "90-98",
    "snippet": "int\nsigsuspend (sigset_t *mask)\n{\n\tif (!mask) {\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\treturn sigpause(*mask);\n}",
    "includes": [
      "#include \"sigact.h\"",
      "#include <signal.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sigpause",
          "args": [
            "*mask"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sigact.h\"\n#include <signal.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\nsigsuspend (sigset_t *mask)\n{\n\tif (!mask) {\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\treturn sigpause(*mask);\n}"
  },
  {
    "function_name": "sigprocmask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/sigact.c",
    "lines": "66-88",
    "snippet": "int\nsigprocmask (int mode, sigset_t *mask, sigset_t *omask)\n{\n\tsigset_t current = sigsetmask(0);\n\n\tif (!mask) {\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\n\tif (omask)\n\t\t*omask = current;\n\n\tif (mode == SIG_BLOCK)\n\t\tcurrent |= *mask;\n\telse if (mode == SIG_UNBLOCK)\n\t\tcurrent &= ~*mask;\n\telse if (mode == SIG_SETMASK)\n\tcurrent = *mask;\n\n\tsigsetmask(current);\n\treturn 0;\n}",
    "includes": [
      "#include \"sigact.h\"",
      "#include <signal.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sigsetmask",
          "args": [
            "current"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sigsetmask",
          "args": [
            "0"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sigact.h\"\n#include <signal.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\nsigprocmask (int mode, sigset_t *mask, sigset_t *omask)\n{\n\tsigset_t current = sigsetmask(0);\n\n\tif (!mask) {\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\n\tif (omask)\n\t\t*omask = current;\n\n\tif (mode == SIG_BLOCK)\n\t\tcurrent |= *mask;\n\telse if (mode == SIG_UNBLOCK)\n\t\tcurrent &= ~*mask;\n\telse if (mode == SIG_SETMASK)\n\tcurrent = *mask;\n\n\tsigsetmask(current);\n\treturn 0;\n}"
  },
  {
    "function_name": "sigemptyset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/sigact.c",
    "lines": "55-64",
    "snippet": "int\nsigemptyset (sigset_t *mask)\n{\n\tif (!mask) {\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\t*mask = 0;\n\treturn 0;\n}",
    "includes": [
      "#include \"sigact.h\"",
      "#include <signal.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sigact.h\"\n#include <signal.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\nsigemptyset (sigset_t *mask)\n{\n\tif (!mask) {\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\t*mask = 0;\n\treturn 0;\n}"
  },
  {
    "function_name": "sigaction",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/sigact.c",
    "lines": "48-53",
    "snippet": "int\nsigaction(int sig, struct sigaction *sigact, struct sigaction *osigact)\n{\n\treturn sigvec(sig, sigact ? &sigact->sv : NULL,\n\t    osigact ? &osigact->sv : NULL);\n}",
    "includes": [
      "#include \"sigact.h\"",
      "#include <signal.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sigvec",
          "args": [
            "sig",
            "sigact ? &sigact->sv : NULL",
            "osigact ? &osigact->sv : NULL"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sigact.h\"\n#include <signal.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\nsigaction(int sig, struct sigaction *sigact, struct sigaction *osigact)\n{\n\treturn sigvec(sig, sigact ? &sigact->sv : NULL,\n\t    osigact ? &osigact->sv : NULL);\n}"
  }
]