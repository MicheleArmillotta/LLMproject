[
  {
    "function_name": "kex_c25519_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/kexc25519.c",
    "lines": "84-133",
    "snippet": "int\nkex_c25519_hash(\n    int hash_alg,\n    const char *client_version_string,\n    const char *server_version_string,\n    const u_char *ckexinit, size_t ckexinitlen,\n    const u_char *skexinit, size_t skexinitlen,\n    const u_char *serverhostkeyblob, size_t sbloblen,\n    const u_char client_dh_pub[CURVE25519_SIZE],\n    const u_char server_dh_pub[CURVE25519_SIZE],\n    const u_char *shared_secret, size_t secretlen,\n    u_char *hash, size_t *hashlen)\n{\n\tstruct sshbuf *b;\n\tint r;\n\n\tif (*hashlen < ssh_digest_bytes(hash_alg))\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif ((b = sshbuf_new()) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif ((r = sshbuf_put_cstring(b, client_version_string)) < 0 ||\n\t    (r = sshbuf_put_cstring(b, server_version_string)) < 0 ||\n\t    /* kexinit messages: fake header: len+SSH2_MSG_KEXINIT */\n\t    (r = sshbuf_put_u32(b, ckexinitlen+1)) < 0 ||\n\t    (r = sshbuf_put_u8(b, SSH2_MSG_KEXINIT)) < 0 ||\n\t    (r = sshbuf_put(b, ckexinit, ckexinitlen)) < 0 ||\n\t    (r = sshbuf_put_u32(b, skexinitlen+1)) < 0 ||\n\t    (r = sshbuf_put_u8(b, SSH2_MSG_KEXINIT)) < 0 ||\n\t    (r = sshbuf_put(b, skexinit, skexinitlen)) < 0 ||\n\t    (r = sshbuf_put_string(b, serverhostkeyblob, sbloblen)) < 0 ||\n\t    (r = sshbuf_put_string(b, client_dh_pub, CURVE25519_SIZE)) < 0 ||\n\t    (r = sshbuf_put_string(b, server_dh_pub, CURVE25519_SIZE)) < 0 ||\n\t    (r = sshbuf_put(b, shared_secret, secretlen)) < 0) {\n\t\tsshbuf_free(b);\n\t\treturn r;\n\t}\n#ifdef DEBUG_KEX\n\tsshbuf_dump(b, stderr);\n#endif\n\tif (ssh_digest_buffer(hash_alg, b, hash, *hashlen) != 0) {\n\t\tsshbuf_free(b);\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\t}\n\tsshbuf_free(b);\n\t*hashlen = ssh_digest_bytes(hash_alg);\n#ifdef DEBUG_KEX\n\tdump_digest(\"hash\", hash, *hashlen);\n#endif\n\treturn 0;\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"digest.h\"",
      "#include \"log.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"ssh2.h\"",
      "#include \"sshbuf.h\"",
      "#include <openssl/evp.h>",
      "#include <openssl/bn.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dump_digest",
          "args": [
            "\"hash\"",
            "hash",
            "*hashlen"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "dump_digest",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/kex.c",
          "lines": "1037-1042",
          "snippet": "void\ndump_digest(char *msg, u_char *digest, int len)\n{\n\tfprintf(stderr, \"%s\\n\", msg);\n\tsshbuf_dump_data(digest, len, stderr);\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"monitor.h\"",
            "#include \"dispatch.h\"",
            "#include \"misc.h\"",
            "#include \"match.h\"",
            "#include \"mac.h\"",
            "#include \"log.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"compat.h\"",
            "#include \"packet.h\"",
            "#include \"ssh2.h\"",
            "#include <openssl/dh.h>",
            "#include <openssl/crypto.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"monitor.h\"\n#include \"dispatch.h\"\n#include \"misc.h\"\n#include \"match.h\"\n#include \"mac.h\"\n#include \"log.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"compat.h\"\n#include \"packet.h\"\n#include \"ssh2.h\"\n#include <openssl/dh.h>\n#include <openssl/crypto.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n#include \"includes.h\"\n\nvoid\ndump_digest(char *msg, u_char *digest, int len)\n{\n\tfprintf(stderr, \"%s\\n\", msg);\n\tsshbuf_dump_data(digest, len, stderr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_digest_bytes",
          "args": [
            "hash_alg"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "143-149",
          "snippet": "size_t\nssh_digest_bytes(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\n\treturn digest == NULL ? 0 : digest->digest_len;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nssh_digest_bytes(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\n\treturn digest == NULL ? 0 : digest->digest_len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_free",
          "args": [
            "b"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "133-166",
          "snippet": "void\nsshbuf_free(struct sshbuf *buf)\n{\n\tif (buf == NULL)\n\t\treturn;\n\t/*\n\t * The following will leak on insane buffers, but this is the safest\n\t * course of action - an invalid pointer or already-freed pointer may\n\t * have been passed to us and continuing to scribble over memory would\n\t * be bad.\n\t */\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn;\n\t/*\n\t * If we are a child, the free our parent to decrement its reference\n\t * count and possibly free it.\n\t */\n\tsshbuf_free(buf->parent);\n\tbuf->parent = NULL;\n\t/*\n\t * If we are a parent with still-extant children, then don't free just\n\t * yet. The last child's call to sshbuf_free should decrement our\n\t * refcount to 0 and trigger the actual free.\n\t */\n\tbuf->refcount--;\n\tif (buf->refcount > 0)\n\t\treturn;\n\tif (!buf->readonly) {\n\t\texplicit_bzero(buf->d, buf->alloc);\n\t\tfree(buf->d);\n\t}\n\texplicit_bzero(buf, sizeof(*buf));\n\tfree(buf);\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nsshbuf_free(struct sshbuf *buf)\n{\n\tif (buf == NULL)\n\t\treturn;\n\t/*\n\t * The following will leak on insane buffers, but this is the safest\n\t * course of action - an invalid pointer or already-freed pointer may\n\t * have been passed to us and continuing to scribble over memory would\n\t * be bad.\n\t */\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn;\n\t/*\n\t * If we are a child, the free our parent to decrement its reference\n\t * count and possibly free it.\n\t */\n\tsshbuf_free(buf->parent);\n\tbuf->parent = NULL;\n\t/*\n\t * If we are a parent with still-extant children, then don't free just\n\t * yet. The last child's call to sshbuf_free should decrement our\n\t * refcount to 0 and trigger the actual free.\n\t */\n\tbuf->refcount--;\n\tif (buf->refcount > 0)\n\t\treturn;\n\tif (!buf->readonly) {\n\t\texplicit_bzero(buf->d, buf->alloc);\n\t\tfree(buf->d);\n\t}\n\texplicit_bzero(buf, sizeof(*buf));\n\tfree(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_digest_buffer",
          "args": [
            "hash_alg",
            "b",
            "hash",
            "*hashlen"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_buffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "249-253",
          "snippet": "int\nssh_digest_buffer(int alg, const struct sshbuf *b, u_char *d, size_t dlen)\n{\n\treturn ssh_digest_memory(alg, sshbuf_ptr(b), sshbuf_len(b), d, dlen);\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_buffer(int alg, const struct sshbuf *b, u_char *d, size_t dlen)\n{\n\treturn ssh_digest_memory(alg, sshbuf_ptr(b), sshbuf_len(b), d, dlen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_dump",
          "args": [
            "b",
            "stderr"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_dump",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-misc.c",
          "lines": "65-70",
          "snippet": "void\nsshbuf_dump(struct sshbuf *buf, FILE *f)\n{\n\tfprintf(f, \"buffer %p len = %zu\\n\", buf, sshbuf_len(buf));\n\tsshbuf_dump_data(sshbuf_ptr(buf), sshbuf_len(buf), f);\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <ctype.h>",
            "#include <resolv.h>",
            "#include <string.h>",
            "#include <limits.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <ctype.h>\n#include <resolv.h>\n#include <string.h>\n#include <limits.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <errno.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nsshbuf_dump(struct sshbuf *buf, FILE *f)\n{\n\tfprintf(f, \"buffer %p len = %zu\\n\", buf, sshbuf_len(buf));\n\tsshbuf_dump_data(sshbuf_ptr(buf), sshbuf_len(buf), f);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_put",
          "args": [
            "b",
            "shared_secret",
            "secretlen"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_putf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "254-264",
          "snippet": "int\nsshbuf_putf(struct sshbuf *buf, const char *fmt, ...)\n{\n\tva_list ap;\n\tint r;\n\n\tva_start(ap, fmt);\n\tr = sshbuf_putfv(buf, fmt, ap);\n\tva_end(ap);\n\treturn r;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_putf(struct sshbuf *buf, const char *fmt, ...)\n{\n\tva_list ap;\n\tint r;\n\n\tva_start(ap, fmt);\n\tr = sshbuf_putfv(buf, fmt, ap);\n\tva_end(ap);\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_put_string",
          "args": [
            "b",
            "server_dh_pub",
            "CURVE25519_SIZE"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "347-363",
          "snippet": "int\nsshbuf_put_string(struct sshbuf *buf, const void *v, size_t len)\n{\n\tu_char *d;\n\tint r;\n\n\tif (len > SSHBUF_SIZE_MAX - 4) {\n\t\tSSHBUF_DBG((\"SSH_ERR_NO_BUFFER_SPACE\"));\n\t\treturn SSH_ERR_NO_BUFFER_SPACE;\n\t}\n\tif ((r = sshbuf_reserve(buf, len + 4, &d)) < 0)\n\t\treturn r;\n\tPOKE_U32(d, len);\n\tif (len != 0)\n\t\tmemcpy(d + 4, v, len);\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_string(struct sshbuf *buf, const void *v, size_t len)\n{\n\tu_char *d;\n\tint r;\n\n\tif (len > SSHBUF_SIZE_MAX - 4) {\n\t\tSSHBUF_DBG((\"SSH_ERR_NO_BUFFER_SPACE\"));\n\t\treturn SSH_ERR_NO_BUFFER_SPACE;\n\t}\n\tif ((r = sshbuf_reserve(buf, len + 4, &d)) < 0)\n\t\treturn r;\n\tPOKE_U32(d, len);\n\tif (len != 0)\n\t\tmemcpy(d + 4, v, len);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_put_u8",
          "args": [
            "b",
            "SSH2_MSG_KEXINIT"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_u8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "335-345",
          "snippet": "int\nsshbuf_put_u8(struct sshbuf *buf, u_char val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 1, &p)) < 0)\n\t\treturn r;\n\tp[0] = val;\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_u8(struct sshbuf *buf, u_char val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 1, &p)) < 0)\n\t\treturn r;\n\tp[0] = val;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_put_u32",
          "args": [
            "b",
            "skexinitlen+1"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_u32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "311-321",
          "snippet": "int\nsshbuf_put_u32(struct sshbuf *buf, u_int32_t val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 4, &p)) < 0)\n\t\treturn r;\n\tPOKE_U32(p, val);\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_u32(struct sshbuf *buf, u_int32_t val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 4, &p)) < 0)\n\t\treturn r;\n\tPOKE_U32(p, val);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_put_cstring",
          "args": [
            "b",
            "server_version_string"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "365-369",
          "snippet": "int\nsshbuf_put_cstring(struct sshbuf *buf, const char *v)\n{\n\treturn sshbuf_put_string(buf, v, v == NULL ? 0 : strlen(v));\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_cstring(struct sshbuf *buf, const char *v)\n{\n\treturn sshbuf_put_string(buf, v, v == NULL ? 0 : strlen(v));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_new",
          "args": [],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "68-85",
          "snippet": "struct sshbuf *\nsshbuf_new(void)\n{\n\tstruct sshbuf *ret;\n\n\tif ((ret = calloc(sizeof(*ret), 1)) == NULL)\n\t\treturn NULL;\n\tret->alloc = SSHBUF_SIZE_INIT;\n\tret->max_size = SSHBUF_SIZE_MAX;\n\tret->readonly = 0;\n\tret->refcount = 1;\n\tret->parent = NULL;\n\tif ((ret->cd = ret->d = calloc(1, ret->alloc)) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct sshbuf *\nsshbuf_new(void)\n{\n\tstruct sshbuf *ret;\n\n\tif ((ret = calloc(sizeof(*ret), 1)) == NULL)\n\t\treturn NULL;\n\tret->alloc = SSHBUF_SIZE_INIT;\n\tret->max_size = SSHBUF_SIZE_MAX;\n\tret->readonly = 0;\n\tret->refcount = 1;\n\tret->parent = NULL;\n\tif ((ret->cd = ret->d = calloc(1, ret->alloc)) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"log.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"ssh2.h\"\n#include \"sshbuf.h\"\n#include <openssl/evp.h>\n#include <openssl/bn.h>\n#include <string.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nkex_c25519_hash(\n    int hash_alg,\n    const char *client_version_string,\n    const char *server_version_string,\n    const u_char *ckexinit, size_t ckexinitlen,\n    const u_char *skexinit, size_t skexinitlen,\n    const u_char *serverhostkeyblob, size_t sbloblen,\n    const u_char client_dh_pub[CURVE25519_SIZE],\n    const u_char server_dh_pub[CURVE25519_SIZE],\n    const u_char *shared_secret, size_t secretlen,\n    u_char *hash, size_t *hashlen)\n{\n\tstruct sshbuf *b;\n\tint r;\n\n\tif (*hashlen < ssh_digest_bytes(hash_alg))\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif ((b = sshbuf_new()) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif ((r = sshbuf_put_cstring(b, client_version_string)) < 0 ||\n\t    (r = sshbuf_put_cstring(b, server_version_string)) < 0 ||\n\t    /* kexinit messages: fake header: len+SSH2_MSG_KEXINIT */\n\t    (r = sshbuf_put_u32(b, ckexinitlen+1)) < 0 ||\n\t    (r = sshbuf_put_u8(b, SSH2_MSG_KEXINIT)) < 0 ||\n\t    (r = sshbuf_put(b, ckexinit, ckexinitlen)) < 0 ||\n\t    (r = sshbuf_put_u32(b, skexinitlen+1)) < 0 ||\n\t    (r = sshbuf_put_u8(b, SSH2_MSG_KEXINIT)) < 0 ||\n\t    (r = sshbuf_put(b, skexinit, skexinitlen)) < 0 ||\n\t    (r = sshbuf_put_string(b, serverhostkeyblob, sbloblen)) < 0 ||\n\t    (r = sshbuf_put_string(b, client_dh_pub, CURVE25519_SIZE)) < 0 ||\n\t    (r = sshbuf_put_string(b, server_dh_pub, CURVE25519_SIZE)) < 0 ||\n\t    (r = sshbuf_put(b, shared_secret, secretlen)) < 0) {\n\t\tsshbuf_free(b);\n\t\treturn r;\n\t}\n#ifdef DEBUG_KEX\n\tsshbuf_dump(b, stderr);\n#endif\n\tif (ssh_digest_buffer(hash_alg, b, hash, *hashlen) != 0) {\n\t\tsshbuf_free(b);\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\t}\n\tsshbuf_free(b);\n\t*hashlen = ssh_digest_bytes(hash_alg);\n#ifdef DEBUG_KEX\n\tdump_digest(\"hash\", hash, *hashlen);\n#endif\n\treturn 0;\n}"
  },
  {
    "function_name": "kexc25519_shared_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/kexc25519.c",
    "lines": "62-82",
    "snippet": "int\nkexc25519_shared_key(const u_char key[CURVE25519_SIZE],\n    const u_char pub[CURVE25519_SIZE], struct sshbuf *out)\n{\n\tu_char shared_key[CURVE25519_SIZE];\n\tint r;\n\n\t/* Check for all-zero public key */\n\texplicit_bzero(shared_key, CURVE25519_SIZE);\n\tif (timingsafe_bcmp(pub, shared_key, CURVE25519_SIZE) == 0)\n\t\treturn SSH_ERR_KEY_INVALID_EC_VALUE;\n\n\tcrypto_scalarmult_curve25519(shared_key, key, pub);\n#ifdef DEBUG_KEXECDH\n\tdump_digest(\"shared secret\", shared_key, CURVE25519_SIZE);\n#endif\n\tsshbuf_reset(out);\n\tr = sshbuf_put_bignum2_bytes(out, shared_key, CURVE25519_SIZE);\n\texplicit_bzero(shared_key, CURVE25519_SIZE);\n\treturn r;\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"digest.h\"",
      "#include \"log.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"ssh2.h\"",
      "#include \"sshbuf.h\"",
      "#include <openssl/evp.h>",
      "#include <openssl/bn.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "explicit_bzero",
          "args": [
            "shared_key",
            "CURVE25519_SIZE"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "explicit_bzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/explicit_bzero.c",
          "lines": "36-53",
          "snippet": "void\nexplicit_bzero(void *p, size_t n)\n{\n\tif (n == 0)\n\t\treturn;\n\t/*\n\t * clang -fsanitize=memory needs to intercept memset-like functions\n\t * to correctly detect memory initialisation. Make sure one is called\n\t * directly since our indirection trick above successfully confuses it.\n\t */\n#if defined(__has_feature)\n# if __has_feature(memory_sanitizer)\n\tmemset(p, 0, n);\n# endif\n#endif\n\n\tssh_bzero(p, n);\n}",
          "includes": [
            "#include <string.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"includes.h\"\n\nvoid\nexplicit_bzero(void *p, size_t n)\n{\n\tif (n == 0)\n\t\treturn;\n\t/*\n\t * clang -fsanitize=memory needs to intercept memset-like functions\n\t * to correctly detect memory initialisation. Make sure one is called\n\t * directly since our indirection trick above successfully confuses it.\n\t */\n#if defined(__has_feature)\n# if __has_feature(memory_sanitizer)\n\tmemset(p, 0, n);\n# endif\n#endif\n\n\tssh_bzero(p, n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_put_bignum2_bytes",
          "args": [
            "out",
            "shared_key",
            "CURVE25519_SIZE"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_bignum2_bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "401-428",
          "snippet": "int\nsshbuf_put_bignum2_bytes(struct sshbuf *buf, const void *v, size_t len)\n{\n\tu_char *d;\n\tconst u_char *s = (const u_char *)v;\n\tint r, prepend;\n\n\tif (len > SSHBUF_SIZE_MAX - 5) {\n\t\tSSHBUF_DBG((\"SSH_ERR_NO_BUFFER_SPACE\"));\n\t\treturn SSH_ERR_NO_BUFFER_SPACE;\n\t}\n\t/* Skip leading zero bytes */\n\tfor (; len > 0 && *s == 0; len--, s++)\n\t\t;\n\t/*\n\t * If most significant bit is set then prepend a zero byte to\n\t * avoid interpretation as a negative number.\n\t */\n\tprepend = len > 0 && (s[0] & 0x80) != 0;\n\tif ((r = sshbuf_reserve(buf, len + 4 + prepend, &d)) < 0)\n\t\treturn r;\n\tPOKE_U32(d, len + prepend);\n\tif (prepend)\n\t\td[4] = 0;\n\tif (len != 0)\n\t\tmemcpy(d + 4 + prepend, s, len);\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_bignum2_bytes(struct sshbuf *buf, const void *v, size_t len)\n{\n\tu_char *d;\n\tconst u_char *s = (const u_char *)v;\n\tint r, prepend;\n\n\tif (len > SSHBUF_SIZE_MAX - 5) {\n\t\tSSHBUF_DBG((\"SSH_ERR_NO_BUFFER_SPACE\"));\n\t\treturn SSH_ERR_NO_BUFFER_SPACE;\n\t}\n\t/* Skip leading zero bytes */\n\tfor (; len > 0 && *s == 0; len--, s++)\n\t\t;\n\t/*\n\t * If most significant bit is set then prepend a zero byte to\n\t * avoid interpretation as a negative number.\n\t */\n\tprepend = len > 0 && (s[0] & 0x80) != 0;\n\tif ((r = sshbuf_reserve(buf, len + 4 + prepend, &d)) < 0)\n\t\treturn r;\n\tPOKE_U32(d, len + prepend);\n\tif (prepend)\n\t\td[4] = 0;\n\tif (len != 0)\n\t\tmemcpy(d + 4 + prepend, s, len);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_reset",
          "args": [
            "out"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "168-188",
          "snippet": "void\nsshbuf_reset(struct sshbuf *buf)\n{\n\tu_char *d;\n\n\tif (buf->readonly || buf->refcount > 1) {\n\t\t/* Nonsensical. Just make buffer appear empty */\n\t\tbuf->off = buf->size;\n\t\treturn;\n\t}\n\t(void) sshbuf_check_sanity(buf);\n\tbuf->off = buf->size = 0;\n\tif (buf->alloc != SSHBUF_SIZE_INIT) {\n\t\tif ((d = recallocarray(buf->d, buf->alloc, SSHBUF_SIZE_INIT,\n\t\t    1)) != NULL) {\n\t\t\tbuf->cd = buf->d = d;\n\t\t\tbuf->alloc = SSHBUF_SIZE_INIT;\n\t\t}\n\t}\n\texplicit_bzero(buf->d, SSHBUF_SIZE_INIT);\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nsshbuf_reset(struct sshbuf *buf)\n{\n\tu_char *d;\n\n\tif (buf->readonly || buf->refcount > 1) {\n\t\t/* Nonsensical. Just make buffer appear empty */\n\t\tbuf->off = buf->size;\n\t\treturn;\n\t}\n\t(void) sshbuf_check_sanity(buf);\n\tbuf->off = buf->size = 0;\n\tif (buf->alloc != SSHBUF_SIZE_INIT) {\n\t\tif ((d = recallocarray(buf->d, buf->alloc, SSHBUF_SIZE_INIT,\n\t\t    1)) != NULL) {\n\t\t\tbuf->cd = buf->d = d;\n\t\t\tbuf->alloc = SSHBUF_SIZE_INIT;\n\t\t}\n\t}\n\texplicit_bzero(buf->d, SSHBUF_SIZE_INIT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dump_digest",
          "args": [
            "\"shared secret\"",
            "shared_key",
            "CURVE25519_SIZE"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "dump_digest",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/kex.c",
          "lines": "1037-1042",
          "snippet": "void\ndump_digest(char *msg, u_char *digest, int len)\n{\n\tfprintf(stderr, \"%s\\n\", msg);\n\tsshbuf_dump_data(digest, len, stderr);\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"monitor.h\"",
            "#include \"dispatch.h\"",
            "#include \"misc.h\"",
            "#include \"match.h\"",
            "#include \"mac.h\"",
            "#include \"log.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"compat.h\"",
            "#include \"packet.h\"",
            "#include \"ssh2.h\"",
            "#include <openssl/dh.h>",
            "#include <openssl/crypto.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"monitor.h\"\n#include \"dispatch.h\"\n#include \"misc.h\"\n#include \"match.h\"\n#include \"mac.h\"\n#include \"log.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"compat.h\"\n#include \"packet.h\"\n#include \"ssh2.h\"\n#include <openssl/dh.h>\n#include <openssl/crypto.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n#include \"includes.h\"\n\nvoid\ndump_digest(char *msg, u_char *digest, int len)\n{\n\tfprintf(stderr, \"%s\\n\", msg);\n\tsshbuf_dump_data(digest, len, stderr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "crypto_scalarmult_curve25519",
          "args": [
            "shared_key",
            "key",
            "pub"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "crypto_scalarmult_curve25519",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/smult_curve25519_ref.c",
          "lines": "247-265",
          "snippet": "int crypto_scalarmult_curve25519(unsigned char *q,\n  const unsigned char *n,\n  const unsigned char *p)\n{\n  unsigned int work[96];\n  unsigned char e[32];\n  unsigned int i;\n  for (i = 0;i < 32;++i) e[i] = n[i];\n  e[0] &= 248;\n  e[31] &= 127;\n  e[31] |= 64;\n  for (i = 0;i < 32;++i) work[i] = p[i];\n  mainloop(work,e);\n  recip(work + 32,work + 32);\n  mult(work + 64,work,work + 32);\n  freeze(work + 64);\n  for (i = 0;i < 32;++i) q[i] = work[64 + i];\n  return 0;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [
            "int crypto_scalarmult_curve25519(unsigned char *, const unsigned char *, const unsigned char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "int crypto_scalarmult_curve25519(unsigned char *, const unsigned char *, const unsigned char *);\n\nint crypto_scalarmult_curve25519(unsigned char *q,\n  const unsigned char *n,\n  const unsigned char *p)\n{\n  unsigned int work[96];\n  unsigned char e[32];\n  unsigned int i;\n  for (i = 0;i < 32;++i) e[i] = n[i];\n  e[0] &= 248;\n  e[31] &= 127;\n  e[31] |= 64;\n  for (i = 0;i < 32;++i) work[i] = p[i];\n  mainloop(work,e);\n  recip(work + 32,work + 32);\n  mult(work + 64,work,work + 32);\n  freeze(work + 64);\n  for (i = 0;i < 32;++i) q[i] = work[64 + i];\n  return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "timingsafe_bcmp",
          "args": [
            "pub",
            "shared_key",
            "CURVE25519_SIZE"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "timingsafe_bcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/timingsafe_bcmp.c",
          "lines": "23-32",
          "snippet": "int\ntimingsafe_bcmp(const void *b1, const void *b2, size_t n)\n{\n\tconst unsigned char *p1 = b1, *p2 = b2;\n\tint ret = 0;\n\n\tfor (; n > 0; n--)\n\t\tret |= *p1++ ^ *p2++;\n\treturn (ret != 0);\n}",
          "includes": [
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"includes.h\"\n\nint\ntimingsafe_bcmp(const void *b1, const void *b2, size_t n)\n{\n\tconst unsigned char *p1 = b1, *p2 = b2;\n\tint ret = 0;\n\n\tfor (; n > 0; n--)\n\t\tret |= *p1++ ^ *p2++;\n\treturn (ret != 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"log.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"ssh2.h\"\n#include \"sshbuf.h\"\n#include <openssl/evp.h>\n#include <openssl/bn.h>\n#include <string.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nkexc25519_shared_key(const u_char key[CURVE25519_SIZE],\n    const u_char pub[CURVE25519_SIZE], struct sshbuf *out)\n{\n\tu_char shared_key[CURVE25519_SIZE];\n\tint r;\n\n\t/* Check for all-zero public key */\n\texplicit_bzero(shared_key, CURVE25519_SIZE);\n\tif (timingsafe_bcmp(pub, shared_key, CURVE25519_SIZE) == 0)\n\t\treturn SSH_ERR_KEY_INVALID_EC_VALUE;\n\n\tcrypto_scalarmult_curve25519(shared_key, key, pub);\n#ifdef DEBUG_KEXECDH\n\tdump_digest(\"shared secret\", shared_key, CURVE25519_SIZE);\n#endif\n\tsshbuf_reset(out);\n\tr = sshbuf_put_bignum2_bytes(out, shared_key, CURVE25519_SIZE);\n\texplicit_bzero(shared_key, CURVE25519_SIZE);\n\treturn r;\n}"
  },
  {
    "function_name": "kexc25519_keygen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/kexc25519.c",
    "lines": "53-60",
    "snippet": "void\nkexc25519_keygen(u_char key[CURVE25519_SIZE], u_char pub[CURVE25519_SIZE])\n{\n\tstatic const u_char basepoint[CURVE25519_SIZE] = {9};\n\n\tarc4random_buf(key, CURVE25519_SIZE);\n\tcrypto_scalarmult_curve25519(pub, key, basepoint);\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"digest.h\"",
      "#include \"log.h\"",
      "#include \"kex.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"ssh2.h\"",
      "#include \"sshbuf.h\"",
      "#include <openssl/evp.h>",
      "#include <openssl/bn.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "crypto_scalarmult_curve25519",
          "args": [
            "pub",
            "key",
            "basepoint"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "crypto_scalarmult_curve25519",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/smult_curve25519_ref.c",
          "lines": "247-265",
          "snippet": "int crypto_scalarmult_curve25519(unsigned char *q,\n  const unsigned char *n,\n  const unsigned char *p)\n{\n  unsigned int work[96];\n  unsigned char e[32];\n  unsigned int i;\n  for (i = 0;i < 32;++i) e[i] = n[i];\n  e[0] &= 248;\n  e[31] &= 127;\n  e[31] |= 64;\n  for (i = 0;i < 32;++i) work[i] = p[i];\n  mainloop(work,e);\n  recip(work + 32,work + 32);\n  mult(work + 64,work,work + 32);\n  freeze(work + 64);\n  for (i = 0;i < 32;++i) q[i] = work[64 + i];\n  return 0;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [
            "int crypto_scalarmult_curve25519(unsigned char *, const unsigned char *, const unsigned char *);"
          ],
          "called_functions": [],
          "contextual_snippet": "int crypto_scalarmult_curve25519(unsigned char *, const unsigned char *, const unsigned char *);\n\nint crypto_scalarmult_curve25519(unsigned char *q,\n  const unsigned char *n,\n  const unsigned char *p)\n{\n  unsigned int work[96];\n  unsigned char e[32];\n  unsigned int i;\n  for (i = 0;i < 32;++i) e[i] = n[i];\n  e[0] &= 248;\n  e[31] &= 127;\n  e[31] |= 64;\n  for (i = 0;i < 32;++i) work[i] = p[i];\n  mainloop(work,e);\n  recip(work + 32,work + 32);\n  mult(work + 64,work,work + 32);\n  freeze(work + 64);\n  for (i = 0;i < 32;++i) q[i] = work[64 + i];\n  return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "arc4random_buf",
          "args": [
            "key",
            "CURVE25519_SIZE"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "arc4random_buf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/arc4random.c",
          "lines": "263-277",
          "snippet": "void\narc4random_buf(void *_buf, size_t n)\n{\n\tsize_t i;\n\tu_int32_t r = 0;\n\tchar *buf = (char *)_buf;\n\n\tfor (i = 0; i < n; i++) {\n\t\tif (i % 4 == 0)\n\t\t\tr = arc4random();\n\t\tbuf[i] = r & 0xff;\n\t\tr >>= 8;\n\t}\n\texplicit_bzero(&r, sizeof(r));\n}",
          "includes": [
            "#include <machine/pctr.h>",
            "#include <stdio.h>",
            "#include \"chacha_private.h\"",
            "#include \"log.h\"",
            "#include <openssl/err.h>",
            "#include <openssl/rand.h>",
            "# include <sys/random.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <machine/pctr.h>\n#include <stdio.h>\n#include \"chacha_private.h\"\n#include \"log.h\"\n#include <openssl/err.h>\n#include <openssl/rand.h>\n# include <sys/random.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\narc4random_buf(void *_buf, size_t n)\n{\n\tsize_t i;\n\tu_int32_t r = 0;\n\tchar *buf = (char *)_buf;\n\n\tfor (i = 0; i < n; i++) {\n\t\tif (i % 4 == 0)\n\t\t\tr = arc4random();\n\t\tbuf[i] = r & 0xff;\n\t\tr >>= 8;\n\t}\n\texplicit_bzero(&r, sizeof(r));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"log.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"ssh2.h\"\n#include \"sshbuf.h\"\n#include <openssl/evp.h>\n#include <openssl/bn.h>\n#include <string.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nkexc25519_keygen(u_char key[CURVE25519_SIZE], u_char pub[CURVE25519_SIZE])\n{\n\tstatic const u_char basepoint[CURVE25519_SIZE] = {9};\n\n\tarc4random_buf(key, CURVE25519_SIZE);\n\tcrypto_scalarmult_curve25519(pub, key, basepoint);\n}"
  }
]