[
  {
    "function_name": "tests",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/hostkeys/tests.c",
    "lines": "11-15",
    "snippet": "void\ntests(void)\n{\n\ttest_iterate();\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [
      "void tests(void);",
      "void test_iterate(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_iterate",
          "args": [],
          "line": 14
        },
        "resolved": true,
        "details": {
          "function_name": "test_iterate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/hostkeys/test_iterate.c",
          "lines": "826-1046",
          "snippet": "void\ntest_iterate(void)\n{\n\tstruct cbctx ctx;\n\n\tTEST_START(\"hostkeys_iterate all with key parse\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_PARSE_KEY;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, NULL, NULL, ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate all without key parse\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = 0;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, NULL, NULL, ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate specify host 1\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = 0;\n\tctx.match_host_p = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"prometheus.example.com\", NULL, ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate specify host 2\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = 0;\n\tctx.match_host_s = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"sisyphus.example.com\", NULL, ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate match host 1\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_MATCH;\n\tctx.match_host_p = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"prometheus.example.com\", NULL, ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate match host 2\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_MATCH;\n\tctx.match_host_s = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"sisyphus.example.com\", NULL, ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate specify host missing\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = 0;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"actaeon.example.org\", NULL, ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate match host missing\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_MATCH;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"actaeon.example.org\", NULL, ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate specify IPv4\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = 0;\n\tctx.match_ipv4 = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"tiresias.example.org\", \"192.0.2.1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate specify IPv6\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = 0;\n\tctx.match_ipv6 = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"tiresias.example.org\", \"2001:db8::1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate match IPv4\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_MATCH;\n\tctx.match_ipv4 = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"tiresias.example.org\", \"192.0.2.1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate match IPv6\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_MATCH;\n\tctx.match_ipv6 = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"tiresias.example.org\", \"2001:db8::1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate specify addr missing\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = 0;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"tiresias.example.org\", \"192.168.0.1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate match addr missing\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_MATCH;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"tiresias.example.org\", \"::1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate specify host 2 and IPv4\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = 0;\n\tctx.match_host_s = 1;\n\tctx.match_ipv4 = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"sisyphus.example.com\", \"192.0.2.1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate match host 1 and IPv6\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_MATCH;\n\tctx.match_host_p = 1;\n\tctx.match_ipv6 = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"prometheus.example.com\",\n\t    \"2001:db8::1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate specify host 2 and IPv4 w/ key parse\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_PARSE_KEY;\n\tctx.match_host_s = 1;\n\tctx.match_ipv4 = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"sisyphus.example.com\", \"192.0.2.1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate match host 1 and IPv6 w/ key parse\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_MATCH|HKF_WANT_PARSE_KEY;\n\tctx.match_host_p = 1;\n\tctx.match_ipv6 = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"prometheus.example.com\",\n\t    \"2001:db8::1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n}",
          "includes": [
            "#include \"hostfile.h\"",
            "#include \"authfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"../test_helper/test_helper.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "struct expected expected_full[] = {\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\t\t\t\t/* path, don't care */\n\t\t1,\t\t\t\t/* line number */\n\t\tHKF_STATUS_COMMENT,\t\t/* status */\n\t\t0,\t\t\t\t/* match flags */\n\t\t\"# Plain host keys, plain host names\", /* full line, optional */\n\t\tMRK_NONE,\t\t\t/* marker (CA / revoked) */\n\t\tNULL,\t\t\t\t/* hosts text */\n\t\tNULL,\t\t\t\t/* raw key, optional */\n\t\tKEY_UNSPEC,\t\t\t/* key type */\n\t\tNULL,\t\t\t\t/* deserialised key */\n\t\tNULL,\t\t\t\t/* comment */\n\t} },\n\t{ \"dsa_1.pub\" , -1, -1, 0, HKF_MATCH_HOST, 0, 0, -1, {\n\t\tNULL,\n\t\t2,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"sisyphus.example.com\",\n\t\tNULL,\n\t\tKEY_DSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"DSA #1\",\n\t} },\n\t{ \"ecdsa_1.pub\" , -1, -1, 0, HKF_MATCH_HOST, 0, 0, -1, {\n\t\tNULL,\n\t\t3,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"sisyphus.example.com\",\n\t\tNULL,\n\t\tKEY_ECDSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ECDSA #1\",\n\t} },\n\t{ \"ed25519_1.pub\" , -1, -1, 0, HKF_MATCH_HOST, 0, 0, -1, {\n\t\tNULL,\n\t\t4,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"sisyphus.example.com\",\n\t\tNULL,\n\t\tKEY_ED25519,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ED25519 #1\",\n\t} },\n\t{ \"rsa_1.pub\" , -1, -1, 0, HKF_MATCH_HOST, 0, 0, -1, {\n\t\tNULL,\n\t\t5,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"sisyphus.example.com\",\n\t\tNULL,\n\t\tKEY_RSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"RSA #1\",\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t6,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t7,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"# Plain host keys, hostnames + addresses\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ \"dsa_2.pub\" , -1, -1, HKF_MATCH_HOST, 0, HKF_MATCH_IP, HKF_MATCH_IP, -1, {\n\t\tNULL,\n\t\t8,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"prometheus.example.com,192.0.2.1,2001:db8::1\",\n\t\tNULL,\n\t\tKEY_DSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"DSA #2\",\n\t} },\n\t{ \"ecdsa_2.pub\" , -1, -1, HKF_MATCH_HOST, 0, HKF_MATCH_IP, HKF_MATCH_IP, -1, {\n\t\tNULL,\n\t\t9,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"prometheus.example.com,192.0.2.1,2001:db8::1\",\n\t\tNULL,\n\t\tKEY_ECDSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ECDSA #2\",\n\t} },\n\t{ \"ed25519_2.pub\" , -1, -1, HKF_MATCH_HOST, 0, HKF_MATCH_IP, HKF_MATCH_IP, -1, {\n\t\tNULL,\n\t\t10,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"prometheus.example.com,192.0.2.1,2001:db8::1\",\n\t\tNULL,\n\t\tKEY_ED25519,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ED25519 #2\",\n\t} },\n\t{ \"rsa_2.pub\" , -1, -1, HKF_MATCH_HOST, 0, HKF_MATCH_IP, HKF_MATCH_IP, -1, {\n\t\tNULL,\n\t\t11,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"prometheus.example.com,192.0.2.1,2001:db8::1\",\n\t\tNULL,\n\t\tKEY_RSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"RSA #2\",\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t12,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t13,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"# Some hosts with wildcard names / IPs\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ \"dsa_3.pub\" , -1, -1, HKF_MATCH_HOST, HKF_MATCH_HOST, HKF_MATCH_IP, HKF_MATCH_IP, -1, {\n\t\tNULL,\n\t\t14,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"*.example.com,192.0.2.*,2001:*\",\n\t\tNULL,\n\t\tKEY_DSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"DSA #3\",\n\t} },\n\t{ \"ecdsa_3.pub\" , -1, -1, HKF_MATCH_HOST, HKF_MATCH_HOST, HKF_MATCH_IP, HKF_MATCH_IP, -1, {\n\t\tNULL,\n\t\t15,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"*.example.com,192.0.2.*,2001:*\",\n\t\tNULL,\n\t\tKEY_ECDSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ECDSA #3\",\n\t} },\n\t{ \"ed25519_3.pub\" , -1, -1, HKF_MATCH_HOST, HKF_MATCH_HOST, HKF_MATCH_IP, HKF_MATCH_IP, -1, {\n\t\tNULL,\n\t\t16,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"*.example.com,192.0.2.*,2001:*\",\n\t\tNULL,\n\t\tKEY_ED25519,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ED25519 #3\",\n\t} },\n\t{ \"rsa_3.pub\" , -1, -1, HKF_MATCH_HOST, HKF_MATCH_HOST, HKF_MATCH_IP, HKF_MATCH_IP, -1, {\n\t\tNULL,\n\t\t17,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"*.example.com,192.0.2.*,2001:*\",\n\t\tNULL,\n\t\tKEY_RSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"RSA #3\",\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t18,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t19,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"# Hashed hostname and address entries\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ \"dsa_5.pub\" , -1, -1, 0, HKF_MATCH_HOST|HKF_MATCH_HOST_HASHED, 0, 0, -1, {\n\t\tNULL,\n\t\t20,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_DSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"DSA #5\",\n\t} },\n\t{ \"ecdsa_5.pub\" , -1, -1, 0, HKF_MATCH_HOST|HKF_MATCH_HOST_HASHED, 0, 0, -1, {\n\t\tNULL,\n\t\t21,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_ECDSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ECDSA #5\",\n\t} },\n\t{ \"ed25519_5.pub\" , -1, -1, 0, HKF_MATCH_HOST|HKF_MATCH_HOST_HASHED, 0, 0, -1, {\n\t\tNULL,\n\t\t22,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_ED25519,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ED25519 #5\",\n\t} },\n\t{ \"rsa_5.pub\" , -1, -1, 0, HKF_MATCH_HOST|HKF_MATCH_HOST_HASHED, 0, 0, -1, {\n\t\tNULL,\n\t\t23,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_RSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"RSA #5\",\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t24,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t/*\n\t * The next series have each key listed multiple times, as the\n\t * hostname and addresses in the pre-hashed known_hosts are split\n\t * to separate lines.\n\t */\n\t{ \"dsa_6.pub\" , -1, -1, HKF_MATCH_HOST|HKF_MATCH_HOST_HASHED, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t25,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_DSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"DSA #6\",\n\t} },\n\t{ \"dsa_6.pub\" , -1, -1, 0, 0, HKF_MATCH_IP|HKF_MATCH_IP_HASHED, 0, -1, {\n\t\tNULL,\n\t\t26,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_DSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"DSA #6\",\n\t} },\n\t{ \"dsa_6.pub\" , -1, -1, 0, 0, 0, HKF_MATCH_IP|HKF_MATCH_IP_HASHED, -1, {\n\t\tNULL,\n\t\t27,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_DSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"DSA #6\",\n\t} },\n\t{ \"ecdsa_6.pub\" , -1, -1, HKF_MATCH_HOST|HKF_MATCH_HOST_HASHED, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t28,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_ECDSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ECDSA #6\",\n\t} },\n\t{ \"ecdsa_6.pub\" , -1, -1, 0, 0, HKF_MATCH_IP|HKF_MATCH_IP_HASHED, 0, -1, {\n\t\tNULL,\n\t\t29,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_ECDSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ECDSA #6\",\n\t} },\n\t{ \"ecdsa_6.pub\" , -1, -1, 0, 0, 0, HKF_MATCH_IP|HKF_MATCH_IP_HASHED, -1, {\n\t\tNULL,\n\t\t30,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_ECDSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ECDSA #6\",\n\t} },\n\t{ \"ed25519_6.pub\" , -1, -1, HKF_MATCH_HOST|HKF_MATCH_HOST_HASHED, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t31,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_ED25519,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ED25519 #6\",\n\t} },\n\t{ \"ed25519_6.pub\" , -1, -1, 0, 0, HKF_MATCH_IP|HKF_MATCH_IP_HASHED, 0, -1, {\n\t\tNULL,\n\t\t32,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_ED25519,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ED25519 #6\",\n\t} },\n\t{ \"ed25519_6.pub\" , -1, -1, 0, 0, 0, HKF_MATCH_IP|HKF_MATCH_IP_HASHED, -1, {\n\t\tNULL,\n\t\t33,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_ED25519,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ED25519 #6\",\n\t} },\n\t{ \"rsa_6.pub\" , -1, -1, HKF_MATCH_HOST|HKF_MATCH_HOST_HASHED, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t34,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_RSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"RSA #6\",\n\t} },\n\t{ \"rsa_6.pub\" , -1, -1, 0, 0, HKF_MATCH_IP|HKF_MATCH_IP_HASHED, 0, -1, {\n\t\tNULL,\n\t\t35,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_RSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"RSA #6\",\n\t} },\n\t{ \"rsa_6.pub\" , -1, -1, 0, 0, 0, HKF_MATCH_IP|HKF_MATCH_IP_HASHED, -1, {\n\t\tNULL,\n\t\t36,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_RSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"RSA #6\",\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t37,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t38,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t39,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"# Revoked and CA keys\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ \"ed25519_4.pub\" , -1, -1, 0, HKF_MATCH_HOST, 0, 0, -1, {\n\t\tNULL,\n\t\t40,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_REVOKE,\n\t\t\"sisyphus.example.com\",\n\t\tNULL,\n\t\tKEY_ED25519,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ED25519 #4\",\n\t} },\n\t{ \"ecdsa_4.pub\" , -1, -1, HKF_MATCH_HOST, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t41,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_CA,\n\t\t\"prometheus.example.com\",\n\t\tNULL,\n\t\tKEY_ECDSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ECDSA #4\",\n\t} },\n\t{ \"dsa_4.pub\" , -1, -1, HKF_MATCH_HOST, HKF_MATCH_HOST, 0, 0, -1, {\n\t\tNULL,\n\t\t42,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_CA,\n\t\t\"*.example.com\",\n\t\tNULL,\n\t\tKEY_DSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"DSA #4\",\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t43,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t44,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"# Some invalid lines\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t45,\n\t\tHKF_STATUS_INVALID,\n\t\t0,\n\t\tNULL,\n\t\tMRK_ERROR,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, HKF_MATCH_HOST, 0, 0, -1, {\n\t\tNULL,\n\t\t46,\n\t\tHKF_STATUS_INVALID,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"sisyphus.example.com\",\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, HKF_MATCH_HOST, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t47,\n\t\tHKF_STATUS_INVALID,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"prometheus.example.com\",\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, HKF_MATCH_HOST, 0, 0, -1, {\n\t\tNULL,\n\t\t48,\n\t\tHKF_STATUS_INVALID,\t/* Would be ok if key not parsed */\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"sisyphus.example.com\",\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, HKF_MATCH_HOST, 0, 0, -1, {\n\t\tNULL,\n\t\t49,\n\t\tHKF_STATUS_INVALID,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"sisyphus.example.com\",\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\t/* filled at runtime */\n\t\tNULL,\n\t} },\n\t{ NULL, HKF_STATUS_OK, KEY_RSA, HKF_MATCH_HOST, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t50,\n\t\tHKF_STATUS_INVALID,\t/* Would be ok if key not parsed */\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"prometheus.example.com\",\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\t/* filled at runtime */\n\t\tNULL,\n\t} },\n};",
            "void test_iterate(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"hostfile.h\"\n#include \"authfile.h\"\n#include \"sshkey.h\"\n#include \"../test_helper/test_helper.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct expected expected_full[] = {\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\t\t\t\t/* path, don't care */\n\t\t1,\t\t\t\t/* line number */\n\t\tHKF_STATUS_COMMENT,\t\t/* status */\n\t\t0,\t\t\t\t/* match flags */\n\t\t\"# Plain host keys, plain host names\", /* full line, optional */\n\t\tMRK_NONE,\t\t\t/* marker (CA / revoked) */\n\t\tNULL,\t\t\t\t/* hosts text */\n\t\tNULL,\t\t\t\t/* raw key, optional */\n\t\tKEY_UNSPEC,\t\t\t/* key type */\n\t\tNULL,\t\t\t\t/* deserialised key */\n\t\tNULL,\t\t\t\t/* comment */\n\t} },\n\t{ \"dsa_1.pub\" , -1, -1, 0, HKF_MATCH_HOST, 0, 0, -1, {\n\t\tNULL,\n\t\t2,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"sisyphus.example.com\",\n\t\tNULL,\n\t\tKEY_DSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"DSA #1\",\n\t} },\n\t{ \"ecdsa_1.pub\" , -1, -1, 0, HKF_MATCH_HOST, 0, 0, -1, {\n\t\tNULL,\n\t\t3,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"sisyphus.example.com\",\n\t\tNULL,\n\t\tKEY_ECDSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ECDSA #1\",\n\t} },\n\t{ \"ed25519_1.pub\" , -1, -1, 0, HKF_MATCH_HOST, 0, 0, -1, {\n\t\tNULL,\n\t\t4,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"sisyphus.example.com\",\n\t\tNULL,\n\t\tKEY_ED25519,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ED25519 #1\",\n\t} },\n\t{ \"rsa_1.pub\" , -1, -1, 0, HKF_MATCH_HOST, 0, 0, -1, {\n\t\tNULL,\n\t\t5,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"sisyphus.example.com\",\n\t\tNULL,\n\t\tKEY_RSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"RSA #1\",\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t6,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t7,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"# Plain host keys, hostnames + addresses\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ \"dsa_2.pub\" , -1, -1, HKF_MATCH_HOST, 0, HKF_MATCH_IP, HKF_MATCH_IP, -1, {\n\t\tNULL,\n\t\t8,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"prometheus.example.com,192.0.2.1,2001:db8::1\",\n\t\tNULL,\n\t\tKEY_DSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"DSA #2\",\n\t} },\n\t{ \"ecdsa_2.pub\" , -1, -1, HKF_MATCH_HOST, 0, HKF_MATCH_IP, HKF_MATCH_IP, -1, {\n\t\tNULL,\n\t\t9,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"prometheus.example.com,192.0.2.1,2001:db8::1\",\n\t\tNULL,\n\t\tKEY_ECDSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ECDSA #2\",\n\t} },\n\t{ \"ed25519_2.pub\" , -1, -1, HKF_MATCH_HOST, 0, HKF_MATCH_IP, HKF_MATCH_IP, -1, {\n\t\tNULL,\n\t\t10,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"prometheus.example.com,192.0.2.1,2001:db8::1\",\n\t\tNULL,\n\t\tKEY_ED25519,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ED25519 #2\",\n\t} },\n\t{ \"rsa_2.pub\" , -1, -1, HKF_MATCH_HOST, 0, HKF_MATCH_IP, HKF_MATCH_IP, -1, {\n\t\tNULL,\n\t\t11,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"prometheus.example.com,192.0.2.1,2001:db8::1\",\n\t\tNULL,\n\t\tKEY_RSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"RSA #2\",\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t12,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t13,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"# Some hosts with wildcard names / IPs\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ \"dsa_3.pub\" , -1, -1, HKF_MATCH_HOST, HKF_MATCH_HOST, HKF_MATCH_IP, HKF_MATCH_IP, -1, {\n\t\tNULL,\n\t\t14,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"*.example.com,192.0.2.*,2001:*\",\n\t\tNULL,\n\t\tKEY_DSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"DSA #3\",\n\t} },\n\t{ \"ecdsa_3.pub\" , -1, -1, HKF_MATCH_HOST, HKF_MATCH_HOST, HKF_MATCH_IP, HKF_MATCH_IP, -1, {\n\t\tNULL,\n\t\t15,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"*.example.com,192.0.2.*,2001:*\",\n\t\tNULL,\n\t\tKEY_ECDSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ECDSA #3\",\n\t} },\n\t{ \"ed25519_3.pub\" , -1, -1, HKF_MATCH_HOST, HKF_MATCH_HOST, HKF_MATCH_IP, HKF_MATCH_IP, -1, {\n\t\tNULL,\n\t\t16,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"*.example.com,192.0.2.*,2001:*\",\n\t\tNULL,\n\t\tKEY_ED25519,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ED25519 #3\",\n\t} },\n\t{ \"rsa_3.pub\" , -1, -1, HKF_MATCH_HOST, HKF_MATCH_HOST, HKF_MATCH_IP, HKF_MATCH_IP, -1, {\n\t\tNULL,\n\t\t17,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"*.example.com,192.0.2.*,2001:*\",\n\t\tNULL,\n\t\tKEY_RSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"RSA #3\",\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t18,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t19,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"# Hashed hostname and address entries\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ \"dsa_5.pub\" , -1, -1, 0, HKF_MATCH_HOST|HKF_MATCH_HOST_HASHED, 0, 0, -1, {\n\t\tNULL,\n\t\t20,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_DSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"DSA #5\",\n\t} },\n\t{ \"ecdsa_5.pub\" , -1, -1, 0, HKF_MATCH_HOST|HKF_MATCH_HOST_HASHED, 0, 0, -1, {\n\t\tNULL,\n\t\t21,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_ECDSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ECDSA #5\",\n\t} },\n\t{ \"ed25519_5.pub\" , -1, -1, 0, HKF_MATCH_HOST|HKF_MATCH_HOST_HASHED, 0, 0, -1, {\n\t\tNULL,\n\t\t22,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_ED25519,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ED25519 #5\",\n\t} },\n\t{ \"rsa_5.pub\" , -1, -1, 0, HKF_MATCH_HOST|HKF_MATCH_HOST_HASHED, 0, 0, -1, {\n\t\tNULL,\n\t\t23,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_RSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"RSA #5\",\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t24,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t/*\n\t * The next series have each key listed multiple times, as the\n\t * hostname and addresses in the pre-hashed known_hosts are split\n\t * to separate lines.\n\t */\n\t{ \"dsa_6.pub\" , -1, -1, HKF_MATCH_HOST|HKF_MATCH_HOST_HASHED, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t25,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_DSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"DSA #6\",\n\t} },\n\t{ \"dsa_6.pub\" , -1, -1, 0, 0, HKF_MATCH_IP|HKF_MATCH_IP_HASHED, 0, -1, {\n\t\tNULL,\n\t\t26,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_DSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"DSA #6\",\n\t} },\n\t{ \"dsa_6.pub\" , -1, -1, 0, 0, 0, HKF_MATCH_IP|HKF_MATCH_IP_HASHED, -1, {\n\t\tNULL,\n\t\t27,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_DSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"DSA #6\",\n\t} },\n\t{ \"ecdsa_6.pub\" , -1, -1, HKF_MATCH_HOST|HKF_MATCH_HOST_HASHED, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t28,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_ECDSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ECDSA #6\",\n\t} },\n\t{ \"ecdsa_6.pub\" , -1, -1, 0, 0, HKF_MATCH_IP|HKF_MATCH_IP_HASHED, 0, -1, {\n\t\tNULL,\n\t\t29,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_ECDSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ECDSA #6\",\n\t} },\n\t{ \"ecdsa_6.pub\" , -1, -1, 0, 0, 0, HKF_MATCH_IP|HKF_MATCH_IP_HASHED, -1, {\n\t\tNULL,\n\t\t30,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_ECDSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ECDSA #6\",\n\t} },\n\t{ \"ed25519_6.pub\" , -1, -1, HKF_MATCH_HOST|HKF_MATCH_HOST_HASHED, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t31,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_ED25519,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ED25519 #6\",\n\t} },\n\t{ \"ed25519_6.pub\" , -1, -1, 0, 0, HKF_MATCH_IP|HKF_MATCH_IP_HASHED, 0, -1, {\n\t\tNULL,\n\t\t32,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_ED25519,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ED25519 #6\",\n\t} },\n\t{ \"ed25519_6.pub\" , -1, -1, 0, 0, 0, HKF_MATCH_IP|HKF_MATCH_IP_HASHED, -1, {\n\t\tNULL,\n\t\t33,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_ED25519,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ED25519 #6\",\n\t} },\n\t{ \"rsa_6.pub\" , -1, -1, HKF_MATCH_HOST|HKF_MATCH_HOST_HASHED, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t34,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_RSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"RSA #6\",\n\t} },\n\t{ \"rsa_6.pub\" , -1, -1, 0, 0, HKF_MATCH_IP|HKF_MATCH_IP_HASHED, 0, -1, {\n\t\tNULL,\n\t\t35,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_RSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"RSA #6\",\n\t} },\n\t{ \"rsa_6.pub\" , -1, -1, 0, 0, 0, HKF_MATCH_IP|HKF_MATCH_IP_HASHED, -1, {\n\t\tNULL,\n\t\t36,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_RSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"RSA #6\",\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t37,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t38,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t39,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"# Revoked and CA keys\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ \"ed25519_4.pub\" , -1, -1, 0, HKF_MATCH_HOST, 0, 0, -1, {\n\t\tNULL,\n\t\t40,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_REVOKE,\n\t\t\"sisyphus.example.com\",\n\t\tNULL,\n\t\tKEY_ED25519,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ED25519 #4\",\n\t} },\n\t{ \"ecdsa_4.pub\" , -1, -1, HKF_MATCH_HOST, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t41,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_CA,\n\t\t\"prometheus.example.com\",\n\t\tNULL,\n\t\tKEY_ECDSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"ECDSA #4\",\n\t} },\n\t{ \"dsa_4.pub\" , -1, -1, HKF_MATCH_HOST, HKF_MATCH_HOST, 0, 0, -1, {\n\t\tNULL,\n\t\t42,\n\t\tHKF_STATUS_OK,\n\t\t0,\n\t\tNULL,\n\t\tMRK_CA,\n\t\t\"*.example.com\",\n\t\tNULL,\n\t\tKEY_DSA,\n\t\tNULL,\t/* filled at runtime */\n\t\t\"DSA #4\",\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t43,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t44,\n\t\tHKF_STATUS_COMMENT,\n\t\t0,\n\t\t\"# Some invalid lines\",\n\t\tMRK_NONE,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t45,\n\t\tHKF_STATUS_INVALID,\n\t\t0,\n\t\tNULL,\n\t\tMRK_ERROR,\n\t\tNULL,\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, HKF_MATCH_HOST, 0, 0, -1, {\n\t\tNULL,\n\t\t46,\n\t\tHKF_STATUS_INVALID,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"sisyphus.example.com\",\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, HKF_MATCH_HOST, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t47,\n\t\tHKF_STATUS_INVALID,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"prometheus.example.com\",\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, HKF_MATCH_HOST, 0, 0, -1, {\n\t\tNULL,\n\t\t48,\n\t\tHKF_STATUS_INVALID,\t/* Would be ok if key not parsed */\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"sisyphus.example.com\",\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\n\t\tNULL,\n\t} },\n\t{ NULL, -1, -1, 0, HKF_MATCH_HOST, 0, 0, -1, {\n\t\tNULL,\n\t\t49,\n\t\tHKF_STATUS_INVALID,\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"sisyphus.example.com\",\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\t/* filled at runtime */\n\t\tNULL,\n\t} },\n\t{ NULL, HKF_STATUS_OK, KEY_RSA, HKF_MATCH_HOST, 0, 0, 0, -1, {\n\t\tNULL,\n\t\t50,\n\t\tHKF_STATUS_INVALID,\t/* Would be ok if key not parsed */\n\t\t0,\n\t\tNULL,\n\t\tMRK_NONE,\n\t\t\"prometheus.example.com\",\n\t\tNULL,\n\t\tKEY_UNSPEC,\n\t\tNULL,\t/* filled at runtime */\n\t\tNULL,\n\t} },\n};\nvoid test_iterate(void);\n\nvoid\ntest_iterate(void)\n{\n\tstruct cbctx ctx;\n\n\tTEST_START(\"hostkeys_iterate all with key parse\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_PARSE_KEY;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, NULL, NULL, ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate all without key parse\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = 0;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, NULL, NULL, ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate specify host 1\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = 0;\n\tctx.match_host_p = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"prometheus.example.com\", NULL, ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate specify host 2\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = 0;\n\tctx.match_host_s = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"sisyphus.example.com\", NULL, ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate match host 1\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_MATCH;\n\tctx.match_host_p = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"prometheus.example.com\", NULL, ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate match host 2\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_MATCH;\n\tctx.match_host_s = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"sisyphus.example.com\", NULL, ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate specify host missing\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = 0;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"actaeon.example.org\", NULL, ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate match host missing\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_MATCH;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"actaeon.example.org\", NULL, ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate specify IPv4\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = 0;\n\tctx.match_ipv4 = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"tiresias.example.org\", \"192.0.2.1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate specify IPv6\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = 0;\n\tctx.match_ipv6 = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"tiresias.example.org\", \"2001:db8::1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate match IPv4\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_MATCH;\n\tctx.match_ipv4 = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"tiresias.example.org\", \"192.0.2.1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate match IPv6\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_MATCH;\n\tctx.match_ipv6 = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"tiresias.example.org\", \"2001:db8::1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate specify addr missing\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = 0;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"tiresias.example.org\", \"192.168.0.1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate match addr missing\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_MATCH;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"tiresias.example.org\", \"::1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate specify host 2 and IPv4\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = 0;\n\tctx.match_host_s = 1;\n\tctx.match_ipv4 = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"sisyphus.example.com\", \"192.0.2.1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate match host 1 and IPv6\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_MATCH;\n\tctx.match_host_p = 1;\n\tctx.match_ipv6 = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"prometheus.example.com\",\n\t    \"2001:db8::1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate specify host 2 and IPv4 w/ key parse\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_PARSE_KEY;\n\tctx.match_host_s = 1;\n\tctx.match_ipv4 = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"sisyphus.example.com\", \"192.0.2.1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n\n\tTEST_START(\"hostkeys_iterate match host 1 and IPv6 w/ key parse\");\n\tmemset(&ctx, 0, sizeof(ctx));\n\tctx.expected = expected_full;\n\tctx.nexpected = sizeof(expected_full)/sizeof(*expected_full);\n\tctx.flags = HKF_WANT_MATCH|HKF_WANT_PARSE_KEY;\n\tctx.match_host_p = 1;\n\tctx.match_ipv6 = 1;\n\tprepare_expected(expected_full, ctx.nexpected);\n\tASSERT_INT_EQ(hostkeys_foreach(test_data_file(\"known_hosts\"),\n\t    check, &ctx, \"prometheus.example.com\",\n\t    \"2001:db8::1\", ctx.flags), 0);\n\tcleanup_expected(expected_full, ctx.nexpected);\n\tTEST_DONE();\n}"
        }
      }
    ],
    "contextual_snippet": "void tests(void);\nvoid test_iterate(void);\n\nvoid\ntests(void)\n{\n\ttest_iterate();\n}"
  }
]