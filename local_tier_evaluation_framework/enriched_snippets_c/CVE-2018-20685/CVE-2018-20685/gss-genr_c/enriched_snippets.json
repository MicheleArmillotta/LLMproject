[
  {
    "function_name": "ssh_gssapi_check_mechanism",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
    "lines": "275-303",
    "snippet": "int\nssh_gssapi_check_mechanism(Gssctxt **ctx, gss_OID oid, const char *host)\n{\n\tgss_buffer_desc token = GSS_C_EMPTY_BUFFER;\n\tOM_uint32 major, minor;\n\tgss_OID_desc spnego_oid = {6, (void *)\"\\x2B\\x06\\x01\\x05\\x05\\x02\"};\n\n\t/* RFC 4462 says we MUST NOT do SPNEGO */\n\tif (oid->length == spnego_oid.length && \n\t    (memcmp(oid->elements, spnego_oid.elements, oid->length) == 0))\n\t\treturn 0; /* false */\n\n\tssh_gssapi_build_ctx(ctx);\n\tssh_gssapi_set_oid(*ctx, oid);\n\tmajor = ssh_gssapi_import_name(*ctx, host);\n\tif (!GSS_ERROR(major)) {\n\t\tmajor = ssh_gssapi_init_ctx(*ctx, 0, GSS_C_NO_BUFFER, &token, \n\t\t    NULL);\n\t\tgss_release_buffer(&minor, &token);\n\t\tif ((*ctx)->context != GSS_C_NO_CONTEXT)\n\t\t\tgss_delete_sec_context(&minor, &(*ctx)->context,\n\t\t\t    GSS_C_NO_BUFFER);\n\t}\n\n\tif (GSS_ERROR(major)) \n\t\tssh_gssapi_delete_ctx(ctx);\n\n\treturn (!GSS_ERROR(major));\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"ssh2.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GSS_ERROR",
          "args": [
            "major"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssh_gssapi_delete_ctx",
          "args": [
            "ctx"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_delete_ctx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
          "lines": "176-201",
          "snippet": "void\nssh_gssapi_delete_ctx(Gssctxt **ctx)\n{\n\tOM_uint32 ms;\n\n\tif ((*ctx) == NULL)\n\t\treturn;\n\tif ((*ctx)->context != GSS_C_NO_CONTEXT)\n\t\tgss_delete_sec_context(&ms, &(*ctx)->context, GSS_C_NO_BUFFER);\n\tif ((*ctx)->name != GSS_C_NO_NAME)\n\t\tgss_release_name(&ms, &(*ctx)->name);\n\tif ((*ctx)->oid != GSS_C_NO_OID) {\n\t\tfree((*ctx)->oid->elements);\n\t\tfree((*ctx)->oid);\n\t\t(*ctx)->oid = GSS_C_NO_OID;\n\t}\n\tif ((*ctx)->creds != GSS_C_NO_CREDENTIAL)\n\t\tgss_release_cred(&ms, &(*ctx)->creds);\n\tif ((*ctx)->client != GSS_C_NO_NAME)\n\t\tgss_release_name(&ms, &(*ctx)->client);\n\tif ((*ctx)->client_creds != GSS_C_NO_CREDENTIAL)\n\t\tgss_release_cred(&ms, &(*ctx)->client_creds);\n\n\tfree(*ctx);\n\t*ctx = NULL;\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"ssh2.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_delete_ctx(Gssctxt **ctx)\n{\n\tOM_uint32 ms;\n\n\tif ((*ctx) == NULL)\n\t\treturn;\n\tif ((*ctx)->context != GSS_C_NO_CONTEXT)\n\t\tgss_delete_sec_context(&ms, &(*ctx)->context, GSS_C_NO_BUFFER);\n\tif ((*ctx)->name != GSS_C_NO_NAME)\n\t\tgss_release_name(&ms, &(*ctx)->name);\n\tif ((*ctx)->oid != GSS_C_NO_OID) {\n\t\tfree((*ctx)->oid->elements);\n\t\tfree((*ctx)->oid);\n\t\t(*ctx)->oid = GSS_C_NO_OID;\n\t}\n\tif ((*ctx)->creds != GSS_C_NO_CREDENTIAL)\n\t\tgss_release_cred(&ms, &(*ctx)->creds);\n\tif ((*ctx)->client != GSS_C_NO_NAME)\n\t\tgss_release_name(&ms, &(*ctx)->client);\n\tif ((*ctx)->client_creds != GSS_C_NO_CREDENTIAL)\n\t\tgss_release_cred(&ms, &(*ctx)->client_creds);\n\n\tfree(*ctx);\n\t*ctx = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GSS_ERROR",
          "args": [
            "major"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_delete_sec_context",
          "args": [
            "&minor",
            "&(*ctx)->context",
            "GSS_C_NO_BUFFER"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_release_buffer",
          "args": [
            "&minor",
            "&token"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssh_gssapi_init_ctx",
          "args": [
            "*ctx",
            "0",
            "GSS_C_NO_BUFFER",
            "&token",
            "NULL"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_init_ctx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
          "lines": "209-229",
          "snippet": "OM_uint32\nssh_gssapi_init_ctx(Gssctxt *ctx, int deleg_creds, gss_buffer_desc *recv_tok,\n    gss_buffer_desc* send_tok, OM_uint32 *flags)\n{\n\tint deleg_flag = 0;\n\n\tif (deleg_creds) {\n\t\tdeleg_flag = GSS_C_DELEG_FLAG;\n\t\tdebug(\"Delegating credentials\");\n\t}\n\n\tctx->major = gss_init_sec_context(&ctx->minor,\n\t    GSS_C_NO_CREDENTIAL, &ctx->context, ctx->name, ctx->oid,\n\t    GSS_C_MUTUAL_FLAG | GSS_C_INTEG_FLAG | deleg_flag,\n\t    0, NULL, recv_tok, NULL, send_tok, flags, NULL);\n\n\tif (GSS_ERROR(ctx->major))\n\t\tssh_gssapi_error(ctx);\n\n\treturn (ctx->major);\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"ssh2.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nOM_uint32\nssh_gssapi_init_ctx(Gssctxt *ctx, int deleg_creds, gss_buffer_desc *recv_tok,\n    gss_buffer_desc* send_tok, OM_uint32 *flags)\n{\n\tint deleg_flag = 0;\n\n\tif (deleg_creds) {\n\t\tdeleg_flag = GSS_C_DELEG_FLAG;\n\t\tdebug(\"Delegating credentials\");\n\t}\n\n\tctx->major = gss_init_sec_context(&ctx->minor,\n\t    GSS_C_NO_CREDENTIAL, &ctx->context, ctx->name, ctx->oid,\n\t    GSS_C_MUTUAL_FLAG | GSS_C_INTEG_FLAG | deleg_flag,\n\t    0, NULL, recv_tok, NULL, send_tok, flags, NULL);\n\n\tif (GSS_ERROR(ctx->major))\n\t\tssh_gssapi_error(ctx);\n\n\treturn (ctx->major);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GSS_ERROR",
          "args": [
            "major"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssh_gssapi_import_name",
          "args": [
            "*ctx",
            "host"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_import_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
          "lines": "232-248",
          "snippet": "OM_uint32\nssh_gssapi_import_name(Gssctxt *ctx, const char *host)\n{\n\tgss_buffer_desc gssbuf;\n\tchar *val;\n\n\txasprintf(&val, \"host@%s\", host);\n\tgssbuf.value = val;\n\tgssbuf.length = strlen(gssbuf.value);\n\n\tif ((ctx->major = gss_import_name(&ctx->minor,\n\t    &gssbuf, GSS_C_NT_HOSTBASED_SERVICE, &ctx->name)))\n\t\tssh_gssapi_error(ctx);\n\n\tfree(gssbuf.value);\n\treturn (ctx->major);\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"ssh2.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nOM_uint32\nssh_gssapi_import_name(Gssctxt *ctx, const char *host)\n{\n\tgss_buffer_desc gssbuf;\n\tchar *val;\n\n\txasprintf(&val, \"host@%s\", host);\n\tgssbuf.value = val;\n\tgssbuf.length = strlen(gssbuf.value);\n\n\tif ((ctx->major = gss_import_name(&ctx->minor,\n\t    &gssbuf, GSS_C_NT_HOSTBASED_SERVICE, &ctx->name)))\n\t\tssh_gssapi_error(ctx);\n\n\tfree(gssbuf.value);\n\treturn (ctx->major);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_gssapi_set_oid",
          "args": [
            "*ctx",
            "oid"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_set_oid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
          "lines": "89-93",
          "snippet": "void\nssh_gssapi_set_oid(Gssctxt *ctx, gss_OID oid)\n{\n\tssh_gssapi_set_oid_data(ctx, oid->elements, oid->length);\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"ssh2.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_set_oid(Gssctxt *ctx, gss_OID oid)\n{\n\tssh_gssapi_set_oid_data(ctx, oid->elements, oid->length);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_gssapi_build_ctx",
          "args": [
            "ctx"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_build_ctx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
          "lines": "163-173",
          "snippet": "void\nssh_gssapi_build_ctx(Gssctxt **ctx)\n{\n\t*ctx = xcalloc(1, sizeof (Gssctxt));\n\t(*ctx)->context = GSS_C_NO_CONTEXT;\n\t(*ctx)->name = GSS_C_NO_NAME;\n\t(*ctx)->oid = GSS_C_NO_OID;\n\t(*ctx)->creds = GSS_C_NO_CREDENTIAL;\n\t(*ctx)->client = GSS_C_NO_NAME;\n\t(*ctx)->client_creds = GSS_C_NO_CREDENTIAL;\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"ssh2.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_build_ctx(Gssctxt **ctx)\n{\n\t*ctx = xcalloc(1, sizeof (Gssctxt));\n\t(*ctx)->context = GSS_C_NO_CONTEXT;\n\t(*ctx)->name = GSS_C_NO_NAME;\n\t(*ctx)->oid = GSS_C_NO_OID;\n\t(*ctx)->creds = GSS_C_NO_CREDENTIAL;\n\t(*ctx)->client = GSS_C_NO_NAME;\n\t(*ctx)->client_creds = GSS_C_NO_CREDENTIAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "oid->elements",
            "spnego_oid.elements",
            "oid->length"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_gssapi_check_mechanism(Gssctxt **ctx, gss_OID oid, const char *host)\n{\n\tgss_buffer_desc token = GSS_C_EMPTY_BUFFER;\n\tOM_uint32 major, minor;\n\tgss_OID_desc spnego_oid = {6, (void *)\"\\x2B\\x06\\x01\\x05\\x05\\x02\"};\n\n\t/* RFC 4462 says we MUST NOT do SPNEGO */\n\tif (oid->length == spnego_oid.length && \n\t    (memcmp(oid->elements, spnego_oid.elements, oid->length) == 0))\n\t\treturn 0; /* false */\n\n\tssh_gssapi_build_ctx(ctx);\n\tssh_gssapi_set_oid(*ctx, oid);\n\tmajor = ssh_gssapi_import_name(*ctx, host);\n\tif (!GSS_ERROR(major)) {\n\t\tmajor = ssh_gssapi_init_ctx(*ctx, 0, GSS_C_NO_BUFFER, &token, \n\t\t    NULL);\n\t\tgss_release_buffer(&minor, &token);\n\t\tif ((*ctx)->context != GSS_C_NO_CONTEXT)\n\t\t\tgss_delete_sec_context(&minor, &(*ctx)->context,\n\t\t\t    GSS_C_NO_BUFFER);\n\t}\n\n\tif (GSS_ERROR(major)) \n\t\tssh_gssapi_delete_ctx(ctx);\n\n\treturn (!GSS_ERROR(major));\n}"
  },
  {
    "function_name": "ssh_gssapi_buildmic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
    "lines": "260-273",
    "snippet": "void\nssh_gssapi_buildmic(struct sshbuf *b, const char *user, const char *service,\n    const char *context)\n{\n\tint r;\n\n\tsshbuf_reset(b);\n\tif ((r = sshbuf_put_string(b, session_id2, session_id2_len)) != 0 ||\n\t    (r = sshbuf_put_u8(b, SSH2_MSG_USERAUTH_REQUEST)) != 0 ||\n\t    (r = sshbuf_put_cstring(b, user)) != 0 ||\n\t    (r = sshbuf_put_cstring(b, service)) != 0 ||\n\t    (r = sshbuf_put_cstring(b, context)) != 0)\n\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r));\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"ssh2.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"%s: buffer error: %s\"",
            "__func__",
            "ssh_err(r)"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fatal.c",
          "lines": "36-45",
          "snippet": "void\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\tcleanup_exit(255);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\tcleanup_exit(255);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_err",
          "args": [
            "r"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssherr.c",
          "lines": "22-147",
          "snippet": "const char *\nssh_err(int n)\n{\n\tswitch (n) {\n\tcase SSH_ERR_SUCCESS:\n\t\treturn \"success\";\n\tcase SSH_ERR_INTERNAL_ERROR:\n\t\treturn \"unexpected internal error\";\n\tcase SSH_ERR_ALLOC_FAIL:\n\t\treturn \"memory allocation failed\";\n\tcase SSH_ERR_MESSAGE_INCOMPLETE:\n\t\treturn \"incomplete message\";\n\tcase SSH_ERR_INVALID_FORMAT:\n\t\treturn \"invalid format\";\n\tcase SSH_ERR_BIGNUM_IS_NEGATIVE:\n\t\treturn \"bignum is negative\";\n\tcase SSH_ERR_STRING_TOO_LARGE:\n\t\treturn \"string is too large\";\n\tcase SSH_ERR_BIGNUM_TOO_LARGE:\n\t\treturn \"bignum is too large\";\n\tcase SSH_ERR_ECPOINT_TOO_LARGE:\n\t\treturn \"elliptic curve point is too large\";\n\tcase SSH_ERR_NO_BUFFER_SPACE:\n\t\treturn \"insufficient buffer space\";\n\tcase SSH_ERR_INVALID_ARGUMENT:\n\t\treturn \"invalid argument\";\n\tcase SSH_ERR_KEY_BITS_MISMATCH:\n\t\treturn \"key bits do not match\";\n\tcase SSH_ERR_EC_CURVE_INVALID:\n\t\treturn \"invalid elliptic curve\";\n\tcase SSH_ERR_KEY_TYPE_MISMATCH:\n\t\treturn \"key type does not match\";\n\tcase SSH_ERR_KEY_TYPE_UNKNOWN:\n\t\treturn \"unknown or unsupported key type\";\n\tcase SSH_ERR_EC_CURVE_MISMATCH:\n\t\treturn \"elliptic curve does not match\";\n\tcase SSH_ERR_EXPECTED_CERT:\n\t\treturn \"plain key provided where certificate required\";\n\tcase SSH_ERR_KEY_LACKS_CERTBLOB:\n\t\treturn \"key lacks certificate data\";\n\tcase SSH_ERR_KEY_CERT_UNKNOWN_TYPE:\n\t\treturn \"unknown/unsupported certificate type\";\n\tcase SSH_ERR_KEY_CERT_INVALID_SIGN_KEY:\n\t\treturn \"invalid certificate signing key\";\n\tcase SSH_ERR_KEY_INVALID_EC_VALUE:\n\t\treturn \"invalid elliptic curve value\";\n\tcase SSH_ERR_SIGNATURE_INVALID:\n\t\treturn \"incorrect signature\";\n\tcase SSH_ERR_LIBCRYPTO_ERROR:\n\t\treturn \"error in libcrypto\";  /* XXX fetch and return */\n\tcase SSH_ERR_UNEXPECTED_TRAILING_DATA:\n\t\treturn \"unexpected bytes remain after decoding\";\n\tcase SSH_ERR_SYSTEM_ERROR:\n\t\treturn strerror(errno);\n\tcase SSH_ERR_KEY_CERT_INVALID:\n\t\treturn \"invalid certificate\";\n\tcase SSH_ERR_AGENT_COMMUNICATION:\n\t\treturn \"communication with agent failed\";\n\tcase SSH_ERR_AGENT_FAILURE:\n\t\treturn \"agent refused operation\";\n\tcase SSH_ERR_DH_GEX_OUT_OF_RANGE:\n\t\treturn \"DH GEX group out of range\";\n\tcase SSH_ERR_DISCONNECTED:\n\t\treturn \"disconnected\";\n\tcase SSH_ERR_MAC_INVALID:\n\t\treturn \"message authentication code incorrect\";\n\tcase SSH_ERR_NO_CIPHER_ALG_MATCH:\n\t\treturn \"no matching cipher found\";\n\tcase SSH_ERR_NO_MAC_ALG_MATCH:\n\t\treturn \"no matching MAC found\";\n\tcase SSH_ERR_NO_COMPRESS_ALG_MATCH:\n\t\treturn \"no matching compression method found\";\n\tcase SSH_ERR_NO_KEX_ALG_MATCH:\n\t\treturn \"no matching key exchange method found\";\n\tcase SSH_ERR_NO_HOSTKEY_ALG_MATCH:\n\t\treturn \"no matching host key type found\";\n\tcase SSH_ERR_PROTOCOL_MISMATCH:\n\t\treturn \"protocol version mismatch\";\n\tcase SSH_ERR_NO_PROTOCOL_VERSION:\n\t\treturn \"could not read protocol version\";\n\tcase SSH_ERR_NO_HOSTKEY_LOADED:\n\t\treturn \"could not load host key\";\n\tcase SSH_ERR_NEED_REKEY:\n\t\treturn \"rekeying not supported by peer\";\n\tcase SSH_ERR_PASSPHRASE_TOO_SHORT:\n\t\treturn \"passphrase is too short (minimum five characters)\";\n\tcase SSH_ERR_FILE_CHANGED:\n\t\treturn \"file changed while reading\";\n\tcase SSH_ERR_KEY_UNKNOWN_CIPHER:\n\t\treturn \"key encrypted using unsupported cipher\";\n\tcase SSH_ERR_KEY_WRONG_PASSPHRASE:\n\t\treturn \"incorrect passphrase supplied to decrypt private key\";\n\tcase SSH_ERR_KEY_BAD_PERMISSIONS:\n\t\treturn \"bad permissions\";\n\tcase SSH_ERR_KEY_CERT_MISMATCH:\n\t\treturn \"certificate does not match key\";\n\tcase SSH_ERR_KEY_NOT_FOUND:\n\t\treturn \"key not found\";\n\tcase SSH_ERR_AGENT_NOT_PRESENT:\n\t\treturn \"agent not present\";\n\tcase SSH_ERR_AGENT_NO_IDENTITIES:\n\t\treturn \"agent contains no identities\";\n\tcase SSH_ERR_BUFFER_READ_ONLY:\n\t\treturn \"internal error: buffer is read-only\";\n\tcase SSH_ERR_KRL_BAD_MAGIC:\n\t\treturn \"KRL file has invalid magic number\";\n\tcase SSH_ERR_KEY_REVOKED:\n\t\treturn \"Key is revoked\";\n\tcase SSH_ERR_CONN_CLOSED:\n\t\treturn \"Connection closed\";\n\tcase SSH_ERR_CONN_TIMEOUT:\n\t\treturn \"Connection timed out\";\n\tcase SSH_ERR_CONN_CORRUPT:\n\t\treturn \"Connection corrupted\";\n\tcase SSH_ERR_PROTOCOL_ERROR:\n\t\treturn \"Protocol error\";\n\tcase SSH_ERR_KEY_LENGTH:\n\t\treturn \"Invalid key length\";\n\tcase SSH_ERR_NUMBER_TOO_LARGE:\n\t\treturn \"number is too large\";\n\tcase SSH_ERR_SIGN_ALG_UNSUPPORTED:\n\t\treturn \"signature algorithm not supported\";\n\tdefault:\n\t\treturn \"unknown error\";\n\t}\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include <string.h>\n#include <errno.h>\n\nconst char *\nssh_err(int n)\n{\n\tswitch (n) {\n\tcase SSH_ERR_SUCCESS:\n\t\treturn \"success\";\n\tcase SSH_ERR_INTERNAL_ERROR:\n\t\treturn \"unexpected internal error\";\n\tcase SSH_ERR_ALLOC_FAIL:\n\t\treturn \"memory allocation failed\";\n\tcase SSH_ERR_MESSAGE_INCOMPLETE:\n\t\treturn \"incomplete message\";\n\tcase SSH_ERR_INVALID_FORMAT:\n\t\treturn \"invalid format\";\n\tcase SSH_ERR_BIGNUM_IS_NEGATIVE:\n\t\treturn \"bignum is negative\";\n\tcase SSH_ERR_STRING_TOO_LARGE:\n\t\treturn \"string is too large\";\n\tcase SSH_ERR_BIGNUM_TOO_LARGE:\n\t\treturn \"bignum is too large\";\n\tcase SSH_ERR_ECPOINT_TOO_LARGE:\n\t\treturn \"elliptic curve point is too large\";\n\tcase SSH_ERR_NO_BUFFER_SPACE:\n\t\treturn \"insufficient buffer space\";\n\tcase SSH_ERR_INVALID_ARGUMENT:\n\t\treturn \"invalid argument\";\n\tcase SSH_ERR_KEY_BITS_MISMATCH:\n\t\treturn \"key bits do not match\";\n\tcase SSH_ERR_EC_CURVE_INVALID:\n\t\treturn \"invalid elliptic curve\";\n\tcase SSH_ERR_KEY_TYPE_MISMATCH:\n\t\treturn \"key type does not match\";\n\tcase SSH_ERR_KEY_TYPE_UNKNOWN:\n\t\treturn \"unknown or unsupported key type\";\n\tcase SSH_ERR_EC_CURVE_MISMATCH:\n\t\treturn \"elliptic curve does not match\";\n\tcase SSH_ERR_EXPECTED_CERT:\n\t\treturn \"plain key provided where certificate required\";\n\tcase SSH_ERR_KEY_LACKS_CERTBLOB:\n\t\treturn \"key lacks certificate data\";\n\tcase SSH_ERR_KEY_CERT_UNKNOWN_TYPE:\n\t\treturn \"unknown/unsupported certificate type\";\n\tcase SSH_ERR_KEY_CERT_INVALID_SIGN_KEY:\n\t\treturn \"invalid certificate signing key\";\n\tcase SSH_ERR_KEY_INVALID_EC_VALUE:\n\t\treturn \"invalid elliptic curve value\";\n\tcase SSH_ERR_SIGNATURE_INVALID:\n\t\treturn \"incorrect signature\";\n\tcase SSH_ERR_LIBCRYPTO_ERROR:\n\t\treturn \"error in libcrypto\";  /* XXX fetch and return */\n\tcase SSH_ERR_UNEXPECTED_TRAILING_DATA:\n\t\treturn \"unexpected bytes remain after decoding\";\n\tcase SSH_ERR_SYSTEM_ERROR:\n\t\treturn strerror(errno);\n\tcase SSH_ERR_KEY_CERT_INVALID:\n\t\treturn \"invalid certificate\";\n\tcase SSH_ERR_AGENT_COMMUNICATION:\n\t\treturn \"communication with agent failed\";\n\tcase SSH_ERR_AGENT_FAILURE:\n\t\treturn \"agent refused operation\";\n\tcase SSH_ERR_DH_GEX_OUT_OF_RANGE:\n\t\treturn \"DH GEX group out of range\";\n\tcase SSH_ERR_DISCONNECTED:\n\t\treturn \"disconnected\";\n\tcase SSH_ERR_MAC_INVALID:\n\t\treturn \"message authentication code incorrect\";\n\tcase SSH_ERR_NO_CIPHER_ALG_MATCH:\n\t\treturn \"no matching cipher found\";\n\tcase SSH_ERR_NO_MAC_ALG_MATCH:\n\t\treturn \"no matching MAC found\";\n\tcase SSH_ERR_NO_COMPRESS_ALG_MATCH:\n\t\treturn \"no matching compression method found\";\n\tcase SSH_ERR_NO_KEX_ALG_MATCH:\n\t\treturn \"no matching key exchange method found\";\n\tcase SSH_ERR_NO_HOSTKEY_ALG_MATCH:\n\t\treturn \"no matching host key type found\";\n\tcase SSH_ERR_PROTOCOL_MISMATCH:\n\t\treturn \"protocol version mismatch\";\n\tcase SSH_ERR_NO_PROTOCOL_VERSION:\n\t\treturn \"could not read protocol version\";\n\tcase SSH_ERR_NO_HOSTKEY_LOADED:\n\t\treturn \"could not load host key\";\n\tcase SSH_ERR_NEED_REKEY:\n\t\treturn \"rekeying not supported by peer\";\n\tcase SSH_ERR_PASSPHRASE_TOO_SHORT:\n\t\treturn \"passphrase is too short (minimum five characters)\";\n\tcase SSH_ERR_FILE_CHANGED:\n\t\treturn \"file changed while reading\";\n\tcase SSH_ERR_KEY_UNKNOWN_CIPHER:\n\t\treturn \"key encrypted using unsupported cipher\";\n\tcase SSH_ERR_KEY_WRONG_PASSPHRASE:\n\t\treturn \"incorrect passphrase supplied to decrypt private key\";\n\tcase SSH_ERR_KEY_BAD_PERMISSIONS:\n\t\treturn \"bad permissions\";\n\tcase SSH_ERR_KEY_CERT_MISMATCH:\n\t\treturn \"certificate does not match key\";\n\tcase SSH_ERR_KEY_NOT_FOUND:\n\t\treturn \"key not found\";\n\tcase SSH_ERR_AGENT_NOT_PRESENT:\n\t\treturn \"agent not present\";\n\tcase SSH_ERR_AGENT_NO_IDENTITIES:\n\t\treturn \"agent contains no identities\";\n\tcase SSH_ERR_BUFFER_READ_ONLY:\n\t\treturn \"internal error: buffer is read-only\";\n\tcase SSH_ERR_KRL_BAD_MAGIC:\n\t\treturn \"KRL file has invalid magic number\";\n\tcase SSH_ERR_KEY_REVOKED:\n\t\treturn \"Key is revoked\";\n\tcase SSH_ERR_CONN_CLOSED:\n\t\treturn \"Connection closed\";\n\tcase SSH_ERR_CONN_TIMEOUT:\n\t\treturn \"Connection timed out\";\n\tcase SSH_ERR_CONN_CORRUPT:\n\t\treturn \"Connection corrupted\";\n\tcase SSH_ERR_PROTOCOL_ERROR:\n\t\treturn \"Protocol error\";\n\tcase SSH_ERR_KEY_LENGTH:\n\t\treturn \"Invalid key length\";\n\tcase SSH_ERR_NUMBER_TOO_LARGE:\n\t\treturn \"number is too large\";\n\tcase SSH_ERR_SIGN_ALG_UNSUPPORTED:\n\t\treturn \"signature algorithm not supported\";\n\tdefault:\n\t\treturn \"unknown error\";\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_put_cstring",
          "args": [
            "b",
            "context"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "365-369",
          "snippet": "int\nsshbuf_put_cstring(struct sshbuf *buf, const char *v)\n{\n\treturn sshbuf_put_string(buf, v, v == NULL ? 0 : strlen(v));\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_cstring(struct sshbuf *buf, const char *v)\n{\n\treturn sshbuf_put_string(buf, v, v == NULL ? 0 : strlen(v));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_put_u8",
          "args": [
            "b",
            "SSH2_MSG_USERAUTH_REQUEST"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_u8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "335-345",
          "snippet": "int\nsshbuf_put_u8(struct sshbuf *buf, u_char val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 1, &p)) < 0)\n\t\treturn r;\n\tp[0] = val;\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_u8(struct sshbuf *buf, u_char val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 1, &p)) < 0)\n\t\treturn r;\n\tp[0] = val;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_put_string",
          "args": [
            "b",
            "session_id2",
            "session_id2_len"
          ],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "347-363",
          "snippet": "int\nsshbuf_put_string(struct sshbuf *buf, const void *v, size_t len)\n{\n\tu_char *d;\n\tint r;\n\n\tif (len > SSHBUF_SIZE_MAX - 4) {\n\t\tSSHBUF_DBG((\"SSH_ERR_NO_BUFFER_SPACE\"));\n\t\treturn SSH_ERR_NO_BUFFER_SPACE;\n\t}\n\tif ((r = sshbuf_reserve(buf, len + 4, &d)) < 0)\n\t\treturn r;\n\tPOKE_U32(d, len);\n\tif (len != 0)\n\t\tmemcpy(d + 4, v, len);\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_string(struct sshbuf *buf, const void *v, size_t len)\n{\n\tu_char *d;\n\tint r;\n\n\tif (len > SSHBUF_SIZE_MAX - 4) {\n\t\tSSHBUF_DBG((\"SSH_ERR_NO_BUFFER_SPACE\"));\n\t\treturn SSH_ERR_NO_BUFFER_SPACE;\n\t}\n\tif ((r = sshbuf_reserve(buf, len + 4, &d)) < 0)\n\t\treturn r;\n\tPOKE_U32(d, len);\n\tif (len != 0)\n\t\tmemcpy(d + 4, v, len);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_reset",
          "args": [
            "b"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "168-188",
          "snippet": "void\nsshbuf_reset(struct sshbuf *buf)\n{\n\tu_char *d;\n\n\tif (buf->readonly || buf->refcount > 1) {\n\t\t/* Nonsensical. Just make buffer appear empty */\n\t\tbuf->off = buf->size;\n\t\treturn;\n\t}\n\t(void) sshbuf_check_sanity(buf);\n\tbuf->off = buf->size = 0;\n\tif (buf->alloc != SSHBUF_SIZE_INIT) {\n\t\tif ((d = recallocarray(buf->d, buf->alloc, SSHBUF_SIZE_INIT,\n\t\t    1)) != NULL) {\n\t\t\tbuf->cd = buf->d = d;\n\t\t\tbuf->alloc = SSHBUF_SIZE_INIT;\n\t\t}\n\t}\n\texplicit_bzero(buf->d, SSHBUF_SIZE_INIT);\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nsshbuf_reset(struct sshbuf *buf)\n{\n\tu_char *d;\n\n\tif (buf->readonly || buf->refcount > 1) {\n\t\t/* Nonsensical. Just make buffer appear empty */\n\t\tbuf->off = buf->size;\n\t\treturn;\n\t}\n\t(void) sshbuf_check_sanity(buf);\n\tbuf->off = buf->size = 0;\n\tif (buf->alloc != SSHBUF_SIZE_INIT) {\n\t\tif ((d = recallocarray(buf->d, buf->alloc, SSHBUF_SIZE_INIT,\n\t\t    1)) != NULL) {\n\t\t\tbuf->cd = buf->d = d;\n\t\t\tbuf->alloc = SSHBUF_SIZE_INIT;\n\t\t}\n\t}\n\texplicit_bzero(buf->d, SSHBUF_SIZE_INIT);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_buildmic(struct sshbuf *b, const char *user, const char *service,\n    const char *context)\n{\n\tint r;\n\n\tsshbuf_reset(b);\n\tif ((r = sshbuf_put_string(b, session_id2, session_id2_len)) != 0 ||\n\t    (r = sshbuf_put_u8(b, SSH2_MSG_USERAUTH_REQUEST)) != 0 ||\n\t    (r = sshbuf_put_cstring(b, user)) != 0 ||\n\t    (r = sshbuf_put_cstring(b, service)) != 0 ||\n\t    (r = sshbuf_put_cstring(b, context)) != 0)\n\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r));\n}"
  },
  {
    "function_name": "ssh_gssapi_sign",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
    "lines": "250-258",
    "snippet": "OM_uint32\nssh_gssapi_sign(Gssctxt *ctx, gss_buffer_t buffer, gss_buffer_t hash)\n{\n\tif ((ctx->major = gss_get_mic(&ctx->minor, ctx->context,\n\t    GSS_C_QOP_DEFAULT, buffer, hash)))\n\t\tssh_gssapi_error(ctx);\n\n\treturn (ctx->major);\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"ssh2.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_gssapi_error",
          "args": [
            "ctx"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
          "lines": "96-104",
          "snippet": "void\nssh_gssapi_error(Gssctxt *ctxt)\n{\n\tchar *s;\n\n\ts = ssh_gssapi_last_error(ctxt, NULL, NULL);\n\tdebug(\"%s\", s);\n\tfree(s);\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"ssh2.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_error(Gssctxt *ctxt)\n{\n\tchar *s;\n\n\ts = ssh_gssapi_last_error(ctxt, NULL, NULL);\n\tdebug(\"%s\", s);\n\tfree(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gss_get_mic",
          "args": [
            "&ctx->minor",
            "ctx->context",
            "GSS_C_QOP_DEFAULT",
            "buffer",
            "hash"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nOM_uint32\nssh_gssapi_sign(Gssctxt *ctx, gss_buffer_t buffer, gss_buffer_t hash)\n{\n\tif ((ctx->major = gss_get_mic(&ctx->minor, ctx->context,\n\t    GSS_C_QOP_DEFAULT, buffer, hash)))\n\t\tssh_gssapi_error(ctx);\n\n\treturn (ctx->major);\n}"
  },
  {
    "function_name": "ssh_gssapi_import_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
    "lines": "232-248",
    "snippet": "OM_uint32\nssh_gssapi_import_name(Gssctxt *ctx, const char *host)\n{\n\tgss_buffer_desc gssbuf;\n\tchar *val;\n\n\txasprintf(&val, \"host@%s\", host);\n\tgssbuf.value = val;\n\tgssbuf.length = strlen(gssbuf.value);\n\n\tif ((ctx->major = gss_import_name(&ctx->minor,\n\t    &gssbuf, GSS_C_NT_HOSTBASED_SERVICE, &ctx->name)))\n\t\tssh_gssapi_error(ctx);\n\n\tfree(gssbuf.value);\n\treturn (ctx->major);\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"ssh2.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "gssbuf.value"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "freeze",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/smult_curve25519_ref.c",
          "lines": "50-60",
          "snippet": "static void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [
            "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;"
          ],
          "called_functions": [],
          "contextual_snippet": "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;\n\nstatic void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_gssapi_error",
          "args": [
            "ctx"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
          "lines": "96-104",
          "snippet": "void\nssh_gssapi_error(Gssctxt *ctxt)\n{\n\tchar *s;\n\n\ts = ssh_gssapi_last_error(ctxt, NULL, NULL);\n\tdebug(\"%s\", s);\n\tfree(s);\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"ssh2.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_error(Gssctxt *ctxt)\n{\n\tchar *s;\n\n\ts = ssh_gssapi_last_error(ctxt, NULL, NULL);\n\tdebug(\"%s\", s);\n\tfree(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gss_import_name",
          "args": [
            "&ctx->minor",
            "&gssbuf",
            "GSS_C_NT_HOSTBASED_SERVICE",
            "&ctx->name"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "gssbuf.value"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xasprintf",
          "args": [
            "&val",
            "\"host@%s\"",
            "host"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "xasprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "104-118",
          "snippet": "int\nxasprintf(char **ret, const char *fmt, ...)\n{\n\tva_list ap;\n\tint i;\n\n\tva_start(ap, fmt);\n\ti = vasprintf(ret, fmt, ap);\n\tva_end(ap);\n\n\tif (i < 0 || *ret == NULL)\n\t\tfatal(\"xasprintf: could not allocate memory\");\n\n\treturn (i);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nint\nxasprintf(char **ret, const char *fmt, ...)\n{\n\tva_list ap;\n\tint i;\n\n\tva_start(ap, fmt);\n\ti = vasprintf(ret, fmt, ap);\n\tva_end(ap);\n\n\tif (i < 0 || *ret == NULL)\n\t\tfatal(\"xasprintf: could not allocate memory\");\n\n\treturn (i);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nOM_uint32\nssh_gssapi_import_name(Gssctxt *ctx, const char *host)\n{\n\tgss_buffer_desc gssbuf;\n\tchar *val;\n\n\txasprintf(&val, \"host@%s\", host);\n\tgssbuf.value = val;\n\tgssbuf.length = strlen(gssbuf.value);\n\n\tif ((ctx->major = gss_import_name(&ctx->minor,\n\t    &gssbuf, GSS_C_NT_HOSTBASED_SERVICE, &ctx->name)))\n\t\tssh_gssapi_error(ctx);\n\n\tfree(gssbuf.value);\n\treturn (ctx->major);\n}"
  },
  {
    "function_name": "ssh_gssapi_init_ctx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
    "lines": "209-229",
    "snippet": "OM_uint32\nssh_gssapi_init_ctx(Gssctxt *ctx, int deleg_creds, gss_buffer_desc *recv_tok,\n    gss_buffer_desc* send_tok, OM_uint32 *flags)\n{\n\tint deleg_flag = 0;\n\n\tif (deleg_creds) {\n\t\tdeleg_flag = GSS_C_DELEG_FLAG;\n\t\tdebug(\"Delegating credentials\");\n\t}\n\n\tctx->major = gss_init_sec_context(&ctx->minor,\n\t    GSS_C_NO_CREDENTIAL, &ctx->context, ctx->name, ctx->oid,\n\t    GSS_C_MUTUAL_FLAG | GSS_C_INTEG_FLAG | deleg_flag,\n\t    0, NULL, recv_tok, NULL, send_tok, flags, NULL);\n\n\tif (GSS_ERROR(ctx->major))\n\t\tssh_gssapi_error(ctx);\n\n\treturn (ctx->major);\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"ssh2.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_gssapi_error",
          "args": [
            "ctx"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
          "lines": "96-104",
          "snippet": "void\nssh_gssapi_error(Gssctxt *ctxt)\n{\n\tchar *s;\n\n\ts = ssh_gssapi_last_error(ctxt, NULL, NULL);\n\tdebug(\"%s\", s);\n\tfree(s);\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"ssh2.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_error(Gssctxt *ctxt)\n{\n\tchar *s;\n\n\ts = ssh_gssapi_last_error(ctxt, NULL, NULL);\n\tdebug(\"%s\", s);\n\tfree(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GSS_ERROR",
          "args": [
            "ctx->major"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_init_sec_context",
          "args": [
            "&ctx->minor",
            "GSS_C_NO_CREDENTIAL",
            "&ctx->context",
            "ctx->name",
            "ctx->oid",
            "GSS_C_MUTUAL_FLAG | GSS_C_INTEG_FLAG | deleg_flag",
            "0",
            "NULL",
            "recv_tok",
            "NULL",
            "send_tok",
            "flags",
            "NULL"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"Delegating credentials\""
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nOM_uint32\nssh_gssapi_init_ctx(Gssctxt *ctx, int deleg_creds, gss_buffer_desc *recv_tok,\n    gss_buffer_desc* send_tok, OM_uint32 *flags)\n{\n\tint deleg_flag = 0;\n\n\tif (deleg_creds) {\n\t\tdeleg_flag = GSS_C_DELEG_FLAG;\n\t\tdebug(\"Delegating credentials\");\n\t}\n\n\tctx->major = gss_init_sec_context(&ctx->minor,\n\t    GSS_C_NO_CREDENTIAL, &ctx->context, ctx->name, ctx->oid,\n\t    GSS_C_MUTUAL_FLAG | GSS_C_INTEG_FLAG | deleg_flag,\n\t    0, NULL, recv_tok, NULL, send_tok, flags, NULL);\n\n\tif (GSS_ERROR(ctx->major))\n\t\tssh_gssapi_error(ctx);\n\n\treturn (ctx->major);\n}"
  },
  {
    "function_name": "ssh_gssapi_delete_ctx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
    "lines": "176-201",
    "snippet": "void\nssh_gssapi_delete_ctx(Gssctxt **ctx)\n{\n\tOM_uint32 ms;\n\n\tif ((*ctx) == NULL)\n\t\treturn;\n\tif ((*ctx)->context != GSS_C_NO_CONTEXT)\n\t\tgss_delete_sec_context(&ms, &(*ctx)->context, GSS_C_NO_BUFFER);\n\tif ((*ctx)->name != GSS_C_NO_NAME)\n\t\tgss_release_name(&ms, &(*ctx)->name);\n\tif ((*ctx)->oid != GSS_C_NO_OID) {\n\t\tfree((*ctx)->oid->elements);\n\t\tfree((*ctx)->oid);\n\t\t(*ctx)->oid = GSS_C_NO_OID;\n\t}\n\tif ((*ctx)->creds != GSS_C_NO_CREDENTIAL)\n\t\tgss_release_cred(&ms, &(*ctx)->creds);\n\tif ((*ctx)->client != GSS_C_NO_NAME)\n\t\tgss_release_name(&ms, &(*ctx)->client);\n\tif ((*ctx)->client_creds != GSS_C_NO_CREDENTIAL)\n\t\tgss_release_cred(&ms, &(*ctx)->client_creds);\n\n\tfree(*ctx);\n\t*ctx = NULL;\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"ssh2.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "*ctx"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "freeze",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/smult_curve25519_ref.c",
          "lines": "50-60",
          "snippet": "static void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [
            "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;"
          ],
          "called_functions": [],
          "contextual_snippet": "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;\n\nstatic void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gss_release_cred",
          "args": [
            "&ms",
            "&(*ctx)->client_creds"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_release_name",
          "args": [
            "&ms",
            "&(*ctx)->client"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_release_cred",
          "args": [
            "&ms",
            "&(*ctx)->creds"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_release_name",
          "args": [
            "&ms",
            "&(*ctx)->name"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_delete_sec_context",
          "args": [
            "&ms",
            "&(*ctx)->context",
            "GSS_C_NO_BUFFER"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_delete_ctx(Gssctxt **ctx)\n{\n\tOM_uint32 ms;\n\n\tif ((*ctx) == NULL)\n\t\treturn;\n\tif ((*ctx)->context != GSS_C_NO_CONTEXT)\n\t\tgss_delete_sec_context(&ms, &(*ctx)->context, GSS_C_NO_BUFFER);\n\tif ((*ctx)->name != GSS_C_NO_NAME)\n\t\tgss_release_name(&ms, &(*ctx)->name);\n\tif ((*ctx)->oid != GSS_C_NO_OID) {\n\t\tfree((*ctx)->oid->elements);\n\t\tfree((*ctx)->oid);\n\t\t(*ctx)->oid = GSS_C_NO_OID;\n\t}\n\tif ((*ctx)->creds != GSS_C_NO_CREDENTIAL)\n\t\tgss_release_cred(&ms, &(*ctx)->creds);\n\tif ((*ctx)->client != GSS_C_NO_NAME)\n\t\tgss_release_name(&ms, &(*ctx)->client);\n\tif ((*ctx)->client_creds != GSS_C_NO_CREDENTIAL)\n\t\tgss_release_cred(&ms, &(*ctx)->client_creds);\n\n\tfree(*ctx);\n\t*ctx = NULL;\n}"
  },
  {
    "function_name": "ssh_gssapi_build_ctx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
    "lines": "163-173",
    "snippet": "void\nssh_gssapi_build_ctx(Gssctxt **ctx)\n{\n\t*ctx = xcalloc(1, sizeof (Gssctxt));\n\t(*ctx)->context = GSS_C_NO_CONTEXT;\n\t(*ctx)->name = GSS_C_NO_NAME;\n\t(*ctx)->oid = GSS_C_NO_OID;\n\t(*ctx)->creds = GSS_C_NO_CREDENTIAL;\n\t(*ctx)->client = GSS_C_NO_NAME;\n\t(*ctx)->client_creds = GSS_C_NO_CREDENTIAL;\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"ssh2.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xcalloc",
          "args": [
            "1",
            "sizeof (Gssctxt)"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "xcalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "52-66",
          "snippet": "void *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_build_ctx(Gssctxt **ctx)\n{\n\t*ctx = xcalloc(1, sizeof (Gssctxt));\n\t(*ctx)->context = GSS_C_NO_CONTEXT;\n\t(*ctx)->name = GSS_C_NO_NAME;\n\t(*ctx)->oid = GSS_C_NO_OID;\n\t(*ctx)->creds = GSS_C_NO_CREDENTIAL;\n\t(*ctx)->client = GSS_C_NO_NAME;\n\t(*ctx)->client_creds = GSS_C_NO_CREDENTIAL;\n}"
  },
  {
    "function_name": "ssh_gssapi_last_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
    "lines": "106-155",
    "snippet": "char *\nssh_gssapi_last_error(Gssctxt *ctxt, OM_uint32 *major_status,\n    OM_uint32 *minor_status)\n{\n\tOM_uint32 lmin;\n\tgss_buffer_desc msg = GSS_C_EMPTY_BUFFER;\n\tOM_uint32 ctx;\n\tstruct sshbuf *b;\n\tchar *ret;\n\tint r;\n\n\tif ((b = sshbuf_new()) == NULL)\n\t\tfatal(\"%s: sshbuf_new failed\", __func__);\n\n\tif (major_status != NULL)\n\t\t*major_status = ctxt->major;\n\tif (minor_status != NULL)\n\t\t*minor_status = ctxt->minor;\n\n\tctx = 0;\n\t/* The GSSAPI error */\n\tdo {\n\t\tgss_display_status(&lmin, ctxt->major,\n\t\t    GSS_C_GSS_CODE, ctxt->oid, &ctx, &msg);\n\n\t\tif ((r = sshbuf_put(b, msg.value, msg.length)) != 0 ||\n\t\t    (r = sshbuf_put_u8(b, '\\n')) != 0)\n\t\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r));\n\n\t\tgss_release_buffer(&lmin, &msg);\n\t} while (ctx != 0);\n\n\t/* The mechanism specific error */\n\tdo {\n\t\tgss_display_status(&lmin, ctxt->minor,\n\t\t    GSS_C_MECH_CODE, ctxt->oid, &ctx, &msg);\n\n\t\tif ((r = sshbuf_put(b, msg.value, msg.length)) != 0 ||\n\t\t    (r = sshbuf_put_u8(b, '\\n')) != 0)\n\t\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r));\n\n\t\tgss_release_buffer(&lmin, &msg);\n\t} while (ctx != 0);\n\n\tif ((r = sshbuf_put_u8(b, '\\n')) != 0)\n\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r));\n\tret = xstrdup((const char *)sshbuf_ptr(b));\n\tsshbuf_free(b);\n\treturn (ret);\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"ssh2.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sshbuf_free",
          "args": [
            "b"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "133-166",
          "snippet": "void\nsshbuf_free(struct sshbuf *buf)\n{\n\tif (buf == NULL)\n\t\treturn;\n\t/*\n\t * The following will leak on insane buffers, but this is the safest\n\t * course of action - an invalid pointer or already-freed pointer may\n\t * have been passed to us and continuing to scribble over memory would\n\t * be bad.\n\t */\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn;\n\t/*\n\t * If we are a child, the free our parent to decrement its reference\n\t * count and possibly free it.\n\t */\n\tsshbuf_free(buf->parent);\n\tbuf->parent = NULL;\n\t/*\n\t * If we are a parent with still-extant children, then don't free just\n\t * yet. The last child's call to sshbuf_free should decrement our\n\t * refcount to 0 and trigger the actual free.\n\t */\n\tbuf->refcount--;\n\tif (buf->refcount > 0)\n\t\treturn;\n\tif (!buf->readonly) {\n\t\texplicit_bzero(buf->d, buf->alloc);\n\t\tfree(buf->d);\n\t}\n\texplicit_bzero(buf, sizeof(*buf));\n\tfree(buf);\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nsshbuf_free(struct sshbuf *buf)\n{\n\tif (buf == NULL)\n\t\treturn;\n\t/*\n\t * The following will leak on insane buffers, but this is the safest\n\t * course of action - an invalid pointer or already-freed pointer may\n\t * have been passed to us and continuing to scribble over memory would\n\t * be bad.\n\t */\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn;\n\t/*\n\t * If we are a child, the free our parent to decrement its reference\n\t * count and possibly free it.\n\t */\n\tsshbuf_free(buf->parent);\n\tbuf->parent = NULL;\n\t/*\n\t * If we are a parent with still-extant children, then don't free just\n\t * yet. The last child's call to sshbuf_free should decrement our\n\t * refcount to 0 and trigger the actual free.\n\t */\n\tbuf->refcount--;\n\tif (buf->refcount > 0)\n\t\treturn;\n\tif (!buf->readonly) {\n\t\texplicit_bzero(buf->d, buf->alloc);\n\t\tfree(buf->d);\n\t}\n\texplicit_bzero(buf, sizeof(*buf));\n\tfree(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "(const char *)sshbuf_ptr(b)"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "xstrdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "92-102",
          "snippet": "char *\nxstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = xmalloc(len);\n\tstrlcpy(cp, str, len);\n\treturn cp;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nchar *\nxstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = xmalloc(len);\n\tstrlcpy(cp, str, len);\n\treturn cp;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_ptr",
          "args": [
            "b"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "268-274",
          "snippet": "const u_char *\nsshbuf_ptr(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn NULL;\n\treturn buf->cd + buf->off;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst u_char *\nsshbuf_ptr(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn NULL;\n\treturn buf->cd + buf->off;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"%s: buffer error: %s\"",
            "__func__",
            "ssh_err(r)"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fatal.c",
          "lines": "36-45",
          "snippet": "void\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\tcleanup_exit(255);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\tcleanup_exit(255);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_err",
          "args": [
            "r"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssherr.c",
          "lines": "22-147",
          "snippet": "const char *\nssh_err(int n)\n{\n\tswitch (n) {\n\tcase SSH_ERR_SUCCESS:\n\t\treturn \"success\";\n\tcase SSH_ERR_INTERNAL_ERROR:\n\t\treturn \"unexpected internal error\";\n\tcase SSH_ERR_ALLOC_FAIL:\n\t\treturn \"memory allocation failed\";\n\tcase SSH_ERR_MESSAGE_INCOMPLETE:\n\t\treturn \"incomplete message\";\n\tcase SSH_ERR_INVALID_FORMAT:\n\t\treturn \"invalid format\";\n\tcase SSH_ERR_BIGNUM_IS_NEGATIVE:\n\t\treturn \"bignum is negative\";\n\tcase SSH_ERR_STRING_TOO_LARGE:\n\t\treturn \"string is too large\";\n\tcase SSH_ERR_BIGNUM_TOO_LARGE:\n\t\treturn \"bignum is too large\";\n\tcase SSH_ERR_ECPOINT_TOO_LARGE:\n\t\treturn \"elliptic curve point is too large\";\n\tcase SSH_ERR_NO_BUFFER_SPACE:\n\t\treturn \"insufficient buffer space\";\n\tcase SSH_ERR_INVALID_ARGUMENT:\n\t\treturn \"invalid argument\";\n\tcase SSH_ERR_KEY_BITS_MISMATCH:\n\t\treturn \"key bits do not match\";\n\tcase SSH_ERR_EC_CURVE_INVALID:\n\t\treturn \"invalid elliptic curve\";\n\tcase SSH_ERR_KEY_TYPE_MISMATCH:\n\t\treturn \"key type does not match\";\n\tcase SSH_ERR_KEY_TYPE_UNKNOWN:\n\t\treturn \"unknown or unsupported key type\";\n\tcase SSH_ERR_EC_CURVE_MISMATCH:\n\t\treturn \"elliptic curve does not match\";\n\tcase SSH_ERR_EXPECTED_CERT:\n\t\treturn \"plain key provided where certificate required\";\n\tcase SSH_ERR_KEY_LACKS_CERTBLOB:\n\t\treturn \"key lacks certificate data\";\n\tcase SSH_ERR_KEY_CERT_UNKNOWN_TYPE:\n\t\treturn \"unknown/unsupported certificate type\";\n\tcase SSH_ERR_KEY_CERT_INVALID_SIGN_KEY:\n\t\treturn \"invalid certificate signing key\";\n\tcase SSH_ERR_KEY_INVALID_EC_VALUE:\n\t\treturn \"invalid elliptic curve value\";\n\tcase SSH_ERR_SIGNATURE_INVALID:\n\t\treturn \"incorrect signature\";\n\tcase SSH_ERR_LIBCRYPTO_ERROR:\n\t\treturn \"error in libcrypto\";  /* XXX fetch and return */\n\tcase SSH_ERR_UNEXPECTED_TRAILING_DATA:\n\t\treturn \"unexpected bytes remain after decoding\";\n\tcase SSH_ERR_SYSTEM_ERROR:\n\t\treturn strerror(errno);\n\tcase SSH_ERR_KEY_CERT_INVALID:\n\t\treturn \"invalid certificate\";\n\tcase SSH_ERR_AGENT_COMMUNICATION:\n\t\treturn \"communication with agent failed\";\n\tcase SSH_ERR_AGENT_FAILURE:\n\t\treturn \"agent refused operation\";\n\tcase SSH_ERR_DH_GEX_OUT_OF_RANGE:\n\t\treturn \"DH GEX group out of range\";\n\tcase SSH_ERR_DISCONNECTED:\n\t\treturn \"disconnected\";\n\tcase SSH_ERR_MAC_INVALID:\n\t\treturn \"message authentication code incorrect\";\n\tcase SSH_ERR_NO_CIPHER_ALG_MATCH:\n\t\treturn \"no matching cipher found\";\n\tcase SSH_ERR_NO_MAC_ALG_MATCH:\n\t\treturn \"no matching MAC found\";\n\tcase SSH_ERR_NO_COMPRESS_ALG_MATCH:\n\t\treturn \"no matching compression method found\";\n\tcase SSH_ERR_NO_KEX_ALG_MATCH:\n\t\treturn \"no matching key exchange method found\";\n\tcase SSH_ERR_NO_HOSTKEY_ALG_MATCH:\n\t\treturn \"no matching host key type found\";\n\tcase SSH_ERR_PROTOCOL_MISMATCH:\n\t\treturn \"protocol version mismatch\";\n\tcase SSH_ERR_NO_PROTOCOL_VERSION:\n\t\treturn \"could not read protocol version\";\n\tcase SSH_ERR_NO_HOSTKEY_LOADED:\n\t\treturn \"could not load host key\";\n\tcase SSH_ERR_NEED_REKEY:\n\t\treturn \"rekeying not supported by peer\";\n\tcase SSH_ERR_PASSPHRASE_TOO_SHORT:\n\t\treturn \"passphrase is too short (minimum five characters)\";\n\tcase SSH_ERR_FILE_CHANGED:\n\t\treturn \"file changed while reading\";\n\tcase SSH_ERR_KEY_UNKNOWN_CIPHER:\n\t\treturn \"key encrypted using unsupported cipher\";\n\tcase SSH_ERR_KEY_WRONG_PASSPHRASE:\n\t\treturn \"incorrect passphrase supplied to decrypt private key\";\n\tcase SSH_ERR_KEY_BAD_PERMISSIONS:\n\t\treturn \"bad permissions\";\n\tcase SSH_ERR_KEY_CERT_MISMATCH:\n\t\treturn \"certificate does not match key\";\n\tcase SSH_ERR_KEY_NOT_FOUND:\n\t\treturn \"key not found\";\n\tcase SSH_ERR_AGENT_NOT_PRESENT:\n\t\treturn \"agent not present\";\n\tcase SSH_ERR_AGENT_NO_IDENTITIES:\n\t\treturn \"agent contains no identities\";\n\tcase SSH_ERR_BUFFER_READ_ONLY:\n\t\treturn \"internal error: buffer is read-only\";\n\tcase SSH_ERR_KRL_BAD_MAGIC:\n\t\treturn \"KRL file has invalid magic number\";\n\tcase SSH_ERR_KEY_REVOKED:\n\t\treturn \"Key is revoked\";\n\tcase SSH_ERR_CONN_CLOSED:\n\t\treturn \"Connection closed\";\n\tcase SSH_ERR_CONN_TIMEOUT:\n\t\treturn \"Connection timed out\";\n\tcase SSH_ERR_CONN_CORRUPT:\n\t\treturn \"Connection corrupted\";\n\tcase SSH_ERR_PROTOCOL_ERROR:\n\t\treturn \"Protocol error\";\n\tcase SSH_ERR_KEY_LENGTH:\n\t\treturn \"Invalid key length\";\n\tcase SSH_ERR_NUMBER_TOO_LARGE:\n\t\treturn \"number is too large\";\n\tcase SSH_ERR_SIGN_ALG_UNSUPPORTED:\n\t\treturn \"signature algorithm not supported\";\n\tdefault:\n\t\treturn \"unknown error\";\n\t}\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include <string.h>\n#include <errno.h>\n\nconst char *\nssh_err(int n)\n{\n\tswitch (n) {\n\tcase SSH_ERR_SUCCESS:\n\t\treturn \"success\";\n\tcase SSH_ERR_INTERNAL_ERROR:\n\t\treturn \"unexpected internal error\";\n\tcase SSH_ERR_ALLOC_FAIL:\n\t\treturn \"memory allocation failed\";\n\tcase SSH_ERR_MESSAGE_INCOMPLETE:\n\t\treturn \"incomplete message\";\n\tcase SSH_ERR_INVALID_FORMAT:\n\t\treturn \"invalid format\";\n\tcase SSH_ERR_BIGNUM_IS_NEGATIVE:\n\t\treturn \"bignum is negative\";\n\tcase SSH_ERR_STRING_TOO_LARGE:\n\t\treturn \"string is too large\";\n\tcase SSH_ERR_BIGNUM_TOO_LARGE:\n\t\treturn \"bignum is too large\";\n\tcase SSH_ERR_ECPOINT_TOO_LARGE:\n\t\treturn \"elliptic curve point is too large\";\n\tcase SSH_ERR_NO_BUFFER_SPACE:\n\t\treturn \"insufficient buffer space\";\n\tcase SSH_ERR_INVALID_ARGUMENT:\n\t\treturn \"invalid argument\";\n\tcase SSH_ERR_KEY_BITS_MISMATCH:\n\t\treturn \"key bits do not match\";\n\tcase SSH_ERR_EC_CURVE_INVALID:\n\t\treturn \"invalid elliptic curve\";\n\tcase SSH_ERR_KEY_TYPE_MISMATCH:\n\t\treturn \"key type does not match\";\n\tcase SSH_ERR_KEY_TYPE_UNKNOWN:\n\t\treturn \"unknown or unsupported key type\";\n\tcase SSH_ERR_EC_CURVE_MISMATCH:\n\t\treturn \"elliptic curve does not match\";\n\tcase SSH_ERR_EXPECTED_CERT:\n\t\treturn \"plain key provided where certificate required\";\n\tcase SSH_ERR_KEY_LACKS_CERTBLOB:\n\t\treturn \"key lacks certificate data\";\n\tcase SSH_ERR_KEY_CERT_UNKNOWN_TYPE:\n\t\treturn \"unknown/unsupported certificate type\";\n\tcase SSH_ERR_KEY_CERT_INVALID_SIGN_KEY:\n\t\treturn \"invalid certificate signing key\";\n\tcase SSH_ERR_KEY_INVALID_EC_VALUE:\n\t\treturn \"invalid elliptic curve value\";\n\tcase SSH_ERR_SIGNATURE_INVALID:\n\t\treturn \"incorrect signature\";\n\tcase SSH_ERR_LIBCRYPTO_ERROR:\n\t\treturn \"error in libcrypto\";  /* XXX fetch and return */\n\tcase SSH_ERR_UNEXPECTED_TRAILING_DATA:\n\t\treturn \"unexpected bytes remain after decoding\";\n\tcase SSH_ERR_SYSTEM_ERROR:\n\t\treturn strerror(errno);\n\tcase SSH_ERR_KEY_CERT_INVALID:\n\t\treturn \"invalid certificate\";\n\tcase SSH_ERR_AGENT_COMMUNICATION:\n\t\treturn \"communication with agent failed\";\n\tcase SSH_ERR_AGENT_FAILURE:\n\t\treturn \"agent refused operation\";\n\tcase SSH_ERR_DH_GEX_OUT_OF_RANGE:\n\t\treturn \"DH GEX group out of range\";\n\tcase SSH_ERR_DISCONNECTED:\n\t\treturn \"disconnected\";\n\tcase SSH_ERR_MAC_INVALID:\n\t\treturn \"message authentication code incorrect\";\n\tcase SSH_ERR_NO_CIPHER_ALG_MATCH:\n\t\treturn \"no matching cipher found\";\n\tcase SSH_ERR_NO_MAC_ALG_MATCH:\n\t\treturn \"no matching MAC found\";\n\tcase SSH_ERR_NO_COMPRESS_ALG_MATCH:\n\t\treturn \"no matching compression method found\";\n\tcase SSH_ERR_NO_KEX_ALG_MATCH:\n\t\treturn \"no matching key exchange method found\";\n\tcase SSH_ERR_NO_HOSTKEY_ALG_MATCH:\n\t\treturn \"no matching host key type found\";\n\tcase SSH_ERR_PROTOCOL_MISMATCH:\n\t\treturn \"protocol version mismatch\";\n\tcase SSH_ERR_NO_PROTOCOL_VERSION:\n\t\treturn \"could not read protocol version\";\n\tcase SSH_ERR_NO_HOSTKEY_LOADED:\n\t\treturn \"could not load host key\";\n\tcase SSH_ERR_NEED_REKEY:\n\t\treturn \"rekeying not supported by peer\";\n\tcase SSH_ERR_PASSPHRASE_TOO_SHORT:\n\t\treturn \"passphrase is too short (minimum five characters)\";\n\tcase SSH_ERR_FILE_CHANGED:\n\t\treturn \"file changed while reading\";\n\tcase SSH_ERR_KEY_UNKNOWN_CIPHER:\n\t\treturn \"key encrypted using unsupported cipher\";\n\tcase SSH_ERR_KEY_WRONG_PASSPHRASE:\n\t\treturn \"incorrect passphrase supplied to decrypt private key\";\n\tcase SSH_ERR_KEY_BAD_PERMISSIONS:\n\t\treturn \"bad permissions\";\n\tcase SSH_ERR_KEY_CERT_MISMATCH:\n\t\treturn \"certificate does not match key\";\n\tcase SSH_ERR_KEY_NOT_FOUND:\n\t\treturn \"key not found\";\n\tcase SSH_ERR_AGENT_NOT_PRESENT:\n\t\treturn \"agent not present\";\n\tcase SSH_ERR_AGENT_NO_IDENTITIES:\n\t\treturn \"agent contains no identities\";\n\tcase SSH_ERR_BUFFER_READ_ONLY:\n\t\treturn \"internal error: buffer is read-only\";\n\tcase SSH_ERR_KRL_BAD_MAGIC:\n\t\treturn \"KRL file has invalid magic number\";\n\tcase SSH_ERR_KEY_REVOKED:\n\t\treturn \"Key is revoked\";\n\tcase SSH_ERR_CONN_CLOSED:\n\t\treturn \"Connection closed\";\n\tcase SSH_ERR_CONN_TIMEOUT:\n\t\treturn \"Connection timed out\";\n\tcase SSH_ERR_CONN_CORRUPT:\n\t\treturn \"Connection corrupted\";\n\tcase SSH_ERR_PROTOCOL_ERROR:\n\t\treturn \"Protocol error\";\n\tcase SSH_ERR_KEY_LENGTH:\n\t\treturn \"Invalid key length\";\n\tcase SSH_ERR_NUMBER_TOO_LARGE:\n\t\treturn \"number is too large\";\n\tcase SSH_ERR_SIGN_ALG_UNSUPPORTED:\n\t\treturn \"signature algorithm not supported\";\n\tdefault:\n\t\treturn \"unknown error\";\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_put_u8",
          "args": [
            "b",
            "'\\n'"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_u8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "335-345",
          "snippet": "int\nsshbuf_put_u8(struct sshbuf *buf, u_char val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 1, &p)) < 0)\n\t\treturn r;\n\tp[0] = val;\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_u8(struct sshbuf *buf, u_char val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 1, &p)) < 0)\n\t\treturn r;\n\tp[0] = val;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gss_release_buffer",
          "args": [
            "&lmin",
            "&msg"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_put",
          "args": [
            "b",
            "msg.value",
            "msg.length"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_putf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "254-264",
          "snippet": "int\nsshbuf_putf(struct sshbuf *buf, const char *fmt, ...)\n{\n\tva_list ap;\n\tint r;\n\n\tva_start(ap, fmt);\n\tr = sshbuf_putfv(buf, fmt, ap);\n\tva_end(ap);\n\treturn r;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_putf(struct sshbuf *buf, const char *fmt, ...)\n{\n\tva_list ap;\n\tint r;\n\n\tva_start(ap, fmt);\n\tr = sshbuf_putfv(buf, fmt, ap);\n\tva_end(ap);\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gss_display_status",
          "args": [
            "&lmin",
            "ctxt->minor",
            "GSS_C_MECH_CODE",
            "ctxt->oid",
            "&ctx",
            "&msg"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_release_buffer",
          "args": [
            "&lmin",
            "&msg"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_display_status",
          "args": [
            "&lmin",
            "ctxt->major",
            "GSS_C_GSS_CODE",
            "ctxt->oid",
            "&ctx",
            "&msg"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"%s: sshbuf_new failed\"",
            "__func__"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "match_test_missing_fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/servconf.c",
          "lines": "988-993",
          "snippet": "static void\nmatch_test_missing_fatal(const char *criteria, const char *attrib)\n{\n\tfatal(\"'Match %s' in configuration but '%s' not in connection \"\n\t    \"test specification.\", criteria, attrib);\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"myproposal.h\"",
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"canohost.h\"",
            "#include \"groupaccess.h\"",
            "#include \"channels.h\"",
            "#include \"match.h\"",
            "#include \"mac.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"pathnames.h\"",
            "#include \"compat.h\"",
            "#include \"servconf.h\"",
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"log.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <util.h>",
            "#include <errno.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <netdb.h>",
            "#include <ctype.h>",
            "#include <net/route.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <sys/sysctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"myproposal.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"canohost.h\"\n#include \"groupaccess.h\"\n#include \"channels.h\"\n#include \"match.h\"\n#include \"mac.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"pathnames.h\"\n#include \"compat.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"log.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <util.h>\n#include <errno.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <netdb.h>\n#include <ctype.h>\n#include <net/route.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <sys/sysctl.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic void\nmatch_test_missing_fatal(const char *criteria, const char *attrib)\n{\n\tfatal(\"'Match %s' in configuration but '%s' not in connection \"\n\t    \"test specification.\", criteria, attrib);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_new",
          "args": [],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "68-85",
          "snippet": "struct sshbuf *\nsshbuf_new(void)\n{\n\tstruct sshbuf *ret;\n\n\tif ((ret = calloc(sizeof(*ret), 1)) == NULL)\n\t\treturn NULL;\n\tret->alloc = SSHBUF_SIZE_INIT;\n\tret->max_size = SSHBUF_SIZE_MAX;\n\tret->readonly = 0;\n\tret->refcount = 1;\n\tret->parent = NULL;\n\tif ((ret->cd = ret->d = calloc(1, ret->alloc)) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct sshbuf *\nsshbuf_new(void)\n{\n\tstruct sshbuf *ret;\n\n\tif ((ret = calloc(sizeof(*ret), 1)) == NULL)\n\t\treturn NULL;\n\tret->alloc = SSHBUF_SIZE_INIT;\n\tret->max_size = SSHBUF_SIZE_MAX;\n\tret->readonly = 0;\n\tret->refcount = 1;\n\tret->parent = NULL;\n\tif ((ret->cd = ret->d = calloc(1, ret->alloc)) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *\nssh_gssapi_last_error(Gssctxt *ctxt, OM_uint32 *major_status,\n    OM_uint32 *minor_status)\n{\n\tOM_uint32 lmin;\n\tgss_buffer_desc msg = GSS_C_EMPTY_BUFFER;\n\tOM_uint32 ctx;\n\tstruct sshbuf *b;\n\tchar *ret;\n\tint r;\n\n\tif ((b = sshbuf_new()) == NULL)\n\t\tfatal(\"%s: sshbuf_new failed\", __func__);\n\n\tif (major_status != NULL)\n\t\t*major_status = ctxt->major;\n\tif (minor_status != NULL)\n\t\t*minor_status = ctxt->minor;\n\n\tctx = 0;\n\t/* The GSSAPI error */\n\tdo {\n\t\tgss_display_status(&lmin, ctxt->major,\n\t\t    GSS_C_GSS_CODE, ctxt->oid, &ctx, &msg);\n\n\t\tif ((r = sshbuf_put(b, msg.value, msg.length)) != 0 ||\n\t\t    (r = sshbuf_put_u8(b, '\\n')) != 0)\n\t\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r));\n\n\t\tgss_release_buffer(&lmin, &msg);\n\t} while (ctx != 0);\n\n\t/* The mechanism specific error */\n\tdo {\n\t\tgss_display_status(&lmin, ctxt->minor,\n\t\t    GSS_C_MECH_CODE, ctxt->oid, &ctx, &msg);\n\n\t\tif ((r = sshbuf_put(b, msg.value, msg.length)) != 0 ||\n\t\t    (r = sshbuf_put_u8(b, '\\n')) != 0)\n\t\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r));\n\n\t\tgss_release_buffer(&lmin, &msg);\n\t} while (ctx != 0);\n\n\tif ((r = sshbuf_put_u8(b, '\\n')) != 0)\n\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r));\n\tret = xstrdup((const char *)sshbuf_ptr(b));\n\tsshbuf_free(b);\n\treturn (ret);\n}"
  },
  {
    "function_name": "ssh_gssapi_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
    "lines": "96-104",
    "snippet": "void\nssh_gssapi_error(Gssctxt *ctxt)\n{\n\tchar *s;\n\n\ts = ssh_gssapi_last_error(ctxt, NULL, NULL);\n\tdebug(\"%s\", s);\n\tfree(s);\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"ssh2.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "s"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "freeze",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/smult_curve25519_ref.c",
          "lines": "50-60",
          "snippet": "static void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [
            "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;"
          ],
          "called_functions": [],
          "contextual_snippet": "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;\n\nstatic void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"%s\"",
            "s"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_gssapi_last_error",
          "args": [
            "ctxt",
            "NULL",
            "NULL"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_last_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
          "lines": "106-155",
          "snippet": "char *\nssh_gssapi_last_error(Gssctxt *ctxt, OM_uint32 *major_status,\n    OM_uint32 *minor_status)\n{\n\tOM_uint32 lmin;\n\tgss_buffer_desc msg = GSS_C_EMPTY_BUFFER;\n\tOM_uint32 ctx;\n\tstruct sshbuf *b;\n\tchar *ret;\n\tint r;\n\n\tif ((b = sshbuf_new()) == NULL)\n\t\tfatal(\"%s: sshbuf_new failed\", __func__);\n\n\tif (major_status != NULL)\n\t\t*major_status = ctxt->major;\n\tif (minor_status != NULL)\n\t\t*minor_status = ctxt->minor;\n\n\tctx = 0;\n\t/* The GSSAPI error */\n\tdo {\n\t\tgss_display_status(&lmin, ctxt->major,\n\t\t    GSS_C_GSS_CODE, ctxt->oid, &ctx, &msg);\n\n\t\tif ((r = sshbuf_put(b, msg.value, msg.length)) != 0 ||\n\t\t    (r = sshbuf_put_u8(b, '\\n')) != 0)\n\t\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r));\n\n\t\tgss_release_buffer(&lmin, &msg);\n\t} while (ctx != 0);\n\n\t/* The mechanism specific error */\n\tdo {\n\t\tgss_display_status(&lmin, ctxt->minor,\n\t\t    GSS_C_MECH_CODE, ctxt->oid, &ctx, &msg);\n\n\t\tif ((r = sshbuf_put(b, msg.value, msg.length)) != 0 ||\n\t\t    (r = sshbuf_put_u8(b, '\\n')) != 0)\n\t\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r));\n\n\t\tgss_release_buffer(&lmin, &msg);\n\t} while (ctx != 0);\n\n\tif ((r = sshbuf_put_u8(b, '\\n')) != 0)\n\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r));\n\tret = xstrdup((const char *)sshbuf_ptr(b));\n\tsshbuf_free(b);\n\treturn (ret);\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"ssh2.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *\nssh_gssapi_last_error(Gssctxt *ctxt, OM_uint32 *major_status,\n    OM_uint32 *minor_status)\n{\n\tOM_uint32 lmin;\n\tgss_buffer_desc msg = GSS_C_EMPTY_BUFFER;\n\tOM_uint32 ctx;\n\tstruct sshbuf *b;\n\tchar *ret;\n\tint r;\n\n\tif ((b = sshbuf_new()) == NULL)\n\t\tfatal(\"%s: sshbuf_new failed\", __func__);\n\n\tif (major_status != NULL)\n\t\t*major_status = ctxt->major;\n\tif (minor_status != NULL)\n\t\t*minor_status = ctxt->minor;\n\n\tctx = 0;\n\t/* The GSSAPI error */\n\tdo {\n\t\tgss_display_status(&lmin, ctxt->major,\n\t\t    GSS_C_GSS_CODE, ctxt->oid, &ctx, &msg);\n\n\t\tif ((r = sshbuf_put(b, msg.value, msg.length)) != 0 ||\n\t\t    (r = sshbuf_put_u8(b, '\\n')) != 0)\n\t\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r));\n\n\t\tgss_release_buffer(&lmin, &msg);\n\t} while (ctx != 0);\n\n\t/* The mechanism specific error */\n\tdo {\n\t\tgss_display_status(&lmin, ctxt->minor,\n\t\t    GSS_C_MECH_CODE, ctxt->oid, &ctx, &msg);\n\n\t\tif ((r = sshbuf_put(b, msg.value, msg.length)) != 0 ||\n\t\t    (r = sshbuf_put_u8(b, '\\n')) != 0)\n\t\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r));\n\n\t\tgss_release_buffer(&lmin, &msg);\n\t} while (ctx != 0);\n\n\tif ((r = sshbuf_put_u8(b, '\\n')) != 0)\n\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r));\n\tret = xstrdup((const char *)sshbuf_ptr(b));\n\tsshbuf_free(b);\n\treturn (ret);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_error(Gssctxt *ctxt)\n{\n\tchar *s;\n\n\ts = ssh_gssapi_last_error(ctxt, NULL, NULL);\n\tdebug(\"%s\", s);\n\tfree(s);\n}"
  },
  {
    "function_name": "ssh_gssapi_set_oid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
    "lines": "89-93",
    "snippet": "void\nssh_gssapi_set_oid(Gssctxt *ctx, gss_OID oid)\n{\n\tssh_gssapi_set_oid_data(ctx, oid->elements, oid->length);\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"ssh2.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_gssapi_set_oid_data",
          "args": [
            "ctx",
            "oid->elements",
            "oid->length"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_set_oid_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
          "lines": "75-86",
          "snippet": "void\nssh_gssapi_set_oid_data(Gssctxt *ctx, void *data, size_t len)\n{\n\tif (ctx->oid != GSS_C_NO_OID) {\n\t\tfree(ctx->oid->elements);\n\t\tfree(ctx->oid);\n\t}\n\tctx->oid = xcalloc(1, sizeof(gss_OID_desc));\n\tctx->oid->length = len;\n\tctx->oid->elements = xmalloc(len);\n\tmemcpy(ctx->oid->elements, data, len);\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"ssh2.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_set_oid_data(Gssctxt *ctx, void *data, size_t len)\n{\n\tif (ctx->oid != GSS_C_NO_OID) {\n\t\tfree(ctx->oid->elements);\n\t\tfree(ctx->oid);\n\t}\n\tctx->oid = xcalloc(1, sizeof(gss_OID_desc));\n\tctx->oid->length = len;\n\tctx->oid->elements = xmalloc(len);\n\tmemcpy(ctx->oid->elements, data, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_set_oid(Gssctxt *ctx, gss_OID oid)\n{\n\tssh_gssapi_set_oid_data(ctx, oid->elements, oid->length);\n}"
  },
  {
    "function_name": "ssh_gssapi_set_oid_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
    "lines": "75-86",
    "snippet": "void\nssh_gssapi_set_oid_data(Gssctxt *ctx, void *data, size_t len)\n{\n\tif (ctx->oid != GSS_C_NO_OID) {\n\t\tfree(ctx->oid->elements);\n\t\tfree(ctx->oid);\n\t}\n\tctx->oid = xcalloc(1, sizeof(gss_OID_desc));\n\tctx->oid->length = len;\n\tctx->oid->elements = xmalloc(len);\n\tmemcpy(ctx->oid->elements, data, len);\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"ssh2.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ctx->oid->elements",
            "data",
            "len"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "len"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "xmalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "39-50",
          "snippet": "void *\nxmalloc(size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0)\n\t\tfatal(\"xmalloc: zero size\");\n\tptr = malloc(size);\n\tif (ptr == NULL)\n\t\tfatal(\"xmalloc: out of memory (allocating %zu bytes)\", size);\n\treturn ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxmalloc(size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0)\n\t\tfatal(\"xmalloc: zero size\");\n\tptr = malloc(size);\n\tif (ptr == NULL)\n\t\tfatal(\"xmalloc: out of memory (allocating %zu bytes)\", size);\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcalloc",
          "args": [
            "1",
            "sizeof(gss_OID_desc)"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "xcalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "52-66",
          "snippet": "void *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "ctx->oid"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "freeze",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/smult_curve25519_ref.c",
          "lines": "50-60",
          "snippet": "static void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [
            "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;"
          ],
          "called_functions": [],
          "contextual_snippet": "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;\n\nstatic void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_set_oid_data(Gssctxt *ctx, void *data, size_t len)\n{\n\tif (ctx->oid != GSS_C_NO_OID) {\n\t\tfree(ctx->oid->elements);\n\t\tfree(ctx->oid);\n\t}\n\tctx->oid = xcalloc(1, sizeof(gss_OID_desc));\n\tctx->oid->length = len;\n\tctx->oid->elements = xmalloc(len);\n\tmemcpy(ctx->oid->elements, data, len);\n}"
  },
  {
    "function_name": "ssh_gssapi_check_oid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
    "lines": "66-72",
    "snippet": "int\nssh_gssapi_check_oid(Gssctxt *ctx, void *data, size_t len)\n{\n\treturn (ctx != NULL && ctx->oid != GSS_C_NO_OID &&\n\t    ctx->oid->length == len &&\n\t    memcmp(ctx->oid->elements, data, len) == 0);\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"ssh2.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "ctx->oid->elements",
            "data",
            "len"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_gssapi_check_oid(Gssctxt *ctx, void *data, size_t len)\n{\n\treturn (ctx != NULL && ctx->oid != GSS_C_NO_OID &&\n\t    ctx->oid->length == len &&\n\t    memcmp(ctx->oid->elements, data, len) == 0);\n}"
  },
  {
    "function_name": "ssh_gssapi_get_buffer_desc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
    "lines": "51-63",
    "snippet": "int\nssh_gssapi_get_buffer_desc(struct sshbuf *b, gss_buffer_desc *g)\n{\n\tint r;\n\tu_char *p;\n\tsize_t len;\n\n\tif ((r = sshbuf_get_string(b, &p, &len)) != 0)\n\t\treturn r;\n\tg->value = p;\n\tg->length = len;\n\treturn 0;\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"ssh2.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <unistd.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sshbuf_get_string",
          "args": [
            "b",
            "&p",
            "&len"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_get_string_direct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "123-147",
          "snippet": "int\nsshbuf_get_string_direct(struct sshbuf *buf, const u_char **valp, size_t *lenp)\n{\n\tsize_t len;\n\tconst u_char *p;\n\tint r;\n\n\tif (valp != NULL)\n\t\t*valp = NULL;\n\tif (lenp != NULL)\n\t\t*lenp = 0;\n\tif ((r = sshbuf_peek_string_direct(buf, &p, &len)) < 0)\n\t\treturn r;\n\tif (valp != NULL)\n\t\t*valp = p;\n\tif (lenp != NULL)\n\t\t*lenp = len;\n\tif (sshbuf_consume(buf, len + 4) != 0) {\n\t\t/* Shouldn't happen */\n\t\tSSHBUF_DBG((\"SSH_ERR_INTERNAL_ERROR\"));\n\t\tSSHBUF_ABORT();\n\t\treturn SSH_ERR_INTERNAL_ERROR;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_get_string_direct(struct sshbuf *buf, const u_char **valp, size_t *lenp)\n{\n\tsize_t len;\n\tconst u_char *p;\n\tint r;\n\n\tif (valp != NULL)\n\t\t*valp = NULL;\n\tif (lenp != NULL)\n\t\t*lenp = 0;\n\tif ((r = sshbuf_peek_string_direct(buf, &p, &len)) < 0)\n\t\treturn r;\n\tif (valp != NULL)\n\t\t*valp = p;\n\tif (lenp != NULL)\n\t\t*lenp = len;\n\tif (sshbuf_consume(buf, len + 4) != 0) {\n\t\t/* Shouldn't happen */\n\t\tSSHBUF_DBG((\"SSH_ERR_INTERNAL_ERROR\"));\n\t\tSSHBUF_ABORT();\n\t\treturn SSH_ERR_INTERNAL_ERROR;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_gssapi_get_buffer_desc(struct sshbuf *b, gss_buffer_desc *g)\n{\n\tint r;\n\tu_char *p;\n\tsize_t len;\n\n\tif ((r = sshbuf_get_string(b, &p, &len)) != 0)\n\t\treturn r;\n\tg->value = p;\n\tg->length = len;\n\treturn 0;\n}"
  }
]