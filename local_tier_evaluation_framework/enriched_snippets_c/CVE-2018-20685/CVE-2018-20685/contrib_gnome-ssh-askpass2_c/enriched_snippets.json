[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/contrib/gnome-ssh-askpass2.c",
    "lines": "206-225",
    "snippet": "int\nmain(int argc, char **argv)\n{\n\tchar *message;\n\tint result;\n\n\tgtk_init(&argc, &argv);\n\n\tif (argc > 1) {\n\t\tmessage = g_strjoinv(\" \", argv + 1);\n\t} else {\n\t\tmessage = g_strdup(\"Enter your OpenSSH passphrase:\");\n\t}\n\n\tsetvbuf(stdout, 0, _IONBF, 0);\n\tresult = passphrase_dialog(message);\n\tg_free(message);\n\n\treturn (result);\n}",
    "includes": [
      "#include <gdk/gdkx.h>",
      "#include <gtk/gtk.h>",
      "#include <X11/Xlib.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "message"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "passphrase_dialog",
          "args": [
            "message"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "passphrase_dialog",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/contrib/gnome-ssh-askpass2.c",
          "lines": "84-204",
          "snippet": "static int\npassphrase_dialog(char *message)\n{\n\tconst char *failed;\n\tchar *passphrase, *local;\n\tint result, grab_tries, grab_server, grab_pointer;\n\tGtkWidget *parent_window, *dialog, *entry;\n\tGdkGrabStatus status;\n\n\tgrab_server = (getenv(\"GNOME_SSH_ASKPASS_GRAB_SERVER\") != NULL);\n\tgrab_pointer = (getenv(\"GNOME_SSH_ASKPASS_GRAB_POINTER\") != NULL);\n\tgrab_tries = 0;\n\n\t/* Create an invisible parent window so that GtkDialog doesn't\n\t * complain.  */\n\tparent_window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n\n\tdialog = gtk_message_dialog_new(GTK_WINDOW(parent_window), 0,\n\t\t\t\t\tGTK_MESSAGE_QUESTION,\n\t\t\t\t\tGTK_BUTTONS_OK_CANCEL,\n\t\t\t\t\t\"%s\",\n\t\t\t\t\tmessage);\n\n\tentry = gtk_entry_new();\n\tgtk_box_pack_start(\n\t    GTK_BOX(gtk_dialog_get_content_area(GTK_DIALOG(dialog))), entry,\n\t    FALSE, FALSE, 0);\n\tgtk_entry_set_visibility(GTK_ENTRY(entry), FALSE);\n\tgtk_widget_grab_focus(entry);\n\tgtk_widget_show(entry);\n\n\tgtk_window_set_title(GTK_WINDOW(dialog), \"OpenSSH\");\n\tgtk_window_set_position (GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);\n\tgtk_window_set_keep_above(GTK_WINDOW(dialog), TRUE);\n\n\t/* Make <enter> close dialog */\n\tgtk_dialog_set_default_response(GTK_DIALOG(dialog), GTK_RESPONSE_OK);\n\tg_signal_connect(G_OBJECT(entry), \"activate\",\n\t\t\t G_CALLBACK(ok_dialog), dialog);\n\n\tgtk_window_set_keep_above(GTK_WINDOW(dialog), TRUE);\n\n\t/* Grab focus */\n\tgtk_widget_show_now(dialog);\n\tif (grab_pointer) {\n\t\tfor(;;) {\n\t\t\tstatus = gdk_pointer_grab(\n\t\t\t    (gtk_widget_get_window(GTK_WIDGET(dialog))), TRUE,\n\t\t\t    0, NULL, NULL, GDK_CURRENT_TIME);\n\t\t\tif (status == GDK_GRAB_SUCCESS)\n\t\t\t\tbreak;\n\t\t\tusleep(GRAB_WAIT * 1000);\n\t\t\tif (++grab_tries > GRAB_TRIES) {\n\t\t\t\tfailed = \"mouse\";\n\t\t\t\tgoto nograb;\n\t\t\t}\n\t\t}\n\t}\n\tfor(;;) {\n\t\tstatus = gdk_keyboard_grab(\n\t\t    gtk_widget_get_window(GTK_WIDGET(dialog)), FALSE,\n\t\t    GDK_CURRENT_TIME);\n\t\tif (status == GDK_GRAB_SUCCESS)\n\t\t\tbreak;\n\t\tusleep(GRAB_WAIT * 1000);\n\t\tif (++grab_tries > GRAB_TRIES) {\n\t\t\tfailed = \"keyboard\";\n\t\t\tgoto nograbkb;\n\t\t}\n\t}\n\tif (grab_server) {\n\t\tgdk_x11_grab_server();\n\t}\n\n\tresult = gtk_dialog_run(GTK_DIALOG(dialog));\n\n\t/* Ungrab */\n\tif (grab_server)\n\t\tXUngrabServer(gdk_x11_get_default_xdisplay());\n\tif (grab_pointer)\n\t\tgdk_pointer_ungrab(GDK_CURRENT_TIME);\n\tgdk_keyboard_ungrab(GDK_CURRENT_TIME);\n\tgdk_flush();\n\n\t/* Report passphrase if user selected OK */\n\tpassphrase = g_strdup(gtk_entry_get_text(GTK_ENTRY(entry)));\n\tif (result == GTK_RESPONSE_OK) {\n\t\tlocal = g_locale_from_utf8(passphrase, strlen(passphrase),\n\t\t\t\t\t   NULL, NULL, NULL);\n\t\tif (local != NULL) {\n\t\t\tputs(local);\n\t\t\tmemset(local, '\\0', strlen(local));\n\t\t\tg_free(local);\n\t\t} else {\n\t\t\tputs(passphrase);\n\t\t}\n\t}\n\t\t\n\t/* Zero passphrase in memory */\n\tmemset(passphrase, '\\b', strlen(passphrase));\n\tgtk_entry_set_text(GTK_ENTRY(entry), passphrase);\n\tmemset(passphrase, '\\0', strlen(passphrase));\n\tg_free(passphrase);\n\t\t\t\n\tgtk_widget_destroy(dialog);\n\treturn (result == GTK_RESPONSE_OK ? 0 : -1);\n\n\t/* At least one grab failed - ungrab what we got, and report\n\t   the failure to the user.  Note that XGrabServer() cannot\n\t   fail.  */\n nograbkb:\n\tgdk_pointer_ungrab(GDK_CURRENT_TIME);\n nograb:\n\tif (grab_server)\n\t\tXUngrabServer(gdk_x11_get_default_xdisplay());\n\tgtk_widget_destroy(dialog);\n\t\n\treport_failed_grab(parent_window, failed);\n\n\treturn (-1);\n}",
          "includes": [
            "#include <gdk/gdkx.h>",
            "#include <gtk/gtk.h>",
            "#include <X11/Xlib.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>"
          ],
          "macros_used": [
            "#define GRAB_WAIT\t250 /* milliseconds */",
            "#define GRAB_TRIES\t16"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gdk/gdkx.h>\n#include <gtk/gtk.h>\n#include <X11/Xlib.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n\n#define GRAB_WAIT\t250 /* milliseconds */\n#define GRAB_TRIES\t16\n\nstatic int\npassphrase_dialog(char *message)\n{\n\tconst char *failed;\n\tchar *passphrase, *local;\n\tint result, grab_tries, grab_server, grab_pointer;\n\tGtkWidget *parent_window, *dialog, *entry;\n\tGdkGrabStatus status;\n\n\tgrab_server = (getenv(\"GNOME_SSH_ASKPASS_GRAB_SERVER\") != NULL);\n\tgrab_pointer = (getenv(\"GNOME_SSH_ASKPASS_GRAB_POINTER\") != NULL);\n\tgrab_tries = 0;\n\n\t/* Create an invisible parent window so that GtkDialog doesn't\n\t * complain.  */\n\tparent_window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n\n\tdialog = gtk_message_dialog_new(GTK_WINDOW(parent_window), 0,\n\t\t\t\t\tGTK_MESSAGE_QUESTION,\n\t\t\t\t\tGTK_BUTTONS_OK_CANCEL,\n\t\t\t\t\t\"%s\",\n\t\t\t\t\tmessage);\n\n\tentry = gtk_entry_new();\n\tgtk_box_pack_start(\n\t    GTK_BOX(gtk_dialog_get_content_area(GTK_DIALOG(dialog))), entry,\n\t    FALSE, FALSE, 0);\n\tgtk_entry_set_visibility(GTK_ENTRY(entry), FALSE);\n\tgtk_widget_grab_focus(entry);\n\tgtk_widget_show(entry);\n\n\tgtk_window_set_title(GTK_WINDOW(dialog), \"OpenSSH\");\n\tgtk_window_set_position (GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);\n\tgtk_window_set_keep_above(GTK_WINDOW(dialog), TRUE);\n\n\t/* Make <enter> close dialog */\n\tgtk_dialog_set_default_response(GTK_DIALOG(dialog), GTK_RESPONSE_OK);\n\tg_signal_connect(G_OBJECT(entry), \"activate\",\n\t\t\t G_CALLBACK(ok_dialog), dialog);\n\n\tgtk_window_set_keep_above(GTK_WINDOW(dialog), TRUE);\n\n\t/* Grab focus */\n\tgtk_widget_show_now(dialog);\n\tif (grab_pointer) {\n\t\tfor(;;) {\n\t\t\tstatus = gdk_pointer_grab(\n\t\t\t    (gtk_widget_get_window(GTK_WIDGET(dialog))), TRUE,\n\t\t\t    0, NULL, NULL, GDK_CURRENT_TIME);\n\t\t\tif (status == GDK_GRAB_SUCCESS)\n\t\t\t\tbreak;\n\t\t\tusleep(GRAB_WAIT * 1000);\n\t\t\tif (++grab_tries > GRAB_TRIES) {\n\t\t\t\tfailed = \"mouse\";\n\t\t\t\tgoto nograb;\n\t\t\t}\n\t\t}\n\t}\n\tfor(;;) {\n\t\tstatus = gdk_keyboard_grab(\n\t\t    gtk_widget_get_window(GTK_WIDGET(dialog)), FALSE,\n\t\t    GDK_CURRENT_TIME);\n\t\tif (status == GDK_GRAB_SUCCESS)\n\t\t\tbreak;\n\t\tusleep(GRAB_WAIT * 1000);\n\t\tif (++grab_tries > GRAB_TRIES) {\n\t\t\tfailed = \"keyboard\";\n\t\t\tgoto nograbkb;\n\t\t}\n\t}\n\tif (grab_server) {\n\t\tgdk_x11_grab_server();\n\t}\n\n\tresult = gtk_dialog_run(GTK_DIALOG(dialog));\n\n\t/* Ungrab */\n\tif (grab_server)\n\t\tXUngrabServer(gdk_x11_get_default_xdisplay());\n\tif (grab_pointer)\n\t\tgdk_pointer_ungrab(GDK_CURRENT_TIME);\n\tgdk_keyboard_ungrab(GDK_CURRENT_TIME);\n\tgdk_flush();\n\n\t/* Report passphrase if user selected OK */\n\tpassphrase = g_strdup(gtk_entry_get_text(GTK_ENTRY(entry)));\n\tif (result == GTK_RESPONSE_OK) {\n\t\tlocal = g_locale_from_utf8(passphrase, strlen(passphrase),\n\t\t\t\t\t   NULL, NULL, NULL);\n\t\tif (local != NULL) {\n\t\t\tputs(local);\n\t\t\tmemset(local, '\\0', strlen(local));\n\t\t\tg_free(local);\n\t\t} else {\n\t\t\tputs(passphrase);\n\t\t}\n\t}\n\t\t\n\t/* Zero passphrase in memory */\n\tmemset(passphrase, '\\b', strlen(passphrase));\n\tgtk_entry_set_text(GTK_ENTRY(entry), passphrase);\n\tmemset(passphrase, '\\0', strlen(passphrase));\n\tg_free(passphrase);\n\t\t\t\n\tgtk_widget_destroy(dialog);\n\treturn (result == GTK_RESPONSE_OK ? 0 : -1);\n\n\t/* At least one grab failed - ungrab what we got, and report\n\t   the failure to the user.  Note that XGrabServer() cannot\n\t   fail.  */\n nograbkb:\n\tgdk_pointer_ungrab(GDK_CURRENT_TIME);\n nograb:\n\tif (grab_server)\n\t\tXUngrabServer(gdk_x11_get_default_xdisplay());\n\tgtk_widget_destroy(dialog);\n\t\n\treport_failed_grab(parent_window, failed);\n\n\treturn (-1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "setvbuf",
          "args": [
            "stdout",
            "0",
            "_IONBF",
            "0"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"Enter your OpenSSH passphrase:\""
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strjoinv",
          "args": [
            "\" \"",
            "argv + 1"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_init",
          "args": [
            "&argc",
            "&argv"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <gdk/gdkx.h>\n#include <gtk/gtk.h>\n#include <X11/Xlib.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n\nint\nmain(int argc, char **argv)\n{\n\tchar *message;\n\tint result;\n\n\tgtk_init(&argc, &argv);\n\n\tif (argc > 1) {\n\t\tmessage = g_strjoinv(\" \", argv + 1);\n\t} else {\n\t\tmessage = g_strdup(\"Enter your OpenSSH passphrase:\");\n\t}\n\n\tsetvbuf(stdout, 0, _IONBF, 0);\n\tresult = passphrase_dialog(message);\n\tg_free(message);\n\n\treturn (result);\n}"
  },
  {
    "function_name": "passphrase_dialog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/contrib/gnome-ssh-askpass2.c",
    "lines": "84-204",
    "snippet": "static int\npassphrase_dialog(char *message)\n{\n\tconst char *failed;\n\tchar *passphrase, *local;\n\tint result, grab_tries, grab_server, grab_pointer;\n\tGtkWidget *parent_window, *dialog, *entry;\n\tGdkGrabStatus status;\n\n\tgrab_server = (getenv(\"GNOME_SSH_ASKPASS_GRAB_SERVER\") != NULL);\n\tgrab_pointer = (getenv(\"GNOME_SSH_ASKPASS_GRAB_POINTER\") != NULL);\n\tgrab_tries = 0;\n\n\t/* Create an invisible parent window so that GtkDialog doesn't\n\t * complain.  */\n\tparent_window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n\n\tdialog = gtk_message_dialog_new(GTK_WINDOW(parent_window), 0,\n\t\t\t\t\tGTK_MESSAGE_QUESTION,\n\t\t\t\t\tGTK_BUTTONS_OK_CANCEL,\n\t\t\t\t\t\"%s\",\n\t\t\t\t\tmessage);\n\n\tentry = gtk_entry_new();\n\tgtk_box_pack_start(\n\t    GTK_BOX(gtk_dialog_get_content_area(GTK_DIALOG(dialog))), entry,\n\t    FALSE, FALSE, 0);\n\tgtk_entry_set_visibility(GTK_ENTRY(entry), FALSE);\n\tgtk_widget_grab_focus(entry);\n\tgtk_widget_show(entry);\n\n\tgtk_window_set_title(GTK_WINDOW(dialog), \"OpenSSH\");\n\tgtk_window_set_position (GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);\n\tgtk_window_set_keep_above(GTK_WINDOW(dialog), TRUE);\n\n\t/* Make <enter> close dialog */\n\tgtk_dialog_set_default_response(GTK_DIALOG(dialog), GTK_RESPONSE_OK);\n\tg_signal_connect(G_OBJECT(entry), \"activate\",\n\t\t\t G_CALLBACK(ok_dialog), dialog);\n\n\tgtk_window_set_keep_above(GTK_WINDOW(dialog), TRUE);\n\n\t/* Grab focus */\n\tgtk_widget_show_now(dialog);\n\tif (grab_pointer) {\n\t\tfor(;;) {\n\t\t\tstatus = gdk_pointer_grab(\n\t\t\t    (gtk_widget_get_window(GTK_WIDGET(dialog))), TRUE,\n\t\t\t    0, NULL, NULL, GDK_CURRENT_TIME);\n\t\t\tif (status == GDK_GRAB_SUCCESS)\n\t\t\t\tbreak;\n\t\t\tusleep(GRAB_WAIT * 1000);\n\t\t\tif (++grab_tries > GRAB_TRIES) {\n\t\t\t\tfailed = \"mouse\";\n\t\t\t\tgoto nograb;\n\t\t\t}\n\t\t}\n\t}\n\tfor(;;) {\n\t\tstatus = gdk_keyboard_grab(\n\t\t    gtk_widget_get_window(GTK_WIDGET(dialog)), FALSE,\n\t\t    GDK_CURRENT_TIME);\n\t\tif (status == GDK_GRAB_SUCCESS)\n\t\t\tbreak;\n\t\tusleep(GRAB_WAIT * 1000);\n\t\tif (++grab_tries > GRAB_TRIES) {\n\t\t\tfailed = \"keyboard\";\n\t\t\tgoto nograbkb;\n\t\t}\n\t}\n\tif (grab_server) {\n\t\tgdk_x11_grab_server();\n\t}\n\n\tresult = gtk_dialog_run(GTK_DIALOG(dialog));\n\n\t/* Ungrab */\n\tif (grab_server)\n\t\tXUngrabServer(gdk_x11_get_default_xdisplay());\n\tif (grab_pointer)\n\t\tgdk_pointer_ungrab(GDK_CURRENT_TIME);\n\tgdk_keyboard_ungrab(GDK_CURRENT_TIME);\n\tgdk_flush();\n\n\t/* Report passphrase if user selected OK */\n\tpassphrase = g_strdup(gtk_entry_get_text(GTK_ENTRY(entry)));\n\tif (result == GTK_RESPONSE_OK) {\n\t\tlocal = g_locale_from_utf8(passphrase, strlen(passphrase),\n\t\t\t\t\t   NULL, NULL, NULL);\n\t\tif (local != NULL) {\n\t\t\tputs(local);\n\t\t\tmemset(local, '\\0', strlen(local));\n\t\t\tg_free(local);\n\t\t} else {\n\t\t\tputs(passphrase);\n\t\t}\n\t}\n\t\t\n\t/* Zero passphrase in memory */\n\tmemset(passphrase, '\\b', strlen(passphrase));\n\tgtk_entry_set_text(GTK_ENTRY(entry), passphrase);\n\tmemset(passphrase, '\\0', strlen(passphrase));\n\tg_free(passphrase);\n\t\t\t\n\tgtk_widget_destroy(dialog);\n\treturn (result == GTK_RESPONSE_OK ? 0 : -1);\n\n\t/* At least one grab failed - ungrab what we got, and report\n\t   the failure to the user.  Note that XGrabServer() cannot\n\t   fail.  */\n nograbkb:\n\tgdk_pointer_ungrab(GDK_CURRENT_TIME);\n nograb:\n\tif (grab_server)\n\t\tXUngrabServer(gdk_x11_get_default_xdisplay());\n\tgtk_widget_destroy(dialog);\n\t\n\treport_failed_grab(parent_window, failed);\n\n\treturn (-1);\n}",
    "includes": [
      "#include <gdk/gdkx.h>",
      "#include <gtk/gtk.h>",
      "#include <X11/Xlib.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>"
    ],
    "macros_used": [
      "#define GRAB_WAIT\t250 /* milliseconds */",
      "#define GRAB_TRIES\t16"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "report_failed_grab",
          "args": [
            "parent_window",
            "failed"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "report_failed_grab",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/contrib/gnome-ssh-askpass2.c",
          "lines": "59-75",
          "snippet": "static void\nreport_failed_grab (GtkWidget *parent_window, const char *what)\n{\n\tGtkWidget *err;\n\n\terr = gtk_message_dialog_new(GTK_WINDOW(parent_window), 0,\n\t\t\t\t     GTK_MESSAGE_ERROR,\n\t\t\t\t     GTK_BUTTONS_CLOSE,\n\t\t\t\t     \"Could not grab %s. \"\n\t\t\t\t     \"A malicious client may be eavesdropping \"\n\t\t\t\t     \"on your session.\", what);\n\tgtk_window_set_position(GTK_WINDOW(err), GTK_WIN_POS_CENTER);\n\n\tgtk_dialog_run(GTK_DIALOG(err));\n\n\tgtk_widget_destroy(err);\n}",
          "includes": [
            "#include <gdk/gdkx.h>",
            "#include <gtk/gtk.h>",
            "#include <X11/Xlib.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gdk/gdkx.h>\n#include <gtk/gtk.h>\n#include <X11/Xlib.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n\nstatic void\nreport_failed_grab (GtkWidget *parent_window, const char *what)\n{\n\tGtkWidget *err;\n\n\terr = gtk_message_dialog_new(GTK_WINDOW(parent_window), 0,\n\t\t\t\t     GTK_MESSAGE_ERROR,\n\t\t\t\t     GTK_BUTTONS_CLOSE,\n\t\t\t\t     \"Could not grab %s. \"\n\t\t\t\t     \"A malicious client may be eavesdropping \"\n\t\t\t\t     \"on your session.\", what);\n\tgtk_window_set_position(GTK_WINDOW(err), GTK_WIN_POS_CENTER);\n\n\tgtk_dialog_run(GTK_DIALOG(err));\n\n\tgtk_widget_destroy(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gtk_widget_destroy",
          "args": [
            "dialog"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XUngrabServer",
          "args": [
            "gdk_x11_get_default_xdisplay()"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gdk_x11_get_default_xdisplay",
          "args": [],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gdk_pointer_ungrab",
          "args": [
            "GDK_CURRENT_TIME"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_widget_destroy",
          "args": [
            "dialog"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "passphrase"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "passphrase",
            "'\\0'",
            "strlen(passphrase)"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "passphrase"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_entry_set_text",
          "args": [
            "GTK_ENTRY(entry)",
            "passphrase"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_ENTRY",
          "args": [
            "entry"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "passphrase",
            "'\\b'",
            "strlen(passphrase)"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "passphrase"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "puts",
          "args": [
            "passphrase"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "local"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "local",
            "'\\0'",
            "strlen(local)"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "local"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "puts",
          "args": [
            "local"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_locale_from_utf8",
          "args": [
            "passphrase",
            "strlen(passphrase)",
            "NULL",
            "NULL",
            "NULL"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "passphrase"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "gtk_entry_get_text(GTK_ENTRY(entry))"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_entry_get_text",
          "args": [
            "GTK_ENTRY(entry)"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_ENTRY",
          "args": [
            "entry"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gdk_flush",
          "args": [],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gdk_keyboard_ungrab",
          "args": [
            "GDK_CURRENT_TIME"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gdk_pointer_ungrab",
          "args": [
            "GDK_CURRENT_TIME"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XUngrabServer",
          "args": [
            "gdk_x11_get_default_xdisplay()"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gdk_x11_get_default_xdisplay",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_dialog_run",
          "args": [
            "GTK_DIALOG(dialog)"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_DIALOG",
          "args": [
            "dialog"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gdk_x11_grab_server",
          "args": [],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "usleep",
          "args": [
            "GRAB_WAIT * 1000"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "usleep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
          "lines": "171-178",
          "snippet": "int usleep(unsigned int useconds)\n{\n\tstruct timespec ts;\n\n\tts.tv_sec = useconds / 1000000;\n\tts.tv_nsec = (useconds % 1000000) * 1000;\n\treturn nanosleep(&ts, NULL);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "# include <sys/time.h>",
            "# include <sys/select.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint usleep(unsigned int useconds)\n{\n\tstruct timespec ts;\n\n\tts.tv_sec = useconds / 1000000;\n\tts.tv_nsec = (useconds % 1000000) * 1000;\n\treturn nanosleep(&ts, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gdk_keyboard_grab",
          "args": [
            "gtk_widget_get_window(GTK_WIDGET(dialog))",
            "FALSE",
            "GDK_CURRENT_TIME"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_widget_get_window",
          "args": [
            "GTK_WIDGET(dialog)"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_WIDGET",
          "args": [
            "dialog"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gdk_pointer_grab",
          "args": [
            "(gtk_widget_get_window(GTK_WIDGET(dialog)))",
            "TRUE",
            "0",
            "NULL",
            "NULL",
            "GDK_CURRENT_TIME"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_widget_get_window",
          "args": [
            "GTK_WIDGET(dialog)"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_WIDGET",
          "args": [
            "dialog"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_widget_show_now",
          "args": [
            "dialog"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_window_set_keep_above",
          "args": [
            "GTK_WINDOW(dialog)",
            "TRUE"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_WINDOW",
          "args": [
            "dialog"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_signal_connect",
          "args": [
            "G_OBJECT(entry)",
            "\"activate\"",
            "G_CALLBACK(ok_dialog)",
            "dialog"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_CALLBACK",
          "args": [
            "ok_dialog"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_OBJECT",
          "args": [
            "entry"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_dialog_set_default_response",
          "args": [
            "GTK_DIALOG(dialog)",
            "GTK_RESPONSE_OK"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_DIALOG",
          "args": [
            "dialog"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_window_set_keep_above",
          "args": [
            "GTK_WINDOW(dialog)",
            "TRUE"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_WINDOW",
          "args": [
            "dialog"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_window_set_position",
          "args": [
            "GTK_WINDOW(dialog)",
            "GTK_WIN_POS_CENTER"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_WINDOW",
          "args": [
            "dialog"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_window_set_title",
          "args": [
            "GTK_WINDOW(dialog)",
            "\"OpenSSH\""
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_WINDOW",
          "args": [
            "dialog"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_widget_show",
          "args": [
            "entry"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_widget_grab_focus",
          "args": [
            "entry"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_entry_set_visibility",
          "args": [
            "GTK_ENTRY(entry)",
            "FALSE"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_ENTRY",
          "args": [
            "entry"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_box_pack_start",
          "args": [
            "GTK_BOX(gtk_dialog_get_content_area(GTK_DIALOG(dialog)))",
            "entry",
            "FALSE",
            "FALSE",
            "0"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_BOX",
          "args": [
            "gtk_dialog_get_content_area(GTK_DIALOG(dialog))"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_dialog_get_content_area",
          "args": [
            "GTK_DIALOG(dialog)"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_DIALOG",
          "args": [
            "dialog"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_entry_new",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_message_dialog_new",
          "args": [
            "GTK_WINDOW(parent_window)",
            "0",
            "GTK_MESSAGE_QUESTION",
            "GTK_BUTTONS_OK_CANCEL",
            "\"%s\"",
            "message"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_WINDOW",
          "args": [
            "parent_window"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_window_new",
          "args": [
            "GTK_WINDOW_TOPLEVEL"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"GNOME_SSH_ASKPASS_GRAB_POINTER\""
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "pam_getenvlist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/auth-pam.c",
          "lines": "254-263",
          "snippet": "static char **\npam_getenvlist(pam_handle_t *pamh)\n{\n\t/*\n\t * XXX - If necessary, we can still support envrionment passing\n\t * for platforms without pam_getenvlist by searching for known\n\t * env vars (e.g. KRB5CCNAME) from the PAM environment.\n\t */\n\t return NULL;\n}",
          "includes": [
            "#include <pthread.h>",
            "#include \"monitor_wrap.h\"",
            "#include \"ssh-gss.h\"",
            "#include \"auth-options.h\"",
            "#include \"ssh2.h\"",
            "#include \"servconf.h\"",
            "#include \"misc.h\"",
            "#include \"packet.h\"",
            "#include \"msg.h\"",
            "#include \"log.h\"",
            "#include \"canohost.h\"",
            "#include \"auth-pam.h\"",
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"xmalloc.h\"",
            "#include <pam/pam_appl.h>",
            "#include <security/pam_appl.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include <errno.h>",
            "#include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <pthread.h>\n#include \"monitor_wrap.h\"\n#include \"ssh-gss.h\"\n#include \"auth-options.h\"\n#include \"ssh2.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"packet.h\"\n#include \"msg.h\"\n#include \"log.h\"\n#include \"canohost.h\"\n#include \"auth-pam.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"xmalloc.h\"\n#include <pam/pam_appl.h>\n#include <security/pam_appl.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <signal.h>\n#include <errno.h>\n#include <sys/wait.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char **\npam_getenvlist(pam_handle_t *pamh)\n{\n\t/*\n\t * XXX - If necessary, we can still support envrionment passing\n\t * for platforms without pam_getenvlist by searching for known\n\t * env vars (e.g. KRB5CCNAME) from the PAM environment.\n\t */\n\t return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <gdk/gdkx.h>\n#include <gtk/gtk.h>\n#include <X11/Xlib.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n\n#define GRAB_WAIT\t250 /* milliseconds */\n#define GRAB_TRIES\t16\n\nstatic int\npassphrase_dialog(char *message)\n{\n\tconst char *failed;\n\tchar *passphrase, *local;\n\tint result, grab_tries, grab_server, grab_pointer;\n\tGtkWidget *parent_window, *dialog, *entry;\n\tGdkGrabStatus status;\n\n\tgrab_server = (getenv(\"GNOME_SSH_ASKPASS_GRAB_SERVER\") != NULL);\n\tgrab_pointer = (getenv(\"GNOME_SSH_ASKPASS_GRAB_POINTER\") != NULL);\n\tgrab_tries = 0;\n\n\t/* Create an invisible parent window so that GtkDialog doesn't\n\t * complain.  */\n\tparent_window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n\n\tdialog = gtk_message_dialog_new(GTK_WINDOW(parent_window), 0,\n\t\t\t\t\tGTK_MESSAGE_QUESTION,\n\t\t\t\t\tGTK_BUTTONS_OK_CANCEL,\n\t\t\t\t\t\"%s\",\n\t\t\t\t\tmessage);\n\n\tentry = gtk_entry_new();\n\tgtk_box_pack_start(\n\t    GTK_BOX(gtk_dialog_get_content_area(GTK_DIALOG(dialog))), entry,\n\t    FALSE, FALSE, 0);\n\tgtk_entry_set_visibility(GTK_ENTRY(entry), FALSE);\n\tgtk_widget_grab_focus(entry);\n\tgtk_widget_show(entry);\n\n\tgtk_window_set_title(GTK_WINDOW(dialog), \"OpenSSH\");\n\tgtk_window_set_position (GTK_WINDOW(dialog), GTK_WIN_POS_CENTER);\n\tgtk_window_set_keep_above(GTK_WINDOW(dialog), TRUE);\n\n\t/* Make <enter> close dialog */\n\tgtk_dialog_set_default_response(GTK_DIALOG(dialog), GTK_RESPONSE_OK);\n\tg_signal_connect(G_OBJECT(entry), \"activate\",\n\t\t\t G_CALLBACK(ok_dialog), dialog);\n\n\tgtk_window_set_keep_above(GTK_WINDOW(dialog), TRUE);\n\n\t/* Grab focus */\n\tgtk_widget_show_now(dialog);\n\tif (grab_pointer) {\n\t\tfor(;;) {\n\t\t\tstatus = gdk_pointer_grab(\n\t\t\t    (gtk_widget_get_window(GTK_WIDGET(dialog))), TRUE,\n\t\t\t    0, NULL, NULL, GDK_CURRENT_TIME);\n\t\t\tif (status == GDK_GRAB_SUCCESS)\n\t\t\t\tbreak;\n\t\t\tusleep(GRAB_WAIT * 1000);\n\t\t\tif (++grab_tries > GRAB_TRIES) {\n\t\t\t\tfailed = \"mouse\";\n\t\t\t\tgoto nograb;\n\t\t\t}\n\t\t}\n\t}\n\tfor(;;) {\n\t\tstatus = gdk_keyboard_grab(\n\t\t    gtk_widget_get_window(GTK_WIDGET(dialog)), FALSE,\n\t\t    GDK_CURRENT_TIME);\n\t\tif (status == GDK_GRAB_SUCCESS)\n\t\t\tbreak;\n\t\tusleep(GRAB_WAIT * 1000);\n\t\tif (++grab_tries > GRAB_TRIES) {\n\t\t\tfailed = \"keyboard\";\n\t\t\tgoto nograbkb;\n\t\t}\n\t}\n\tif (grab_server) {\n\t\tgdk_x11_grab_server();\n\t}\n\n\tresult = gtk_dialog_run(GTK_DIALOG(dialog));\n\n\t/* Ungrab */\n\tif (grab_server)\n\t\tXUngrabServer(gdk_x11_get_default_xdisplay());\n\tif (grab_pointer)\n\t\tgdk_pointer_ungrab(GDK_CURRENT_TIME);\n\tgdk_keyboard_ungrab(GDK_CURRENT_TIME);\n\tgdk_flush();\n\n\t/* Report passphrase if user selected OK */\n\tpassphrase = g_strdup(gtk_entry_get_text(GTK_ENTRY(entry)));\n\tif (result == GTK_RESPONSE_OK) {\n\t\tlocal = g_locale_from_utf8(passphrase, strlen(passphrase),\n\t\t\t\t\t   NULL, NULL, NULL);\n\t\tif (local != NULL) {\n\t\t\tputs(local);\n\t\t\tmemset(local, '\\0', strlen(local));\n\t\t\tg_free(local);\n\t\t} else {\n\t\t\tputs(passphrase);\n\t\t}\n\t}\n\t\t\n\t/* Zero passphrase in memory */\n\tmemset(passphrase, '\\b', strlen(passphrase));\n\tgtk_entry_set_text(GTK_ENTRY(entry), passphrase);\n\tmemset(passphrase, '\\0', strlen(passphrase));\n\tg_free(passphrase);\n\t\t\t\n\tgtk_widget_destroy(dialog);\n\treturn (result == GTK_RESPONSE_OK ? 0 : -1);\n\n\t/* At least one grab failed - ungrab what we got, and report\n\t   the failure to the user.  Note that XGrabServer() cannot\n\t   fail.  */\n nograbkb:\n\tgdk_pointer_ungrab(GDK_CURRENT_TIME);\n nograb:\n\tif (grab_server)\n\t\tXUngrabServer(gdk_x11_get_default_xdisplay());\n\tgtk_widget_destroy(dialog);\n\t\n\treport_failed_grab(parent_window, failed);\n\n\treturn (-1);\n}"
  },
  {
    "function_name": "ok_dialog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/contrib/gnome-ssh-askpass2.c",
    "lines": "77-82",
    "snippet": "static void\nok_dialog(GtkWidget *entry, gpointer dialog)\n{\n\tg_return_if_fail(GTK_IS_DIALOG(dialog));\n\tgtk_dialog_response(GTK_DIALOG(dialog), GTK_RESPONSE_OK);\n}",
    "includes": [
      "#include <gdk/gdkx.h>",
      "#include <gtk/gtk.h>",
      "#include <X11/Xlib.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gtk_dialog_response",
          "args": [
            "GTK_DIALOG(dialog)",
            "GTK_RESPONSE_OK"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_DIALOG",
          "args": [
            "dialog"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_return_if_fail",
          "args": [
            "GTK_IS_DIALOG(dialog)"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_IS_DIALOG",
          "args": [
            "dialog"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <gdk/gdkx.h>\n#include <gtk/gtk.h>\n#include <X11/Xlib.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n\nstatic void\nok_dialog(GtkWidget *entry, gpointer dialog)\n{\n\tg_return_if_fail(GTK_IS_DIALOG(dialog));\n\tgtk_dialog_response(GTK_DIALOG(dialog), GTK_RESPONSE_OK);\n}"
  },
  {
    "function_name": "report_failed_grab",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/contrib/gnome-ssh-askpass2.c",
    "lines": "59-75",
    "snippet": "static void\nreport_failed_grab (GtkWidget *parent_window, const char *what)\n{\n\tGtkWidget *err;\n\n\terr = gtk_message_dialog_new(GTK_WINDOW(parent_window), 0,\n\t\t\t\t     GTK_MESSAGE_ERROR,\n\t\t\t\t     GTK_BUTTONS_CLOSE,\n\t\t\t\t     \"Could not grab %s. \"\n\t\t\t\t     \"A malicious client may be eavesdropping \"\n\t\t\t\t     \"on your session.\", what);\n\tgtk_window_set_position(GTK_WINDOW(err), GTK_WIN_POS_CENTER);\n\n\tgtk_dialog_run(GTK_DIALOG(err));\n\n\tgtk_widget_destroy(err);\n}",
    "includes": [
      "#include <gdk/gdkx.h>",
      "#include <gtk/gtk.h>",
      "#include <X11/Xlib.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gtk_widget_destroy",
          "args": [
            "err"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_dialog_run",
          "args": [
            "GTK_DIALOG(err)"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_DIALOG",
          "args": [
            "err"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_window_set_position",
          "args": [
            "GTK_WINDOW(err)",
            "GTK_WIN_POS_CENTER"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_WINDOW",
          "args": [
            "err"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gtk_message_dialog_new",
          "args": [
            "GTK_WINDOW(parent_window)",
            "0",
            "GTK_MESSAGE_ERROR",
            "GTK_BUTTONS_CLOSE",
            "\"Could not grab %s. \"\n\t\t\t\t     \"A malicious client may be eavesdropping \"\n\t\t\t\t     \"on your session.\"",
            "what"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GTK_WINDOW",
          "args": [
            "parent_window"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <gdk/gdkx.h>\n#include <gtk/gtk.h>\n#include <X11/Xlib.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n\nstatic void\nreport_failed_grab (GtkWidget *parent_window, const char *what)\n{\n\tGtkWidget *err;\n\n\terr = gtk_message_dialog_new(GTK_WINDOW(parent_window), 0,\n\t\t\t\t     GTK_MESSAGE_ERROR,\n\t\t\t\t     GTK_BUTTONS_CLOSE,\n\t\t\t\t     \"Could not grab %s. \"\n\t\t\t\t     \"A malicious client may be eavesdropping \"\n\t\t\t\t     \"on your session.\", what);\n\tgtk_window_set_position(GTK_WINDOW(err), GTK_WIN_POS_CENTER);\n\n\tgtk_dialog_run(GTK_DIALOG(err));\n\n\tgtk_widget_destroy(err);\n}"
  }
]