[
  {
    "function_name": "wots_pkFromSig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_wots.c",
    "lines": "158-191",
    "snippet": "int wots_pkFromSig(unsigned char *pk, const unsigned char *sig, const unsigned char *msg, const wots_params *params, const unsigned char *pub_seed, uint32_t addr[8])\n{\n  int csum = 0;\n  uint32_t i = 0;\n  int *basew = calloc(params->len, sizeof(int));\n  if (basew == NULL)\n    return -1;\n\n  base_w(basew, params->len_1, msg, params);\n\n  for (i=0; i < params->len_1; i++) {\n    csum += params->w - 1 - basew[i];\n  }\n\n  csum = csum << (8 - ((params->len_2 * params->log_w) % 8));\n\n  int len_2_bytes = ((params->len_2 * params->log_w) + 7) / 8;\n\n  unsigned char csum_bytes[len_2_bytes];\n  to_byte(csum_bytes, csum, len_2_bytes);\n\n  int csum_basew[params->len_2];\n  base_w(csum_basew, params->len_2, csum_bytes, params);\n\n  for (i = 0; i < params->len_2; i++) {\n    basew[params->len_1 + i] = csum_basew[i];\n  }\n  for (i=0; i < params->len; i++) {\n    setChainADRS(addr, i);\n    gen_chain(pk+i*params->n, sig+i*params->n, basew[i], params->w-1-basew[i], params, pub_seed, addr);\n  }\n  free(basew);\n  return 0;\n}",
    "includes": [
      "#include \"xmss_hash_address.h\"",
      "#include \"xmss_wots.h\"",
      "#include \"xmss_hash.h\"",
      "#include \"xmss_commons.h\"",
      "#include <limits.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "basew"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "freeze",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/smult_curve25519_ref.c",
          "lines": "50-60",
          "snippet": "static void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [
            "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;"
          ],
          "called_functions": [],
          "contextual_snippet": "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;\n\nstatic void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gen_chain",
          "args": [
            "pk+i*params->n",
            "sig+i*params->n",
            "basew[i]",
            "params->w-1-basew[i]",
            "params",
            "pub_seed",
            "addr"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "gen_chain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_wots.c",
          "lines": "71-81",
          "snippet": "static void gen_chain(unsigned char *out, const unsigned char *in, unsigned int start, unsigned int steps, const wots_params *params, const unsigned char *pub_seed, uint32_t addr[8])\n{\n  uint32_t i, j;\n  for (j = 0; j < params->n; j++)\n    out[j] = in[j];\n\n  for (i = start; i < (start+steps) && i < params->w; i++) {\n    setHashADRS(addr, i);\n    hash_f(out, out, pub_seed, addr, params->n);\n  }\n}",
          "includes": [
            "#include \"xmss_hash_address.h\"",
            "#include \"xmss_wots.h\"",
            "#include \"xmss_hash.h\"",
            "#include \"xmss_commons.h\"",
            "#include <limits.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xmss_hash_address.h\"\n#include \"xmss_wots.h\"\n#include \"xmss_hash.h\"\n#include \"xmss_commons.h\"\n#include <limits.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nstatic void gen_chain(unsigned char *out, const unsigned char *in, unsigned int start, unsigned int steps, const wots_params *params, const unsigned char *pub_seed, uint32_t addr[8])\n{\n  uint32_t i, j;\n  for (j = 0; j < params->n; j++)\n    out[j] = in[j];\n\n  for (i = start; i < (start+steps) && i < params->w; i++) {\n    setHashADRS(addr, i);\n    hash_f(out, out, pub_seed, addr, params->n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setChainADRS",
          "args": [
            "addr",
            "i"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "setChainADRS",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_hash_address.c",
          "lines": "43-45",
          "snippet": "void setChainADRS(uint32_t adrs[8], uint32_t chain){\n  adrs[5] = chain;\n}",
          "includes": [
            "#include \"xmss_hash_address.h\"\t/* prototypes */",
            "#include <stdint.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xmss_hash_address.h\"\t/* prototypes */\n#include <stdint.h>\n#include \"includes.h\"\n\nvoid setChainADRS(uint32_t adrs[8], uint32_t chain){\n  adrs[5] = chain;\n}"
        }
      },
      {
        "call_info": {
          "callee": "base_w",
          "args": [
            "csum_basew",
            "params->len_2",
            "csum_bytes",
            "params"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "base_w",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_wots.c",
          "lines": "88-106",
          "snippet": "static void base_w(int *output, const int out_len, const unsigned char *input, const wots_params *params)\n{\n  int in = 0;\n  int out = 0;\n  uint32_t total = 0;\n  int bits = 0;\n  int consumed = 0;\n\n  for (consumed = 0; consumed < out_len; consumed++) {\n    if (bits == 0) {\n      total = input[in];\n      in++;\n      bits += 8;\n    }\n    bits -= params->log_w;\n    output[out] = (total >> bits) & (params->w - 1);\n    out++;\n  }\n}",
          "includes": [
            "#include \"xmss_hash_address.h\"",
            "#include \"xmss_wots.h\"",
            "#include \"xmss_hash.h\"",
            "#include \"xmss_commons.h\"",
            "#include <limits.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xmss_hash_address.h\"\n#include \"xmss_wots.h\"\n#include \"xmss_hash.h\"\n#include \"xmss_commons.h\"\n#include <limits.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nstatic void base_w(int *output, const int out_len, const unsigned char *input, const wots_params *params)\n{\n  int in = 0;\n  int out = 0;\n  uint32_t total = 0;\n  int bits = 0;\n  int consumed = 0;\n\n  for (consumed = 0; consumed < out_len; consumed++) {\n    if (bits == 0) {\n      total = input[in];\n      in++;\n      bits += 8;\n    }\n    bits -= params->log_w;\n    output[out] = (total >> bits) & (params->w - 1);\n    out++;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_byte",
          "args": [
            "csum_bytes",
            "csum",
            "len_2_bytes"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "to_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_commons.c",
          "lines": "19-26",
          "snippet": "void to_byte(unsigned char *out, unsigned long long in, uint32_t bytes)\n{\n  int32_t i;\n  for (i = bytes-1; i >= 0; i--) {\n    out[i] = in & 0xff;\n    in = in >> 8;\n  }\n}",
          "includes": [
            "#include <stdint.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include \"xmss_commons.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include \"xmss_commons.h\"\n#include \"includes.h\"\n\nvoid to_byte(unsigned char *out, unsigned long long in, uint32_t bytes)\n{\n  int32_t i;\n  for (i = bytes-1; i >= 0; i--) {\n    out[i] = in & 0xff;\n    in = in >> 8;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "calloc",
          "args": [
            "params->len",
            "sizeof(int)"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "xcalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "52-66",
          "snippet": "void *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xmss_hash_address.h\"\n#include \"xmss_wots.h\"\n#include \"xmss_hash.h\"\n#include \"xmss_commons.h\"\n#include <limits.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nint wots_pkFromSig(unsigned char *pk, const unsigned char *sig, const unsigned char *msg, const wots_params *params, const unsigned char *pub_seed, uint32_t addr[8])\n{\n  int csum = 0;\n  uint32_t i = 0;\n  int *basew = calloc(params->len, sizeof(int));\n  if (basew == NULL)\n    return -1;\n\n  base_w(basew, params->len_1, msg, params);\n\n  for (i=0; i < params->len_1; i++) {\n    csum += params->w - 1 - basew[i];\n  }\n\n  csum = csum << (8 - ((params->len_2 * params->log_w) % 8));\n\n  int len_2_bytes = ((params->len_2 * params->log_w) + 7) / 8;\n\n  unsigned char csum_bytes[len_2_bytes];\n  to_byte(csum_bytes, csum, len_2_bytes);\n\n  int csum_basew[params->len_2];\n  base_w(csum_basew, params->len_2, csum_bytes, params);\n\n  for (i = 0; i < params->len_2; i++) {\n    basew[params->len_1 + i] = csum_basew[i];\n  }\n  for (i=0; i < params->len; i++) {\n    setChainADRS(addr, i);\n    gen_chain(pk+i*params->n, sig+i*params->n, basew[i], params->w-1-basew[i], params, pub_seed, addr);\n  }\n  free(basew);\n  return 0;\n}"
  },
  {
    "function_name": "wots_sign",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_wots.c",
    "lines": "119-156",
    "snippet": "int wots_sign(unsigned char *sig, const unsigned char *msg, const unsigned char *sk, const wots_params *params, const unsigned char *pub_seed, uint32_t addr[8])\n{\n  //int basew[params->len];\n  int csum = 0;\n  uint32_t i = 0;\n  int *basew = calloc(params->len, sizeof(int));\n  if (basew == NULL)\n    return -1;\n\n  base_w(basew, params->len_1, msg, params);\n\n  for (i=0; i < params->len_1; i++) {\n    csum += params->w - 1 - basew[i];\n  }\n\n  csum = csum << (8 - ((params->len_2 * params->log_w) % 8));\n\n  int len_2_bytes = ((params->len_2 * params->log_w) + 7) / 8;\n\n  unsigned char csum_bytes[len_2_bytes];\n  to_byte(csum_bytes, csum, len_2_bytes);\n\n  int csum_basew[params->len_2];\n  base_w(csum_basew, params->len_2, csum_bytes, params);\n\n  for (i = 0; i < params->len_2; i++) {\n    basew[params->len_1 + i] = csum_basew[i];\n  }\n\n  expand_seed(sig, sk, params);\n\n  for (i = 0; i < params->len; i++) {\n    setChainADRS(addr, i);\n    gen_chain(sig+i*params->n, sig+i*params->n, 0, basew[i], params, pub_seed, addr);\n  }\n  free(basew);\n  return 0;\n}",
    "includes": [
      "#include \"xmss_hash_address.h\"",
      "#include \"xmss_wots.h\"",
      "#include \"xmss_hash.h\"",
      "#include \"xmss_commons.h\"",
      "#include <limits.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "basew"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "freeze",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/smult_curve25519_ref.c",
          "lines": "50-60",
          "snippet": "static void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [
            "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;"
          ],
          "called_functions": [],
          "contextual_snippet": "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;\n\nstatic void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gen_chain",
          "args": [
            "sig+i*params->n",
            "sig+i*params->n",
            "0",
            "basew[i]",
            "params",
            "pub_seed",
            "addr"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "gen_chain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_wots.c",
          "lines": "71-81",
          "snippet": "static void gen_chain(unsigned char *out, const unsigned char *in, unsigned int start, unsigned int steps, const wots_params *params, const unsigned char *pub_seed, uint32_t addr[8])\n{\n  uint32_t i, j;\n  for (j = 0; j < params->n; j++)\n    out[j] = in[j];\n\n  for (i = start; i < (start+steps) && i < params->w; i++) {\n    setHashADRS(addr, i);\n    hash_f(out, out, pub_seed, addr, params->n);\n  }\n}",
          "includes": [
            "#include \"xmss_hash_address.h\"",
            "#include \"xmss_wots.h\"",
            "#include \"xmss_hash.h\"",
            "#include \"xmss_commons.h\"",
            "#include <limits.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xmss_hash_address.h\"\n#include \"xmss_wots.h\"\n#include \"xmss_hash.h\"\n#include \"xmss_commons.h\"\n#include <limits.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nstatic void gen_chain(unsigned char *out, const unsigned char *in, unsigned int start, unsigned int steps, const wots_params *params, const unsigned char *pub_seed, uint32_t addr[8])\n{\n  uint32_t i, j;\n  for (j = 0; j < params->n; j++)\n    out[j] = in[j];\n\n  for (i = start; i < (start+steps) && i < params->w; i++) {\n    setHashADRS(addr, i);\n    hash_f(out, out, pub_seed, addr, params->n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setChainADRS",
          "args": [
            "addr",
            "i"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "setChainADRS",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_hash_address.c",
          "lines": "43-45",
          "snippet": "void setChainADRS(uint32_t adrs[8], uint32_t chain){\n  adrs[5] = chain;\n}",
          "includes": [
            "#include \"xmss_hash_address.h\"\t/* prototypes */",
            "#include <stdint.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xmss_hash_address.h\"\t/* prototypes */\n#include <stdint.h>\n#include \"includes.h\"\n\nvoid setChainADRS(uint32_t adrs[8], uint32_t chain){\n  adrs[5] = chain;\n}"
        }
      },
      {
        "call_info": {
          "callee": "expand_seed",
          "args": [
            "sig",
            "sk",
            "params"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "expand_seed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_wots.c",
          "lines": "54-62",
          "snippet": "static void expand_seed(unsigned char *outseeds, const unsigned char *inseed, const wots_params *params)\n{\n  uint32_t i = 0;\n  unsigned char ctr[32];\n  for(i = 0; i < params->len; i++){\n    to_byte(ctr, i, 32);\n    prf((outseeds + (i*params->n)), ctr, inseed, params->n);\n  }\n}",
          "includes": [
            "#include \"xmss_hash_address.h\"",
            "#include \"xmss_wots.h\"",
            "#include \"xmss_hash.h\"",
            "#include \"xmss_commons.h\"",
            "#include <limits.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xmss_hash_address.h\"\n#include \"xmss_wots.h\"\n#include \"xmss_hash.h\"\n#include \"xmss_commons.h\"\n#include <limits.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nstatic void expand_seed(unsigned char *outseeds, const unsigned char *inseed, const wots_params *params)\n{\n  uint32_t i = 0;\n  unsigned char ctr[32];\n  for(i = 0; i < params->len; i++){\n    to_byte(ctr, i, 32);\n    prf((outseeds + (i*params->n)), ctr, inseed, params->n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "base_w",
          "args": [
            "csum_basew",
            "params->len_2",
            "csum_bytes",
            "params"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "base_w",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_wots.c",
          "lines": "88-106",
          "snippet": "static void base_w(int *output, const int out_len, const unsigned char *input, const wots_params *params)\n{\n  int in = 0;\n  int out = 0;\n  uint32_t total = 0;\n  int bits = 0;\n  int consumed = 0;\n\n  for (consumed = 0; consumed < out_len; consumed++) {\n    if (bits == 0) {\n      total = input[in];\n      in++;\n      bits += 8;\n    }\n    bits -= params->log_w;\n    output[out] = (total >> bits) & (params->w - 1);\n    out++;\n  }\n}",
          "includes": [
            "#include \"xmss_hash_address.h\"",
            "#include \"xmss_wots.h\"",
            "#include \"xmss_hash.h\"",
            "#include \"xmss_commons.h\"",
            "#include <limits.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xmss_hash_address.h\"\n#include \"xmss_wots.h\"\n#include \"xmss_hash.h\"\n#include \"xmss_commons.h\"\n#include <limits.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nstatic void base_w(int *output, const int out_len, const unsigned char *input, const wots_params *params)\n{\n  int in = 0;\n  int out = 0;\n  uint32_t total = 0;\n  int bits = 0;\n  int consumed = 0;\n\n  for (consumed = 0; consumed < out_len; consumed++) {\n    if (bits == 0) {\n      total = input[in];\n      in++;\n      bits += 8;\n    }\n    bits -= params->log_w;\n    output[out] = (total >> bits) & (params->w - 1);\n    out++;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_byte",
          "args": [
            "csum_bytes",
            "csum",
            "len_2_bytes"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "to_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_commons.c",
          "lines": "19-26",
          "snippet": "void to_byte(unsigned char *out, unsigned long long in, uint32_t bytes)\n{\n  int32_t i;\n  for (i = bytes-1; i >= 0; i--) {\n    out[i] = in & 0xff;\n    in = in >> 8;\n  }\n}",
          "includes": [
            "#include <stdint.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include \"xmss_commons.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include \"xmss_commons.h\"\n#include \"includes.h\"\n\nvoid to_byte(unsigned char *out, unsigned long long in, uint32_t bytes)\n{\n  int32_t i;\n  for (i = bytes-1; i >= 0; i--) {\n    out[i] = in & 0xff;\n    in = in >> 8;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "calloc",
          "args": [
            "params->len",
            "sizeof(int)"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "xcalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "52-66",
          "snippet": "void *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xmss_hash_address.h\"\n#include \"xmss_wots.h\"\n#include \"xmss_hash.h\"\n#include \"xmss_commons.h\"\n#include <limits.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nint wots_sign(unsigned char *sig, const unsigned char *msg, const unsigned char *sk, const wots_params *params, const unsigned char *pub_seed, uint32_t addr[8])\n{\n  //int basew[params->len];\n  int csum = 0;\n  uint32_t i = 0;\n  int *basew = calloc(params->len, sizeof(int));\n  if (basew == NULL)\n    return -1;\n\n  base_w(basew, params->len_1, msg, params);\n\n  for (i=0; i < params->len_1; i++) {\n    csum += params->w - 1 - basew[i];\n  }\n\n  csum = csum << (8 - ((params->len_2 * params->log_w) % 8));\n\n  int len_2_bytes = ((params->len_2 * params->log_w) + 7) / 8;\n\n  unsigned char csum_bytes[len_2_bytes];\n  to_byte(csum_bytes, csum, len_2_bytes);\n\n  int csum_basew[params->len_2];\n  base_w(csum_basew, params->len_2, csum_bytes, params);\n\n  for (i = 0; i < params->len_2; i++) {\n    basew[params->len_1 + i] = csum_basew[i];\n  }\n\n  expand_seed(sig, sk, params);\n\n  for (i = 0; i < params->len; i++) {\n    setChainADRS(addr, i);\n    gen_chain(sig+i*params->n, sig+i*params->n, 0, basew[i], params, pub_seed, addr);\n  }\n  free(basew);\n  return 0;\n}"
  },
  {
    "function_name": "wots_pkgen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_wots.c",
    "lines": "108-116",
    "snippet": "void wots_pkgen(unsigned char *pk, const unsigned char *sk, const wots_params *params, const unsigned char *pub_seed, uint32_t addr[8])\n{\n  uint32_t i;\n  expand_seed(pk, sk, params);\n  for (i=0; i < params->len; i++) {\n    setChainADRS(addr, i);\n    gen_chain(pk+i*params->n, pk+i*params->n, 0, params->w-1, params, pub_seed, addr);\n  }\n}",
    "includes": [
      "#include \"xmss_hash_address.h\"",
      "#include \"xmss_wots.h\"",
      "#include \"xmss_hash.h\"",
      "#include \"xmss_commons.h\"",
      "#include <limits.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gen_chain",
          "args": [
            "pk+i*params->n",
            "pk+i*params->n",
            "0",
            "params->w-1",
            "params",
            "pub_seed",
            "addr"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "gen_chain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_wots.c",
          "lines": "71-81",
          "snippet": "static void gen_chain(unsigned char *out, const unsigned char *in, unsigned int start, unsigned int steps, const wots_params *params, const unsigned char *pub_seed, uint32_t addr[8])\n{\n  uint32_t i, j;\n  for (j = 0; j < params->n; j++)\n    out[j] = in[j];\n\n  for (i = start; i < (start+steps) && i < params->w; i++) {\n    setHashADRS(addr, i);\n    hash_f(out, out, pub_seed, addr, params->n);\n  }\n}",
          "includes": [
            "#include \"xmss_hash_address.h\"",
            "#include \"xmss_wots.h\"",
            "#include \"xmss_hash.h\"",
            "#include \"xmss_commons.h\"",
            "#include <limits.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xmss_hash_address.h\"\n#include \"xmss_wots.h\"\n#include \"xmss_hash.h\"\n#include \"xmss_commons.h\"\n#include <limits.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nstatic void gen_chain(unsigned char *out, const unsigned char *in, unsigned int start, unsigned int steps, const wots_params *params, const unsigned char *pub_seed, uint32_t addr[8])\n{\n  uint32_t i, j;\n  for (j = 0; j < params->n; j++)\n    out[j] = in[j];\n\n  for (i = start; i < (start+steps) && i < params->w; i++) {\n    setHashADRS(addr, i);\n    hash_f(out, out, pub_seed, addr, params->n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setChainADRS",
          "args": [
            "addr",
            "i"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "setChainADRS",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_hash_address.c",
          "lines": "43-45",
          "snippet": "void setChainADRS(uint32_t adrs[8], uint32_t chain){\n  adrs[5] = chain;\n}",
          "includes": [
            "#include \"xmss_hash_address.h\"\t/* prototypes */",
            "#include <stdint.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xmss_hash_address.h\"\t/* prototypes */\n#include <stdint.h>\n#include \"includes.h\"\n\nvoid setChainADRS(uint32_t adrs[8], uint32_t chain){\n  adrs[5] = chain;\n}"
        }
      },
      {
        "call_info": {
          "callee": "expand_seed",
          "args": [
            "pk",
            "sk",
            "params"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "expand_seed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_wots.c",
          "lines": "54-62",
          "snippet": "static void expand_seed(unsigned char *outseeds, const unsigned char *inseed, const wots_params *params)\n{\n  uint32_t i = 0;\n  unsigned char ctr[32];\n  for(i = 0; i < params->len; i++){\n    to_byte(ctr, i, 32);\n    prf((outseeds + (i*params->n)), ctr, inseed, params->n);\n  }\n}",
          "includes": [
            "#include \"xmss_hash_address.h\"",
            "#include \"xmss_wots.h\"",
            "#include \"xmss_hash.h\"",
            "#include \"xmss_commons.h\"",
            "#include <limits.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xmss_hash_address.h\"\n#include \"xmss_wots.h\"\n#include \"xmss_hash.h\"\n#include \"xmss_commons.h\"\n#include <limits.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nstatic void expand_seed(unsigned char *outseeds, const unsigned char *inseed, const wots_params *params)\n{\n  uint32_t i = 0;\n  unsigned char ctr[32];\n  for(i = 0; i < params->len; i++){\n    to_byte(ctr, i, 32);\n    prf((outseeds + (i*params->n)), ctr, inseed, params->n);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xmss_hash_address.h\"\n#include \"xmss_wots.h\"\n#include \"xmss_hash.h\"\n#include \"xmss_commons.h\"\n#include <limits.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nvoid wots_pkgen(unsigned char *pk, const unsigned char *sk, const wots_params *params, const unsigned char *pub_seed, uint32_t addr[8])\n{\n  uint32_t i;\n  expand_seed(pk, sk, params);\n  for (i=0; i < params->len; i++) {\n    setChainADRS(addr, i);\n    gen_chain(pk+i*params->n, pk+i*params->n, 0, params->w-1, params, pub_seed, addr);\n  }\n}"
  },
  {
    "function_name": "base_w",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_wots.c",
    "lines": "88-106",
    "snippet": "static void base_w(int *output, const int out_len, const unsigned char *input, const wots_params *params)\n{\n  int in = 0;\n  int out = 0;\n  uint32_t total = 0;\n  int bits = 0;\n  int consumed = 0;\n\n  for (consumed = 0; consumed < out_len; consumed++) {\n    if (bits == 0) {\n      total = input[in];\n      in++;\n      bits += 8;\n    }\n    bits -= params->log_w;\n    output[out] = (total >> bits) & (params->w - 1);\n    out++;\n  }\n}",
    "includes": [
      "#include \"xmss_hash_address.h\"",
      "#include \"xmss_wots.h\"",
      "#include \"xmss_hash.h\"",
      "#include \"xmss_commons.h\"",
      "#include <limits.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"xmss_hash_address.h\"\n#include \"xmss_wots.h\"\n#include \"xmss_hash.h\"\n#include \"xmss_commons.h\"\n#include <limits.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nstatic void base_w(int *output, const int out_len, const unsigned char *input, const wots_params *params)\n{\n  int in = 0;\n  int out = 0;\n  uint32_t total = 0;\n  int bits = 0;\n  int consumed = 0;\n\n  for (consumed = 0; consumed < out_len; consumed++) {\n    if (bits == 0) {\n      total = input[in];\n      in++;\n      bits += 8;\n    }\n    bits -= params->log_w;\n    output[out] = (total >> bits) & (params->w - 1);\n    out++;\n  }\n}"
  },
  {
    "function_name": "gen_chain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_wots.c",
    "lines": "71-81",
    "snippet": "static void gen_chain(unsigned char *out, const unsigned char *in, unsigned int start, unsigned int steps, const wots_params *params, const unsigned char *pub_seed, uint32_t addr[8])\n{\n  uint32_t i, j;\n  for (j = 0; j < params->n; j++)\n    out[j] = in[j];\n\n  for (i = start; i < (start+steps) && i < params->w; i++) {\n    setHashADRS(addr, i);\n    hash_f(out, out, pub_seed, addr, params->n);\n  }\n}",
    "includes": [
      "#include \"xmss_hash_address.h\"",
      "#include \"xmss_wots.h\"",
      "#include \"xmss_hash.h\"",
      "#include \"xmss_commons.h\"",
      "#include <limits.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_f",
          "args": [
            "out",
            "out",
            "pub_seed",
            "addr",
            "params->n"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "hash_f",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_hash.c",
          "lines": "119-139",
          "snippet": "int hash_f(unsigned char *out, const unsigned char *in, const unsigned char *pub_seed, uint32_t addr[8], const unsigned int n)\n{\n  unsigned char buf[n];\n  unsigned char key[n];\n  unsigned char bitmask[n];\n  unsigned char byte_addr[32];\n  unsigned int i;\n\n  setKeyAndMask(addr, 0);  \n  addr_to_byte(byte_addr, addr);  \n  prf(key, byte_addr, pub_seed, n);\n  \n  setKeyAndMask(addr, 1);\n  addr_to_byte(byte_addr, addr);\n  prf(bitmask, byte_addr, pub_seed, n);\n  \n  for (i = 0; i < n; i++) {\n    buf[i] = in[i] ^ bitmask[i];\n  }\n  return core_hash_SHA2(out, 0, key, n, buf, n, n);\n}",
          "includes": [
            "#include <openssl/evp.h>",
            "#include <openssl/hmac.h>",
            "#include <openssl/sha.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stddef.h>",
            "#include \"xmss_hash.h\"",
            "#include \"xmss_commons.h\"",
            "#include \"xmss_hash_address.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/evp.h>\n#include <openssl/hmac.h>\n#include <openssl/sha.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stddef.h>\n#include \"xmss_hash.h\"\n#include \"xmss_commons.h\"\n#include \"xmss_hash_address.h\"\n#include \"includes.h\"\n\nint hash_f(unsigned char *out, const unsigned char *in, const unsigned char *pub_seed, uint32_t addr[8], const unsigned int n)\n{\n  unsigned char buf[n];\n  unsigned char key[n];\n  unsigned char bitmask[n];\n  unsigned char byte_addr[32];\n  unsigned int i;\n\n  setKeyAndMask(addr, 0);  \n  addr_to_byte(byte_addr, addr);  \n  prf(key, byte_addr, pub_seed, n);\n  \n  setKeyAndMask(addr, 1);\n  addr_to_byte(byte_addr, addr);\n  prf(bitmask, byte_addr, pub_seed, n);\n  \n  for (i = 0; i < n; i++) {\n    buf[i] = in[i] ^ bitmask[i];\n  }\n  return core_hash_SHA2(out, 0, key, n, buf, n, n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "setHashADRS",
          "args": [
            "addr",
            "i"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "setHashADRS",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_hash_address.c",
          "lines": "47-49",
          "snippet": "void setHashADRS(uint32_t adrs[8], uint32_t hash){\n  adrs[6] = hash;\n}",
          "includes": [
            "#include \"xmss_hash_address.h\"\t/* prototypes */",
            "#include <stdint.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xmss_hash_address.h\"\t/* prototypes */\n#include <stdint.h>\n#include \"includes.h\"\n\nvoid setHashADRS(uint32_t adrs[8], uint32_t hash){\n  adrs[6] = hash;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xmss_hash_address.h\"\n#include \"xmss_wots.h\"\n#include \"xmss_hash.h\"\n#include \"xmss_commons.h\"\n#include <limits.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nstatic void gen_chain(unsigned char *out, const unsigned char *in, unsigned int start, unsigned int steps, const wots_params *params, const unsigned char *pub_seed, uint32_t addr[8])\n{\n  uint32_t i, j;\n  for (j = 0; j < params->n; j++)\n    out[j] = in[j];\n\n  for (i = start; i < (start+steps) && i < params->w; i++) {\n    setHashADRS(addr, i);\n    hash_f(out, out, pub_seed, addr, params->n);\n  }\n}"
  },
  {
    "function_name": "expand_seed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_wots.c",
    "lines": "54-62",
    "snippet": "static void expand_seed(unsigned char *outseeds, const unsigned char *inseed, const wots_params *params)\n{\n  uint32_t i = 0;\n  unsigned char ctr[32];\n  for(i = 0; i < params->len; i++){\n    to_byte(ctr, i, 32);\n    prf((outseeds + (i*params->n)), ctr, inseed, params->n);\n  }\n}",
    "includes": [
      "#include \"xmss_hash_address.h\"",
      "#include \"xmss_wots.h\"",
      "#include \"xmss_hash.h\"",
      "#include \"xmss_commons.h\"",
      "#include <limits.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "prf",
          "args": [
            "(outseeds + (i*params->n))",
            "ctr",
            "inseed",
            "params->n"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "prf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_hash.c",
          "lines": "74-77",
          "snippet": "int prf(unsigned char *out, const unsigned char *in, const unsigned char *key, unsigned int keylen)\n{ \n  return core_hash_SHA2(out, 3, key, keylen, in, 32, keylen);\n}",
          "includes": [
            "#include <openssl/evp.h>",
            "#include <openssl/hmac.h>",
            "#include <openssl/sha.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stddef.h>",
            "#include \"xmss_hash.h\"",
            "#include \"xmss_commons.h\"",
            "#include \"xmss_hash_address.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/evp.h>\n#include <openssl/hmac.h>\n#include <openssl/sha.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stddef.h>\n#include \"xmss_hash.h\"\n#include \"xmss_commons.h\"\n#include \"xmss_hash_address.h\"\n#include \"includes.h\"\n\nint prf(unsigned char *out, const unsigned char *in, const unsigned char *key, unsigned int keylen)\n{ \n  return core_hash_SHA2(out, 3, key, keylen, in, 32, keylen);\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_byte",
          "args": [
            "ctr",
            "i",
            "32"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "to_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_commons.c",
          "lines": "19-26",
          "snippet": "void to_byte(unsigned char *out, unsigned long long in, uint32_t bytes)\n{\n  int32_t i;\n  for (i = bytes-1; i >= 0; i--) {\n    out[i] = in & 0xff;\n    in = in >> 8;\n  }\n}",
          "includes": [
            "#include <stdint.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include \"xmss_commons.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include \"xmss_commons.h\"\n#include \"includes.h\"\n\nvoid to_byte(unsigned char *out, unsigned long long in, uint32_t bytes)\n{\n  int32_t i;\n  for (i = bytes-1; i >= 0; i--) {\n    out[i] = in & 0xff;\n    in = in >> 8;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xmss_hash_address.h\"\n#include \"xmss_wots.h\"\n#include \"xmss_hash.h\"\n#include \"xmss_commons.h\"\n#include <limits.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nstatic void expand_seed(unsigned char *outseeds, const unsigned char *inseed, const wots_params *params)\n{\n  uint32_t i = 0;\n  unsigned char ctr[32];\n  for(i = 0; i < params->len; i++){\n    to_byte(ctr, i, 32);\n    prf((outseeds + (i*params->n)), ctr, inseed, params->n);\n  }\n}"
  },
  {
    "function_name": "wots_set_params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_wots.c",
    "lines": "37-47",
    "snippet": "void\nwots_set_params(wots_params *params, int n, int w)\n{\n  params->n = n;\n  params->w = w;\n  params->log_w = wots_log2(params->w);\n  params->len_1 = (CHAR_BIT * n) / params->log_w;\n  params->len_2 = (wots_log2(params->len_1 * (w - 1)) / params->log_w) + 1;\n  params->len = params->len_1 + params->len_2;\n  params->keysize = params->len * params->n;\n}",
    "includes": [
      "#include \"xmss_hash_address.h\"",
      "#include \"xmss_wots.h\"",
      "#include \"xmss_hash.h\"",
      "#include \"xmss_commons.h\"",
      "#include <limits.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wots_log2",
          "args": [
            "params->len_1 * (w - 1)"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "wots_log2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_wots.c",
          "lines": "24-35",
          "snippet": "static inline int\nwots_log2(uint32_t v)\n{\n  int      b;\n\n  for (b = sizeof (v) * CHAR_BIT - 1; b >= 0; b--) {\n    if ((1U << b) & v) {\n      return b;\n    }\n  }\n  return 0;\n}",
          "includes": [
            "#include \"xmss_hash_address.h\"",
            "#include \"xmss_wots.h\"",
            "#include \"xmss_hash.h\"",
            "#include \"xmss_commons.h\"",
            "#include <limits.h>",
            "#include <stdint.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xmss_hash_address.h\"\n#include \"xmss_wots.h\"\n#include \"xmss_hash.h\"\n#include \"xmss_commons.h\"\n#include <limits.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nstatic inline int\nwots_log2(uint32_t v)\n{\n  int      b;\n\n  for (b = sizeof (v) * CHAR_BIT - 1; b >= 0; b--) {\n    if ((1U << b) & v) {\n      return b;\n    }\n  }\n  return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"xmss_hash_address.h\"\n#include \"xmss_wots.h\"\n#include \"xmss_hash.h\"\n#include \"xmss_commons.h\"\n#include <limits.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nvoid\nwots_set_params(wots_params *params, int n, int w)\n{\n  params->n = n;\n  params->w = w;\n  params->log_w = wots_log2(params->w);\n  params->len_1 = (CHAR_BIT * n) / params->log_w;\n  params->len_2 = (wots_log2(params->len_1 * (w - 1)) / params->log_w) + 1;\n  params->len = params->len_1 + params->len_2;\n  params->keysize = params->len * params->n;\n}"
  },
  {
    "function_name": "wots_log2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmss_wots.c",
    "lines": "24-35",
    "snippet": "static inline int\nwots_log2(uint32_t v)\n{\n  int      b;\n\n  for (b = sizeof (v) * CHAR_BIT - 1; b >= 0; b--) {\n    if ((1U << b) & v) {\n      return b;\n    }\n  }\n  return 0;\n}",
    "includes": [
      "#include \"xmss_hash_address.h\"",
      "#include \"xmss_wots.h\"",
      "#include \"xmss_hash.h\"",
      "#include \"xmss_commons.h\"",
      "#include <limits.h>",
      "#include <stdint.h>",
      "#include <stdlib.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"xmss_hash_address.h\"\n#include \"xmss_wots.h\"\n#include \"xmss_hash.h\"\n#include \"xmss_commons.h\"\n#include <limits.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nstatic inline int\nwots_log2(uint32_t v)\n{\n  int      b;\n\n  for (b = sizeof (v) * CHAR_BIT - 1; b >= 0; b--) {\n    if ((1U << b) & v) {\n      return b;\n    }\n  }\n  return 0;\n}"
  }
]