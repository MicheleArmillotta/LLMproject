[
  {
    "function_name": "strcasestr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strcasestr.c",
    "lines": "48-66",
    "snippet": "char *\nstrcasestr(const char *s, const char *find)\n{\n\tchar c, sc;\n\tsize_t len;\n\n\tif ((c = *find++) != 0) {\n\t\tc = (char)tolower((unsigned char)c);\n\t\tlen = strlen(find);\n\t\tdo {\n\t\t\tdo {\n\t\t\t\tif ((sc = *s++) == 0)\n\t\t\t\t\treturn (NULL);\n\t\t\t} while ((char)tolower((unsigned char)sc) != c);\n\t\t} while (strncasecmp(s, find, len) != 0);\n\t\ts--;\n\t}\n\treturn ((char *)s);\n}",
    "includes": [
      "#include <string.h>",
      "#include <ctype.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncasecmp",
          "args": [
            "s",
            "find",
            "len"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tolower",
          "args": [
            "(unsigned char)sc"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "find"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tolower",
          "args": [
            "(unsigned char)c"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <ctype.h>\n#include \"includes.h\"\n\nchar *\nstrcasestr(const char *s, const char *find)\n{\n\tchar c, sc;\n\tsize_t len;\n\n\tif ((c = *find++) != 0) {\n\t\tc = (char)tolower((unsigned char)c);\n\t\tlen = strlen(find);\n\t\tdo {\n\t\t\tdo {\n\t\t\t\tif ((sc = *s++) == 0)\n\t\t\t\t\treturn (NULL);\n\t\t\t} while ((char)tolower((unsigned char)sc) != c);\n\t\t} while (strncasecmp(s, find, len) != 0);\n\t\ts--;\n\t}\n\treturn ((char *)s);\n}"
  }
]