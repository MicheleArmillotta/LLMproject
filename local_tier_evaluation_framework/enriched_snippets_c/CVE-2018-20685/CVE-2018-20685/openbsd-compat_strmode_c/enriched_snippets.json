[
  {
    "function_name": "strmode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strmode.c",
    "lines": "42-147",
    "snippet": "void\nstrmode(int mode, char *p)\n{\n\t /* print type */\n\tswitch (mode & S_IFMT) {\n\tcase S_IFDIR:\t\t\t/* directory */\n\t\t*p++ = 'd';\n\t\tbreak;\n\tcase S_IFCHR:\t\t\t/* character special */\n\t\t*p++ = 'c';\n\t\tbreak;\n\tcase S_IFBLK:\t\t\t/* block special */\n\t\t*p++ = 'b';\n\t\tbreak;\n\tcase S_IFREG:\t\t\t/* regular */\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IFLNK:\t\t\t/* symbolic link */\n\t\t*p++ = 'l';\n\t\tbreak;\n#ifdef S_IFSOCK\n\tcase S_IFSOCK:\t\t\t/* socket */\n\t\t*p++ = 's';\n\t\tbreak;\n#endif\n#ifdef S_IFIFO\n\tcase S_IFIFO:\t\t\t/* fifo */\n\t\t*p++ = 'p';\n\t\tbreak;\n#endif\n\tdefault:\t\t\t/* unknown */\n\t\t*p++ = '?';\n\t\tbreak;\n\t}\n\t/* usr */\n\tif (mode & S_IRUSR)\n\t\t*p++ = 'r';\n\telse\n\t\t*p++ = '-';\n\tif (mode & S_IWUSR)\n\t\t*p++ = 'w';\n\telse\n\t\t*p++ = '-';\n\tswitch (mode & (S_IXUSR | S_ISUID)) {\n\tcase 0:\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IXUSR:\n\t\t*p++ = 'x';\n\t\tbreak;\n\tcase S_ISUID:\n\t\t*p++ = 'S';\n\t\tbreak;\n\tcase S_IXUSR | S_ISUID:\n\t\t*p++ = 's';\n\t\tbreak;\n\t}\n\t/* group */\n\tif (mode & S_IRGRP)\n\t\t*p++ = 'r';\n\telse\n\t\t*p++ = '-';\n\tif (mode & S_IWGRP)\n\t\t*p++ = 'w';\n\telse\n\t\t*p++ = '-';\n\tswitch (mode & (S_IXGRP | S_ISGID)) {\n\tcase 0:\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IXGRP:\n\t\t*p++ = 'x';\n\t\tbreak;\n\tcase S_ISGID:\n\t\t*p++ = 'S';\n\t\tbreak;\n\tcase S_IXGRP | S_ISGID:\n\t\t*p++ = 's';\n\t\tbreak;\n\t}\n\t/* other */\n\tif (mode & S_IROTH)\n\t\t*p++ = 'r';\n\telse\n\t\t*p++ = '-';\n\tif (mode & S_IWOTH)\n\t\t*p++ = 'w';\n\telse\n\t\t*p++ = '-';\n\tswitch (mode & (S_IXOTH | S_ISVTX)) {\n\tcase 0:\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IXOTH:\n\t\t*p++ = 'x';\n\t\tbreak;\n\tcase S_ISVTX:\n\t\t*p++ = 'T';\n\t\tbreak;\n\tcase S_IXOTH | S_ISVTX:\n\t\t*p++ = 't';\n\t\tbreak;\n\t}\n\t*p++ = ' ';\t\t/* will be a '+' if ACL's implemented */\n\t*p = '\\0';\n}",
    "includes": [
      "#include <string.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <string.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nstrmode(int mode, char *p)\n{\n\t /* print type */\n\tswitch (mode & S_IFMT) {\n\tcase S_IFDIR:\t\t\t/* directory */\n\t\t*p++ = 'd';\n\t\tbreak;\n\tcase S_IFCHR:\t\t\t/* character special */\n\t\t*p++ = 'c';\n\t\tbreak;\n\tcase S_IFBLK:\t\t\t/* block special */\n\t\t*p++ = 'b';\n\t\tbreak;\n\tcase S_IFREG:\t\t\t/* regular */\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IFLNK:\t\t\t/* symbolic link */\n\t\t*p++ = 'l';\n\t\tbreak;\n#ifdef S_IFSOCK\n\tcase S_IFSOCK:\t\t\t/* socket */\n\t\t*p++ = 's';\n\t\tbreak;\n#endif\n#ifdef S_IFIFO\n\tcase S_IFIFO:\t\t\t/* fifo */\n\t\t*p++ = 'p';\n\t\tbreak;\n#endif\n\tdefault:\t\t\t/* unknown */\n\t\t*p++ = '?';\n\t\tbreak;\n\t}\n\t/* usr */\n\tif (mode & S_IRUSR)\n\t\t*p++ = 'r';\n\telse\n\t\t*p++ = '-';\n\tif (mode & S_IWUSR)\n\t\t*p++ = 'w';\n\telse\n\t\t*p++ = '-';\n\tswitch (mode & (S_IXUSR | S_ISUID)) {\n\tcase 0:\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IXUSR:\n\t\t*p++ = 'x';\n\t\tbreak;\n\tcase S_ISUID:\n\t\t*p++ = 'S';\n\t\tbreak;\n\tcase S_IXUSR | S_ISUID:\n\t\t*p++ = 's';\n\t\tbreak;\n\t}\n\t/* group */\n\tif (mode & S_IRGRP)\n\t\t*p++ = 'r';\n\telse\n\t\t*p++ = '-';\n\tif (mode & S_IWGRP)\n\t\t*p++ = 'w';\n\telse\n\t\t*p++ = '-';\n\tswitch (mode & (S_IXGRP | S_ISGID)) {\n\tcase 0:\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IXGRP:\n\t\t*p++ = 'x';\n\t\tbreak;\n\tcase S_ISGID:\n\t\t*p++ = 'S';\n\t\tbreak;\n\tcase S_IXGRP | S_ISGID:\n\t\t*p++ = 's';\n\t\tbreak;\n\t}\n\t/* other */\n\tif (mode & S_IROTH)\n\t\t*p++ = 'r';\n\telse\n\t\t*p++ = '-';\n\tif (mode & S_IWOTH)\n\t\t*p++ = 'w';\n\telse\n\t\t*p++ = '-';\n\tswitch (mode & (S_IXOTH | S_ISVTX)) {\n\tcase 0:\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IXOTH:\n\t\t*p++ = 'x';\n\t\tbreak;\n\tcase S_ISVTX:\n\t\t*p++ = 'T';\n\t\tbreak;\n\tcase S_IXOTH | S_ISVTX:\n\t\t*p++ = 't';\n\t\tbreak;\n\t}\n\t*p++ = ' ';\t\t/* will be a '+' if ACL's implemented */\n\t*p = '\\0';\n}"
  }
]