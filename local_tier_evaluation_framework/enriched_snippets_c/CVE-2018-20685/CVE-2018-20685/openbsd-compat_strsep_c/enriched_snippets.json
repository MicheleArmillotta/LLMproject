[
  {
    "function_name": "strsep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strsep.c",
    "lines": "52-77",
    "snippet": "char *\nstrsep(char **stringp, const char *delim)\n{\n\tchar *s;\n\tconst char *spanp;\n\tint c, sc;\n\tchar *tok;\n\n\tif ((s = *stringp) == NULL)\n\t\treturn (NULL);\n\tfor (tok = s;;) {\n\t\tc = *s++;\n\t\tspanp = delim;\n\t\tdo {\n\t\t\tif ((sc = *spanp++) == c) {\n\t\t\t\tif (c == 0)\n\t\t\t\t\ts = NULL;\n\t\t\t\telse\n\t\t\t\t\ts[-1] = 0;\n\t\t\t\t*stringp = s;\n\t\t\t\treturn (tok);\n\t\t\t}\n\t\t} while (sc != 0);\n\t}\n\t/* NOTREACHED */\n}",
    "includes": [
      "#include <stdio.h>",
      "#include <string.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <stdio.h>\n#include <string.h>\n#include \"includes.h\"\n\nchar *\nstrsep(char **stringp, const char *delim)\n{\n\tchar *s;\n\tconst char *spanp;\n\tint c, sc;\n\tchar *tok;\n\n\tif ((s = *stringp) == NULL)\n\t\treturn (NULL);\n\tfor (tok = s;;) {\n\t\tc = *s++;\n\t\tspanp = delim;\n\t\tdo {\n\t\t\tif ((sc = *spanp++) == c) {\n\t\t\t\tif (c == 0)\n\t\t\t\t\ts = NULL;\n\t\t\t\telse\n\t\t\t\t\ts[-1] = 0;\n\t\t\t\t*stringp = s;\n\t\t\t\treturn (tok);\n\t\t\t}\n\t\t} while (sc != 0);\n\t}\n\t/* NOTREACHED */\n}"
  }
]