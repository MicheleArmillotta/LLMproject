[
  {
    "function_name": "openssh_RSA_verify",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-rsa.c",
    "lines": "402-448",
    "snippet": "static int\nopenssh_RSA_verify(int hash_alg, u_char *hash, size_t hashlen,\n    u_char *sigbuf, size_t siglen, RSA *rsa)\n{\n\tsize_t rsasize = 0, oidlen = 0, hlen = 0;\n\tint ret, len, oidmatch, hashmatch;\n\tconst u_char *oid = NULL;\n\tu_char *decrypted = NULL;\n\n\tif ((ret = rsa_hash_alg_oid(hash_alg, &oid, &oidlen)) != 0)\n\t\treturn ret;\n\tret = SSH_ERR_INTERNAL_ERROR;\n\thlen = ssh_digest_bytes(hash_alg);\n\tif (hashlen != hlen) {\n\t\tret = SSH_ERR_INVALID_ARGUMENT;\n\t\tgoto done;\n\t}\n\trsasize = RSA_size(rsa);\n\tif (rsasize <= 0 || rsasize > SSHBUF_MAX_BIGNUM ||\n\t    siglen == 0 || siglen > rsasize) {\n\t\tret = SSH_ERR_INVALID_ARGUMENT;\n\t\tgoto done;\n\t}\n\tif ((decrypted = malloc(rsasize)) == NULL) {\n\t\tret = SSH_ERR_ALLOC_FAIL;\n\t\tgoto done;\n\t}\n\tif ((len = RSA_public_decrypt(siglen, sigbuf, decrypted, rsa,\n\t    RSA_PKCS1_PADDING)) < 0) {\n\t\tret = SSH_ERR_LIBCRYPTO_ERROR;\n\t\tgoto done;\n\t}\n\tif (len < 0 || (size_t)len != hlen + oidlen) {\n\t\tret = SSH_ERR_INVALID_FORMAT;\n\t\tgoto done;\n\t}\n\toidmatch = timingsafe_bcmp(decrypted, oid, oidlen) == 0;\n\thashmatch = timingsafe_bcmp(decrypted + oidlen, hash, hlen) == 0;\n\tif (!oidmatch || !hashmatch) {\n\t\tret = SSH_ERR_SIGNATURE_INVALID;\n\t\tgoto done;\n\t}\n\tret = 0;\ndone:\n\tfreezero(decrypted, rsasize);\n\treturn ret;\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"log.h\"",
      "#include \"digest.h\"",
      "#include \"sshkey.h\"",
      "#include \"ssherr.h\"",
      "#include \"compat.h\"",
      "#include \"sshbuf.h\"",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <openssl/err.h>",
      "#include <openssl/evp.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "freezero",
          "args": [
            "decrypted",
            "rsasize"
          ],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "freezero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/freezero.c",
          "lines": "24-31",
          "snippet": "void\nfreezero(void *ptr, size_t sz)\n{\n\tif (ptr == NULL)\n\t\treturn;\n\texplicit_bzero(ptr, sz);\n\tfree(ptr);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nvoid\nfreezero(void *ptr, size_t sz)\n{\n\tif (ptr == NULL)\n\t\treturn;\n\texplicit_bzero(ptr, sz);\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "timingsafe_bcmp",
          "args": [
            "decrypted + oidlen",
            "hash",
            "hlen"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "timingsafe_bcmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/timingsafe_bcmp.c",
          "lines": "23-32",
          "snippet": "int\ntimingsafe_bcmp(const void *b1, const void *b2, size_t n)\n{\n\tconst unsigned char *p1 = b1, *p2 = b2;\n\tint ret = 0;\n\n\tfor (; n > 0; n--)\n\t\tret |= *p1++ ^ *p2++;\n\treturn (ret != 0);\n}",
          "includes": [
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"includes.h\"\n\nint\ntimingsafe_bcmp(const void *b1, const void *b2, size_t n)\n{\n\tconst unsigned char *p1 = b1, *p2 = b2;\n\tint ret = 0;\n\n\tfor (; n > 0; n--)\n\t\tret |= *p1++ ^ *p2++;\n\treturn (ret != 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "RSA_public_decrypt",
          "args": [
            "siglen",
            "sigbuf",
            "decrypted",
            "rsa",
            "RSA_PKCS1_PADDING"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "rsasize"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "xmalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "39-50",
          "snippet": "void *\nxmalloc(size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0)\n\t\tfatal(\"xmalloc: zero size\");\n\tptr = malloc(size);\n\tif (ptr == NULL)\n\t\tfatal(\"xmalloc: out of memory (allocating %zu bytes)\", size);\n\treturn ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxmalloc(size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0)\n\t\tfatal(\"xmalloc: zero size\");\n\tptr = malloc(size);\n\tif (ptr == NULL)\n\t\tfatal(\"xmalloc: out of memory (allocating %zu bytes)\", size);\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "RSA_size",
          "args": [
            "rsa"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssh_digest_bytes",
          "args": [
            "hash_alg"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "143-149",
          "snippet": "size_t\nssh_digest_bytes(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\n\treturn digest == NULL ? 0 : digest->digest_len;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nssh_digest_bytes(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\n\treturn digest == NULL ? 0 : digest->digest_len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rsa_hash_alg_oid",
          "args": [
            "hash_alg",
            "&oid",
            "&oidlen"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "rsa_hash_alg_oid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-rsa.c",
          "lines": "380-400",
          "snippet": "static int\nrsa_hash_alg_oid(int hash_alg, const u_char **oidp, size_t *oidlenp)\n{\n\tswitch (hash_alg) {\n\tcase SSH_DIGEST_SHA1:\n\t\t*oidp = id_sha1;\n\t\t*oidlenp = sizeof(id_sha1);\n\t\tbreak;\n\tcase SSH_DIGEST_SHA256:\n\t\t*oidp = id_sha256;\n\t\t*oidlenp = sizeof(id_sha256);\n\t\tbreak;\n\tcase SSH_DIGEST_SHA512:\n\t\t*oidp = id_sha512;\n\t\t*oidlenp = sizeof(id_sha512);\n\t\tbreak;\n\tdefault:\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"log.h\"",
            "#include \"digest.h\"",
            "#include \"sshkey.h\"",
            "#include \"ssherr.h\"",
            "#include \"compat.h\"",
            "#include \"sshbuf.h\"",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <openssl/err.h>",
            "#include <openssl/evp.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"log.h\"\n#include \"digest.h\"\n#include \"sshkey.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <stdarg.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nrsa_hash_alg_oid(int hash_alg, const u_char **oidp, size_t *oidlenp)\n{\n\tswitch (hash_alg) {\n\tcase SSH_DIGEST_SHA1:\n\t\t*oidp = id_sha1;\n\t\t*oidlenp = sizeof(id_sha1);\n\t\tbreak;\n\tcase SSH_DIGEST_SHA256:\n\t\t*oidp = id_sha256;\n\t\t*oidlenp = sizeof(id_sha256);\n\t\tbreak;\n\tcase SSH_DIGEST_SHA512:\n\t\t*oidp = id_sha512;\n\t\t*oidlenp = sizeof(id_sha512);\n\t\tbreak;\n\tdefault:\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"log.h\"\n#include \"digest.h\"\n#include \"sshkey.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <stdarg.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nopenssh_RSA_verify(int hash_alg, u_char *hash, size_t hashlen,\n    u_char *sigbuf, size_t siglen, RSA *rsa)\n{\n\tsize_t rsasize = 0, oidlen = 0, hlen = 0;\n\tint ret, len, oidmatch, hashmatch;\n\tconst u_char *oid = NULL;\n\tu_char *decrypted = NULL;\n\n\tif ((ret = rsa_hash_alg_oid(hash_alg, &oid, &oidlen)) != 0)\n\t\treturn ret;\n\tret = SSH_ERR_INTERNAL_ERROR;\n\thlen = ssh_digest_bytes(hash_alg);\n\tif (hashlen != hlen) {\n\t\tret = SSH_ERR_INVALID_ARGUMENT;\n\t\tgoto done;\n\t}\n\trsasize = RSA_size(rsa);\n\tif (rsasize <= 0 || rsasize > SSHBUF_MAX_BIGNUM ||\n\t    siglen == 0 || siglen > rsasize) {\n\t\tret = SSH_ERR_INVALID_ARGUMENT;\n\t\tgoto done;\n\t}\n\tif ((decrypted = malloc(rsasize)) == NULL) {\n\t\tret = SSH_ERR_ALLOC_FAIL;\n\t\tgoto done;\n\t}\n\tif ((len = RSA_public_decrypt(siglen, sigbuf, decrypted, rsa,\n\t    RSA_PKCS1_PADDING)) < 0) {\n\t\tret = SSH_ERR_LIBCRYPTO_ERROR;\n\t\tgoto done;\n\t}\n\tif (len < 0 || (size_t)len != hlen + oidlen) {\n\t\tret = SSH_ERR_INVALID_FORMAT;\n\t\tgoto done;\n\t}\n\toidmatch = timingsafe_bcmp(decrypted, oid, oidlen) == 0;\n\thashmatch = timingsafe_bcmp(decrypted + oidlen, hash, hlen) == 0;\n\tif (!oidmatch || !hashmatch) {\n\t\tret = SSH_ERR_SIGNATURE_INVALID;\n\t\tgoto done;\n\t}\n\tret = 0;\ndone:\n\tfreezero(decrypted, rsasize);\n\treturn ret;\n}"
  },
  {
    "function_name": "rsa_hash_alg_oid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-rsa.c",
    "lines": "380-400",
    "snippet": "static int\nrsa_hash_alg_oid(int hash_alg, const u_char **oidp, size_t *oidlenp)\n{\n\tswitch (hash_alg) {\n\tcase SSH_DIGEST_SHA1:\n\t\t*oidp = id_sha1;\n\t\t*oidlenp = sizeof(id_sha1);\n\t\tbreak;\n\tcase SSH_DIGEST_SHA256:\n\t\t*oidp = id_sha256;\n\t\t*oidlenp = sizeof(id_sha256);\n\t\tbreak;\n\tcase SSH_DIGEST_SHA512:\n\t\t*oidp = id_sha512;\n\t\t*oidlenp = sizeof(id_sha512);\n\t\tbreak;\n\tdefault:\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"log.h\"",
      "#include \"digest.h\"",
      "#include \"sshkey.h\"",
      "#include \"ssherr.h\"",
      "#include \"compat.h\"",
      "#include \"sshbuf.h\"",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <openssl/err.h>",
      "#include <openssl/evp.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"log.h\"\n#include \"digest.h\"\n#include \"sshkey.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <stdarg.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nrsa_hash_alg_oid(int hash_alg, const u_char **oidp, size_t *oidlenp)\n{\n\tswitch (hash_alg) {\n\tcase SSH_DIGEST_SHA1:\n\t\t*oidp = id_sha1;\n\t\t*oidlenp = sizeof(id_sha1);\n\t\tbreak;\n\tcase SSH_DIGEST_SHA256:\n\t\t*oidp = id_sha256;\n\t\t*oidlenp = sizeof(id_sha256);\n\t\tbreak;\n\tcase SSH_DIGEST_SHA512:\n\t\t*oidp = id_sha512;\n\t\t*oidlenp = sizeof(id_sha512);\n\t\tbreak;\n\tdefault:\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "ssh_rsa_verify",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-rsa.c",
    "lines": "244-329",
    "snippet": "int\nssh_rsa_verify(const struct sshkey *key,\n    const u_char *sig, size_t siglen, const u_char *data, size_t datalen,\n    const char *alg)\n{\n\tconst BIGNUM *rsa_n;\n\tchar *sigtype = NULL;\n\tint hash_alg, want_alg, ret = SSH_ERR_INTERNAL_ERROR;\n\tsize_t len = 0, diff, modlen, dlen;\n\tstruct sshbuf *b = NULL;\n\tu_char digest[SSH_DIGEST_MAX_LENGTH], *osigblob, *sigblob = NULL;\n\n\tif (key == NULL || key->rsa == NULL ||\n\t    sshkey_type_plain(key->type) != KEY_RSA ||\n\t    sig == NULL || siglen == 0)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tRSA_get0_key(key->rsa, &rsa_n, NULL, NULL);\n\tif (BN_num_bits(rsa_n) < SSH_RSA_MINIMUM_MODULUS_SIZE)\n\t\treturn SSH_ERR_KEY_LENGTH;\n\n\tif ((b = sshbuf_from(sig, siglen)) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif (sshbuf_get_cstring(b, &sigtype, NULL) != 0) {\n\t\tret = SSH_ERR_INVALID_FORMAT;\n\t\tgoto out;\n\t}\n\tif ((hash_alg = rsa_hash_id_from_ident(sigtype)) == -1) {\n\t\tret = SSH_ERR_KEY_TYPE_MISMATCH;\n\t\tgoto out;\n\t}\n\t/*\n\t * Allow ssh-rsa-cert-v01 certs to generate SHA2 signatures for\n\t * legacy reasons, but otherwise the signature type should match.\n\t */\n\tif (alg != NULL && strcmp(alg, \"ssh-rsa-cert-v01@openssh.com\") != 0) {\n\t\tif ((want_alg = rsa_hash_id_from_keyname(alg)) == -1) {\n\t\t\tret = SSH_ERR_INVALID_ARGUMENT;\n\t\t\tgoto out;\n\t\t}\n\t\tif (hash_alg != want_alg) {\n\t\t\tret = SSH_ERR_SIGNATURE_INVALID;\n\t\t\tgoto out;\n\t\t}\n\t}\n\tif (sshbuf_get_string(b, &sigblob, &len) != 0) {\n\t\tret = SSH_ERR_INVALID_FORMAT;\n\t\tgoto out;\n\t}\n\tif (sshbuf_len(b) != 0) {\n\t\tret = SSH_ERR_UNEXPECTED_TRAILING_DATA;\n\t\tgoto out;\n\t}\n\t/* RSA_verify expects a signature of RSA_size */\n\tmodlen = RSA_size(key->rsa);\n\tif (len > modlen) {\n\t\tret = SSH_ERR_KEY_BITS_MISMATCH;\n\t\tgoto out;\n\t} else if (len < modlen) {\n\t\tdiff = modlen - len;\n\t\tosigblob = sigblob;\n\t\tif ((sigblob = realloc(sigblob, modlen)) == NULL) {\n\t\t\tsigblob = osigblob; /* put it back for clear/free */\n\t\t\tret = SSH_ERR_ALLOC_FAIL;\n\t\t\tgoto out;\n\t\t}\n\t\tmemmove(sigblob + diff, sigblob, len);\n\t\texplicit_bzero(sigblob, diff);\n\t\tlen = modlen;\n\t}\n\tif ((dlen = ssh_digest_bytes(hash_alg)) == 0) {\n\t\tret = SSH_ERR_INTERNAL_ERROR;\n\t\tgoto out;\n\t}\n\tif ((ret = ssh_digest_memory(hash_alg, data, datalen,\n\t    digest, sizeof(digest))) != 0)\n\t\tgoto out;\n\n\tret = openssh_RSA_verify(hash_alg, digest, dlen, sigblob, len,\n\t    key->rsa);\n out:\n\tfreezero(sigblob, len);\n\tfree(sigtype);\n\tsshbuf_free(b);\n\texplicit_bzero(digest, sizeof(digest));\n\treturn ret;\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"log.h\"",
      "#include \"digest.h\"",
      "#include \"sshkey.h\"",
      "#include \"ssherr.h\"",
      "#include \"compat.h\"",
      "#include \"sshbuf.h\"",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <openssl/err.h>",
      "#include <openssl/evp.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "explicit_bzero",
          "args": [
            "digest",
            "sizeof(digest)"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "explicit_bzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/explicit_bzero.c",
          "lines": "36-53",
          "snippet": "void\nexplicit_bzero(void *p, size_t n)\n{\n\tif (n == 0)\n\t\treturn;\n\t/*\n\t * clang -fsanitize=memory needs to intercept memset-like functions\n\t * to correctly detect memory initialisation. Make sure one is called\n\t * directly since our indirection trick above successfully confuses it.\n\t */\n#if defined(__has_feature)\n# if __has_feature(memory_sanitizer)\n\tmemset(p, 0, n);\n# endif\n#endif\n\n\tssh_bzero(p, n);\n}",
          "includes": [
            "#include <string.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"includes.h\"\n\nvoid\nexplicit_bzero(void *p, size_t n)\n{\n\tif (n == 0)\n\t\treturn;\n\t/*\n\t * clang -fsanitize=memory needs to intercept memset-like functions\n\t * to correctly detect memory initialisation. Make sure one is called\n\t * directly since our indirection trick above successfully confuses it.\n\t */\n#if defined(__has_feature)\n# if __has_feature(memory_sanitizer)\n\tmemset(p, 0, n);\n# endif\n#endif\n\n\tssh_bzero(p, n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_free",
          "args": [
            "b"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "133-166",
          "snippet": "void\nsshbuf_free(struct sshbuf *buf)\n{\n\tif (buf == NULL)\n\t\treturn;\n\t/*\n\t * The following will leak on insane buffers, but this is the safest\n\t * course of action - an invalid pointer or already-freed pointer may\n\t * have been passed to us and continuing to scribble over memory would\n\t * be bad.\n\t */\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn;\n\t/*\n\t * If we are a child, the free our parent to decrement its reference\n\t * count and possibly free it.\n\t */\n\tsshbuf_free(buf->parent);\n\tbuf->parent = NULL;\n\t/*\n\t * If we are a parent with still-extant children, then don't free just\n\t * yet. The last child's call to sshbuf_free should decrement our\n\t * refcount to 0 and trigger the actual free.\n\t */\n\tbuf->refcount--;\n\tif (buf->refcount > 0)\n\t\treturn;\n\tif (!buf->readonly) {\n\t\texplicit_bzero(buf->d, buf->alloc);\n\t\tfree(buf->d);\n\t}\n\texplicit_bzero(buf, sizeof(*buf));\n\tfree(buf);\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nsshbuf_free(struct sshbuf *buf)\n{\n\tif (buf == NULL)\n\t\treturn;\n\t/*\n\t * The following will leak on insane buffers, but this is the safest\n\t * course of action - an invalid pointer or already-freed pointer may\n\t * have been passed to us and continuing to scribble over memory would\n\t * be bad.\n\t */\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn;\n\t/*\n\t * If we are a child, the free our parent to decrement its reference\n\t * count and possibly free it.\n\t */\n\tsshbuf_free(buf->parent);\n\tbuf->parent = NULL;\n\t/*\n\t * If we are a parent with still-extant children, then don't free just\n\t * yet. The last child's call to sshbuf_free should decrement our\n\t * refcount to 0 and trigger the actual free.\n\t */\n\tbuf->refcount--;\n\tif (buf->refcount > 0)\n\t\treturn;\n\tif (!buf->readonly) {\n\t\texplicit_bzero(buf->d, buf->alloc);\n\t\tfree(buf->d);\n\t}\n\texplicit_bzero(buf, sizeof(*buf));\n\tfree(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "sigtype"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "freeze",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/smult_curve25519_ref.c",
          "lines": "50-60",
          "snippet": "static void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [
            "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;"
          ],
          "called_functions": [],
          "contextual_snippet": "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;\n\nstatic void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "freezero",
          "args": [
            "sigblob",
            "len"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "freezero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/freezero.c",
          "lines": "24-31",
          "snippet": "void\nfreezero(void *ptr, size_t sz)\n{\n\tif (ptr == NULL)\n\t\treturn;\n\texplicit_bzero(ptr, sz);\n\tfree(ptr);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nvoid\nfreezero(void *ptr, size_t sz)\n{\n\tif (ptr == NULL)\n\t\treturn;\n\texplicit_bzero(ptr, sz);\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "openssh_RSA_verify",
          "args": [
            "hash_alg",
            "digest",
            "dlen",
            "sigblob",
            "len",
            "key->rsa"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "openssh_RSA_verify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-rsa.c",
          "lines": "402-448",
          "snippet": "static int\nopenssh_RSA_verify(int hash_alg, u_char *hash, size_t hashlen,\n    u_char *sigbuf, size_t siglen, RSA *rsa)\n{\n\tsize_t rsasize = 0, oidlen = 0, hlen = 0;\n\tint ret, len, oidmatch, hashmatch;\n\tconst u_char *oid = NULL;\n\tu_char *decrypted = NULL;\n\n\tif ((ret = rsa_hash_alg_oid(hash_alg, &oid, &oidlen)) != 0)\n\t\treturn ret;\n\tret = SSH_ERR_INTERNAL_ERROR;\n\thlen = ssh_digest_bytes(hash_alg);\n\tif (hashlen != hlen) {\n\t\tret = SSH_ERR_INVALID_ARGUMENT;\n\t\tgoto done;\n\t}\n\trsasize = RSA_size(rsa);\n\tif (rsasize <= 0 || rsasize > SSHBUF_MAX_BIGNUM ||\n\t    siglen == 0 || siglen > rsasize) {\n\t\tret = SSH_ERR_INVALID_ARGUMENT;\n\t\tgoto done;\n\t}\n\tif ((decrypted = malloc(rsasize)) == NULL) {\n\t\tret = SSH_ERR_ALLOC_FAIL;\n\t\tgoto done;\n\t}\n\tif ((len = RSA_public_decrypt(siglen, sigbuf, decrypted, rsa,\n\t    RSA_PKCS1_PADDING)) < 0) {\n\t\tret = SSH_ERR_LIBCRYPTO_ERROR;\n\t\tgoto done;\n\t}\n\tif (len < 0 || (size_t)len != hlen + oidlen) {\n\t\tret = SSH_ERR_INVALID_FORMAT;\n\t\tgoto done;\n\t}\n\toidmatch = timingsafe_bcmp(decrypted, oid, oidlen) == 0;\n\thashmatch = timingsafe_bcmp(decrypted + oidlen, hash, hlen) == 0;\n\tif (!oidmatch || !hashmatch) {\n\t\tret = SSH_ERR_SIGNATURE_INVALID;\n\t\tgoto done;\n\t}\n\tret = 0;\ndone:\n\tfreezero(decrypted, rsasize);\n\treturn ret;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"log.h\"",
            "#include \"digest.h\"",
            "#include \"sshkey.h\"",
            "#include \"ssherr.h\"",
            "#include \"compat.h\"",
            "#include \"sshbuf.h\"",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <openssl/err.h>",
            "#include <openssl/evp.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"log.h\"\n#include \"digest.h\"\n#include \"sshkey.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <stdarg.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nopenssh_RSA_verify(int hash_alg, u_char *hash, size_t hashlen,\n    u_char *sigbuf, size_t siglen, RSA *rsa)\n{\n\tsize_t rsasize = 0, oidlen = 0, hlen = 0;\n\tint ret, len, oidmatch, hashmatch;\n\tconst u_char *oid = NULL;\n\tu_char *decrypted = NULL;\n\n\tif ((ret = rsa_hash_alg_oid(hash_alg, &oid, &oidlen)) != 0)\n\t\treturn ret;\n\tret = SSH_ERR_INTERNAL_ERROR;\n\thlen = ssh_digest_bytes(hash_alg);\n\tif (hashlen != hlen) {\n\t\tret = SSH_ERR_INVALID_ARGUMENT;\n\t\tgoto done;\n\t}\n\trsasize = RSA_size(rsa);\n\tif (rsasize <= 0 || rsasize > SSHBUF_MAX_BIGNUM ||\n\t    siglen == 0 || siglen > rsasize) {\n\t\tret = SSH_ERR_INVALID_ARGUMENT;\n\t\tgoto done;\n\t}\n\tif ((decrypted = malloc(rsasize)) == NULL) {\n\t\tret = SSH_ERR_ALLOC_FAIL;\n\t\tgoto done;\n\t}\n\tif ((len = RSA_public_decrypt(siglen, sigbuf, decrypted, rsa,\n\t    RSA_PKCS1_PADDING)) < 0) {\n\t\tret = SSH_ERR_LIBCRYPTO_ERROR;\n\t\tgoto done;\n\t}\n\tif (len < 0 || (size_t)len != hlen + oidlen) {\n\t\tret = SSH_ERR_INVALID_FORMAT;\n\t\tgoto done;\n\t}\n\toidmatch = timingsafe_bcmp(decrypted, oid, oidlen) == 0;\n\thashmatch = timingsafe_bcmp(decrypted + oidlen, hash, hlen) == 0;\n\tif (!oidmatch || !hashmatch) {\n\t\tret = SSH_ERR_SIGNATURE_INVALID;\n\t\tgoto done;\n\t}\n\tret = 0;\ndone:\n\tfreezero(decrypted, rsasize);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_digest_memory",
          "args": [
            "hash_alg",
            "data",
            "datalen",
            "digest",
            "sizeof(digest)"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_memory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "235-247",
          "snippet": "int\nssh_digest_memory(int alg, const void *m, size_t mlen, u_char *d, size_t dlen)\n{\n\tstruct ssh_digest_ctx *ctx = ssh_digest_start(alg);\n\n\tif (ctx == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (ssh_digest_update(ctx, m, mlen) != 0 ||\n\t    ssh_digest_final(ctx, d, dlen) != 0)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tssh_digest_free(ctx);\n\treturn 0;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_memory(int alg, const void *m, size_t mlen, u_char *d, size_t dlen)\n{\n\tstruct ssh_digest_ctx *ctx = ssh_digest_start(alg);\n\n\tif (ctx == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (ssh_digest_update(ctx, m, mlen) != 0 ||\n\t    ssh_digest_final(ctx, d, dlen) != 0)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tssh_digest_free(ctx);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_digest_bytes",
          "args": [
            "hash_alg"
          ],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "143-149",
          "snippet": "size_t\nssh_digest_bytes(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\n\treturn digest == NULL ? 0 : digest->digest_len;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nssh_digest_bytes(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\n\treturn digest == NULL ? 0 : digest->digest_len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "sigblob + diff",
            "sigblob",
            "len"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "realloc",
          "args": [
            "sigblob",
            "modlen"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "rpl_realloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-malloc.c",
          "lines": "48-56",
          "snippet": "void *\nrpl_realloc(void *ptr, size_t size)\n{\n\tif (size == 0)\n\t\tsize = 1;\n\tif (ptr == 0)\n\t\treturn malloc(size);\n\treturn realloc(ptr, size);\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nvoid *\nrpl_realloc(void *ptr, size_t size)\n{\n\tif (size == 0)\n\t\tsize = 1;\n\tif (ptr == 0)\n\t\treturn malloc(size);\n\treturn realloc(ptr, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "RSA_size",
          "args": [
            "key->rsa"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_len",
          "args": [
            "b"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "252-258",
          "snippet": "size_t\nsshbuf_len(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn 0;\n\treturn buf->size - buf->off;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nsshbuf_len(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn 0;\n\treturn buf->size - buf->off;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_get_string",
          "args": [
            "b",
            "&sigblob",
            "&len"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_get_string_direct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "123-147",
          "snippet": "int\nsshbuf_get_string_direct(struct sshbuf *buf, const u_char **valp, size_t *lenp)\n{\n\tsize_t len;\n\tconst u_char *p;\n\tint r;\n\n\tif (valp != NULL)\n\t\t*valp = NULL;\n\tif (lenp != NULL)\n\t\t*lenp = 0;\n\tif ((r = sshbuf_peek_string_direct(buf, &p, &len)) < 0)\n\t\treturn r;\n\tif (valp != NULL)\n\t\t*valp = p;\n\tif (lenp != NULL)\n\t\t*lenp = len;\n\tif (sshbuf_consume(buf, len + 4) != 0) {\n\t\t/* Shouldn't happen */\n\t\tSSHBUF_DBG((\"SSH_ERR_INTERNAL_ERROR\"));\n\t\tSSHBUF_ABORT();\n\t\treturn SSH_ERR_INTERNAL_ERROR;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_get_string_direct(struct sshbuf *buf, const u_char **valp, size_t *lenp)\n{\n\tsize_t len;\n\tconst u_char *p;\n\tint r;\n\n\tif (valp != NULL)\n\t\t*valp = NULL;\n\tif (lenp != NULL)\n\t\t*lenp = 0;\n\tif ((r = sshbuf_peek_string_direct(buf, &p, &len)) < 0)\n\t\treturn r;\n\tif (valp != NULL)\n\t\t*valp = p;\n\tif (lenp != NULL)\n\t\t*lenp = len;\n\tif (sshbuf_consume(buf, len + 4) != 0) {\n\t\t/* Shouldn't happen */\n\t\tSSHBUF_DBG((\"SSH_ERR_INTERNAL_ERROR\"));\n\t\tSSHBUF_ABORT();\n\t\treturn SSH_ERR_INTERNAL_ERROR;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rsa_hash_id_from_keyname",
          "args": [
            "alg"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "rsa_hash_id_from_keyname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-rsa.c",
          "lines": "77-91",
          "snippet": "static int\nrsa_hash_id_from_keyname(const char *alg)\n{\n\tint r;\n\n\tif ((r = rsa_hash_id_from_ident(alg)) != -1)\n\t\treturn r;\n\tif (strcmp(alg, \"ssh-rsa-cert-v01@openssh.com\") == 0)\n\t\treturn SSH_DIGEST_SHA1;\n\tif (strcmp(alg, \"rsa-sha2-256-cert-v01@openssh.com\") == 0)\n\t\treturn SSH_DIGEST_SHA256;\n\tif (strcmp(alg, \"rsa-sha2-512-cert-v01@openssh.com\") == 0)\n\t\treturn SSH_DIGEST_SHA512;\n\treturn -1;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"log.h\"",
            "#include \"digest.h\"",
            "#include \"sshkey.h\"",
            "#include \"ssherr.h\"",
            "#include \"compat.h\"",
            "#include \"sshbuf.h\"",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <openssl/err.h>",
            "#include <openssl/evp.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"log.h\"\n#include \"digest.h\"\n#include \"sshkey.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <stdarg.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nrsa_hash_id_from_keyname(const char *alg)\n{\n\tint r;\n\n\tif ((r = rsa_hash_id_from_ident(alg)) != -1)\n\t\treturn r;\n\tif (strcmp(alg, \"ssh-rsa-cert-v01@openssh.com\") == 0)\n\t\treturn SSH_DIGEST_SHA1;\n\tif (strcmp(alg, \"rsa-sha2-256-cert-v01@openssh.com\") == 0)\n\t\treturn SSH_DIGEST_SHA256;\n\tif (strcmp(alg, \"rsa-sha2-512-cert-v01@openssh.com\") == 0)\n\t\treturn SSH_DIGEST_SHA512;\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "alg",
            "\"ssh-rsa-cert-v01@openssh.com\""
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_maybe_null",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "1550-1558",
          "snippet": "static int\nstrcmp_maybe_null(const char *a, const char *b)\n{\n\tif ((a == NULL && b != NULL) || (a != NULL && b == NULL))\n\t\treturn 0;\n\tif (a != NULL && strcmp(a, b) != 0)\n\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nstrcmp_maybe_null(const char *a, const char *b)\n{\n\tif ((a == NULL && b != NULL) || (a != NULL && b == NULL))\n\t\treturn 0;\n\tif (a != NULL && strcmp(a, b) != 0)\n\t\treturn 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rsa_hash_id_from_ident",
          "args": [
            "sigtype"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "rsa_hash_id_from_ident",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-rsa.c",
          "lines": "60-70",
          "snippet": "static int\nrsa_hash_id_from_ident(const char *ident)\n{\n\tif (strcmp(ident, \"ssh-rsa\") == 0)\n\t\treturn SSH_DIGEST_SHA1;\n\tif (strcmp(ident, \"rsa-sha2-256\") == 0)\n\t\treturn SSH_DIGEST_SHA256;\n\tif (strcmp(ident, \"rsa-sha2-512\") == 0)\n\t\treturn SSH_DIGEST_SHA512;\n\treturn -1;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"log.h\"",
            "#include \"digest.h\"",
            "#include \"sshkey.h\"",
            "#include \"ssherr.h\"",
            "#include \"compat.h\"",
            "#include \"sshbuf.h\"",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <openssl/err.h>",
            "#include <openssl/evp.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"log.h\"\n#include \"digest.h\"\n#include \"sshkey.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <stdarg.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nrsa_hash_id_from_ident(const char *ident)\n{\n\tif (strcmp(ident, \"ssh-rsa\") == 0)\n\t\treturn SSH_DIGEST_SHA1;\n\tif (strcmp(ident, \"rsa-sha2-256\") == 0)\n\t\treturn SSH_DIGEST_SHA256;\n\tif (strcmp(ident, \"rsa-sha2-512\") == 0)\n\t\treturn SSH_DIGEST_SHA512;\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_get_cstring",
          "args": [
            "b",
            "&sigtype",
            "NULL"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_get_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "180-213",
          "snippet": "int\nsshbuf_get_cstring(struct sshbuf *buf, char **valp, size_t *lenp)\n{\n\tsize_t len;\n\tconst u_char *p, *z;\n\tint r;\n\n\tif (valp != NULL)\n\t\t*valp = NULL;\n\tif (lenp != NULL)\n\t\t*lenp = 0;\n\tif ((r = sshbuf_peek_string_direct(buf, &p, &len)) != 0)\n\t\treturn r;\n\t/* Allow a \\0 only at the end of the string */\n\tif (len > 0 &&\n\t    (z = memchr(p , '\\0', len)) != NULL && z < p + len - 1) {\n\t\tSSHBUF_DBG((\"SSH_ERR_INVALID_FORMAT\"));\n\t\treturn SSH_ERR_INVALID_FORMAT;\n\t}\n\tif ((r = sshbuf_skip_string(buf)) != 0)\n\t\treturn -1;\n\tif (valp != NULL) {\n\t\tif ((*valp = malloc(len + 1)) == NULL) {\n\t\t\tSSHBUF_DBG((\"SSH_ERR_ALLOC_FAIL\"));\n\t\t\treturn SSH_ERR_ALLOC_FAIL;\n\t\t}\n\t\tif (len != 0)\n\t\t\tmemcpy(*valp, p, len);\n\t\t(*valp)[len] = '\\0';\n\t}\n\tif (lenp != NULL)\n\t\t*lenp = (size_t)len;\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_get_cstring(struct sshbuf *buf, char **valp, size_t *lenp)\n{\n\tsize_t len;\n\tconst u_char *p, *z;\n\tint r;\n\n\tif (valp != NULL)\n\t\t*valp = NULL;\n\tif (lenp != NULL)\n\t\t*lenp = 0;\n\tif ((r = sshbuf_peek_string_direct(buf, &p, &len)) != 0)\n\t\treturn r;\n\t/* Allow a \\0 only at the end of the string */\n\tif (len > 0 &&\n\t    (z = memchr(p , '\\0', len)) != NULL && z < p + len - 1) {\n\t\tSSHBUF_DBG((\"SSH_ERR_INVALID_FORMAT\"));\n\t\treturn SSH_ERR_INVALID_FORMAT;\n\t}\n\tif ((r = sshbuf_skip_string(buf)) != 0)\n\t\treturn -1;\n\tif (valp != NULL) {\n\t\tif ((*valp = malloc(len + 1)) == NULL) {\n\t\t\tSSHBUF_DBG((\"SSH_ERR_ALLOC_FAIL\"));\n\t\t\treturn SSH_ERR_ALLOC_FAIL;\n\t\t}\n\t\tif (len != 0)\n\t\t\tmemcpy(*valp, p, len);\n\t\t(*valp)[len] = '\\0';\n\t}\n\tif (lenp != NULL)\n\t\t*lenp = (size_t)len;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_from",
          "args": [
            "sig",
            "siglen"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_from",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "87-102",
          "snippet": "struct sshbuf *\nsshbuf_from(const void *blob, size_t len)\n{\n\tstruct sshbuf *ret;\n\n\tif (blob == NULL || len > SSHBUF_SIZE_MAX ||\n\t    (ret = calloc(sizeof(*ret), 1)) == NULL)\n\t\treturn NULL;\n\tret->alloc = ret->size = ret->max_size = len;\n\tret->readonly = 1;\n\tret->refcount = 1;\n\tret->parent = NULL;\n\tret->cd = blob;\n\tret->d = NULL;\n\treturn ret;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct sshbuf *\nsshbuf_from(const void *blob, size_t len)\n{\n\tstruct sshbuf *ret;\n\n\tif (blob == NULL || len > SSHBUF_SIZE_MAX ||\n\t    (ret = calloc(sizeof(*ret), 1)) == NULL)\n\t\treturn NULL;\n\tret->alloc = ret->size = ret->max_size = len;\n\tret->readonly = 1;\n\tret->refcount = 1;\n\tret->parent = NULL;\n\tret->cd = blob;\n\tret->d = NULL;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_num_bits",
          "args": [
            "rsa_n"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RSA_get0_key",
          "args": [
            "key->rsa",
            "&rsa_n",
            "NULL",
            "NULL"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "RSA_get0_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "230-239",
          "snippet": "void\nRSA_get0_key(const RSA *r, const BIGNUM **n, const BIGNUM **e, const BIGNUM **d)\n{\n\tif (n != NULL)\n\t\t*n = r->n;\n\tif (e != NULL)\n\t\t*e = r->e;\n\tif (d != NULL)\n\t\t*d = r->d;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nRSA_get0_key(const RSA *r, const BIGNUM **n, const BIGNUM **e, const BIGNUM **d)\n{\n\tif (n != NULL)\n\t\t*n = r->n;\n\tif (e != NULL)\n\t\t*e = r->e;\n\tif (d != NULL)\n\t\t*d = r->d;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshkey_type_plain",
          "args": [
            "key->type"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "sshkey_type_plain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshkey.c",
          "lines": "341-358",
          "snippet": "int\nsshkey_type_plain(int type)\n{\n\tswitch (type) {\n\tcase KEY_RSA_CERT:\n\t\treturn KEY_RSA;\n\tcase KEY_DSA_CERT:\n\t\treturn KEY_DSA;\n\tcase KEY_ECDSA_CERT:\n\t\treturn KEY_ECDSA;\n\tcase KEY_ED25519_CERT:\n\t\treturn KEY_ED25519;\n\tcase KEY_XMSS_CERT:\n\t\treturn KEY_XMSS;\n\tdefault:\n\t\treturn type;\n\t}\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"xmss_fast.h\"",
            "#include \"match.h\"",
            "#include \"sshkey-xmss.h\"",
            "#include \"sshkey.h\"",
            "#include \"digest.h\"",
            "#include \"cipher.h\"",
            "#include \"sshbuf.h\"",
            "#include \"misc.h\"",
            "#include \"ssherr.h\"",
            "#include \"ssh2.h\"",
            "#include <util.h>",
            "#include <resolv.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include \"crypto_api.h\"",
            "#include <openssl/pem.h>",
            "#include <openssl/err.h>",
            "#include <openssl/evp.h>",
            "#include <netinet/in.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"xmss_fast.h\"\n#include \"match.h\"\n#include \"sshkey-xmss.h\"\n#include \"sshkey.h\"\n#include \"digest.h\"\n#include \"cipher.h\"\n#include \"sshbuf.h\"\n#include \"misc.h\"\n#include \"ssherr.h\"\n#include \"ssh2.h\"\n#include <util.h>\n#include <resolv.h>\n#include <string.h>\n#include <stdio.h>\n#include <limits.h>\n#include <errno.h>\n#include \"crypto_api.h\"\n#include <openssl/pem.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <netinet/in.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshkey_type_plain(int type)\n{\n\tswitch (type) {\n\tcase KEY_RSA_CERT:\n\t\treturn KEY_RSA;\n\tcase KEY_DSA_CERT:\n\t\treturn KEY_DSA;\n\tcase KEY_ECDSA_CERT:\n\t\treturn KEY_ECDSA;\n\tcase KEY_ED25519_CERT:\n\t\treturn KEY_ED25519;\n\tcase KEY_XMSS_CERT:\n\t\treturn KEY_XMSS;\n\tdefault:\n\t\treturn type;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"log.h\"\n#include \"digest.h\"\n#include \"sshkey.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <stdarg.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_rsa_verify(const struct sshkey *key,\n    const u_char *sig, size_t siglen, const u_char *data, size_t datalen,\n    const char *alg)\n{\n\tconst BIGNUM *rsa_n;\n\tchar *sigtype = NULL;\n\tint hash_alg, want_alg, ret = SSH_ERR_INTERNAL_ERROR;\n\tsize_t len = 0, diff, modlen, dlen;\n\tstruct sshbuf *b = NULL;\n\tu_char digest[SSH_DIGEST_MAX_LENGTH], *osigblob, *sigblob = NULL;\n\n\tif (key == NULL || key->rsa == NULL ||\n\t    sshkey_type_plain(key->type) != KEY_RSA ||\n\t    sig == NULL || siglen == 0)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tRSA_get0_key(key->rsa, &rsa_n, NULL, NULL);\n\tif (BN_num_bits(rsa_n) < SSH_RSA_MINIMUM_MODULUS_SIZE)\n\t\treturn SSH_ERR_KEY_LENGTH;\n\n\tif ((b = sshbuf_from(sig, siglen)) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif (sshbuf_get_cstring(b, &sigtype, NULL) != 0) {\n\t\tret = SSH_ERR_INVALID_FORMAT;\n\t\tgoto out;\n\t}\n\tif ((hash_alg = rsa_hash_id_from_ident(sigtype)) == -1) {\n\t\tret = SSH_ERR_KEY_TYPE_MISMATCH;\n\t\tgoto out;\n\t}\n\t/*\n\t * Allow ssh-rsa-cert-v01 certs to generate SHA2 signatures for\n\t * legacy reasons, but otherwise the signature type should match.\n\t */\n\tif (alg != NULL && strcmp(alg, \"ssh-rsa-cert-v01@openssh.com\") != 0) {\n\t\tif ((want_alg = rsa_hash_id_from_keyname(alg)) == -1) {\n\t\t\tret = SSH_ERR_INVALID_ARGUMENT;\n\t\t\tgoto out;\n\t\t}\n\t\tif (hash_alg != want_alg) {\n\t\t\tret = SSH_ERR_SIGNATURE_INVALID;\n\t\t\tgoto out;\n\t\t}\n\t}\n\tif (sshbuf_get_string(b, &sigblob, &len) != 0) {\n\t\tret = SSH_ERR_INVALID_FORMAT;\n\t\tgoto out;\n\t}\n\tif (sshbuf_len(b) != 0) {\n\t\tret = SSH_ERR_UNEXPECTED_TRAILING_DATA;\n\t\tgoto out;\n\t}\n\t/* RSA_verify expects a signature of RSA_size */\n\tmodlen = RSA_size(key->rsa);\n\tif (len > modlen) {\n\t\tret = SSH_ERR_KEY_BITS_MISMATCH;\n\t\tgoto out;\n\t} else if (len < modlen) {\n\t\tdiff = modlen - len;\n\t\tosigblob = sigblob;\n\t\tif ((sigblob = realloc(sigblob, modlen)) == NULL) {\n\t\t\tsigblob = osigblob; /* put it back for clear/free */\n\t\t\tret = SSH_ERR_ALLOC_FAIL;\n\t\t\tgoto out;\n\t\t}\n\t\tmemmove(sigblob + diff, sigblob, len);\n\t\texplicit_bzero(sigblob, diff);\n\t\tlen = modlen;\n\t}\n\tif ((dlen = ssh_digest_bytes(hash_alg)) == 0) {\n\t\tret = SSH_ERR_INTERNAL_ERROR;\n\t\tgoto out;\n\t}\n\tif ((ret = ssh_digest_memory(hash_alg, data, datalen,\n\t    digest, sizeof(digest))) != 0)\n\t\tgoto out;\n\n\tret = openssh_RSA_verify(hash_alg, digest, dlen, sigblob, len,\n\t    key->rsa);\n out:\n\tfreezero(sigblob, len);\n\tfree(sigtype);\n\tsshbuf_free(b);\n\texplicit_bzero(digest, sizeof(digest));\n\treturn ret;\n}"
  },
  {
    "function_name": "ssh_rsa_sign",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-rsa.c",
    "lines": "163-242",
    "snippet": "int\nssh_rsa_sign(const struct sshkey *key, u_char **sigp, size_t *lenp,\n    const u_char *data, size_t datalen, const char *alg_ident)\n{\n\tconst BIGNUM *rsa_n;\n\tu_char digest[SSH_DIGEST_MAX_LENGTH], *sig = NULL;\n\tsize_t slen = 0;\n\tu_int dlen, len;\n\tint nid, hash_alg, ret = SSH_ERR_INTERNAL_ERROR;\n\tstruct sshbuf *b = NULL;\n\n\tif (lenp != NULL)\n\t\t*lenp = 0;\n\tif (sigp != NULL)\n\t\t*sigp = NULL;\n\n\tif (alg_ident == NULL || strlen(alg_ident) == 0)\n\t\thash_alg = SSH_DIGEST_SHA1;\n\telse\n\t\thash_alg = rsa_hash_id_from_keyname(alg_ident);\n\tif (key == NULL || key->rsa == NULL || hash_alg == -1 ||\n\t    sshkey_type_plain(key->type) != KEY_RSA)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tRSA_get0_key(key->rsa, &rsa_n, NULL, NULL);\n\tif (BN_num_bits(rsa_n) < SSH_RSA_MINIMUM_MODULUS_SIZE)\n\t\treturn SSH_ERR_KEY_LENGTH;\n\tslen = RSA_size(key->rsa);\n\tif (slen <= 0 || slen > SSHBUF_MAX_BIGNUM)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\n\t/* hash the data */\n\tnid = rsa_hash_alg_nid(hash_alg);\n\tif ((dlen = ssh_digest_bytes(hash_alg)) == 0)\n\t\treturn SSH_ERR_INTERNAL_ERROR;\n\tif ((ret = ssh_digest_memory(hash_alg, data, datalen,\n\t    digest, sizeof(digest))) != 0)\n\t\tgoto out;\n\n\tif ((sig = malloc(slen)) == NULL) {\n\t\tret = SSH_ERR_ALLOC_FAIL;\n\t\tgoto out;\n\t}\n\n\tif (RSA_sign(nid, digest, dlen, sig, &len, key->rsa) != 1) {\n\t\tret = SSH_ERR_LIBCRYPTO_ERROR;\n\t\tgoto out;\n\t}\n\tif (len < slen) {\n\t\tsize_t diff = slen - len;\n\t\tmemmove(sig + diff, sig, len);\n\t\texplicit_bzero(sig, diff);\n\t} else if (len > slen) {\n\t\tret = SSH_ERR_INTERNAL_ERROR;\n\t\tgoto out;\n\t}\n\t/* encode signature */\n\tif ((b = sshbuf_new()) == NULL) {\n\t\tret = SSH_ERR_ALLOC_FAIL;\n\t\tgoto out;\n\t}\n\tif ((ret = sshbuf_put_cstring(b, rsa_hash_alg_ident(hash_alg))) != 0 ||\n\t    (ret = sshbuf_put_string(b, sig, slen)) != 0)\n\t\tgoto out;\n\tlen = sshbuf_len(b);\n\tif (sigp != NULL) {\n\t\tif ((*sigp = malloc(len)) == NULL) {\n\t\t\tret = SSH_ERR_ALLOC_FAIL;\n\t\t\tgoto out;\n\t\t}\n\t\tmemcpy(*sigp, sshbuf_ptr(b), len);\n\t}\n\tif (lenp != NULL)\n\t\t*lenp = len;\n\tret = 0;\n out:\n\texplicit_bzero(digest, sizeof(digest));\n\tfreezero(sig, slen);\n\tsshbuf_free(b);\n\treturn ret;\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"log.h\"",
      "#include \"digest.h\"",
      "#include \"sshkey.h\"",
      "#include \"ssherr.h\"",
      "#include \"compat.h\"",
      "#include \"sshbuf.h\"",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <openssl/err.h>",
      "#include <openssl/evp.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sshbuf_free",
          "args": [
            "b"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "133-166",
          "snippet": "void\nsshbuf_free(struct sshbuf *buf)\n{\n\tif (buf == NULL)\n\t\treturn;\n\t/*\n\t * The following will leak on insane buffers, but this is the safest\n\t * course of action - an invalid pointer or already-freed pointer may\n\t * have been passed to us and continuing to scribble over memory would\n\t * be bad.\n\t */\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn;\n\t/*\n\t * If we are a child, the free our parent to decrement its reference\n\t * count and possibly free it.\n\t */\n\tsshbuf_free(buf->parent);\n\tbuf->parent = NULL;\n\t/*\n\t * If we are a parent with still-extant children, then don't free just\n\t * yet. The last child's call to sshbuf_free should decrement our\n\t * refcount to 0 and trigger the actual free.\n\t */\n\tbuf->refcount--;\n\tif (buf->refcount > 0)\n\t\treturn;\n\tif (!buf->readonly) {\n\t\texplicit_bzero(buf->d, buf->alloc);\n\t\tfree(buf->d);\n\t}\n\texplicit_bzero(buf, sizeof(*buf));\n\tfree(buf);\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nsshbuf_free(struct sshbuf *buf)\n{\n\tif (buf == NULL)\n\t\treturn;\n\t/*\n\t * The following will leak on insane buffers, but this is the safest\n\t * course of action - an invalid pointer or already-freed pointer may\n\t * have been passed to us and continuing to scribble over memory would\n\t * be bad.\n\t */\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn;\n\t/*\n\t * If we are a child, the free our parent to decrement its reference\n\t * count and possibly free it.\n\t */\n\tsshbuf_free(buf->parent);\n\tbuf->parent = NULL;\n\t/*\n\t * If we are a parent with still-extant children, then don't free just\n\t * yet. The last child's call to sshbuf_free should decrement our\n\t * refcount to 0 and trigger the actual free.\n\t */\n\tbuf->refcount--;\n\tif (buf->refcount > 0)\n\t\treturn;\n\tif (!buf->readonly) {\n\t\texplicit_bzero(buf->d, buf->alloc);\n\t\tfree(buf->d);\n\t}\n\texplicit_bzero(buf, sizeof(*buf));\n\tfree(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "freezero",
          "args": [
            "sig",
            "slen"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "freezero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/freezero.c",
          "lines": "24-31",
          "snippet": "void\nfreezero(void *ptr, size_t sz)\n{\n\tif (ptr == NULL)\n\t\treturn;\n\texplicit_bzero(ptr, sz);\n\tfree(ptr);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nvoid\nfreezero(void *ptr, size_t sz)\n{\n\tif (ptr == NULL)\n\t\treturn;\n\texplicit_bzero(ptr, sz);\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "explicit_bzero",
          "args": [
            "digest",
            "sizeof(digest)"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "explicit_bzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/explicit_bzero.c",
          "lines": "36-53",
          "snippet": "void\nexplicit_bzero(void *p, size_t n)\n{\n\tif (n == 0)\n\t\treturn;\n\t/*\n\t * clang -fsanitize=memory needs to intercept memset-like functions\n\t * to correctly detect memory initialisation. Make sure one is called\n\t * directly since our indirection trick above successfully confuses it.\n\t */\n#if defined(__has_feature)\n# if __has_feature(memory_sanitizer)\n\tmemset(p, 0, n);\n# endif\n#endif\n\n\tssh_bzero(p, n);\n}",
          "includes": [
            "#include <string.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"includes.h\"\n\nvoid\nexplicit_bzero(void *p, size_t n)\n{\n\tif (n == 0)\n\t\treturn;\n\t/*\n\t * clang -fsanitize=memory needs to intercept memset-like functions\n\t * to correctly detect memory initialisation. Make sure one is called\n\t * directly since our indirection trick above successfully confuses it.\n\t */\n#if defined(__has_feature)\n# if __has_feature(memory_sanitizer)\n\tmemset(p, 0, n);\n# endif\n#endif\n\n\tssh_bzero(p, n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "*sigp",
            "sshbuf_ptr(b)",
            "len"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_ptr",
          "args": [
            "b"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "268-274",
          "snippet": "const u_char *\nsshbuf_ptr(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn NULL;\n\treturn buf->cd + buf->off;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst u_char *\nsshbuf_ptr(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn NULL;\n\treturn buf->cd + buf->off;\n}"
        }
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "len"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "xmalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "39-50",
          "snippet": "void *\nxmalloc(size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0)\n\t\tfatal(\"xmalloc: zero size\");\n\tptr = malloc(size);\n\tif (ptr == NULL)\n\t\tfatal(\"xmalloc: out of memory (allocating %zu bytes)\", size);\n\treturn ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxmalloc(size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0)\n\t\tfatal(\"xmalloc: zero size\");\n\tptr = malloc(size);\n\tif (ptr == NULL)\n\t\tfatal(\"xmalloc: out of memory (allocating %zu bytes)\", size);\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_len",
          "args": [
            "b"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "252-258",
          "snippet": "size_t\nsshbuf_len(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn 0;\n\treturn buf->size - buf->off;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nsshbuf_len(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn 0;\n\treturn buf->size - buf->off;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_put_string",
          "args": [
            "b",
            "sig",
            "slen"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "347-363",
          "snippet": "int\nsshbuf_put_string(struct sshbuf *buf, const void *v, size_t len)\n{\n\tu_char *d;\n\tint r;\n\n\tif (len > SSHBUF_SIZE_MAX - 4) {\n\t\tSSHBUF_DBG((\"SSH_ERR_NO_BUFFER_SPACE\"));\n\t\treturn SSH_ERR_NO_BUFFER_SPACE;\n\t}\n\tif ((r = sshbuf_reserve(buf, len + 4, &d)) < 0)\n\t\treturn r;\n\tPOKE_U32(d, len);\n\tif (len != 0)\n\t\tmemcpy(d + 4, v, len);\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_string(struct sshbuf *buf, const void *v, size_t len)\n{\n\tu_char *d;\n\tint r;\n\n\tif (len > SSHBUF_SIZE_MAX - 4) {\n\t\tSSHBUF_DBG((\"SSH_ERR_NO_BUFFER_SPACE\"));\n\t\treturn SSH_ERR_NO_BUFFER_SPACE;\n\t}\n\tif ((r = sshbuf_reserve(buf, len + 4, &d)) < 0)\n\t\treturn r;\n\tPOKE_U32(d, len);\n\tif (len != 0)\n\t\tmemcpy(d + 4, v, len);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_put_cstring",
          "args": [
            "b",
            "rsa_hash_alg_ident(hash_alg)"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "365-369",
          "snippet": "int\nsshbuf_put_cstring(struct sshbuf *buf, const char *v)\n{\n\treturn sshbuf_put_string(buf, v, v == NULL ? 0 : strlen(v));\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_cstring(struct sshbuf *buf, const char *v)\n{\n\treturn sshbuf_put_string(buf, v, v == NULL ? 0 : strlen(v));\n}"
        }
      },
      {
        "call_info": {
          "callee": "rsa_hash_alg_ident",
          "args": [
            "hash_alg"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "rsa_hash_alg_ident",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-rsa.c",
          "lines": "42-54",
          "snippet": "static const char *\nrsa_hash_alg_ident(int hash_alg)\n{\n\tswitch (hash_alg) {\n\tcase SSH_DIGEST_SHA1:\n\t\treturn \"ssh-rsa\";\n\tcase SSH_DIGEST_SHA256:\n\t\treturn \"rsa-sha2-256\";\n\tcase SSH_DIGEST_SHA512:\n\t\treturn \"rsa-sha2-512\";\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"log.h\"",
            "#include \"digest.h\"",
            "#include \"sshkey.h\"",
            "#include \"ssherr.h\"",
            "#include \"compat.h\"",
            "#include \"sshbuf.h\"",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <openssl/err.h>",
            "#include <openssl/evp.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"log.h\"\n#include \"digest.h\"\n#include \"sshkey.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <stdarg.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic const char *\nrsa_hash_alg_ident(int hash_alg)\n{\n\tswitch (hash_alg) {\n\tcase SSH_DIGEST_SHA1:\n\t\treturn \"ssh-rsa\";\n\tcase SSH_DIGEST_SHA256:\n\t\treturn \"rsa-sha2-256\";\n\tcase SSH_DIGEST_SHA512:\n\t\treturn \"rsa-sha2-512\";\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_new",
          "args": [],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "68-85",
          "snippet": "struct sshbuf *\nsshbuf_new(void)\n{\n\tstruct sshbuf *ret;\n\n\tif ((ret = calloc(sizeof(*ret), 1)) == NULL)\n\t\treturn NULL;\n\tret->alloc = SSHBUF_SIZE_INIT;\n\tret->max_size = SSHBUF_SIZE_MAX;\n\tret->readonly = 0;\n\tret->refcount = 1;\n\tret->parent = NULL;\n\tif ((ret->cd = ret->d = calloc(1, ret->alloc)) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct sshbuf *\nsshbuf_new(void)\n{\n\tstruct sshbuf *ret;\n\n\tif ((ret = calloc(sizeof(*ret), 1)) == NULL)\n\t\treturn NULL;\n\tret->alloc = SSHBUF_SIZE_INIT;\n\tret->max_size = SSHBUF_SIZE_MAX;\n\tret->readonly = 0;\n\tret->refcount = 1;\n\tret->parent = NULL;\n\tif ((ret->cd = ret->d = calloc(1, ret->alloc)) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "sig + diff",
            "sig",
            "len"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RSA_sign",
          "args": [
            "nid",
            "digest",
            "dlen",
            "sig",
            "&len",
            "key->rsa"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssh_digest_memory",
          "args": [
            "hash_alg",
            "data",
            "datalen",
            "digest",
            "sizeof(digest)"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_memory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "235-247",
          "snippet": "int\nssh_digest_memory(int alg, const void *m, size_t mlen, u_char *d, size_t dlen)\n{\n\tstruct ssh_digest_ctx *ctx = ssh_digest_start(alg);\n\n\tif (ctx == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (ssh_digest_update(ctx, m, mlen) != 0 ||\n\t    ssh_digest_final(ctx, d, dlen) != 0)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tssh_digest_free(ctx);\n\treturn 0;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_memory(int alg, const void *m, size_t mlen, u_char *d, size_t dlen)\n{\n\tstruct ssh_digest_ctx *ctx = ssh_digest_start(alg);\n\n\tif (ctx == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (ssh_digest_update(ctx, m, mlen) != 0 ||\n\t    ssh_digest_final(ctx, d, dlen) != 0)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tssh_digest_free(ctx);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_digest_bytes",
          "args": [
            "hash_alg"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-libc.c",
          "lines": "143-149",
          "snippet": "size_t\nssh_digest_bytes(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\n\treturn digest == NULL ? 0 : digest->digest_len;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <sha2.h>",
            "#include <sha1.h>",
            "#include <rmd160.h>",
            "#include <md5.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <sha2.h>\n#include <sha1.h>\n#include <rmd160.h>\n#include <md5.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nssh_digest_bytes(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\n\treturn digest == NULL ? 0 : digest->digest_len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rsa_hash_alg_nid",
          "args": [
            "hash_alg"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "rsa_hash_alg_nid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-rsa.c",
          "lines": "93-106",
          "snippet": "static int\nrsa_hash_alg_nid(int type)\n{\n\tswitch (type) {\n\tcase SSH_DIGEST_SHA1:\n\t\treturn NID_sha1;\n\tcase SSH_DIGEST_SHA256:\n\t\treturn NID_sha256;\n\tcase SSH_DIGEST_SHA512:\n\t\treturn NID_sha512;\n\tdefault:\n\t\treturn -1;\n\t}\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"log.h\"",
            "#include \"digest.h\"",
            "#include \"sshkey.h\"",
            "#include \"ssherr.h\"",
            "#include \"compat.h\"",
            "#include \"sshbuf.h\"",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <openssl/err.h>",
            "#include <openssl/evp.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"log.h\"\n#include \"digest.h\"\n#include \"sshkey.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <stdarg.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nrsa_hash_alg_nid(int type)\n{\n\tswitch (type) {\n\tcase SSH_DIGEST_SHA1:\n\t\treturn NID_sha1;\n\tcase SSH_DIGEST_SHA256:\n\t\treturn NID_sha256;\n\tcase SSH_DIGEST_SHA512:\n\t\treturn NID_sha512;\n\tdefault:\n\t\treturn -1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "RSA_size",
          "args": [
            "key->rsa"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_num_bits",
          "args": [
            "rsa_n"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RSA_get0_key",
          "args": [
            "key->rsa",
            "&rsa_n",
            "NULL",
            "NULL"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "RSA_get0_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "230-239",
          "snippet": "void\nRSA_get0_key(const RSA *r, const BIGNUM **n, const BIGNUM **e, const BIGNUM **d)\n{\n\tif (n != NULL)\n\t\t*n = r->n;\n\tif (e != NULL)\n\t\t*e = r->e;\n\tif (d != NULL)\n\t\t*d = r->d;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nRSA_get0_key(const RSA *r, const BIGNUM **n, const BIGNUM **e, const BIGNUM **d)\n{\n\tif (n != NULL)\n\t\t*n = r->n;\n\tif (e != NULL)\n\t\t*e = r->e;\n\tif (d != NULL)\n\t\t*d = r->d;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshkey_type_plain",
          "args": [
            "key->type"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "sshkey_type_plain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshkey.c",
          "lines": "341-358",
          "snippet": "int\nsshkey_type_plain(int type)\n{\n\tswitch (type) {\n\tcase KEY_RSA_CERT:\n\t\treturn KEY_RSA;\n\tcase KEY_DSA_CERT:\n\t\treturn KEY_DSA;\n\tcase KEY_ECDSA_CERT:\n\t\treturn KEY_ECDSA;\n\tcase KEY_ED25519_CERT:\n\t\treturn KEY_ED25519;\n\tcase KEY_XMSS_CERT:\n\t\treturn KEY_XMSS;\n\tdefault:\n\t\treturn type;\n\t}\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"xmss_fast.h\"",
            "#include \"match.h\"",
            "#include \"sshkey-xmss.h\"",
            "#include \"sshkey.h\"",
            "#include \"digest.h\"",
            "#include \"cipher.h\"",
            "#include \"sshbuf.h\"",
            "#include \"misc.h\"",
            "#include \"ssherr.h\"",
            "#include \"ssh2.h\"",
            "#include <util.h>",
            "#include <resolv.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include \"crypto_api.h\"",
            "#include <openssl/pem.h>",
            "#include <openssl/err.h>",
            "#include <openssl/evp.h>",
            "#include <netinet/in.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"xmss_fast.h\"\n#include \"match.h\"\n#include \"sshkey-xmss.h\"\n#include \"sshkey.h\"\n#include \"digest.h\"\n#include \"cipher.h\"\n#include \"sshbuf.h\"\n#include \"misc.h\"\n#include \"ssherr.h\"\n#include \"ssh2.h\"\n#include <util.h>\n#include <resolv.h>\n#include <string.h>\n#include <stdio.h>\n#include <limits.h>\n#include <errno.h>\n#include \"crypto_api.h\"\n#include <openssl/pem.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <netinet/in.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshkey_type_plain(int type)\n{\n\tswitch (type) {\n\tcase KEY_RSA_CERT:\n\t\treturn KEY_RSA;\n\tcase KEY_DSA_CERT:\n\t\treturn KEY_DSA;\n\tcase KEY_ECDSA_CERT:\n\t\treturn KEY_ECDSA;\n\tcase KEY_ED25519_CERT:\n\t\treturn KEY_ED25519;\n\tcase KEY_XMSS_CERT:\n\t\treturn KEY_XMSS;\n\tdefault:\n\t\treturn type;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "rsa_hash_id_from_keyname",
          "args": [
            "alg_ident"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "rsa_hash_id_from_keyname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-rsa.c",
          "lines": "77-91",
          "snippet": "static int\nrsa_hash_id_from_keyname(const char *alg)\n{\n\tint r;\n\n\tif ((r = rsa_hash_id_from_ident(alg)) != -1)\n\t\treturn r;\n\tif (strcmp(alg, \"ssh-rsa-cert-v01@openssh.com\") == 0)\n\t\treturn SSH_DIGEST_SHA1;\n\tif (strcmp(alg, \"rsa-sha2-256-cert-v01@openssh.com\") == 0)\n\t\treturn SSH_DIGEST_SHA256;\n\tif (strcmp(alg, \"rsa-sha2-512-cert-v01@openssh.com\") == 0)\n\t\treturn SSH_DIGEST_SHA512;\n\treturn -1;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"log.h\"",
            "#include \"digest.h\"",
            "#include \"sshkey.h\"",
            "#include \"ssherr.h\"",
            "#include \"compat.h\"",
            "#include \"sshbuf.h\"",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <openssl/err.h>",
            "#include <openssl/evp.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"log.h\"\n#include \"digest.h\"\n#include \"sshkey.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <stdarg.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nrsa_hash_id_from_keyname(const char *alg)\n{\n\tint r;\n\n\tif ((r = rsa_hash_id_from_ident(alg)) != -1)\n\t\treturn r;\n\tif (strcmp(alg, \"ssh-rsa-cert-v01@openssh.com\") == 0)\n\t\treturn SSH_DIGEST_SHA1;\n\tif (strcmp(alg, \"rsa-sha2-256-cert-v01@openssh.com\") == 0)\n\t\treturn SSH_DIGEST_SHA256;\n\tif (strcmp(alg, \"rsa-sha2-512-cert-v01@openssh.com\") == 0)\n\t\treturn SSH_DIGEST_SHA512;\n\treturn -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "alg_ident"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"log.h\"\n#include \"digest.h\"\n#include \"sshkey.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <stdarg.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_rsa_sign(const struct sshkey *key, u_char **sigp, size_t *lenp,\n    const u_char *data, size_t datalen, const char *alg_ident)\n{\n\tconst BIGNUM *rsa_n;\n\tu_char digest[SSH_DIGEST_MAX_LENGTH], *sig = NULL;\n\tsize_t slen = 0;\n\tu_int dlen, len;\n\tint nid, hash_alg, ret = SSH_ERR_INTERNAL_ERROR;\n\tstruct sshbuf *b = NULL;\n\n\tif (lenp != NULL)\n\t\t*lenp = 0;\n\tif (sigp != NULL)\n\t\t*sigp = NULL;\n\n\tif (alg_ident == NULL || strlen(alg_ident) == 0)\n\t\thash_alg = SSH_DIGEST_SHA1;\n\telse\n\t\thash_alg = rsa_hash_id_from_keyname(alg_ident);\n\tif (key == NULL || key->rsa == NULL || hash_alg == -1 ||\n\t    sshkey_type_plain(key->type) != KEY_RSA)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tRSA_get0_key(key->rsa, &rsa_n, NULL, NULL);\n\tif (BN_num_bits(rsa_n) < SSH_RSA_MINIMUM_MODULUS_SIZE)\n\t\treturn SSH_ERR_KEY_LENGTH;\n\tslen = RSA_size(key->rsa);\n\tif (slen <= 0 || slen > SSHBUF_MAX_BIGNUM)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\n\t/* hash the data */\n\tnid = rsa_hash_alg_nid(hash_alg);\n\tif ((dlen = ssh_digest_bytes(hash_alg)) == 0)\n\t\treturn SSH_ERR_INTERNAL_ERROR;\n\tif ((ret = ssh_digest_memory(hash_alg, data, datalen,\n\t    digest, sizeof(digest))) != 0)\n\t\tgoto out;\n\n\tif ((sig = malloc(slen)) == NULL) {\n\t\tret = SSH_ERR_ALLOC_FAIL;\n\t\tgoto out;\n\t}\n\n\tif (RSA_sign(nid, digest, dlen, sig, &len, key->rsa) != 1) {\n\t\tret = SSH_ERR_LIBCRYPTO_ERROR;\n\t\tgoto out;\n\t}\n\tif (len < slen) {\n\t\tsize_t diff = slen - len;\n\t\tmemmove(sig + diff, sig, len);\n\t\texplicit_bzero(sig, diff);\n\t} else if (len > slen) {\n\t\tret = SSH_ERR_INTERNAL_ERROR;\n\t\tgoto out;\n\t}\n\t/* encode signature */\n\tif ((b = sshbuf_new()) == NULL) {\n\t\tret = SSH_ERR_ALLOC_FAIL;\n\t\tgoto out;\n\t}\n\tif ((ret = sshbuf_put_cstring(b, rsa_hash_alg_ident(hash_alg))) != 0 ||\n\t    (ret = sshbuf_put_string(b, sig, slen)) != 0)\n\t\tgoto out;\n\tlen = sshbuf_len(b);\n\tif (sigp != NULL) {\n\t\tif ((*sigp = malloc(len)) == NULL) {\n\t\t\tret = SSH_ERR_ALLOC_FAIL;\n\t\t\tgoto out;\n\t\t}\n\t\tmemcpy(*sigp, sshbuf_ptr(b), len);\n\t}\n\tif (lenp != NULL)\n\t\t*lenp = len;\n\tret = 0;\n out:\n\texplicit_bzero(digest, sizeof(digest));\n\tfreezero(sig, slen);\n\tsshbuf_free(b);\n\treturn ret;\n}"
  },
  {
    "function_name": "ssh_rsa_complete_crt_parameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-rsa.c",
    "lines": "108-160",
    "snippet": "int\nssh_rsa_complete_crt_parameters(struct sshkey *key, const BIGNUM *iqmp)\n{\n\tconst BIGNUM *rsa_p, *rsa_q, *rsa_d;\n\tBIGNUM *aux = NULL, *d_consttime = NULL;\n\tBIGNUM *rsa_dmq1 = NULL, *rsa_dmp1 = NULL, *rsa_iqmp = NULL;\n\tBN_CTX *ctx = NULL;\n\tint r;\n\n\tif (key == NULL || key->rsa == NULL ||\n\t    sshkey_type_plain(key->type) != KEY_RSA)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\n\tRSA_get0_key(key->rsa, NULL, NULL, &rsa_d);\n\tRSA_get0_factors(key->rsa, &rsa_p, &rsa_q);\n\n\tif ((ctx = BN_CTX_new()) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif ((aux = BN_new()) == NULL ||\n\t    (rsa_dmq1 = BN_new()) == NULL ||\n\t    (rsa_dmp1 = BN_new()) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif ((d_consttime = BN_dup(rsa_d)) == NULL ||\n\t    (rsa_iqmp = BN_dup(iqmp)) == NULL) {\n\t\tr = SSH_ERR_ALLOC_FAIL;\n\t\tgoto out;\n\t}\n\tBN_set_flags(aux, BN_FLG_CONSTTIME);\n\tBN_set_flags(d_consttime, BN_FLG_CONSTTIME);\n\n\tif ((BN_sub(aux, rsa_q, BN_value_one()) == 0) ||\n\t    (BN_mod(rsa_dmq1, d_consttime, aux, ctx) == 0) ||\n\t    (BN_sub(aux, rsa_p, BN_value_one()) == 0) ||\n\t    (BN_mod(rsa_dmp1, d_consttime, aux, ctx) == 0)) {\n\t\tr = SSH_ERR_LIBCRYPTO_ERROR;\n\t\tgoto out;\n\t}\n\tif (!RSA_set0_crt_params(key->rsa, rsa_dmp1, rsa_dmq1, rsa_iqmp)) {\n\t\tr = SSH_ERR_LIBCRYPTO_ERROR;\n\t\tgoto out;\n\t}\n\trsa_dmp1 = rsa_dmq1 = rsa_iqmp = NULL; /* transferred */\n\t/* success */\n\tr = 0;\n out:\n\tBN_clear_free(aux);\n\tBN_clear_free(d_consttime);\n\tBN_clear_free(rsa_dmp1);\n\tBN_clear_free(rsa_dmq1);\n\tBN_clear_free(rsa_iqmp);\n\tBN_CTX_free(ctx);\n\treturn r;\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"log.h\"",
      "#include \"digest.h\"",
      "#include \"sshkey.h\"",
      "#include \"ssherr.h\"",
      "#include \"compat.h\"",
      "#include \"sshbuf.h\"",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <openssl/err.h>",
      "#include <openssl/evp.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_CTX_free",
          "args": [
            "ctx"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "rsa_iqmp"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "rsa_dmq1"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "rsa_dmp1"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "d_consttime"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "aux"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RSA_set0_crt_params",
          "args": [
            "key->rsa",
            "rsa_dmp1",
            "rsa_dmq1",
            "rsa_iqmp"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "RSA_set0_crt_params",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "281-303",
          "snippet": "int\nRSA_set0_crt_params(RSA *r, BIGNUM *dmp1, BIGNUM *dmq1, BIGNUM *iqmp)\n{\n\tif ((r->dmp1 == NULL && dmp1 == NULL) ||\n\t    (r->dmq1 == NULL && dmq1 == NULL) ||\n\t    (r->iqmp == NULL && iqmp == NULL))\n\t       \treturn 0;\n\n\tif (dmp1 != NULL) {\n\t\tBN_free(r->dmp1);\n\t\tr->dmp1 = dmp1;\n\t}\n\tif (dmq1 != NULL) {\n\t\tBN_free(r->dmq1);\n\t\tr->dmq1 = dmq1;\n\t}\n\tif (iqmp != NULL) {\n\t\tBN_free(r->iqmp);\n\t\tr->iqmp = iqmp;\n\t}\n\n\treturn 1;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nRSA_set0_crt_params(RSA *r, BIGNUM *dmp1, BIGNUM *dmq1, BIGNUM *iqmp)\n{\n\tif ((r->dmp1 == NULL && dmp1 == NULL) ||\n\t    (r->dmq1 == NULL && dmq1 == NULL) ||\n\t    (r->iqmp == NULL && iqmp == NULL))\n\t       \treturn 0;\n\n\tif (dmp1 != NULL) {\n\t\tBN_free(r->dmp1);\n\t\tr->dmp1 = dmp1;\n\t}\n\tif (dmq1 != NULL) {\n\t\tBN_free(r->dmq1);\n\t\tr->dmq1 = dmq1;\n\t}\n\tif (iqmp != NULL) {\n\t\tBN_free(r->iqmp);\n\t\tr->iqmp = iqmp;\n\t}\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_mod",
          "args": [
            "rsa_dmp1",
            "d_consttime",
            "aux",
            "ctx"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_sub",
          "args": [
            "aux",
            "rsa_p",
            "BN_value_one()"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_value_one",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_mod",
          "args": [
            "rsa_dmq1",
            "d_consttime",
            "aux",
            "ctx"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_sub",
          "args": [
            "aux",
            "rsa_q",
            "BN_value_one()"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_value_one",
          "args": [],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_set_flags",
          "args": [
            "d_consttime",
            "BN_FLG_CONSTTIME"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_set_flags",
          "args": [
            "aux",
            "BN_FLG_CONSTTIME"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_dup",
          "args": [
            "iqmp"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_dup",
          "args": [
            "rsa_d"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_CTX_new",
          "args": [],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RSA_get0_factors",
          "args": [
            "key->rsa",
            "&rsa_p",
            "&rsa_q"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "RSA_get0_factors",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "307-314",
          "snippet": "void\nRSA_get0_factors(const RSA *r, const BIGNUM **p, const BIGNUM **q)\n{\n\tif (p != NULL)\n\t\t*p = r->p;\n\tif (q != NULL)\n\t\t*q = r->q;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nRSA_get0_factors(const RSA *r, const BIGNUM **p, const BIGNUM **q)\n{\n\tif (p != NULL)\n\t\t*p = r->p;\n\tif (q != NULL)\n\t\t*q = r->q;\n}"
        }
      },
      {
        "call_info": {
          "callee": "RSA_get0_key",
          "args": [
            "key->rsa",
            "NULL",
            "NULL",
            "&rsa_d"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "RSA_get0_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "230-239",
          "snippet": "void\nRSA_get0_key(const RSA *r, const BIGNUM **n, const BIGNUM **e, const BIGNUM **d)\n{\n\tif (n != NULL)\n\t\t*n = r->n;\n\tif (e != NULL)\n\t\t*e = r->e;\n\tif (d != NULL)\n\t\t*d = r->d;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nRSA_get0_key(const RSA *r, const BIGNUM **n, const BIGNUM **e, const BIGNUM **d)\n{\n\tif (n != NULL)\n\t\t*n = r->n;\n\tif (e != NULL)\n\t\t*e = r->e;\n\tif (d != NULL)\n\t\t*d = r->d;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshkey_type_plain",
          "args": [
            "key->type"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "sshkey_type_plain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshkey.c",
          "lines": "341-358",
          "snippet": "int\nsshkey_type_plain(int type)\n{\n\tswitch (type) {\n\tcase KEY_RSA_CERT:\n\t\treturn KEY_RSA;\n\tcase KEY_DSA_CERT:\n\t\treturn KEY_DSA;\n\tcase KEY_ECDSA_CERT:\n\t\treturn KEY_ECDSA;\n\tcase KEY_ED25519_CERT:\n\t\treturn KEY_ED25519;\n\tcase KEY_XMSS_CERT:\n\t\treturn KEY_XMSS;\n\tdefault:\n\t\treturn type;\n\t}\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"xmss_fast.h\"",
            "#include \"match.h\"",
            "#include \"sshkey-xmss.h\"",
            "#include \"sshkey.h\"",
            "#include \"digest.h\"",
            "#include \"cipher.h\"",
            "#include \"sshbuf.h\"",
            "#include \"misc.h\"",
            "#include \"ssherr.h\"",
            "#include \"ssh2.h\"",
            "#include <util.h>",
            "#include <resolv.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include \"crypto_api.h\"",
            "#include <openssl/pem.h>",
            "#include <openssl/err.h>",
            "#include <openssl/evp.h>",
            "#include <netinet/in.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"xmss_fast.h\"\n#include \"match.h\"\n#include \"sshkey-xmss.h\"\n#include \"sshkey.h\"\n#include \"digest.h\"\n#include \"cipher.h\"\n#include \"sshbuf.h\"\n#include \"misc.h\"\n#include \"ssherr.h\"\n#include \"ssh2.h\"\n#include <util.h>\n#include <resolv.h>\n#include <string.h>\n#include <stdio.h>\n#include <limits.h>\n#include <errno.h>\n#include \"crypto_api.h\"\n#include <openssl/pem.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <netinet/in.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshkey_type_plain(int type)\n{\n\tswitch (type) {\n\tcase KEY_RSA_CERT:\n\t\treturn KEY_RSA;\n\tcase KEY_DSA_CERT:\n\t\treturn KEY_DSA;\n\tcase KEY_ECDSA_CERT:\n\t\treturn KEY_ECDSA;\n\tcase KEY_ED25519_CERT:\n\t\treturn KEY_ED25519;\n\tcase KEY_XMSS_CERT:\n\t\treturn KEY_XMSS;\n\tdefault:\n\t\treturn type;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"log.h\"\n#include \"digest.h\"\n#include \"sshkey.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <stdarg.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_rsa_complete_crt_parameters(struct sshkey *key, const BIGNUM *iqmp)\n{\n\tconst BIGNUM *rsa_p, *rsa_q, *rsa_d;\n\tBIGNUM *aux = NULL, *d_consttime = NULL;\n\tBIGNUM *rsa_dmq1 = NULL, *rsa_dmp1 = NULL, *rsa_iqmp = NULL;\n\tBN_CTX *ctx = NULL;\n\tint r;\n\n\tif (key == NULL || key->rsa == NULL ||\n\t    sshkey_type_plain(key->type) != KEY_RSA)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\n\tRSA_get0_key(key->rsa, NULL, NULL, &rsa_d);\n\tRSA_get0_factors(key->rsa, &rsa_p, &rsa_q);\n\n\tif ((ctx = BN_CTX_new()) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif ((aux = BN_new()) == NULL ||\n\t    (rsa_dmq1 = BN_new()) == NULL ||\n\t    (rsa_dmp1 = BN_new()) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif ((d_consttime = BN_dup(rsa_d)) == NULL ||\n\t    (rsa_iqmp = BN_dup(iqmp)) == NULL) {\n\t\tr = SSH_ERR_ALLOC_FAIL;\n\t\tgoto out;\n\t}\n\tBN_set_flags(aux, BN_FLG_CONSTTIME);\n\tBN_set_flags(d_consttime, BN_FLG_CONSTTIME);\n\n\tif ((BN_sub(aux, rsa_q, BN_value_one()) == 0) ||\n\t    (BN_mod(rsa_dmq1, d_consttime, aux, ctx) == 0) ||\n\t    (BN_sub(aux, rsa_p, BN_value_one()) == 0) ||\n\t    (BN_mod(rsa_dmp1, d_consttime, aux, ctx) == 0)) {\n\t\tr = SSH_ERR_LIBCRYPTO_ERROR;\n\t\tgoto out;\n\t}\n\tif (!RSA_set0_crt_params(key->rsa, rsa_dmp1, rsa_dmq1, rsa_iqmp)) {\n\t\tr = SSH_ERR_LIBCRYPTO_ERROR;\n\t\tgoto out;\n\t}\n\trsa_dmp1 = rsa_dmq1 = rsa_iqmp = NULL; /* transferred */\n\t/* success */\n\tr = 0;\n out:\n\tBN_clear_free(aux);\n\tBN_clear_free(d_consttime);\n\tBN_clear_free(rsa_dmp1);\n\tBN_clear_free(rsa_dmq1);\n\tBN_clear_free(rsa_iqmp);\n\tBN_CTX_free(ctx);\n\treturn r;\n}"
  },
  {
    "function_name": "rsa_hash_alg_nid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-rsa.c",
    "lines": "93-106",
    "snippet": "static int\nrsa_hash_alg_nid(int type)\n{\n\tswitch (type) {\n\tcase SSH_DIGEST_SHA1:\n\t\treturn NID_sha1;\n\tcase SSH_DIGEST_SHA256:\n\t\treturn NID_sha256;\n\tcase SSH_DIGEST_SHA512:\n\t\treturn NID_sha512;\n\tdefault:\n\t\treturn -1;\n\t}\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"log.h\"",
      "#include \"digest.h\"",
      "#include \"sshkey.h\"",
      "#include \"ssherr.h\"",
      "#include \"compat.h\"",
      "#include \"sshbuf.h\"",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <openssl/err.h>",
      "#include <openssl/evp.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"log.h\"\n#include \"digest.h\"\n#include \"sshkey.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <stdarg.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nrsa_hash_alg_nid(int type)\n{\n\tswitch (type) {\n\tcase SSH_DIGEST_SHA1:\n\t\treturn NID_sha1;\n\tcase SSH_DIGEST_SHA256:\n\t\treturn NID_sha256;\n\tcase SSH_DIGEST_SHA512:\n\t\treturn NID_sha512;\n\tdefault:\n\t\treturn -1;\n\t}\n}"
  },
  {
    "function_name": "rsa_hash_id_from_keyname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-rsa.c",
    "lines": "77-91",
    "snippet": "static int\nrsa_hash_id_from_keyname(const char *alg)\n{\n\tint r;\n\n\tif ((r = rsa_hash_id_from_ident(alg)) != -1)\n\t\treturn r;\n\tif (strcmp(alg, \"ssh-rsa-cert-v01@openssh.com\") == 0)\n\t\treturn SSH_DIGEST_SHA1;\n\tif (strcmp(alg, \"rsa-sha2-256-cert-v01@openssh.com\") == 0)\n\t\treturn SSH_DIGEST_SHA256;\n\tif (strcmp(alg, \"rsa-sha2-512-cert-v01@openssh.com\") == 0)\n\t\treturn SSH_DIGEST_SHA512;\n\treturn -1;\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"log.h\"",
      "#include \"digest.h\"",
      "#include \"sshkey.h\"",
      "#include \"ssherr.h\"",
      "#include \"compat.h\"",
      "#include \"sshbuf.h\"",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <openssl/err.h>",
      "#include <openssl/evp.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "alg",
            "\"rsa-sha2-512-cert-v01@openssh.com\""
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_maybe_null",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "1550-1558",
          "snippet": "static int\nstrcmp_maybe_null(const char *a, const char *b)\n{\n\tif ((a == NULL && b != NULL) || (a != NULL && b == NULL))\n\t\treturn 0;\n\tif (a != NULL && strcmp(a, b) != 0)\n\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nstrcmp_maybe_null(const char *a, const char *b)\n{\n\tif ((a == NULL && b != NULL) || (a != NULL && b == NULL))\n\t\treturn 0;\n\tif (a != NULL && strcmp(a, b) != 0)\n\t\treturn 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rsa_hash_id_from_ident",
          "args": [
            "alg"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "rsa_hash_id_from_ident",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-rsa.c",
          "lines": "60-70",
          "snippet": "static int\nrsa_hash_id_from_ident(const char *ident)\n{\n\tif (strcmp(ident, \"ssh-rsa\") == 0)\n\t\treturn SSH_DIGEST_SHA1;\n\tif (strcmp(ident, \"rsa-sha2-256\") == 0)\n\t\treturn SSH_DIGEST_SHA256;\n\tif (strcmp(ident, \"rsa-sha2-512\") == 0)\n\t\treturn SSH_DIGEST_SHA512;\n\treturn -1;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"log.h\"",
            "#include \"digest.h\"",
            "#include \"sshkey.h\"",
            "#include \"ssherr.h\"",
            "#include \"compat.h\"",
            "#include \"sshbuf.h\"",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <openssl/err.h>",
            "#include <openssl/evp.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"log.h\"\n#include \"digest.h\"\n#include \"sshkey.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <stdarg.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nrsa_hash_id_from_ident(const char *ident)\n{\n\tif (strcmp(ident, \"ssh-rsa\") == 0)\n\t\treturn SSH_DIGEST_SHA1;\n\tif (strcmp(ident, \"rsa-sha2-256\") == 0)\n\t\treturn SSH_DIGEST_SHA256;\n\tif (strcmp(ident, \"rsa-sha2-512\") == 0)\n\t\treturn SSH_DIGEST_SHA512;\n\treturn -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"log.h\"\n#include \"digest.h\"\n#include \"sshkey.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <stdarg.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nrsa_hash_id_from_keyname(const char *alg)\n{\n\tint r;\n\n\tif ((r = rsa_hash_id_from_ident(alg)) != -1)\n\t\treturn r;\n\tif (strcmp(alg, \"ssh-rsa-cert-v01@openssh.com\") == 0)\n\t\treturn SSH_DIGEST_SHA1;\n\tif (strcmp(alg, \"rsa-sha2-256-cert-v01@openssh.com\") == 0)\n\t\treturn SSH_DIGEST_SHA256;\n\tif (strcmp(alg, \"rsa-sha2-512-cert-v01@openssh.com\") == 0)\n\t\treturn SSH_DIGEST_SHA512;\n\treturn -1;\n}"
  },
  {
    "function_name": "rsa_hash_id_from_ident",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-rsa.c",
    "lines": "60-70",
    "snippet": "static int\nrsa_hash_id_from_ident(const char *ident)\n{\n\tif (strcmp(ident, \"ssh-rsa\") == 0)\n\t\treturn SSH_DIGEST_SHA1;\n\tif (strcmp(ident, \"rsa-sha2-256\") == 0)\n\t\treturn SSH_DIGEST_SHA256;\n\tif (strcmp(ident, \"rsa-sha2-512\") == 0)\n\t\treturn SSH_DIGEST_SHA512;\n\treturn -1;\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"log.h\"",
      "#include \"digest.h\"",
      "#include \"sshkey.h\"",
      "#include \"ssherr.h\"",
      "#include \"compat.h\"",
      "#include \"sshbuf.h\"",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <openssl/err.h>",
      "#include <openssl/evp.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "ident",
            "\"rsa-sha2-512\""
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_maybe_null",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "1550-1558",
          "snippet": "static int\nstrcmp_maybe_null(const char *a, const char *b)\n{\n\tif ((a == NULL && b != NULL) || (a != NULL && b == NULL))\n\t\treturn 0;\n\tif (a != NULL && strcmp(a, b) != 0)\n\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nstrcmp_maybe_null(const char *a, const char *b)\n{\n\tif ((a == NULL && b != NULL) || (a != NULL && b == NULL))\n\t\treturn 0;\n\tif (a != NULL && strcmp(a, b) != 0)\n\t\treturn 0;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"log.h\"\n#include \"digest.h\"\n#include \"sshkey.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <stdarg.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nrsa_hash_id_from_ident(const char *ident)\n{\n\tif (strcmp(ident, \"ssh-rsa\") == 0)\n\t\treturn SSH_DIGEST_SHA1;\n\tif (strcmp(ident, \"rsa-sha2-256\") == 0)\n\t\treturn SSH_DIGEST_SHA256;\n\tif (strcmp(ident, \"rsa-sha2-512\") == 0)\n\t\treturn SSH_DIGEST_SHA512;\n\treturn -1;\n}"
  },
  {
    "function_name": "rsa_hash_alg_ident",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-rsa.c",
    "lines": "42-54",
    "snippet": "static const char *\nrsa_hash_alg_ident(int hash_alg)\n{\n\tswitch (hash_alg) {\n\tcase SSH_DIGEST_SHA1:\n\t\treturn \"ssh-rsa\";\n\tcase SSH_DIGEST_SHA256:\n\t\treturn \"rsa-sha2-256\";\n\tcase SSH_DIGEST_SHA512:\n\t\treturn \"rsa-sha2-512\";\n\t}\n\treturn NULL;\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"log.h\"",
      "#include \"digest.h\"",
      "#include \"sshkey.h\"",
      "#include \"ssherr.h\"",
      "#include \"compat.h\"",
      "#include \"sshbuf.h\"",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <openssl/err.h>",
      "#include <openssl/evp.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"log.h\"\n#include \"digest.h\"\n#include \"sshkey.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"sshbuf.h\"\n#include <string.h>\n#include <stdarg.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic const char *\nrsa_hash_alg_ident(int hash_alg)\n{\n\tswitch (hash_alg) {\n\tcase SSH_DIGEST_SHA1:\n\t\treturn \"ssh-rsa\";\n\tcase SSH_DIGEST_SHA256:\n\t\treturn \"rsa-sha2-256\";\n\tcase SSH_DIGEST_SHA512:\n\t\treturn \"rsa-sha2-512\";\n\t}\n\treturn NULL;\n}"
  }
]