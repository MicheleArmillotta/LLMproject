[
  {
    "function_name": "poly1305_auth",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/poly1305.c",
    "lines": "33-160",
    "snippet": "void\npoly1305_auth(unsigned char out[POLY1305_TAGLEN], const unsigned char *m, size_t inlen, const unsigned char key[POLY1305_KEYLEN]) {\n\tuint32_t t0,t1,t2,t3;\n\tuint32_t h0,h1,h2,h3,h4;\n\tuint32_t r0,r1,r2,r3,r4;\n\tuint32_t s1,s2,s3,s4;\n\tuint32_t b, nb;\n\tsize_t j;\n\tuint64_t t[5];\n\tuint64_t f0,f1,f2,f3;\n\tuint32_t g0,g1,g2,g3,g4;\n\tuint64_t c;\n\tunsigned char mp[16];\n\n\t/* clamp key */\n\tt0 = U8TO32_LE(key+0);\n\tt1 = U8TO32_LE(key+4);\n\tt2 = U8TO32_LE(key+8);\n\tt3 = U8TO32_LE(key+12);\n\n\t/* precompute multipliers */\n\tr0 = t0 & 0x3ffffff; t0 >>= 26; t0 |= t1 << 6;\n\tr1 = t0 & 0x3ffff03; t1 >>= 20; t1 |= t2 << 12;\n\tr2 = t1 & 0x3ffc0ff; t2 >>= 14; t2 |= t3 << 18;\n\tr3 = t2 & 0x3f03fff; t3 >>= 8;\n\tr4 = t3 & 0x00fffff;\n\n\ts1 = r1 * 5;\n\ts2 = r2 * 5;\n\ts3 = r3 * 5;\n\ts4 = r4 * 5;\n\n\t/* init state */\n\th0 = 0;\n\th1 = 0;\n\th2 = 0;\n\th3 = 0;\n\th4 = 0;\n\n\t/* full blocks */\n\tif (inlen < 16) goto poly1305_donna_atmost15bytes;\npoly1305_donna_16bytes:\n\tm += 16;\n\tinlen -= 16;\n\n\tt0 = U8TO32_LE(m-16);\n\tt1 = U8TO32_LE(m-12);\n\tt2 = U8TO32_LE(m-8);\n\tt3 = U8TO32_LE(m-4);\n\n\th0 += t0 & 0x3ffffff;\n\th1 += ((((uint64_t)t1 << 32) | t0) >> 26) & 0x3ffffff;\n\th2 += ((((uint64_t)t2 << 32) | t1) >> 20) & 0x3ffffff;\n\th3 += ((((uint64_t)t3 << 32) | t2) >> 14) & 0x3ffffff;\n\th4 += (t3 >> 8) | (1 << 24);\n\n\npoly1305_donna_mul:\n\tt[0]  = mul32x32_64(h0,r0) + mul32x32_64(h1,s4) + mul32x32_64(h2,s3) + mul32x32_64(h3,s2) + mul32x32_64(h4,s1);\n\tt[1]  = mul32x32_64(h0,r1) + mul32x32_64(h1,r0) + mul32x32_64(h2,s4) + mul32x32_64(h3,s3) + mul32x32_64(h4,s2);\n\tt[2]  = mul32x32_64(h0,r2) + mul32x32_64(h1,r1) + mul32x32_64(h2,r0) + mul32x32_64(h3,s4) + mul32x32_64(h4,s3);\n\tt[3]  = mul32x32_64(h0,r3) + mul32x32_64(h1,r2) + mul32x32_64(h2,r1) + mul32x32_64(h3,r0) + mul32x32_64(h4,s4);\n\tt[4]  = mul32x32_64(h0,r4) + mul32x32_64(h1,r3) + mul32x32_64(h2,r2) + mul32x32_64(h3,r1) + mul32x32_64(h4,r0);\n\n\t                h0 = (uint32_t)t[0] & 0x3ffffff; c =           (t[0] >> 26);\n\tt[1] += c;      h1 = (uint32_t)t[1] & 0x3ffffff; b = (uint32_t)(t[1] >> 26);\n\tt[2] += b;      h2 = (uint32_t)t[2] & 0x3ffffff; b = (uint32_t)(t[2] >> 26);\n\tt[3] += b;      h3 = (uint32_t)t[3] & 0x3ffffff; b = (uint32_t)(t[3] >> 26);\n\tt[4] += b;      h4 = (uint32_t)t[4] & 0x3ffffff; b = (uint32_t)(t[4] >> 26);\n\th0 += b * 5;\n\n\tif (inlen >= 16) goto poly1305_donna_16bytes;\n\n\t/* final bytes */\npoly1305_donna_atmost15bytes:\n\tif (!inlen) goto poly1305_donna_finish;\n\n\tfor (j = 0; j < inlen; j++) mp[j] = m[j];\n\tmp[j++] = 1;\n\tfor (; j < 16; j++)\tmp[j] = 0;\n\tinlen = 0;\n\n\tt0 = U8TO32_LE(mp+0);\n\tt1 = U8TO32_LE(mp+4);\n\tt2 = U8TO32_LE(mp+8);\n\tt3 = U8TO32_LE(mp+12);\n\n\th0 += t0 & 0x3ffffff;\n\th1 += ((((uint64_t)t1 << 32) | t0) >> 26) & 0x3ffffff;\n\th2 += ((((uint64_t)t2 << 32) | t1) >> 20) & 0x3ffffff;\n\th3 += ((((uint64_t)t3 << 32) | t2) >> 14) & 0x3ffffff;\n\th4 += (t3 >> 8);\n\n\tgoto poly1305_donna_mul;\n\npoly1305_donna_finish:\n\t             b = h0 >> 26; h0 = h0 & 0x3ffffff;\n\th1 +=     b; b = h1 >> 26; h1 = h1 & 0x3ffffff;\n\th2 +=     b; b = h2 >> 26; h2 = h2 & 0x3ffffff;\n\th3 +=     b; b = h3 >> 26; h3 = h3 & 0x3ffffff;\n\th4 +=     b; b = h4 >> 26; h4 = h4 & 0x3ffffff;\n\th0 += b * 5; b = h0 >> 26; h0 = h0 & 0x3ffffff;\n\th1 +=     b;\n\n\tg0 = h0 + 5; b = g0 >> 26; g0 &= 0x3ffffff;\n\tg1 = h1 + b; b = g1 >> 26; g1 &= 0x3ffffff;\n\tg2 = h2 + b; b = g2 >> 26; g2 &= 0x3ffffff;\n\tg3 = h3 + b; b = g3 >> 26; g3 &= 0x3ffffff;\n\tg4 = h4 + b - (1 << 26);\n\n\tb = (g4 >> 31) - 1;\n\tnb = ~b;\n\th0 = (h0 & nb) | (g0 & b);\n\th1 = (h1 & nb) | (g1 & b);\n\th2 = (h2 & nb) | (g2 & b);\n\th3 = (h3 & nb) | (g3 & b);\n\th4 = (h4 & nb) | (g4 & b);\n\n\tf0 = ((h0      ) | (h1 << 26)) + (uint64_t)U8TO32_LE(&key[16]);\n\tf1 = ((h1 >>  6) | (h2 << 20)) + (uint64_t)U8TO32_LE(&key[20]);\n\tf2 = ((h2 >> 12) | (h3 << 14)) + (uint64_t)U8TO32_LE(&key[24]);\n\tf3 = ((h3 >> 18) | (h4 <<  8)) + (uint64_t)U8TO32_LE(&key[28]);\n\n\tU32TO8_LE(&out[ 0], f0); f1 += (f0 >> 32);\n\tU32TO8_LE(&out[ 4], f1); f2 += (f1 >> 32);\n\tU32TO8_LE(&out[ 8], f2); f3 += (f2 >> 32);\n\tU32TO8_LE(&out[12], f3);\n}",
    "includes": [
      "#include \"poly1305.h\"",
      "# include <stdint.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "U32TO8_LE",
          "args": [
            "&out[12]",
            "f3"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U32TO8_LE",
          "args": [
            "&out[ 8]",
            "f2"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U32TO8_LE",
          "args": [
            "&out[ 4]",
            "f1"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U32TO8_LE",
          "args": [
            "&out[ 0]",
            "f0"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U8TO32_LE",
          "args": [
            "&key[28]"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U8TO32_LE",
          "args": [
            "&key[24]"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U8TO32_LE",
          "args": [
            "&key[20]"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U8TO32_LE",
          "args": [
            "&key[16]"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U8TO32_LE",
          "args": [
            "mp+12"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U8TO32_LE",
          "args": [
            "mp+8"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U8TO32_LE",
          "args": [
            "mp+4"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U8TO32_LE",
          "args": [
            "mp+0"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h4",
            "r0"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h3",
            "r1"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h2",
            "r2"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h1",
            "r3"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h0",
            "r4"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h4",
            "s4"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h3",
            "r0"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h2",
            "r1"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h1",
            "r2"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h0",
            "r3"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h4",
            "s3"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h3",
            "s4"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h2",
            "r0"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h1",
            "r1"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h0",
            "r2"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h4",
            "s2"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h3",
            "s3"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h2",
            "s4"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h1",
            "r0"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h0",
            "r1"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h4",
            "s1"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h3",
            "s2"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h2",
            "s3"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h1",
            "s4"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mul32x32_64",
          "args": [
            "h0",
            "r0"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U8TO32_LE",
          "args": [
            "m-4"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U8TO32_LE",
          "args": [
            "m-8"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U8TO32_LE",
          "args": [
            "m-12"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U8TO32_LE",
          "args": [
            "m-16"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U8TO32_LE",
          "args": [
            "key+12"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U8TO32_LE",
          "args": [
            "key+8"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U8TO32_LE",
          "args": [
            "key+4"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "U8TO32_LE",
          "args": [
            "key+0"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"poly1305.h\"\n# include <stdint.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\npoly1305_auth(unsigned char out[POLY1305_TAGLEN], const unsigned char *m, size_t inlen, const unsigned char key[POLY1305_KEYLEN]) {\n\tuint32_t t0,t1,t2,t3;\n\tuint32_t h0,h1,h2,h3,h4;\n\tuint32_t r0,r1,r2,r3,r4;\n\tuint32_t s1,s2,s3,s4;\n\tuint32_t b, nb;\n\tsize_t j;\n\tuint64_t t[5];\n\tuint64_t f0,f1,f2,f3;\n\tuint32_t g0,g1,g2,g3,g4;\n\tuint64_t c;\n\tunsigned char mp[16];\n\n\t/* clamp key */\n\tt0 = U8TO32_LE(key+0);\n\tt1 = U8TO32_LE(key+4);\n\tt2 = U8TO32_LE(key+8);\n\tt3 = U8TO32_LE(key+12);\n\n\t/* precompute multipliers */\n\tr0 = t0 & 0x3ffffff; t0 >>= 26; t0 |= t1 << 6;\n\tr1 = t0 & 0x3ffff03; t1 >>= 20; t1 |= t2 << 12;\n\tr2 = t1 & 0x3ffc0ff; t2 >>= 14; t2 |= t3 << 18;\n\tr3 = t2 & 0x3f03fff; t3 >>= 8;\n\tr4 = t3 & 0x00fffff;\n\n\ts1 = r1 * 5;\n\ts2 = r2 * 5;\n\ts3 = r3 * 5;\n\ts4 = r4 * 5;\n\n\t/* init state */\n\th0 = 0;\n\th1 = 0;\n\th2 = 0;\n\th3 = 0;\n\th4 = 0;\n\n\t/* full blocks */\n\tif (inlen < 16) goto poly1305_donna_atmost15bytes;\npoly1305_donna_16bytes:\n\tm += 16;\n\tinlen -= 16;\n\n\tt0 = U8TO32_LE(m-16);\n\tt1 = U8TO32_LE(m-12);\n\tt2 = U8TO32_LE(m-8);\n\tt3 = U8TO32_LE(m-4);\n\n\th0 += t0 & 0x3ffffff;\n\th1 += ((((uint64_t)t1 << 32) | t0) >> 26) & 0x3ffffff;\n\th2 += ((((uint64_t)t2 << 32) | t1) >> 20) & 0x3ffffff;\n\th3 += ((((uint64_t)t3 << 32) | t2) >> 14) & 0x3ffffff;\n\th4 += (t3 >> 8) | (1 << 24);\n\n\npoly1305_donna_mul:\n\tt[0]  = mul32x32_64(h0,r0) + mul32x32_64(h1,s4) + mul32x32_64(h2,s3) + mul32x32_64(h3,s2) + mul32x32_64(h4,s1);\n\tt[1]  = mul32x32_64(h0,r1) + mul32x32_64(h1,r0) + mul32x32_64(h2,s4) + mul32x32_64(h3,s3) + mul32x32_64(h4,s2);\n\tt[2]  = mul32x32_64(h0,r2) + mul32x32_64(h1,r1) + mul32x32_64(h2,r0) + mul32x32_64(h3,s4) + mul32x32_64(h4,s3);\n\tt[3]  = mul32x32_64(h0,r3) + mul32x32_64(h1,r2) + mul32x32_64(h2,r1) + mul32x32_64(h3,r0) + mul32x32_64(h4,s4);\n\tt[4]  = mul32x32_64(h0,r4) + mul32x32_64(h1,r3) + mul32x32_64(h2,r2) + mul32x32_64(h3,r1) + mul32x32_64(h4,r0);\n\n\t                h0 = (uint32_t)t[0] & 0x3ffffff; c =           (t[0] >> 26);\n\tt[1] += c;      h1 = (uint32_t)t[1] & 0x3ffffff; b = (uint32_t)(t[1] >> 26);\n\tt[2] += b;      h2 = (uint32_t)t[2] & 0x3ffffff; b = (uint32_t)(t[2] >> 26);\n\tt[3] += b;      h3 = (uint32_t)t[3] & 0x3ffffff; b = (uint32_t)(t[3] >> 26);\n\tt[4] += b;      h4 = (uint32_t)t[4] & 0x3ffffff; b = (uint32_t)(t[4] >> 26);\n\th0 += b * 5;\n\n\tif (inlen >= 16) goto poly1305_donna_16bytes;\n\n\t/* final bytes */\npoly1305_donna_atmost15bytes:\n\tif (!inlen) goto poly1305_donna_finish;\n\n\tfor (j = 0; j < inlen; j++) mp[j] = m[j];\n\tmp[j++] = 1;\n\tfor (; j < 16; j++)\tmp[j] = 0;\n\tinlen = 0;\n\n\tt0 = U8TO32_LE(mp+0);\n\tt1 = U8TO32_LE(mp+4);\n\tt2 = U8TO32_LE(mp+8);\n\tt3 = U8TO32_LE(mp+12);\n\n\th0 += t0 & 0x3ffffff;\n\th1 += ((((uint64_t)t1 << 32) | t0) >> 26) & 0x3ffffff;\n\th2 += ((((uint64_t)t2 << 32) | t1) >> 20) & 0x3ffffff;\n\th3 += ((((uint64_t)t3 << 32) | t2) >> 14) & 0x3ffffff;\n\th4 += (t3 >> 8);\n\n\tgoto poly1305_donna_mul;\n\npoly1305_donna_finish:\n\t             b = h0 >> 26; h0 = h0 & 0x3ffffff;\n\th1 +=     b; b = h1 >> 26; h1 = h1 & 0x3ffffff;\n\th2 +=     b; b = h2 >> 26; h2 = h2 & 0x3ffffff;\n\th3 +=     b; b = h3 >> 26; h3 = h3 & 0x3ffffff;\n\th4 +=     b; b = h4 >> 26; h4 = h4 & 0x3ffffff;\n\th0 += b * 5; b = h0 >> 26; h0 = h0 & 0x3ffffff;\n\th1 +=     b;\n\n\tg0 = h0 + 5; b = g0 >> 26; g0 &= 0x3ffffff;\n\tg1 = h1 + b; b = g1 >> 26; g1 &= 0x3ffffff;\n\tg2 = h2 + b; b = g2 >> 26; g2 &= 0x3ffffff;\n\tg3 = h3 + b; b = g3 >> 26; g3 &= 0x3ffffff;\n\tg4 = h4 + b - (1 << 26);\n\n\tb = (g4 >> 31) - 1;\n\tnb = ~b;\n\th0 = (h0 & nb) | (g0 & b);\n\th1 = (h1 & nb) | (g1 & b);\n\th2 = (h2 & nb) | (g2 & b);\n\th3 = (h3 & nb) | (g3 & b);\n\th4 = (h4 & nb) | (g4 & b);\n\n\tf0 = ((h0      ) | (h1 << 26)) + (uint64_t)U8TO32_LE(&key[16]);\n\tf1 = ((h1 >>  6) | (h2 << 20)) + (uint64_t)U8TO32_LE(&key[20]);\n\tf2 = ((h2 >> 12) | (h3 << 14)) + (uint64_t)U8TO32_LE(&key[24]);\n\tf3 = ((h3 >> 18) | (h4 <<  8)) + (uint64_t)U8TO32_LE(&key[28]);\n\n\tU32TO8_LE(&out[ 0], f0); f1 += (f0 >> 32);\n\tU32TO8_LE(&out[ 4], f1); f2 += (f1 >> 32);\n\tU32TO8_LE(&out[ 8], f2); f3 += (f2 >> 32);\n\tU32TO8_LE(&out[12], f3);\n}"
  }
]