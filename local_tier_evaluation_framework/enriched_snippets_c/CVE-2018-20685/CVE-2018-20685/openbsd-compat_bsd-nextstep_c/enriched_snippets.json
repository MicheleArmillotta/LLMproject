[
  {
    "function_name": "cfsetispeed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-nextstep.c",
    "lines": "97-102",
    "snippet": "int\ncfsetispeed(struct termios *t, int speed)\n{\n\tt->c_ispeed = speed;\n\treturn (0);\n}",
    "includes": [
      "#include \"bsd-nextstep.h\"",
      "#include <sys/wait.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bsd-nextstep.h\"\n#include <sys/wait.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\ncfsetispeed(struct termios *t, int speed)\n{\n\tt->c_ispeed = speed;\n\treturn (0);\n}"
  },
  {
    "function_name": "cfsetospeed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-nextstep.c",
    "lines": "90-95",
    "snippet": "int\ncfsetospeed(struct termios *t,int speed)\n{\n\tt->c_ospeed = speed;\n\treturn (0);\n}",
    "includes": [
      "#include \"bsd-nextstep.h\"",
      "#include <sys/wait.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bsd-nextstep.h\"\n#include <sys/wait.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\ncfsetospeed(struct termios *t,int speed)\n{\n\tt->c_ospeed = speed;\n\treturn (0);\n}"
  },
  {
    "function_name": "cfgetispeed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-nextstep.c",
    "lines": "85-88",
    "snippet": "speed_t cfgetispeed(const struct termios *t)\n{\n\treturn (t->c_ispeed);\n}",
    "includes": [
      "#include \"bsd-nextstep.h\"",
      "#include <sys/wait.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bsd-nextstep.h\"\n#include <sys/wait.h>\n#include <errno.h>\n#include \"includes.h\"\n\nspeed_t cfgetispeed(const struct termios *t)\n{\n\treturn (t->c_ispeed);\n}"
  },
  {
    "function_name": "cfgetospeed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-nextstep.c",
    "lines": "80-83",
    "snippet": "speed_t cfgetospeed(const struct termios *t)\n{\n\treturn (t->c_ospeed);\n}",
    "includes": [
      "#include \"bsd-nextstep.h\"",
      "#include <sys/wait.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bsd-nextstep.h\"\n#include <sys/wait.h>\n#include <errno.h>\n#include \"includes.h\"\n\nspeed_t cfgetospeed(const struct termios *t)\n{\n\treturn (t->c_ospeed);\n}"
  },
  {
    "function_name": "tcsetpgrp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-nextstep.c",
    "lines": "75-78",
    "snippet": "int tcsetpgrp(int fd, pid_t pgrp)\n{\n\treturn (ioctl(fd, TIOCSPGRP, &pgrp));\n}",
    "includes": [
      "#include \"bsd-nextstep.h\"",
      "#include <sys/wait.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "TIOCSPGRP",
            "&pgrp"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bsd-nextstep.h\"\n#include <sys/wait.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint tcsetpgrp(int fd, pid_t pgrp)\n{\n\treturn (ioctl(fd, TIOCSPGRP, &pgrp));\n}"
  },
  {
    "function_name": "tcsetattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-nextstep.c",
    "lines": "52-73",
    "snippet": "int\ntcsetattr(int fd, int opt, const struct termios *t)\n{\n\tstruct termios localterm;\n\n\tif (opt & TCSASOFT) {\n\t\tlocalterm = *t;\n\t\tlocalterm.c_cflag |= CIGNORE;\n\t\tt = &localterm;\n\t}\n\tswitch (opt & ~TCSASOFT) {\n\tcase TCSANOW:\n\t\treturn (ioctl(fd, TIOCSETA, t));\n\tcase TCSADRAIN:\n\t\treturn (ioctl(fd, TIOCSETAW, t));\n\tcase TCSAFLUSH:\n\t\treturn (ioctl(fd, TIOCSETAF, t));\n\tdefault:\n\t\terrno = EINVAL;\n\t\treturn (-1);\n\t}\n}",
    "includes": [
      "#include \"bsd-nextstep.h\"",
      "#include <sys/wait.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "TIOCSETAF",
            "t"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "TIOCSETAW",
            "t"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "TIOCSETA",
            "t"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bsd-nextstep.h\"\n#include <sys/wait.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\ntcsetattr(int fd, int opt, const struct termios *t)\n{\n\tstruct termios localterm;\n\n\tif (opt & TCSASOFT) {\n\t\tlocalterm = *t;\n\t\tlocalterm.c_cflag |= CIGNORE;\n\t\tt = &localterm;\n\t}\n\tswitch (opt & ~TCSASOFT) {\n\tcase TCSANOW:\n\t\treturn (ioctl(fd, TIOCSETA, t));\n\tcase TCSADRAIN:\n\t\treturn (ioctl(fd, TIOCSETAW, t));\n\tcase TCSAFLUSH:\n\t\treturn (ioctl(fd, TIOCSETAF, t));\n\tdefault:\n\t\terrno = EINVAL;\n\t\treturn (-1);\n\t}\n}"
  },
  {
    "function_name": "tcgetattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-nextstep.c",
    "lines": "46-50",
    "snippet": "int\ntcgetattr(int fd, struct termios *t)\n{\n\treturn (ioctl(fd, TIOCGETA, t));\n}",
    "includes": [
      "#include \"bsd-nextstep.h\"",
      "#include <sys/wait.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "TIOCGETA",
            "t"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bsd-nextstep.h\"\n#include <sys/wait.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\ntcgetattr(int fd, struct termios *t)\n{\n\treturn (ioctl(fd, TIOCGETA, t));\n}"
  },
  {
    "function_name": "posix_wait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-nextstep.c",
    "lines": "32-44",
    "snippet": "pid_t\nposix_wait(int *status)\n{\n\tunion wait statusp;\n\tpid_t wait_pid;\n\n\t#undef wait\t\t\t/* Use NeXT's wait() function */\n\twait_pid = wait(&statusp);\n\tif (status)\n\t\t*status = (int) statusp.w_status;\n\n\treturn (wait_pid);\n}",
    "includes": [
      "#include \"bsd-nextstep.h\"",
      "#include <sys/wait.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait",
          "args": [
            "&statusp"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "posix_wait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-nextstep.c",
          "lines": "32-44",
          "snippet": "pid_t\nposix_wait(int *status)\n{\n\tunion wait statusp;\n\tpid_t wait_pid;\n\n\t#undef wait\t\t\t/* Use NeXT's wait() function */\n\twait_pid = wait(&statusp);\n\tif (status)\n\t\t*status = (int) statusp.w_status;\n\n\treturn (wait_pid);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"bsd-nextstep.h\"\n#include <sys/wait.h>\n#include <errno.h>\n#include \"includes.h\"\n\npid_t\nposix_wait(int *status)\n{\n\tunion wait statusp;\n\tpid_t wait_pid;\n\n\t#undef wait\t\t\t/* Use NeXT's wait() function */\n\twait_pid = wait(&statusp);\n\tif (status)\n\t\t*status = (int) statusp.w_status;\n\n\treturn (wait_pid);\n}"
  }
]