[
  {
    "function_name": "bitmap_from_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
    "lines": "188-214",
    "snippet": "int\nbitmap_from_string(struct bitmap *b, const void *p, size_t l)\n{\n\tint r;\n\tsize_t i, offset, shift;\n\tconst u_char *s = (const u_char *)p;\n\n\tif (l > BITMAP_MAX / 8)\n\t\treturn -1;\n\tif ((r = reserve(b, l * 8)) != 0)\n\t\treturn r;\n\tbitmap_zero(b);\n\tif (l == 0)\n\t\treturn 0;\n\tb->top = offset = ((l + (BITMAP_BYTES - 1)) / BITMAP_BYTES) - 1;\n\tshift = ((l + (BITMAP_BYTES - 1)) % BITMAP_BYTES) * 8;\n\tfor (i = 0; i < l; i++) {\n\t\tb->d[offset] |= (BITMAP_WTYPE)s[i] << shift;\n\t\tif (shift == 0) {\n\t\t\toffset--;\n\t\t\tshift = BITMAP_BITS - 8;\n\t\t} else\n\t\t\tshift -= 8;\n\t}\n\tretop(b);\n\treturn 0;\n}",
    "includes": [
      "#include \"bitmap.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)",
      "#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))",
      "#define BITMAP_MAX\t(1<<24)",
      "#define BITMAP_WTYPE\tu_int"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "retop",
          "args": [
            "b"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "retop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "116-123",
          "snippet": "static void\nretop(struct bitmap *b)\n{\n\tif (b->top >= b->len)\n\t\treturn;\n\twhile (b->top > 0 && b->d[b->top] == 0)\n\t\tb->top--;\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic void\nretop(struct bitmap *b)\n{\n\tif (b->top >= b->len)\n\t\treturn;\n\twhile (b->top > 0 && b->d[b->top] == 0)\n\t\tb->top--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bitmap_zero",
          "args": [
            "b"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "bitmap_zero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "64-69",
          "snippet": "void\nbitmap_zero(struct bitmap *b)\n{\n\tmemset(b->d, 0, b->len * BITMAP_BYTES);\n\tb->top = 0;\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))\n\nvoid\nbitmap_zero(struct bitmap *b)\n{\n\tmemset(b->d, 0, b->len * BITMAP_BYTES);\n\tb->top = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "reserve",
          "args": [
            "b",
            "l * 8"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "reserve",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "81-98",
          "snippet": "static int\nreserve(struct bitmap *b, u_int n)\n{\n\tBITMAP_WTYPE *tmp;\n\tsize_t nlen;\n\n\tif (b->top >= b->len || n > BITMAP_MAX)\n\t\treturn -1; /* invalid */\n\tnlen = (n / BITMAP_BITS) + 1;\n\tif (b->len < nlen) {\n\t\tif ((tmp = recallocarray(b->d, b->len,\n\t\t    nlen, BITMAP_BYTES)) == NULL)\n\t\t\treturn -1;\n\t\tb->d = tmp;\n\t\tb->len = nlen;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)",
            "#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))",
            "#define BITMAP_MAX\t(1<<24)",
            "#define BITMAP_WTYPE\tu_int"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)\n#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))\n#define BITMAP_MAX\t(1<<24)\n#define BITMAP_WTYPE\tu_int\n\nstatic int\nreserve(struct bitmap *b, u_int n)\n{\n\tBITMAP_WTYPE *tmp;\n\tsize_t nlen;\n\n\tif (b->top >= b->len || n > BITMAP_MAX)\n\t\treturn -1; /* invalid */\n\tnlen = (n / BITMAP_BITS) + 1;\n\tif (b->len < nlen) {\n\t\tif ((tmp = recallocarray(b->d, b->len,\n\t\t    nlen, BITMAP_BYTES)) == NULL)\n\t\t\treturn -1;\n\t\tb->d = tmp;\n\t\tb->len = nlen;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)\n#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))\n#define BITMAP_MAX\t(1<<24)\n#define BITMAP_WTYPE\tu_int\n\nint\nbitmap_from_string(struct bitmap *b, const void *p, size_t l)\n{\n\tint r;\n\tsize_t i, offset, shift;\n\tconst u_char *s = (const u_char *)p;\n\n\tif (l > BITMAP_MAX / 8)\n\t\treturn -1;\n\tif ((r = reserve(b, l * 8)) != 0)\n\t\treturn r;\n\tbitmap_zero(b);\n\tif (l == 0)\n\t\treturn 0;\n\tb->top = offset = ((l + (BITMAP_BYTES - 1)) / BITMAP_BYTES) - 1;\n\tshift = ((l + (BITMAP_BYTES - 1)) % BITMAP_BYTES) * 8;\n\tfor (i = 0; i < l; i++) {\n\t\tb->d[offset] |= (BITMAP_WTYPE)s[i] << shift;\n\t\tif (shift == 0) {\n\t\t\toffset--;\n\t\t\tshift = BITMAP_BITS - 8;\n\t\t} else\n\t\t\tshift -= 8;\n\t}\n\tretop(b);\n\treturn 0;\n}"
  },
  {
    "function_name": "bitmap_to_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
    "lines": "167-186",
    "snippet": "int\nbitmap_to_string(struct bitmap *b, void *p, size_t l)\n{\n\tu_char *s = (u_char *)p;\n\tsize_t i, j, k, need = bitmap_nbytes(b);\n\n\tif (l < need || b->top >= b->len)\n\t\treturn -1;\n\tif (l > need)\n\t\tl = need;\n\t/* Put the bytes from LSB backwards */\n\tfor (i = k = 0; i < b->top + 1; i++) {\n\t\tfor (j = 0; j < BITMAP_BYTES; j++) {\n\t\t\tif (k >= l)\n\t\t\t\tbreak;\n\t\t\ts[need - 1 - k++] = (b->d[i] >> (j * 8)) & 0xff;\n\t\t}\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"bitmap.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bitmap_nbytes",
          "args": [
            "b"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "bitmap_nbytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "161-165",
          "snippet": "size_t\nbitmap_nbytes(struct bitmap *b)\n{\n\treturn (bitmap_nbits(b) + 7) / 8;\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nbitmap_nbytes(struct bitmap *b)\n{\n\treturn (bitmap_nbits(b) + 7) / 8;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))\n\nint\nbitmap_to_string(struct bitmap *b, void *p, size_t l)\n{\n\tu_char *s = (u_char *)p;\n\tsize_t i, j, k, need = bitmap_nbytes(b);\n\n\tif (l < need || b->top >= b->len)\n\t\treturn -1;\n\tif (l > need)\n\t\tl = need;\n\t/* Put the bytes from LSB backwards */\n\tfor (i = k = 0; i < b->top + 1; i++) {\n\t\tfor (j = 0; j < BITMAP_BYTES; j++) {\n\t\t\tif (k >= l)\n\t\t\t\tbreak;\n\t\t\ts[need - 1 - k++] = (b->d[i] >> (j * 8)) & 0xff;\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "bitmap_nbytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
    "lines": "161-165",
    "snippet": "size_t\nbitmap_nbytes(struct bitmap *b)\n{\n\treturn (bitmap_nbits(b) + 7) / 8;\n}",
    "includes": [
      "#include \"bitmap.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bitmap_nbits",
          "args": [
            "b"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "bitmap_nbits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "140-159",
          "snippet": "size_t\nbitmap_nbits(struct bitmap *b)\n{\n\tsize_t bits;\n\tBITMAP_WTYPE w;\n\n\tretop(b);\n\tif (b->top >= b->len)\n\t\treturn 0; /* invalid */\n\tif (b->len == 0 || (b->top == 0 && b->d[0] == 0))\n\t\treturn 0;\n\t/* Find MSB set */\n\tw = b->d[b->top];\n\tbits = (b->top + 1) * BITMAP_BITS;\n\twhile (!(w & ((BITMAP_WTYPE)1 << (BITMAP_BITS - 1)))) {\n\t\tw <<= 1;\n\t\tbits--;\n\t}\n\treturn bits;\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)",
            "#define BITMAP_WTYPE\tu_int"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)\n#define BITMAP_WTYPE\tu_int\n\nsize_t\nbitmap_nbits(struct bitmap *b)\n{\n\tsize_t bits;\n\tBITMAP_WTYPE w;\n\n\tretop(b);\n\tif (b->top >= b->len)\n\t\treturn 0; /* invalid */\n\tif (b->len == 0 || (b->top == 0 && b->d[0] == 0))\n\t\treturn 0;\n\t/* Find MSB set */\n\tw = b->d[b->top];\n\tbits = (b->top + 1) * BITMAP_BITS;\n\twhile (!(w & ((BITMAP_WTYPE)1 << (BITMAP_BITS - 1)))) {\n\t\tw <<= 1;\n\t\tbits--;\n\t}\n\treturn bits;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nbitmap_nbytes(struct bitmap *b)\n{\n\treturn (bitmap_nbits(b) + 7) / 8;\n}"
  },
  {
    "function_name": "bitmap_nbits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
    "lines": "140-159",
    "snippet": "size_t\nbitmap_nbits(struct bitmap *b)\n{\n\tsize_t bits;\n\tBITMAP_WTYPE w;\n\n\tretop(b);\n\tif (b->top >= b->len)\n\t\treturn 0; /* invalid */\n\tif (b->len == 0 || (b->top == 0 && b->d[0] == 0))\n\t\treturn 0;\n\t/* Find MSB set */\n\tw = b->d[b->top];\n\tbits = (b->top + 1) * BITMAP_BITS;\n\twhile (!(w & ((BITMAP_WTYPE)1 << (BITMAP_BITS - 1)))) {\n\t\tw <<= 1;\n\t\tbits--;\n\t}\n\treturn bits;\n}",
    "includes": [
      "#include \"bitmap.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)",
      "#define BITMAP_WTYPE\tu_int"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "retop",
          "args": [
            "b"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "retop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "116-123",
          "snippet": "static void\nretop(struct bitmap *b)\n{\n\tif (b->top >= b->len)\n\t\treturn;\n\twhile (b->top > 0 && b->d[b->top] == 0)\n\t\tb->top--;\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic void\nretop(struct bitmap *b)\n{\n\tif (b->top >= b->len)\n\t\treturn;\n\twhile (b->top > 0 && b->d[b->top] == 0)\n\t\tb->top--;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)\n#define BITMAP_WTYPE\tu_int\n\nsize_t\nbitmap_nbits(struct bitmap *b)\n{\n\tsize_t bits;\n\tBITMAP_WTYPE w;\n\n\tretop(b);\n\tif (b->top >= b->len)\n\t\treturn 0; /* invalid */\n\tif (b->len == 0 || (b->top == 0 && b->d[0] == 0))\n\t\treturn 0;\n\t/* Find MSB set */\n\tw = b->d[b->top];\n\tbits = (b->top + 1) * BITMAP_BITS;\n\twhile (!(w & ((BITMAP_WTYPE)1 << (BITMAP_BITS - 1)))) {\n\t\tw <<= 1;\n\t\tbits--;\n\t}\n\treturn bits;\n}"
  },
  {
    "function_name": "bitmap_clear_bit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
    "lines": "125-138",
    "snippet": "void\nbitmap_clear_bit(struct bitmap *b, u_int n)\n{\n\tsize_t offset;\n\n\tif (b->top >= b->len || n > BITMAP_MAX)\n\t\treturn; /* invalid */\n\toffset = n / BITMAP_BITS;\n\tif (offset > b->top)\n\t\treturn;\n\tb->d[offset] &= ~((BITMAP_WTYPE)1 << (n & BITMAP_WMASK));\n\t/* The top may have changed as a result of the clear */\n\tretop(b);\n}",
    "includes": [
      "#include \"bitmap.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define BITMAP_WMASK\t((BITMAP_WTYPE)BITMAP_BITS - 1)",
      "#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)",
      "#define BITMAP_MAX\t(1<<24)",
      "#define BITMAP_WTYPE\tu_int"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "retop",
          "args": [
            "b"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "retop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "116-123",
          "snippet": "static void\nretop(struct bitmap *b)\n{\n\tif (b->top >= b->len)\n\t\treturn;\n\twhile (b->top > 0 && b->d[b->top] == 0)\n\t\tb->top--;\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic void\nretop(struct bitmap *b)\n{\n\tif (b->top >= b->len)\n\t\treturn;\n\twhile (b->top > 0 && b->d[b->top] == 0)\n\t\tb->top--;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_WMASK\t((BITMAP_WTYPE)BITMAP_BITS - 1)\n#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)\n#define BITMAP_MAX\t(1<<24)\n#define BITMAP_WTYPE\tu_int\n\nvoid\nbitmap_clear_bit(struct bitmap *b, u_int n)\n{\n\tsize_t offset;\n\n\tif (b->top >= b->len || n > BITMAP_MAX)\n\t\treturn; /* invalid */\n\toffset = n / BITMAP_BITS;\n\tif (offset > b->top)\n\t\treturn;\n\tb->d[offset] &= ~((BITMAP_WTYPE)1 << (n & BITMAP_WMASK));\n\t/* The top may have changed as a result of the clear */\n\tretop(b);\n}"
  },
  {
    "function_name": "retop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
    "lines": "116-123",
    "snippet": "static void\nretop(struct bitmap *b)\n{\n\tif (b->top >= b->len)\n\t\treturn;\n\twhile (b->top > 0 && b->d[b->top] == 0)\n\t\tb->top--;\n}",
    "includes": [
      "#include \"bitmap.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic void\nretop(struct bitmap *b)\n{\n\tif (b->top >= b->len)\n\t\treturn;\n\twhile (b->top > 0 && b->d[b->top] == 0)\n\t\tb->top--;\n}"
  },
  {
    "function_name": "bitmap_set_bit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
    "lines": "100-113",
    "snippet": "int\nbitmap_set_bit(struct bitmap *b, u_int n)\n{\n\tint r;\n\tsize_t offset;\n\n\tif ((r = reserve(b, n)) != 0)\n\t\treturn r;\n\toffset = n / BITMAP_BITS;\n\tif (offset > b->top)\n\t\tb->top = offset;\n\tb->d[offset] |= (BITMAP_WTYPE)1 << (n & BITMAP_WMASK);\n\treturn 0;\n}",
    "includes": [
      "#include \"bitmap.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define BITMAP_WMASK\t((BITMAP_WTYPE)BITMAP_BITS - 1)",
      "#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)",
      "#define BITMAP_WTYPE\tu_int"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reserve",
          "args": [
            "b",
            "n"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "reserve",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "81-98",
          "snippet": "static int\nreserve(struct bitmap *b, u_int n)\n{\n\tBITMAP_WTYPE *tmp;\n\tsize_t nlen;\n\n\tif (b->top >= b->len || n > BITMAP_MAX)\n\t\treturn -1; /* invalid */\n\tnlen = (n / BITMAP_BITS) + 1;\n\tif (b->len < nlen) {\n\t\tif ((tmp = recallocarray(b->d, b->len,\n\t\t    nlen, BITMAP_BYTES)) == NULL)\n\t\t\treturn -1;\n\t\tb->d = tmp;\n\t\tb->len = nlen;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)",
            "#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))",
            "#define BITMAP_MAX\t(1<<24)",
            "#define BITMAP_WTYPE\tu_int"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)\n#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))\n#define BITMAP_MAX\t(1<<24)\n#define BITMAP_WTYPE\tu_int\n\nstatic int\nreserve(struct bitmap *b, u_int n)\n{\n\tBITMAP_WTYPE *tmp;\n\tsize_t nlen;\n\n\tif (b->top >= b->len || n > BITMAP_MAX)\n\t\treturn -1; /* invalid */\n\tnlen = (n / BITMAP_BITS) + 1;\n\tif (b->len < nlen) {\n\t\tif ((tmp = recallocarray(b->d, b->len,\n\t\t    nlen, BITMAP_BYTES)) == NULL)\n\t\t\treturn -1;\n\t\tb->d = tmp;\n\t\tb->len = nlen;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_WMASK\t((BITMAP_WTYPE)BITMAP_BITS - 1)\n#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)\n#define BITMAP_WTYPE\tu_int\n\nint\nbitmap_set_bit(struct bitmap *b, u_int n)\n{\n\tint r;\n\tsize_t offset;\n\n\tif ((r = reserve(b, n)) != 0)\n\t\treturn r;\n\toffset = n / BITMAP_BITS;\n\tif (offset > b->top)\n\t\tb->top = offset;\n\tb->d[offset] |= (BITMAP_WTYPE)1 << (n & BITMAP_WMASK);\n\treturn 0;\n}"
  },
  {
    "function_name": "reserve",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
    "lines": "81-98",
    "snippet": "static int\nreserve(struct bitmap *b, u_int n)\n{\n\tBITMAP_WTYPE *tmp;\n\tsize_t nlen;\n\n\tif (b->top >= b->len || n > BITMAP_MAX)\n\t\treturn -1; /* invalid */\n\tnlen = (n / BITMAP_BITS) + 1;\n\tif (b->len < nlen) {\n\t\tif ((tmp = recallocarray(b->d, b->len,\n\t\t    nlen, BITMAP_BYTES)) == NULL)\n\t\t\treturn -1;\n\t\tb->d = tmp;\n\t\tb->len = nlen;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"bitmap.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)",
      "#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))",
      "#define BITMAP_MAX\t(1<<24)",
      "#define BITMAP_WTYPE\tu_int"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "recallocarray",
          "args": [
            "b->d",
            "b->len",
            "nlen",
            "BITMAP_BYTES"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "xrecallocarray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "80-90",
          "snippet": "void *\nxrecallocarray(void *ptr, size_t onmemb, size_t nmemb, size_t size)\n{\n\tvoid *new_ptr;\n\n\tnew_ptr = recallocarray(ptr, onmemb, nmemb, size);\n\tif (new_ptr == NULL)\n\t\tfatal(\"xrecallocarray: out of memory (%zu elements of %zu bytes)\",\n\t\t    nmemb, size);\n\treturn new_ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxrecallocarray(void *ptr, size_t onmemb, size_t nmemb, size_t size)\n{\n\tvoid *new_ptr;\n\n\tnew_ptr = recallocarray(ptr, onmemb, nmemb, size);\n\tif (new_ptr == NULL)\n\t\tfatal(\"xrecallocarray: out of memory (%zu elements of %zu bytes)\",\n\t\t    nmemb, size);\n\treturn new_ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)\n#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))\n#define BITMAP_MAX\t(1<<24)\n#define BITMAP_WTYPE\tu_int\n\nstatic int\nreserve(struct bitmap *b, u_int n)\n{\n\tBITMAP_WTYPE *tmp;\n\tsize_t nlen;\n\n\tif (b->top >= b->len || n > BITMAP_MAX)\n\t\treturn -1; /* invalid */\n\tnlen = (n / BITMAP_BITS) + 1;\n\tif (b->len < nlen) {\n\t\tif ((tmp = recallocarray(b->d, b->len,\n\t\t    nlen, BITMAP_BYTES)) == NULL)\n\t\t\treturn -1;\n\t\tb->d = tmp;\n\t\tb->len = nlen;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "bitmap_test_bit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
    "lines": "71-79",
    "snippet": "int\nbitmap_test_bit(struct bitmap *b, u_int n)\n{\n\tif (b->top >= b->len)\n\t\treturn 0; /* invalid */\n\tif (b->len == 0 || (n / BITMAP_BITS) > b->top)\n\t\treturn 0;\n\treturn (b->d[n / BITMAP_BITS] >> (n & BITMAP_WMASK)) & 1;\n}",
    "includes": [
      "#include \"bitmap.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define BITMAP_WMASK\t((BITMAP_WTYPE)BITMAP_BITS - 1)",
      "#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_WMASK\t((BITMAP_WTYPE)BITMAP_BITS - 1)\n#define BITMAP_BITS\t(sizeof(BITMAP_WTYPE) * 8)\n\nint\nbitmap_test_bit(struct bitmap *b, u_int n)\n{\n\tif (b->top >= b->len)\n\t\treturn 0; /* invalid */\n\tif (b->len == 0 || (n / BITMAP_BITS) > b->top)\n\t\treturn 0;\n\treturn (b->d[n / BITMAP_BITS] >> (n & BITMAP_WMASK)) & 1;\n}"
  },
  {
    "function_name": "bitmap_zero",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
    "lines": "64-69",
    "snippet": "void\nbitmap_zero(struct bitmap *b)\n{\n\tmemset(b->d, 0, b->len * BITMAP_BYTES);\n\tb->top = 0;\n}",
    "includes": [
      "#include \"bitmap.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "b->d",
            "0",
            "b->len * BITMAP_BYTES"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))\n\nvoid\nbitmap_zero(struct bitmap *b)\n{\n\tmemset(b->d, 0, b->len * BITMAP_BYTES);\n\tb->top = 0;\n}"
  },
  {
    "function_name": "bitmap_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
    "lines": "53-62",
    "snippet": "void\nbitmap_free(struct bitmap *b)\n{\n\tif (b != NULL && b->d != NULL) {\n\t\tbitmap_zero(b);\n\t\tfree(b->d);\n\t\tb->d = NULL;\n\t}\n\tfree(b);\n}",
    "includes": [
      "#include \"bitmap.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "b"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "bitmap_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "53-62",
          "snippet": "void\nbitmap_free(struct bitmap *b)\n{\n\tif (b != NULL && b->d != NULL) {\n\t\tbitmap_zero(b);\n\t\tfree(b->d);\n\t\tb->d = NULL;\n\t}\n\tfree(b);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "bitmap_zero",
          "args": [
            "b"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "bitmap_zero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "64-69",
          "snippet": "void\nbitmap_zero(struct bitmap *b)\n{\n\tmemset(b->d, 0, b->len * BITMAP_BYTES);\n\tb->top = 0;\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))\n\nvoid\nbitmap_zero(struct bitmap *b)\n{\n\tmemset(b->d, 0, b->len * BITMAP_BYTES);\n\tb->top = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nbitmap_free(struct bitmap *b)\n{\n\tif (b != NULL && b->d != NULL) {\n\t\tbitmap_zero(b);\n\t\tfree(b->d);\n\t\tb->d = NULL;\n\t}\n\tfree(b);\n}"
  },
  {
    "function_name": "bitmap_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
    "lines": "37-51",
    "snippet": "struct bitmap *\nbitmap_new(void)\n{\n\tstruct bitmap *ret;\n\n\tif ((ret = calloc(1, sizeof(*ret))) == NULL)\n\t\treturn NULL;\n\tif ((ret->d = calloc(1, BITMAP_BYTES)) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\tret->len = 1;\n\tret->top = 0;\n\treturn ret;\n}",
    "includes": [
      "#include \"bitmap.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "ret"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "bitmap_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/bitmap.c",
          "lines": "53-62",
          "snippet": "void\nbitmap_free(struct bitmap *b)\n{\n\tif (b != NULL && b->d != NULL) {\n\t\tbitmap_zero(b);\n\t\tfree(b->d);\n\t\tb->d = NULL;\n\t}\n\tfree(b);\n}",
          "includes": [
            "#include \"bitmap.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nbitmap_free(struct bitmap *b)\n{\n\tif (b != NULL && b->d != NULL) {\n\t\tbitmap_zero(b);\n\t\tfree(b->d);\n\t\tb->d = NULL;\n\t}\n\tfree(b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "calloc",
          "args": [
            "1",
            "BITMAP_BYTES"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "xcalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "52-66",
          "snippet": "void *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bitmap.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define BITMAP_BYTES\t(sizeof(BITMAP_WTYPE))\n\nstruct bitmap *\nbitmap_new(void)\n{\n\tstruct bitmap *ret;\n\n\tif ((ret = calloc(1, sizeof(*ret))) == NULL)\n\t\treturn NULL;\n\tif ((ret->d = calloc(1, BITMAP_BYTES)) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\tret->len = 1;\n\tret->top = 0;\n\treturn ret;\n}"
  }
]