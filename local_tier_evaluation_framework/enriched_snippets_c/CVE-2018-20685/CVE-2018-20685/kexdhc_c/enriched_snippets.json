[
  {
    "function_name": "input_kex_dh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/kexdhc.c",
    "lines": "107-223",
    "snippet": "static int\ninput_kex_dh(int type, u_int32_t seq, struct ssh *ssh)\n{\n\tstruct kex *kex = ssh->kex;\n\tBIGNUM *dh_server_pub = NULL, *shared_secret = NULL;\n\tconst BIGNUM *pub_key;\n\tstruct sshkey *server_host_key = NULL;\n\tu_char *kbuf = NULL, *server_host_key_blob = NULL, *signature = NULL;\n\tu_char hash[SSH_DIGEST_MAX_LENGTH];\n\tsize_t klen = 0, slen, sbloblen, hashlen;\n\tint kout, r;\n\n\tif (kex->verify_host_key == NULL) {\n\t\tr = SSH_ERR_INVALID_ARGUMENT;\n\t\tgoto out;\n\t}\n\t/* key, cert */\n\tif ((r = sshpkt_get_string(ssh, &server_host_key_blob,\n\t    &sbloblen)) != 0 ||\n\t    (r = sshkey_from_blob(server_host_key_blob, sbloblen,\n\t    &server_host_key)) != 0)\n\t\tgoto out;\n\tif (server_host_key->type != kex->hostkey_type ||\n\t    (kex->hostkey_type == KEY_ECDSA &&\n\t    server_host_key->ecdsa_nid != kex->hostkey_nid)) {\n\t\tr = SSH_ERR_KEY_TYPE_MISMATCH;\n\t\tgoto out;\n\t}\n\tif (kex->verify_host_key(server_host_key, ssh) == -1) {\n\t\tr = SSH_ERR_SIGNATURE_INVALID;\n\t\tgoto out;\n\t}\n\t/* DH parameter f, server public DH key */\n\tif ((dh_server_pub = BN_new()) == NULL) {\n\t\tr = SSH_ERR_ALLOC_FAIL;\n\t\tgoto out;\n\t}\n\t/* signed H */\n\tif ((r = sshpkt_get_bignum2(ssh, dh_server_pub)) != 0 ||\n\t    (r = sshpkt_get_string(ssh, &signature, &slen)) != 0 ||\n\t    (r = sshpkt_get_end(ssh)) != 0)\n\t\tgoto out;\n#ifdef DEBUG_KEXDH\n\tfprintf(stderr, \"dh_server_pub= \");\n\tBN_print_fp(stderr, dh_server_pub);\n\tfprintf(stderr, \"\\n\");\n\tdebug(\"bits %d\", BN_num_bits(dh_server_pub));\n#endif\n\tif (!dh_pub_is_valid(kex->dh, dh_server_pub)) {\n\t\tsshpkt_disconnect(ssh, \"bad server public DH value\");\n\t\tr = SSH_ERR_MESSAGE_INCOMPLETE;\n\t\tgoto out;\n\t}\n\n\tklen = DH_size(kex->dh);\n\tif ((kbuf = malloc(klen)) == NULL ||\n\t    (shared_secret = BN_new()) == NULL) {\n\t\tr = SSH_ERR_ALLOC_FAIL;\n\t\tgoto out;\n\t}\n\tif ((kout = DH_compute_key(kbuf, dh_server_pub, kex->dh)) < 0 ||\n\t    BN_bin2bn(kbuf, kout, shared_secret) == NULL) {\n\t\tr = SSH_ERR_LIBCRYPTO_ERROR;\n\t\tgoto out;\n\t}\n#ifdef DEBUG_KEXDH\n\tdump_digest(\"shared secret\", kbuf, kout);\n#endif\n\n\t/* calc and verify H */\n\tDH_get0_key(kex->dh, &pub_key, NULL);\n\thashlen = sizeof(hash);\n\tif ((r = kex_dh_hash(\n\t    kex->hash_alg,\n\t    kex->client_version_string,\n\t    kex->server_version_string,\n\t    sshbuf_ptr(kex->my), sshbuf_len(kex->my),\n\t    sshbuf_ptr(kex->peer), sshbuf_len(kex->peer),\n\t    server_host_key_blob, sbloblen,\n\t    pub_key,\n\t    dh_server_pub,\n\t    shared_secret,\n\t    hash, &hashlen)) != 0)\n\t\tgoto out;\n\n\tif ((r = sshkey_verify(server_host_key, signature, slen, hash, hashlen,\n\t    kex->hostkey_alg, ssh->compat)) != 0)\n\t\tgoto out;\n\n\t/* save session id */\n\tif (kex->session_id == NULL) {\n\t\tkex->session_id_len = hashlen;\n\t\tkex->session_id = malloc(kex->session_id_len);\n\t\tif (kex->session_id == NULL) {\n\t\t\tr = SSH_ERR_ALLOC_FAIL;\n\t\t\tgoto out;\n\t\t}\n\t\tmemcpy(kex->session_id, hash, kex->session_id_len);\n\t}\n\n\tif ((r = kex_derive_keys_bn(ssh, hash, hashlen, shared_secret)) == 0)\n\t\tr = kex_send_newkeys(ssh);\n out:\n\texplicit_bzero(hash, sizeof(hash));\n\tDH_free(kex->dh);\n\tkex->dh = NULL;\n\tBN_clear_free(dh_server_pub);\n\tif (kbuf) {\n\t\texplicit_bzero(kbuf, klen);\n\t\tfree(kbuf);\n\t}\n\tBN_clear_free(shared_secret);\n\tsshkey_free(server_host_key);\n\tfree(server_host_key_blob);\n\tfree(signature);\n\treturn r;\n}",
    "includes": [
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"compat.h\"",
      "#include \"dispatch.h\"",
      "#include \"ssh2.h\"",
      "#include \"dh.h\"",
      "#include \"packet.h\"",
      "#include \"log.h\"",
      "#include \"kex.h\"",
      "#include \"digest.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <openssl/dh.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "signature"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "freeze",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/smult_curve25519_ref.c",
          "lines": "50-60",
          "snippet": "static void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [
            "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;"
          ],
          "called_functions": [],
          "contextual_snippet": "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;\n\nstatic void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshkey_free",
          "args": [
            "server_host_key"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "sshkey_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshkey.c",
          "lines": "552-606",
          "snippet": "void\nsshkey_free(struct sshkey *k)\n{\n\tif (k == NULL)\n\t\treturn;\n\tswitch (k->type) {\n#ifdef WITH_OPENSSL\n\tcase KEY_RSA:\n\tcase KEY_RSA_CERT:\n\t\tRSA_free(k->rsa);\n\t\tk->rsa = NULL;\n\t\tbreak;\n\tcase KEY_DSA:\n\tcase KEY_DSA_CERT:\n\t\tDSA_free(k->dsa);\n\t\tk->dsa = NULL;\n\t\tbreak;\n# ifdef OPENSSL_HAS_ECC\n\tcase KEY_ECDSA:\n\tcase KEY_ECDSA_CERT:\n\t\tEC_KEY_free(k->ecdsa);\n\t\tk->ecdsa = NULL;\n\t\tbreak;\n# endif /* OPENSSL_HAS_ECC */\n#endif /* WITH_OPENSSL */\n\tcase KEY_ED25519:\n\tcase KEY_ED25519_CERT:\n\t\tfreezero(k->ed25519_pk, ED25519_PK_SZ);\n\t\tk->ed25519_pk = NULL;\n\t\tfreezero(k->ed25519_sk, ED25519_SK_SZ);\n\t\tk->ed25519_sk = NULL;\n\t\tbreak;\n#ifdef WITH_XMSS\n\tcase KEY_XMSS:\n\tcase KEY_XMSS_CERT:\n\t\tfreezero(k->xmss_pk, sshkey_xmss_pklen(k));\n\t\tk->xmss_pk = NULL;\n\t\tfreezero(k->xmss_sk, sshkey_xmss_sklen(k));\n\t\tk->xmss_sk = NULL;\n\t\tsshkey_xmss_free_state(k);\n\t\tfree(k->xmss_name);\n\t\tk->xmss_name = NULL;\n\t\tfree(k->xmss_filename);\n\t\tk->xmss_filename = NULL;\n\t\tbreak;\n#endif /* WITH_XMSS */\n\tcase KEY_UNSPEC:\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\tif (sshkey_is_cert(k))\n\t\tcert_free(k->cert);\n\tfreezero(k, sizeof(*k));\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"xmss_fast.h\"",
            "#include \"match.h\"",
            "#include \"sshkey-xmss.h\"",
            "#include \"sshkey.h\"",
            "#include \"digest.h\"",
            "#include \"cipher.h\"",
            "#include \"sshbuf.h\"",
            "#include \"misc.h\"",
            "#include \"ssherr.h\"",
            "#include \"ssh2.h\"",
            "#include <util.h>",
            "#include <resolv.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include \"crypto_api.h\"",
            "#include <openssl/pem.h>",
            "#include <openssl/err.h>",
            "#include <openssl/evp.h>",
            "#include <netinet/in.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"xmss_fast.h\"\n#include \"match.h\"\n#include \"sshkey-xmss.h\"\n#include \"sshkey.h\"\n#include \"digest.h\"\n#include \"cipher.h\"\n#include \"sshbuf.h\"\n#include \"misc.h\"\n#include \"ssherr.h\"\n#include \"ssh2.h\"\n#include <util.h>\n#include <resolv.h>\n#include <string.h>\n#include <stdio.h>\n#include <limits.h>\n#include <errno.h>\n#include \"crypto_api.h\"\n#include <openssl/pem.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <netinet/in.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nsshkey_free(struct sshkey *k)\n{\n\tif (k == NULL)\n\t\treturn;\n\tswitch (k->type) {\n#ifdef WITH_OPENSSL\n\tcase KEY_RSA:\n\tcase KEY_RSA_CERT:\n\t\tRSA_free(k->rsa);\n\t\tk->rsa = NULL;\n\t\tbreak;\n\tcase KEY_DSA:\n\tcase KEY_DSA_CERT:\n\t\tDSA_free(k->dsa);\n\t\tk->dsa = NULL;\n\t\tbreak;\n# ifdef OPENSSL_HAS_ECC\n\tcase KEY_ECDSA:\n\tcase KEY_ECDSA_CERT:\n\t\tEC_KEY_free(k->ecdsa);\n\t\tk->ecdsa = NULL;\n\t\tbreak;\n# endif /* OPENSSL_HAS_ECC */\n#endif /* WITH_OPENSSL */\n\tcase KEY_ED25519:\n\tcase KEY_ED25519_CERT:\n\t\tfreezero(k->ed25519_pk, ED25519_PK_SZ);\n\t\tk->ed25519_pk = NULL;\n\t\tfreezero(k->ed25519_sk, ED25519_SK_SZ);\n\t\tk->ed25519_sk = NULL;\n\t\tbreak;\n#ifdef WITH_XMSS\n\tcase KEY_XMSS:\n\tcase KEY_XMSS_CERT:\n\t\tfreezero(k->xmss_pk, sshkey_xmss_pklen(k));\n\t\tk->xmss_pk = NULL;\n\t\tfreezero(k->xmss_sk, sshkey_xmss_sklen(k));\n\t\tk->xmss_sk = NULL;\n\t\tsshkey_xmss_free_state(k);\n\t\tfree(k->xmss_name);\n\t\tk->xmss_name = NULL;\n\t\tfree(k->xmss_filename);\n\t\tk->xmss_filename = NULL;\n\t\tbreak;\n#endif /* WITH_XMSS */\n\tcase KEY_UNSPEC:\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\tif (sshkey_is_cert(k))\n\t\tcert_free(k->cert);\n\tfreezero(k, sizeof(*k));\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "shared_secret"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "explicit_bzero",
          "args": [
            "kbuf",
            "klen"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "explicit_bzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/explicit_bzero.c",
          "lines": "36-53",
          "snippet": "void\nexplicit_bzero(void *p, size_t n)\n{\n\tif (n == 0)\n\t\treturn;\n\t/*\n\t * clang -fsanitize=memory needs to intercept memset-like functions\n\t * to correctly detect memory initialisation. Make sure one is called\n\t * directly since our indirection trick above successfully confuses it.\n\t */\n#if defined(__has_feature)\n# if __has_feature(memory_sanitizer)\n\tmemset(p, 0, n);\n# endif\n#endif\n\n\tssh_bzero(p, n);\n}",
          "includes": [
            "#include <string.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"includes.h\"\n\nvoid\nexplicit_bzero(void *p, size_t n)\n{\n\tif (n == 0)\n\t\treturn;\n\t/*\n\t * clang -fsanitize=memory needs to intercept memset-like functions\n\t * to correctly detect memory initialisation. Make sure one is called\n\t * directly since our indirection trick above successfully confuses it.\n\t */\n#if defined(__has_feature)\n# if __has_feature(memory_sanitizer)\n\tmemset(p, 0, n);\n# endif\n#endif\n\n\tssh_bzero(p, n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "dh_server_pub"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DH_free",
          "args": [
            "kex->dh"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kex_send_newkeys",
          "args": [
            "ssh"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "kex_send_newkeys",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/kex.c",
          "lines": "420-436",
          "snippet": "int\nkex_send_newkeys(struct ssh *ssh)\n{\n\tint r;\n\n\tkex_reset_dispatch(ssh);\n\tif ((r = sshpkt_start(ssh, SSH2_MSG_NEWKEYS)) != 0 ||\n\t    (r = sshpkt_send(ssh)) != 0)\n\t\treturn r;\n\tdebug(\"SSH2_MSG_NEWKEYS sent\");\n\tdebug(\"expecting SSH2_MSG_NEWKEYS\");\n\tssh_dispatch_set(ssh, SSH2_MSG_NEWKEYS, &kex_input_newkeys);\n\tif (ssh->kex->ext_info_c)\n\t\tif ((r = kex_send_ext_info(ssh)) != 0)\n\t\t\treturn r;\n\treturn 0;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"monitor.h\"",
            "#include \"dispatch.h\"",
            "#include \"misc.h\"",
            "#include \"match.h\"",
            "#include \"mac.h\"",
            "#include \"log.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"compat.h\"",
            "#include \"packet.h\"",
            "#include \"ssh2.h\"",
            "#include <openssl/dh.h>",
            "#include <openssl/crypto.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int kex_choose_conf(struct ssh *);",
            "static int kex_input_newkeys(int, u_int32_t, struct ssh *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"monitor.h\"\n#include \"dispatch.h\"\n#include \"misc.h\"\n#include \"match.h\"\n#include \"mac.h\"\n#include \"log.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"compat.h\"\n#include \"packet.h\"\n#include \"ssh2.h\"\n#include <openssl/dh.h>\n#include <openssl/crypto.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n#include \"includes.h\"\n\nstatic int kex_choose_conf(struct ssh *);\nstatic int kex_input_newkeys(int, u_int32_t, struct ssh *);\n\nint\nkex_send_newkeys(struct ssh *ssh)\n{\n\tint r;\n\n\tkex_reset_dispatch(ssh);\n\tif ((r = sshpkt_start(ssh, SSH2_MSG_NEWKEYS)) != 0 ||\n\t    (r = sshpkt_send(ssh)) != 0)\n\t\treturn r;\n\tdebug(\"SSH2_MSG_NEWKEYS sent\");\n\tdebug(\"expecting SSH2_MSG_NEWKEYS\");\n\tssh_dispatch_set(ssh, SSH2_MSG_NEWKEYS, &kex_input_newkeys);\n\tif (ssh->kex->ext_info_c)\n\t\tif ((r = kex_send_ext_info(ssh)) != 0)\n\t\t\treturn r;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kex_derive_keys_bn",
          "args": [
            "ssh",
            "hash",
            "hashlen",
            "shared_secret"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "kex_derive_keys_bn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/kex.c",
          "lines": "1019-1032",
          "snippet": "int\nkex_derive_keys_bn(struct ssh *ssh, u_char *hash, u_int hashlen,\n    const BIGNUM *secret)\n{\n\tstruct sshbuf *shared_secret;\n\tint r;\n\n\tif ((shared_secret = sshbuf_new()) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif ((r = sshbuf_put_bignum2(shared_secret, secret)) == 0)\n\t\tr = kex_derive_keys(ssh, hash, hashlen, shared_secret);\n\tsshbuf_free(shared_secret);\n\treturn r;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"monitor.h\"",
            "#include \"dispatch.h\"",
            "#include \"misc.h\"",
            "#include \"match.h\"",
            "#include \"mac.h\"",
            "#include \"log.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"compat.h\"",
            "#include \"packet.h\"",
            "#include \"ssh2.h\"",
            "#include <openssl/dh.h>",
            "#include <openssl/crypto.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int kex_choose_conf(struct ssh *);",
            "static int kex_input_newkeys(int, u_int32_t, struct ssh *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"monitor.h\"\n#include \"dispatch.h\"\n#include \"misc.h\"\n#include \"match.h\"\n#include \"mac.h\"\n#include \"log.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"compat.h\"\n#include \"packet.h\"\n#include \"ssh2.h\"\n#include <openssl/dh.h>\n#include <openssl/crypto.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n#include \"includes.h\"\n\nstatic int kex_choose_conf(struct ssh *);\nstatic int kex_input_newkeys(int, u_int32_t, struct ssh *);\n\nint\nkex_derive_keys_bn(struct ssh *ssh, u_char *hash, u_int hashlen,\n    const BIGNUM *secret)\n{\n\tstruct sshbuf *shared_secret;\n\tint r;\n\n\tif ((shared_secret = sshbuf_new()) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif ((r = sshbuf_put_bignum2(shared_secret, secret)) == 0)\n\t\tr = kex_derive_keys(ssh, hash, hashlen, shared_secret);\n\tsshbuf_free(shared_secret);\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "kex->session_id",
            "hash",
            "kex->session_id_len"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "kex->session_id_len"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "xmalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "39-50",
          "snippet": "void *\nxmalloc(size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0)\n\t\tfatal(\"xmalloc: zero size\");\n\tptr = malloc(size);\n\tif (ptr == NULL)\n\t\tfatal(\"xmalloc: out of memory (allocating %zu bytes)\", size);\n\treturn ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxmalloc(size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0)\n\t\tfatal(\"xmalloc: zero size\");\n\tptr = malloc(size);\n\tif (ptr == NULL)\n\t\tfatal(\"xmalloc: out of memory (allocating %zu bytes)\", size);\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshkey_verify",
          "args": [
            "server_host_key",
            "signature",
            "slen",
            "hash",
            "hashlen",
            "kex->hostkey_alg",
            "ssh->compat"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "sshkey_verify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshkey.c",
          "lines": "2427-2459",
          "snippet": "int\nsshkey_verify(const struct sshkey *key,\n    const u_char *sig, size_t siglen,\n    const u_char *data, size_t dlen, const char *alg, u_int compat)\n{\n\tif (siglen == 0 || dlen > SSH_KEY_MAX_SIGN_DATA_SIZE)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tswitch (key->type) {\n#ifdef WITH_OPENSSL\n\tcase KEY_DSA_CERT:\n\tcase KEY_DSA:\n\t\treturn ssh_dss_verify(key, sig, siglen, data, dlen, compat);\n# ifdef OPENSSL_HAS_ECC\n\tcase KEY_ECDSA_CERT:\n\tcase KEY_ECDSA:\n\t\treturn ssh_ecdsa_verify(key, sig, siglen, data, dlen, compat);\n# endif /* OPENSSL_HAS_ECC */\n\tcase KEY_RSA_CERT:\n\tcase KEY_RSA:\n\t\treturn ssh_rsa_verify(key, sig, siglen, data, dlen, alg);\n#endif /* WITH_OPENSSL */\n\tcase KEY_ED25519:\n\tcase KEY_ED25519_CERT:\n\t\treturn ssh_ed25519_verify(key, sig, siglen, data, dlen, compat);\n#ifdef WITH_XMSS\n\tcase KEY_XMSS:\n\tcase KEY_XMSS_CERT:\n\t\treturn ssh_xmss_verify(key, sig, siglen, data, dlen, compat);\n#endif /* WITH_XMSS */\n\tdefault:\n\t\treturn SSH_ERR_KEY_TYPE_UNKNOWN;\n\t}\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"xmss_fast.h\"",
            "#include \"match.h\"",
            "#include \"sshkey-xmss.h\"",
            "#include \"sshkey.h\"",
            "#include \"digest.h\"",
            "#include \"cipher.h\"",
            "#include \"sshbuf.h\"",
            "#include \"misc.h\"",
            "#include \"ssherr.h\"",
            "#include \"ssh2.h\"",
            "#include <util.h>",
            "#include <resolv.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include \"crypto_api.h\"",
            "#include <openssl/pem.h>",
            "#include <openssl/err.h>",
            "#include <openssl/evp.h>",
            "#include <netinet/in.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"xmss_fast.h\"\n#include \"match.h\"\n#include \"sshkey-xmss.h\"\n#include \"sshkey.h\"\n#include \"digest.h\"\n#include \"cipher.h\"\n#include \"sshbuf.h\"\n#include \"misc.h\"\n#include \"ssherr.h\"\n#include \"ssh2.h\"\n#include <util.h>\n#include <resolv.h>\n#include <string.h>\n#include <stdio.h>\n#include <limits.h>\n#include <errno.h>\n#include \"crypto_api.h\"\n#include <openssl/pem.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <netinet/in.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshkey_verify(const struct sshkey *key,\n    const u_char *sig, size_t siglen,\n    const u_char *data, size_t dlen, const char *alg, u_int compat)\n{\n\tif (siglen == 0 || dlen > SSH_KEY_MAX_SIGN_DATA_SIZE)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tswitch (key->type) {\n#ifdef WITH_OPENSSL\n\tcase KEY_DSA_CERT:\n\tcase KEY_DSA:\n\t\treturn ssh_dss_verify(key, sig, siglen, data, dlen, compat);\n# ifdef OPENSSL_HAS_ECC\n\tcase KEY_ECDSA_CERT:\n\tcase KEY_ECDSA:\n\t\treturn ssh_ecdsa_verify(key, sig, siglen, data, dlen, compat);\n# endif /* OPENSSL_HAS_ECC */\n\tcase KEY_RSA_CERT:\n\tcase KEY_RSA:\n\t\treturn ssh_rsa_verify(key, sig, siglen, data, dlen, alg);\n#endif /* WITH_OPENSSL */\n\tcase KEY_ED25519:\n\tcase KEY_ED25519_CERT:\n\t\treturn ssh_ed25519_verify(key, sig, siglen, data, dlen, compat);\n#ifdef WITH_XMSS\n\tcase KEY_XMSS:\n\tcase KEY_XMSS_CERT:\n\t\treturn ssh_xmss_verify(key, sig, siglen, data, dlen, compat);\n#endif /* WITH_XMSS */\n\tdefault:\n\t\treturn SSH_ERR_KEY_TYPE_UNKNOWN;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kex_dh_hash",
          "args": [
            "kex->hash_alg",
            "kex->client_version_string",
            "kex->server_version_string",
            "sshbuf_ptr(kex->my)",
            "sshbuf_len(kex->my)",
            "sshbuf_ptr(kex->peer)",
            "sshbuf_len(kex->peer)",
            "server_host_key_blob",
            "sbloblen",
            "pub_key",
            "dh_server_pub",
            "shared_secret",
            "hash",
            "&hashlen"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "kex_dh_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/kexdh.c",
          "lines": "46-95",
          "snippet": "int\nkex_dh_hash(\n    int hash_alg,\n    const char *client_version_string,\n    const char *server_version_string,\n    const u_char *ckexinit, size_t ckexinitlen,\n    const u_char *skexinit, size_t skexinitlen,\n    const u_char *serverhostkeyblob, size_t sbloblen,\n    const BIGNUM *client_dh_pub,\n    const BIGNUM *server_dh_pub,\n    const BIGNUM *shared_secret,\n    u_char *hash, size_t *hashlen)\n{\n\tstruct sshbuf *b;\n\tint r;\n\n\tif (*hashlen < ssh_digest_bytes(hash_alg))\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif ((b = sshbuf_new()) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif ((r = sshbuf_put_cstring(b, client_version_string)) != 0 ||\n\t    (r = sshbuf_put_cstring(b, server_version_string)) != 0 ||\n\t    /* kexinit messages: fake header: len+SSH2_MSG_KEXINIT */\n\t    (r = sshbuf_put_u32(b, ckexinitlen+1)) != 0 ||\n\t    (r = sshbuf_put_u8(b, SSH2_MSG_KEXINIT)) != 0 ||\n\t    (r = sshbuf_put(b, ckexinit, ckexinitlen)) != 0 ||\n\t    (r = sshbuf_put_u32(b, skexinitlen+1)) != 0 ||\n\t    (r = sshbuf_put_u8(b, SSH2_MSG_KEXINIT)) != 0 ||\n\t    (r = sshbuf_put(b, skexinit, skexinitlen)) != 0 ||\n\t    (r = sshbuf_put_string(b, serverhostkeyblob, sbloblen)) != 0 ||\n\t    (r = sshbuf_put_bignum2(b, client_dh_pub)) != 0 ||\n\t    (r = sshbuf_put_bignum2(b, server_dh_pub)) != 0 ||\n\t    (r = sshbuf_put_bignum2(b, shared_secret)) != 0) {\n\t\tsshbuf_free(b);\n\t\treturn r;\n\t}\n#ifdef DEBUG_KEX\n\tsshbuf_dump(b, stderr);\n#endif\n\tif (ssh_digest_buffer(hash_alg, b, hash, *hashlen) != 0) {\n\t\tsshbuf_free(b);\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\t}\n\tsshbuf_free(b);\n\t*hashlen = ssh_digest_bytes(hash_alg);\n#ifdef DEBUG_KEX\n\tdump_digest(\"hash\", hash, *hashlen);\n#endif\n\treturn 0;\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"ssh2.h\"",
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include <openssl/evp.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"ssh2.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nkex_dh_hash(\n    int hash_alg,\n    const char *client_version_string,\n    const char *server_version_string,\n    const u_char *ckexinit, size_t ckexinitlen,\n    const u_char *skexinit, size_t skexinitlen,\n    const u_char *serverhostkeyblob, size_t sbloblen,\n    const BIGNUM *client_dh_pub,\n    const BIGNUM *server_dh_pub,\n    const BIGNUM *shared_secret,\n    u_char *hash, size_t *hashlen)\n{\n\tstruct sshbuf *b;\n\tint r;\n\n\tif (*hashlen < ssh_digest_bytes(hash_alg))\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif ((b = sshbuf_new()) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif ((r = sshbuf_put_cstring(b, client_version_string)) != 0 ||\n\t    (r = sshbuf_put_cstring(b, server_version_string)) != 0 ||\n\t    /* kexinit messages: fake header: len+SSH2_MSG_KEXINIT */\n\t    (r = sshbuf_put_u32(b, ckexinitlen+1)) != 0 ||\n\t    (r = sshbuf_put_u8(b, SSH2_MSG_KEXINIT)) != 0 ||\n\t    (r = sshbuf_put(b, ckexinit, ckexinitlen)) != 0 ||\n\t    (r = sshbuf_put_u32(b, skexinitlen+1)) != 0 ||\n\t    (r = sshbuf_put_u8(b, SSH2_MSG_KEXINIT)) != 0 ||\n\t    (r = sshbuf_put(b, skexinit, skexinitlen)) != 0 ||\n\t    (r = sshbuf_put_string(b, serverhostkeyblob, sbloblen)) != 0 ||\n\t    (r = sshbuf_put_bignum2(b, client_dh_pub)) != 0 ||\n\t    (r = sshbuf_put_bignum2(b, server_dh_pub)) != 0 ||\n\t    (r = sshbuf_put_bignum2(b, shared_secret)) != 0) {\n\t\tsshbuf_free(b);\n\t\treturn r;\n\t}\n#ifdef DEBUG_KEX\n\tsshbuf_dump(b, stderr);\n#endif\n\tif (ssh_digest_buffer(hash_alg, b, hash, *hashlen) != 0) {\n\t\tsshbuf_free(b);\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\t}\n\tsshbuf_free(b);\n\t*hashlen = ssh_digest_bytes(hash_alg);\n#ifdef DEBUG_KEX\n\tdump_digest(\"hash\", hash, *hashlen);\n#endif\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_len",
          "args": [
            "kex->peer"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "252-258",
          "snippet": "size_t\nsshbuf_len(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn 0;\n\treturn buf->size - buf->off;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nsshbuf_len(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn 0;\n\treturn buf->size - buf->off;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_ptr",
          "args": [
            "kex->peer"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "268-274",
          "snippet": "const u_char *\nsshbuf_ptr(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn NULL;\n\treturn buf->cd + buf->off;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst u_char *\nsshbuf_ptr(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn NULL;\n\treturn buf->cd + buf->off;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DH_get0_key",
          "args": [
            "kex->dh",
            "&pub_key",
            "NULL"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "DH_get0_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "488-495",
          "snippet": "void\nDH_get0_key(const DH *dh, const BIGNUM **pub_key, const BIGNUM **priv_key)\n{\n\tif (pub_key != NULL)\n\t\t*pub_key = dh->pub_key;\n\tif (priv_key != NULL)\n\t\t*priv_key = dh->priv_key;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nDH_get0_key(const DH *dh, const BIGNUM **pub_key, const BIGNUM **priv_key)\n{\n\tif (pub_key != NULL)\n\t\t*pub_key = dh->pub_key;\n\tif (priv_key != NULL)\n\t\t*priv_key = dh->priv_key;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dump_digest",
          "args": [
            "\"shared secret\"",
            "kbuf",
            "kout"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "dump_digest",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/kex.c",
          "lines": "1037-1042",
          "snippet": "void\ndump_digest(char *msg, u_char *digest, int len)\n{\n\tfprintf(stderr, \"%s\\n\", msg);\n\tsshbuf_dump_data(digest, len, stderr);\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"monitor.h\"",
            "#include \"dispatch.h\"",
            "#include \"misc.h\"",
            "#include \"match.h\"",
            "#include \"mac.h\"",
            "#include \"log.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"compat.h\"",
            "#include \"packet.h\"",
            "#include \"ssh2.h\"",
            "#include <openssl/dh.h>",
            "#include <openssl/crypto.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"monitor.h\"\n#include \"dispatch.h\"\n#include \"misc.h\"\n#include \"match.h\"\n#include \"mac.h\"\n#include \"log.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"compat.h\"\n#include \"packet.h\"\n#include \"ssh2.h\"\n#include <openssl/dh.h>\n#include <openssl/crypto.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n#include \"includes.h\"\n\nvoid\ndump_digest(char *msg, u_char *digest, int len)\n{\n\tfprintf(stderr, \"%s\\n\", msg);\n\tsshbuf_dump_data(digest, len, stderr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_bin2bn",
          "args": [
            "kbuf",
            "kout",
            "shared_secret"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DH_compute_key",
          "args": [
            "kbuf",
            "dh_server_pub",
            "kex->dh"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DH_size",
          "args": [
            "kex->dh"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshpkt_disconnect",
          "args": [
            "ssh",
            "\"bad server public DH value\""
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "sshpkt_disconnect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "2656-2674",
          "snippet": "int\nsshpkt_disconnect(struct ssh *ssh, const char *fmt,...)\n{\n\tchar buf[1024];\n\tva_list args;\n\tint r;\n\n\tva_start(args, fmt);\n\tvsnprintf(buf, sizeof(buf), fmt, args);\n\tva_end(args);\n\n\tif ((r = sshpkt_start(ssh, SSH2_MSG_DISCONNECT)) != 0 ||\n\t    (r = sshpkt_put_u32(ssh, SSH2_DISCONNECT_PROTOCOL_ERROR)) != 0 ||\n\t    (r = sshpkt_put_cstring(ssh, buf)) != 0 ||\n\t    (r = sshpkt_put_cstring(ssh, \"\")) != 0 ||\n\t    (r = sshpkt_send(ssh)) != 0)\n\t\treturn r;\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshpkt_disconnect(struct ssh *ssh, const char *fmt,...)\n{\n\tchar buf[1024];\n\tva_list args;\n\tint r;\n\n\tva_start(args, fmt);\n\tvsnprintf(buf, sizeof(buf), fmt, args);\n\tva_end(args);\n\n\tif ((r = sshpkt_start(ssh, SSH2_MSG_DISCONNECT)) != 0 ||\n\t    (r = sshpkt_put_u32(ssh, SSH2_DISCONNECT_PROTOCOL_ERROR)) != 0 ||\n\t    (r = sshpkt_put_cstring(ssh, buf)) != 0 ||\n\t    (r = sshpkt_put_cstring(ssh, \"\")) != 0 ||\n\t    (r = sshpkt_send(ssh)) != 0)\n\t\treturn r;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dh_pub_is_valid",
          "args": [
            "kex->dh",
            "dh_server_pub"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "dh_pub_is_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
          "lines": "222-268",
          "snippet": "int\ndh_pub_is_valid(const DH *dh, const BIGNUM *dh_pub)\n{\n\tint i;\n\tint n = BN_num_bits(dh_pub);\n\tint bits_set = 0;\n\tBIGNUM *tmp;\n\tconst BIGNUM *dh_p;\n\n\tDH_get0_pqg(dh, &dh_p, NULL, NULL);\n\n\tif (BN_is_negative(dh_pub)) {\n\t\tlogit(\"invalid public DH value: negative\");\n\t\treturn 0;\n\t}\n\tif (BN_cmp(dh_pub, BN_value_one()) != 1) {\t/* pub_exp <= 1 */\n\t\tlogit(\"invalid public DH value: <= 1\");\n\t\treturn 0;\n\t}\n\n\tif ((tmp = BN_new()) == NULL) {\n\t\terror(\"%s: BN_new failed\", __func__);\n\t\treturn 0;\n\t}\n\tif (!BN_sub(tmp, dh_p, BN_value_one()) ||\n\t    BN_cmp(dh_pub, tmp) != -1) {\t\t/* pub_exp > p-2 */\n\t\tBN_clear_free(tmp);\n\t\tlogit(\"invalid public DH value: >= p-1\");\n\t\treturn 0;\n\t}\n\tBN_clear_free(tmp);\n\n\tfor (i = 0; i <= n; i++)\n\t\tif (BN_is_bit_set(dh_pub, i))\n\t\t\tbits_set++;\n\tdebug2(\"bits set: %d/%d\", bits_set, BN_num_bits(dh_p));\n\n\t/*\n\t * if g==2 and bits_set==1 then computing log_g(dh_pub) is trivial\n\t */\n\tif (bits_set < 4) {\n\t\tlogit(\"invalid public DH value (%d/%d)\",\n\t\t   bits_set, BN_num_bits(dh_p));\n\t\treturn 0;\n\t}\n\treturn 1;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"dh.h\"",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <openssl/dh.h>",
            "#include <openssl/bn.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nint\ndh_pub_is_valid(const DH *dh, const BIGNUM *dh_pub)\n{\n\tint i;\n\tint n = BN_num_bits(dh_pub);\n\tint bits_set = 0;\n\tBIGNUM *tmp;\n\tconst BIGNUM *dh_p;\n\n\tDH_get0_pqg(dh, &dh_p, NULL, NULL);\n\n\tif (BN_is_negative(dh_pub)) {\n\t\tlogit(\"invalid public DH value: negative\");\n\t\treturn 0;\n\t}\n\tif (BN_cmp(dh_pub, BN_value_one()) != 1) {\t/* pub_exp <= 1 */\n\t\tlogit(\"invalid public DH value: <= 1\");\n\t\treturn 0;\n\t}\n\n\tif ((tmp = BN_new()) == NULL) {\n\t\terror(\"%s: BN_new failed\", __func__);\n\t\treturn 0;\n\t}\n\tif (!BN_sub(tmp, dh_p, BN_value_one()) ||\n\t    BN_cmp(dh_pub, tmp) != -1) {\t\t/* pub_exp > p-2 */\n\t\tBN_clear_free(tmp);\n\t\tlogit(\"invalid public DH value: >= p-1\");\n\t\treturn 0;\n\t}\n\tBN_clear_free(tmp);\n\n\tfor (i = 0; i <= n; i++)\n\t\tif (BN_is_bit_set(dh_pub, i))\n\t\t\tbits_set++;\n\tdebug2(\"bits set: %d/%d\", bits_set, BN_num_bits(dh_p));\n\n\t/*\n\t * if g==2 and bits_set==1 then computing log_g(dh_pub) is trivial\n\t */\n\tif (bits_set < 4) {\n\t\tlogit(\"invalid public DH value (%d/%d)\",\n\t\t   bits_set, BN_num_bits(dh_p));\n\t\treturn 0;\n\t}\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"bits %d\"",
            "BN_num_bits(dh_server_pub)"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_num_bits",
          "args": [
            "dh_server_pub"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"\\n\""
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_print_fp",
          "args": [
            "stderr",
            "dh_server_pub"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"dh_server_pub= \""
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshpkt_get_end",
          "args": [
            "ssh"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "sshpkt_get_end",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "2555-2561",
          "snippet": "int\nsshpkt_get_end(struct ssh *ssh)\n{\n\tif (sshbuf_len(ssh->state->incoming_packet) > 0)\n\t\treturn SSH_ERR_UNEXPECTED_TRAILING_DATA;\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshpkt_get_end(struct ssh *ssh)\n{\n\tif (sshbuf_len(ssh->state->incoming_packet) > 0)\n\t\treturn SSH_ERR_UNEXPECTED_TRAILING_DATA;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshpkt_get_string",
          "args": [
            "ssh",
            "&signature",
            "&slen"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "sshpkt_get_string_direct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "2520-2524",
          "snippet": "int\nsshpkt_get_string_direct(struct ssh *ssh, const u_char **valp, size_t *lenp)\n{\n\treturn sshbuf_get_string_direct(ssh->state->incoming_packet, valp, lenp);\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshpkt_get_string_direct(struct ssh *ssh, const u_char **valp, size_t *lenp)\n{\n\treturn sshbuf_get_string_direct(ssh->state->incoming_packet, valp, lenp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshpkt_get_bignum2",
          "args": [
            "ssh",
            "dh_server_pub"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "sshpkt_get_bignum2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "2548-2552",
          "snippet": "int\nsshpkt_get_bignum2(struct ssh *ssh, BIGNUM *v)\n{\n\treturn sshbuf_get_bignum2(ssh->state->incoming_packet, v);\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshpkt_get_bignum2(struct ssh *ssh, BIGNUM *v)\n{\n\treturn sshbuf_get_bignum2(ssh->state->incoming_packet, v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kex->verify_host_key",
          "args": [
            "server_host_key",
            "ssh"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshkey_from_blob",
          "args": [
            "server_host_key_blob",
            "sbloblen",
            "&server_host_key"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "sshkey_from_blob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshkey.c",
          "lines": "2263-2274",
          "snippet": "int\nsshkey_from_blob(const u_char *blob, size_t blen, struct sshkey **keyp)\n{\n\tstruct sshbuf *b;\n\tint r;\n\n\tif ((b = sshbuf_from(blob, blen)) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tr = sshkey_from_blob_internal(b, keyp, 1);\n\tsshbuf_free(b);\n\treturn r;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"xmss_fast.h\"",
            "#include \"match.h\"",
            "#include \"sshkey-xmss.h\"",
            "#include \"sshkey.h\"",
            "#include \"digest.h\"",
            "#include \"cipher.h\"",
            "#include \"sshbuf.h\"",
            "#include \"misc.h\"",
            "#include \"ssherr.h\"",
            "#include \"ssh2.h\"",
            "#include <util.h>",
            "#include <resolv.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include \"crypto_api.h\"",
            "#include <openssl/pem.h>",
            "#include <openssl/err.h>",
            "#include <openssl/evp.h>",
            "#include <netinet/in.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"xmss_fast.h\"\n#include \"match.h\"\n#include \"sshkey-xmss.h\"\n#include \"sshkey.h\"\n#include \"digest.h\"\n#include \"cipher.h\"\n#include \"sshbuf.h\"\n#include \"misc.h\"\n#include \"ssherr.h\"\n#include \"ssh2.h\"\n#include <util.h>\n#include <resolv.h>\n#include <string.h>\n#include <stdio.h>\n#include <limits.h>\n#include <errno.h>\n#include \"crypto_api.h\"\n#include <openssl/pem.h>\n#include <openssl/err.h>\n#include <openssl/evp.h>\n#include <netinet/in.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshkey_from_blob(const u_char *blob, size_t blen, struct sshkey **keyp)\n{\n\tstruct sshbuf *b;\n\tint r;\n\n\tif ((b = sshbuf_from(blob, blen)) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tr = sshkey_from_blob_internal(b, keyp, 1);\n\tsshbuf_free(b);\n\treturn r;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"dispatch.h\"\n#include \"ssh2.h\"\n#include \"dh.h\"\n#include \"packet.h\"\n#include \"log.h\"\n#include \"kex.h\"\n#include \"digest.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <signal.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <openssl/dh.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\ninput_kex_dh(int type, u_int32_t seq, struct ssh *ssh)\n{\n\tstruct kex *kex = ssh->kex;\n\tBIGNUM *dh_server_pub = NULL, *shared_secret = NULL;\n\tconst BIGNUM *pub_key;\n\tstruct sshkey *server_host_key = NULL;\n\tu_char *kbuf = NULL, *server_host_key_blob = NULL, *signature = NULL;\n\tu_char hash[SSH_DIGEST_MAX_LENGTH];\n\tsize_t klen = 0, slen, sbloblen, hashlen;\n\tint kout, r;\n\n\tif (kex->verify_host_key == NULL) {\n\t\tr = SSH_ERR_INVALID_ARGUMENT;\n\t\tgoto out;\n\t}\n\t/* key, cert */\n\tif ((r = sshpkt_get_string(ssh, &server_host_key_blob,\n\t    &sbloblen)) != 0 ||\n\t    (r = sshkey_from_blob(server_host_key_blob, sbloblen,\n\t    &server_host_key)) != 0)\n\t\tgoto out;\n\tif (server_host_key->type != kex->hostkey_type ||\n\t    (kex->hostkey_type == KEY_ECDSA &&\n\t    server_host_key->ecdsa_nid != kex->hostkey_nid)) {\n\t\tr = SSH_ERR_KEY_TYPE_MISMATCH;\n\t\tgoto out;\n\t}\n\tif (kex->verify_host_key(server_host_key, ssh) == -1) {\n\t\tr = SSH_ERR_SIGNATURE_INVALID;\n\t\tgoto out;\n\t}\n\t/* DH parameter f, server public DH key */\n\tif ((dh_server_pub = BN_new()) == NULL) {\n\t\tr = SSH_ERR_ALLOC_FAIL;\n\t\tgoto out;\n\t}\n\t/* signed H */\n\tif ((r = sshpkt_get_bignum2(ssh, dh_server_pub)) != 0 ||\n\t    (r = sshpkt_get_string(ssh, &signature, &slen)) != 0 ||\n\t    (r = sshpkt_get_end(ssh)) != 0)\n\t\tgoto out;\n#ifdef DEBUG_KEXDH\n\tfprintf(stderr, \"dh_server_pub= \");\n\tBN_print_fp(stderr, dh_server_pub);\n\tfprintf(stderr, \"\\n\");\n\tdebug(\"bits %d\", BN_num_bits(dh_server_pub));\n#endif\n\tif (!dh_pub_is_valid(kex->dh, dh_server_pub)) {\n\t\tsshpkt_disconnect(ssh, \"bad server public DH value\");\n\t\tr = SSH_ERR_MESSAGE_INCOMPLETE;\n\t\tgoto out;\n\t}\n\n\tklen = DH_size(kex->dh);\n\tif ((kbuf = malloc(klen)) == NULL ||\n\t    (shared_secret = BN_new()) == NULL) {\n\t\tr = SSH_ERR_ALLOC_FAIL;\n\t\tgoto out;\n\t}\n\tif ((kout = DH_compute_key(kbuf, dh_server_pub, kex->dh)) < 0 ||\n\t    BN_bin2bn(kbuf, kout, shared_secret) == NULL) {\n\t\tr = SSH_ERR_LIBCRYPTO_ERROR;\n\t\tgoto out;\n\t}\n#ifdef DEBUG_KEXDH\n\tdump_digest(\"shared secret\", kbuf, kout);\n#endif\n\n\t/* calc and verify H */\n\tDH_get0_key(kex->dh, &pub_key, NULL);\n\thashlen = sizeof(hash);\n\tif ((r = kex_dh_hash(\n\t    kex->hash_alg,\n\t    kex->client_version_string,\n\t    kex->server_version_string,\n\t    sshbuf_ptr(kex->my), sshbuf_len(kex->my),\n\t    sshbuf_ptr(kex->peer), sshbuf_len(kex->peer),\n\t    server_host_key_blob, sbloblen,\n\t    pub_key,\n\t    dh_server_pub,\n\t    shared_secret,\n\t    hash, &hashlen)) != 0)\n\t\tgoto out;\n\n\tif ((r = sshkey_verify(server_host_key, signature, slen, hash, hashlen,\n\t    kex->hostkey_alg, ssh->compat)) != 0)\n\t\tgoto out;\n\n\t/* save session id */\n\tif (kex->session_id == NULL) {\n\t\tkex->session_id_len = hashlen;\n\t\tkex->session_id = malloc(kex->session_id_len);\n\t\tif (kex->session_id == NULL) {\n\t\t\tr = SSH_ERR_ALLOC_FAIL;\n\t\t\tgoto out;\n\t\t}\n\t\tmemcpy(kex->session_id, hash, kex->session_id_len);\n\t}\n\n\tif ((r = kex_derive_keys_bn(ssh, hash, hashlen, shared_secret)) == 0)\n\t\tr = kex_send_newkeys(ssh);\n out:\n\texplicit_bzero(hash, sizeof(hash));\n\tDH_free(kex->dh);\n\tkex->dh = NULL;\n\tBN_clear_free(dh_server_pub);\n\tif (kbuf) {\n\t\texplicit_bzero(kbuf, klen);\n\t\tfree(kbuf);\n\t}\n\tBN_clear_free(shared_secret);\n\tsshkey_free(server_host_key);\n\tfree(server_host_key_blob);\n\tfree(signature);\n\treturn r;\n}"
  },
  {
    "function_name": "kexdh_client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/kexdhc.c",
    "lines": "56-105",
    "snippet": "int\nkexdh_client(struct ssh *ssh)\n{\n\tstruct kex *kex = ssh->kex;\n\tint r;\n\tconst BIGNUM *pub_key;\n\n\t/* generate and send 'e', client DH public key */\n\tswitch (kex->kex_type) {\n\tcase KEX_DH_GRP1_SHA1:\n\t\tkex->dh = dh_new_group1();\n\t\tbreak;\n\tcase KEX_DH_GRP14_SHA1:\n\tcase KEX_DH_GRP14_SHA256:\n\t\tkex->dh = dh_new_group14();\n\t\tbreak;\n\tcase KEX_DH_GRP16_SHA512:\n\t\tkex->dh = dh_new_group16();\n\t\tbreak;\n\tcase KEX_DH_GRP18_SHA512:\n\t\tkex->dh = dh_new_group18();\n\t\tbreak;\n\tdefault:\n\t\tr = SSH_ERR_INVALID_ARGUMENT;\n\t\tgoto out;\n\t}\n\tif (kex->dh == NULL) {\n\t\tr = SSH_ERR_ALLOC_FAIL;\n\t\tgoto out;\n\t}\n\tdebug(\"sending SSH2_MSG_KEXDH_INIT\");\n\tif ((r = dh_gen_key(kex->dh, kex->we_need * 8)) != 0)\n\t\tgoto out;\n\tDH_get0_key(kex->dh, &pub_key, NULL);\n\tif ((r = sshpkt_start(ssh, SSH2_MSG_KEXDH_INIT)) != 0 ||\n\t    (r = sshpkt_put_bignum2(ssh, pub_key)) != 0 ||\n\t    (r = sshpkt_send(ssh)) != 0)\n\t\tgoto out;\n#ifdef DEBUG_KEXDH\n\tDHparams_print_fp(stderr, kex->dh);\n\tfprintf(stderr, \"pub= \");\n\tBN_print_fp(stderr, pub_key);\n\tfprintf(stderr, \"\\n\");\n#endif\n\tdebug(\"expecting SSH2_MSG_KEXDH_REPLY\");\n\tssh_dispatch_set(ssh, SSH2_MSG_KEXDH_REPLY, &input_kex_dh);\n\tr = 0;\n out:\n\treturn r;\n}",
    "includes": [
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"compat.h\"",
      "#include \"dispatch.h\"",
      "#include \"ssh2.h\"",
      "#include \"dh.h\"",
      "#include \"packet.h\"",
      "#include \"log.h\"",
      "#include \"kex.h\"",
      "#include \"digest.h\"",
      "#include \"cipher.h\"",
      "#include \"sshkey.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include <signal.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <openssl/dh.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_dispatch_set",
          "args": [
            "ssh",
            "SSH2_MSG_KEXDH_REPLY",
            "&input_kex_dh"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_dispatch_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dispatch.c",
          "lines": "81-85",
          "snippet": "void\nssh_dispatch_set(struct ssh *ssh, int type, dispatch_fn *fn)\n{\n\tssh->dispatch[type] = fn;\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include \"compat.h\"",
            "#include \"packet.h\"",
            "#include \"dispatch.h\"",
            "#include \"log.h\"",
            "#include \"ssh2.h\"",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"packet.h\"\n#include \"dispatch.h\"\n#include \"log.h\"\n#include \"ssh2.h\"\n#include <stdarg.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_dispatch_set(struct ssh *ssh, int type, dispatch_fn *fn)\n{\n\tssh->dispatch[type] = fn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"expecting SSH2_MSG_KEXDH_REPLY\""
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"\\n\""
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_print_fp",
          "args": [
            "stderr",
            "pub_key"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"pub= \""
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DHparams_print_fp",
          "args": [
            "stderr",
            "kex->dh"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshpkt_send",
          "args": [
            "ssh"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "sshpkt_send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "2648-2654",
          "snippet": "int\nsshpkt_send(struct ssh *ssh)\n{\n\tif (ssh->state && ssh->state->mux)\n\t\treturn ssh_packet_send_mux(ssh);\n\treturn ssh_packet_send2(ssh);\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshpkt_send(struct ssh *ssh)\n{\n\tif (ssh->state && ssh->state->mux)\n\t\treturn ssh_packet_send_mux(ssh);\n\treturn ssh_packet_send2(ssh);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshpkt_put_bignum2",
          "args": [
            "ssh",
            "pub_key"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "sshpkt_put_bignum2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "2481-2485",
          "snippet": "int\nsshpkt_put_bignum2(struct ssh *ssh, const BIGNUM *v)\n{\n\treturn sshbuf_put_bignum2(ssh->state->outgoing_packet, v);\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshpkt_put_bignum2(struct ssh *ssh, const BIGNUM *v)\n{\n\treturn sshbuf_put_bignum2(ssh->state->outgoing_packet, v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshpkt_start",
          "args": [
            "ssh",
            "SSH2_MSG_KEXDH_INIT"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "sshpkt_start",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "2573-2583",
          "snippet": "int\nsshpkt_start(struct ssh *ssh, u_char type)\n{\n\tu_char buf[6]; /* u32 packet length, u8 pad len, u8 type */\n\n\tDBG(debug(\"packet_start[%d]\", type));\n\tmemset(buf, 0, sizeof(buf));\n\tbuf[sizeof(buf) - 1] = type;\n\tsshbuf_reset(ssh->state->outgoing_packet);\n\treturn sshbuf_put(ssh->state->outgoing_packet, buf, sizeof(buf));\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshpkt_start(struct ssh *ssh, u_char type)\n{\n\tu_char buf[6]; /* u32 packet length, u8 pad len, u8 type */\n\n\tDBG(debug(\"packet_start[%d]\", type));\n\tmemset(buf, 0, sizeof(buf));\n\tbuf[sizeof(buf) - 1] = type;\n\tsshbuf_reset(ssh->state->outgoing_packet);\n\treturn sshbuf_put(ssh->state->outgoing_packet, buf, sizeof(buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "DH_get0_key",
          "args": [
            "kex->dh",
            "&pub_key",
            "NULL"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "DH_get0_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "488-495",
          "snippet": "void\nDH_get0_key(const DH *dh, const BIGNUM **pub_key, const BIGNUM **priv_key)\n{\n\tif (pub_key != NULL)\n\t\t*pub_key = dh->pub_key;\n\tif (priv_key != NULL)\n\t\t*priv_key = dh->priv_key;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nDH_get0_key(const DH *dh, const BIGNUM **pub_key, const BIGNUM **priv_key)\n{\n\tif (pub_key != NULL)\n\t\t*pub_key = dh->pub_key;\n\tif (priv_key != NULL)\n\t\t*priv_key = dh->priv_key;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dh_gen_key",
          "args": [
            "kex->dh",
            "kex->we_need * 8"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "dh_gen_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
          "lines": "270-297",
          "snippet": "int\ndh_gen_key(DH *dh, int need)\n{\n\tint pbits;\n\tconst BIGNUM *dh_p, *pub_key;\n\n\tDH_get0_pqg(dh, &dh_p, NULL, NULL);\n\n\tif (need < 0 || dh_p == NULL ||\n\t    (pbits = BN_num_bits(dh_p)) <= 0 ||\n\t    need > INT_MAX / 2 || 2 * need > pbits)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (need < 256)\n\t\tneed = 256;\n\t/*\n\t * Pollard Rho, Big step/Little Step attacks are O(sqrt(n)),\n\t * so double requested need here.\n\t */\n\tif (!DH_set_length(dh, MINIMUM(need * 2, pbits - 1)))\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\n\tif (DH_generate_key(dh) == 0)\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\tDH_get0_key(dh, &pub_key, NULL);\n\tif (!dh_pub_is_valid(dh, pub_key))\n\t\treturn SSH_ERR_INVALID_FORMAT;\n\treturn 0;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"dh.h\"",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <openssl/dh.h>",
            "#include <openssl/bn.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nint\ndh_gen_key(DH *dh, int need)\n{\n\tint pbits;\n\tconst BIGNUM *dh_p, *pub_key;\n\n\tDH_get0_pqg(dh, &dh_p, NULL, NULL);\n\n\tif (need < 0 || dh_p == NULL ||\n\t    (pbits = BN_num_bits(dh_p)) <= 0 ||\n\t    need > INT_MAX / 2 || 2 * need > pbits)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (need < 256)\n\t\tneed = 256;\n\t/*\n\t * Pollard Rho, Big step/Little Step attacks are O(sqrt(n)),\n\t * so double requested need here.\n\t */\n\tif (!DH_set_length(dh, MINIMUM(need * 2, pbits - 1)))\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\n\tif (DH_generate_key(dh) == 0)\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\tDH_get0_key(dh, &pub_key, NULL);\n\tif (!dh_pub_is_valid(dh, pub_key))\n\t\treturn SSH_ERR_INVALID_FORMAT;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dh_new_group18",
          "args": [],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "dh_new_group18",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
          "lines": "406-455",
          "snippet": "DH *\ndh_new_group18(void)\n{\n\tstatic char *gen = \"2\", *group18 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AAAC42D\" \"AD33170D\" \"04507A33\" \"A85521AB\" \"DF1CBA64\"\n\t    \"ECFB8504\" \"58DBEF0A\" \"8AEA7157\" \"5D060C7D\" \"B3970F85\" \"A6E1E4C7\"\n\t    \"ABF5AE8C\" \"DB0933D7\" \"1E8C94E0\" \"4A25619D\" \"CEE3D226\" \"1AD2EE6B\"\n\t    \"F12FFA06\" \"D98A0864\" \"D8760273\" \"3EC86A64\" \"521F2B18\" \"177B200C\"\n\t    \"BBE11757\" \"7A615D6C\" \"770988C0\" \"BAD946E2\" \"08E24FA0\" \"74E5AB31\"\n\t    \"43DB5BFC\" \"E0FD108E\" \"4B82D120\" \"A9210801\" \"1A723C12\" \"A787E6D7\"\n\t    \"88719A10\" \"BDBA5B26\" \"99C32718\" \"6AF4E23C\" \"1A946834\" \"B6150BDA\"\n\t    \"2583E9CA\" \"2AD44CE8\" \"DBBBC2DB\" \"04DE8EF9\" \"2E8EFC14\" \"1FBECAA6\"\n\t    \"287C5947\" \"4E6BC05D\" \"99B2964F\" \"A090C3A2\" \"233BA186\" \"515BE7ED\"\n\t    \"1F612970\" \"CEE2D7AF\" \"B81BDD76\" \"2170481C\" \"D0069127\" \"D5B05AA9\"\n\t    \"93B4EA98\" \"8D8FDDC1\" \"86FFB7DC\" \"90A6C08F\" \"4DF435C9\" \"34028492\"\n\t    \"36C3FAB4\" \"D27C7026\" \"C1D4DCB2\" \"602646DE\" \"C9751E76\" \"3DBA37BD\"\n\t    \"F8FF9406\" \"AD9E530E\" \"E5DB382F\" \"413001AE\" \"B06A53ED\" \"9027D831\"\n\t    \"179727B0\" \"865A8918\" \"DA3EDBEB\" \"CF9B14ED\" \"44CE6CBA\" \"CED4BB1B\"\n\t    \"DB7F1447\" \"E6CC254B\" \"33205151\" \"2BD7AF42\" \"6FB8F401\" \"378CD2BF\"\n\t    \"5983CA01\" \"C64B92EC\" \"F032EA15\" \"D1721D03\" \"F482D7CE\" \"6E74FEF6\"\n\t    \"D55E702F\" \"46980C82\" \"B5A84031\" \"900B1C9E\" \"59E7C97F\" \"BEC7E8F3\"\n\t    \"23A97A7E\" \"36CC88BE\" \"0F1D45B7\" \"FF585AC5\" \"4BD407B2\" \"2B4154AA\"\n\t    \"CC8F6D7E\" \"BF48E1D8\" \"14CC5ED2\" \"0F8037E0\" \"A79715EE\" \"F29BE328\"\n\t    \"06A1D58B\" \"B7C5DA76\" \"F550AA3D\" \"8A1FBFF0\" \"EB19CCB1\" \"A313D55C\"\n\t    \"DA56C9EC\" \"2EF29632\" \"387FE8D7\" \"6E3C0468\" \"043E8F66\" \"3F4860EE\"\n\t    \"12BF2D5B\" \"0B7474D6\" \"E694F91E\" \"6DBE1159\" \"74A3926F\" \"12FEE5E4\"\n\t    \"38777CB6\" \"A932DF8C\" \"D8BEC4D0\" \"73B931BA\" \"3BC832B6\" \"8D9DD300\"\n\t    \"741FA7BF\" \"8AFC47ED\" \"2576F693\" \"6BA42466\" \"3AAB639C\" \"5AE4F568\"\n\t    \"3423B474\" \"2BF1C978\" \"238F16CB\" \"E39D652D\" \"E3FDB8BE\" \"FC848AD9\"\n\t    \"22222E04\" \"A4037C07\" \"13EB57A8\" \"1A23F0C7\" \"3473FC64\" \"6CEA306B\"\n\t    \"4BCBC886\" \"2F8385DD\" \"FA9D4B7F\" \"A2C087E8\" \"79683303\" \"ED5BDD3A\"\n\t    \"062B3CF5\" \"B3A278A6\" \"6D2A13F8\" \"3F44F82D\" \"DF310EE0\" \"74AB6A36\"\n\t    \"4597E899\" \"A0255DC1\" \"64F31CC5\" \"0846851D\" \"F9AB4819\" \"5DED7EA1\"\n\t    \"B1D510BD\" \"7EE74D73\" \"FAF36BC3\" \"1ECFA268\" \"359046F4\" \"EB879F92\"\n\t    \"4009438B\" \"481C6CD7\" \"889A002E\" \"D5EE382B\" \"C9190DA6\" \"FC026E47\"\n\t    \"9558E447\" \"5677E9AA\" \"9E3050E2\" \"765694DF\" \"C81F56E8\" \"80B96E71\"\n\t    \"60C980DD\" \"98EDD3DF\" \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group18));\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"dh.h\"",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <openssl/dh.h>",
            "#include <openssl/bn.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group18(void)\n{\n\tstatic char *gen = \"2\", *group18 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AAAC42D\" \"AD33170D\" \"04507A33\" \"A85521AB\" \"DF1CBA64\"\n\t    \"ECFB8504\" \"58DBEF0A\" \"8AEA7157\" \"5D060C7D\" \"B3970F85\" \"A6E1E4C7\"\n\t    \"ABF5AE8C\" \"DB0933D7\" \"1E8C94E0\" \"4A25619D\" \"CEE3D226\" \"1AD2EE6B\"\n\t    \"F12FFA06\" \"D98A0864\" \"D8760273\" \"3EC86A64\" \"521F2B18\" \"177B200C\"\n\t    \"BBE11757\" \"7A615D6C\" \"770988C0\" \"BAD946E2\" \"08E24FA0\" \"74E5AB31\"\n\t    \"43DB5BFC\" \"E0FD108E\" \"4B82D120\" \"A9210801\" \"1A723C12\" \"A787E6D7\"\n\t    \"88719A10\" \"BDBA5B26\" \"99C32718\" \"6AF4E23C\" \"1A946834\" \"B6150BDA\"\n\t    \"2583E9CA\" \"2AD44CE8\" \"DBBBC2DB\" \"04DE8EF9\" \"2E8EFC14\" \"1FBECAA6\"\n\t    \"287C5947\" \"4E6BC05D\" \"99B2964F\" \"A090C3A2\" \"233BA186\" \"515BE7ED\"\n\t    \"1F612970\" \"CEE2D7AF\" \"B81BDD76\" \"2170481C\" \"D0069127\" \"D5B05AA9\"\n\t    \"93B4EA98\" \"8D8FDDC1\" \"86FFB7DC\" \"90A6C08F\" \"4DF435C9\" \"34028492\"\n\t    \"36C3FAB4\" \"D27C7026\" \"C1D4DCB2\" \"602646DE\" \"C9751E76\" \"3DBA37BD\"\n\t    \"F8FF9406\" \"AD9E530E\" \"E5DB382F\" \"413001AE\" \"B06A53ED\" \"9027D831\"\n\t    \"179727B0\" \"865A8918\" \"DA3EDBEB\" \"CF9B14ED\" \"44CE6CBA\" \"CED4BB1B\"\n\t    \"DB7F1447\" \"E6CC254B\" \"33205151\" \"2BD7AF42\" \"6FB8F401\" \"378CD2BF\"\n\t    \"5983CA01\" \"C64B92EC\" \"F032EA15\" \"D1721D03\" \"F482D7CE\" \"6E74FEF6\"\n\t    \"D55E702F\" \"46980C82\" \"B5A84031\" \"900B1C9E\" \"59E7C97F\" \"BEC7E8F3\"\n\t    \"23A97A7E\" \"36CC88BE\" \"0F1D45B7\" \"FF585AC5\" \"4BD407B2\" \"2B4154AA\"\n\t    \"CC8F6D7E\" \"BF48E1D8\" \"14CC5ED2\" \"0F8037E0\" \"A79715EE\" \"F29BE328\"\n\t    \"06A1D58B\" \"B7C5DA76\" \"F550AA3D\" \"8A1FBFF0\" \"EB19CCB1\" \"A313D55C\"\n\t    \"DA56C9EC\" \"2EF29632\" \"387FE8D7\" \"6E3C0468\" \"043E8F66\" \"3F4860EE\"\n\t    \"12BF2D5B\" \"0B7474D6\" \"E694F91E\" \"6DBE1159\" \"74A3926F\" \"12FEE5E4\"\n\t    \"38777CB6\" \"A932DF8C\" \"D8BEC4D0\" \"73B931BA\" \"3BC832B6\" \"8D9DD300\"\n\t    \"741FA7BF\" \"8AFC47ED\" \"2576F693\" \"6BA42466\" \"3AAB639C\" \"5AE4F568\"\n\t    \"3423B474\" \"2BF1C978\" \"238F16CB\" \"E39D652D\" \"E3FDB8BE\" \"FC848AD9\"\n\t    \"22222E04\" \"A4037C07\" \"13EB57A8\" \"1A23F0C7\" \"3473FC64\" \"6CEA306B\"\n\t    \"4BCBC886\" \"2F8385DD\" \"FA9D4B7F\" \"A2C087E8\" \"79683303\" \"ED5BDD3A\"\n\t    \"062B3CF5\" \"B3A278A6\" \"6D2A13F8\" \"3F44F82D\" \"DF310EE0\" \"74AB6A36\"\n\t    \"4597E899\" \"A0255DC1\" \"64F31CC5\" \"0846851D\" \"F9AB4819\" \"5DED7EA1\"\n\t    \"B1D510BD\" \"7EE74D73\" \"FAF36BC3\" \"1ECFA268\" \"359046F4\" \"EB879F92\"\n\t    \"4009438B\" \"481C6CD7\" \"889A002E\" \"D5EE382B\" \"C9190DA6\" \"FC026E47\"\n\t    \"9558E447\" \"5677E9AA\" \"9E3050E2\" \"765694DF\" \"C81F56E8\" \"80B96E71\"\n\t    \"60C980DD\" \"98EDD3DF\" \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group18));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dh_new_group16",
          "args": [],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "dh_new_group16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
          "lines": "375-403",
          "snippet": "DH *\ndh_new_group16(void)\n{\n\tstatic char *gen = \"2\", *group16 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AAAC42D\" \"AD33170D\" \"04507A33\" \"A85521AB\" \"DF1CBA64\"\n\t    \"ECFB8504\" \"58DBEF0A\" \"8AEA7157\" \"5D060C7D\" \"B3970F85\" \"A6E1E4C7\"\n\t    \"ABF5AE8C\" \"DB0933D7\" \"1E8C94E0\" \"4A25619D\" \"CEE3D226\" \"1AD2EE6B\"\n\t    \"F12FFA06\" \"D98A0864\" \"D8760273\" \"3EC86A64\" \"521F2B18\" \"177B200C\"\n\t    \"BBE11757\" \"7A615D6C\" \"770988C0\" \"BAD946E2\" \"08E24FA0\" \"74E5AB31\"\n\t    \"43DB5BFC\" \"E0FD108E\" \"4B82D120\" \"A9210801\" \"1A723C12\" \"A787E6D7\"\n\t    \"88719A10\" \"BDBA5B26\" \"99C32718\" \"6AF4E23C\" \"1A946834\" \"B6150BDA\"\n\t    \"2583E9CA\" \"2AD44CE8\" \"DBBBC2DB\" \"04DE8EF9\" \"2E8EFC14\" \"1FBECAA6\"\n\t    \"287C5947\" \"4E6BC05D\" \"99B2964F\" \"A090C3A2\" \"233BA186\" \"515BE7ED\"\n\t    \"1F612970\" \"CEE2D7AF\" \"B81BDD76\" \"2170481C\" \"D0069127\" \"D5B05AA9\"\n\t    \"93B4EA98\" \"8D8FDDC1\" \"86FFB7DC\" \"90A6C08F\" \"4DF435C9\" \"34063199\"\n\t    \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group16));\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"dh.h\"",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <openssl/dh.h>",
            "#include <openssl/bn.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group16(void)\n{\n\tstatic char *gen = \"2\", *group16 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AAAC42D\" \"AD33170D\" \"04507A33\" \"A85521AB\" \"DF1CBA64\"\n\t    \"ECFB8504\" \"58DBEF0A\" \"8AEA7157\" \"5D060C7D\" \"B3970F85\" \"A6E1E4C7\"\n\t    \"ABF5AE8C\" \"DB0933D7\" \"1E8C94E0\" \"4A25619D\" \"CEE3D226\" \"1AD2EE6B\"\n\t    \"F12FFA06\" \"D98A0864\" \"D8760273\" \"3EC86A64\" \"521F2B18\" \"177B200C\"\n\t    \"BBE11757\" \"7A615D6C\" \"770988C0\" \"BAD946E2\" \"08E24FA0\" \"74E5AB31\"\n\t    \"43DB5BFC\" \"E0FD108E\" \"4B82D120\" \"A9210801\" \"1A723C12\" \"A787E6D7\"\n\t    \"88719A10\" \"BDBA5B26\" \"99C32718\" \"6AF4E23C\" \"1A946834\" \"B6150BDA\"\n\t    \"2583E9CA\" \"2AD44CE8\" \"DBBBC2DB\" \"04DE8EF9\" \"2E8EFC14\" \"1FBECAA6\"\n\t    \"287C5947\" \"4E6BC05D\" \"99B2964F\" \"A090C3A2\" \"233BA186\" \"515BE7ED\"\n\t    \"1F612970\" \"CEE2D7AF\" \"B81BDD76\" \"2170481C\" \"D0069127\" \"D5B05AA9\"\n\t    \"93B4EA98\" \"8D8FDDC1\" \"86FFB7DC\" \"90A6C08F\" \"4DF435C9\" \"34063199\"\n\t    \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group16));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dh_new_group14",
          "args": [],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "dh_new_group14",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
          "lines": "355-372",
          "snippet": "DH *\ndh_new_group14(void)\n{\n\tstatic char *gen = \"2\", *group14 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AACAA68\" \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group14));\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"dh.h\"",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <openssl/dh.h>",
            "#include <openssl/bn.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group14(void)\n{\n\tstatic char *gen = \"2\", *group14 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AACAA68\" \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group14));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"compat.h\"\n#include \"dispatch.h\"\n#include \"ssh2.h\"\n#include \"dh.h\"\n#include \"packet.h\"\n#include \"log.h\"\n#include \"kex.h\"\n#include \"digest.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <signal.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <openssl/dh.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nkexdh_client(struct ssh *ssh)\n{\n\tstruct kex *kex = ssh->kex;\n\tint r;\n\tconst BIGNUM *pub_key;\n\n\t/* generate and send 'e', client DH public key */\n\tswitch (kex->kex_type) {\n\tcase KEX_DH_GRP1_SHA1:\n\t\tkex->dh = dh_new_group1();\n\t\tbreak;\n\tcase KEX_DH_GRP14_SHA1:\n\tcase KEX_DH_GRP14_SHA256:\n\t\tkex->dh = dh_new_group14();\n\t\tbreak;\n\tcase KEX_DH_GRP16_SHA512:\n\t\tkex->dh = dh_new_group16();\n\t\tbreak;\n\tcase KEX_DH_GRP18_SHA512:\n\t\tkex->dh = dh_new_group18();\n\t\tbreak;\n\tdefault:\n\t\tr = SSH_ERR_INVALID_ARGUMENT;\n\t\tgoto out;\n\t}\n\tif (kex->dh == NULL) {\n\t\tr = SSH_ERR_ALLOC_FAIL;\n\t\tgoto out;\n\t}\n\tdebug(\"sending SSH2_MSG_KEXDH_INIT\");\n\tif ((r = dh_gen_key(kex->dh, kex->we_need * 8)) != 0)\n\t\tgoto out;\n\tDH_get0_key(kex->dh, &pub_key, NULL);\n\tif ((r = sshpkt_start(ssh, SSH2_MSG_KEXDH_INIT)) != 0 ||\n\t    (r = sshpkt_put_bignum2(ssh, pub_key)) != 0 ||\n\t    (r = sshpkt_send(ssh)) != 0)\n\t\tgoto out;\n#ifdef DEBUG_KEXDH\n\tDHparams_print_fp(stderr, kex->dh);\n\tfprintf(stderr, \"pub= \");\n\tBN_print_fp(stderr, pub_key);\n\tfprintf(stderr, \"\\n\");\n#endif\n\tdebug(\"expecting SSH2_MSG_KEXDH_REPLY\");\n\tssh_dispatch_set(ssh, SSH2_MSG_KEXDH_REPLY, &input_kex_dh);\n\tr = 0;\n out:\n\treturn r;\n}"
  }
]