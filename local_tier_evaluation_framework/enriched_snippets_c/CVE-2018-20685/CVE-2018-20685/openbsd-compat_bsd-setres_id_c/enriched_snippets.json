[
  {
    "function_name": "setresuid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-setres_id.c",
    "lines": "63-97",
    "snippet": "int\nsetresuid(uid_t ruid, uid_t euid, uid_t suid)\n{\n\tint ret = 0, saved_errno;\n\n\tif (ruid != suid) {\n\t\terrno = ENOSYS;\n\t\treturn -1;\n\t}\n#if defined(HAVE_SETREUID) && !defined(BROKEN_SETREUID)\n\tif (setreuid(ruid, euid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setreuid %u: %.100s\", ruid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n#else\n\n# ifndef SETEUID_BREAKS_SETUID\n\tif (seteuid(euid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"seteuid %u: %.100s\", euid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n# endif\n\tif (setuid(ruid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setuid %u: %.100s\", ruid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n#endif\n\treturn ret;\n}",
    "includes": [
      "#include \"log.h\"",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"setuid %u: %.100s\"",
            "ruid",
            "strerror(errno)"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "162-170",
          "snippet": "void\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "errno"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "gai_strerror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/fake-rfc2553.c",
          "lines": "87-105",
          "snippet": "const char *\n#else\nchar *\n#endif\ngai_strerror(int err)\n{\n\tswitch (err) {\n\tcase EAI_NODATA:\n\t\treturn (\"no address associated with name\");\n\tcase EAI_MEMORY:\n\t\treturn (\"memory allocation failure.\");\n\tcase EAI_NONAME:\n\t\treturn (\"nodename nor servname provided, or not known\");\n\tcase EAI_FAMILY:\n\t\treturn (\"ai_family not supported\");\n\tdefault:\n\t\treturn (\"unknown/invalid error.\");\n\t}\n}",
          "includes": [
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <string.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nconst char *\n#else\nchar *\n#endif\ngai_strerror(int err)\n{\n\tswitch (err) {\n\tcase EAI_NODATA:\n\t\treturn (\"no address associated with name\");\n\tcase EAI_MEMORY:\n\t\treturn (\"memory allocation failure.\");\n\tcase EAI_NONAME:\n\t\treturn (\"nodename nor servname provided, or not known\");\n\tcase EAI_FAMILY:\n\t\treturn (\"ai_family not supported\");\n\tdefault:\n\t\treturn (\"unknown/invalid error.\");\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "setuid",
          "args": [
            "ruid"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seteuid",
          "args": [
            "euid"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "seteuid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
          "lines": "82-85",
          "snippet": "int seteuid(uid_t euid)\n{\n\treturn (setreuid(-1, euid));\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "# include <sys/time.h>",
            "# include <sys/select.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint seteuid(uid_t euid)\n{\n\treturn (setreuid(-1, euid));\n}"
        }
      },
      {
        "call_info": {
          "callee": "setreuid",
          "args": [
            "ruid",
            "euid"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include <string.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsetresuid(uid_t ruid, uid_t euid, uid_t suid)\n{\n\tint ret = 0, saved_errno;\n\n\tif (ruid != suid) {\n\t\terrno = ENOSYS;\n\t\treturn -1;\n\t}\n#if defined(HAVE_SETREUID) && !defined(BROKEN_SETREUID)\n\tif (setreuid(ruid, euid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setreuid %u: %.100s\", ruid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n#else\n\n# ifndef SETEUID_BREAKS_SETUID\n\tif (seteuid(euid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"seteuid %u: %.100s\", euid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n# endif\n\tif (setuid(ruid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setuid %u: %.100s\", ruid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n#endif\n\treturn ret;\n}"
  },
  {
    "function_name": "setresgid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-setres_id.c",
    "lines": "28-59",
    "snippet": "int\nsetresgid(gid_t rgid, gid_t egid, gid_t sgid)\n{\n\tint ret = 0, saved_errno;\n\n\tif (rgid != sgid) {\n\t\terrno = ENOSYS;\n\t\treturn -1;\n\t}\n#if defined(HAVE_SETREGID) && !defined(BROKEN_SETREGID)\n\tif (setregid(rgid, egid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setregid %u: %.100s\", rgid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n#else\n\tif (setegid(egid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setegid %u: %.100s\", (u_int)egid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n\tif (setgid(rgid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setgid %u: %.100s\", rgid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n#endif\n\treturn ret;\n}",
    "includes": [
      "#include \"log.h\"",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdarg.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"setgid %u: %.100s\"",
            "rgid",
            "strerror(errno)"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "162-170",
          "snippet": "void\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "errno"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "gai_strerror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/fake-rfc2553.c",
          "lines": "87-105",
          "snippet": "const char *\n#else\nchar *\n#endif\ngai_strerror(int err)\n{\n\tswitch (err) {\n\tcase EAI_NODATA:\n\t\treturn (\"no address associated with name\");\n\tcase EAI_MEMORY:\n\t\treturn (\"memory allocation failure.\");\n\tcase EAI_NONAME:\n\t\treturn (\"nodename nor servname provided, or not known\");\n\tcase EAI_FAMILY:\n\t\treturn (\"ai_family not supported\");\n\tdefault:\n\t\treturn (\"unknown/invalid error.\");\n\t}\n}",
          "includes": [
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <string.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nconst char *\n#else\nchar *\n#endif\ngai_strerror(int err)\n{\n\tswitch (err) {\n\tcase EAI_NODATA:\n\t\treturn (\"no address associated with name\");\n\tcase EAI_MEMORY:\n\t\treturn (\"memory allocation failure.\");\n\tcase EAI_NONAME:\n\t\treturn (\"nodename nor servname provided, or not known\");\n\tcase EAI_FAMILY:\n\t\treturn (\"ai_family not supported\");\n\tdefault:\n\t\treturn (\"unknown/invalid error.\");\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "setgid",
          "args": [
            "rgid"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setegid",
          "args": [
            "egid"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "setegid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
          "lines": "89-92",
          "snippet": "int setegid(uid_t egid)\n{\n\treturn(setresgid(-1, egid, -1));\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "# include <sys/time.h>",
            "# include <sys/select.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint setegid(uid_t egid)\n{\n\treturn(setresgid(-1, egid, -1));\n}"
        }
      },
      {
        "call_info": {
          "callee": "setregid",
          "args": [
            "rgid",
            "egid"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"log.h\"\n#include <string.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsetresgid(gid_t rgid, gid_t egid, gid_t sgid)\n{\n\tint ret = 0, saved_errno;\n\n\tif (rgid != sgid) {\n\t\terrno = ENOSYS;\n\t\treturn -1;\n\t}\n#if defined(HAVE_SETREGID) && !defined(BROKEN_SETREGID)\n\tif (setregid(rgid, egid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setregid %u: %.100s\", rgid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n#else\n\tif (setegid(egid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setegid %u: %.100s\", (u_int)egid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n\tif (setgid(rgid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setgid %u: %.100s\", rgid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n#endif\n\treturn ret;\n}"
  }
]