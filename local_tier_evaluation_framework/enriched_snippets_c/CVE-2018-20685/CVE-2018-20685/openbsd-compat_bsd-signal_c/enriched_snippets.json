[
  {
    "function_name": "strsignal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-signal.c",
    "lines": "54-60",
    "snippet": "char *strsignal(int sig)\n{\n\tstatic char buf[16];\n\n\t(void)snprintf(buf, sizeof(buf), \"%d\", sig);\n\treturn buf;\n}",
    "includes": [
      "#include \"openbsd-compat/bsd-signal.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"%d\"",
            "sig"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "snprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-snprintf.c",
          "lines": "869-879",
          "snippet": "int\nsnprintf(char *str, size_t count, SNPRINTF_CONST char *fmt, ...)\n{\n\tsize_t ret;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tret = vsnprintf(str, count, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include <errno.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <ctype.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <ctype.h>\n#include \"includes.h\"\n\nint\nsnprintf(char *str, size_t count, SNPRINTF_CONST char *fmt, ...)\n{\n\tsize_t ret;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tret = vsnprintf(str, count, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/bsd-signal.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include \"includes.h\"\n\nchar *strsignal(int sig)\n{\n\tstatic char buf[16];\n\n\t(void)snprintf(buf, sizeof(buf), \"%d\", sig);\n\treturn buf;\n}"
  },
  {
    "function_name": "mysignal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-signal.c",
    "lines": "27-51",
    "snippet": "mysig_t\nmysignal(int sig, mysig_t act)\n{\n#ifdef HAVE_SIGACTION\n\tstruct sigaction sa, osa;\n\n\tif (sigaction(sig, NULL, &osa) == -1)\n\t\treturn (mysig_t) -1;\n\tif (osa.sa_handler != act) {\n\t\tmemset(&sa, 0, sizeof(sa));\n\t\tsigemptyset(&sa.sa_mask);\n\t\tsa.sa_flags = 0;\n#ifdef SA_INTERRUPT\n\t\tif (sig == SIGALRM)\n\t\t\tsa.sa_flags |= SA_INTERRUPT;\n#endif\n\t\tsa.sa_handler = act;\n\t\tif (sigaction(sig, &sa, NULL) == -1)\n\t\t\treturn (mysig_t) -1;\n\t}\n\treturn (osa.sa_handler);\n#else\n\treturn (signal(sig, act));\n#endif\n}",
    "includes": [
      "#include \"openbsd-compat/bsd-signal.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <signal.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "signal",
          "args": [
            "sig",
            "act"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "mysignal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-signal.c",
          "lines": "27-51",
          "snippet": "mysig_t\nmysignal(int sig, mysig_t act)\n{\n#ifdef HAVE_SIGACTION\n\tstruct sigaction sa, osa;\n\n\tif (sigaction(sig, NULL, &osa) == -1)\n\t\treturn (mysig_t) -1;\n\tif (osa.sa_handler != act) {\n\t\tmemset(&sa, 0, sizeof(sa));\n\t\tsigemptyset(&sa.sa_mask);\n\t\tsa.sa_flags = 0;\n#ifdef SA_INTERRUPT\n\t\tif (sig == SIGALRM)\n\t\t\tsa.sa_flags |= SA_INTERRUPT;\n#endif\n\t\tsa.sa_handler = act;\n\t\tif (sigaction(sig, &sa, NULL) == -1)\n\t\t\treturn (mysig_t) -1;\n\t}\n\treturn (osa.sa_handler);\n#else\n\treturn (signal(sig, act));\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "sigaction",
          "args": [
            "sig",
            "&sa",
            "NULL"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "sigaction",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/sigact.c",
          "lines": "48-53",
          "snippet": "int\nsigaction(int sig, struct sigaction *sigact, struct sigaction *osigact)\n{\n\treturn sigvec(sig, sigact ? &sigact->sv : NULL,\n\t    osigact ? &osigact->sv : NULL);\n}",
          "includes": [
            "#include \"sigact.h\"",
            "#include <signal.h>",
            "#include <errno.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sigact.h\"\n#include <signal.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\nsigaction(int sig, struct sigaction *sigact, struct sigaction *osigact)\n{\n\treturn sigvec(sig, sigact ? &sigact->sv : NULL,\n\t    osigact ? &osigact->sv : NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sigemptyset",
          "args": [
            "&sa.sa_mask"
          ],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "sigemptyset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/sigact.c",
          "lines": "55-64",
          "snippet": "int\nsigemptyset (sigset_t *mask)\n{\n\tif (!mask) {\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\t*mask = 0;\n\treturn 0;\n}",
          "includes": [
            "#include \"sigact.h\"",
            "#include <signal.h>",
            "#include <errno.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sigact.h\"\n#include <signal.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\nsigemptyset (sigset_t *mask)\n{\n\tif (!mask) {\n\t\terrno = EINVAL;\n\t\treturn -1;\n\t}\n\t*mask = 0;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&sa",
            "0",
            "sizeof(sa)"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/bsd-signal.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include \"includes.h\"\n\nmysig_t\nmysignal(int sig, mysig_t act)\n{\n#ifdef HAVE_SIGACTION\n\tstruct sigaction sa, osa;\n\n\tif (sigaction(sig, NULL, &osa) == -1)\n\t\treturn (mysig_t) -1;\n\tif (osa.sa_handler != act) {\n\t\tmemset(&sa, 0, sizeof(sa));\n\t\tsigemptyset(&sa.sa_mask);\n\t\tsa.sa_flags = 0;\n#ifdef SA_INTERRUPT\n\t\tif (sig == SIGALRM)\n\t\t\tsa.sa_flags |= SA_INTERRUPT;\n#endif\n\t\tsa.sa_handler = act;\n\t\tif (sigaction(sig, &sa, NULL) == -1)\n\t\t\treturn (mysig_t) -1;\n\t}\n\treturn (osa.sa_handler);\n#else\n\treturn (signal(sig, act));\n#endif\n}"
  }
]