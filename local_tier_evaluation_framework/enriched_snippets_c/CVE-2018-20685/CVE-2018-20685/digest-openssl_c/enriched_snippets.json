[
  {
    "function_name": "ssh_digest_buffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
    "lines": "201-205",
    "snippet": "int\nssh_digest_buffer(int alg, const struct sshbuf *b, u_char *d, size_t dlen)\n{\n\treturn ssh_digest_memory(alg, sshbuf_ptr(b), sshbuf_len(b), d, dlen);\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include <openssl/evp.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_digest_memory",
          "args": [
            "alg",
            "sshbuf_ptr(b)",
            "sshbuf_len(b)",
            "d",
            "dlen"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_memory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
          "lines": "183-199",
          "snippet": "int\nssh_digest_memory(int alg, const void *m, size_t mlen, u_char *d, size_t dlen)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\tu_int mdlen;\n\n\tif (digest == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (dlen > UINT_MAX)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (dlen < digest->digest_len)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tmdlen = dlen;\n\tif (!EVP_Digest(m, mlen, d, &mdlen, digest->mdfunc(), NULL))\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\treturn 0;\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include <openssl/evp.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_memory(int alg, const void *m, size_t mlen, u_char *d, size_t dlen)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\tu_int mdlen;\n\n\tif (digest == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (dlen > UINT_MAX)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (dlen < digest->digest_len)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tmdlen = dlen;\n\tif (!EVP_Digest(m, mlen, d, &mdlen, digest->mdfunc(), NULL))\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_len",
          "args": [
            "b"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "252-258",
          "snippet": "size_t\nsshbuf_len(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn 0;\n\treturn buf->size - buf->off;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nsshbuf_len(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn 0;\n\treturn buf->size - buf->off;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_ptr",
          "args": [
            "b"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "268-274",
          "snippet": "const u_char *\nsshbuf_ptr(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn NULL;\n\treturn buf->cd + buf->off;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst u_char *\nsshbuf_ptr(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn NULL;\n\treturn buf->cd + buf->off;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_buffer(int alg, const struct sshbuf *b, u_char *d, size_t dlen)\n{\n\treturn ssh_digest_memory(alg, sshbuf_ptr(b), sshbuf_len(b), d, dlen);\n}"
  },
  {
    "function_name": "ssh_digest_memory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
    "lines": "183-199",
    "snippet": "int\nssh_digest_memory(int alg, const void *m, size_t mlen, u_char *d, size_t dlen)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\tu_int mdlen;\n\n\tif (digest == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (dlen > UINT_MAX)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (dlen < digest->digest_len)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tmdlen = dlen;\n\tif (!EVP_Digest(m, mlen, d, &mdlen, digest->mdfunc(), NULL))\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\treturn 0;\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include <openssl/evp.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EVP_Digest",
          "args": [
            "m",
            "mlen",
            "d",
            "&mdlen",
            "digest->mdfunc()",
            "NULL"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "digest->mdfunc",
          "args": [],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssh_digest_by_alg",
          "args": [
            "alg"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_by_alg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
          "lines": "66-76",
          "snippet": "static const struct ssh_digest *\nssh_digest_by_alg(int alg)\n{\n\tif (alg < 0 || alg >= SSH_DIGEST_MAX)\n\t\treturn NULL;\n\tif (digests[alg].id != alg) /* sanity */\n\t\treturn NULL;\n\tif (digests[alg].mdfunc == NULL)\n\t\treturn NULL;\n\treturn &(digests[alg]);\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include <openssl/evp.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic const struct ssh_digest *\nssh_digest_by_alg(int alg)\n{\n\tif (alg < 0 || alg >= SSH_DIGEST_MAX)\n\t\treturn NULL;\n\tif (digests[alg].id != alg) /* sanity */\n\t\treturn NULL;\n\tif (digests[alg].mdfunc == NULL)\n\t\treturn NULL;\n\treturn &(digests[alg]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_memory(int alg, const void *m, size_t mlen, u_char *d, size_t dlen)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\tu_int mdlen;\n\n\tif (digest == NULL)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (dlen > UINT_MAX)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (dlen < digest->digest_len)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tmdlen = dlen;\n\tif (!EVP_Digest(m, mlen, d, &mdlen, digest->mdfunc(), NULL))\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\treturn 0;\n}"
  },
  {
    "function_name": "ssh_digest_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
    "lines": "174-181",
    "snippet": "void\nssh_digest_free(struct ssh_digest_ctx *ctx)\n{\n\tif (ctx == NULL)\n\t\treturn;\n\tEVP_MD_CTX_free(ctx->mdctx);\n\tfreezero(ctx, sizeof(*ctx));\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include <openssl/evp.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "freezero",
          "args": [
            "ctx",
            "sizeof(*ctx)"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "freezero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/freezero.c",
          "lines": "24-31",
          "snippet": "void\nfreezero(void *ptr, size_t sz)\n{\n\tif (ptr == NULL)\n\t\treturn;\n\texplicit_bzero(ptr, sz);\n\tfree(ptr);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nvoid\nfreezero(void *ptr, size_t sz)\n{\n\tif (ptr == NULL)\n\t\treturn;\n\texplicit_bzero(ptr, sz);\n\tfree(ptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "EVP_MD_CTX_free",
          "args": [
            "ctx->mdctx"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "EVP_MD_CTX_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "628-637",
          "snippet": "void\nEVP_MD_CTX_free(EVP_MD_CTX *ctx)\n{\n\tif (ctx == NULL)\n\t\treturn;\n\n\tEVP_MD_CTX_cleanup(ctx);\n\n\tfree(ctx);\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nEVP_MD_CTX_free(EVP_MD_CTX *ctx)\n{\n\tif (ctx == NULL)\n\t\treturn;\n\n\tEVP_MD_CTX_cleanup(ctx);\n\n\tfree(ctx);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_digest_free(struct ssh_digest_ctx *ctx)\n{\n\tif (ctx == NULL)\n\t\treturn;\n\tEVP_MD_CTX_free(ctx->mdctx);\n\tfreezero(ctx, sizeof(*ctx));\n}"
  },
  {
    "function_name": "ssh_digest_final",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
    "lines": "157-172",
    "snippet": "int\nssh_digest_final(struct ssh_digest_ctx *ctx, u_char *d, size_t dlen)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(ctx->alg);\n\tu_int l = dlen;\n\n\tif (digest == NULL || dlen > UINT_MAX)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (dlen < digest->digest_len) /* No truncation allowed */\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (EVP_DigestFinal_ex(ctx->mdctx, d, &l) != 1)\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\tif (l != digest->digest_len) /* sanity */\n\t\treturn SSH_ERR_INTERNAL_ERROR;\n\treturn 0;\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include <openssl/evp.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EVP_DigestFinal_ex",
          "args": [
            "ctx->mdctx",
            "d",
            "&l"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssh_digest_by_alg",
          "args": [
            "ctx->alg"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_by_alg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
          "lines": "66-76",
          "snippet": "static const struct ssh_digest *\nssh_digest_by_alg(int alg)\n{\n\tif (alg < 0 || alg >= SSH_DIGEST_MAX)\n\t\treturn NULL;\n\tif (digests[alg].id != alg) /* sanity */\n\t\treturn NULL;\n\tif (digests[alg].mdfunc == NULL)\n\t\treturn NULL;\n\treturn &(digests[alg]);\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include <openssl/evp.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic const struct ssh_digest *\nssh_digest_by_alg(int alg)\n{\n\tif (alg < 0 || alg >= SSH_DIGEST_MAX)\n\t\treturn NULL;\n\tif (digests[alg].id != alg) /* sanity */\n\t\treturn NULL;\n\tif (digests[alg].mdfunc == NULL)\n\t\treturn NULL;\n\treturn &(digests[alg]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_final(struct ssh_digest_ctx *ctx, u_char *d, size_t dlen)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(ctx->alg);\n\tu_int l = dlen;\n\n\tif (digest == NULL || dlen > UINT_MAX)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (dlen < digest->digest_len) /* No truncation allowed */\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (EVP_DigestFinal_ex(ctx->mdctx, d, &l) != 1)\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\tif (l != digest->digest_len) /* sanity */\n\t\treturn SSH_ERR_INTERNAL_ERROR;\n\treturn 0;\n}"
  },
  {
    "function_name": "ssh_digest_update_buffer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
    "lines": "151-155",
    "snippet": "int\nssh_digest_update_buffer(struct ssh_digest_ctx *ctx, const struct sshbuf *b)\n{\n\treturn ssh_digest_update(ctx, sshbuf_ptr(b), sshbuf_len(b));\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include <openssl/evp.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_digest_update",
          "args": [
            "ctx",
            "sshbuf_ptr(b)",
            "sshbuf_len(b)"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
          "lines": "143-149",
          "snippet": "int\nssh_digest_update(struct ssh_digest_ctx *ctx, const void *m, size_t mlen)\n{\n\tif (EVP_DigestUpdate(ctx->mdctx, m, mlen) != 1)\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\treturn 0;\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include <openssl/evp.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_update(struct ssh_digest_ctx *ctx, const void *m, size_t mlen)\n{\n\tif (EVP_DigestUpdate(ctx->mdctx, m, mlen) != 1)\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_len",
          "args": [
            "b"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "252-258",
          "snippet": "size_t\nsshbuf_len(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn 0;\n\treturn buf->size - buf->off;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nsshbuf_len(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn 0;\n\treturn buf->size - buf->off;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_ptr",
          "args": [
            "b"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "268-274",
          "snippet": "const u_char *\nsshbuf_ptr(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn NULL;\n\treturn buf->cd + buf->off;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst u_char *\nsshbuf_ptr(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn NULL;\n\treturn buf->cd + buf->off;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_update_buffer(struct ssh_digest_ctx *ctx, const struct sshbuf *b)\n{\n\treturn ssh_digest_update(ctx, sshbuf_ptr(b), sshbuf_len(b));\n}"
  },
  {
    "function_name": "ssh_digest_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
    "lines": "143-149",
    "snippet": "int\nssh_digest_update(struct ssh_digest_ctx *ctx, const void *m, size_t mlen)\n{\n\tif (EVP_DigestUpdate(ctx->mdctx, m, mlen) != 1)\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\treturn 0;\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include <openssl/evp.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EVP_DigestUpdate",
          "args": [
            "ctx->mdctx",
            "m",
            "mlen"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_update(struct ssh_digest_ctx *ctx, const void *m, size_t mlen)\n{\n\tif (EVP_DigestUpdate(ctx->mdctx, m, mlen) != 1)\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\treturn 0;\n}"
  },
  {
    "function_name": "ssh_digest_copy_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
    "lines": "132-141",
    "snippet": "int\nssh_digest_copy_state(struct ssh_digest_ctx *from, struct ssh_digest_ctx *to)\n{\n\tif (from->alg != to->alg)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\t/* we have bcopy-style order while openssl has memcpy-style */\n\tif (!EVP_MD_CTX_copy_ex(to->mdctx, from->mdctx))\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\treturn 0;\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include <openssl/evp.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EVP_MD_CTX_copy_ex",
          "args": [
            "to->mdctx",
            "from->mdctx"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_copy_state(struct ssh_digest_ctx *from, struct ssh_digest_ctx *to)\n{\n\tif (from->alg != to->alg)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\t/* we have bcopy-style order while openssl has memcpy-style */\n\tif (!EVP_MD_CTX_copy_ex(to->mdctx, from->mdctx))\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\treturn 0;\n}"
  },
  {
    "function_name": "ssh_digest_start",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
    "lines": "112-130",
    "snippet": "struct ssh_digest_ctx *\nssh_digest_start(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\tstruct ssh_digest_ctx *ret;\n\n\tif (digest == NULL || ((ret = calloc(1, sizeof(*ret))) == NULL))\n\t\treturn NULL;\n\tret->alg = alg;\n\tif ((ret->mdctx = EVP_MD_CTX_new()) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\tif (EVP_DigestInit_ex(ret->mdctx, digest->mdfunc(), NULL) != 1) {\n\t\tssh_digest_free(ret);\n\t\treturn NULL;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include <openssl/evp.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_digest_free",
          "args": [
            "ret"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
          "lines": "174-181",
          "snippet": "void\nssh_digest_free(struct ssh_digest_ctx *ctx)\n{\n\tif (ctx == NULL)\n\t\treturn;\n\tEVP_MD_CTX_free(ctx->mdctx);\n\tfreezero(ctx, sizeof(*ctx));\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include <openssl/evp.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_digest_free(struct ssh_digest_ctx *ctx)\n{\n\tif (ctx == NULL)\n\t\treturn;\n\tEVP_MD_CTX_free(ctx->mdctx);\n\tfreezero(ctx, sizeof(*ctx));\n}"
        }
      },
      {
        "call_info": {
          "callee": "EVP_DigestInit_ex",
          "args": [
            "ret->mdctx",
            "digest->mdfunc()",
            "NULL"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "digest->mdfunc",
          "args": [],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EVP_MD_CTX_new",
          "args": [],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "EVP_MD_CTX_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "620-624",
          "snippet": "EVP_MD_CTX *\nEVP_MD_CTX_new(void)\n{\n\treturn calloc(1, sizeof(EVP_MD_CTX));\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nEVP_MD_CTX *\nEVP_MD_CTX_new(void)\n{\n\treturn calloc(1, sizeof(EVP_MD_CTX));\n}"
        }
      },
      {
        "call_info": {
          "callee": "calloc",
          "args": [
            "1",
            "sizeof(*ret)"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "xcalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "52-66",
          "snippet": "void *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_digest_by_alg",
          "args": [
            "alg"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_by_alg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
          "lines": "66-76",
          "snippet": "static const struct ssh_digest *\nssh_digest_by_alg(int alg)\n{\n\tif (alg < 0 || alg >= SSH_DIGEST_MAX)\n\t\treturn NULL;\n\tif (digests[alg].id != alg) /* sanity */\n\t\treturn NULL;\n\tif (digests[alg].mdfunc == NULL)\n\t\treturn NULL;\n\treturn &(digests[alg]);\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include <openssl/evp.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic const struct ssh_digest *\nssh_digest_by_alg(int alg)\n{\n\tif (alg < 0 || alg >= SSH_DIGEST_MAX)\n\t\treturn NULL;\n\tif (digests[alg].id != alg) /* sanity */\n\t\treturn NULL;\n\tif (digests[alg].mdfunc == NULL)\n\t\treturn NULL;\n\treturn &(digests[alg]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct ssh_digest_ctx *\nssh_digest_start(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\tstruct ssh_digest_ctx *ret;\n\n\tif (digest == NULL || ((ret = calloc(1, sizeof(*ret))) == NULL))\n\t\treturn NULL;\n\tret->alg = alg;\n\tif ((ret->mdctx = EVP_MD_CTX_new()) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\tif (EVP_DigestInit_ex(ret->mdctx, digest->mdfunc(), NULL) != 1) {\n\t\tssh_digest_free(ret);\n\t\treturn NULL;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "ssh_digest_blocksize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
    "lines": "106-110",
    "snippet": "size_t\nssh_digest_blocksize(struct ssh_digest_ctx *ctx)\n{\n\treturn EVP_MD_CTX_block_size(ctx->mdctx);\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include <openssl/evp.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EVP_MD_CTX_block_size",
          "args": [
            "ctx->mdctx"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nssh_digest_blocksize(struct ssh_digest_ctx *ctx)\n{\n\treturn EVP_MD_CTX_block_size(ctx->mdctx);\n}"
  },
  {
    "function_name": "ssh_digest_bytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
    "lines": "98-104",
    "snippet": "size_t\nssh_digest_bytes(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\n\treturn digest == NULL ? 0 : digest->digest_len;\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include <openssl/evp.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_digest_by_alg",
          "args": [
            "alg"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_by_alg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
          "lines": "66-76",
          "snippet": "static const struct ssh_digest *\nssh_digest_by_alg(int alg)\n{\n\tif (alg < 0 || alg >= SSH_DIGEST_MAX)\n\t\treturn NULL;\n\tif (digests[alg].id != alg) /* sanity */\n\t\treturn NULL;\n\tif (digests[alg].mdfunc == NULL)\n\t\treturn NULL;\n\treturn &(digests[alg]);\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include <openssl/evp.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic const struct ssh_digest *\nssh_digest_by_alg(int alg)\n{\n\tif (alg < 0 || alg >= SSH_DIGEST_MAX)\n\t\treturn NULL;\n\tif (digests[alg].id != alg) /* sanity */\n\t\treturn NULL;\n\tif (digests[alg].mdfunc == NULL)\n\t\treturn NULL;\n\treturn &(digests[alg]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nssh_digest_bytes(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\n\treturn digest == NULL ? 0 : digest->digest_len;\n}"
  },
  {
    "function_name": "ssh_digest_alg_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
    "lines": "90-96",
    "snippet": "const char *\nssh_digest_alg_name(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\n\treturn digest == NULL ? NULL : digest->name;\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include <openssl/evp.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_digest_by_alg",
          "args": [
            "alg"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_digest_by_alg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
          "lines": "66-76",
          "snippet": "static const struct ssh_digest *\nssh_digest_by_alg(int alg)\n{\n\tif (alg < 0 || alg >= SSH_DIGEST_MAX)\n\t\treturn NULL;\n\tif (digests[alg].id != alg) /* sanity */\n\t\treturn NULL;\n\tif (digests[alg].mdfunc == NULL)\n\t\treturn NULL;\n\treturn &(digests[alg]);\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include \"digest.h\"",
            "#include \"sshbuf.h\"",
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include <openssl/evp.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic const struct ssh_digest *\nssh_digest_by_alg(int alg)\n{\n\tif (alg < 0 || alg >= SSH_DIGEST_MAX)\n\t\treturn NULL;\n\tif (digests[alg].id != alg) /* sanity */\n\t\treturn NULL;\n\tif (digests[alg].mdfunc == NULL)\n\t\treturn NULL;\n\treturn &(digests[alg]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst char *\nssh_digest_alg_name(int alg)\n{\n\tconst struct ssh_digest *digest = ssh_digest_by_alg(alg);\n\n\treturn digest == NULL ? NULL : digest->name;\n}"
  },
  {
    "function_name": "ssh_digest_alg_by_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
    "lines": "78-88",
    "snippet": "int\nssh_digest_alg_by_name(const char *name)\n{\n\tint alg;\n\n\tfor (alg = 0; digests[alg].id != -1; alg++) {\n\t\tif (strcasecmp(name, digests[alg].name) == 0)\n\t\t\treturn digests[alg].id;\n\t}\n\treturn -1;\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include <openssl/evp.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "name",
            "digests[alg].name"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_digest_alg_by_name(const char *name)\n{\n\tint alg;\n\n\tfor (alg = 0; digests[alg].id != -1; alg++) {\n\t\tif (strcasecmp(name, digests[alg].name) == 0)\n\t\t\treturn digests[alg].id;\n\t}\n\treturn -1;\n}"
  },
  {
    "function_name": "ssh_digest_by_alg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/digest-openssl.c",
    "lines": "66-76",
    "snippet": "static const struct ssh_digest *\nssh_digest_by_alg(int alg)\n{\n\tif (alg < 0 || alg >= SSH_DIGEST_MAX)\n\t\treturn NULL;\n\tif (digests[alg].id != alg) /* sanity */\n\t\treturn NULL;\n\tif (digests[alg].mdfunc == NULL)\n\t\treturn NULL;\n\treturn &(digests[alg]);\n}",
    "includes": [
      "#include \"ssherr.h\"",
      "#include \"digest.h\"",
      "#include \"sshbuf.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include <openssl/evp.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <limits.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ssherr.h\"\n#include \"digest.h\"\n#include \"sshbuf.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/evp.h>\n#include <string.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic const struct ssh_digest *\nssh_digest_by_alg(int alg)\n{\n\tif (alg < 0 || alg >= SSH_DIGEST_MAX)\n\t\treturn NULL;\n\tif (digests[alg].id != alg) /* sanity */\n\t\treturn NULL;\n\tif (digests[alg].mdfunc == NULL)\n\t\treturn NULL;\n\treturn &(digests[alg]);\n}"
  }
]