[
  {
    "function_name": "ssh_OpenSSL_add_all_algorithms",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/openssl-compat.c",
    "lines": "70-85",
    "snippet": "void\nssh_OpenSSL_add_all_algorithms(void)\n{\n\tOpenSSL_add_all_algorithms();\n\n\t/* Enable use of crypto hardware */\n\tENGINE_load_builtin_engines();\n\tENGINE_register_all_complete();\n\n#if OPENSSL_VERSION_NUMBER < 0x10100000L\n\tOPENSSL_config(NULL);\n#else\n\tOPENSSL_init_crypto(OPENSSL_INIT_ADD_ALL_CIPHERS |\n\t    OPENSSL_INIT_ADD_ALL_DIGESTS | OPENSSL_INIT_LOAD_CONFIG, NULL);\n#endif\n}",
    "includes": [
      "#include \"openssl-compat.h\"",
      "#include \"log.h\"",
      "# include <openssl/conf.h>",
      "# include <openssl/engine.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "OPENSSL_init_crypto",
          "args": [
            "OPENSSL_INIT_ADD_ALL_CIPHERS |\n\t    OPENSSL_INIT_ADD_ALL_DIGESTS | OPENSSL_INIT_LOAD_CONFIG",
            "NULL"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OPENSSL_config",
          "args": [
            "NULL"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENGINE_register_all_complete",
          "args": [],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENGINE_load_builtin_engines",
          "args": [],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OpenSSL_add_all_algorithms",
          "args": [],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_OpenSSL_add_all_algorithms",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/openssl-compat.c",
          "lines": "70-85",
          "snippet": "void\nssh_OpenSSL_add_all_algorithms(void)\n{\n\tOpenSSL_add_all_algorithms();\n\n\t/* Enable use of crypto hardware */\n\tENGINE_load_builtin_engines();\n\tENGINE_register_all_complete();\n\n#if OPENSSL_VERSION_NUMBER < 0x10100000L\n\tOPENSSL_config(NULL);\n#else\n\tOPENSSL_init_crypto(OPENSSL_INIT_ADD_ALL_CIPHERS |\n\t    OPENSSL_INIT_ADD_ALL_DIGESTS | OPENSSL_INIT_LOAD_CONFIG, NULL);\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"openssl-compat.h\"\n#include \"log.h\"\n# include <openssl/conf.h>\n# include <openssl/engine.h>\n#include <string.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid\nssh_OpenSSL_add_all_algorithms(void)\n{\n\tOpenSSL_add_all_algorithms();\n\n\t/* Enable use of crypto hardware */\n\tENGINE_load_builtin_engines();\n\tENGINE_register_all_complete();\n\n#if OPENSSL_VERSION_NUMBER < 0x10100000L\n\tOPENSSL_config(NULL);\n#else\n\tOPENSSL_init_crypto(OPENSSL_INIT_ADD_ALL_CIPHERS |\n\t    OPENSSL_INIT_ADD_ALL_DIGESTS | OPENSSL_INIT_LOAD_CONFIG, NULL);\n#endif\n}"
  },
  {
    "function_name": "ssh_compatible_openssl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/openssl-compat.c",
    "lines": "42-67",
    "snippet": "int\nssh_compatible_openssl(long headerver, long libver)\n{\n\tlong mask, hfix, lfix;\n\n\t/* exact match is always OK */\n\tif (headerver == libver)\n\t\treturn 1;\n\n\t/* for versions < 1.0.0, major,minor,fix,status must match */\n\tif (headerver < 0x1000000f) {\n\t\tmask = 0xfffff00fL; /* major,minor,fix,status */\n\t\treturn (headerver & mask) == (libver & mask);\n\t}\n\n\t/*\n\t * For versions >= 1.0.0, major,minor,status must match and library\n\t * fix version must be equal to or newer than the header.\n\t */\n\tmask = 0xfff0000fL; /* major,minor,status */\n\thfix = (headerver & 0x000ff000) >> 12;\n\tlfix = (libver & 0x000ff000) >> 12;\n\tif ( (headerver & mask) == (libver & mask) && lfix >= hfix)\n\t\treturn 1;\n\treturn 0;\n}",
    "includes": [
      "#include \"openssl-compat.h\"",
      "#include \"log.h\"",
      "# include <openssl/conf.h>",
      "# include <openssl/engine.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"openssl-compat.h\"\n#include \"log.h\"\n# include <openssl/conf.h>\n# include <openssl/engine.h>\n#include <string.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nint\nssh_compatible_openssl(long headerver, long libver)\n{\n\tlong mask, hfix, lfix;\n\n\t/* exact match is always OK */\n\tif (headerver == libver)\n\t\treturn 1;\n\n\t/* for versions < 1.0.0, major,minor,fix,status must match */\n\tif (headerver < 0x1000000f) {\n\t\tmask = 0xfffff00fL; /* major,minor,fix,status */\n\t\treturn (headerver & mask) == (libver & mask);\n\t}\n\n\t/*\n\t * For versions >= 1.0.0, major,minor,status must match and library\n\t * fix version must be equal to or newer than the header.\n\t */\n\tmask = 0xfff0000fL; /* major,minor,status */\n\thfix = (headerver & 0x000ff000) >> 12;\n\tlfix = (libver & 0x000ff000) >> 12;\n\tif ( (headerver & mask) == (libver & mask) && lfix >= hfix)\n\t\treturn 1;\n\treturn 0;\n}"
  }
]