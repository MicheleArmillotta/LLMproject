[
  {
    "function_name": "sshbuf_getput_crypto_tests",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/sshbuf/test_sshbuf_getput_crypto.c",
    "lines": "31-408",
    "snippet": "void\nsshbuf_getput_crypto_tests(void)\n{\n\tstruct sshbuf *p1;\n\tBIGNUM *bn, *bn2;\n\t/* This one has num_bits != num_bytes * 8 to test bignum1 encoding */\n\tconst char *hexbn1 = \"0102030405060708090a0b0c0d0e0f10\";\n\t/* This one has MSB set to test bignum2 encoding negative-avoidance */\n\tconst char *hexbn2 = \"f0e0d0c0b0a0908070605040302010007fff11\";\n\tu_char expbn1[] = {\n\t\t0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08,\n\t\t0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10,\n\t};\n\tu_char expbn2[] = {\n\t\t0xf0, 0xe0, 0xd0, 0xc0, 0xb0, 0xa0, 0x90, 0x80,\n\t\t0x70, 0x60, 0x50, 0x40, 0x30, 0x20, 0x10, 0x00,\n\t\t0x7f, 0xff, 0x11\n\t};\n#if defined(OPENSSL_HAS_ECC) && defined(OPENSSL_HAS_NISTP256)\n\tconst u_char *d;\n\tsize_t s;\n\tBIGNUM *bn_x, *bn_y;\n\tint ec256_nid = NID_X9_62_prime256v1;\n\tchar *ec256_x = \"0C828004839D0106AA59575216191357\"\n\t\t        \"34B451459DADB586677EF9DF55784999\";\n\tchar *ec256_y = \"4D196B50F0B4E94B3C73E3A9D4CD9DF2\"\n\t                \"C8F9A35E42BDD047550F69D80EC23CD4\";\n\tu_char expec256[] = {\n\t\t0x04,\n\t\t0x0c, 0x82, 0x80, 0x04, 0x83, 0x9d, 0x01, 0x06,\n\t\t0xaa, 0x59, 0x57, 0x52, 0x16, 0x19, 0x13, 0x57,\n\t\t0x34, 0xb4, 0x51, 0x45, 0x9d, 0xad, 0xb5, 0x86,\n\t\t0x67, 0x7e, 0xf9, 0xdf, 0x55, 0x78, 0x49, 0x99,\n\t\t0x4d, 0x19, 0x6b, 0x50, 0xf0, 0xb4, 0xe9, 0x4b,\n\t\t0x3c, 0x73, 0xe3, 0xa9, 0xd4, 0xcd, 0x9d, 0xf2,\n\t\t0xc8, 0xf9, 0xa3, 0x5e, 0x42, 0xbd, 0xd0, 0x47,\n\t\t0x55, 0x0f, 0x69, 0xd8, 0x0e, 0xc2, 0x3c, 0xd4\n\t};\n\tEC_KEY *eck;\n\tEC_POINT *ecp;\n#endif\n\tint r;\n\n#define MKBN(b, bnn) \\\n\tdo { \\\n\t\tbnn = NULL; \\\n\t\tASSERT_INT_GT(BN_hex2bn(&bnn, b), 0); \\\n\t} while (0)\n\n\tTEST_START(\"sshbuf_put_bignum1\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_bignum1(p1, bn), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(expbn1) + 2);\n\tASSERT_U16_EQ(PEEK_U16(sshbuf_ptr(p1)), (u_int16_t)BN_num_bits(bn));\n\tASSERT_MEM_EQ(sshbuf_ptr(p1) + 2, expbn1, sizeof(expbn1));\n\tBN_free(bn);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum1 limited\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_set_max_size(p1, sizeof(expbn1) + 1), 0);\n\tr = sshbuf_put_bignum1(p1, bn);\n\tASSERT_INT_EQ(r, SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 0);\n\tBN_free(bn);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum1 bn2\");\n\tMKBN(hexbn2, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_bignum1(p1, bn), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(expbn2) + 2);\n\tASSERT_U16_EQ(PEEK_U16(sshbuf_ptr(p1)), (u_int16_t)BN_num_bits(bn));\n\tASSERT_MEM_EQ(sshbuf_ptr(p1) + 2, expbn2, sizeof(expbn2));\n\tBN_free(bn);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum1 bn2 limited\");\n\tMKBN(hexbn2, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_set_max_size(p1, sizeof(expbn1) + 1), 0);\n\tr = sshbuf_put_bignum1(p1, bn);\n\tASSERT_INT_EQ(r, SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 0);\n\tBN_free(bn);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum2\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_bignum2(p1, bn), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(expbn1) + 4);\n\tASSERT_U32_EQ(PEEK_U32(sshbuf_ptr(p1)), (u_int32_t)BN_num_bytes(bn));\n\tASSERT_MEM_EQ(sshbuf_ptr(p1) + 4, expbn1, sizeof(expbn1));\n\tBN_free(bn);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum2 limited\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_set_max_size(p1, sizeof(expbn1) + 3), 0);\n\tr = sshbuf_put_bignum2(p1, bn);\n\tASSERT_INT_EQ(r, SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 0);\n\tBN_free(bn);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum2 bn2\");\n\tMKBN(hexbn2, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_bignum2(p1, bn), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(expbn2) + 4 + 1); /* MSB */\n\tASSERT_U32_EQ(PEEK_U32(sshbuf_ptr(p1)), (u_int32_t)BN_num_bytes(bn) + 1);\n\tASSERT_U8_EQ(*(sshbuf_ptr(p1) + 4), 0x00);\n\tASSERT_MEM_EQ(sshbuf_ptr(p1) + 5, expbn2, sizeof(expbn2));\n\tBN_free(bn);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum2 bn2 limited\");\n\tMKBN(hexbn2, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_set_max_size(p1, sizeof(expbn2) + 3), 0);\n\tr = sshbuf_put_bignum2(p1, bn);\n\tASSERT_INT_EQ(r, SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 0);\n\tBN_free(bn);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum1\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, BN_num_bits(bn)), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, expbn1, sizeof(expbn1)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2 + sizeof(expbn1));\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, 0xd00f), 0);\n\tbn2 = BN_new();\n\tASSERT_INT_EQ(sshbuf_get_bignum1(p1, bn2), 0);\n\tASSERT_BIGNUM_EQ(bn, bn2);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum1 truncated\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, BN_num_bits(bn)), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, expbn1, sizeof(expbn1) - 1), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2 + sizeof(expbn1) - 1);\n\tbn2 = BN_new();\n\tr = sshbuf_get_bignum1(p1, bn2);\n\tASSERT_INT_EQ(r, SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2 + sizeof(expbn1) - 1);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum1 giant\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, 0xffff), 0);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, (0xffff + 7) / 8, NULL), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2 + ((0xffff + 7) / 8));\n\tbn2 = BN_new();\n\tr = sshbuf_get_bignum1(p1, bn2);\n\tASSERT_INT_EQ(r, SSH_ERR_BIGNUM_TOO_LARGE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2 + ((0xffff + 7) / 8));\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum1 bn2\");\n\tMKBN(hexbn2, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, BN_num_bits(bn)), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, expbn2, sizeof(expbn2)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2 + sizeof(expbn2));\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, 0xd00f), 0);\n\tbn2 = BN_new();\n\tASSERT_INT_EQ(sshbuf_get_bignum1(p1, bn2), 0);\n\tASSERT_BIGNUM_EQ(bn, bn2);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum1 bn2 truncated\");\n\tMKBN(hexbn2, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, BN_num_bits(bn)), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, expbn2, sizeof(expbn2) - 1), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2 + sizeof(expbn2) - 1);\n\tbn2 = BN_new();\n\tr = sshbuf_get_bignum1(p1, bn2);\n\tASSERT_INT_EQ(r, SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2 + sizeof(expbn2) - 1);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum2\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, BN_num_bytes(bn)), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, expbn1, sizeof(expbn1)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 4 + sizeof(expbn1));\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, 0xd00f), 0);\n\tbn2 = BN_new();\n\tASSERT_INT_EQ(sshbuf_get_bignum2(p1, bn2), 0);\n\tASSERT_BIGNUM_EQ(bn, bn2);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum2 truncated\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, BN_num_bytes(bn)), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, expbn1, sizeof(expbn1) - 1), 0);\n\tbn2 = BN_new();\n\tr = sshbuf_get_bignum2(p1, bn2);\n\tASSERT_INT_EQ(r, SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(expbn1) + 3);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum2 giant\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, 65536), 0);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, 65536, NULL), 0);\n\tbn2 = BN_new();\n\tr = sshbuf_get_bignum2(p1, bn2);\n\tASSERT_INT_EQ(r, SSH_ERR_BIGNUM_TOO_LARGE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 65536 + 4);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum2 bn2\");\n\tMKBN(hexbn2, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, BN_num_bytes(bn) + 1), 0); /* MSB */\n\tASSERT_INT_EQ(sshbuf_put_u8(p1, 0x00), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, expbn2, sizeof(expbn2)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 4 + 1 + sizeof(expbn2));\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, 0xd00f), 0);\n\tbn2 = BN_new();\n\tASSERT_INT_EQ(sshbuf_get_bignum2(p1, bn2), 0);\n\tASSERT_BIGNUM_EQ(bn, bn2);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum2 bn2 truncated\");\n\tMKBN(hexbn2, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, BN_num_bytes(bn) + 1), 0);\n\tASSERT_INT_EQ(sshbuf_put_u8(p1, 0x00), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, expbn2, sizeof(expbn2) - 1), 0);\n\tbn2 = BN_new();\n\tr = sshbuf_get_bignum2(p1, bn2);\n\tASSERT_INT_EQ(r, SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(expbn2) + 1 + 4 - 1);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum2 bn2 negative\");\n\tMKBN(hexbn2, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, BN_num_bytes(bn)), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, expbn2, sizeof(expbn2)), 0);\n\tbn2 = BN_new();\n\tr = sshbuf_get_bignum2(p1, bn2);\n\tASSERT_INT_EQ(r, SSH_ERR_BIGNUM_IS_NEGATIVE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(expbn2) + 4);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n#if defined(OPENSSL_HAS_ECC) && defined(OPENSSL_HAS_NISTP256)\n\tTEST_START(\"sshbuf_put_ec\");\n\teck = EC_KEY_new_by_curve_name(ec256_nid);\n\tASSERT_PTR_NE(eck, NULL);\n\tecp = EC_POINT_new(EC_KEY_get0_group(eck));\n\tASSERT_PTR_NE(ecp, NULL);\n\tMKBN(ec256_x, bn_x);\n\tMKBN(ec256_y, bn_y);\n\tASSERT_INT_EQ(EC_POINT_set_affine_coordinates_GFp(\n\t    EC_KEY_get0_group(eck), ecp, bn_x, bn_y, NULL), 1);\n\tASSERT_INT_EQ(EC_KEY_set_public_key(eck, ecp), 1);\n\tBN_free(bn_x);\n\tBN_free(bn_y);\n\tEC_POINT_free(ecp);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_eckey(p1, eck), 0);\n\tASSERT_INT_EQ(sshbuf_get_string_direct(p1, &d, &s), 0);\n\tASSERT_SIZE_T_EQ(s, sizeof(expec256));\n\tASSERT_MEM_EQ(d, expec256, sizeof(expec256));\n\tsshbuf_free(p1);\n\tEC_KEY_free(eck);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_ec\");\n\teck = EC_KEY_new_by_curve_name(ec256_nid);\n\tASSERT_PTR_NE(eck, NULL);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_string(p1, expec256, sizeof(expec256)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(expec256) + 4);\n\tASSERT_INT_EQ(sshbuf_put_u8(p1, 0x00), 0);\n\tASSERT_INT_EQ(sshbuf_get_eckey(p1, eck), 0);\n\tbn_x = BN_new();\n\tbn_y = BN_new();\n\tASSERT_PTR_NE(bn_x, NULL);\n\tASSERT_PTR_NE(bn_y, NULL);\n\tASSERT_INT_EQ(EC_POINT_get_affine_coordinates_GFp(\n\t    EC_KEY_get0_group(eck), EC_KEY_get0_public_key(eck),\n\t    bn_x, bn_y, NULL), 1);\n\tMKBN(ec256_x, bn);\n\tMKBN(ec256_y, bn2);\n\tASSERT_INT_EQ(BN_cmp(bn_x, bn), 0);\n\tASSERT_INT_EQ(BN_cmp(bn_y, bn2), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 1);\n\tsshbuf_free(p1);\n\tEC_KEY_free(eck);\n\tBN_free(bn_x);\n\tBN_free(bn_y);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tTEST_DONE();\n#endif\n}",
    "includes": [
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"../test_helper/test_helper.h\"",
      "# include <openssl/ec.h>",
      "#include <openssl/objects.h>",
      "#include <openssl/bn.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "# include <stdint.h>",
      "#include <stdio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void sshbuf_getput_crypto_tests(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn2"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn_y"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn_x"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EC_KEY_free",
          "args": [
            "eck"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_free",
          "args": [
            "p1"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "133-166",
          "snippet": "void\nsshbuf_free(struct sshbuf *buf)\n{\n\tif (buf == NULL)\n\t\treturn;\n\t/*\n\t * The following will leak on insane buffers, but this is the safest\n\t * course of action - an invalid pointer or already-freed pointer may\n\t * have been passed to us and continuing to scribble over memory would\n\t * be bad.\n\t */\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn;\n\t/*\n\t * If we are a child, the free our parent to decrement its reference\n\t * count and possibly free it.\n\t */\n\tsshbuf_free(buf->parent);\n\tbuf->parent = NULL;\n\t/*\n\t * If we are a parent with still-extant children, then don't free just\n\t * yet. The last child's call to sshbuf_free should decrement our\n\t * refcount to 0 and trigger the actual free.\n\t */\n\tbuf->refcount--;\n\tif (buf->refcount > 0)\n\t\treturn;\n\tif (!buf->readonly) {\n\t\texplicit_bzero(buf->d, buf->alloc);\n\t\tfree(buf->d);\n\t}\n\texplicit_bzero(buf, sizeof(*buf));\n\tfree(buf);\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nsshbuf_free(struct sshbuf *buf)\n{\n\tif (buf == NULL)\n\t\treturn;\n\t/*\n\t * The following will leak on insane buffers, but this is the safest\n\t * course of action - an invalid pointer or already-freed pointer may\n\t * have been passed to us and continuing to scribble over memory would\n\t * be bad.\n\t */\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn;\n\t/*\n\t * If we are a child, the free our parent to decrement its reference\n\t * count and possibly free it.\n\t */\n\tsshbuf_free(buf->parent);\n\tbuf->parent = NULL;\n\t/*\n\t * If we are a parent with still-extant children, then don't free just\n\t * yet. The last child's call to sshbuf_free should decrement our\n\t * refcount to 0 and trigger the actual free.\n\t */\n\tbuf->refcount--;\n\tif (buf->refcount > 0)\n\t\treturn;\n\tif (!buf->readonly) {\n\t\texplicit_bzero(buf->d, buf->alloc);\n\t\tfree(buf->d);\n\t}\n\texplicit_bzero(buf, sizeof(*buf));\n\tfree(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "1"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_len",
          "args": [
            "p1"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "252-258",
          "snippet": "size_t\nsshbuf_len(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn 0;\n\treturn buf->size - buf->off;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nsshbuf_len(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn 0;\n\treturn buf->size - buf->off;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "BN_cmp(bn_y, bn2)",
            "0"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_cmp",
          "args": [
            "bn_y",
            "bn2"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "BN_cmp(bn_x, bn)",
            "0"
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_cmp",
          "args": [
            "bn_x",
            "bn"
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "ec256_y",
            "bn2"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "ec256_x",
            "bn"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "EC_POINT_get_affine_coordinates_GFp(\n\t    EC_KEY_get0_group(eck), EC_KEY_get0_public_key(eck),\n\t    bn_x, bn_y, NULL)",
            "1"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EC_POINT_get_affine_coordinates_GFp",
          "args": [
            "EC_KEY_get0_group(eck)",
            "EC_KEY_get0_public_key(eck)",
            "bn_x",
            "bn_y",
            "NULL"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EC_KEY_get0_public_key",
          "args": [
            "eck"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EC_KEY_get0_group",
          "args": [
            "eck"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "bn_y",
            "NULL"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "bn_x",
            "NULL"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_get_eckey(p1, eck)",
            "0"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_get_eckey",
          "args": [
            "p1",
            "eck"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_get_eckey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-crypto.c",
          "lines": "110-143",
          "snippet": "int\nsshbuf_get_eckey(struct sshbuf *buf, EC_KEY *v)\n{\n\tEC_POINT *pt = EC_POINT_new(EC_KEY_get0_group(v));\n\tint r;\n\tconst u_char *d;\n\tsize_t len;\n\n\tif (pt == NULL) {\n\t\tSSHBUF_DBG((\"SSH_ERR_ALLOC_FAIL\"));\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\t}\n\tif ((r = sshbuf_peek_string_direct(buf, &d, &len)) < 0) {\n\t\tEC_POINT_free(pt);\n\t\treturn r;\n\t}\n\tif ((r = get_ec(d, len, pt, EC_KEY_get0_group(v))) != 0) {\n\t\tEC_POINT_free(pt);\n\t\treturn r;\n\t}\n\tif (EC_KEY_set_public_key(v, pt) != 1) {\n\t\tEC_POINT_free(pt);\n\t\treturn SSH_ERR_ALLOC_FAIL; /* XXX assumption */\n\t}\n\tEC_POINT_free(pt);\n\t/* Skip string */\n\tif (sshbuf_get_string_direct(buf, NULL, NULL) != 0) {\n\t\t/* Shouldn't happen */\n\t\tSSHBUF_DBG((\"SSH_ERR_INTERNAL_ERROR\"));\n\t\tSSHBUF_ABORT();\n\t\treturn SSH_ERR_INTERNAL_ERROR;\n\t}\n\treturn 0;\t\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "# include <openssl/ec.h>",
            "#include <openssl/bn.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n# include <openssl/ec.h>\n#include <openssl/bn.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_get_eckey(struct sshbuf *buf, EC_KEY *v)\n{\n\tEC_POINT *pt = EC_POINT_new(EC_KEY_get0_group(v));\n\tint r;\n\tconst u_char *d;\n\tsize_t len;\n\n\tif (pt == NULL) {\n\t\tSSHBUF_DBG((\"SSH_ERR_ALLOC_FAIL\"));\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\t}\n\tif ((r = sshbuf_peek_string_direct(buf, &d, &len)) < 0) {\n\t\tEC_POINT_free(pt);\n\t\treturn r;\n\t}\n\tif ((r = get_ec(d, len, pt, EC_KEY_get0_group(v))) != 0) {\n\t\tEC_POINT_free(pt);\n\t\treturn r;\n\t}\n\tif (EC_KEY_set_public_key(v, pt) != 1) {\n\t\tEC_POINT_free(pt);\n\t\treturn SSH_ERR_ALLOC_FAIL; /* XXX assumption */\n\t}\n\tEC_POINT_free(pt);\n\t/* Skip string */\n\tif (sshbuf_get_string_direct(buf, NULL, NULL) != 0) {\n\t\t/* Shouldn't happen */\n\t\tSSHBUF_DBG((\"SSH_ERR_INTERNAL_ERROR\"));\n\t\tSSHBUF_ABORT();\n\t\treturn SSH_ERR_INTERNAL_ERROR;\n\t}\n\treturn 0;\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u8(p1, 0x00)",
            "0"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_put_u8",
          "args": [
            "p1",
            "0x00"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_u8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "335-345",
          "snippet": "int\nsshbuf_put_u8(struct sshbuf *buf, u_char val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 1, &p)) < 0)\n\t\treturn r;\n\tp[0] = val;\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_u8(struct sshbuf *buf, u_char val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 1, &p)) < 0)\n\t\treturn r;\n\tp[0] = val;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "sizeof(expec256) + 4"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_string(p1, expec256, sizeof(expec256))",
            "0"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_put_string",
          "args": [
            "p1",
            "expec256",
            "sizeof(expec256)"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "347-363",
          "snippet": "int\nsshbuf_put_string(struct sshbuf *buf, const void *v, size_t len)\n{\n\tu_char *d;\n\tint r;\n\n\tif (len > SSHBUF_SIZE_MAX - 4) {\n\t\tSSHBUF_DBG((\"SSH_ERR_NO_BUFFER_SPACE\"));\n\t\treturn SSH_ERR_NO_BUFFER_SPACE;\n\t}\n\tif ((r = sshbuf_reserve(buf, len + 4, &d)) < 0)\n\t\treturn r;\n\tPOKE_U32(d, len);\n\tif (len != 0)\n\t\tmemcpy(d + 4, v, len);\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_string(struct sshbuf *buf, const void *v, size_t len)\n{\n\tu_char *d;\n\tint r;\n\n\tif (len > SSHBUF_SIZE_MAX - 4) {\n\t\tSSHBUF_DBG((\"SSH_ERR_NO_BUFFER_SPACE\"));\n\t\treturn SSH_ERR_NO_BUFFER_SPACE;\n\t}\n\tif ((r = sshbuf_reserve(buf, len + 4, &d)) < 0)\n\t\treturn r;\n\tPOKE_U32(d, len);\n\tif (len != 0)\n\t\tmemcpy(d + 4, v, len);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_new",
          "args": [],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "68-85",
          "snippet": "struct sshbuf *\nsshbuf_new(void)\n{\n\tstruct sshbuf *ret;\n\n\tif ((ret = calloc(sizeof(*ret), 1)) == NULL)\n\t\treturn NULL;\n\tret->alloc = SSHBUF_SIZE_INIT;\n\tret->max_size = SSHBUF_SIZE_MAX;\n\tret->readonly = 0;\n\tret->refcount = 1;\n\tret->parent = NULL;\n\tif ((ret->cd = ret->d = calloc(1, ret->alloc)) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct sshbuf *\nsshbuf_new(void)\n{\n\tstruct sshbuf *ret;\n\n\tif ((ret = calloc(sizeof(*ret), 1)) == NULL)\n\t\treturn NULL;\n\tret->alloc = SSHBUF_SIZE_INIT;\n\tret->max_size = SSHBUF_SIZE_MAX;\n\tret->readonly = 0;\n\tret->refcount = 1;\n\tret->parent = NULL;\n\tif ((ret->cd = ret->d = calloc(1, ret->alloc)) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "eck",
            "NULL"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EC_KEY_new_by_curve_name",
          "args": [
            "ec256_nid"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_get_ec\""
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EC_KEY_free",
          "args": [
            "eck"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_MEM_EQ",
          "args": [
            "d",
            "expec256",
            "sizeof(expec256)"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "s",
            "sizeof(expec256)"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_get_string_direct(p1, &d, &s)",
            "0"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_get_string_direct",
          "args": [
            "p1",
            "&d",
            "&s"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_get_string_direct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "123-147",
          "snippet": "int\nsshbuf_get_string_direct(struct sshbuf *buf, const u_char **valp, size_t *lenp)\n{\n\tsize_t len;\n\tconst u_char *p;\n\tint r;\n\n\tif (valp != NULL)\n\t\t*valp = NULL;\n\tif (lenp != NULL)\n\t\t*lenp = 0;\n\tif ((r = sshbuf_peek_string_direct(buf, &p, &len)) < 0)\n\t\treturn r;\n\tif (valp != NULL)\n\t\t*valp = p;\n\tif (lenp != NULL)\n\t\t*lenp = len;\n\tif (sshbuf_consume(buf, len + 4) != 0) {\n\t\t/* Shouldn't happen */\n\t\tSSHBUF_DBG((\"SSH_ERR_INTERNAL_ERROR\"));\n\t\tSSHBUF_ABORT();\n\t\treturn SSH_ERR_INTERNAL_ERROR;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_get_string_direct(struct sshbuf *buf, const u_char **valp, size_t *lenp)\n{\n\tsize_t len;\n\tconst u_char *p;\n\tint r;\n\n\tif (valp != NULL)\n\t\t*valp = NULL;\n\tif (lenp != NULL)\n\t\t*lenp = 0;\n\tif ((r = sshbuf_peek_string_direct(buf, &p, &len)) < 0)\n\t\treturn r;\n\tif (valp != NULL)\n\t\t*valp = p;\n\tif (lenp != NULL)\n\t\t*lenp = len;\n\tif (sshbuf_consume(buf, len + 4) != 0) {\n\t\t/* Shouldn't happen */\n\t\tSSHBUF_DBG((\"SSH_ERR_INTERNAL_ERROR\"));\n\t\tSSHBUF_ABORT();\n\t\treturn SSH_ERR_INTERNAL_ERROR;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_eckey(p1, eck)",
            "0"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_put_eckey",
          "args": [
            "p1",
            "eck"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_eckey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-crypto.c",
          "lines": "217-222",
          "snippet": "int\nsshbuf_put_eckey(struct sshbuf *buf, const EC_KEY *v)\n{\n\treturn sshbuf_put_ec(buf, EC_KEY_get0_public_key(v),\n\t    EC_KEY_get0_group(v));\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "# include <openssl/ec.h>",
            "#include <openssl/bn.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n# include <openssl/ec.h>\n#include <openssl/bn.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_eckey(struct sshbuf *buf, const EC_KEY *v)\n{\n\treturn sshbuf_put_ec(buf, EC_KEY_get0_public_key(v),\n\t    EC_KEY_get0_group(v));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EC_POINT_free",
          "args": [
            "ecp"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn_y"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn_x"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "EC_KEY_set_public_key(eck, ecp)",
            "1"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EC_KEY_set_public_key",
          "args": [
            "eck",
            "ecp"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "EC_POINT_set_affine_coordinates_GFp(\n\t    EC_KEY_get0_group(eck), ecp, bn_x, bn_y, NULL)",
            "1"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EC_POINT_set_affine_coordinates_GFp",
          "args": [
            "EC_KEY_get0_group(eck)",
            "ecp",
            "bn_x",
            "bn_y",
            "NULL"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EC_KEY_get0_group",
          "args": [
            "eck"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "ec256_y",
            "bn_y"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "ec256_x",
            "bn_x"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "ecp",
            "NULL"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EC_POINT_new",
          "args": [
            "EC_KEY_get0_group(eck)"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EC_KEY_get0_group",
          "args": [
            "eck"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "eck",
            "NULL"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EC_KEY_new_by_curve_name",
          "args": [
            "ec256_nid"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_put_ec\""
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn2"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "sizeof(expbn2) + 4"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "r",
            "SSH_ERR_BIGNUM_IS_NEGATIVE"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_get_bignum2",
          "args": [
            "p1",
            "bn2"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_get_bignum2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-crypto.c",
          "lines": "34-46",
          "snippet": "int\nsshbuf_get_bignum2(struct sshbuf *buf, BIGNUM *v)\n{\n\tconst u_char *d;\n\tsize_t len;\n\tint r;\n\n\tif ((r = sshbuf_get_bignum2_bytes_direct(buf, &d, &len)) != 0)\n\t\treturn r;\n\tif (v != NULL && BN_bin2bn(d, len, v) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "# include <openssl/ec.h>",
            "#include <openssl/bn.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n# include <openssl/ec.h>\n#include <openssl/bn.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_get_bignum2(struct sshbuf *buf, BIGNUM *v)\n{\n\tconst u_char *d;\n\tsize_t len;\n\tint r;\n\n\tif ((r = sshbuf_get_bignum2_bytes_direct(buf, &d, &len)) != 0)\n\t\treturn r;\n\tif (v != NULL && BN_bin2bn(d, len, v) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put(p1, expbn2, sizeof(expbn2))",
            "0"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_put",
          "args": [
            "p1",
            "expbn2",
            "sizeof(expbn2)"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_putf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "254-264",
          "snippet": "int\nsshbuf_putf(struct sshbuf *buf, const char *fmt, ...)\n{\n\tva_list ap;\n\tint r;\n\n\tva_start(ap, fmt);\n\tr = sshbuf_putfv(buf, fmt, ap);\n\tva_end(ap);\n\treturn r;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_putf(struct sshbuf *buf, const char *fmt, ...)\n{\n\tva_list ap;\n\tint r;\n\n\tva_start(ap, fmt);\n\tr = sshbuf_putfv(buf, fmt, ap);\n\tva_end(ap);\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u32(p1, BN_num_bytes(bn))",
            "0"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_put_u32",
          "args": [
            "p1",
            "BN_num_bytes(bn)"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_u32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "311-321",
          "snippet": "int\nsshbuf_put_u32(struct sshbuf *buf, u_int32_t val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 4, &p)) < 0)\n\t\treturn r;\n\tPOKE_U32(p, val);\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_u32(struct sshbuf *buf, u_int32_t val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 4, &p)) < 0)\n\t\treturn r;\n\tPOKE_U32(p, val);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_num_bytes",
          "args": [
            "bn"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn2",
            "bn"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_get_bignum2 bn2 negative\""
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn2"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "sizeof(expbn2) + 1 + 4 - 1"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "r",
            "SSH_ERR_MESSAGE_INCOMPLETE"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put(p1, expbn2, sizeof(expbn2) - 1)",
            "0"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u8(p1, 0x00)",
            "0"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u32(p1, BN_num_bytes(bn) + 1)",
            "0"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_num_bytes",
          "args": [
            "bn"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn2",
            "bn"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_get_bignum2 bn2 truncated\""
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn2"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "2"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_BIGNUM_EQ",
          "args": [
            "bn",
            "bn2"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_get_bignum2(p1, bn2)",
            "0"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u16(p1, 0xd00f)",
            "0"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_put_u16",
          "args": [
            "p1",
            "0xd00f"
          ],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_u16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "323-333",
          "snippet": "int\nsshbuf_put_u16(struct sshbuf *buf, u_int16_t val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 2, &p)) < 0)\n\t\treturn r;\n\tPOKE_U16(p, val);\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_u16(struct sshbuf *buf, u_int16_t val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 2, &p)) < 0)\n\t\treturn r;\n\tPOKE_U16(p, val);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "4 + 1 + sizeof(expbn2)"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put(p1, expbn2, sizeof(expbn2))",
            "0"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u8(p1, 0x00)",
            "0"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u32(p1, BN_num_bytes(bn) + 1)",
            "0"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_num_bytes",
          "args": [
            "bn"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn2",
            "bn"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_get_bignum2 bn2\""
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn2"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "65536 + 4"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "r",
            "SSH_ERR_BIGNUM_TOO_LARGE"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_reserve(p1, 65536, NULL)",
            "0"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_reserve",
          "args": [
            "p1",
            "65536",
            "NULL"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_reserve",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "343-361",
          "snippet": "int\nsshbuf_reserve(struct sshbuf *buf, size_t len, u_char **dpp)\n{\n\tu_char *dp;\n\tint r;\n\n\tif (dpp != NULL)\n\t\t*dpp = NULL;\n\n\tSSHBUF_DBG((\"reserve buf = %p len = %zu\", buf, len));\n\tif ((r = sshbuf_allocate(buf, len)) != 0)\n\t\treturn r;\n\n\tdp = buf->d + buf->size;\n\tbuf->size += len;\n\tif (dpp != NULL)\n\t\t*dpp = dp;\n\treturn 0;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_reserve(struct sshbuf *buf, size_t len, u_char **dpp)\n{\n\tu_char *dp;\n\tint r;\n\n\tif (dpp != NULL)\n\t\t*dpp = NULL;\n\n\tSSHBUF_DBG((\"reserve buf = %p len = %zu\", buf, len));\n\tif ((r = sshbuf_allocate(buf, len)) != 0)\n\t\treturn r;\n\n\tdp = buf->d + buf->size;\n\tbuf->size += len;\n\tif (dpp != NULL)\n\t\t*dpp = dp;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u32(p1, 65536)",
            "0"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn1",
            "bn"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_get_bignum2 giant\""
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn2"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "sizeof(expbn1) + 3"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "r",
            "SSH_ERR_MESSAGE_INCOMPLETE"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put(p1, expbn1, sizeof(expbn1) - 1)",
            "0"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u32(p1, BN_num_bytes(bn))",
            "0"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_num_bytes",
          "args": [
            "bn"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn1",
            "bn"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_get_bignum2 truncated\""
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn2"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "2"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_BIGNUM_EQ",
          "args": [
            "bn",
            "bn2"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_get_bignum2(p1, bn2)",
            "0"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u16(p1, 0xd00f)",
            "0"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "4 + sizeof(expbn1)"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put(p1, expbn1, sizeof(expbn1))",
            "0"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u32(p1, BN_num_bytes(bn))",
            "0"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_num_bytes",
          "args": [
            "bn"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn1",
            "bn"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_get_bignum2\""
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn2"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "2 + sizeof(expbn2) - 1"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "r",
            "SSH_ERR_MESSAGE_INCOMPLETE"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_get_bignum1",
          "args": [
            "p1",
            "bn2"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_get_bignum1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-crypto.c",
          "lines": "48-72",
          "snippet": "int\nsshbuf_get_bignum1(struct sshbuf *buf, BIGNUM *v)\n{\n\tconst u_char *d = sshbuf_ptr(buf);\n\tu_int16_t len_bits;\n\tsize_t len_bytes;\n\n\t/* Length in bits */\n\tif (sshbuf_len(buf) < 2)\n\t\treturn SSH_ERR_MESSAGE_INCOMPLETE;\n\tlen_bits = PEEK_U16(d);\n\tlen_bytes = (len_bits + 7) >> 3;\n\tif (len_bytes > SSHBUF_MAX_BIGNUM)\n\t\treturn SSH_ERR_BIGNUM_TOO_LARGE;\n\tif (sshbuf_len(buf) < 2 + len_bytes)\n\t\treturn SSH_ERR_MESSAGE_INCOMPLETE;\n\tif (v != NULL && BN_bin2bn(d + 2, len_bytes, v) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif (sshbuf_consume(buf, 2 + len_bytes) != 0) {\n\t\tSSHBUF_DBG((\"SSH_ERR_INTERNAL_ERROR\"));\n\t\tSSHBUF_ABORT();\n\t\treturn SSH_ERR_INTERNAL_ERROR;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "# include <openssl/ec.h>",
            "#include <openssl/bn.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n# include <openssl/ec.h>\n#include <openssl/bn.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_get_bignum1(struct sshbuf *buf, BIGNUM *v)\n{\n\tconst u_char *d = sshbuf_ptr(buf);\n\tu_int16_t len_bits;\n\tsize_t len_bytes;\n\n\t/* Length in bits */\n\tif (sshbuf_len(buf) < 2)\n\t\treturn SSH_ERR_MESSAGE_INCOMPLETE;\n\tlen_bits = PEEK_U16(d);\n\tlen_bytes = (len_bits + 7) >> 3;\n\tif (len_bytes > SSHBUF_MAX_BIGNUM)\n\t\treturn SSH_ERR_BIGNUM_TOO_LARGE;\n\tif (sshbuf_len(buf) < 2 + len_bytes)\n\t\treturn SSH_ERR_MESSAGE_INCOMPLETE;\n\tif (v != NULL && BN_bin2bn(d + 2, len_bytes, v) == NULL)\n\t\treturn SSH_ERR_ALLOC_FAIL;\n\tif (sshbuf_consume(buf, 2 + len_bytes) != 0) {\n\t\tSSHBUF_DBG((\"SSH_ERR_INTERNAL_ERROR\"));\n\t\tSSHBUF_ABORT();\n\t\treturn SSH_ERR_INTERNAL_ERROR;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "2 + sizeof(expbn2) - 1"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put(p1, expbn2, sizeof(expbn2) - 1)",
            "0"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u16(p1, BN_num_bits(bn))",
            "0"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_num_bits",
          "args": [
            "bn"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn2",
            "bn"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_get_bignum1 bn2 truncated\""
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn2"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "2"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_BIGNUM_EQ",
          "args": [
            "bn",
            "bn2"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_get_bignum1(p1, bn2)",
            "0"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u16(p1, 0xd00f)",
            "0"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "2 + sizeof(expbn2)"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put(p1, expbn2, sizeof(expbn2))",
            "0"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u16(p1, BN_num_bits(bn))",
            "0"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_num_bits",
          "args": [
            "bn"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn2",
            "bn"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_get_bignum1 bn2\""
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn2"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "2 + ((0xffff + 7) / 8)"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "r",
            "SSH_ERR_BIGNUM_TOO_LARGE"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "2 + ((0xffff + 7) / 8)"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_reserve(p1, (0xffff + 7) / 8, NULL)",
            "0"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u16(p1, 0xffff)",
            "0"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn1",
            "bn"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_get_bignum1 giant\""
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn2"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "2 + sizeof(expbn1) - 1"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "r",
            "SSH_ERR_MESSAGE_INCOMPLETE"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "2 + sizeof(expbn1) - 1"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put(p1, expbn1, sizeof(expbn1) - 1)",
            "0"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u16(p1, BN_num_bits(bn))",
            "0"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_num_bits",
          "args": [
            "bn"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn1",
            "bn"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_get_bignum1 truncated\""
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn2"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "2"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_BIGNUM_EQ",
          "args": [
            "bn",
            "bn2"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_get_bignum1(p1, bn2)",
            "0"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u16(p1, 0xd00f)",
            "0"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "2 + sizeof(expbn1)"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put(p1, expbn1, sizeof(expbn1))",
            "0"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u16(p1, BN_num_bits(bn))",
            "0"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_num_bits",
          "args": [
            "bn"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn1",
            "bn"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_get_bignum1\""
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "0"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "r",
            "SSH_ERR_NO_BUFFER_SPACE"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_put_bignum2",
          "args": [
            "p1",
            "bn"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_bignum2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-crypto.c",
          "lines": "146-166",
          "snippet": "int\nsshbuf_put_bignum2(struct sshbuf *buf, const BIGNUM *v)\n{\n\tu_char d[SSHBUF_MAX_BIGNUM + 1];\n\tint len = BN_num_bytes(v), prepend = 0, r;\n\n\tif (len < 0 || len > SSHBUF_MAX_BIGNUM)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\t*d = '\\0';\n\tif (BN_bn2bin(v, d + 1) != len)\n\t\treturn SSH_ERR_INTERNAL_ERROR; /* Shouldn't happen */\n\t/* If MSB is set, prepend a \\0 */\n\tif (len > 0 && (d[1] & 0x80) != 0)\n\t\tprepend = 1;\n\tif ((r = sshbuf_put_string(buf, d + 1 - prepend, len + prepend)) < 0) {\n\t\texplicit_bzero(d, sizeof(d));\n\t\treturn r;\n\t}\n\texplicit_bzero(d, sizeof(d));\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "# include <openssl/ec.h>",
            "#include <openssl/bn.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n# include <openssl/ec.h>\n#include <openssl/bn.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_bignum2(struct sshbuf *buf, const BIGNUM *v)\n{\n\tu_char d[SSHBUF_MAX_BIGNUM + 1];\n\tint len = BN_num_bytes(v), prepend = 0, r;\n\n\tif (len < 0 || len > SSHBUF_MAX_BIGNUM)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\t*d = '\\0';\n\tif (BN_bn2bin(v, d + 1) != len)\n\t\treturn SSH_ERR_INTERNAL_ERROR; /* Shouldn't happen */\n\t/* If MSB is set, prepend a \\0 */\n\tif (len > 0 && (d[1] & 0x80) != 0)\n\t\tprepend = 1;\n\tif ((r = sshbuf_put_string(buf, d + 1 - prepend, len + prepend)) < 0) {\n\t\texplicit_bzero(d, sizeof(d));\n\t\treturn r;\n\t}\n\texplicit_bzero(d, sizeof(d));\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_set_max_size(p1, sizeof(expbn2) + 3)",
            "0"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_set_max_size",
          "args": [
            "p1",
            "sizeof(expbn2) + 3"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_set_max_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "214-250",
          "snippet": "int\nsshbuf_set_max_size(struct sshbuf *buf, size_t max_size)\n{\n\tsize_t rlen;\n\tu_char *dp;\n\tint r;\n\n\tSSHBUF_DBG((\"set max buf = %p len = %zu\", buf, max_size));\n\tif ((r = sshbuf_check_sanity(buf)) != 0)\n\t\treturn r;\n\tif (max_size == buf->max_size)\n\t\treturn 0;\n\tif (buf->readonly || buf->refcount > 1)\n\t\treturn SSH_ERR_BUFFER_READ_ONLY;\n\tif (max_size > SSHBUF_SIZE_MAX)\n\t\treturn SSH_ERR_NO_BUFFER_SPACE;\n\t/* pack and realloc if necessary */\n\tsshbuf_maybe_pack(buf, max_size < buf->size);\n\tif (max_size < buf->alloc && max_size > buf->size) {\n\t\tif (buf->size < SSHBUF_SIZE_INIT)\n\t\t\trlen = SSHBUF_SIZE_INIT;\n\t\telse\n\t\t\trlen = ROUNDUP(buf->size, SSHBUF_SIZE_INC);\n\t\tif (rlen > max_size)\n\t\t\trlen = max_size;\n\t\tSSHBUF_DBG((\"new alloc = %zu\", rlen));\n\t\tif ((dp = recallocarray(buf->d, buf->alloc, rlen, 1)) == NULL)\n\t\t\treturn SSH_ERR_ALLOC_FAIL;\n\t\tbuf->cd = buf->d = dp;\n\t\tbuf->alloc = rlen;\n\t}\n\tSSHBUF_TELL(\"new-max\");\n\tif (max_size < buf->alloc)\n\t\treturn SSH_ERR_NO_BUFFER_SPACE;\n\tbuf->max_size = max_size;\n\treturn 0;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_set_max_size(struct sshbuf *buf, size_t max_size)\n{\n\tsize_t rlen;\n\tu_char *dp;\n\tint r;\n\n\tSSHBUF_DBG((\"set max buf = %p len = %zu\", buf, max_size));\n\tif ((r = sshbuf_check_sanity(buf)) != 0)\n\t\treturn r;\n\tif (max_size == buf->max_size)\n\t\treturn 0;\n\tif (buf->readonly || buf->refcount > 1)\n\t\treturn SSH_ERR_BUFFER_READ_ONLY;\n\tif (max_size > SSHBUF_SIZE_MAX)\n\t\treturn SSH_ERR_NO_BUFFER_SPACE;\n\t/* pack and realloc if necessary */\n\tsshbuf_maybe_pack(buf, max_size < buf->size);\n\tif (max_size < buf->alloc && max_size > buf->size) {\n\t\tif (buf->size < SSHBUF_SIZE_INIT)\n\t\t\trlen = SSHBUF_SIZE_INIT;\n\t\telse\n\t\t\trlen = ROUNDUP(buf->size, SSHBUF_SIZE_INC);\n\t\tif (rlen > max_size)\n\t\t\trlen = max_size;\n\t\tSSHBUF_DBG((\"new alloc = %zu\", rlen));\n\t\tif ((dp = recallocarray(buf->d, buf->alloc, rlen, 1)) == NULL)\n\t\t\treturn SSH_ERR_ALLOC_FAIL;\n\t\tbuf->cd = buf->d = dp;\n\t\tbuf->alloc = rlen;\n\t}\n\tSSHBUF_TELL(\"new-max\");\n\tif (max_size < buf->alloc)\n\t\treturn SSH_ERR_NO_BUFFER_SPACE;\n\tbuf->max_size = max_size;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn2",
            "bn"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_put_bignum2 bn2 limited\""
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_MEM_EQ",
          "args": [
            "sshbuf_ptr(p1) + 5",
            "expbn2",
            "sizeof(expbn2)"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_ptr",
          "args": [
            "p1"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "268-274",
          "snippet": "const u_char *\nsshbuf_ptr(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn NULL;\n\treturn buf->cd + buf->off;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst u_char *\nsshbuf_ptr(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn NULL;\n\treturn buf->cd + buf->off;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_U8_EQ",
          "args": [
            "*(sshbuf_ptr(p1) + 4)",
            "0x00"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_U32_EQ",
          "args": [
            "PEEK_U32(sshbuf_ptr(p1))",
            "(u_int32_t)BN_num_bytes(bn) + 1"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_num_bytes",
          "args": [
            "bn"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PEEK_U32",
          "args": [
            "sshbuf_ptr(p1)"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "sizeof(expbn2) + 4 + 1"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_bignum2(p1, bn)",
            "0"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn2",
            "bn"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_put_bignum2 bn2\""
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "0"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "r",
            "SSH_ERR_NO_BUFFER_SPACE"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_set_max_size(p1, sizeof(expbn1) + 3)",
            "0"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn1",
            "bn"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_put_bignum2 limited\""
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_MEM_EQ",
          "args": [
            "sshbuf_ptr(p1) + 4",
            "expbn1",
            "sizeof(expbn1)"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_U32_EQ",
          "args": [
            "PEEK_U32(sshbuf_ptr(p1))",
            "(u_int32_t)BN_num_bytes(bn)"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_num_bytes",
          "args": [
            "bn"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PEEK_U32",
          "args": [
            "sshbuf_ptr(p1)"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "sizeof(expbn1) + 4"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_bignum2(p1, bn)",
            "0"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn1",
            "bn"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_put_bignum2\""
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "0"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "r",
            "SSH_ERR_NO_BUFFER_SPACE"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_put_bignum1",
          "args": [
            "p1",
            "bn"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_bignum1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-crypto.c",
          "lines": "168-188",
          "snippet": "int\nsshbuf_put_bignum1(struct sshbuf *buf, const BIGNUM *v)\n{\n\tint r, len_bits = BN_num_bits(v);\n\tsize_t len_bytes = (len_bits + 7) / 8;\n\tu_char d[SSHBUF_MAX_BIGNUM], *dp;\n\n\tif (len_bits < 0 || len_bytes > SSHBUF_MAX_BIGNUM)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (BN_bn2bin(v, d) != (int)len_bytes)\n\t\treturn SSH_ERR_INTERNAL_ERROR; /* Shouldn't happen */\n\tif ((r = sshbuf_reserve(buf, len_bytes + 2, &dp)) < 0) {\n\t\texplicit_bzero(d, sizeof(d));\n\t\treturn r;\n\t}\n\tPOKE_U16(dp, len_bits);\n\tif (len_bytes != 0)\n\t\tmemcpy(dp + 2, d, len_bytes);\n\texplicit_bzero(d, sizeof(d));\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "# include <openssl/ec.h>",
            "#include <openssl/bn.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n# include <openssl/ec.h>\n#include <openssl/bn.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_bignum1(struct sshbuf *buf, const BIGNUM *v)\n{\n\tint r, len_bits = BN_num_bits(v);\n\tsize_t len_bytes = (len_bits + 7) / 8;\n\tu_char d[SSHBUF_MAX_BIGNUM], *dp;\n\n\tif (len_bits < 0 || len_bytes > SSHBUF_MAX_BIGNUM)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (BN_bn2bin(v, d) != (int)len_bytes)\n\t\treturn SSH_ERR_INTERNAL_ERROR; /* Shouldn't happen */\n\tif ((r = sshbuf_reserve(buf, len_bytes + 2, &dp)) < 0) {\n\t\texplicit_bzero(d, sizeof(d));\n\t\treturn r;\n\t}\n\tPOKE_U16(dp, len_bits);\n\tif (len_bytes != 0)\n\t\tmemcpy(dp + 2, d, len_bytes);\n\texplicit_bzero(d, sizeof(d));\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_set_max_size(p1, sizeof(expbn1) + 1)",
            "0"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn2",
            "bn"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_put_bignum1 bn2 limited\""
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_MEM_EQ",
          "args": [
            "sshbuf_ptr(p1) + 2",
            "expbn2",
            "sizeof(expbn2)"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_U16_EQ",
          "args": [
            "PEEK_U16(sshbuf_ptr(p1))",
            "(u_int16_t)BN_num_bits(bn)"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_num_bits",
          "args": [
            "bn"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PEEK_U16",
          "args": [
            "sshbuf_ptr(p1)"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "sizeof(expbn2) + 2"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_bignum1(p1, bn)",
            "0"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn2",
            "bn"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_put_bignum1 bn2\""
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "0"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "r",
            "SSH_ERR_NO_BUFFER_SPACE"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_set_max_size(p1, sizeof(expbn1) + 1)",
            "0"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn1",
            "bn"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_put_bignum1 limited\""
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_free",
          "args": [
            "bn"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_MEM_EQ",
          "args": [
            "sshbuf_ptr(p1) + 2",
            "expbn1",
            "sizeof(expbn1)"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_U16_EQ",
          "args": [
            "PEEK_U16(sshbuf_ptr(p1))",
            "(u_int16_t)BN_num_bits(bn)"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_num_bits",
          "args": [
            "bn"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PEEK_U16",
          "args": [
            "sshbuf_ptr(p1)"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_SIZE_T_EQ",
          "args": [
            "sshbuf_len(p1)",
            "sizeof(expbn1) + 2"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_bignum1(p1, bn)",
            "0"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "p1",
            "NULL"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKBN",
          "args": [
            "hexbn1",
            "bn"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"sshbuf_put_bignum1\""
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"../test_helper/test_helper.h\"\n# include <openssl/ec.h>\n#include <openssl/objects.h>\n#include <openssl/bn.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid sshbuf_getput_crypto_tests(void);\n\nvoid\nsshbuf_getput_crypto_tests(void)\n{\n\tstruct sshbuf *p1;\n\tBIGNUM *bn, *bn2;\n\t/* This one has num_bits != num_bytes * 8 to test bignum1 encoding */\n\tconst char *hexbn1 = \"0102030405060708090a0b0c0d0e0f10\";\n\t/* This one has MSB set to test bignum2 encoding negative-avoidance */\n\tconst char *hexbn2 = \"f0e0d0c0b0a0908070605040302010007fff11\";\n\tu_char expbn1[] = {\n\t\t0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08,\n\t\t0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x10,\n\t};\n\tu_char expbn2[] = {\n\t\t0xf0, 0xe0, 0xd0, 0xc0, 0xb0, 0xa0, 0x90, 0x80,\n\t\t0x70, 0x60, 0x50, 0x40, 0x30, 0x20, 0x10, 0x00,\n\t\t0x7f, 0xff, 0x11\n\t};\n#if defined(OPENSSL_HAS_ECC) && defined(OPENSSL_HAS_NISTP256)\n\tconst u_char *d;\n\tsize_t s;\n\tBIGNUM *bn_x, *bn_y;\n\tint ec256_nid = NID_X9_62_prime256v1;\n\tchar *ec256_x = \"0C828004839D0106AA59575216191357\"\n\t\t        \"34B451459DADB586677EF9DF55784999\";\n\tchar *ec256_y = \"4D196B50F0B4E94B3C73E3A9D4CD9DF2\"\n\t                \"C8F9A35E42BDD047550F69D80EC23CD4\";\n\tu_char expec256[] = {\n\t\t0x04,\n\t\t0x0c, 0x82, 0x80, 0x04, 0x83, 0x9d, 0x01, 0x06,\n\t\t0xaa, 0x59, 0x57, 0x52, 0x16, 0x19, 0x13, 0x57,\n\t\t0x34, 0xb4, 0x51, 0x45, 0x9d, 0xad, 0xb5, 0x86,\n\t\t0x67, 0x7e, 0xf9, 0xdf, 0x55, 0x78, 0x49, 0x99,\n\t\t0x4d, 0x19, 0x6b, 0x50, 0xf0, 0xb4, 0xe9, 0x4b,\n\t\t0x3c, 0x73, 0xe3, 0xa9, 0xd4, 0xcd, 0x9d, 0xf2,\n\t\t0xc8, 0xf9, 0xa3, 0x5e, 0x42, 0xbd, 0xd0, 0x47,\n\t\t0x55, 0x0f, 0x69, 0xd8, 0x0e, 0xc2, 0x3c, 0xd4\n\t};\n\tEC_KEY *eck;\n\tEC_POINT *ecp;\n#endif\n\tint r;\n\n#define MKBN(b, bnn) \\\n\tdo { \\\n\t\tbnn = NULL; \\\n\t\tASSERT_INT_GT(BN_hex2bn(&bnn, b), 0); \\\n\t} while (0)\n\n\tTEST_START(\"sshbuf_put_bignum1\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_bignum1(p1, bn), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(expbn1) + 2);\n\tASSERT_U16_EQ(PEEK_U16(sshbuf_ptr(p1)), (u_int16_t)BN_num_bits(bn));\n\tASSERT_MEM_EQ(sshbuf_ptr(p1) + 2, expbn1, sizeof(expbn1));\n\tBN_free(bn);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum1 limited\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_set_max_size(p1, sizeof(expbn1) + 1), 0);\n\tr = sshbuf_put_bignum1(p1, bn);\n\tASSERT_INT_EQ(r, SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 0);\n\tBN_free(bn);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum1 bn2\");\n\tMKBN(hexbn2, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_bignum1(p1, bn), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(expbn2) + 2);\n\tASSERT_U16_EQ(PEEK_U16(sshbuf_ptr(p1)), (u_int16_t)BN_num_bits(bn));\n\tASSERT_MEM_EQ(sshbuf_ptr(p1) + 2, expbn2, sizeof(expbn2));\n\tBN_free(bn);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum1 bn2 limited\");\n\tMKBN(hexbn2, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_set_max_size(p1, sizeof(expbn1) + 1), 0);\n\tr = sshbuf_put_bignum1(p1, bn);\n\tASSERT_INT_EQ(r, SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 0);\n\tBN_free(bn);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum2\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_bignum2(p1, bn), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(expbn1) + 4);\n\tASSERT_U32_EQ(PEEK_U32(sshbuf_ptr(p1)), (u_int32_t)BN_num_bytes(bn));\n\tASSERT_MEM_EQ(sshbuf_ptr(p1) + 4, expbn1, sizeof(expbn1));\n\tBN_free(bn);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum2 limited\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_set_max_size(p1, sizeof(expbn1) + 3), 0);\n\tr = sshbuf_put_bignum2(p1, bn);\n\tASSERT_INT_EQ(r, SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 0);\n\tBN_free(bn);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum2 bn2\");\n\tMKBN(hexbn2, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_bignum2(p1, bn), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(expbn2) + 4 + 1); /* MSB */\n\tASSERT_U32_EQ(PEEK_U32(sshbuf_ptr(p1)), (u_int32_t)BN_num_bytes(bn) + 1);\n\tASSERT_U8_EQ(*(sshbuf_ptr(p1) + 4), 0x00);\n\tASSERT_MEM_EQ(sshbuf_ptr(p1) + 5, expbn2, sizeof(expbn2));\n\tBN_free(bn);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_put_bignum2 bn2 limited\");\n\tMKBN(hexbn2, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_set_max_size(p1, sizeof(expbn2) + 3), 0);\n\tr = sshbuf_put_bignum2(p1, bn);\n\tASSERT_INT_EQ(r, SSH_ERR_NO_BUFFER_SPACE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 0);\n\tBN_free(bn);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum1\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, BN_num_bits(bn)), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, expbn1, sizeof(expbn1)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2 + sizeof(expbn1));\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, 0xd00f), 0);\n\tbn2 = BN_new();\n\tASSERT_INT_EQ(sshbuf_get_bignum1(p1, bn2), 0);\n\tASSERT_BIGNUM_EQ(bn, bn2);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum1 truncated\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, BN_num_bits(bn)), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, expbn1, sizeof(expbn1) - 1), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2 + sizeof(expbn1) - 1);\n\tbn2 = BN_new();\n\tr = sshbuf_get_bignum1(p1, bn2);\n\tASSERT_INT_EQ(r, SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2 + sizeof(expbn1) - 1);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum1 giant\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, 0xffff), 0);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, (0xffff + 7) / 8, NULL), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2 + ((0xffff + 7) / 8));\n\tbn2 = BN_new();\n\tr = sshbuf_get_bignum1(p1, bn2);\n\tASSERT_INT_EQ(r, SSH_ERR_BIGNUM_TOO_LARGE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2 + ((0xffff + 7) / 8));\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum1 bn2\");\n\tMKBN(hexbn2, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, BN_num_bits(bn)), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, expbn2, sizeof(expbn2)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2 + sizeof(expbn2));\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, 0xd00f), 0);\n\tbn2 = BN_new();\n\tASSERT_INT_EQ(sshbuf_get_bignum1(p1, bn2), 0);\n\tASSERT_BIGNUM_EQ(bn, bn2);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum1 bn2 truncated\");\n\tMKBN(hexbn2, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, BN_num_bits(bn)), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, expbn2, sizeof(expbn2) - 1), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2 + sizeof(expbn2) - 1);\n\tbn2 = BN_new();\n\tr = sshbuf_get_bignum1(p1, bn2);\n\tASSERT_INT_EQ(r, SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2 + sizeof(expbn2) - 1);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum2\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, BN_num_bytes(bn)), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, expbn1, sizeof(expbn1)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 4 + sizeof(expbn1));\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, 0xd00f), 0);\n\tbn2 = BN_new();\n\tASSERT_INT_EQ(sshbuf_get_bignum2(p1, bn2), 0);\n\tASSERT_BIGNUM_EQ(bn, bn2);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum2 truncated\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, BN_num_bytes(bn)), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, expbn1, sizeof(expbn1) - 1), 0);\n\tbn2 = BN_new();\n\tr = sshbuf_get_bignum2(p1, bn2);\n\tASSERT_INT_EQ(r, SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(expbn1) + 3);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum2 giant\");\n\tMKBN(hexbn1, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, 65536), 0);\n\tASSERT_INT_EQ(sshbuf_reserve(p1, 65536, NULL), 0);\n\tbn2 = BN_new();\n\tr = sshbuf_get_bignum2(p1, bn2);\n\tASSERT_INT_EQ(r, SSH_ERR_BIGNUM_TOO_LARGE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 65536 + 4);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum2 bn2\");\n\tMKBN(hexbn2, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, BN_num_bytes(bn) + 1), 0); /* MSB */\n\tASSERT_INT_EQ(sshbuf_put_u8(p1, 0x00), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, expbn2, sizeof(expbn2)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 4 + 1 + sizeof(expbn2));\n\tASSERT_INT_EQ(sshbuf_put_u16(p1, 0xd00f), 0);\n\tbn2 = BN_new();\n\tASSERT_INT_EQ(sshbuf_get_bignum2(p1, bn2), 0);\n\tASSERT_BIGNUM_EQ(bn, bn2);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 2);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum2 bn2 truncated\");\n\tMKBN(hexbn2, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, BN_num_bytes(bn) + 1), 0);\n\tASSERT_INT_EQ(sshbuf_put_u8(p1, 0x00), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, expbn2, sizeof(expbn2) - 1), 0);\n\tbn2 = BN_new();\n\tr = sshbuf_get_bignum2(p1, bn2);\n\tASSERT_INT_EQ(r, SSH_ERR_MESSAGE_INCOMPLETE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(expbn2) + 1 + 4 - 1);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_bignum2 bn2 negative\");\n\tMKBN(hexbn2, bn);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_u32(p1, BN_num_bytes(bn)), 0);\n\tASSERT_INT_EQ(sshbuf_put(p1, expbn2, sizeof(expbn2)), 0);\n\tbn2 = BN_new();\n\tr = sshbuf_get_bignum2(p1, bn2);\n\tASSERT_INT_EQ(r, SSH_ERR_BIGNUM_IS_NEGATIVE);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(expbn2) + 4);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tsshbuf_free(p1);\n\tTEST_DONE();\n\n#if defined(OPENSSL_HAS_ECC) && defined(OPENSSL_HAS_NISTP256)\n\tTEST_START(\"sshbuf_put_ec\");\n\teck = EC_KEY_new_by_curve_name(ec256_nid);\n\tASSERT_PTR_NE(eck, NULL);\n\tecp = EC_POINT_new(EC_KEY_get0_group(eck));\n\tASSERT_PTR_NE(ecp, NULL);\n\tMKBN(ec256_x, bn_x);\n\tMKBN(ec256_y, bn_y);\n\tASSERT_INT_EQ(EC_POINT_set_affine_coordinates_GFp(\n\t    EC_KEY_get0_group(eck), ecp, bn_x, bn_y, NULL), 1);\n\tASSERT_INT_EQ(EC_KEY_set_public_key(eck, ecp), 1);\n\tBN_free(bn_x);\n\tBN_free(bn_y);\n\tEC_POINT_free(ecp);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_eckey(p1, eck), 0);\n\tASSERT_INT_EQ(sshbuf_get_string_direct(p1, &d, &s), 0);\n\tASSERT_SIZE_T_EQ(s, sizeof(expec256));\n\tASSERT_MEM_EQ(d, expec256, sizeof(expec256));\n\tsshbuf_free(p1);\n\tEC_KEY_free(eck);\n\tTEST_DONE();\n\n\tTEST_START(\"sshbuf_get_ec\");\n\teck = EC_KEY_new_by_curve_name(ec256_nid);\n\tASSERT_PTR_NE(eck, NULL);\n\tp1 = sshbuf_new();\n\tASSERT_PTR_NE(p1, NULL);\n\tASSERT_INT_EQ(sshbuf_put_string(p1, expec256, sizeof(expec256)), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), sizeof(expec256) + 4);\n\tASSERT_INT_EQ(sshbuf_put_u8(p1, 0x00), 0);\n\tASSERT_INT_EQ(sshbuf_get_eckey(p1, eck), 0);\n\tbn_x = BN_new();\n\tbn_y = BN_new();\n\tASSERT_PTR_NE(bn_x, NULL);\n\tASSERT_PTR_NE(bn_y, NULL);\n\tASSERT_INT_EQ(EC_POINT_get_affine_coordinates_GFp(\n\t    EC_KEY_get0_group(eck), EC_KEY_get0_public_key(eck),\n\t    bn_x, bn_y, NULL), 1);\n\tMKBN(ec256_x, bn);\n\tMKBN(ec256_y, bn2);\n\tASSERT_INT_EQ(BN_cmp(bn_x, bn), 0);\n\tASSERT_INT_EQ(BN_cmp(bn_y, bn2), 0);\n\tASSERT_SIZE_T_EQ(sshbuf_len(p1), 1);\n\tsshbuf_free(p1);\n\tEC_KEY_free(eck);\n\tBN_free(bn_x);\n\tBN_free(bn_y);\n\tBN_free(bn);\n\tBN_free(bn2);\n\tTEST_DONE();\n#endif\n}"
  }
]