[
  {
    "function_name": "_ssh_compat_fflush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "314-326",
    "snippet": "int _ssh_compat_fflush(FILE *f)\n{\n\tint r1, r2;\n\n\tif (f == NULL) {\n\t\tr1 = fflush(stdout);\n\t\tr2 = fflush(stderr);\n\t\tif (r1 == -1 || r2 == -1)\n\t\t\treturn -1;\n\t\treturn 0;\n\t}\n\treturn fflush(f);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fflush",
          "args": [
            "f"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "_ssh_compat_fflush",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
          "lines": "314-326",
          "snippet": "int _ssh_compat_fflush(FILE *f)\n{\n\tint r1, r2;\n\n\tif (f == NULL) {\n\t\tr1 = fflush(stdout);\n\t\tr2 = fflush(stderr);\n\t\tif (r1 == -1 || r2 == -1)\n\t\t\treturn -1;\n\t\treturn 0;\n\t}\n\treturn fflush(f);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint _ssh_compat_fflush(FILE *f)\n{\n\tint r1, r2;\n\n\tif (f == NULL) {\n\t\tr1 = fflush(stdout);\n\t\tr2 = fflush(stderr);\n\t\tif (r1 == -1 || r2 == -1)\n\t\t\treturn -1;\n\t\treturn 0;\n\t}\n\treturn fflush(f);\n}"
  },
  {
    "function_name": "getsid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "304-309",
    "snippet": "pid_t\ngetsid(pid_t pid)\n{\n\terrno = ENOSYS;\n\treturn -1;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\npid_t\ngetsid(pid_t pid)\n{\n\terrno = ENOSYS;\n\treturn -1;\n}"
  },
  {
    "function_name": "raise",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "296-300",
    "snippet": "int\nraise(int sig)\n{\n\tkill(getpid(), sig);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kill",
          "args": [
            "getpid()",
            "sig"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpid",
          "args": [],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nraise(int sig)\n{\n\tkill(getpid(), sig);\n}"
  },
  {
    "function_name": "bzero",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "288-292",
    "snippet": "void\nbzero(void *b, size_t n)\n{\n\t(void)memset(b, 0, n);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "b",
            "0",
            "n"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nbzero(void *b, size_t n)\n{\n\t(void)memset(b, 0, n);\n}"
  },
  {
    "function_name": "llabs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "280-284",
    "snippet": "long long\nllabs(long long j)\n{\n\treturn (j < 0 ? -j : j);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nlong long\nllabs(long long j)\n{\n\treturn (j < 0 ? -j : j);\n}"
  },
  {
    "function_name": "mbtowc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "264-276",
    "snippet": "int\nmbtowc(wchar_t *pwc, const char *s, size_t n)\n{\n\tif (s == NULL || *s == '\\0')\n\t\treturn 0;\t/* ASCII is not state-dependent */\n\tif (*s < 0 || *s > 0x7f || n < 1) {\n\t\terrno = EOPNOTSUPP;\n\t\treturn -1;\n\t}\n\tif (pwc != NULL)\n\t\t*pwc = *s;\n\treturn 1;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nmbtowc(wchar_t *pwc, const char *s, size_t n)\n{\n\tif (s == NULL || *s == '\\0')\n\t\treturn 0;\t/* ASCII is not state-dependent */\n\tif (*s < 0 || *s > 0x7f || n < 1) {\n\t\terrno = EOPNOTSUPP;\n\t\treturn -1;\n\t}\n\tif (pwc != NULL)\n\t\t*pwc = *s;\n\treturn 1;\n}"
  },
  {
    "function_name": "pledge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "255-259",
    "snippet": "int\npledge(const char *promises, const char *paths[])\n{\n\treturn 0;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\npledge(const char *promises, const char *paths[])\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "getpgid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "239-251",
    "snippet": "pid_t\ngetpgid(pid_t pid)\n{\n#if defined(HAVE_GETPGRP) && !defined(GETPGRP_VOID) && GETPGRP_VOID == 0\n\treturn getpgrp(pid);\n#elif defined(HAVE_GETPGRP)\n\tif (pid == 0)\n\t\treturn getpgrp();\n#endif\n\n\terrno = ESRCH;\n\treturn -1;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "getpgrp",
          "args": [],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpgrp",
          "args": [
            "pid"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "tcgetpgrp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
          "lines": "182-191",
          "snippet": "pid_t\ntcgetpgrp(int fd)\n{\n\tint ctty_pgrp;\n\n\tif (ioctl(fd, TIOCGPGRP, &ctty_pgrp) == -1)\n\t\treturn(-1);\n\telse\n\t\treturn(ctty_pgrp);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "# include <sys/time.h>",
            "# include <sys/select.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\npid_t\ntcgetpgrp(int fd)\n{\n\tint ctty_pgrp;\n\n\tif (ioctl(fd, TIOCGPGRP, &ctty_pgrp) == -1)\n\t\treturn(-1);\n\telse\n\t\treturn(ctty_pgrp);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\npid_t\ngetpgid(pid_t pid)\n{\n#if defined(HAVE_GETPGRP) && !defined(GETPGRP_VOID) && GETPGRP_VOID == 0\n\treturn getpgrp(pid);\n#elif defined(HAVE_GETPGRP)\n\tif (pid == 0)\n\t\treturn getpgrp();\n#endif\n\n\terrno = ESRCH;\n\treturn -1;\n}"
  },
  {
    "function_name": "isblank",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "231-235",
    "snippet": "int\nisblank(int c)\n{\n\treturn (c == ' ' || c == '\\t');\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nisblank(int c)\n{\n\treturn (c == ' ' || c == '\\t');\n}"
  },
  {
    "function_name": "strdup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "216-227",
    "snippet": "char *\nstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = malloc(len);\n\tif (cp != NULL)\n\t\treturn(memcpy(cp, str, len));\n\treturn NULL;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "cp",
            "str",
            "len"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "len"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "rpl_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-malloc.c",
          "lines": "26-32",
          "snippet": "void *\nrpl_malloc(size_t size)\n{\n\tif (size == 0)\n\t\tsize = 1;\n\treturn malloc(size);\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nvoid *\nrpl_malloc(size_t size)\n{\n\tif (size == 0)\n\t\tsize = 1;\n\treturn malloc(size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *\nstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = malloc(len);\n\tif (cp != NULL)\n\t\treturn(memcpy(cp, str, len));\n\treturn NULL;\n}"
  },
  {
    "function_name": "tcsendbreak",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "195-212",
    "snippet": "int\ntcsendbreak(int fd, int duration)\n{\n# if defined(TIOCSBRK) && defined(TIOCCBRK)\n\tstruct timeval sleepytime;\n\n\tsleepytime.tv_sec = 0;\n\tsleepytime.tv_usec = 400000;\n\tif (ioctl(fd, TIOCSBRK, 0) == -1)\n\t\treturn (-1);\n\t(void)select(0, 0, 0, 0, &sleepytime);\n\tif (ioctl(fd, TIOCCBRK, 0) == -1)\n\t\treturn (-1);\n\treturn (0);\n# else\n\treturn -1;\n# endif\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "TIOCCBRK",
            "0"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "select",
          "args": [
            "0",
            "0",
            "0",
            "0",
            "&sleepytime"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "select",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/smult_curve25519_ref.c",
          "lines": "110-122",
          "snippet": "static void select(unsigned int p[64],unsigned int q[64],const unsigned int r[64],const unsigned int s[64],unsigned int b)\n{\n  unsigned int j;\n  unsigned int t;\n  unsigned int bminus1;\n\n  bminus1 = b - 1;\n  for (j = 0;j < 64;++j) {\n    t = bminus1 & (r[j] ^ s[j]);\n    p[j] = s[j] ^ t;\n    q[j] = r[j] ^ t;\n  }\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static void select(unsigned int p[64],unsigned int q[64],const unsigned int r[64],const unsigned int s[64],unsigned int b)\n{\n  unsigned int j;\n  unsigned int t;\n  unsigned int bminus1;\n\n  bminus1 = b - 1;\n  for (j = 0;j < 64;++j) {\n    t = bminus1 & (r[j] ^ s[j]);\n    p[j] = s[j] ^ t;\n    q[j] = r[j] ^ t;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "TIOCSBRK",
            "0"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\ntcsendbreak(int fd, int duration)\n{\n# if defined(TIOCSBRK) && defined(TIOCCBRK)\n\tstruct timeval sleepytime;\n\n\tsleepytime.tv_sec = 0;\n\tsleepytime.tv_usec = 400000;\n\tif (ioctl(fd, TIOCSBRK, 0) == -1)\n\t\treturn (-1);\n\t(void)select(0, 0, 0, 0, &sleepytime);\n\tif (ioctl(fd, TIOCCBRK, 0) == -1)\n\t\treturn (-1);\n\treturn (0);\n# else\n\treturn -1;\n# endif\n}"
  },
  {
    "function_name": "tcgetpgrp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "182-191",
    "snippet": "pid_t\ntcgetpgrp(int fd)\n{\n\tint ctty_pgrp;\n\n\tif (ioctl(fd, TIOCGPGRP, &ctty_pgrp) == -1)\n\t\treturn(-1);\n\telse\n\t\treturn(ctty_pgrp);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "TIOCGPGRP",
            "&ctty_pgrp"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\npid_t\ntcgetpgrp(int fd)\n{\n\tint ctty_pgrp;\n\n\tif (ioctl(fd, TIOCGPGRP, &ctty_pgrp) == -1)\n\t\treturn(-1);\n\telse\n\t\treturn(ctty_pgrp);\n}"
  },
  {
    "function_name": "usleep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "171-178",
    "snippet": "int usleep(unsigned int useconds)\n{\n\tstruct timespec ts;\n\n\tts.tv_sec = useconds / 1000000;\n\tts.tv_nsec = (useconds % 1000000) * 1000;\n\treturn nanosleep(&ts, NULL);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nanosleep",
          "args": [
            "&ts",
            "NULL"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "nanosleep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
          "lines": "140-167",
          "snippet": "int nanosleep(const struct timespec *req, struct timespec *rem)\n{\n\tint rc, saverrno;\n\textern int errno;\n\tstruct timeval tstart, tstop, tremain, time2wait;\n\n\tTIMESPEC_TO_TIMEVAL(&time2wait, req)\n\t(void) gettimeofday(&tstart, NULL);\n\trc = select(0, NULL, NULL, NULL, &time2wait);\n\tif (rc == -1) {\n\t\tsaverrno = errno;\n\t\t(void) gettimeofday (&tstop, NULL);\n\t\terrno = saverrno;\n\t\ttremain.tv_sec = time2wait.tv_sec -\n\t\t\t(tstop.tv_sec - tstart.tv_sec);\n\t\ttremain.tv_usec = time2wait.tv_usec -\n\t\t\t(tstop.tv_usec - tstart.tv_usec);\n\t\ttremain.tv_sec += tremain.tv_usec / 1000000L;\n\t\ttremain.tv_usec %= 1000000L;\n\t} else {\n\t\ttremain.tv_sec = 0;\n\t\ttremain.tv_usec = 0;\n\t}\n\tif (rem != NULL)\n\t\tTIMEVAL_TO_TIMESPEC(&tremain, rem)\n\n\treturn(rc);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "# include <sys/time.h>",
            "# include <sys/select.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint nanosleep(const struct timespec *req, struct timespec *rem)\n{\n\tint rc, saverrno;\n\textern int errno;\n\tstruct timeval tstart, tstop, tremain, time2wait;\n\n\tTIMESPEC_TO_TIMEVAL(&time2wait, req)\n\t(void) gettimeofday(&tstart, NULL);\n\trc = select(0, NULL, NULL, NULL, &time2wait);\n\tif (rc == -1) {\n\t\tsaverrno = errno;\n\t\t(void) gettimeofday (&tstop, NULL);\n\t\terrno = saverrno;\n\t\ttremain.tv_sec = time2wait.tv_sec -\n\t\t\t(tstop.tv_sec - tstart.tv_sec);\n\t\ttremain.tv_usec = time2wait.tv_usec -\n\t\t\t(tstop.tv_usec - tstart.tv_usec);\n\t\ttremain.tv_sec += tremain.tv_usec / 1000000L;\n\t\ttremain.tv_usec %= 1000000L;\n\t} else {\n\t\ttremain.tv_sec = 0;\n\t\ttremain.tv_usec = 0;\n\t}\n\tif (rem != NULL)\n\t\tTIMEVAL_TO_TIMESPEC(&tremain, rem)\n\n\treturn(rc);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint usleep(unsigned int useconds)\n{\n\tstruct timespec ts;\n\n\tts.tv_sec = useconds / 1000000;\n\tts.tv_nsec = (useconds % 1000000) * 1000;\n\treturn nanosleep(&ts, NULL);\n}"
  },
  {
    "function_name": "nanosleep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "140-167",
    "snippet": "int nanosleep(const struct timespec *req, struct timespec *rem)\n{\n\tint rc, saverrno;\n\textern int errno;\n\tstruct timeval tstart, tstop, tremain, time2wait;\n\n\tTIMESPEC_TO_TIMEVAL(&time2wait, req)\n\t(void) gettimeofday(&tstart, NULL);\n\trc = select(0, NULL, NULL, NULL, &time2wait);\n\tif (rc == -1) {\n\t\tsaverrno = errno;\n\t\t(void) gettimeofday (&tstop, NULL);\n\t\terrno = saverrno;\n\t\ttremain.tv_sec = time2wait.tv_sec -\n\t\t\t(tstop.tv_sec - tstart.tv_sec);\n\t\ttremain.tv_usec = time2wait.tv_usec -\n\t\t\t(tstop.tv_usec - tstart.tv_usec);\n\t\ttremain.tv_sec += tremain.tv_usec / 1000000L;\n\t\ttremain.tv_usec %= 1000000L;\n\t} else {\n\t\ttremain.tv_sec = 0;\n\t\ttremain.tv_usec = 0;\n\t}\n\tif (rem != NULL)\n\t\tTIMEVAL_TO_TIMESPEC(&tremain, rem)\n\n\treturn(rc);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TIMEVAL_TO_TIMESPEC",
          "args": [
            "&tremain",
            "rem"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gettimeofday",
          "args": [
            "&tstop",
            "NULL"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "select",
          "args": [
            "0",
            "NULL",
            "NULL",
            "NULL",
            "&time2wait"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "select",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/smult_curve25519_ref.c",
          "lines": "110-122",
          "snippet": "static void select(unsigned int p[64],unsigned int q[64],const unsigned int r[64],const unsigned int s[64],unsigned int b)\n{\n  unsigned int j;\n  unsigned int t;\n  unsigned int bminus1;\n\n  bminus1 = b - 1;\n  for (j = 0;j < 64;++j) {\n    t = bminus1 & (r[j] ^ s[j]);\n    p[j] = s[j] ^ t;\n    q[j] = r[j] ^ t;\n  }\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static void select(unsigned int p[64],unsigned int q[64],const unsigned int r[64],const unsigned int s[64],unsigned int b)\n{\n  unsigned int j;\n  unsigned int t;\n  unsigned int bminus1;\n\n  bminus1 = b - 1;\n  for (j = 0;j < 64;++j) {\n    t = bminus1 & (r[j] ^ s[j]);\n    p[j] = s[j] ^ t;\n    q[j] = r[j] ^ t;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "gettimeofday",
          "args": [
            "&tstart",
            "NULL"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TIMESPEC_TO_TIMEVAL",
          "args": [
            "void"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TIMESPEC_TO_TIMEVAL",
          "args": [
            "&time2wait",
            "req"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint nanosleep(const struct timespec *req, struct timespec *rem)\n{\n\tint rc, saverrno;\n\textern int errno;\n\tstruct timeval tstart, tstop, tremain, time2wait;\n\n\tTIMESPEC_TO_TIMEVAL(&time2wait, req)\n\t(void) gettimeofday(&tstart, NULL);\n\trc = select(0, NULL, NULL, NULL, &time2wait);\n\tif (rc == -1) {\n\t\tsaverrno = errno;\n\t\t(void) gettimeofday (&tstop, NULL);\n\t\terrno = saverrno;\n\t\ttremain.tv_sec = time2wait.tv_sec -\n\t\t\t(tstop.tv_sec - tstart.tv_sec);\n\t\ttremain.tv_usec = time2wait.tv_usec -\n\t\t\t(tstop.tv_usec - tstart.tv_usec);\n\t\ttremain.tv_sec += tremain.tv_usec / 1000000L;\n\t\ttremain.tv_usec %= 1000000L;\n\t} else {\n\t\ttremain.tv_sec = 0;\n\t\ttremain.tv_usec = 0;\n\t}\n\tif (rem != NULL)\n\t\tTIMEVAL_TO_TIMESPEC(&tremain, rem)\n\n\treturn(rc);\n}"
  },
  {
    "function_name": "truncate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "121-136",
    "snippet": "int truncate(const char *path, off_t length)\n{\n\tint fd, ret, saverrno;\n\n\tfd = open(path, O_WRONLY);\n\tif (fd < 0)\n\t\treturn (-1);\n\n\tret = ftruncate(fd, length);\n\tsaverrno = errno;\n\tclose(fd);\n\tif (ret == -1)\n\t\terrno = saverrno;\n\n\treturn(ret);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "fd"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "closefrom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-closefrom.c",
          "lines": "68-107",
          "snippet": "void\nclosefrom(int lowfd)\n{\n    long fd, maxfd;\n#if defined(HAVE_DIRFD) && defined(HAVE_PROC_PID)\n    char fdpath[PATH_MAX], *endp;\n    struct dirent *dent;\n    DIR *dirp;\n    int len;\n\n    /* Check for a /proc/$$/fd directory. */\n    len = snprintf(fdpath, sizeof(fdpath), \"/proc/%ld/fd\", (long)getpid());\n    if (len > 0 && (size_t)len < sizeof(fdpath) && (dirp = opendir(fdpath))) {\n\twhile ((dent = readdir(dirp)) != NULL) {\n\t    fd = strtol(dent->d_name, &endp, 10);\n\t    if (dent->d_name != endp && *endp == '\\0' &&\n\t\tfd >= 0 && fd < INT_MAX && fd >= lowfd && fd != dirfd(dirp))\n\t\t(void) close((int) fd);\n\t}\n\t(void) closedir(dirp);\n    } else\n#endif\n    {\n\t/*\n\t * Fall back on sysconf() or getdtablesize().  We avoid checking\n\t * resource limits since it is possible to open a file descriptor\n\t * and then drop the rlimit such that it is below the open fd.\n\t */\n#ifdef HAVE_SYSCONF\n\tmaxfd = sysconf(_SC_OPEN_MAX);\n#else\n\tmaxfd = getdtablesize();\n#endif /* HAVE_SYSCONF */\n\tif (maxfd < 0)\n\t    maxfd = OPEN_MAX;\n\n\tfor (fd = lowfd; fd < maxfd; fd++)\n\t    (void) close((int) fd);\n    }\n}",
          "includes": [
            "#  include <ndir.h>",
            "#  include <sys/dir.h>",
            "#  include <sys/ndir.h>",
            "# include <dirent.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <stdlib.h>",
            "#include <limits.h>",
            "# include <fcntl.h>",
            "#include <stdio.h>",
            "#include <unistd.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#  include <ndir.h>\n#  include <sys/dir.h>\n#  include <sys/ndir.h>\n# include <dirent.h>\n#include <unistd.h>\n#include <string.h>\n#include <stddef.h>\n#include <stdlib.h>\n#include <limits.h>\n# include <fcntl.h>\n#include <stdio.h>\n#include <unistd.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nclosefrom(int lowfd)\n{\n    long fd, maxfd;\n#if defined(HAVE_DIRFD) && defined(HAVE_PROC_PID)\n    char fdpath[PATH_MAX], *endp;\n    struct dirent *dent;\n    DIR *dirp;\n    int len;\n\n    /* Check for a /proc/$$/fd directory. */\n    len = snprintf(fdpath, sizeof(fdpath), \"/proc/%ld/fd\", (long)getpid());\n    if (len > 0 && (size_t)len < sizeof(fdpath) && (dirp = opendir(fdpath))) {\n\twhile ((dent = readdir(dirp)) != NULL) {\n\t    fd = strtol(dent->d_name, &endp, 10);\n\t    if (dent->d_name != endp && *endp == '\\0' &&\n\t\tfd >= 0 && fd < INT_MAX && fd >= lowfd && fd != dirfd(dirp))\n\t\t(void) close((int) fd);\n\t}\n\t(void) closedir(dirp);\n    } else\n#endif\n    {\n\t/*\n\t * Fall back on sysconf() or getdtablesize().  We avoid checking\n\t * resource limits since it is possible to open a file descriptor\n\t * and then drop the rlimit such that it is below the open fd.\n\t */\n#ifdef HAVE_SYSCONF\n\tmaxfd = sysconf(_SC_OPEN_MAX);\n#else\n\tmaxfd = getdtablesize();\n#endif /* HAVE_SYSCONF */\n\tif (maxfd < 0)\n\t    maxfd = OPEN_MAX;\n\n\tfor (fd = lowfd; fd < maxfd; fd++)\n\t    (void) close((int) fd);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ftruncate",
          "args": [
            "fd",
            "length"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "path",
            "O_WRONLY"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "binary_open",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-cygwin_util.c",
          "lines": "43-53",
          "snippet": "int\nbinary_open(const char *filename, int flags, ...)\n{\n\tva_list ap;\n\tmode_t mode;\n\n\tva_start(ap, flags);\n\tmode = va_arg(ap, mode_t);\n\tva_end(ap);\n\treturn (open(filename, flags | O_BINARY, mode));\n}",
          "includes": [
            "#include \"xmalloc.h\"",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xmalloc.h\"\n#include <stdarg.h>\n#include <unistd.h>\n#include <string.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nbinary_open(const char *filename, int flags, ...)\n{\n\tva_list ap;\n\tmode_t mode;\n\n\tva_start(ap, flags);\n\tmode = va_arg(ap, mode_t);\n\tva_end(ap);\n\treturn (open(filename, flags | O_BINARY, mode));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint truncate(const char *path, off_t length)\n{\n\tint fd, ret, saverrno;\n\n\tfd = open(path, O_WRONLY);\n\tif (fd < 0)\n\t\treturn (-1);\n\n\tret = ftruncate(fd, length);\n\tsaverrno = errno;\n\tclose(fd);\n\tif (ret == -1)\n\t\terrno = saverrno;\n\n\treturn(ret);\n}"
  },
  {
    "function_name": "utimes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "109-117",
    "snippet": "int utimes(char *filename, struct timeval *tvp)\n{\n\tstruct utimbuf ub;\n\n\tub.actime = tvp[0].tv_sec;\n\tub.modtime = tvp[1].tv_sec;\n\n\treturn (utime(filename, &ub));\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "utime",
          "args": [
            "filename",
            "&ub"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "utimes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
          "lines": "109-117",
          "snippet": "int utimes(char *filename, struct timeval *tvp)\n{\n\tstruct utimbuf ub;\n\n\tub.actime = tvp[0].tv_sec;\n\tub.modtime = tvp[1].tv_sec;\n\n\treturn (utime(filename, &ub));\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint utimes(char *filename, struct timeval *tvp)\n{\n\tstruct utimbuf ub;\n\n\tub.actime = tvp[0].tv_sec;\n\tub.modtime = tvp[1].tv_sec;\n\n\treturn (utime(filename, &ub));\n}"
  },
  {
    "function_name": "strerror",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "96-105",
    "snippet": "const char *strerror(int e)\n{\n\textern int sys_nerr;\n\textern char *sys_errlist[];\n\n\tif ((e >= 0) && (e < sys_nerr))\n\t\treturn (sys_errlist[e]);\n\n\treturn (\"unlisted error\");\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst char *strerror(int e)\n{\n\textern int sys_nerr;\n\textern char *sys_errlist[];\n\n\tif ((e >= 0) && (e < sys_nerr))\n\t\treturn (sys_errlist[e]);\n\n\treturn (\"unlisted error\");\n}"
  },
  {
    "function_name": "setegid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "89-92",
    "snippet": "int setegid(uid_t egid)\n{\n\treturn(setresgid(-1, egid, -1));\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setresgid",
          "args": [
            "-1",
            "egid",
            "-1"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "setresgid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-setres_id.c",
          "lines": "28-59",
          "snippet": "int\nsetresgid(gid_t rgid, gid_t egid, gid_t sgid)\n{\n\tint ret = 0, saved_errno;\n\n\tif (rgid != sgid) {\n\t\terrno = ENOSYS;\n\t\treturn -1;\n\t}\n#if defined(HAVE_SETREGID) && !defined(BROKEN_SETREGID)\n\tif (setregid(rgid, egid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setregid %u: %.100s\", rgid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n#else\n\tif (setegid(egid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setegid %u: %.100s\", (u_int)egid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n\tif (setgid(rgid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setgid %u: %.100s\", rgid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n#endif\n\treturn ret;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include <string.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsetresgid(gid_t rgid, gid_t egid, gid_t sgid)\n{\n\tint ret = 0, saved_errno;\n\n\tif (rgid != sgid) {\n\t\terrno = ENOSYS;\n\t\treturn -1;\n\t}\n#if defined(HAVE_SETREGID) && !defined(BROKEN_SETREGID)\n\tif (setregid(rgid, egid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setregid %u: %.100s\", rgid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n#else\n\tif (setegid(egid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setegid %u: %.100s\", (u_int)egid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n\tif (setgid(rgid) < 0) {\n\t\tsaved_errno = errno;\n\t\terror(\"setgid %u: %.100s\", rgid, strerror(errno));\n\t\terrno = saved_errno;\n\t\tret = -1;\n\t}\n#endif\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint setegid(uid_t egid)\n{\n\treturn(setresgid(-1, egid, -1));\n}"
  },
  {
    "function_name": "seteuid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "82-85",
    "snippet": "int seteuid(uid_t euid)\n{\n\treturn (setreuid(-1, euid));\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setreuid",
          "args": [
            "-1",
            "euid"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint seteuid(uid_t euid)\n{\n\treturn (setreuid(-1, euid));\n}"
  },
  {
    "function_name": "innetgr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "74-78",
    "snippet": "int innetgr(const char *netgroup, const char *host,\n\t    const char *user, const char *domain)\n{\n\treturn (0);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint innetgr(const char *netgroup, const char *host,\n\t    const char *user, const char *domain)\n{\n\treturn (0);\n}"
  },
  {
    "function_name": "setlogin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "67-70",
    "snippet": "int setlogin(const char *name)\n{\n\treturn (0);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint setlogin(const char *name)\n{\n\treturn (0);\n}"
  },
  {
    "function_name": "ssh_get_progname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
    "lines": "43-64",
    "snippet": "char *ssh_get_progname(char *argv0)\n{\n\tchar *p, *q;\n#ifdef HAVE___PROGNAME\n\textern char *__progname;\n\n\tp = __progname;\n#else\n\tif (argv0 == NULL)\n\t\treturn (\"unknown\");\t/* XXX */\n\tp = strrchr(argv0, '/');\n\tif (p == NULL)\n\t\tp = argv0;\n\telse\n\t\tp++;\n#endif\n\tif ((q = strdup(p)) == NULL) {\n\t\tperror(\"strdup\");\n\t\texit(1);\n\t}\n\treturn q;\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <signal.h>",
      "#include <string.h>",
      "# include <sys/time.h>",
      "# include <sys/select.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "sftp_server_cleanup_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-server.c",
          "lines": "1474-1483",
          "snippet": "void\nsftp_server_cleanup_exit(int i)\n{\n\tif (pw != NULL && client_addr != NULL) {\n\t\thandle_log_exit();\n\t\tlogit(\"session closed for local user %s from [%s]\",\n\t\t    pw->pw_name, client_addr);\n\t}\n\t_exit(i);\n}",
          "includes": [
            "#include \"sftp-common.h\"",
            "#include \"sftp.h\"",
            "#include \"uidswap.h\"",
            "#include \"match.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"xmalloc.h\"",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <pwd.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <sys/statvfs.h>",
            "#include <sys/mount.h>",
            "# include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static struct passwd *pw = NULL;",
            "static char *client_addr = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"uidswap.h\"\n#include \"match.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"xmalloc.h\"\n#include <stdarg.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <pwd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <sys/statvfs.h>\n#include <sys/mount.h>\n# include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic struct passwd *pw = NULL;\nstatic char *client_addr = NULL;\n\nvoid\nsftp_server_cleanup_exit(int i)\n{\n\tif (pw != NULL && client_addr != NULL) {\n\t\thandle_log_exit();\n\t\tlogit(\"session closed for local user %s from [%s]\",\n\t\t    pw->pw_name, client_addr);\n\t}\n\t_exit(i);\n}"
        }
      },
      {
        "call_info": {
          "callee": "perror",
          "args": [
            "\"strdup\""
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "p"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "strdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
          "lines": "216-227",
          "snippet": "char *\nstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = malloc(len);\n\tif (cp != NULL)\n\t\treturn(memcpy(cp, str, len));\n\treturn NULL;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "# include <sys/time.h>",
            "# include <sys/select.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *\nstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = malloc(len);\n\tif (cp != NULL)\n\t\treturn(memcpy(cp, str, len));\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "argv0",
            "'/'"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *ssh_get_progname(char *argv0)\n{\n\tchar *p, *q;\n#ifdef HAVE___PROGNAME\n\textern char *__progname;\n\n\tp = __progname;\n#else\n\tif (argv0 == NULL)\n\t\treturn (\"unknown\");\t/* XXX */\n\tp = strrchr(argv0, '/');\n\tif (p == NULL)\n\t\tp = argv0;\n\telse\n\t\tp++;\n#endif\n\tif ((q = strdup(p)) == NULL) {\n\t\tperror(\"strdup\");\n\t\texit(1);\n\t}\n\treturn q;\n}"
  }
]