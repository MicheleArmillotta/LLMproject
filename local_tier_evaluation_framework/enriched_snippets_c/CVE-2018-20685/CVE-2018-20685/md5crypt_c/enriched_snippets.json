[
  {
    "function_name": "md5_crypt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/md5crypt.c",
    "lines": "50-163",
    "snippet": "char *\nmd5_crypt(const char *pw, const char *salt)\n{\n\tstatic char passwd[120], salt_copy[9];\n\tstatic const char *sp, *ep;\n\tunsigned char final[16];\n\tint sl, pl, i, j;\n\tMD5_CTX\tctx, ctx1;\n\tunsigned long l;\n\n\t/* Refine the Salt first */\n\tsp = salt;\n\n\t/* If it starts with the magic string, then skip that */\n\tif(strncmp(sp, magic, strlen(magic)) == 0)\n\t\tsp += strlen(magic);\n\n\t/* It stops at the first '$', max 8 chars */\n\tfor (ep = sp; *ep != '$'; ep++) {\n\t\tif (*ep == '\\0' || ep >= (sp + 8))\n\t\t\treturn (NULL);\n\t}\n\n\t/* get the length of the true salt */\n\tsl = ep - sp;\n\n\t/* Stash the salt */\n\tmemcpy(salt_copy, sp, sl);\n\tsalt_copy[sl] = '\\0';\n\n\tMD5_Init(&ctx);\n\n\t/* The password first, since that is what is most unknown */\n\tMD5_Update(&ctx, pw, strlen(pw));\n\n\t/* Then our magic string */\n\tMD5_Update(&ctx, magic, strlen(magic));\n\n\t/* Then the raw salt */\n\tMD5_Update(&ctx, sp, sl);\n\n\t/* Then just as many characters of the MD5(pw, salt, pw) */\n\tMD5_Init(&ctx1);\n\tMD5_Update(&ctx1, pw, strlen(pw));\n\tMD5_Update(&ctx1, sp, sl);\n\tMD5_Update(&ctx1, pw, strlen(pw));\n\tMD5_Final(final, &ctx1);\n\n\tfor(pl = strlen(pw); pl > 0; pl -= 16)\n\t\tMD5_Update(&ctx, final, pl > 16 ? 16 : pl);\n\n\t/* Don't leave anything around in vm they could use. */\n\tmemset(final, '\\0', sizeof final);\n\n\t/* Then something really weird... */\n\tfor (j = 0, i = strlen(pw); i != 0; i >>= 1)\n\t\tif (i & 1)\n\t\t\tMD5_Update(&ctx, final + j, 1);\n\t\telse\n\t\t\tMD5_Update(&ctx, pw + j, 1);\n\n\t/* Now make the output string */\n\tsnprintf(passwd, sizeof(passwd), \"%s%s$\", magic, salt_copy);\n\n\tMD5_Final(final, &ctx);\n\n\t/*\n\t * and now, just to make sure things don't run too fast\n\t * On a 60 Mhz Pentium this takes 34 msec, so you would\n\t * need 30 seconds to build a 1000 entry dictionary...\n\t */\n\tfor(i = 0; i < 1000; i++) {\n\t\tMD5_Init(&ctx1);\n\t\tif (i & 1)\n\t\t\tMD5_Update(&ctx1, pw, strlen(pw));\n\t\telse\n\t\t\tMD5_Update(&ctx1, final, 16);\n\n\t\tif (i % 3)\n\t\t\tMD5_Update(&ctx1, sp, sl);\n\n\t\tif (i % 7)\n\t\t\tMD5_Update(&ctx1, pw, strlen(pw));\n\n\t\tif (i & 1)\n\t\t\tMD5_Update(&ctx1, final, 16);\n\t\telse\n\t\t\tMD5_Update(&ctx1, pw, strlen(pw));\n\n\t\tMD5_Final(final, &ctx1);\n\t}\n\n\tl = (final[ 0]<<16) | (final[ 6]<<8) | final[12];\n\tstrlcat(passwd, to64(l, 4), sizeof(passwd));\n\tl = (final[ 1]<<16) | (final[ 7]<<8) | final[13];\n\tstrlcat(passwd, to64(l, 4), sizeof(passwd));\n\tl = (final[ 2]<<16) | (final[ 8]<<8) | final[14];\n\tstrlcat(passwd, to64(l, 4), sizeof(passwd));\n\tl = (final[ 3]<<16) | (final[ 9]<<8) | final[15];\n\tstrlcat(passwd, to64(l, 4), sizeof(passwd));\n\tl = (final[ 4]<<16) | (final[10]<<8) | final[ 5];\n\tstrlcat(passwd, to64(l, 4), sizeof(passwd));\n\tl =                    final[11]                ;\n\tstrlcat(passwd, to64(l, 2), sizeof(passwd));\n\n\t/* Don't leave anything around in vm they could use. */\n\tmemset(final, 0, sizeof(final));\n\tmemset(salt_copy, 0, sizeof(salt_copy));\n\tmemset(&ctx, 0, sizeof(ctx));\n\tmemset(&ctx1, 0, sizeof(ctx1));\n\t(void)to64(0, 4);\n\n\treturn (passwd);\n}",
    "includes": [
      "#include <openssl/md5.h>",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "to64",
          "args": [
            "0",
            "4"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "to64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/md5crypt.c",
          "lines": "26-42",
          "snippet": "static char *\nto64(unsigned long v, int n)\n{\n\tstatic char buf[5];\n\tchar *s = buf;\n\n\tif (n > 4)\n\t\treturn (NULL);\n\n\tmemset(buf, '\\0', sizeof(buf));\n\twhile (--n >= 0) {\n\t\t*s++ = itoa64[v&0x3f];\n\t\tv >>= 6;\n\t}\n\n\treturn (buf);\n}",
          "includes": [
            "#include <openssl/md5.h>",
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/md5.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *\nto64(unsigned long v, int n)\n{\n\tstatic char buf[5];\n\tchar *s = buf;\n\n\tif (n > 4)\n\t\treturn (NULL);\n\n\tmemset(buf, '\\0', sizeof(buf));\n\twhile (--n >= 0) {\n\t\t*s++ = itoa64[v&0x3f];\n\t\tv >>= 6;\n\t}\n\n\treturn (buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&ctx1",
            "0",
            "sizeof(ctx1)"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&ctx",
            "0",
            "sizeof(ctx)"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "salt_copy",
            "0",
            "sizeof(salt_copy)"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "final",
            "0",
            "sizeof(final)"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlcat",
          "args": [
            "passwd",
            "to64(l, 2)",
            "sizeof(passwd)"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "strlcat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strlcat.c",
          "lines": "34-60",
          "snippet": "size_t\nstrlcat(char *dst, const char *src, size_t siz)\n{\n\tchar *d = dst;\n\tconst char *s = src;\n\tsize_t n = siz;\n\tsize_t dlen;\n\n\t/* Find the end of dst and adjust bytes left but don't go past end */\n\twhile (n-- != 0 && *d != '\\0')\n\t\td++;\n\tdlen = d - dst;\n\tn = siz - dlen;\n\n\tif (n == 0)\n\t\treturn(dlen + strlen(s));\n\twhile (*s != '\\0') {\n\t\tif (n != 1) {\n\t\t\t*d++ = *s;\n\t\t\tn--;\n\t\t}\n\t\ts++;\n\t}\n\t*d = '\\0';\n\n\treturn(dlen + (s - src));\t/* count does not include NUL */\n}",
          "includes": [
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nstrlcat(char *dst, const char *src, size_t siz)\n{\n\tchar *d = dst;\n\tconst char *s = src;\n\tsize_t n = siz;\n\tsize_t dlen;\n\n\t/* Find the end of dst and adjust bytes left but don't go past end */\n\twhile (n-- != 0 && *d != '\\0')\n\t\td++;\n\tdlen = d - dst;\n\tn = siz - dlen;\n\n\tif (n == 0)\n\t\treturn(dlen + strlen(s));\n\twhile (*s != '\\0') {\n\t\tif (n != 1) {\n\t\t\t*d++ = *s;\n\t\t\tn--;\n\t\t}\n\t\ts++;\n\t}\n\t*d = '\\0';\n\n\treturn(dlen + (s - src));\t/* count does not include NUL */\n}"
        }
      },
      {
        "call_info": {
          "callee": "MD5_Final",
          "args": [
            "final",
            "&ctx1"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Update",
          "args": [
            "&ctx1",
            "pw",
            "strlen(pw)"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "pw"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Update",
          "args": [
            "&ctx1",
            "final",
            "16"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Update",
          "args": [
            "&ctx1",
            "pw",
            "strlen(pw)"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "pw"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Update",
          "args": [
            "&ctx1",
            "sp",
            "sl"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Update",
          "args": [
            "&ctx1",
            "final",
            "16"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Update",
          "args": [
            "&ctx1",
            "pw",
            "strlen(pw)"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "pw"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Init",
          "args": [
            "&ctx1"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Final",
          "args": [
            "final",
            "&ctx"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "passwd",
            "sizeof(passwd)",
            "\"%s%s$\"",
            "magic",
            "salt_copy"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "snprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-snprintf.c",
          "lines": "869-879",
          "snippet": "int\nsnprintf(char *str, size_t count, SNPRINTF_CONST char *fmt, ...)\n{\n\tsize_t ret;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tret = vsnprintf(str, count, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include <errno.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <ctype.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <ctype.h>\n#include \"includes.h\"\n\nint\nsnprintf(char *str, size_t count, SNPRINTF_CONST char *fmt, ...)\n{\n\tsize_t ret;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tret = vsnprintf(str, count, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MD5_Update",
          "args": [
            "&ctx",
            "pw + j",
            "1"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Update",
          "args": [
            "&ctx",
            "final + j",
            "1"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "pw"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "final",
            "'\\0'",
            "sizeof final"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Update",
          "args": [
            "&ctx",
            "final",
            "pl > 16 ? 16 : pl"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "pw"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Final",
          "args": [
            "final",
            "&ctx1"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Update",
          "args": [
            "&ctx1",
            "pw",
            "strlen(pw)"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "pw"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Update",
          "args": [
            "&ctx1",
            "sp",
            "sl"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Update",
          "args": [
            "&ctx1",
            "pw",
            "strlen(pw)"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "pw"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Init",
          "args": [
            "&ctx1"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Update",
          "args": [
            "&ctx",
            "sp",
            "sl"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Update",
          "args": [
            "&ctx",
            "magic",
            "strlen(magic)"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "magic"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Update",
          "args": [
            "&ctx",
            "pw",
            "strlen(pw)"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "pw"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MD5_Init",
          "args": [
            "&ctx"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "salt_copy",
            "sp",
            "sl"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "magic"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "sp",
            "magic",
            "strlen(magic)"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "g_strncmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/glob.c",
          "lines": "422-435",
          "snippet": "static int\ng_strncmp(const Char *s1, const char *s2, size_t n)\n{\n\tint rv = 0;\n\n\twhile (n--) {\n\t\trv = *(Char *)s1 - *(const unsigned char *)s2++;\n\t\tif (rv)\n\t\t\tbreak;\n\t\tif (*s1++ == '\\0')\n\t\t\tbreak;\n\t}\n\treturn rv;\n}",
          "includes": [
            "#include \"charclass.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pwd.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <dirent.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"glob.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"charclass.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pwd.h>\n#include <limits.h>\n#include <errno.h>\n#include <ctype.h>\n#include <dirent.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"glob.h\"\n#include \"includes.h\"\n\nstatic int\ng_strncmp(const Char *s1, const char *s2, size_t n)\n{\n\tint rv = 0;\n\n\twhile (n--) {\n\t\trv = *(Char *)s1 - *(const unsigned char *)s2++;\n\t\tif (rv)\n\t\t\tbreak;\n\t\tif (*s1++ == '\\0')\n\t\t\tbreak;\n\t}\n\treturn rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "magic"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/md5.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *\nmd5_crypt(const char *pw, const char *salt)\n{\n\tstatic char passwd[120], salt_copy[9];\n\tstatic const char *sp, *ep;\n\tunsigned char final[16];\n\tint sl, pl, i, j;\n\tMD5_CTX\tctx, ctx1;\n\tunsigned long l;\n\n\t/* Refine the Salt first */\n\tsp = salt;\n\n\t/* If it starts with the magic string, then skip that */\n\tif(strncmp(sp, magic, strlen(magic)) == 0)\n\t\tsp += strlen(magic);\n\n\t/* It stops at the first '$', max 8 chars */\n\tfor (ep = sp; *ep != '$'; ep++) {\n\t\tif (*ep == '\\0' || ep >= (sp + 8))\n\t\t\treturn (NULL);\n\t}\n\n\t/* get the length of the true salt */\n\tsl = ep - sp;\n\n\t/* Stash the salt */\n\tmemcpy(salt_copy, sp, sl);\n\tsalt_copy[sl] = '\\0';\n\n\tMD5_Init(&ctx);\n\n\t/* The password first, since that is what is most unknown */\n\tMD5_Update(&ctx, pw, strlen(pw));\n\n\t/* Then our magic string */\n\tMD5_Update(&ctx, magic, strlen(magic));\n\n\t/* Then the raw salt */\n\tMD5_Update(&ctx, sp, sl);\n\n\t/* Then just as many characters of the MD5(pw, salt, pw) */\n\tMD5_Init(&ctx1);\n\tMD5_Update(&ctx1, pw, strlen(pw));\n\tMD5_Update(&ctx1, sp, sl);\n\tMD5_Update(&ctx1, pw, strlen(pw));\n\tMD5_Final(final, &ctx1);\n\n\tfor(pl = strlen(pw); pl > 0; pl -= 16)\n\t\tMD5_Update(&ctx, final, pl > 16 ? 16 : pl);\n\n\t/* Don't leave anything around in vm they could use. */\n\tmemset(final, '\\0', sizeof final);\n\n\t/* Then something really weird... */\n\tfor (j = 0, i = strlen(pw); i != 0; i >>= 1)\n\t\tif (i & 1)\n\t\t\tMD5_Update(&ctx, final + j, 1);\n\t\telse\n\t\t\tMD5_Update(&ctx, pw + j, 1);\n\n\t/* Now make the output string */\n\tsnprintf(passwd, sizeof(passwd), \"%s%s$\", magic, salt_copy);\n\n\tMD5_Final(final, &ctx);\n\n\t/*\n\t * and now, just to make sure things don't run too fast\n\t * On a 60 Mhz Pentium this takes 34 msec, so you would\n\t * need 30 seconds to build a 1000 entry dictionary...\n\t */\n\tfor(i = 0; i < 1000; i++) {\n\t\tMD5_Init(&ctx1);\n\t\tif (i & 1)\n\t\t\tMD5_Update(&ctx1, pw, strlen(pw));\n\t\telse\n\t\t\tMD5_Update(&ctx1, final, 16);\n\n\t\tif (i % 3)\n\t\t\tMD5_Update(&ctx1, sp, sl);\n\n\t\tif (i % 7)\n\t\t\tMD5_Update(&ctx1, pw, strlen(pw));\n\n\t\tif (i & 1)\n\t\t\tMD5_Update(&ctx1, final, 16);\n\t\telse\n\t\t\tMD5_Update(&ctx1, pw, strlen(pw));\n\n\t\tMD5_Final(final, &ctx1);\n\t}\n\n\tl = (final[ 0]<<16) | (final[ 6]<<8) | final[12];\n\tstrlcat(passwd, to64(l, 4), sizeof(passwd));\n\tl = (final[ 1]<<16) | (final[ 7]<<8) | final[13];\n\tstrlcat(passwd, to64(l, 4), sizeof(passwd));\n\tl = (final[ 2]<<16) | (final[ 8]<<8) | final[14];\n\tstrlcat(passwd, to64(l, 4), sizeof(passwd));\n\tl = (final[ 3]<<16) | (final[ 9]<<8) | final[15];\n\tstrlcat(passwd, to64(l, 4), sizeof(passwd));\n\tl = (final[ 4]<<16) | (final[10]<<8) | final[ 5];\n\tstrlcat(passwd, to64(l, 4), sizeof(passwd));\n\tl =                    final[11]                ;\n\tstrlcat(passwd, to64(l, 2), sizeof(passwd));\n\n\t/* Don't leave anything around in vm they could use. */\n\tmemset(final, 0, sizeof(final));\n\tmemset(salt_copy, 0, sizeof(salt_copy));\n\tmemset(&ctx, 0, sizeof(ctx));\n\tmemset(&ctx1, 0, sizeof(ctx1));\n\t(void)to64(0, 4);\n\n\treturn (passwd);\n}"
  },
  {
    "function_name": "is_md5_salt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/md5crypt.c",
    "lines": "44-48",
    "snippet": "int\nis_md5_salt(const char *salt)\n{\n\treturn (strncmp(salt, magic, strlen(magic)) == 0);\n}",
    "includes": [
      "#include <openssl/md5.h>",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "salt",
            "magic",
            "strlen(magic)"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "g_strncmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/glob.c",
          "lines": "422-435",
          "snippet": "static int\ng_strncmp(const Char *s1, const char *s2, size_t n)\n{\n\tint rv = 0;\n\n\twhile (n--) {\n\t\trv = *(Char *)s1 - *(const unsigned char *)s2++;\n\t\tif (rv)\n\t\t\tbreak;\n\t\tif (*s1++ == '\\0')\n\t\t\tbreak;\n\t}\n\treturn rv;\n}",
          "includes": [
            "#include \"charclass.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pwd.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <dirent.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"glob.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"charclass.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pwd.h>\n#include <limits.h>\n#include <errno.h>\n#include <ctype.h>\n#include <dirent.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"glob.h\"\n#include \"includes.h\"\n\nstatic int\ng_strncmp(const Char *s1, const char *s2, size_t n)\n{\n\tint rv = 0;\n\n\twhile (n--) {\n\t\trv = *(Char *)s1 - *(const unsigned char *)s2++;\n\t\tif (rv)\n\t\t\tbreak;\n\t\tif (*s1++ == '\\0')\n\t\t\tbreak;\n\t}\n\treturn rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "magic"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/md5.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nis_md5_salt(const char *salt)\n{\n\treturn (strncmp(salt, magic, strlen(magic)) == 0);\n}"
  },
  {
    "function_name": "to64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/md5crypt.c",
    "lines": "26-42",
    "snippet": "static char *\nto64(unsigned long v, int n)\n{\n\tstatic char buf[5];\n\tchar *s = buf;\n\n\tif (n > 4)\n\t\treturn (NULL);\n\n\tmemset(buf, '\\0', sizeof(buf));\n\twhile (--n >= 0) {\n\t\t*s++ = itoa64[v&0x3f];\n\t\tv >>= 6;\n\t}\n\n\treturn (buf);\n}",
    "includes": [
      "#include <openssl/md5.h>",
      "#include <string.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "buf",
            "'\\0'",
            "sizeof(buf)"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/md5.h>\n#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *\nto64(unsigned long v, int n)\n{\n\tstatic char buf[5];\n\tchar *s = buf;\n\n\tif (n > 4)\n\t\treturn (NULL);\n\n\tmemset(buf, '\\0', sizeof(buf));\n\twhile (--n >= 0) {\n\t\t*s++ = itoa64[v&0x3f];\n\t\tv >>= 6;\n\t}\n\n\treturn (buf);\n}"
  }
]