[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/logintest.c",
    "lines": "283-307",
    "snippet": "int\nmain(int argc, char *argv[])\n{\n\tprintf(\"Platform-independent login recording test driver\\n\");\n\n\t__progname = ssh_get_progname(argv[0]);\n\tif (argc == 2) {\n\t\tif (strncmp(argv[1], \"-i\", 3) == 0)\n\t\t\tcompile_opts_only = 1;\n\t\telse if (strncmp(argv[1], \"-v\", 3) == 0)\n\t\t\tbe_verbose=1;\n\t}\n\n\tif (!compile_opts_only) {\n\t\tif (be_verbose && !testOutput())\n\t\t\treturn 1;\n\n\t\tif (!testAPI())\n\t\t\treturn 1;\n\t}\n\n\tshowOptions();\n\n\treturn 0;\n}",
    "includes": [
      "#include \"loginrec.h\"",
      "#include <time.h>",
      "#include <netdb.h>",
      "#include <pwd.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include <sys/wait.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "extern char *__progname;",
      "int compile_opts_only = 0;",
      "int be_verbose = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "showOptions",
          "args": [],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "showOptions",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/logintest.c",
          "lines": "254-280",
          "snippet": "void\nshowOptions(void)\n{\n\tprintf(\"**\\n** Compile-time options\\n**\\n\");\n\n\tprintf(\"login recording methods selected:\\n\");\n#ifdef USE_LOGIN\n\tprintf(\"\\tUSE_LOGIN\\n\");\n#endif\n#ifdef USE_UTMP\n\tprintf(\"\\tUSE_UTMP (UTMP_FILE=%s)\\n\", UTMP_FILE);\n#endif\n#ifdef USE_UTMPX\n\tprintf(\"\\tUSE_UTMPX\\n\");\n#endif\n#ifdef USE_WTMP\n\tprintf(\"\\tUSE_WTMP (WTMP_FILE=%s)\\n\", WTMP_FILE);\n#endif\n#ifdef USE_WTMPX\n\tprintf(\"\\tUSE_WTMPX (WTMPX_FILE=%s)\\n\", WTMPX_FILE);\n#endif\n#ifdef USE_LASTLOG\n\tprintf(\"\\tUSE_LASTLOG (LASTLOG_FILE=%s)\\n\", LASTLOG_FILE);\n#endif\n\tprintf(\"\\n\");\n\n}",
          "includes": [
            "#include \"loginrec.h\"",
            "#include <time.h>",
            "#include <netdb.h>",
            "#include <pwd.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include <sys/wait.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"loginrec.h\"\n#include <time.h>\n#include <netdb.h>\n#include <pwd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <sys/wait.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nshowOptions(void)\n{\n\tprintf(\"**\\n** Compile-time options\\n**\\n\");\n\n\tprintf(\"login recording methods selected:\\n\");\n#ifdef USE_LOGIN\n\tprintf(\"\\tUSE_LOGIN\\n\");\n#endif\n#ifdef USE_UTMP\n\tprintf(\"\\tUSE_UTMP (UTMP_FILE=%s)\\n\", UTMP_FILE);\n#endif\n#ifdef USE_UTMPX\n\tprintf(\"\\tUSE_UTMPX\\n\");\n#endif\n#ifdef USE_WTMP\n\tprintf(\"\\tUSE_WTMP (WTMP_FILE=%s)\\n\", WTMP_FILE);\n#endif\n#ifdef USE_WTMPX\n\tprintf(\"\\tUSE_WTMPX (WTMPX_FILE=%s)\\n\", WTMPX_FILE);\n#endif\n#ifdef USE_LASTLOG\n\tprintf(\"\\tUSE_LASTLOG (LASTLOG_FILE=%s)\\n\", LASTLOG_FILE);\n#endif\n\tprintf(\"\\n\");\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "testAPI",
          "args": [],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "testAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/logintest.c",
          "lines": "83-217",
          "snippet": "int\ntestAPI()\n{\n\tstruct logininfo *li1;\n\tstruct passwd *pw;\n\tstruct hostent *he;\n\tstruct sockaddr_in sa_in4;\n\tchar cmdstring[256], stripline[8];\n\tchar username[32];\n#ifdef HAVE_TIME_H\n\ttime_t t0, t1, t2, logintime, logouttime;\n\tchar s_t0[64],s_t1[64],s_t2[64];\n\tchar s_logintime[64], s_logouttime[64]; /* ctime() strings */\n#endif\n\n\tprintf(\"**\\n** Testing the API...\\n**\\n\");\n\n\tpw = getpwuid(getuid());\n\tstrlcpy(username, pw->pw_name, sizeof(username));\n\n\t/* gethostname(hostname, sizeof(hostname)); */\n\n\tprintf(\"login_alloc_entry test (no host info):\\n\");\n\n\t/* FIXME fake tty more effectively - this could upset some platforms */\n\tli1 = login_alloc_entry((int)getpid(), username, NULL, ttyname(0));\n\tstrlcpy(li1->progname, \"OpenSSH-logintest\", sizeof(li1->progname));\n\n\tif (be_verbose)\n\t\tdump_logininfo(li1, \"li1\");\n\n\tprintf(\"Setting host address info for 'localhost' (may call out):\\n\");\n\tif (! (he = gethostbyname(\"localhost\"))) {\n\t\tprintf(\"Couldn't set hostname(lookup failed)\\n\");\n\t} else {\n\t\t/* NOTE: this is messy, but typically a program wouldn't have to set\n\t\t *  any of this, a sockaddr_in* would be already prepared */\n\t\tmemcpy((void *)&(sa_in4.sin_addr), (void *)&(he->h_addr_list[0][0]),\n\t\t       sizeof(struct in_addr));\n\t\tlogin_set_addr(li1, (struct sockaddr *) &sa_in4, sizeof(sa_in4));\n\t\tstrlcpy(li1->hostname, \"localhost\", sizeof(li1->hostname));\n\t}\n\tif (be_verbose)\n\t\tdump_logininfo(li1, \"li1\");\n\n\tif ((int)geteuid() != 0) {\n\t\tprintf(\"NOT RUNNING LOGIN TESTS - you are not root!\\n\");\n\t\treturn 1;\n\t}\n\n\tif (nologtest)\n\t\treturn 1;\n\n\tline_stripname(stripline, li1->line, sizeof(stripline));\n\n\tprintf(\"Performing an invalid login attempt (no type field)\\n--\\n\");\n\tlogin_write(li1);\n\tprintf(\"--\\n(Should have written errors to stderr)\\n\");\n\n#ifdef HAVE_TIME_H\n\t(void)time(&t0);\n\tstrlcpy(s_t0, ctime(&t0), sizeof(s_t0));\n\tt1 = login_get_lastlog_time(getuid());\n\tstrlcpy(s_t1, ctime(&t1), sizeof(s_t1));\n\tprintf(\"Before logging in:\\n\\tcurrent time is %d - %s\\t\"\n\t       \"lastlog time is %d - %s\\n\",\n\t       (int)t0, s_t0, (int)t1, s_t1);\n#endif\n\n\tprintf(\"Performing a login on line %s \", stripline);\n#ifdef HAVE_TIME_H\n\t(void)time(&logintime);\n\tstrlcpy(s_logintime, ctime(&logintime), sizeof(s_logintime));\n\tprintf(\"at %d - %s\", (int)logintime, s_logintime);\n#endif\n\tprintf(\"--\\n\");\n\tlogin_login(li1);\n\n\tsnprintf(cmdstring, sizeof(cmdstring), \"who | grep '%s '\",\n\t\t stripline);\n\tsystem(cmdstring);\n\n\tprintf(\"--\\nPausing for %d second(s)...\\n\", PAUSE_BEFORE_LOGOUT);\n\tsleep(PAUSE_BEFORE_LOGOUT);\n\n\tprintf(\"Performing a logout \");\n#ifdef HAVE_TIME_H\n\t(void)time(&logouttime);\n\tstrlcpy(s_logouttime, ctime(&logouttime), sizeof(s_logouttime));\n\tprintf(\"at %d - %s\", (int)logouttime, s_logouttime);\n#endif\n\tprintf(\"\\nThe root login shown above should be gone.\\n\"\n\t       \"If the root login hasn't gone, but another user on the same\\n\"\n\t       \"pty has, this is OK - we're hacking it here, and there\\n\"\n\t       \"shouldn't be two users on one pty in reality...\\n\"\n\t       \"-- ('who' output follows)\\n\");\n\tlogin_logout(li1);\n\n\tsystem(cmdstring);\n\tprintf(\"-- ('who' output ends)\\n\");\n\n#ifdef HAVE_TIME_H\n\tt2 = login_get_lastlog_time(getuid());\n\tstrlcpy(s_t2, ctime(&t2), sizeof(s_t2));\n\tprintf(\"After logging in, lastlog time is %d - %s\\n\", (int)t2, s_t2);\n\tif (t1 == t2)\n\t\tprintf(\"The lastlog times before and after logging in are the \"\n\t\t       \"same.\\nThis indicates that lastlog is ** NOT WORKING \"\n\t\t       \"CORRECTLY **\\n\");\n\telse if (t0 != t2)\n\t\t/* We can be off by a second or so, even when recording works fine.\n\t\t * I'm not 100% sure why, but it's true. */\n\t\tprintf(\"** The login time and the lastlog time differ.\\n\"\n\t\t       \"** This indicates that lastlog is either recording the \"\n\t\t       \"wrong time,\\n** or retrieving the wrong entry.\\n\"\n\t\t       \"If it's off by less than %d second(s) \"\n\t\t       \"run the test again.\\n\", PAUSE_BEFORE_LOGOUT);\n\telse\n\t\tprintf(\"lastlog agrees with the login time. This is a good thing.\\n\");\n\n#endif\n\n\tprintf(\"--\\nThe output of 'last' shown next should have \"\n\t       \"an entry for root \\n  on %s for the time shown above:\\n--\\n\",\n\t       stripline);\n\tsnprintf(cmdstring, sizeof(cmdstring), \"last | grep '%s ' | head -3\",\n\t\t stripline);\n\tsystem(cmdstring);\n\n\tprintf(\"--\\nEnd of login test.\\n\");\n\n\tlogin_free_entry(li1);\n\n\treturn 1;\n}",
          "includes": [
            "#include \"loginrec.h\"",
            "#include <time.h>",
            "#include <netdb.h>",
            "#include <pwd.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include <sys/wait.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define PAUSE_BEFORE_LOGOUT 3"
          ],
          "globals_used": [
            "int nologtest = 0;",
            "int be_verbose = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"loginrec.h\"\n#include <time.h>\n#include <netdb.h>\n#include <pwd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <sys/wait.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define PAUSE_BEFORE_LOGOUT 3\n\nint nologtest = 0;\nint be_verbose = 0;\n\nint\ntestAPI()\n{\n\tstruct logininfo *li1;\n\tstruct passwd *pw;\n\tstruct hostent *he;\n\tstruct sockaddr_in sa_in4;\n\tchar cmdstring[256], stripline[8];\n\tchar username[32];\n#ifdef HAVE_TIME_H\n\ttime_t t0, t1, t2, logintime, logouttime;\n\tchar s_t0[64],s_t1[64],s_t2[64];\n\tchar s_logintime[64], s_logouttime[64]; /* ctime() strings */\n#endif\n\n\tprintf(\"**\\n** Testing the API...\\n**\\n\");\n\n\tpw = getpwuid(getuid());\n\tstrlcpy(username, pw->pw_name, sizeof(username));\n\n\t/* gethostname(hostname, sizeof(hostname)); */\n\n\tprintf(\"login_alloc_entry test (no host info):\\n\");\n\n\t/* FIXME fake tty more effectively - this could upset some platforms */\n\tli1 = login_alloc_entry((int)getpid(), username, NULL, ttyname(0));\n\tstrlcpy(li1->progname, \"OpenSSH-logintest\", sizeof(li1->progname));\n\n\tif (be_verbose)\n\t\tdump_logininfo(li1, \"li1\");\n\n\tprintf(\"Setting host address info for 'localhost' (may call out):\\n\");\n\tif (! (he = gethostbyname(\"localhost\"))) {\n\t\tprintf(\"Couldn't set hostname(lookup failed)\\n\");\n\t} else {\n\t\t/* NOTE: this is messy, but typically a program wouldn't have to set\n\t\t *  any of this, a sockaddr_in* would be already prepared */\n\t\tmemcpy((void *)&(sa_in4.sin_addr), (void *)&(he->h_addr_list[0][0]),\n\t\t       sizeof(struct in_addr));\n\t\tlogin_set_addr(li1, (struct sockaddr *) &sa_in4, sizeof(sa_in4));\n\t\tstrlcpy(li1->hostname, \"localhost\", sizeof(li1->hostname));\n\t}\n\tif (be_verbose)\n\t\tdump_logininfo(li1, \"li1\");\n\n\tif ((int)geteuid() != 0) {\n\t\tprintf(\"NOT RUNNING LOGIN TESTS - you are not root!\\n\");\n\t\treturn 1;\n\t}\n\n\tif (nologtest)\n\t\treturn 1;\n\n\tline_stripname(stripline, li1->line, sizeof(stripline));\n\n\tprintf(\"Performing an invalid login attempt (no type field)\\n--\\n\");\n\tlogin_write(li1);\n\tprintf(\"--\\n(Should have written errors to stderr)\\n\");\n\n#ifdef HAVE_TIME_H\n\t(void)time(&t0);\n\tstrlcpy(s_t0, ctime(&t0), sizeof(s_t0));\n\tt1 = login_get_lastlog_time(getuid());\n\tstrlcpy(s_t1, ctime(&t1), sizeof(s_t1));\n\tprintf(\"Before logging in:\\n\\tcurrent time is %d - %s\\t\"\n\t       \"lastlog time is %d - %s\\n\",\n\t       (int)t0, s_t0, (int)t1, s_t1);\n#endif\n\n\tprintf(\"Performing a login on line %s \", stripline);\n#ifdef HAVE_TIME_H\n\t(void)time(&logintime);\n\tstrlcpy(s_logintime, ctime(&logintime), sizeof(s_logintime));\n\tprintf(\"at %d - %s\", (int)logintime, s_logintime);\n#endif\n\tprintf(\"--\\n\");\n\tlogin_login(li1);\n\n\tsnprintf(cmdstring, sizeof(cmdstring), \"who | grep '%s '\",\n\t\t stripline);\n\tsystem(cmdstring);\n\n\tprintf(\"--\\nPausing for %d second(s)...\\n\", PAUSE_BEFORE_LOGOUT);\n\tsleep(PAUSE_BEFORE_LOGOUT);\n\n\tprintf(\"Performing a logout \");\n#ifdef HAVE_TIME_H\n\t(void)time(&logouttime);\n\tstrlcpy(s_logouttime, ctime(&logouttime), sizeof(s_logouttime));\n\tprintf(\"at %d - %s\", (int)logouttime, s_logouttime);\n#endif\n\tprintf(\"\\nThe root login shown above should be gone.\\n\"\n\t       \"If the root login hasn't gone, but another user on the same\\n\"\n\t       \"pty has, this is OK - we're hacking it here, and there\\n\"\n\t       \"shouldn't be two users on one pty in reality...\\n\"\n\t       \"-- ('who' output follows)\\n\");\n\tlogin_logout(li1);\n\n\tsystem(cmdstring);\n\tprintf(\"-- ('who' output ends)\\n\");\n\n#ifdef HAVE_TIME_H\n\tt2 = login_get_lastlog_time(getuid());\n\tstrlcpy(s_t2, ctime(&t2), sizeof(s_t2));\n\tprintf(\"After logging in, lastlog time is %d - %s\\n\", (int)t2, s_t2);\n\tif (t1 == t2)\n\t\tprintf(\"The lastlog times before and after logging in are the \"\n\t\t       \"same.\\nThis indicates that lastlog is ** NOT WORKING \"\n\t\t       \"CORRECTLY **\\n\");\n\telse if (t0 != t2)\n\t\t/* We can be off by a second or so, even when recording works fine.\n\t\t * I'm not 100% sure why, but it's true. */\n\t\tprintf(\"** The login time and the lastlog time differ.\\n\"\n\t\t       \"** This indicates that lastlog is either recording the \"\n\t\t       \"wrong time,\\n** or retrieving the wrong entry.\\n\"\n\t\t       \"If it's off by less than %d second(s) \"\n\t\t       \"run the test again.\\n\", PAUSE_BEFORE_LOGOUT);\n\telse\n\t\tprintf(\"lastlog agrees with the login time. This is a good thing.\\n\");\n\n#endif\n\n\tprintf(\"--\\nThe output of 'last' shown next should have \"\n\t       \"an entry for root \\n  on %s for the time shown above:\\n--\\n\",\n\t       stripline);\n\tsnprintf(cmdstring, sizeof(cmdstring), \"last | grep '%s ' | head -3\",\n\t\t stripline);\n\tsystem(cmdstring);\n\n\tprintf(\"--\\nEnd of login test.\\n\");\n\n\tlogin_free_entry(li1);\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "testOutput",
          "args": [],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "testOutput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/logintest.c",
          "lines": "239-250",
          "snippet": "int\ntestOutput()\n{\n\tprintf(\"**\\n** Testing linename functions\\n**\\n\");\n\ttestLineName(\"/dev/pts/1\");\n\ttestLineName(\"pts/1\");\n\ttestLineName(\"pts/999\");\n\ttestLineName(\"/dev/ttyp00\");\n\ttestLineName(\"ttyp00\");\n\n\treturn 1;\n}",
          "includes": [
            "#include \"loginrec.h\"",
            "#include <time.h>",
            "#include <netdb.h>",
            "#include <pwd.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include <sys/wait.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"loginrec.h\"\n#include <time.h>\n#include <netdb.h>\n#include <pwd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <sys/wait.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\ntestOutput()\n{\n\tprintf(\"**\\n** Testing linename functions\\n**\\n\");\n\ttestLineName(\"/dev/pts/1\");\n\ttestLineName(\"pts/1\");\n\ttestLineName(\"pts/999\");\n\ttestLineName(\"/dev/ttyp00\");\n\ttestLineName(\"ttyp00\");\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "argv[1]",
            "\"-v\"",
            "3"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "g_strncmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/glob.c",
          "lines": "422-435",
          "snippet": "static int\ng_strncmp(const Char *s1, const char *s2, size_t n)\n{\n\tint rv = 0;\n\n\twhile (n--) {\n\t\trv = *(Char *)s1 - *(const unsigned char *)s2++;\n\t\tif (rv)\n\t\t\tbreak;\n\t\tif (*s1++ == '\\0')\n\t\t\tbreak;\n\t}\n\treturn rv;\n}",
          "includes": [
            "#include \"charclass.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pwd.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <dirent.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"glob.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"charclass.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pwd.h>\n#include <limits.h>\n#include <errno.h>\n#include <ctype.h>\n#include <dirent.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"glob.h\"\n#include \"includes.h\"\n\nstatic int\ng_strncmp(const Char *s1, const char *s2, size_t n)\n{\n\tint rv = 0;\n\n\twhile (n--) {\n\t\trv = *(Char *)s1 - *(const unsigned char *)s2++;\n\t\tif (rv)\n\t\t\tbreak;\n\t\tif (*s1++ == '\\0')\n\t\t\tbreak;\n\t}\n\treturn rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_get_progname",
          "args": [
            "argv[0]"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_get_progname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
          "lines": "43-64",
          "snippet": "char *ssh_get_progname(char *argv0)\n{\n\tchar *p, *q;\n#ifdef HAVE___PROGNAME\n\textern char *__progname;\n\n\tp = __progname;\n#else\n\tif (argv0 == NULL)\n\t\treturn (\"unknown\");\t/* XXX */\n\tp = strrchr(argv0, '/');\n\tif (p == NULL)\n\t\tp = argv0;\n\telse\n\t\tp++;\n#endif\n\tif ((q = strdup(p)) == NULL) {\n\t\tperror(\"strdup\");\n\t\texit(1);\n\t}\n\treturn q;\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "# include <sys/time.h>",
            "# include <sys/select.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *ssh_get_progname(char *argv0)\n{\n\tchar *p, *q;\n#ifdef HAVE___PROGNAME\n\textern char *__progname;\n\n\tp = __progname;\n#else\n\tif (argv0 == NULL)\n\t\treturn (\"unknown\");\t/* XXX */\n\tp = strrchr(argv0, '/');\n\tif (p == NULL)\n\t\tp = argv0;\n\telse\n\t\tp++;\n#endif\n\tif ((q = strdup(p)) == NULL) {\n\t\tperror(\"strdup\");\n\t\texit(1);\n\t}\n\treturn q;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Platform-independent login recording test driver\\n\""
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "mprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/utf8.c",
          "lines": "289-299",
          "snippet": "int\nmprintf(const char *fmt, ...)\n{\n\tva_list\t ap;\n\tint\t ret;\n\n\tva_start(ap, fmt);\n\tret = vfmprintf(stdout, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"utf8.h\"",
            "# include <wchar.h>",
            "# include <vis.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <locale.h>",
            "#include <limits.h>",
            "# include <langinfo.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\t vasnmprintf(char **, size_t, int *, const char *, va_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utf8.h\"\n# include <wchar.h>\n# include <vis.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <locale.h>\n#include <limits.h>\n# include <langinfo.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\t vasnmprintf(char **, size_t, int *, const char *, va_list);\n\nint\nmprintf(const char *fmt, ...)\n{\n\tva_list\t ap;\n\tint\t ret;\n\n\tva_start(ap, fmt);\n\tret = vfmprintf(stdout, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"loginrec.h\"\n#include <time.h>\n#include <netdb.h>\n#include <pwd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <sys/wait.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nextern char *__progname;\nint compile_opts_only = 0;\nint be_verbose = 0;\n\nint\nmain(int argc, char *argv[])\n{\n\tprintf(\"Platform-independent login recording test driver\\n\");\n\n\t__progname = ssh_get_progname(argv[0]);\n\tif (argc == 2) {\n\t\tif (strncmp(argv[1], \"-i\", 3) == 0)\n\t\t\tcompile_opts_only = 1;\n\t\telse if (strncmp(argv[1], \"-v\", 3) == 0)\n\t\t\tbe_verbose=1;\n\t}\n\n\tif (!compile_opts_only) {\n\t\tif (be_verbose && !testOutput())\n\t\t\treturn 1;\n\n\t\tif (!testAPI())\n\t\t\treturn 1;\n\t}\n\n\tshowOptions();\n\n\treturn 0;\n}"
  },
  {
    "function_name": "showOptions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/logintest.c",
    "lines": "254-280",
    "snippet": "void\nshowOptions(void)\n{\n\tprintf(\"**\\n** Compile-time options\\n**\\n\");\n\n\tprintf(\"login recording methods selected:\\n\");\n#ifdef USE_LOGIN\n\tprintf(\"\\tUSE_LOGIN\\n\");\n#endif\n#ifdef USE_UTMP\n\tprintf(\"\\tUSE_UTMP (UTMP_FILE=%s)\\n\", UTMP_FILE);\n#endif\n#ifdef USE_UTMPX\n\tprintf(\"\\tUSE_UTMPX\\n\");\n#endif\n#ifdef USE_WTMP\n\tprintf(\"\\tUSE_WTMP (WTMP_FILE=%s)\\n\", WTMP_FILE);\n#endif\n#ifdef USE_WTMPX\n\tprintf(\"\\tUSE_WTMPX (WTMPX_FILE=%s)\\n\", WTMPX_FILE);\n#endif\n#ifdef USE_LASTLOG\n\tprintf(\"\\tUSE_LASTLOG (LASTLOG_FILE=%s)\\n\", LASTLOG_FILE);\n#endif\n\tprintf(\"\\n\");\n\n}",
    "includes": [
      "#include \"loginrec.h\"",
      "#include <time.h>",
      "#include <netdb.h>",
      "#include <pwd.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include <sys/wait.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\n\""
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "mprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/utf8.c",
          "lines": "289-299",
          "snippet": "int\nmprintf(const char *fmt, ...)\n{\n\tva_list\t ap;\n\tint\t ret;\n\n\tva_start(ap, fmt);\n\tret = vfmprintf(stdout, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"utf8.h\"",
            "# include <wchar.h>",
            "# include <vis.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <locale.h>",
            "#include <limits.h>",
            "# include <langinfo.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\t vasnmprintf(char **, size_t, int *, const char *, va_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utf8.h\"\n# include <wchar.h>\n# include <vis.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <locale.h>\n#include <limits.h>\n# include <langinfo.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\t vasnmprintf(char **, size_t, int *, const char *, va_list);\n\nint\nmprintf(const char *fmt, ...)\n{\n\tva_list\t ap;\n\tint\t ret;\n\n\tva_start(ap, fmt);\n\tret = vfmprintf(stdout, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"\\tUSE_LASTLOG (LASTLOG_FILE=%s)\\n\"",
            "LASTLOG_FILE"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "xasprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "104-118",
          "snippet": "int\nxasprintf(char **ret, const char *fmt, ...)\n{\n\tva_list ap;\n\tint i;\n\n\tva_start(ap, fmt);\n\ti = vasprintf(ret, fmt, ap);\n\tva_end(ap);\n\n\tif (i < 0 || *ret == NULL)\n\t\tfatal(\"xasprintf: could not allocate memory\");\n\n\treturn (i);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nint\nxasprintf(char **ret, const char *fmt, ...)\n{\n\tva_list ap;\n\tint i;\n\n\tva_start(ap, fmt);\n\ti = vasprintf(ret, fmt, ap);\n\tva_end(ap);\n\n\tif (i < 0 || *ret == NULL)\n\t\tfatal(\"xasprintf: could not allocate memory\");\n\n\treturn (i);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"loginrec.h\"\n#include <time.h>\n#include <netdb.h>\n#include <pwd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <sys/wait.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nshowOptions(void)\n{\n\tprintf(\"**\\n** Compile-time options\\n**\\n\");\n\n\tprintf(\"login recording methods selected:\\n\");\n#ifdef USE_LOGIN\n\tprintf(\"\\tUSE_LOGIN\\n\");\n#endif\n#ifdef USE_UTMP\n\tprintf(\"\\tUSE_UTMP (UTMP_FILE=%s)\\n\", UTMP_FILE);\n#endif\n#ifdef USE_UTMPX\n\tprintf(\"\\tUSE_UTMPX\\n\");\n#endif\n#ifdef USE_WTMP\n\tprintf(\"\\tUSE_WTMP (WTMP_FILE=%s)\\n\", WTMP_FILE);\n#endif\n#ifdef USE_WTMPX\n\tprintf(\"\\tUSE_WTMPX (WTMPX_FILE=%s)\\n\", WTMPX_FILE);\n#endif\n#ifdef USE_LASTLOG\n\tprintf(\"\\tUSE_LASTLOG (LASTLOG_FILE=%s)\\n\", LASTLOG_FILE);\n#endif\n\tprintf(\"\\n\");\n\n}"
  },
  {
    "function_name": "testOutput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/logintest.c",
    "lines": "239-250",
    "snippet": "int\ntestOutput()\n{\n\tprintf(\"**\\n** Testing linename functions\\n**\\n\");\n\ttestLineName(\"/dev/pts/1\");\n\ttestLineName(\"pts/1\");\n\ttestLineName(\"pts/999\");\n\ttestLineName(\"/dev/ttyp00\");\n\ttestLineName(\"ttyp00\");\n\n\treturn 1;\n}",
    "includes": [
      "#include \"loginrec.h\"",
      "#include <time.h>",
      "#include <netdb.h>",
      "#include <pwd.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include <sys/wait.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "testLineName",
          "args": [
            "\"ttyp00\""
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "testLineName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/logintest.c",
          "lines": "220-236",
          "snippet": "void\ntestLineName(char *line)\n{\n\t/* have to null-terminate - these functions are designed for\n\t * structures with fixed-length char arrays, and don't null-term.*/\n\tchar full[17], strip[9], abbrev[5];\n\n\tmemset(full, '\\0', sizeof(full));\n\tmemset(strip, '\\0', sizeof(strip));\n\tmemset(abbrev, '\\0', sizeof(abbrev));\n\n\tline_fullname(full, line, sizeof(full)-1);\n\tline_stripname(strip, full, sizeof(strip)-1);\n\tline_abbrevname(abbrev, full, sizeof(abbrev)-1);\n\tprintf(\"%s: %s, %s, %s\\n\", line, full, strip, abbrev);\n\n}",
          "includes": [
            "#include \"loginrec.h\"",
            "#include <time.h>",
            "#include <netdb.h>",
            "#include <pwd.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include <sys/wait.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"loginrec.h\"\n#include <time.h>\n#include <netdb.h>\n#include <pwd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <sys/wait.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ntestLineName(char *line)\n{\n\t/* have to null-terminate - these functions are designed for\n\t * structures with fixed-length char arrays, and don't null-term.*/\n\tchar full[17], strip[9], abbrev[5];\n\n\tmemset(full, '\\0', sizeof(full));\n\tmemset(strip, '\\0', sizeof(strip));\n\tmemset(abbrev, '\\0', sizeof(abbrev));\n\n\tline_fullname(full, line, sizeof(full)-1);\n\tline_stripname(strip, full, sizeof(strip)-1);\n\tline_abbrevname(abbrev, full, sizeof(abbrev)-1);\n\tprintf(\"%s: %s, %s, %s\\n\", line, full, strip, abbrev);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"**\\n** Testing linename functions\\n**\\n\""
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "mprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/utf8.c",
          "lines": "289-299",
          "snippet": "int\nmprintf(const char *fmt, ...)\n{\n\tva_list\t ap;\n\tint\t ret;\n\n\tva_start(ap, fmt);\n\tret = vfmprintf(stdout, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"utf8.h\"",
            "# include <wchar.h>",
            "# include <vis.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <locale.h>",
            "#include <limits.h>",
            "# include <langinfo.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\t vasnmprintf(char **, size_t, int *, const char *, va_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utf8.h\"\n# include <wchar.h>\n# include <vis.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <locale.h>\n#include <limits.h>\n# include <langinfo.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\t vasnmprintf(char **, size_t, int *, const char *, va_list);\n\nint\nmprintf(const char *fmt, ...)\n{\n\tva_list\t ap;\n\tint\t ret;\n\n\tva_start(ap, fmt);\n\tret = vfmprintf(stdout, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"loginrec.h\"\n#include <time.h>\n#include <netdb.h>\n#include <pwd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <sys/wait.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\ntestOutput()\n{\n\tprintf(\"**\\n** Testing linename functions\\n**\\n\");\n\ttestLineName(\"/dev/pts/1\");\n\ttestLineName(\"pts/1\");\n\ttestLineName(\"pts/999\");\n\ttestLineName(\"/dev/ttyp00\");\n\ttestLineName(\"ttyp00\");\n\n\treturn 1;\n}"
  },
  {
    "function_name": "testLineName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/logintest.c",
    "lines": "220-236",
    "snippet": "void\ntestLineName(char *line)\n{\n\t/* have to null-terminate - these functions are designed for\n\t * structures with fixed-length char arrays, and don't null-term.*/\n\tchar full[17], strip[9], abbrev[5];\n\n\tmemset(full, '\\0', sizeof(full));\n\tmemset(strip, '\\0', sizeof(strip));\n\tmemset(abbrev, '\\0', sizeof(abbrev));\n\n\tline_fullname(full, line, sizeof(full)-1);\n\tline_stripname(strip, full, sizeof(strip)-1);\n\tline_abbrevname(abbrev, full, sizeof(abbrev)-1);\n\tprintf(\"%s: %s, %s, %s\\n\", line, full, strip, abbrev);\n\n}",
    "includes": [
      "#include \"loginrec.h\"",
      "#include <time.h>",
      "#include <netdb.h>",
      "#include <pwd.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include <sys/wait.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: %s, %s, %s\\n\"",
            "line",
            "full",
            "strip",
            "abbrev"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "xasprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "104-118",
          "snippet": "int\nxasprintf(char **ret, const char *fmt, ...)\n{\n\tva_list ap;\n\tint i;\n\n\tva_start(ap, fmt);\n\ti = vasprintf(ret, fmt, ap);\n\tva_end(ap);\n\n\tif (i < 0 || *ret == NULL)\n\t\tfatal(\"xasprintf: could not allocate memory\");\n\n\treturn (i);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nint\nxasprintf(char **ret, const char *fmt, ...)\n{\n\tva_list ap;\n\tint i;\n\n\tva_start(ap, fmt);\n\ti = vasprintf(ret, fmt, ap);\n\tva_end(ap);\n\n\tif (i < 0 || *ret == NULL)\n\t\tfatal(\"xasprintf: could not allocate memory\");\n\n\treturn (i);\n}"
        }
      },
      {
        "call_info": {
          "callee": "line_abbrevname",
          "args": [
            "abbrev",
            "full",
            "sizeof(abbrev)-1"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "line_abbrevname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/loginrec.c",
          "lines": "596-623",
          "snippet": "char *\nline_abbrevname(char *dst, const char *src, int dstsize)\n{\n\tsize_t len;\n\n\tmemset(dst, '\\0', dstsize);\n\n\t/* Always skip prefix if present */\n\tif (strncmp(src, \"/dev/\", 5) == 0)\n\t\tsrc += 5;\n\n#ifdef WITH_ABBREV_NO_TTY\n\tif (strncmp(src, \"tty\", 3) == 0)\n\t\tsrc += 3;\n#endif\n\n\tlen = strlen(src);\n\n\tif (len > 0) {\n\t\tif (((int)len - dstsize) > 0)\n\t\t\tsrc +=  ((int)len - dstsize);\n\n\t\t/* note: _don't_ change this to strlcpy */\n\t\tstrncpy(dst, src, (size_t)dstsize);\n\t}\n\n\treturn (dst);\n}",
          "includes": [
            "# include <util.h>",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"auth.h\"",
            "#include \"canohost.h\"",
            "#include \"packet.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"loginrec.h\"",
            "#include \"ssh.h\"",
            "#include \"hostfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <util.h>\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"auth.h\"\n#include \"canohost.h\"\n#include \"packet.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"loginrec.h\"\n#include \"ssh.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdarg.h>\n#include <pwd.h>\n# include <paths.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *\nline_abbrevname(char *dst, const char *src, int dstsize)\n{\n\tsize_t len;\n\n\tmemset(dst, '\\0', dstsize);\n\n\t/* Always skip prefix if present */\n\tif (strncmp(src, \"/dev/\", 5) == 0)\n\t\tsrc += 5;\n\n#ifdef WITH_ABBREV_NO_TTY\n\tif (strncmp(src, \"tty\", 3) == 0)\n\t\tsrc += 3;\n#endif\n\n\tlen = strlen(src);\n\n\tif (len > 0) {\n\t\tif (((int)len - dstsize) > 0)\n\t\t\tsrc +=  ((int)len - dstsize);\n\n\t\t/* note: _don't_ change this to strlcpy */\n\t\tstrncpy(dst, src, (size_t)dstsize);\n\t}\n\n\treturn (dst);\n}"
        }
      },
      {
        "call_info": {
          "callee": "line_stripname",
          "args": [
            "strip",
            "full",
            "sizeof(strip)-1"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "line_stripname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/loginrec.c",
          "lines": "577-586",
          "snippet": "char *\nline_stripname(char *dst, const char *src, int dstsize)\n{\n\tmemset(dst, '\\0', dstsize);\n\tif (strncmp(src, \"/dev/\", 5) == 0)\n\t\tstrlcpy(dst, src + 5, dstsize);\n\telse\n\t\tstrlcpy(dst, src, dstsize);\n\treturn (dst);\n}",
          "includes": [
            "# include <util.h>",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"auth.h\"",
            "#include \"canohost.h\"",
            "#include \"packet.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"loginrec.h\"",
            "#include \"ssh.h\"",
            "#include \"hostfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <util.h>\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"auth.h\"\n#include \"canohost.h\"\n#include \"packet.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"loginrec.h\"\n#include \"ssh.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdarg.h>\n#include <pwd.h>\n# include <paths.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *\nline_stripname(char *dst, const char *src, int dstsize)\n{\n\tmemset(dst, '\\0', dstsize);\n\tif (strncmp(src, \"/dev/\", 5) == 0)\n\t\tstrlcpy(dst, src + 5, dstsize);\n\telse\n\t\tstrlcpy(dst, src, dstsize);\n\treturn (dst);\n}"
        }
      },
      {
        "call_info": {
          "callee": "line_fullname",
          "args": [
            "full",
            "line",
            "sizeof(full)-1"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "line_fullname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/loginrec.c",
          "lines": "563-574",
          "snippet": "char *\nline_fullname(char *dst, const char *src, u_int dstsize)\n{\n\tmemset(dst, '\\0', dstsize);\n\tif ((strncmp(src, \"/dev/\", 5) == 0) || (dstsize < (strlen(src) + 5)))\n\t\tstrlcpy(dst, src, dstsize);\n\telse {\n\t\tstrlcpy(dst, \"/dev/\", dstsize);\n\t\tstrlcat(dst, src, dstsize);\n\t}\n\treturn (dst);\n}",
          "includes": [
            "# include <util.h>",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"auth.h\"",
            "#include \"canohost.h\"",
            "#include \"packet.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"loginrec.h\"",
            "#include \"ssh.h\"",
            "#include \"hostfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <util.h>\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"auth.h\"\n#include \"canohost.h\"\n#include \"packet.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"loginrec.h\"\n#include \"ssh.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdarg.h>\n#include <pwd.h>\n# include <paths.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *\nline_fullname(char *dst, const char *src, u_int dstsize)\n{\n\tmemset(dst, '\\0', dstsize);\n\tif ((strncmp(src, \"/dev/\", 5) == 0) || (dstsize < (strlen(src) + 5)))\n\t\tstrlcpy(dst, src, dstsize);\n\telse {\n\t\tstrlcpy(dst, \"/dev/\", dstsize);\n\t\tstrlcat(dst, src, dstsize);\n\t}\n\treturn (dst);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "abbrev",
            "'\\0'",
            "sizeof(abbrev)"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "strip",
            "'\\0'",
            "sizeof(strip)"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "full",
            "'\\0'",
            "sizeof(full)"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"loginrec.h\"\n#include <time.h>\n#include <netdb.h>\n#include <pwd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <sys/wait.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ntestLineName(char *line)\n{\n\t/* have to null-terminate - these functions are designed for\n\t * structures with fixed-length char arrays, and don't null-term.*/\n\tchar full[17], strip[9], abbrev[5];\n\n\tmemset(full, '\\0', sizeof(full));\n\tmemset(strip, '\\0', sizeof(strip));\n\tmemset(abbrev, '\\0', sizeof(abbrev));\n\n\tline_fullname(full, line, sizeof(full)-1);\n\tline_stripname(strip, full, sizeof(strip)-1);\n\tline_abbrevname(abbrev, full, sizeof(abbrev)-1);\n\tprintf(\"%s: %s, %s, %s\\n\", line, full, strip, abbrev);\n\n}"
  },
  {
    "function_name": "testAPI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/logintest.c",
    "lines": "83-217",
    "snippet": "int\ntestAPI()\n{\n\tstruct logininfo *li1;\n\tstruct passwd *pw;\n\tstruct hostent *he;\n\tstruct sockaddr_in sa_in4;\n\tchar cmdstring[256], stripline[8];\n\tchar username[32];\n#ifdef HAVE_TIME_H\n\ttime_t t0, t1, t2, logintime, logouttime;\n\tchar s_t0[64],s_t1[64],s_t2[64];\n\tchar s_logintime[64], s_logouttime[64]; /* ctime() strings */\n#endif\n\n\tprintf(\"**\\n** Testing the API...\\n**\\n\");\n\n\tpw = getpwuid(getuid());\n\tstrlcpy(username, pw->pw_name, sizeof(username));\n\n\t/* gethostname(hostname, sizeof(hostname)); */\n\n\tprintf(\"login_alloc_entry test (no host info):\\n\");\n\n\t/* FIXME fake tty more effectively - this could upset some platforms */\n\tli1 = login_alloc_entry((int)getpid(), username, NULL, ttyname(0));\n\tstrlcpy(li1->progname, \"OpenSSH-logintest\", sizeof(li1->progname));\n\n\tif (be_verbose)\n\t\tdump_logininfo(li1, \"li1\");\n\n\tprintf(\"Setting host address info for 'localhost' (may call out):\\n\");\n\tif (! (he = gethostbyname(\"localhost\"))) {\n\t\tprintf(\"Couldn't set hostname(lookup failed)\\n\");\n\t} else {\n\t\t/* NOTE: this is messy, but typically a program wouldn't have to set\n\t\t *  any of this, a sockaddr_in* would be already prepared */\n\t\tmemcpy((void *)&(sa_in4.sin_addr), (void *)&(he->h_addr_list[0][0]),\n\t\t       sizeof(struct in_addr));\n\t\tlogin_set_addr(li1, (struct sockaddr *) &sa_in4, sizeof(sa_in4));\n\t\tstrlcpy(li1->hostname, \"localhost\", sizeof(li1->hostname));\n\t}\n\tif (be_verbose)\n\t\tdump_logininfo(li1, \"li1\");\n\n\tif ((int)geteuid() != 0) {\n\t\tprintf(\"NOT RUNNING LOGIN TESTS - you are not root!\\n\");\n\t\treturn 1;\n\t}\n\n\tif (nologtest)\n\t\treturn 1;\n\n\tline_stripname(stripline, li1->line, sizeof(stripline));\n\n\tprintf(\"Performing an invalid login attempt (no type field)\\n--\\n\");\n\tlogin_write(li1);\n\tprintf(\"--\\n(Should have written errors to stderr)\\n\");\n\n#ifdef HAVE_TIME_H\n\t(void)time(&t0);\n\tstrlcpy(s_t0, ctime(&t0), sizeof(s_t0));\n\tt1 = login_get_lastlog_time(getuid());\n\tstrlcpy(s_t1, ctime(&t1), sizeof(s_t1));\n\tprintf(\"Before logging in:\\n\\tcurrent time is %d - %s\\t\"\n\t       \"lastlog time is %d - %s\\n\",\n\t       (int)t0, s_t0, (int)t1, s_t1);\n#endif\n\n\tprintf(\"Performing a login on line %s \", stripline);\n#ifdef HAVE_TIME_H\n\t(void)time(&logintime);\n\tstrlcpy(s_logintime, ctime(&logintime), sizeof(s_logintime));\n\tprintf(\"at %d - %s\", (int)logintime, s_logintime);\n#endif\n\tprintf(\"--\\n\");\n\tlogin_login(li1);\n\n\tsnprintf(cmdstring, sizeof(cmdstring), \"who | grep '%s '\",\n\t\t stripline);\n\tsystem(cmdstring);\n\n\tprintf(\"--\\nPausing for %d second(s)...\\n\", PAUSE_BEFORE_LOGOUT);\n\tsleep(PAUSE_BEFORE_LOGOUT);\n\n\tprintf(\"Performing a logout \");\n#ifdef HAVE_TIME_H\n\t(void)time(&logouttime);\n\tstrlcpy(s_logouttime, ctime(&logouttime), sizeof(s_logouttime));\n\tprintf(\"at %d - %s\", (int)logouttime, s_logouttime);\n#endif\n\tprintf(\"\\nThe root login shown above should be gone.\\n\"\n\t       \"If the root login hasn't gone, but another user on the same\\n\"\n\t       \"pty has, this is OK - we're hacking it here, and there\\n\"\n\t       \"shouldn't be two users on one pty in reality...\\n\"\n\t       \"-- ('who' output follows)\\n\");\n\tlogin_logout(li1);\n\n\tsystem(cmdstring);\n\tprintf(\"-- ('who' output ends)\\n\");\n\n#ifdef HAVE_TIME_H\n\tt2 = login_get_lastlog_time(getuid());\n\tstrlcpy(s_t2, ctime(&t2), sizeof(s_t2));\n\tprintf(\"After logging in, lastlog time is %d - %s\\n\", (int)t2, s_t2);\n\tif (t1 == t2)\n\t\tprintf(\"The lastlog times before and after logging in are the \"\n\t\t       \"same.\\nThis indicates that lastlog is ** NOT WORKING \"\n\t\t       \"CORRECTLY **\\n\");\n\telse if (t0 != t2)\n\t\t/* We can be off by a second or so, even when recording works fine.\n\t\t * I'm not 100% sure why, but it's true. */\n\t\tprintf(\"** The login time and the lastlog time differ.\\n\"\n\t\t       \"** This indicates that lastlog is either recording the \"\n\t\t       \"wrong time,\\n** or retrieving the wrong entry.\\n\"\n\t\t       \"If it's off by less than %d second(s) \"\n\t\t       \"run the test again.\\n\", PAUSE_BEFORE_LOGOUT);\n\telse\n\t\tprintf(\"lastlog agrees with the login time. This is a good thing.\\n\");\n\n#endif\n\n\tprintf(\"--\\nThe output of 'last' shown next should have \"\n\t       \"an entry for root \\n  on %s for the time shown above:\\n--\\n\",\n\t       stripline);\n\tsnprintf(cmdstring, sizeof(cmdstring), \"last | grep '%s ' | head -3\",\n\t\t stripline);\n\tsystem(cmdstring);\n\n\tprintf(\"--\\nEnd of login test.\\n\");\n\n\tlogin_free_entry(li1);\n\n\treturn 1;\n}",
    "includes": [
      "#include \"loginrec.h\"",
      "#include <time.h>",
      "#include <netdb.h>",
      "#include <pwd.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include <sys/wait.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define PAUSE_BEFORE_LOGOUT 3"
    ],
    "globals_used": [
      "int nologtest = 0;",
      "int be_verbose = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "login_free_entry",
          "args": [
            "li1"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "login_free_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/loginrec.c",
          "lines": "354-358",
          "snippet": "void\nlogin_free_entry(struct logininfo *li)\n{\n\tfree(li);\n}",
          "includes": [
            "# include <util.h>",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"auth.h\"",
            "#include \"canohost.h\"",
            "#include \"packet.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"loginrec.h\"",
            "#include \"ssh.h\"",
            "#include \"hostfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int utmp_write_entry(struct logininfo *li);",
            "int utmpx_write_entry(struct logininfo *li);",
            "int wtmp_write_entry(struct logininfo *li);",
            "int wtmpx_write_entry(struct logininfo *li);",
            "int lastlog_write_entry(struct logininfo *li);",
            "int syslogin_write_entry(struct logininfo *li);",
            "int getlast_entry(struct logininfo *li);",
            "int lastlog_get_entry(struct logininfo *li);",
            "int utmpx_get_entry(struct logininfo *li);",
            "int wtmp_get_entry(struct logininfo *li);",
            "int wtmpx_get_entry(struct logininfo *li);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <util.h>\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"auth.h\"\n#include \"canohost.h\"\n#include \"packet.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"loginrec.h\"\n#include \"ssh.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdarg.h>\n#include <pwd.h>\n# include <paths.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint utmp_write_entry(struct logininfo *li);\nint utmpx_write_entry(struct logininfo *li);\nint wtmp_write_entry(struct logininfo *li);\nint wtmpx_write_entry(struct logininfo *li);\nint lastlog_write_entry(struct logininfo *li);\nint syslogin_write_entry(struct logininfo *li);\nint getlast_entry(struct logininfo *li);\nint lastlog_get_entry(struct logininfo *li);\nint utmpx_get_entry(struct logininfo *li);\nint wtmp_get_entry(struct logininfo *li);\nint wtmpx_get_entry(struct logininfo *li);\n\nvoid\nlogin_free_entry(struct logininfo *li)\n{\n\tfree(li);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"--\\nEnd of login test.\\n\""
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "mprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/utf8.c",
          "lines": "289-299",
          "snippet": "int\nmprintf(const char *fmt, ...)\n{\n\tva_list\t ap;\n\tint\t ret;\n\n\tva_start(ap, fmt);\n\tret = vfmprintf(stdout, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include \"utf8.h\"",
            "# include <wchar.h>",
            "# include <vis.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <locale.h>",
            "#include <limits.h>",
            "# include <langinfo.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\t vasnmprintf(char **, size_t, int *, const char *, va_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utf8.h\"\n# include <wchar.h>\n# include <vis.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <locale.h>\n#include <limits.h>\n# include <langinfo.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\t vasnmprintf(char **, size_t, int *, const char *, va_list);\n\nint\nmprintf(const char *fmt, ...)\n{\n\tva_list\t ap;\n\tint\t ret;\n\n\tva_start(ap, fmt);\n\tret = vfmprintf(stdout, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "system",
          "args": [
            "cmdstring"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "cmdstring",
            "sizeof(cmdstring)",
            "\"last | grep '%s ' | head -3\"",
            "stripline"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "snprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-snprintf.c",
          "lines": "869-879",
          "snippet": "int\nsnprintf(char *str, size_t count, SNPRINTF_CONST char *fmt, ...)\n{\n\tsize_t ret;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tret = vsnprintf(str, count, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include <errno.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <ctype.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <ctype.h>\n#include \"includes.h\"\n\nint\nsnprintf(char *str, size_t count, SNPRINTF_CONST char *fmt, ...)\n{\n\tsize_t ret;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tret = vsnprintf(str, count, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"--\\nThe output of 'last' shown next should have \"\n\t       \"an entry for root \\n  on %s for the time shown above:\\n--\\n\"",
            "stripline"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "xasprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "104-118",
          "snippet": "int\nxasprintf(char **ret, const char *fmt, ...)\n{\n\tva_list ap;\n\tint i;\n\n\tva_start(ap, fmt);\n\ti = vasprintf(ret, fmt, ap);\n\tva_end(ap);\n\n\tif (i < 0 || *ret == NULL)\n\t\tfatal(\"xasprintf: could not allocate memory\");\n\n\treturn (i);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nint\nxasprintf(char **ret, const char *fmt, ...)\n{\n\tva_list ap;\n\tint i;\n\n\tva_start(ap, fmt);\n\ti = vasprintf(ret, fmt, ap);\n\tva_end(ap);\n\n\tif (i < 0 || *ret == NULL)\n\t\tfatal(\"xasprintf: could not allocate memory\");\n\n\treturn (i);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "s_t2",
            "ctime(&t2)",
            "sizeof(s_t2)"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "strlcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strlcpy.c",
          "lines": "32-56",
          "snippet": "size_t\nstrlcpy(char *dst, const char *src, size_t siz)\n{\n\tchar *d = dst;\n\tconst char *s = src;\n\tsize_t n = siz;\n\n\t/* Copy as many bytes as will fit */\n\tif (n != 0) {\n\t\twhile (--n != 0) {\n\t\t\tif ((*d++ = *s++) == '\\0')\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* Not enough room in dst, add NUL and traverse rest of src */\n\tif (n == 0) {\n\t\tif (siz != 0)\n\t\t\t*d = '\\0';\t\t/* NUL-terminate dst */\n\t\twhile (*s++)\n\t\t\t;\n\t}\n\n\treturn(s - src - 1);\t/* count does not include NUL */\n}",
          "includes": [
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nstrlcpy(char *dst, const char *src, size_t siz)\n{\n\tchar *d = dst;\n\tconst char *s = src;\n\tsize_t n = siz;\n\n\t/* Copy as many bytes as will fit */\n\tif (n != 0) {\n\t\twhile (--n != 0) {\n\t\t\tif ((*d++ = *s++) == '\\0')\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* Not enough room in dst, add NUL and traverse rest of src */\n\tif (n == 0) {\n\t\tif (siz != 0)\n\t\t\t*d = '\\0';\t\t/* NUL-terminate dst */\n\t\twhile (*s++)\n\t\t\t;\n\t}\n\n\treturn(s - src - 1);\t/* count does not include NUL */\n}"
        }
      },
      {
        "call_info": {
          "callee": "ctime",
          "args": [
            "&t2"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "login_get_lastlog_time",
          "args": [
            "getuid()"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "login_get_lastlog_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/loginrec.c",
          "lines": "275-284",
          "snippet": "unsigned int\nlogin_get_lastlog_time(const uid_t uid)\n{\n\tstruct logininfo li;\n\n\tif (login_get_lastlog(&li, uid))\n\t\treturn (li.tv_sec);\n\telse\n\t\treturn (0);\n}",
          "includes": [
            "# include <util.h>",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"auth.h\"",
            "#include \"canohost.h\"",
            "#include \"packet.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"loginrec.h\"",
            "#include \"ssh.h\"",
            "#include \"hostfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int utmp_write_entry(struct logininfo *li);",
            "int utmpx_write_entry(struct logininfo *li);",
            "int wtmp_write_entry(struct logininfo *li);",
            "int wtmpx_write_entry(struct logininfo *li);",
            "int lastlog_write_entry(struct logininfo *li);",
            "int syslogin_write_entry(struct logininfo *li);",
            "int getlast_entry(struct logininfo *li);",
            "int lastlog_get_entry(struct logininfo *li);",
            "int utmpx_get_entry(struct logininfo *li);",
            "int wtmp_get_entry(struct logininfo *li);",
            "int wtmpx_get_entry(struct logininfo *li);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <util.h>\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"auth.h\"\n#include \"canohost.h\"\n#include \"packet.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"loginrec.h\"\n#include \"ssh.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdarg.h>\n#include <pwd.h>\n# include <paths.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint utmp_write_entry(struct logininfo *li);\nint utmpx_write_entry(struct logininfo *li);\nint wtmp_write_entry(struct logininfo *li);\nint wtmpx_write_entry(struct logininfo *li);\nint lastlog_write_entry(struct logininfo *li);\nint syslogin_write_entry(struct logininfo *li);\nint getlast_entry(struct logininfo *li);\nint lastlog_get_entry(struct logininfo *li);\nint utmpx_get_entry(struct logininfo *li);\nint wtmp_get_entry(struct logininfo *li);\nint wtmpx_get_entry(struct logininfo *li);\n\nunsigned int\nlogin_get_lastlog_time(const uid_t uid)\n{\n\tstruct logininfo li;\n\n\tif (login_get_lastlog(&li, uid))\n\t\treturn (li.tv_sec);\n\telse\n\t\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "system",
          "args": [
            "cmdstring"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "login_logout",
          "args": [
            "li1"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "login_logout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/loginrec.c",
          "lines": "250-255",
          "snippet": "int\nlogin_logout(struct logininfo *li)\n{\n\tli->type = LTYPE_LOGOUT;\n\treturn (login_write(li));\n}",
          "includes": [
            "# include <util.h>",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"auth.h\"",
            "#include \"canohost.h\"",
            "#include \"packet.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"loginrec.h\"",
            "#include \"ssh.h\"",
            "#include \"hostfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int utmp_write_entry(struct logininfo *li);",
            "int utmpx_write_entry(struct logininfo *li);",
            "int wtmp_write_entry(struct logininfo *li);",
            "int wtmpx_write_entry(struct logininfo *li);",
            "int lastlog_write_entry(struct logininfo *li);",
            "int syslogin_write_entry(struct logininfo *li);",
            "int getlast_entry(struct logininfo *li);",
            "int lastlog_get_entry(struct logininfo *li);",
            "int utmpx_get_entry(struct logininfo *li);",
            "int wtmp_get_entry(struct logininfo *li);",
            "int wtmpx_get_entry(struct logininfo *li);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <util.h>\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"auth.h\"\n#include \"canohost.h\"\n#include \"packet.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"loginrec.h\"\n#include \"ssh.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdarg.h>\n#include <pwd.h>\n# include <paths.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint utmp_write_entry(struct logininfo *li);\nint utmpx_write_entry(struct logininfo *li);\nint wtmp_write_entry(struct logininfo *li);\nint wtmpx_write_entry(struct logininfo *li);\nint lastlog_write_entry(struct logininfo *li);\nint syslogin_write_entry(struct logininfo *li);\nint getlast_entry(struct logininfo *li);\nint lastlog_get_entry(struct logininfo *li);\nint utmpx_get_entry(struct logininfo *li);\nint wtmp_get_entry(struct logininfo *li);\nint wtmpx_get_entry(struct logininfo *li);\n\nint\nlogin_logout(struct logininfo *li)\n{\n\tli->type = LTYPE_LOGOUT;\n\treturn (login_write(li));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ctime",
          "args": [
            "&logouttime"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "&logouttime"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "parse_cert_times",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keygen.c",
          "lines": "1840-1888",
          "snippet": "static void\nparse_cert_times(char *timespec)\n{\n\tchar *from, *to;\n\ttime_t now = time(NULL);\n\tint64_t secs;\n\n\t/* +timespec relative to now */\n\tif (*timespec == '+' && strchr(timespec, ':') == NULL) {\n\t\tif ((secs = convtime(timespec + 1)) == -1)\n\t\t\tfatal(\"Invalid relative certificate life %s\", timespec);\n\t\tcert_valid_to = now + secs;\n\t\t/*\n\t\t * Backdate certificate one minute to avoid problems on hosts\n\t\t * with poorly-synchronised clocks.\n\t\t */\n\t\tcert_valid_from = ((now - 59)/ 60) * 60;\n\t\treturn;\n\t}\n\n\t/*\n\t * from:to, where\n\t * from := [+-]timespec | YYYYMMDD | YYYYMMDDHHMMSS | \"always\"\n\t *   to := [+-]timespec | YYYYMMDD | YYYYMMDDHHMMSS | \"forever\"\n\t */\n\tfrom = xstrdup(timespec);\n\tto = strchr(from, ':');\n\tif (to == NULL || from == to || *(to + 1) == '\\0')\n\t\tfatal(\"Invalid certificate life specification %s\", timespec);\n\t*to++ = '\\0';\n\n\tif (*from == '-' || *from == '+')\n\t\tcert_valid_from = parse_relative_time(from, now);\n\telse if (strcmp(from, \"always\") == 0)\n\t\tcert_valid_from = 0;\n\telse if (parse_absolute_time(from, &cert_valid_from) != 0)\n\t\tfatal(\"Invalid from time \\\"%s\\\"\", from);\n\n\tif (*to == '-' || *to == '+')\n\t\tcert_valid_to = parse_relative_time(to, now);\n\telse if (strcmp(to, \"forever\") == 0)\n\t\tcert_valid_to = ~(u_int64_t)0;\n\telse if (parse_absolute_time(to, &cert_valid_to) != 0)\n\t\tfatal(\"Invalid to time \\\"%s\\\"\", to);\n\n\tif (cert_valid_to <= cert_valid_from)\n\t\tfatal(\"Empty certificate validity interval\");\n\tfree(from);\n}",
          "includes": [
            "#include \"authfd.h\"",
            "#include \"utf8.h\"",
            "#include \"digest.h\"",
            "#include \"krl.h\"",
            "#include \"atomicio.h\"",
            "#include \"ssh-pkcs11.h\"",
            "#include \"ssherr.h\"",
            "#include \"ssh2.h\"",
            "#include \"ssh.h\"",
            "#include \"dns.h\"",
            "#include \"hostfile.h\"",
            "#include \"match.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"sshbuf.h\"",
            "#include \"uuencode.h\"",
            "#include \"authfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include <time.h>",
            "#include <locale.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include <openssl/pem.h>",
            "#include <openssl/evp.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "u_int64_t cert_valid_from = 0;",
            "u_int64_t cert_valid_to = ~0ULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"authfd.h\"\n#include \"utf8.h\"\n#include \"digest.h\"\n#include \"krl.h\"\n#include \"atomicio.h\"\n#include \"ssh-pkcs11.h\"\n#include \"ssherr.h\"\n#include \"ssh2.h\"\n#include \"ssh.h\"\n#include \"dns.h\"\n#include \"hostfile.h\"\n#include \"match.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"sshbuf.h\"\n#include \"uuencode.h\"\n#include \"authfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include <time.h>\n#include <locale.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/pem.h>\n#include <openssl/evp.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nu_int64_t cert_valid_from = 0;\nu_int64_t cert_valid_to = ~0ULL;\n\nstatic void\nparse_cert_times(char *timespec)\n{\n\tchar *from, *to;\n\ttime_t now = time(NULL);\n\tint64_t secs;\n\n\t/* +timespec relative to now */\n\tif (*timespec == '+' && strchr(timespec, ':') == NULL) {\n\t\tif ((secs = convtime(timespec + 1)) == -1)\n\t\t\tfatal(\"Invalid relative certificate life %s\", timespec);\n\t\tcert_valid_to = now + secs;\n\t\t/*\n\t\t * Backdate certificate one minute to avoid problems on hosts\n\t\t * with poorly-synchronised clocks.\n\t\t */\n\t\tcert_valid_from = ((now - 59)/ 60) * 60;\n\t\treturn;\n\t}\n\n\t/*\n\t * from:to, where\n\t * from := [+-]timespec | YYYYMMDD | YYYYMMDDHHMMSS | \"always\"\n\t *   to := [+-]timespec | YYYYMMDD | YYYYMMDDHHMMSS | \"forever\"\n\t */\n\tfrom = xstrdup(timespec);\n\tto = strchr(from, ':');\n\tif (to == NULL || from == to || *(to + 1) == '\\0')\n\t\tfatal(\"Invalid certificate life specification %s\", timespec);\n\t*to++ = '\\0';\n\n\tif (*from == '-' || *from == '+')\n\t\tcert_valid_from = parse_relative_time(from, now);\n\telse if (strcmp(from, \"always\") == 0)\n\t\tcert_valid_from = 0;\n\telse if (parse_absolute_time(from, &cert_valid_from) != 0)\n\t\tfatal(\"Invalid from time \\\"%s\\\"\", from);\n\n\tif (*to == '-' || *to == '+')\n\t\tcert_valid_to = parse_relative_time(to, now);\n\telse if (strcmp(to, \"forever\") == 0)\n\t\tcert_valid_to = ~(u_int64_t)0;\n\telse if (parse_absolute_time(to, &cert_valid_to) != 0)\n\t\tfatal(\"Invalid to time \\\"%s\\\"\", to);\n\n\tif (cert_valid_to <= cert_valid_from)\n\t\tfatal(\"Empty certificate validity interval\");\n\tfree(from);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sleep",
          "args": [
            "PAUSE_BEFORE_LOGOUT"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "usleep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-misc.c",
          "lines": "171-178",
          "snippet": "int usleep(unsigned int useconds)\n{\n\tstruct timespec ts;\n\n\tts.tv_sec = useconds / 1000000;\n\tts.tv_nsec = (useconds % 1000000) * 1000;\n\treturn nanosleep(&ts, NULL);\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "# include <sys/time.h>",
            "# include <sys/select.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <time.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <string.h>\n# include <sys/time.h>\n# include <sys/select.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint usleep(unsigned int useconds)\n{\n\tstruct timespec ts;\n\n\tts.tv_sec = useconds / 1000000;\n\tts.tv_nsec = (useconds % 1000000) * 1000;\n\treturn nanosleep(&ts, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "system",
          "args": [
            "cmdstring"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "login_login",
          "args": [
            "li1"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "login_login",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/loginrec.c",
          "lines": "233-238",
          "snippet": "int\nlogin_login(struct logininfo *li)\n{\n\tli->type = LTYPE_LOGIN;\n\treturn (login_write(li));\n}",
          "includes": [
            "# include <util.h>",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"auth.h\"",
            "#include \"canohost.h\"",
            "#include \"packet.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"loginrec.h\"",
            "#include \"ssh.h\"",
            "#include \"hostfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int utmp_write_entry(struct logininfo *li);",
            "int utmpx_write_entry(struct logininfo *li);",
            "int wtmp_write_entry(struct logininfo *li);",
            "int wtmpx_write_entry(struct logininfo *li);",
            "int lastlog_write_entry(struct logininfo *li);",
            "int syslogin_write_entry(struct logininfo *li);",
            "int getlast_entry(struct logininfo *li);",
            "int lastlog_get_entry(struct logininfo *li);",
            "int utmpx_get_entry(struct logininfo *li);",
            "int wtmp_get_entry(struct logininfo *li);",
            "int wtmpx_get_entry(struct logininfo *li);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <util.h>\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"auth.h\"\n#include \"canohost.h\"\n#include \"packet.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"loginrec.h\"\n#include \"ssh.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdarg.h>\n#include <pwd.h>\n# include <paths.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint utmp_write_entry(struct logininfo *li);\nint utmpx_write_entry(struct logininfo *li);\nint wtmp_write_entry(struct logininfo *li);\nint wtmpx_write_entry(struct logininfo *li);\nint lastlog_write_entry(struct logininfo *li);\nint syslogin_write_entry(struct logininfo *li);\nint getlast_entry(struct logininfo *li);\nint lastlog_get_entry(struct logininfo *li);\nint utmpx_get_entry(struct logininfo *li);\nint wtmp_get_entry(struct logininfo *li);\nint wtmpx_get_entry(struct logininfo *li);\n\nint\nlogin_login(struct logininfo *li)\n{\n\tli->type = LTYPE_LOGIN;\n\treturn (login_write(li));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ctime",
          "args": [
            "&logintime"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ctime",
          "args": [
            "&t1"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ctime",
          "args": [
            "&t0"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "login_write",
          "args": [
            "li1"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "syslogin_write_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/loginrec.c",
          "lines": "1446-1458",
          "snippet": "int\nsyslogin_write_entry(struct logininfo *li)\n{\n\tswitch (li->type) {\n\tcase LTYPE_LOGIN:\n\t\treturn (syslogin_perform_login(li));\n\tcase LTYPE_LOGOUT:\n\t\treturn (syslogin_perform_logout(li));\n\tdefault:\n\t\tlogit(\"%s: Invalid type field\", __func__);\n\t\treturn (0);\n\t}\n}",
          "includes": [
            "# include <util.h>",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"auth.h\"",
            "#include \"canohost.h\"",
            "#include \"packet.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"loginrec.h\"",
            "#include \"ssh.h\"",
            "#include \"hostfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int utmp_write_entry(struct logininfo *li);",
            "int utmpx_write_entry(struct logininfo *li);",
            "int wtmp_write_entry(struct logininfo *li);",
            "int wtmpx_write_entry(struct logininfo *li);",
            "int lastlog_write_entry(struct logininfo *li);",
            "int syslogin_write_entry(struct logininfo *li);",
            "int getlast_entry(struct logininfo *li);",
            "int lastlog_get_entry(struct logininfo *li);",
            "int utmpx_get_entry(struct logininfo *li);",
            "int wtmp_get_entry(struct logininfo *li);",
            "int wtmpx_get_entry(struct logininfo *li);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <util.h>\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"auth.h\"\n#include \"canohost.h\"\n#include \"packet.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"loginrec.h\"\n#include \"ssh.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdarg.h>\n#include <pwd.h>\n# include <paths.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint utmp_write_entry(struct logininfo *li);\nint utmpx_write_entry(struct logininfo *li);\nint wtmp_write_entry(struct logininfo *li);\nint wtmpx_write_entry(struct logininfo *li);\nint lastlog_write_entry(struct logininfo *li);\nint syslogin_write_entry(struct logininfo *li);\nint getlast_entry(struct logininfo *li);\nint lastlog_get_entry(struct logininfo *li);\nint utmpx_get_entry(struct logininfo *li);\nint wtmp_get_entry(struct logininfo *li);\nint wtmpx_get_entry(struct logininfo *li);\n\nint\nsyslogin_write_entry(struct logininfo *li)\n{\n\tswitch (li->type) {\n\tcase LTYPE_LOGIN:\n\t\treturn (syslogin_perform_login(li));\n\tcase LTYPE_LOGOUT:\n\t\treturn (syslogin_perform_logout(li));\n\tdefault:\n\t\tlogit(\"%s: Invalid type field\", __func__);\n\t\treturn (0);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "line_stripname",
          "args": [
            "stripline",
            "li1->line",
            "sizeof(stripline)"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "line_stripname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/loginrec.c",
          "lines": "577-586",
          "snippet": "char *\nline_stripname(char *dst, const char *src, int dstsize)\n{\n\tmemset(dst, '\\0', dstsize);\n\tif (strncmp(src, \"/dev/\", 5) == 0)\n\t\tstrlcpy(dst, src + 5, dstsize);\n\telse\n\t\tstrlcpy(dst, src, dstsize);\n\treturn (dst);\n}",
          "includes": [
            "# include <util.h>",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"auth.h\"",
            "#include \"canohost.h\"",
            "#include \"packet.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"loginrec.h\"",
            "#include \"ssh.h\"",
            "#include \"hostfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <util.h>\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"auth.h\"\n#include \"canohost.h\"\n#include \"packet.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"loginrec.h\"\n#include \"ssh.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdarg.h>\n#include <pwd.h>\n# include <paths.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *\nline_stripname(char *dst, const char *src, int dstsize)\n{\n\tmemset(dst, '\\0', dstsize);\n\tif (strncmp(src, \"/dev/\", 5) == 0)\n\t\tstrlcpy(dst, src + 5, dstsize);\n\telse\n\t\tstrlcpy(dst, src, dstsize);\n\treturn (dst);\n}"
        }
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dump_logininfo",
          "args": [
            "li1",
            "\"li1\""
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "dump_logininfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/logintest.c",
          "lines": "60-80",
          "snippet": "void\ndump_logininfo(struct logininfo *li, char *descname)\n{\n\t/* yes I know how nasty this is */\n\tprintf(\"struct logininfo %s = {\\n\\t\"\n\t       \"progname\\t'%s'\\n\\ttype\\t\\t%d\\n\\t\"\n\t       \"pid\\t\\t%d\\n\\tuid\\t\\t%d\\n\\t\"\n\t       \"line\\t\\t'%s'\\n\\tusername\\t'%s'\\n\\t\"\n\t       \"hostname\\t'%s'\\n\\texit\\t\\t%d\\n\\ttermination\\t%d\\n\\t\"\n\t       \"tv_sec\\t%d\\n\\ttv_usec\\t%d\\n\\t\"\n\t       \"struct login_netinfo hostaddr {\\n\\t\\t\"\n\t       \"struct sockaddr sa {\\n\"\n\t       \"\\t\\t\\tfamily\\t%d\\n\\t\\t}\\n\"\n\t       \"\\t}\\n\"\n\t       \"}\\n\",\n\t       descname, li->progname, li->type,\n\t       li->pid, li->uid, li->line,\n\t       li->username, li->hostname, li->exit,\n\t       li->termination, li->tv_sec, li->tv_usec,\n\t       li->hostaddr.sa.sa_family);\n}",
          "includes": [
            "#include \"loginrec.h\"",
            "#include <time.h>",
            "#include <netdb.h>",
            "#include <pwd.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <unistd.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include <sys/wait.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"loginrec.h\"\n#include <time.h>\n#include <netdb.h>\n#include <pwd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <sys/wait.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndump_logininfo(struct logininfo *li, char *descname)\n{\n\t/* yes I know how nasty this is */\n\tprintf(\"struct logininfo %s = {\\n\\t\"\n\t       \"progname\\t'%s'\\n\\ttype\\t\\t%d\\n\\t\"\n\t       \"pid\\t\\t%d\\n\\tuid\\t\\t%d\\n\\t\"\n\t       \"line\\t\\t'%s'\\n\\tusername\\t'%s'\\n\\t\"\n\t       \"hostname\\t'%s'\\n\\texit\\t\\t%d\\n\\ttermination\\t%d\\n\\t\"\n\t       \"tv_sec\\t%d\\n\\ttv_usec\\t%d\\n\\t\"\n\t       \"struct login_netinfo hostaddr {\\n\\t\\t\"\n\t       \"struct sockaddr sa {\\n\"\n\t       \"\\t\\t\\tfamily\\t%d\\n\\t\\t}\\n\"\n\t       \"\\t}\\n\"\n\t       \"}\\n\",\n\t       descname, li->progname, li->type,\n\t       li->pid, li->uid, li->line,\n\t       li->username, li->hostname, li->exit,\n\t       li->termination, li->tv_sec, li->tv_usec,\n\t       li->hostaddr.sa.sa_family);\n}"
        }
      },
      {
        "call_info": {
          "callee": "login_set_addr",
          "args": [
            "li1",
            "(struct sockaddr *) &sa_in4",
            "sizeof(sa_in4)"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "login_set_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/loginrec.c",
          "lines": "418-429",
          "snippet": "void\nlogin_set_addr(struct logininfo *li, const struct sockaddr *sa,\n    const unsigned int sa_size)\n{\n\tunsigned int bufsize = sa_size;\n\n\t/* make sure we don't overrun our union */\n\tif (sizeof(li->hostaddr) < sa_size)\n\t\tbufsize = sizeof(li->hostaddr);\n\n\tmemcpy(&li->hostaddr.sa, sa, bufsize);\n}",
          "includes": [
            "# include <util.h>",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"auth.h\"",
            "#include \"canohost.h\"",
            "#include \"packet.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"loginrec.h\"",
            "#include \"ssh.h\"",
            "#include \"hostfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int utmp_write_entry(struct logininfo *li);",
            "int utmpx_write_entry(struct logininfo *li);",
            "int wtmp_write_entry(struct logininfo *li);",
            "int wtmpx_write_entry(struct logininfo *li);",
            "int lastlog_write_entry(struct logininfo *li);",
            "int syslogin_write_entry(struct logininfo *li);",
            "int getlast_entry(struct logininfo *li);",
            "int lastlog_get_entry(struct logininfo *li);",
            "int utmpx_get_entry(struct logininfo *li);",
            "int wtmp_get_entry(struct logininfo *li);",
            "int wtmpx_get_entry(struct logininfo *li);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <util.h>\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"auth.h\"\n#include \"canohost.h\"\n#include \"packet.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"loginrec.h\"\n#include \"ssh.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdarg.h>\n#include <pwd.h>\n# include <paths.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint utmp_write_entry(struct logininfo *li);\nint utmpx_write_entry(struct logininfo *li);\nint wtmp_write_entry(struct logininfo *li);\nint wtmpx_write_entry(struct logininfo *li);\nint lastlog_write_entry(struct logininfo *li);\nint syslogin_write_entry(struct logininfo *li);\nint getlast_entry(struct logininfo *li);\nint lastlog_get_entry(struct logininfo *li);\nint utmpx_get_entry(struct logininfo *li);\nint wtmp_get_entry(struct logininfo *li);\nint wtmpx_get_entry(struct logininfo *li);\n\nvoid\nlogin_set_addr(struct logininfo *li, const struct sockaddr *sa,\n    const unsigned int sa_size)\n{\n\tunsigned int bufsize = sa_size;\n\n\t/* make sure we don't overrun our union */\n\tif (sizeof(li->hostaddr) < sa_size)\n\t\tbufsize = sizeof(li->hostaddr);\n\n\tmemcpy(&li->hostaddr.sa, sa, bufsize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "(void *)&(sa_in4.sin_addr)",
            "(void *)&(he->h_addr_list[0][0])",
            "sizeof(struct in_addr)"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gethostbyname",
          "args": [
            "\"localhost\""
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "login_alloc_entry",
          "args": [
            "(int)getpid()",
            "username",
            "NULL",
            "ttyname(0)"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "login_alloc_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/loginrec.c",
          "lines": "341-350",
          "snippet": "struct\nlogininfo *login_alloc_entry(pid_t pid, const char *username,\n    const char *hostname, const char *line)\n{\n\tstruct logininfo *newli;\n\n\tnewli = xmalloc(sizeof(*newli));\n\tlogin_init_entry(newli, pid, username, hostname, line);\n\treturn (newli);\n}",
          "includes": [
            "# include <util.h>",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"auth.h\"",
            "#include \"canohost.h\"",
            "#include \"packet.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"loginrec.h\"",
            "#include \"ssh.h\"",
            "#include \"hostfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <util.h>\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"auth.h\"\n#include \"canohost.h\"\n#include \"packet.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"loginrec.h\"\n#include \"ssh.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdarg.h>\n#include <pwd.h>\n# include <paths.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct\nlogininfo *login_alloc_entry(pid_t pid, const char *username,\n    const char *hostname, const char *line)\n{\n\tstruct logininfo *newli;\n\n\tnewli = xmalloc(sizeof(*newli));\n\tlogin_init_entry(newli, pid, username, hostname, line);\n\treturn (newli);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ttyname",
          "args": [
            "0"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpid",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpwuid",
          "args": [
            "getuid()"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"loginrec.h\"\n#include <time.h>\n#include <netdb.h>\n#include <pwd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <sys/wait.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define PAUSE_BEFORE_LOGOUT 3\n\nint nologtest = 0;\nint be_verbose = 0;\n\nint\ntestAPI()\n{\n\tstruct logininfo *li1;\n\tstruct passwd *pw;\n\tstruct hostent *he;\n\tstruct sockaddr_in sa_in4;\n\tchar cmdstring[256], stripline[8];\n\tchar username[32];\n#ifdef HAVE_TIME_H\n\ttime_t t0, t1, t2, logintime, logouttime;\n\tchar s_t0[64],s_t1[64],s_t2[64];\n\tchar s_logintime[64], s_logouttime[64]; /* ctime() strings */\n#endif\n\n\tprintf(\"**\\n** Testing the API...\\n**\\n\");\n\n\tpw = getpwuid(getuid());\n\tstrlcpy(username, pw->pw_name, sizeof(username));\n\n\t/* gethostname(hostname, sizeof(hostname)); */\n\n\tprintf(\"login_alloc_entry test (no host info):\\n\");\n\n\t/* FIXME fake tty more effectively - this could upset some platforms */\n\tli1 = login_alloc_entry((int)getpid(), username, NULL, ttyname(0));\n\tstrlcpy(li1->progname, \"OpenSSH-logintest\", sizeof(li1->progname));\n\n\tif (be_verbose)\n\t\tdump_logininfo(li1, \"li1\");\n\n\tprintf(\"Setting host address info for 'localhost' (may call out):\\n\");\n\tif (! (he = gethostbyname(\"localhost\"))) {\n\t\tprintf(\"Couldn't set hostname(lookup failed)\\n\");\n\t} else {\n\t\t/* NOTE: this is messy, but typically a program wouldn't have to set\n\t\t *  any of this, a sockaddr_in* would be already prepared */\n\t\tmemcpy((void *)&(sa_in4.sin_addr), (void *)&(he->h_addr_list[0][0]),\n\t\t       sizeof(struct in_addr));\n\t\tlogin_set_addr(li1, (struct sockaddr *) &sa_in4, sizeof(sa_in4));\n\t\tstrlcpy(li1->hostname, \"localhost\", sizeof(li1->hostname));\n\t}\n\tif (be_verbose)\n\t\tdump_logininfo(li1, \"li1\");\n\n\tif ((int)geteuid() != 0) {\n\t\tprintf(\"NOT RUNNING LOGIN TESTS - you are not root!\\n\");\n\t\treturn 1;\n\t}\n\n\tif (nologtest)\n\t\treturn 1;\n\n\tline_stripname(stripline, li1->line, sizeof(stripline));\n\n\tprintf(\"Performing an invalid login attempt (no type field)\\n--\\n\");\n\tlogin_write(li1);\n\tprintf(\"--\\n(Should have written errors to stderr)\\n\");\n\n#ifdef HAVE_TIME_H\n\t(void)time(&t0);\n\tstrlcpy(s_t0, ctime(&t0), sizeof(s_t0));\n\tt1 = login_get_lastlog_time(getuid());\n\tstrlcpy(s_t1, ctime(&t1), sizeof(s_t1));\n\tprintf(\"Before logging in:\\n\\tcurrent time is %d - %s\\t\"\n\t       \"lastlog time is %d - %s\\n\",\n\t       (int)t0, s_t0, (int)t1, s_t1);\n#endif\n\n\tprintf(\"Performing a login on line %s \", stripline);\n#ifdef HAVE_TIME_H\n\t(void)time(&logintime);\n\tstrlcpy(s_logintime, ctime(&logintime), sizeof(s_logintime));\n\tprintf(\"at %d - %s\", (int)logintime, s_logintime);\n#endif\n\tprintf(\"--\\n\");\n\tlogin_login(li1);\n\n\tsnprintf(cmdstring, sizeof(cmdstring), \"who | grep '%s '\",\n\t\t stripline);\n\tsystem(cmdstring);\n\n\tprintf(\"--\\nPausing for %d second(s)...\\n\", PAUSE_BEFORE_LOGOUT);\n\tsleep(PAUSE_BEFORE_LOGOUT);\n\n\tprintf(\"Performing a logout \");\n#ifdef HAVE_TIME_H\n\t(void)time(&logouttime);\n\tstrlcpy(s_logouttime, ctime(&logouttime), sizeof(s_logouttime));\n\tprintf(\"at %d - %s\", (int)logouttime, s_logouttime);\n#endif\n\tprintf(\"\\nThe root login shown above should be gone.\\n\"\n\t       \"If the root login hasn't gone, but another user on the same\\n\"\n\t       \"pty has, this is OK - we're hacking it here, and there\\n\"\n\t       \"shouldn't be two users on one pty in reality...\\n\"\n\t       \"-- ('who' output follows)\\n\");\n\tlogin_logout(li1);\n\n\tsystem(cmdstring);\n\tprintf(\"-- ('who' output ends)\\n\");\n\n#ifdef HAVE_TIME_H\n\tt2 = login_get_lastlog_time(getuid());\n\tstrlcpy(s_t2, ctime(&t2), sizeof(s_t2));\n\tprintf(\"After logging in, lastlog time is %d - %s\\n\", (int)t2, s_t2);\n\tif (t1 == t2)\n\t\tprintf(\"The lastlog times before and after logging in are the \"\n\t\t       \"same.\\nThis indicates that lastlog is ** NOT WORKING \"\n\t\t       \"CORRECTLY **\\n\");\n\telse if (t0 != t2)\n\t\t/* We can be off by a second or so, even when recording works fine.\n\t\t * I'm not 100% sure why, but it's true. */\n\t\tprintf(\"** The login time and the lastlog time differ.\\n\"\n\t\t       \"** This indicates that lastlog is either recording the \"\n\t\t       \"wrong time,\\n** or retrieving the wrong entry.\\n\"\n\t\t       \"If it's off by less than %d second(s) \"\n\t\t       \"run the test again.\\n\", PAUSE_BEFORE_LOGOUT);\n\telse\n\t\tprintf(\"lastlog agrees with the login time. This is a good thing.\\n\");\n\n#endif\n\n\tprintf(\"--\\nThe output of 'last' shown next should have \"\n\t       \"an entry for root \\n  on %s for the time shown above:\\n--\\n\",\n\t       stripline);\n\tsnprintf(cmdstring, sizeof(cmdstring), \"last | grep '%s ' | head -3\",\n\t\t stripline);\n\tsystem(cmdstring);\n\n\tprintf(\"--\\nEnd of login test.\\n\");\n\n\tlogin_free_entry(li1);\n\n\treturn 1;\n}"
  },
  {
    "function_name": "dump_logininfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/logintest.c",
    "lines": "60-80",
    "snippet": "void\ndump_logininfo(struct logininfo *li, char *descname)\n{\n\t/* yes I know how nasty this is */\n\tprintf(\"struct logininfo %s = {\\n\\t\"\n\t       \"progname\\t'%s'\\n\\ttype\\t\\t%d\\n\\t\"\n\t       \"pid\\t\\t%d\\n\\tuid\\t\\t%d\\n\\t\"\n\t       \"line\\t\\t'%s'\\n\\tusername\\t'%s'\\n\\t\"\n\t       \"hostname\\t'%s'\\n\\texit\\t\\t%d\\n\\ttermination\\t%d\\n\\t\"\n\t       \"tv_sec\\t%d\\n\\ttv_usec\\t%d\\n\\t\"\n\t       \"struct login_netinfo hostaddr {\\n\\t\\t\"\n\t       \"struct sockaddr sa {\\n\"\n\t       \"\\t\\t\\tfamily\\t%d\\n\\t\\t}\\n\"\n\t       \"\\t}\\n\"\n\t       \"}\\n\",\n\t       descname, li->progname, li->type,\n\t       li->pid, li->uid, li->line,\n\t       li->username, li->hostname, li->exit,\n\t       li->termination, li->tv_sec, li->tv_usec,\n\t       li->hostaddr.sa.sa_family);\n}",
    "includes": [
      "#include \"loginrec.h\"",
      "#include <time.h>",
      "#include <netdb.h>",
      "#include <pwd.h>",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <unistd.h>",
      "#include <netinet/in.h>",
      "#include <sys/socket.h>",
      "#include <sys/wait.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"struct logininfo %s = {\\n\\t\"\n\t       \"progname\\t'%s'\\n\\ttype\\t\\t%d\\n\\t\"\n\t       \"pid\\t\\t%d\\n\\tuid\\t\\t%d\\n\\t\"\n\t       \"line\\t\\t'%s'\\n\\tusername\\t'%s'\\n\\t\"\n\t       \"hostname\\t'%s'\\n\\texit\\t\\t%d\\n\\ttermination\\t%d\\n\\t\"\n\t       \"tv_sec\\t%d\\n\\ttv_usec\\t%d\\n\\t\"\n\t       \"struct login_netinfo hostaddr {\\n\\t\\t\"\n\t       \"struct sockaddr sa {\\n\"\n\t       \"\\t\\t\\tfamily\\t%d\\n\\t\\t}\\n\"\n\t       \"\\t}\\n\"\n\t       \"}\\n\"",
            "descname",
            "li->progname",
            "li->type",
            "li->pid",
            "li->uid",
            "li->line",
            "li->username",
            "li->hostname",
            "li->exit",
            "li->termination",
            "li->tv_sec",
            "li->tv_usec",
            "li->hostaddr.sa.sa_family"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "xasprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "104-118",
          "snippet": "int\nxasprintf(char **ret, const char *fmt, ...)\n{\n\tva_list ap;\n\tint i;\n\n\tva_start(ap, fmt);\n\ti = vasprintf(ret, fmt, ap);\n\tva_end(ap);\n\n\tif (i < 0 || *ret == NULL)\n\t\tfatal(\"xasprintf: could not allocate memory\");\n\n\treturn (i);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nint\nxasprintf(char **ret, const char *fmt, ...)\n{\n\tva_list ap;\n\tint i;\n\n\tva_start(ap, fmt);\n\ti = vasprintf(ret, fmt, ap);\n\tva_end(ap);\n\n\tif (i < 0 || *ret == NULL)\n\t\tfatal(\"xasprintf: could not allocate memory\");\n\n\treturn (i);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"loginrec.h\"\n#include <time.h>\n#include <netdb.h>\n#include <pwd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <sys/wait.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndump_logininfo(struct logininfo *li, char *descname)\n{\n\t/* yes I know how nasty this is */\n\tprintf(\"struct logininfo %s = {\\n\\t\"\n\t       \"progname\\t'%s'\\n\\ttype\\t\\t%d\\n\\t\"\n\t       \"pid\\t\\t%d\\n\\tuid\\t\\t%d\\n\\t\"\n\t       \"line\\t\\t'%s'\\n\\tusername\\t'%s'\\n\\t\"\n\t       \"hostname\\t'%s'\\n\\texit\\t\\t%d\\n\\ttermination\\t%d\\n\\t\"\n\t       \"tv_sec\\t%d\\n\\ttv_usec\\t%d\\n\\t\"\n\t       \"struct login_netinfo hostaddr {\\n\\t\\t\"\n\t       \"struct sockaddr sa {\\n\"\n\t       \"\\t\\t\\tfamily\\t%d\\n\\t\\t}\\n\"\n\t       \"\\t}\\n\"\n\t       \"}\\n\",\n\t       descname, li->progname, li->type,\n\t       li->pid, li->uid, li->line,\n\t       li->username, li->hostname, li->exit,\n\t       li->termination, li->tv_sec, li->tv_usec,\n\t       li->hostaddr.sa.sa_family);\n}"
  }
]