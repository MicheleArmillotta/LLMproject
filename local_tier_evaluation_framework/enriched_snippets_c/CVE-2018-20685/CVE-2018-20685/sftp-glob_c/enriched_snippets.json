[
  {
    "function_name": "remote_glob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-glob.c",
    "lines": "136-150",
    "snippet": "int\nremote_glob(struct sftp_conn *conn, const char *pattern, int flags,\n    int (*errfunc)(const char *, int), glob_t *pglob)\n{\n\tpglob->gl_opendir = fudge_opendir;\n\tpglob->gl_readdir = (struct dirent *(*)(void *))fudge_readdir;\n\tpglob->gl_closedir = (void (*)(void *))fudge_closedir;\n\tpglob->gl_lstat = fudge_lstat;\n\tpglob->gl_stat = fudge_stat;\n\n\tmemset(&cur, 0, sizeof(cur));\n\tcur.conn = conn;\n\n\treturn(glob(pattern, flags | GLOB_ALTDIRFUNC, errfunc, pglob));\n}",
    "includes": [
      "#include \"sftp-client.h\"",
      "#include \"sftp-common.h\"",
      "#include \"sftp.h\"",
      "#include \"xmalloc.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <dirent.h>",
      "# include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int remote_glob(struct sftp_conn *, const char *, int,\n    int (*)(const char *, int), glob_t *);",
      "static struct {\n\tstruct sftp_conn *conn;\n} cur;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "glob",
          "args": [
            "pattern",
            "flags | GLOB_ALTDIRFUNC",
            "errfunc",
            "pglob"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "do_globbed_ls",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp.c",
          "lines": "929-1033",
          "snippet": "static int\ndo_globbed_ls(struct sftp_conn *conn, const char *path,\n    const char *strip_path, int lflag)\n{\n\tchar *fname, *lname;\n\tglob_t g;\n\tint err, r;\n\tstruct winsize ws;\n\tu_int i, j, nentries, *indices = NULL, c = 1;\n\tu_int colspace = 0, columns = 1, m = 0, width = 80;\n\n\tmemset(&g, 0, sizeof(g));\n\n\tif ((r = remote_glob(conn, path,\n\t    GLOB_MARK|GLOB_NOCHECK|GLOB_BRACE|GLOB_KEEPSTAT|GLOB_NOSORT,\n\t    NULL, &g)) != 0 ||\n\t    (g.gl_pathc && !g.gl_matchc)) {\n\t\tif (g.gl_pathc)\n\t\t\tglobfree(&g);\n\t\tif (r == GLOB_NOSPACE) {\n\t\t\terror(\"Can't ls: Too many matches for \\\"%s\\\"\", path);\n\t\t} else {\n\t\t\terror(\"Can't ls: \\\"%s\\\" not found\", path);\n\t\t}\n\t\treturn -1;\n\t}\n\n\tif (interrupted)\n\t\tgoto out;\n\n\t/*\n\t * If the glob returns a single match and it is a directory,\n\t * then just list its contents.\n\t */\n\tif (g.gl_matchc == 1 && g.gl_statv[0] != NULL &&\n\t    S_ISDIR(g.gl_statv[0]->st_mode)) {\n\t\terr = do_ls_dir(conn, g.gl_pathv[0], strip_path, lflag);\n\t\tglobfree(&g);\n\t\treturn err;\n\t}\n\n\tif (ioctl(fileno(stdin), TIOCGWINSZ, &ws) != -1)\n\t\twidth = ws.ws_col;\n\n\tif (!(lflag & LS_SHORT_VIEW)) {\n\t\t/* Count entries for sort and find longest filename */\n\t\tfor (i = 0; g.gl_pathv[i]; i++)\n\t\t\tm = MAXIMUM(m, strlen(g.gl_pathv[i]));\n\n\t\tcolumns = width / (m + 2);\n\t\tcolumns = MAXIMUM(columns, 1);\n\t\tcolspace = width / columns;\n\t}\n\n\t/*\n\t * Sorting: rather than mess with the contents of glob_t, prepare\n\t * an array of indices into it and sort that. For the usual\n\t * unsorted case, the indices are just the identity 1=1, 2=2, etc.\n\t */\n\tfor (nentries = 0; g.gl_pathv[nentries] != NULL; nentries++)\n\t\t;\t/* count entries */\n\tindices = calloc(nentries, sizeof(*indices));\n\tfor (i = 0; i < nentries; i++)\n\t\tindices[i] = i;\n\n\tif (lflag & SORT_FLAGS) {\n\t\tsort_glob = &g;\n\t\tsort_flag = lflag & (SORT_FLAGS|LS_REVERSE_SORT);\n\t\tqsort(indices, nentries, sizeof(*indices), sglob_comp);\n\t\tsort_glob = NULL;\n\t}\n\n\tfor (j = 0; j < nentries && !interrupted; j++) {\n\t\ti = indices[j];\n\t\tfname = path_strip(g.gl_pathv[i], strip_path);\n\t\tif (lflag & LS_LONG_VIEW) {\n\t\t\tif (g.gl_statv[i] == NULL) {\n\t\t\t\terror(\"no stat information for %s\", fname);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlname = ls_file(fname, g.gl_statv[i], 1,\n\t\t\t    (lflag & LS_SI_UNITS));\n\t\t\tmprintf(\"%s\\n\", lname);\n\t\t\tfree(lname);\n\t\t} else {\n\t\t\tmprintf(\"%-*s\", colspace, fname);\n\t\t\tif (c >= columns) {\n\t\t\t\tprintf(\"\\n\");\n\t\t\t\tc = 1;\n\t\t\t} else\n\t\t\t\tc++;\n\t\t}\n\t\tfree(fname);\n\t}\n\n\tif (!(lflag & LS_LONG_VIEW) && (c != 1))\n\t\tprintf(\"\\n\");\n\n out:\n\tif (g.gl_pathc)\n\t\tglobfree(&g);\n\tfree(indices);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"sftp-client.h\"",
            "#include \"sftp-common.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"sftp.h\"",
            "#include \"utf8.h\"",
            "#include \"misc.h\"",
            "#include \"pathnames.h\"",
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "# include <util.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <histedit.h>",
            "# include <locale.h>",
            "#include <libgen.h>",
            "# include <paths.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <sys/statvfs.h>",
            "#include <sys/wait.h>",
            "#include <sys/socket.h>",
            "#include <sys/param.h>",
            "# include <sys/stat.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define SORT_FLAGS\t(LS_NAME_SORT|LS_TIME_SORT|LS_SIZE_SORT)",
            "#define LS_SI_UNITS\t0x0100\t/* Display sizes as K, M, G, etc. */",
            "#define LS_REVERSE_SORT\t0x0040\t/* Reverse sort order */",
            "#define LS_SHORT_VIEW\t0x0002\t/* Single row view ala ls -1 */",
            "#define LS_LONG_VIEW\t0x0001\t/* Full view ala ls -l */"
          ],
          "globals_used": [
            "volatile sig_atomic_t interrupted = 0;",
            "int sort_flag;",
            "glob_t *sort_glob;",
            "int remote_glob(struct sftp_conn *, const char *, int,\n    int (*)(const char *, int), glob_t *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sftp-client.h\"\n#include \"sftp-common.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"sftp.h\"\n#include \"utf8.h\"\n#include \"misc.h\"\n#include \"pathnames.h\"\n#include \"log.h\"\n#include \"xmalloc.h\"\n# include <util.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <signal.h>\n#include <limits.h>\n#include <histedit.h>\n# include <locale.h>\n#include <libgen.h>\n# include <paths.h>\n#include <errno.h>\n#include <ctype.h>\n#include <sys/statvfs.h>\n#include <sys/wait.h>\n#include <sys/socket.h>\n#include <sys/param.h>\n# include <sys/stat.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define SORT_FLAGS\t(LS_NAME_SORT|LS_TIME_SORT|LS_SIZE_SORT)\n#define LS_SI_UNITS\t0x0100\t/* Display sizes as K, M, G, etc. */\n#define LS_REVERSE_SORT\t0x0040\t/* Reverse sort order */\n#define LS_SHORT_VIEW\t0x0002\t/* Single row view ala ls -1 */\n#define LS_LONG_VIEW\t0x0001\t/* Full view ala ls -l */\n\nvolatile sig_atomic_t interrupted = 0;\nint sort_flag;\nglob_t *sort_glob;\nint remote_glob(struct sftp_conn *, const char *, int,\n    int (*)(const char *, int), glob_t *);\n\nstatic int\ndo_globbed_ls(struct sftp_conn *conn, const char *path,\n    const char *strip_path, int lflag)\n{\n\tchar *fname, *lname;\n\tglob_t g;\n\tint err, r;\n\tstruct winsize ws;\n\tu_int i, j, nentries, *indices = NULL, c = 1;\n\tu_int colspace = 0, columns = 1, m = 0, width = 80;\n\n\tmemset(&g, 0, sizeof(g));\n\n\tif ((r = remote_glob(conn, path,\n\t    GLOB_MARK|GLOB_NOCHECK|GLOB_BRACE|GLOB_KEEPSTAT|GLOB_NOSORT,\n\t    NULL, &g)) != 0 ||\n\t    (g.gl_pathc && !g.gl_matchc)) {\n\t\tif (g.gl_pathc)\n\t\t\tglobfree(&g);\n\t\tif (r == GLOB_NOSPACE) {\n\t\t\terror(\"Can't ls: Too many matches for \\\"%s\\\"\", path);\n\t\t} else {\n\t\t\terror(\"Can't ls: \\\"%s\\\" not found\", path);\n\t\t}\n\t\treturn -1;\n\t}\n\n\tif (interrupted)\n\t\tgoto out;\n\n\t/*\n\t * If the glob returns a single match and it is a directory,\n\t * then just list its contents.\n\t */\n\tif (g.gl_matchc == 1 && g.gl_statv[0] != NULL &&\n\t    S_ISDIR(g.gl_statv[0]->st_mode)) {\n\t\terr = do_ls_dir(conn, g.gl_pathv[0], strip_path, lflag);\n\t\tglobfree(&g);\n\t\treturn err;\n\t}\n\n\tif (ioctl(fileno(stdin), TIOCGWINSZ, &ws) != -1)\n\t\twidth = ws.ws_col;\n\n\tif (!(lflag & LS_SHORT_VIEW)) {\n\t\t/* Count entries for sort and find longest filename */\n\t\tfor (i = 0; g.gl_pathv[i]; i++)\n\t\t\tm = MAXIMUM(m, strlen(g.gl_pathv[i]));\n\n\t\tcolumns = width / (m + 2);\n\t\tcolumns = MAXIMUM(columns, 1);\n\t\tcolspace = width / columns;\n\t}\n\n\t/*\n\t * Sorting: rather than mess with the contents of glob_t, prepare\n\t * an array of indices into it and sort that. For the usual\n\t * unsorted case, the indices are just the identity 1=1, 2=2, etc.\n\t */\n\tfor (nentries = 0; g.gl_pathv[nentries] != NULL; nentries++)\n\t\t;\t/* count entries */\n\tindices = calloc(nentries, sizeof(*indices));\n\tfor (i = 0; i < nentries; i++)\n\t\tindices[i] = i;\n\n\tif (lflag & SORT_FLAGS) {\n\t\tsort_glob = &g;\n\t\tsort_flag = lflag & (SORT_FLAGS|LS_REVERSE_SORT);\n\t\tqsort(indices, nentries, sizeof(*indices), sglob_comp);\n\t\tsort_glob = NULL;\n\t}\n\n\tfor (j = 0; j < nentries && !interrupted; j++) {\n\t\ti = indices[j];\n\t\tfname = path_strip(g.gl_pathv[i], strip_path);\n\t\tif (lflag & LS_LONG_VIEW) {\n\t\t\tif (g.gl_statv[i] == NULL) {\n\t\t\t\terror(\"no stat information for %s\", fname);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlname = ls_file(fname, g.gl_statv[i], 1,\n\t\t\t    (lflag & LS_SI_UNITS));\n\t\t\tmprintf(\"%s\\n\", lname);\n\t\t\tfree(lname);\n\t\t} else {\n\t\t\tmprintf(\"%-*s\", colspace, fname);\n\t\t\tif (c >= columns) {\n\t\t\t\tprintf(\"\\n\");\n\t\t\t\tc = 1;\n\t\t\t} else\n\t\t\t\tc++;\n\t\t}\n\t\tfree(fname);\n\t}\n\n\tif (!(lflag & LS_LONG_VIEW) && (c != 1))\n\t\tprintf(\"\\n\");\n\n out:\n\tif (g.gl_pathc)\n\t\tglobfree(&g);\n\tfree(indices);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&cur",
            "0",
            "sizeof(cur)"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sftp-client.h\"\n#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"xmalloc.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <dirent.h>\n# include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint remote_glob(struct sftp_conn *, const char *, int,\n    int (*)(const char *, int), glob_t *);\nstatic struct {\n\tstruct sftp_conn *conn;\n} cur;\n\nint\nremote_glob(struct sftp_conn *conn, const char *pattern, int flags,\n    int (*errfunc)(const char *, int), glob_t *pglob)\n{\n\tpglob->gl_opendir = fudge_opendir;\n\tpglob->gl_readdir = (struct dirent *(*)(void *))fudge_readdir;\n\tpglob->gl_closedir = (void (*)(void *))fudge_closedir;\n\tpglob->gl_lstat = fudge_lstat;\n\tpglob->gl_stat = fudge_stat;\n\n\tmemset(&cur, 0, sizeof(cur));\n\tcur.conn = conn;\n\n\treturn(glob(pattern, flags | GLOB_ALTDIRFUNC, errfunc, pglob));\n}"
  },
  {
    "function_name": "fudge_stat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-glob.c",
    "lines": "123-134",
    "snippet": "static int\nfudge_stat(const char *path, struct stat *st)\n{\n\tAttrib *a;\n\n\tif (!(a = do_stat(cur.conn, (char *)path, 1)))\n\t\treturn(-1);\n\n\tattrib_to_stat(a, st);\n\n\treturn(0);\n}",
    "includes": [
      "#include \"sftp-client.h\"",
      "#include \"sftp-common.h\"",
      "#include \"sftp.h\"",
      "#include \"xmalloc.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <dirent.h>",
      "# include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct {\n\tstruct sftp_conn *conn;\n} cur;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "attrib_to_stat",
          "args": [
            "a",
            "st"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "attrib_to_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-common.c",
          "lines": "84-101",
          "snippet": "void\nattrib_to_stat(const Attrib *a, struct stat *st)\n{\n\tmemset(st, 0, sizeof(*st));\n\n\tif (a->flags & SSH2_FILEXFER_ATTR_SIZE)\n\t\tst->st_size = a->size;\n\tif (a->flags & SSH2_FILEXFER_ATTR_UIDGID) {\n\t\tst->st_uid = a->uid;\n\t\tst->st_gid = a->gid;\n\t}\n\tif (a->flags & SSH2_FILEXFER_ATTR_PERMISSIONS)\n\t\tst->st_mode = a->perm;\n\tif (a->flags & SSH2_FILEXFER_ATTR_ACMODTIME) {\n\t\tst->st_atime = a->atime;\n\t\tst->st_mtime = a->mtime;\n\t}\n}",
          "includes": [
            "#include \"sftp-common.h\"",
            "#include \"sftp.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <util.h>",
            "#include <stdarg.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <util.h>\n#include <stdarg.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <grp.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nattrib_to_stat(const Attrib *a, struct stat *st)\n{\n\tmemset(st, 0, sizeof(*st));\n\n\tif (a->flags & SSH2_FILEXFER_ATTR_SIZE)\n\t\tst->st_size = a->size;\n\tif (a->flags & SSH2_FILEXFER_ATTR_UIDGID) {\n\t\tst->st_uid = a->uid;\n\t\tst->st_gid = a->gid;\n\t}\n\tif (a->flags & SSH2_FILEXFER_ATTR_PERMISSIONS)\n\t\tst->st_mode = a->perm;\n\tif (a->flags & SSH2_FILEXFER_ATTR_ACMODTIME) {\n\t\tst->st_atime = a->atime;\n\t\tst->st_mtime = a->mtime;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_stat",
          "args": [
            "cur.conn",
            "(char *)path",
            "1"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "do_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-client.c",
          "lines": "742-754",
          "snippet": "Attrib *\ndo_stat(struct sftp_conn *conn, const char *path, int quiet)\n{\n\tu_int id;\n\n\tid = conn->msg_id++;\n\n\tsend_string_request(conn, id,\n\t    conn->version == 0 ? SSH2_FXP_STAT_VERSION_0 : SSH2_FXP_STAT,\n\t    path, strlen(path));\n\n\treturn(get_decode_stat(conn, id, quiet));\n}",
          "includes": [
            "#include \"sftp-client.h\"",
            "#include \"sftp-common.h\"",
            "#include \"sftp.h\"",
            "#include \"utf8.h\"",
            "#include \"misc.h\"",
            "#include \"progressmeter.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <sys/uio.h>",
            "# include <sys/time.h>",
            "# include <sys/stat.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sftp-client.h\"\n#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"utf8.h\"\n#include \"misc.h\"\n#include \"progressmeter.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <sys/uio.h>\n# include <sys/time.h>\n# include <sys/stat.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/statvfs.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nAttrib *\ndo_stat(struct sftp_conn *conn, const char *path, int quiet)\n{\n\tu_int id;\n\n\tid = conn->msg_id++;\n\n\tsend_string_request(conn, id,\n\t    conn->version == 0 ? SSH2_FXP_STAT_VERSION_0 : SSH2_FXP_STAT,\n\t    path, strlen(path));\n\n\treturn(get_decode_stat(conn, id, quiet));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sftp-client.h\"\n#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"xmalloc.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <dirent.h>\n# include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic struct {\n\tstruct sftp_conn *conn;\n} cur;\n\nstatic int\nfudge_stat(const char *path, struct stat *st)\n{\n\tAttrib *a;\n\n\tif (!(a = do_stat(cur.conn, (char *)path, 1)))\n\t\treturn(-1);\n\n\tattrib_to_stat(a, st);\n\n\treturn(0);\n}"
  },
  {
    "function_name": "fudge_lstat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-glob.c",
    "lines": "110-121",
    "snippet": "static int\nfudge_lstat(const char *path, struct stat *st)\n{\n\tAttrib *a;\n\n\tif (!(a = do_lstat(cur.conn, (char *)path, 1)))\n\t\treturn(-1);\n\n\tattrib_to_stat(a, st);\n\n\treturn(0);\n}",
    "includes": [
      "#include \"sftp-client.h\"",
      "#include \"sftp-common.h\"",
      "#include \"sftp.h\"",
      "#include \"xmalloc.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <dirent.h>",
      "# include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct {\n\tstruct sftp_conn *conn;\n} cur;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "attrib_to_stat",
          "args": [
            "a",
            "st"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "attrib_to_stat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-common.c",
          "lines": "84-101",
          "snippet": "void\nattrib_to_stat(const Attrib *a, struct stat *st)\n{\n\tmemset(st, 0, sizeof(*st));\n\n\tif (a->flags & SSH2_FILEXFER_ATTR_SIZE)\n\t\tst->st_size = a->size;\n\tif (a->flags & SSH2_FILEXFER_ATTR_UIDGID) {\n\t\tst->st_uid = a->uid;\n\t\tst->st_gid = a->gid;\n\t}\n\tif (a->flags & SSH2_FILEXFER_ATTR_PERMISSIONS)\n\t\tst->st_mode = a->perm;\n\tif (a->flags & SSH2_FILEXFER_ATTR_ACMODTIME) {\n\t\tst->st_atime = a->atime;\n\t\tst->st_mtime = a->mtime;\n\t}\n}",
          "includes": [
            "#include \"sftp-common.h\"",
            "#include \"sftp.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <util.h>",
            "#include <stdarg.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <util.h>\n#include <stdarg.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <grp.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nattrib_to_stat(const Attrib *a, struct stat *st)\n{\n\tmemset(st, 0, sizeof(*st));\n\n\tif (a->flags & SSH2_FILEXFER_ATTR_SIZE)\n\t\tst->st_size = a->size;\n\tif (a->flags & SSH2_FILEXFER_ATTR_UIDGID) {\n\t\tst->st_uid = a->uid;\n\t\tst->st_gid = a->gid;\n\t}\n\tif (a->flags & SSH2_FILEXFER_ATTR_PERMISSIONS)\n\t\tst->st_mode = a->perm;\n\tif (a->flags & SSH2_FILEXFER_ATTR_ACMODTIME) {\n\t\tst->st_atime = a->atime;\n\t\tst->st_mtime = a->mtime;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_lstat",
          "args": [
            "cur.conn",
            "(char *)path",
            "1"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "do_lstat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-client.c",
          "lines": "756-774",
          "snippet": "Attrib *\ndo_lstat(struct sftp_conn *conn, const char *path, int quiet)\n{\n\tu_int id;\n\n\tif (conn->version == 0) {\n\t\tif (quiet)\n\t\t\tdebug(\"Server version does not support lstat operation\");\n\t\telse\n\t\t\tlogit(\"Server version does not support lstat operation\");\n\t\treturn(do_stat(conn, path, quiet));\n\t}\n\n\tid = conn->msg_id++;\n\tsend_string_request(conn, id, SSH2_FXP_LSTAT, path,\n\t    strlen(path));\n\n\treturn(get_decode_stat(conn, id, quiet));\n}",
          "includes": [
            "#include \"sftp-client.h\"",
            "#include \"sftp-common.h\"",
            "#include \"sftp.h\"",
            "#include \"utf8.h\"",
            "#include \"misc.h\"",
            "#include \"progressmeter.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <sys/uio.h>",
            "# include <sys/time.h>",
            "# include <sys/stat.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sftp-client.h\"\n#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"utf8.h\"\n#include \"misc.h\"\n#include \"progressmeter.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <sys/uio.h>\n# include <sys/time.h>\n# include <sys/stat.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/statvfs.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nAttrib *\ndo_lstat(struct sftp_conn *conn, const char *path, int quiet)\n{\n\tu_int id;\n\n\tif (conn->version == 0) {\n\t\tif (quiet)\n\t\t\tdebug(\"Server version does not support lstat operation\");\n\t\telse\n\t\t\tlogit(\"Server version does not support lstat operation\");\n\t\treturn(do_stat(conn, path, quiet));\n\t}\n\n\tid = conn->msg_id++;\n\tsend_string_request(conn, id, SSH2_FXP_LSTAT, path,\n\t    strlen(path));\n\n\treturn(get_decode_stat(conn, id, quiet));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sftp-client.h\"\n#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"xmalloc.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <dirent.h>\n# include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic struct {\n\tstruct sftp_conn *conn;\n} cur;\n\nstatic int\nfudge_lstat(const char *path, struct stat *st)\n{\n\tAttrib *a;\n\n\tif (!(a = do_lstat(cur.conn, (char *)path, 1)))\n\t\treturn(-1);\n\n\tattrib_to_stat(a, st);\n\n\treturn(0);\n}"
  },
  {
    "function_name": "fudge_closedir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-glob.c",
    "lines": "103-108",
    "snippet": "static void\nfudge_closedir(struct SFTP_OPENDIR *od)\n{\n\tfree_sftp_dirents(od->dir);\n\tfree(od);\n}",
    "includes": [
      "#include \"sftp-client.h\"",
      "#include \"sftp-common.h\"",
      "#include \"sftp.h\"",
      "#include \"xmalloc.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <dirent.h>",
      "# include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "od"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "freeze",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/smult_curve25519_ref.c",
          "lines": "50-60",
          "snippet": "static void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [
            "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;"
          ],
          "called_functions": [],
          "contextual_snippet": "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;\n\nstatic void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_sftp_dirents",
          "args": [
            "od->dir"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "free_sftp_dirents",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-client.c",
          "lines": "681-693",
          "snippet": "void free_sftp_dirents(SFTP_DIRENT **s)\n{\n\tint i;\n\n\tif (s == NULL)\n\t\treturn;\n\tfor (i = 0; s[i]; i++) {\n\t\tfree(s[i]->filename);\n\t\tfree(s[i]->longname);\n\t\tfree(s[i]);\n\t}\n\tfree(s);\n}",
          "includes": [
            "#include \"sftp-client.h\"",
            "#include \"sftp-common.h\"",
            "#include \"sftp.h\"",
            "#include \"utf8.h\"",
            "#include \"misc.h\"",
            "#include \"progressmeter.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <sys/uio.h>",
            "# include <sys/time.h>",
            "# include <sys/stat.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sftp-client.h\"\n#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"utf8.h\"\n#include \"misc.h\"\n#include \"progressmeter.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <sys/uio.h>\n# include <sys/time.h>\n# include <sys/stat.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/statvfs.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid free_sftp_dirents(SFTP_DIRENT **s)\n{\n\tint i;\n\n\tif (s == NULL)\n\t\treturn;\n\tfor (i = 0; s[i]; i++) {\n\t\tfree(s[i]->filename);\n\t\tfree(s[i]->longname);\n\t\tfree(s[i]);\n\t}\n\tfree(s);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sftp-client.h\"\n#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"xmalloc.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <dirent.h>\n# include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic void\nfudge_closedir(struct SFTP_OPENDIR *od)\n{\n\tfree_sftp_dirents(od->dir);\n\tfree(od);\n}"
  },
  {
    "function_name": "fudge_readdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-glob.c",
    "lines": "64-101",
    "snippet": "static struct dirent *\nfudge_readdir(struct SFTP_OPENDIR *od)\n{\n\t/* Solaris needs sizeof(dirent) + path length (see below) */\n\tstatic char buf[sizeof(struct dirent) + MAXPATHLEN];\n\tstruct dirent *ret = (struct dirent *)buf;\n#ifdef __GNU_LIBRARY__\n\tstatic int inum = 1;\n#endif /* __GNU_LIBRARY__ */\n\n\tif (od->dir[od->offset] == NULL)\n\t\treturn(NULL);\n\n\tmemset(buf, 0, sizeof(buf));\n\n\t/*\n\t * Solaris defines dirent->d_name as a one byte array and expects\n\t * you to hack around it.\n\t */\n#ifdef BROKEN_ONE_BYTE_DIRENT_D_NAME\n\tstrlcpy(ret->d_name, od->dir[od->offset++]->filename, MAXPATHLEN);\n#else\n\tstrlcpy(ret->d_name, od->dir[od->offset++]->filename,\n\t    sizeof(ret->d_name));\n#endif\n#ifdef __GNU_LIBRARY__\n\t/*\n\t * Idiot glibc uses extensions to struct dirent for readdir with\n\t * ALTDIRFUNCs. Not that this is documented anywhere but the\n\t * source... Fake an inode number to appease it.\n\t */\n\tret->d_ino = inum++;\n\tif (!inum)\n\t\tinum = 1;\n#endif /* __GNU_LIBRARY__ */\n\n\treturn(ret);\n}",
    "includes": [
      "#include \"sftp-client.h\"",
      "#include \"sftp-common.h\"",
      "#include \"sftp.h\"",
      "#include \"xmalloc.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <dirent.h>",
      "# include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "ret->d_name",
            "od->dir[od->offset++]->filename",
            "sizeof(ret->d_name)"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "strlcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strlcpy.c",
          "lines": "32-56",
          "snippet": "size_t\nstrlcpy(char *dst, const char *src, size_t siz)\n{\n\tchar *d = dst;\n\tconst char *s = src;\n\tsize_t n = siz;\n\n\t/* Copy as many bytes as will fit */\n\tif (n != 0) {\n\t\twhile (--n != 0) {\n\t\t\tif ((*d++ = *s++) == '\\0')\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* Not enough room in dst, add NUL and traverse rest of src */\n\tif (n == 0) {\n\t\tif (siz != 0)\n\t\t\t*d = '\\0';\t\t/* NUL-terminate dst */\n\t\twhile (*s++)\n\t\t\t;\n\t}\n\n\treturn(s - src - 1);\t/* count does not include NUL */\n}",
          "includes": [
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nstrlcpy(char *dst, const char *src, size_t siz)\n{\n\tchar *d = dst;\n\tconst char *s = src;\n\tsize_t n = siz;\n\n\t/* Copy as many bytes as will fit */\n\tif (n != 0) {\n\t\twhile (--n != 0) {\n\t\t\tif ((*d++ = *s++) == '\\0')\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* Not enough room in dst, add NUL and traverse rest of src */\n\tif (n == 0) {\n\t\tif (siz != 0)\n\t\t\t*d = '\\0';\t\t/* NUL-terminate dst */\n\t\twhile (*s++)\n\t\t\t;\n\t}\n\n\treturn(s - src - 1);\t/* count does not include NUL */\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "buf",
            "0",
            "sizeof(buf)"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sftp-client.h\"\n#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"xmalloc.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <dirent.h>\n# include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic struct dirent *\nfudge_readdir(struct SFTP_OPENDIR *od)\n{\n\t/* Solaris needs sizeof(dirent) + path length (see below) */\n\tstatic char buf[sizeof(struct dirent) + MAXPATHLEN];\n\tstruct dirent *ret = (struct dirent *)buf;\n#ifdef __GNU_LIBRARY__\n\tstatic int inum = 1;\n#endif /* __GNU_LIBRARY__ */\n\n\tif (od->dir[od->offset] == NULL)\n\t\treturn(NULL);\n\n\tmemset(buf, 0, sizeof(buf));\n\n\t/*\n\t * Solaris defines dirent->d_name as a one byte array and expects\n\t * you to hack around it.\n\t */\n#ifdef BROKEN_ONE_BYTE_DIRENT_D_NAME\n\tstrlcpy(ret->d_name, od->dir[od->offset++]->filename, MAXPATHLEN);\n#else\n\tstrlcpy(ret->d_name, od->dir[od->offset++]->filename,\n\t    sizeof(ret->d_name));\n#endif\n#ifdef __GNU_LIBRARY__\n\t/*\n\t * Idiot glibc uses extensions to struct dirent for readdir with\n\t * ALTDIRFUNCs. Not that this is documented anywhere but the\n\t * source... Fake an inode number to appease it.\n\t */\n\tret->d_ino = inum++;\n\tif (!inum)\n\t\tinum = 1;\n#endif /* __GNU_LIBRARY__ */\n\n\treturn(ret);\n}"
  },
  {
    "function_name": "fudge_opendir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-glob.c",
    "lines": "47-62",
    "snippet": "static void *\nfudge_opendir(const char *path)\n{\n\tstruct SFTP_OPENDIR *r;\n\n\tr = xcalloc(1, sizeof(*r));\n\n\tif (do_readdir(cur.conn, (char *)path, &r->dir)) {\n\t\tfree(r);\n\t\treturn(NULL);\n\t}\n\n\tr->offset = 0;\n\n\treturn((void *)r);\n}",
    "includes": [
      "#include \"sftp-client.h\"",
      "#include \"sftp-common.h\"",
      "#include \"sftp.h\"",
      "#include \"xmalloc.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <dirent.h>",
      "# include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static struct {\n\tstruct sftp_conn *conn;\n} cur;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "r"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "freeze",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/smult_curve25519_ref.c",
          "lines": "50-60",
          "snippet": "static void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [
            "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;"
          ],
          "called_functions": [],
          "contextual_snippet": "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;\n\nstatic void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_readdir",
          "args": [
            "cur.conn",
            "(char *)path",
            "&r->dir"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "do_readdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-client.c",
          "lines": "675-679",
          "snippet": "int\ndo_readdir(struct sftp_conn *conn, const char *path, SFTP_DIRENT ***dir)\n{\n\treturn(do_lsreaddir(conn, path, 0, dir));\n}",
          "includes": [
            "#include \"sftp-client.h\"",
            "#include \"sftp-common.h\"",
            "#include \"sftp.h\"",
            "#include \"utf8.h\"",
            "#include \"misc.h\"",
            "#include \"progressmeter.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <sys/uio.h>",
            "# include <sys/time.h>",
            "# include <sys/stat.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/statvfs.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sftp-client.h\"\n#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"utf8.h\"\n#include \"misc.h\"\n#include \"progressmeter.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <sys/uio.h>\n# include <sys/time.h>\n# include <sys/stat.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/statvfs.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\ndo_readdir(struct sftp_conn *conn, const char *path, SFTP_DIRENT ***dir)\n{\n\treturn(do_lsreaddir(conn, path, 0, dir));\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcalloc",
          "args": [
            "1",
            "sizeof(*r)"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "xcalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "52-66",
          "snippet": "void *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxcalloc(size_t nmemb, size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0 || nmemb == 0)\n\t\tfatal(\"xcalloc: zero size\");\n\tif (SIZE_MAX / nmemb < size)\n\t\tfatal(\"xcalloc: nmemb * size > SIZE_MAX\");\n\tptr = calloc(nmemb, size);\n\tif (ptr == NULL)\n\t\tfatal(\"xcalloc: out of memory (allocating %zu bytes)\",\n\t\t    size * nmemb);\n\treturn ptr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sftp-client.h\"\n#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"xmalloc.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <stdlib.h>\n#include <dirent.h>\n# include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic struct {\n\tstruct sftp_conn *conn;\n} cur;\n\nstatic void *\nfudge_opendir(const char *path)\n{\n\tstruct SFTP_OPENDIR *r;\n\n\tr = xcalloc(1, sizeof(*r));\n\n\tif (do_readdir(cur.conn, (char *)path, &r->dir)) {\n\t\tfree(r);\n\t\treturn(NULL);\n\t}\n\n\tr->offset = 0;\n\n\treturn((void *)r);\n}"
  }
]