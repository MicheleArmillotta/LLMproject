[
  {
    "function_name": "tests",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/utf8/tests.c",
    "lines": "54-102",
    "snippet": "void\ntests(void)\n{\n\tchar\t*loc;\n\n\tTEST_START(\"utf8_setlocale\");\n\tloc = setlocale(LC_CTYPE, \"en_US.UTF-8\");\n\tASSERT_PTR_NE(loc, NULL);\n\tTEST_DONE();\n\n\tbadarg();\n\tone(1, \"empty\", \"\", 2, 0, 0, \"\");\n\tone(1, \"ascii\", \"x\", -2, -2, -2, \"x\");\n\tone(1, \"newline\", \"a\\nb\", -2, -2, -2, \"a\\nb\");\n\tone(1, \"cr\", \"a\\rb\", -2, -2, -2, \"a\\rb\");\n\tone(1, \"tab\", \"a\\tb\", -2, -2, -2, \"a\\tb\");\n\tone(1, \"esc\", \"\\033x\", -2, -2, -2, \"\\\\033x\");\n\tone(1, \"inv_badbyte\", \"\\377x\", -2, -2, -2, \"\\\\377x\");\n\tone(1, \"inv_nocont\", \"\\341x\", -2, -2, -2, \"\\\\341x\");\n\tone(1, \"inv_nolead\", \"a\\200b\", -2, -2, -2, \"a\\\\200b\");\n\tone(1, \"sz_ascii\", \"1234567890123456\", -2, -2, 16, \"123456789012345\");\n\tone(1, \"sz_esc\", \"123456789012\\033\", -2, -2, 16, \"123456789012\");\n\tone(1, \"width_ascii\", \"123\", 2, 2, -1, \"12\");\n\tone(1, \"width_double\", \"a\\343\\201\\201\", 2, 1, -1, \"a\");\n\tone(1, \"double_fit\", \"a\\343\\201\\201\", 3, 3, 4, \"a\\343\\201\\201\");\n\tone(1, \"double_spc\", \"a\\343\\201\\201\", 4, 3, 4, \"a\\343\\201\\201\");\n\n\tTEST_START(\"C_setlocale\");\n\tloc = setlocale(LC_CTYPE, \"C\");\n\tASSERT_PTR_NE(loc, NULL);\n\tTEST_DONE();\n\n\tbadarg();\n\tone(0, \"empty\", \"\", 2, 0, 0, \"\");\n\tone(0, \"ascii\", \"x\", -2, -2, -2, \"x\");\n\tone(0, \"newline\", \"a\\nb\", -2, -2, -2, \"a\\nb\");\n\tone(0, \"cr\", \"a\\rb\", -2, -2, -2, \"a\\rb\");\n\tone(0, \"tab\", \"a\\tb\", -2, -2, -2, \"a\\tb\");\n\tone(0, \"esc\", \"\\033x\", -2, -2, -2, \"\\\\033x\");\n\tone(0, \"inv_badbyte\", \"\\377x\", -2, -2, -2, \"\\\\377x\");\n\tone(0, \"inv_nocont\", \"\\341x\", -2, -2, -2, \"\\\\341x\");\n\tone(0, \"inv_nolead\", \"a\\200b\", -2, -2, -2, \"a\\\\200b\");\n\tone(0, \"sz_ascii\", \"1234567890123456\", -2, -2, 16, \"123456789012345\");\n\tone(0, \"sz_esc\", \"123456789012\\033\", -2, -2, 16, \"123456789012\");\n\tone(0, \"width_ascii\", \"123\", 2, 2, -1, \"12\");\n\tone(0, \"width_double\", \"a\\343\\201\\201\", 2, 1, -1, \"a\");\n\tone(0, \"double_fit\", \"a\\343\\201\\201\", 7, 5, -1, \"a\\\\343\");\n\tone(0, \"double_spc\", \"a\\343\\201\\201\", 13, 13, 13, \"a\\\\343\\\\201\\\\201\");\n}",
    "includes": [
      "#include \"utf8.h\"",
      "#include \"../test_helper/test_helper.h\"",
      "#include <string.h>",
      "#include <locale.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "one",
          "args": [
            "0",
            "\"double_spc\"",
            "\"a\\343\\201\\201\"",
            "13",
            "13",
            "13",
            "\"a\\\\343\\\\201\\\\201\""
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "one",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/utf8/tests.c",
          "lines": "33-52",
          "snippet": "static void\none(int utf8, const char *name, const char *mbs, int width,\n    int wantwidth, int wantlen, const char *wants)\n{\n\tchar\t buf[16];\n\tint\t*wp;\n\tint\t len;\n\n\tif (wantlen == -2)\n\t\twantlen = strlen(wants);\n\t(void)strlcpy(buf, utf8 ? \"utf8_\" : \"c_\", sizeof(buf));\n\t(void)strlcat(buf, name, sizeof(buf));\n\tTEST_START(buf);\n\twp = wantwidth == -2 ? NULL : &width;\n\tlen = snmprintf(buf, sizeof(buf), wp, \"%s\", mbs);\n\tASSERT_INT_EQ(len, wantlen);\n\tASSERT_STRING_EQ(buf, wants);\n\tASSERT_INT_EQ(width, wantwidth);\n\tTEST_DONE();\n}",
          "includes": [
            "#include \"utf8.h\"",
            "#include \"../test_helper/test_helper.h\"",
            "#include <string.h>",
            "#include <locale.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utf8.h\"\n#include \"../test_helper/test_helper.h\"\n#include <string.h>\n#include <locale.h>\n#include \"includes.h\"\n\nstatic void\none(int utf8, const char *name, const char *mbs, int width,\n    int wantwidth, int wantlen, const char *wants)\n{\n\tchar\t buf[16];\n\tint\t*wp;\n\tint\t len;\n\n\tif (wantlen == -2)\n\t\twantlen = strlen(wants);\n\t(void)strlcpy(buf, utf8 ? \"utf8_\" : \"c_\", sizeof(buf));\n\t(void)strlcat(buf, name, sizeof(buf));\n\tTEST_START(buf);\n\twp = wantwidth == -2 ? NULL : &width;\n\tlen = snmprintf(buf, sizeof(buf), wp, \"%s\", mbs);\n\tASSERT_INT_EQ(len, wantlen);\n\tASSERT_STRING_EQ(buf, wants);\n\tASSERT_INT_EQ(width, wantwidth);\n\tTEST_DONE();\n}"
        }
      },
      {
        "call_info": {
          "callee": "badarg",
          "args": [],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "badarg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/utf8/tests.c",
          "lines": "18-31",
          "snippet": "static void\nbadarg(void)\n{\n\tchar\t buf[16];\n\tint\t len, width;\n\n\twidth = 1;\n\tTEST_START(\"utf8_badarg\");\n\tlen = snmprintf(buf, sizeof(buf), &width, \"\\377\");\n\tASSERT_INT_EQ(len, -1);\n\tASSERT_STRING_EQ(buf, \"\");\n\tASSERT_INT_EQ(width, 0);\n\tTEST_DONE();\n}",
          "includes": [
            "#include \"utf8.h\"",
            "#include \"../test_helper/test_helper.h\"",
            "#include <string.h>",
            "#include <locale.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"utf8.h\"\n#include \"../test_helper/test_helper.h\"\n#include <string.h>\n#include <locale.h>\n#include \"includes.h\"\n\nstatic void\nbadarg(void)\n{\n\tchar\t buf[16];\n\tint\t len, width;\n\n\twidth = 1;\n\tTEST_START(\"utf8_badarg\");\n\tlen = snmprintf(buf, sizeof(buf), &width, \"\\377\");\n\tASSERT_INT_EQ(len, -1);\n\tASSERT_STRING_EQ(buf, \"\");\n\tASSERT_INT_EQ(width, 0);\n\tTEST_DONE();\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "loc",
            "NULL"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setlocale",
          "args": [
            "LC_CTYPE",
            "\"C\""
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"C_setlocale\""
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "loc",
            "NULL"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setlocale",
          "args": [
            "LC_CTYPE",
            "\"en_US.UTF-8\""
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"utf8_setlocale\""
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utf8.h\"\n#include \"../test_helper/test_helper.h\"\n#include <string.h>\n#include <locale.h>\n#include \"includes.h\"\n\nvoid\ntests(void)\n{\n\tchar\t*loc;\n\n\tTEST_START(\"utf8_setlocale\");\n\tloc = setlocale(LC_CTYPE, \"en_US.UTF-8\");\n\tASSERT_PTR_NE(loc, NULL);\n\tTEST_DONE();\n\n\tbadarg();\n\tone(1, \"empty\", \"\", 2, 0, 0, \"\");\n\tone(1, \"ascii\", \"x\", -2, -2, -2, \"x\");\n\tone(1, \"newline\", \"a\\nb\", -2, -2, -2, \"a\\nb\");\n\tone(1, \"cr\", \"a\\rb\", -2, -2, -2, \"a\\rb\");\n\tone(1, \"tab\", \"a\\tb\", -2, -2, -2, \"a\\tb\");\n\tone(1, \"esc\", \"\\033x\", -2, -2, -2, \"\\\\033x\");\n\tone(1, \"inv_badbyte\", \"\\377x\", -2, -2, -2, \"\\\\377x\");\n\tone(1, \"inv_nocont\", \"\\341x\", -2, -2, -2, \"\\\\341x\");\n\tone(1, \"inv_nolead\", \"a\\200b\", -2, -2, -2, \"a\\\\200b\");\n\tone(1, \"sz_ascii\", \"1234567890123456\", -2, -2, 16, \"123456789012345\");\n\tone(1, \"sz_esc\", \"123456789012\\033\", -2, -2, 16, \"123456789012\");\n\tone(1, \"width_ascii\", \"123\", 2, 2, -1, \"12\");\n\tone(1, \"width_double\", \"a\\343\\201\\201\", 2, 1, -1, \"a\");\n\tone(1, \"double_fit\", \"a\\343\\201\\201\", 3, 3, 4, \"a\\343\\201\\201\");\n\tone(1, \"double_spc\", \"a\\343\\201\\201\", 4, 3, 4, \"a\\343\\201\\201\");\n\n\tTEST_START(\"C_setlocale\");\n\tloc = setlocale(LC_CTYPE, \"C\");\n\tASSERT_PTR_NE(loc, NULL);\n\tTEST_DONE();\n\n\tbadarg();\n\tone(0, \"empty\", \"\", 2, 0, 0, \"\");\n\tone(0, \"ascii\", \"x\", -2, -2, -2, \"x\");\n\tone(0, \"newline\", \"a\\nb\", -2, -2, -2, \"a\\nb\");\n\tone(0, \"cr\", \"a\\rb\", -2, -2, -2, \"a\\rb\");\n\tone(0, \"tab\", \"a\\tb\", -2, -2, -2, \"a\\tb\");\n\tone(0, \"esc\", \"\\033x\", -2, -2, -2, \"\\\\033x\");\n\tone(0, \"inv_badbyte\", \"\\377x\", -2, -2, -2, \"\\\\377x\");\n\tone(0, \"inv_nocont\", \"\\341x\", -2, -2, -2, \"\\\\341x\");\n\tone(0, \"inv_nolead\", \"a\\200b\", -2, -2, -2, \"a\\\\200b\");\n\tone(0, \"sz_ascii\", \"1234567890123456\", -2, -2, 16, \"123456789012345\");\n\tone(0, \"sz_esc\", \"123456789012\\033\", -2, -2, 16, \"123456789012\");\n\tone(0, \"width_ascii\", \"123\", 2, 2, -1, \"12\");\n\tone(0, \"width_double\", \"a\\343\\201\\201\", 2, 1, -1, \"a\");\n\tone(0, \"double_fit\", \"a\\343\\201\\201\", 7, 5, -1, \"a\\\\343\");\n\tone(0, \"double_spc\", \"a\\343\\201\\201\", 13, 13, 13, \"a\\\\343\\\\201\\\\201\");\n}"
  },
  {
    "function_name": "one",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/utf8/tests.c",
    "lines": "33-52",
    "snippet": "static void\none(int utf8, const char *name, const char *mbs, int width,\n    int wantwidth, int wantlen, const char *wants)\n{\n\tchar\t buf[16];\n\tint\t*wp;\n\tint\t len;\n\n\tif (wantlen == -2)\n\t\twantlen = strlen(wants);\n\t(void)strlcpy(buf, utf8 ? \"utf8_\" : \"c_\", sizeof(buf));\n\t(void)strlcat(buf, name, sizeof(buf));\n\tTEST_START(buf);\n\twp = wantwidth == -2 ? NULL : &width;\n\tlen = snmprintf(buf, sizeof(buf), wp, \"%s\", mbs);\n\tASSERT_INT_EQ(len, wantlen);\n\tASSERT_STRING_EQ(buf, wants);\n\tASSERT_INT_EQ(width, wantwidth);\n\tTEST_DONE();\n}",
    "includes": [
      "#include \"utf8.h\"",
      "#include \"../test_helper/test_helper.h\"",
      "#include <string.h>",
      "#include <locale.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "width",
            "wantwidth"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_STRING_EQ",
          "args": [
            "buf",
            "wants"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "len",
            "wantlen"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snmprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "wp",
            "\"%s\"",
            "mbs"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "snmprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/utf8.c",
          "lines": "240-256",
          "snippet": "int\nsnmprintf(char *str, size_t sz, int *wp, const char *fmt, ...)\n{\n\tva_list\t ap;\n\tchar\t*cp;\n\tint\t ret;\n\n\tva_start(ap, fmt);\n\tret = vasnmprintf(&cp, sz, wp, fmt, ap);\n\tva_end(ap);\n\tif (cp != NULL) {\n\t\t(void)strlcpy(str, cp, sz);\n\t\tfree(cp);\n\t} else\n\t\t*str = '\\0';\n\treturn ret;\n}",
          "includes": [
            "#include \"utf8.h\"",
            "# include <wchar.h>",
            "# include <vis.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <locale.h>",
            "#include <limits.h>",
            "# include <langinfo.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\t grow_dst(char **, size_t *, size_t, char **, size_t);",
            "static int\t vasnmprintf(char **, size_t, int *, const char *, va_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utf8.h\"\n# include <wchar.h>\n# include <vis.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <locale.h>\n#include <limits.h>\n# include <langinfo.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\t grow_dst(char **, size_t *, size_t, char **, size_t);\nstatic int\t vasnmprintf(char **, size_t, int *, const char *, va_list);\n\nint\nsnmprintf(char *str, size_t sz, int *wp, const char *fmt, ...)\n{\n\tva_list\t ap;\n\tchar\t*cp;\n\tint\t ret;\n\n\tva_start(ap, fmt);\n\tret = vasnmprintf(&cp, sz, wp, fmt, ap);\n\tva_end(ap);\n\tif (cp != NULL) {\n\t\t(void)strlcpy(str, cp, sz);\n\t\tfree(cp);\n\t} else\n\t\t*str = '\\0';\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "buf"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlcat",
          "args": [
            "buf",
            "name",
            "sizeof(buf)"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "strlcat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strlcat.c",
          "lines": "34-60",
          "snippet": "size_t\nstrlcat(char *dst, const char *src, size_t siz)\n{\n\tchar *d = dst;\n\tconst char *s = src;\n\tsize_t n = siz;\n\tsize_t dlen;\n\n\t/* Find the end of dst and adjust bytes left but don't go past end */\n\twhile (n-- != 0 && *d != '\\0')\n\t\td++;\n\tdlen = d - dst;\n\tn = siz - dlen;\n\n\tif (n == 0)\n\t\treturn(dlen + strlen(s));\n\twhile (*s != '\\0') {\n\t\tif (n != 1) {\n\t\t\t*d++ = *s;\n\t\t\tn--;\n\t\t}\n\t\ts++;\n\t}\n\t*d = '\\0';\n\n\treturn(dlen + (s - src));\t/* count does not include NUL */\n}",
          "includes": [
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nstrlcat(char *dst, const char *src, size_t siz)\n{\n\tchar *d = dst;\n\tconst char *s = src;\n\tsize_t n = siz;\n\tsize_t dlen;\n\n\t/* Find the end of dst and adjust bytes left but don't go past end */\n\twhile (n-- != 0 && *d != '\\0')\n\t\td++;\n\tdlen = d - dst;\n\tn = siz - dlen;\n\n\tif (n == 0)\n\t\treturn(dlen + strlen(s));\n\twhile (*s != '\\0') {\n\t\tif (n != 1) {\n\t\t\t*d++ = *s;\n\t\t\tn--;\n\t\t}\n\t\ts++;\n\t}\n\t*d = '\\0';\n\n\treturn(dlen + (s - src));\t/* count does not include NUL */\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "buf",
            "utf8 ? \"utf8_\" : \"c_\"",
            "sizeof(buf)"
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "strlcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strlcpy.c",
          "lines": "32-56",
          "snippet": "size_t\nstrlcpy(char *dst, const char *src, size_t siz)\n{\n\tchar *d = dst;\n\tconst char *s = src;\n\tsize_t n = siz;\n\n\t/* Copy as many bytes as will fit */\n\tif (n != 0) {\n\t\twhile (--n != 0) {\n\t\t\tif ((*d++ = *s++) == '\\0')\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* Not enough room in dst, add NUL and traverse rest of src */\n\tif (n == 0) {\n\t\tif (siz != 0)\n\t\t\t*d = '\\0';\t\t/* NUL-terminate dst */\n\t\twhile (*s++)\n\t\t\t;\n\t}\n\n\treturn(s - src - 1);\t/* count does not include NUL */\n}",
          "includes": [
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nstrlcpy(char *dst, const char *src, size_t siz)\n{\n\tchar *d = dst;\n\tconst char *s = src;\n\tsize_t n = siz;\n\n\t/* Copy as many bytes as will fit */\n\tif (n != 0) {\n\t\twhile (--n != 0) {\n\t\t\tif ((*d++ = *s++) == '\\0')\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* Not enough room in dst, add NUL and traverse rest of src */\n\tif (n == 0) {\n\t\tif (siz != 0)\n\t\t\t*d = '\\0';\t\t/* NUL-terminate dst */\n\t\twhile (*s++)\n\t\t\t;\n\t}\n\n\treturn(s - src - 1);\t/* count does not include NUL */\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "wants"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utf8.h\"\n#include \"../test_helper/test_helper.h\"\n#include <string.h>\n#include <locale.h>\n#include \"includes.h\"\n\nstatic void\none(int utf8, const char *name, const char *mbs, int width,\n    int wantwidth, int wantlen, const char *wants)\n{\n\tchar\t buf[16];\n\tint\t*wp;\n\tint\t len;\n\n\tif (wantlen == -2)\n\t\twantlen = strlen(wants);\n\t(void)strlcpy(buf, utf8 ? \"utf8_\" : \"c_\", sizeof(buf));\n\t(void)strlcat(buf, name, sizeof(buf));\n\tTEST_START(buf);\n\twp = wantwidth == -2 ? NULL : &width;\n\tlen = snmprintf(buf, sizeof(buf), wp, \"%s\", mbs);\n\tASSERT_INT_EQ(len, wantlen);\n\tASSERT_STRING_EQ(buf, wants);\n\tASSERT_INT_EQ(width, wantwidth);\n\tTEST_DONE();\n}"
  },
  {
    "function_name": "badarg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/utf8/tests.c",
    "lines": "18-31",
    "snippet": "static void\nbadarg(void)\n{\n\tchar\t buf[16];\n\tint\t len, width;\n\n\twidth = 1;\n\tTEST_START(\"utf8_badarg\");\n\tlen = snmprintf(buf, sizeof(buf), &width, \"\\377\");\n\tASSERT_INT_EQ(len, -1);\n\tASSERT_STRING_EQ(buf, \"\");\n\tASSERT_INT_EQ(width, 0);\n\tTEST_DONE();\n}",
    "includes": [
      "#include \"utf8.h\"",
      "#include \"../test_helper/test_helper.h\"",
      "#include <string.h>",
      "#include <locale.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "width",
            "0"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_STRING_EQ",
          "args": [
            "buf",
            "\"\""
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "len",
            "-1"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snmprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "&width",
            "\"\\377\""
          ],
          "line": 26
        },
        "resolved": true,
        "details": {
          "function_name": "snmprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/utf8.c",
          "lines": "240-256",
          "snippet": "int\nsnmprintf(char *str, size_t sz, int *wp, const char *fmt, ...)\n{\n\tva_list\t ap;\n\tchar\t*cp;\n\tint\t ret;\n\n\tva_start(ap, fmt);\n\tret = vasnmprintf(&cp, sz, wp, fmt, ap);\n\tva_end(ap);\n\tif (cp != NULL) {\n\t\t(void)strlcpy(str, cp, sz);\n\t\tfree(cp);\n\t} else\n\t\t*str = '\\0';\n\treturn ret;\n}",
          "includes": [
            "#include \"utf8.h\"",
            "# include <wchar.h>",
            "# include <vis.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <locale.h>",
            "#include <limits.h>",
            "# include <langinfo.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int\t grow_dst(char **, size_t *, size_t, char **, size_t);",
            "static int\t vasnmprintf(char **, size_t, int *, const char *, va_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"utf8.h\"\n# include <wchar.h>\n# include <vis.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <locale.h>\n#include <limits.h>\n# include <langinfo.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\t grow_dst(char **, size_t *, size_t, char **, size_t);\nstatic int\t vasnmprintf(char **, size_t, int *, const char *, va_list);\n\nint\nsnmprintf(char *str, size_t sz, int *wp, const char *fmt, ...)\n{\n\tva_list\t ap;\n\tchar\t*cp;\n\tint\t ret;\n\n\tva_start(ap, fmt);\n\tret = vasnmprintf(&cp, sz, wp, fmt, ap);\n\tva_end(ap);\n\tif (cp != NULL) {\n\t\t(void)strlcpy(str, cp, sz);\n\t\tfree(cp);\n\t} else\n\t\t*str = '\\0';\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"utf8_badarg\""
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"utf8.h\"\n#include \"../test_helper/test_helper.h\"\n#include <string.h>\n#include <locale.h>\n#include \"includes.h\"\n\nstatic void\nbadarg(void)\n{\n\tchar\t buf[16];\n\tint\t len, width;\n\n\twidth = 1;\n\tTEST_START(\"utf8_badarg\");\n\tlen = snmprintf(buf, sizeof(buf), &width, \"\\377\");\n\tASSERT_INT_EQ(len, -1);\n\tASSERT_STRING_EQ(buf, \"\");\n\tASSERT_INT_EQ(width, 0);\n\tTEST_DONE();\n}"
  }
]