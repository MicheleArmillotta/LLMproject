[
  {
    "function_name": "_conv_num",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strptime.c",
    "lines": "377-398",
    "snippet": "static int\n_conv_num(const unsigned char **buf, int *dest, int llim, int ulim)\n{\n\tint result = 0;\n\tint rulim = ulim;\n\n\tif (**buf < '0' || **buf > '9')\n\t\treturn (0);\n\n\t/* we use rulim to break out of the loop when we run out of digits */\n\tdo {\n\t\tresult *= 10;\n\t\tresult += *(*buf)++ - '0';\n\t\trulim /= 10;\n\t} while ((result * 10 <= ulim) && rulim && **buf >= '0' && **buf <= '9');\n\n\tif (result < llim || result > ulim)\n\t\treturn (0);\n\n\t*dest = result;\n\treturn (1);\n}",
    "includes": [
      "#include <time.h>",
      "#include <string.h>",
      "#include <locale.h>",
      "#include <ctype.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <time.h>\n#include <string.h>\n#include <locale.h>\n#include <ctype.h>\n#include \"includes.h\"\n\nstatic int\n_conv_num(const unsigned char **buf, int *dest, int llim, int ulim)\n{\n\tint result = 0;\n\tint rulim = ulim;\n\n\tif (**buf < '0' || **buf > '9')\n\t\treturn (0);\n\n\t/* we use rulim to break out of the loop when we run out of digits */\n\tdo {\n\t\tresult *= 10;\n\t\tresult += *(*buf)++ - '0';\n\t\trulim /= 10;\n\t} while ((result * 10 <= ulim) && rulim && **buf >= '0' && **buf <= '9');\n\n\tif (result < llim || result > ulim)\n\t\treturn (0);\n\n\t*dest = result;\n\treturn (1);\n}"
  },
  {
    "function_name": "_strptime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strptime.c",
    "lines": "66-374",
    "snippet": "static char *\n_strptime(const char *buf, const char *fmt, struct tm *tm, int initialize)\n{\n\tunsigned char c;\n\tconst unsigned char *bp;\n\tsize_t len;\n\tint alt_format, i;\n\tstatic int century, relyear;\n\n\tif (initialize) {\n\t\tcentury = TM_YEAR_BASE;\n\t\trelyear = -1;\n\t}\n\n\tbp = (unsigned char *)buf;\n\twhile ((c = *fmt) != '\\0') {\n\t\t/* Clear `alternate' modifier prior to new conversion. */\n\t\talt_format = 0;\n\n\t\t/* Eat up white-space. */\n\t\tif (isspace(c)) {\n\t\t\twhile (isspace(*bp))\n\t\t\t\tbp++;\n\n\t\t\tfmt++;\n\t\t\tcontinue;\n\t\t}\n\t\t\t\t\n\t\tif ((c = *fmt++) != '%')\n\t\t\tgoto literal;\n\n\nagain:\t\tswitch (c = *fmt++) {\n\t\tcase '%':\t/* \"%%\" is converted to \"%\". */\nliteral:\n\t\tif (c != *bp++)\n\t\t\treturn (NULL);\n\n\t\tbreak;\n\n\t\t/*\n\t\t * \"Alternative\" modifiers. Just set the appropriate flag\n\t\t * and start over again.\n\t\t */\n\t\tcase 'E':\t/* \"%E?\" alternative conversion modifier. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\talt_format |= _ALT_E;\n\t\t\tgoto again;\n\n\t\tcase 'O':\t/* \"%O?\" alternative conversion modifier. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\talt_format |= _ALT_O;\n\t\t\tgoto again;\n\t\t\t\n\t\t/*\n\t\t * \"Complex\" conversion rules, implemented through recursion.\n\t\t */\n#if 0\n\t\tcase 'c':\t/* Date and time, using the locale's format. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(bp = _strptime(bp, _ctloc(d_t_fmt), tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n#endif\n\t\tcase 'D':\t/* The date as \"%m/%d/%y\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%m/%d/%y\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\t\n\t\tcase 'R':\t/* The time as \"%H:%M\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%H:%M\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'r':\t/* The time as \"%I:%M:%S %p\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%I:%M:%S %p\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'T':\t/* The time as \"%H:%M:%S\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%H:%M:%S\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n#if 0\n\t\tcase 'X':\t/* The time, using the locale's format. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(bp = _strptime(bp, _ctloc(t_fmt), tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'x':\t/* The date, using the locale's format. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(bp = _strptime(bp, _ctloc(d_fmt), tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n#endif\n\t\t/*\n\t\t * \"Elementary\" conversion rules.\n\t\t */\n#if 0\n\t\tcase 'A':\t/* The day of week, using the locale's form. */\n\t\tcase 'a':\n\t\t\t_LEGAL_ALT(0);\n\t\t\tfor (i = 0; i < 7; i++) {\n\t\t\t\t/* Full name. */\n\t\t\t\tlen = strlen(_ctloc(day[i]));\n\t\t\t\tif (strncasecmp(_ctloc(day[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\n\t\t\t\t/* Abbreviated name. */\n\t\t\t\tlen = strlen(_ctloc(abday[i]));\n\t\t\t\tif (strncasecmp(_ctloc(abday[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Nothing matched. */\n\t\t\tif (i == 7)\n\t\t\t\treturn (NULL);\n\n\t\t\ttm->tm_wday = i;\n\t\t\tbp += len;\n\t\t\tbreak;\n\n\t\tcase 'B':\t/* The month, using the locale's form. */\n\t\tcase 'b':\n\t\tcase 'h':\n\t\t\t_LEGAL_ALT(0);\n\t\t\tfor (i = 0; i < 12; i++) {\n\t\t\t\t/* Full name. */\n\t\t\t\tlen = strlen(_ctloc(mon[i]));\n\t\t\t\tif (strncasecmp(_ctloc(mon[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\n\t\t\t\t/* Abbreviated name. */\n\t\t\t\tlen = strlen(_ctloc(abmon[i]));\n\t\t\t\tif (strncasecmp(_ctloc(abmon[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Nothing matched. */\n\t\t\tif (i == 12)\n\t\t\t\treturn (NULL);\n\n\t\t\ttm->tm_mon = i;\n\t\t\tbp += len;\n\t\t\tbreak;\n#endif\n\n\t\tcase 'C':\t/* The century number. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(_conv_num(&bp, &i, 0, 99)))\n\t\t\t\treturn (NULL);\n\n\t\t\tcentury = i * 100;\n\t\t\tbreak;\n\n\t\tcase 'd':\t/* The day of month. */\n\t\tcase 'e':\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_mday, 1, 31)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'k':\t/* The hour (24-hour clock representation). */\n\t\t\t_LEGAL_ALT(0);\n\t\t\t/* FALLTHROUGH */\n\t\tcase 'H':\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_hour, 0, 23)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'l':\t/* The hour (12-hour clock representation). */\n\t\t\t_LEGAL_ALT(0);\n\t\t\t/* FALLTHROUGH */\n\t\tcase 'I':\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_hour, 1, 12)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'j':\t/* The day of year. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_yday, 1, 366)))\n\t\t\t\treturn (NULL);\n\t\t\ttm->tm_yday--;\n\t\t\tbreak;\n\n\t\tcase 'M':\t/* The minute. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_min, 0, 59)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'm':\t/* The month. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_mon, 1, 12)))\n\t\t\t\treturn (NULL);\n\t\t\ttm->tm_mon--;\n\t\t\tbreak;\n\n#if 0\n\t\tcase 'p':\t/* The locale's equivalent of AM/PM. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\t/* AM? */\n\t\t\tlen = strlen(_ctloc(am_pm[0]));\n\t\t\tif (strncasecmp(_ctloc(am_pm[0]), bp, len) == 0) {\n\t\t\t\tif (tm->tm_hour > 12)\t/* i.e., 13:00 AM ?! */\n\t\t\t\t\treturn (NULL);\n\t\t\t\telse if (tm->tm_hour == 12)\n\t\t\t\t\ttm->tm_hour = 0;\n\n\t\t\t\tbp += len;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* PM? */\n\t\t\tlen = strlen(_ctloc(am_pm[1]));\n\t\t\tif (strncasecmp(_ctloc(am_pm[1]), bp, len) == 0) {\n\t\t\t\tif (tm->tm_hour > 12)\t/* i.e., 13:00 PM ?! */\n\t\t\t\t\treturn (NULL);\n\t\t\t\telse if (tm->tm_hour < 12)\n\t\t\t\t\ttm->tm_hour += 12;\n\n\t\t\t\tbp += len;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Nothing matched. */\n\t\t\treturn (NULL);\n#endif\n\t\tcase 'S':\t/* The seconds. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_sec, 0, 61)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'U':\t/* The week of year, beginning on sunday. */\n\t\tcase 'W':\t/* The week of year, beginning on monday. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\t/*\n\t\t\t * XXX This is bogus, as we can not assume any valid\n\t\t\t * information present in the tm structure at this\n\t\t\t * point to calculate a real value, so just check the\n\t\t\t * range for now.\n\t\t\t */\n\t\t\t if (!(_conv_num(&bp, &i, 0, 53)))\n\t\t\t\treturn (NULL);\n\t\t\t break;\n\n\t\tcase 'w':\t/* The day of week, beginning on sunday. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_wday, 0, 6)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'Y':\t/* The year. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(_conv_num(&bp, &i, 0, 9999)))\n\t\t\t\treturn (NULL);\n\n\t\t\trelyear = -1;\n\t\t\ttm->tm_year = i - TM_YEAR_BASE;\n\t\t\tbreak;\n\n\t\tcase 'y':\t/* The year within the century (2 digits). */\n\t\t\t_LEGAL_ALT(_ALT_E | _ALT_O);\n\t\t\tif (!(_conv_num(&bp, &relyear, 0, 99)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\t/*\n\t\t * Miscellaneous conversions.\n\t\t */\n\t\tcase 'n':\t/* Any kind of white-space. */\n\t\tcase 't':\n\t\t\t_LEGAL_ALT(0);\n\t\t\twhile (isspace(*bp))\n\t\t\t\tbp++;\n\t\t\tbreak;\n\n\n\t\tdefault:\t/* Unknown/unsupported conversion. */\n\t\t\treturn (NULL);\n\t\t}\n\n\n\t}\n\n\t/*\n\t * We need to evaluate the two digit year spec (%y)\n\t * last as we can get a century spec (%C) at any time.\n\t */\n\tif (relyear != -1) {\n\t\tif (century == TM_YEAR_BASE) {\n\t\t\tif (relyear <= 68)\n\t\t\t\ttm->tm_year = relyear + 2000 - TM_YEAR_BASE;\n\t\t\telse\n\t\t\t\ttm->tm_year = relyear + 1900 - TM_YEAR_BASE;\n\t\t} else {\n\t\t\ttm->tm_year = relyear + century - TM_YEAR_BASE;\n\t\t}\n\t}\n\n\treturn ((char *)bp);\n}",
    "includes": [
      "#include <time.h>",
      "#include <string.h>",
      "#include <locale.h>",
      "#include <ctype.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define _ALT_O\t\t\t0x02",
      "#define _ALT_E\t\t\t0x01",
      "#define TM_YEAR_BASE 1900\t/* from tzfile.h */"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "*bp"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "0"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_conv_num",
          "args": [
            "&bp",
            "&relyear",
            "0",
            "99"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "_conv_num",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strptime.c",
          "lines": "377-398",
          "snippet": "static int\n_conv_num(const unsigned char **buf, int *dest, int llim, int ulim)\n{\n\tint result = 0;\n\tint rulim = ulim;\n\n\tif (**buf < '0' || **buf > '9')\n\t\treturn (0);\n\n\t/* we use rulim to break out of the loop when we run out of digits */\n\tdo {\n\t\tresult *= 10;\n\t\tresult += *(*buf)++ - '0';\n\t\trulim /= 10;\n\t} while ((result * 10 <= ulim) && rulim && **buf >= '0' && **buf <= '9');\n\n\tif (result < llim || result > ulim)\n\t\treturn (0);\n\n\t*dest = result;\n\treturn (1);\n}",
          "includes": [
            "#include <time.h>",
            "#include <string.h>",
            "#include <locale.h>",
            "#include <ctype.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <string.h>\n#include <locale.h>\n#include <ctype.h>\n#include \"includes.h\"\n\nstatic int\n_conv_num(const unsigned char **buf, int *dest, int llim, int ulim)\n{\n\tint result = 0;\n\tint rulim = ulim;\n\n\tif (**buf < '0' || **buf > '9')\n\t\treturn (0);\n\n\t/* we use rulim to break out of the loop when we run out of digits */\n\tdo {\n\t\tresult *= 10;\n\t\tresult += *(*buf)++ - '0';\n\t\trulim /= 10;\n\t} while ((result * 10 <= ulim) && rulim && **buf >= '0' && **buf <= '9');\n\n\tif (result < llim || result > ulim)\n\t\treturn (0);\n\n\t*dest = result;\n\treturn (1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "_ALT_E | _ALT_O"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "_ALT_E"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "_ALT_O"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "_ALT_O"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "_ALT_O"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncasecmp",
          "args": [
            "_ctloc(am_pm[1])",
            "bp",
            "len"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ctloc",
          "args": [
            "am_pm[1]"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "_ctloc(am_pm[1])"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ctloc",
          "args": [
            "am_pm[1]"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncasecmp",
          "args": [
            "_ctloc(am_pm[0])",
            "bp",
            "len"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ctloc",
          "args": [
            "am_pm[0]"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "_ctloc(am_pm[0])"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ctloc",
          "args": [
            "am_pm[0]"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "0"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "_ALT_O"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "_ALT_O"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "0"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "_ALT_O"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "0"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "_ALT_O"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "0"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "_ALT_O"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "_ALT_E"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncasecmp",
          "args": [
            "_ctloc(abmon[i])",
            "bp",
            "len"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ctloc",
          "args": [
            "abmon[i]"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "_ctloc(abmon[i])"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ctloc",
          "args": [
            "abmon[i]"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncasecmp",
          "args": [
            "_ctloc(mon[i])",
            "bp",
            "len"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ctloc",
          "args": [
            "mon[i]"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "_ctloc(mon[i])"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ctloc",
          "args": [
            "mon[i]"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "0"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncasecmp",
          "args": [
            "_ctloc(abday[i])",
            "bp",
            "len"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ctloc",
          "args": [
            "abday[i]"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "_ctloc(abday[i])"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ctloc",
          "args": [
            "abday[i]"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncasecmp",
          "args": [
            "_ctloc(day[i])",
            "bp",
            "len"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ctloc",
          "args": [
            "day[i]"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "_ctloc(day[i])"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ctloc",
          "args": [
            "day[i]"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "0"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_strptime",
          "args": [
            "bp",
            "_ctloc(d_fmt)",
            "tm",
            "0"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "_strptime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strptime.c",
          "lines": "66-374",
          "snippet": "static char *\n_strptime(const char *buf, const char *fmt, struct tm *tm, int initialize)\n{\n\tunsigned char c;\n\tconst unsigned char *bp;\n\tsize_t len;\n\tint alt_format, i;\n\tstatic int century, relyear;\n\n\tif (initialize) {\n\t\tcentury = TM_YEAR_BASE;\n\t\trelyear = -1;\n\t}\n\n\tbp = (unsigned char *)buf;\n\twhile ((c = *fmt) != '\\0') {\n\t\t/* Clear `alternate' modifier prior to new conversion. */\n\t\talt_format = 0;\n\n\t\t/* Eat up white-space. */\n\t\tif (isspace(c)) {\n\t\t\twhile (isspace(*bp))\n\t\t\t\tbp++;\n\n\t\t\tfmt++;\n\t\t\tcontinue;\n\t\t}\n\t\t\t\t\n\t\tif ((c = *fmt++) != '%')\n\t\t\tgoto literal;\n\n\nagain:\t\tswitch (c = *fmt++) {\n\t\tcase '%':\t/* \"%%\" is converted to \"%\". */\nliteral:\n\t\tif (c != *bp++)\n\t\t\treturn (NULL);\n\n\t\tbreak;\n\n\t\t/*\n\t\t * \"Alternative\" modifiers. Just set the appropriate flag\n\t\t * and start over again.\n\t\t */\n\t\tcase 'E':\t/* \"%E?\" alternative conversion modifier. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\talt_format |= _ALT_E;\n\t\t\tgoto again;\n\n\t\tcase 'O':\t/* \"%O?\" alternative conversion modifier. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\talt_format |= _ALT_O;\n\t\t\tgoto again;\n\t\t\t\n\t\t/*\n\t\t * \"Complex\" conversion rules, implemented through recursion.\n\t\t */\n#if 0\n\t\tcase 'c':\t/* Date and time, using the locale's format. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(bp = _strptime(bp, _ctloc(d_t_fmt), tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n#endif\n\t\tcase 'D':\t/* The date as \"%m/%d/%y\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%m/%d/%y\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\t\n\t\tcase 'R':\t/* The time as \"%H:%M\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%H:%M\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'r':\t/* The time as \"%I:%M:%S %p\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%I:%M:%S %p\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'T':\t/* The time as \"%H:%M:%S\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%H:%M:%S\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n#if 0\n\t\tcase 'X':\t/* The time, using the locale's format. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(bp = _strptime(bp, _ctloc(t_fmt), tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'x':\t/* The date, using the locale's format. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(bp = _strptime(bp, _ctloc(d_fmt), tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n#endif\n\t\t/*\n\t\t * \"Elementary\" conversion rules.\n\t\t */\n#if 0\n\t\tcase 'A':\t/* The day of week, using the locale's form. */\n\t\tcase 'a':\n\t\t\t_LEGAL_ALT(0);\n\t\t\tfor (i = 0; i < 7; i++) {\n\t\t\t\t/* Full name. */\n\t\t\t\tlen = strlen(_ctloc(day[i]));\n\t\t\t\tif (strncasecmp(_ctloc(day[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\n\t\t\t\t/* Abbreviated name. */\n\t\t\t\tlen = strlen(_ctloc(abday[i]));\n\t\t\t\tif (strncasecmp(_ctloc(abday[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Nothing matched. */\n\t\t\tif (i == 7)\n\t\t\t\treturn (NULL);\n\n\t\t\ttm->tm_wday = i;\n\t\t\tbp += len;\n\t\t\tbreak;\n\n\t\tcase 'B':\t/* The month, using the locale's form. */\n\t\tcase 'b':\n\t\tcase 'h':\n\t\t\t_LEGAL_ALT(0);\n\t\t\tfor (i = 0; i < 12; i++) {\n\t\t\t\t/* Full name. */\n\t\t\t\tlen = strlen(_ctloc(mon[i]));\n\t\t\t\tif (strncasecmp(_ctloc(mon[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\n\t\t\t\t/* Abbreviated name. */\n\t\t\t\tlen = strlen(_ctloc(abmon[i]));\n\t\t\t\tif (strncasecmp(_ctloc(abmon[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Nothing matched. */\n\t\t\tif (i == 12)\n\t\t\t\treturn (NULL);\n\n\t\t\ttm->tm_mon = i;\n\t\t\tbp += len;\n\t\t\tbreak;\n#endif\n\n\t\tcase 'C':\t/* The century number. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(_conv_num(&bp, &i, 0, 99)))\n\t\t\t\treturn (NULL);\n\n\t\t\tcentury = i * 100;\n\t\t\tbreak;\n\n\t\tcase 'd':\t/* The day of month. */\n\t\tcase 'e':\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_mday, 1, 31)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'k':\t/* The hour (24-hour clock representation). */\n\t\t\t_LEGAL_ALT(0);\n\t\t\t/* FALLTHROUGH */\n\t\tcase 'H':\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_hour, 0, 23)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'l':\t/* The hour (12-hour clock representation). */\n\t\t\t_LEGAL_ALT(0);\n\t\t\t/* FALLTHROUGH */\n\t\tcase 'I':\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_hour, 1, 12)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'j':\t/* The day of year. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_yday, 1, 366)))\n\t\t\t\treturn (NULL);\n\t\t\ttm->tm_yday--;\n\t\t\tbreak;\n\n\t\tcase 'M':\t/* The minute. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_min, 0, 59)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'm':\t/* The month. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_mon, 1, 12)))\n\t\t\t\treturn (NULL);\n\t\t\ttm->tm_mon--;\n\t\t\tbreak;\n\n#if 0\n\t\tcase 'p':\t/* The locale's equivalent of AM/PM. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\t/* AM? */\n\t\t\tlen = strlen(_ctloc(am_pm[0]));\n\t\t\tif (strncasecmp(_ctloc(am_pm[0]), bp, len) == 0) {\n\t\t\t\tif (tm->tm_hour > 12)\t/* i.e., 13:00 AM ?! */\n\t\t\t\t\treturn (NULL);\n\t\t\t\telse if (tm->tm_hour == 12)\n\t\t\t\t\ttm->tm_hour = 0;\n\n\t\t\t\tbp += len;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* PM? */\n\t\t\tlen = strlen(_ctloc(am_pm[1]));\n\t\t\tif (strncasecmp(_ctloc(am_pm[1]), bp, len) == 0) {\n\t\t\t\tif (tm->tm_hour > 12)\t/* i.e., 13:00 PM ?! */\n\t\t\t\t\treturn (NULL);\n\t\t\t\telse if (tm->tm_hour < 12)\n\t\t\t\t\ttm->tm_hour += 12;\n\n\t\t\t\tbp += len;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Nothing matched. */\n\t\t\treturn (NULL);\n#endif\n\t\tcase 'S':\t/* The seconds. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_sec, 0, 61)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'U':\t/* The week of year, beginning on sunday. */\n\t\tcase 'W':\t/* The week of year, beginning on monday. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\t/*\n\t\t\t * XXX This is bogus, as we can not assume any valid\n\t\t\t * information present in the tm structure at this\n\t\t\t * point to calculate a real value, so just check the\n\t\t\t * range for now.\n\t\t\t */\n\t\t\t if (!(_conv_num(&bp, &i, 0, 53)))\n\t\t\t\treturn (NULL);\n\t\t\t break;\n\n\t\tcase 'w':\t/* The day of week, beginning on sunday. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_wday, 0, 6)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'Y':\t/* The year. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(_conv_num(&bp, &i, 0, 9999)))\n\t\t\t\treturn (NULL);\n\n\t\t\trelyear = -1;\n\t\t\ttm->tm_year = i - TM_YEAR_BASE;\n\t\t\tbreak;\n\n\t\tcase 'y':\t/* The year within the century (2 digits). */\n\t\t\t_LEGAL_ALT(_ALT_E | _ALT_O);\n\t\t\tif (!(_conv_num(&bp, &relyear, 0, 99)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\t/*\n\t\t * Miscellaneous conversions.\n\t\t */\n\t\tcase 'n':\t/* Any kind of white-space. */\n\t\tcase 't':\n\t\t\t_LEGAL_ALT(0);\n\t\t\twhile (isspace(*bp))\n\t\t\t\tbp++;\n\t\t\tbreak;\n\n\n\t\tdefault:\t/* Unknown/unsupported conversion. */\n\t\t\treturn (NULL);\n\t\t}\n\n\n\t}\n\n\t/*\n\t * We need to evaluate the two digit year spec (%y)\n\t * last as we can get a century spec (%C) at any time.\n\t */\n\tif (relyear != -1) {\n\t\tif (century == TM_YEAR_BASE) {\n\t\t\tif (relyear <= 68)\n\t\t\t\ttm->tm_year = relyear + 2000 - TM_YEAR_BASE;\n\t\t\telse\n\t\t\t\ttm->tm_year = relyear + 1900 - TM_YEAR_BASE;\n\t\t} else {\n\t\t\ttm->tm_year = relyear + century - TM_YEAR_BASE;\n\t\t}\n\t}\n\n\treturn ((char *)bp);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "_ctloc",
          "args": [
            "d_fmt"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "_ALT_E"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ctloc",
          "args": [
            "t_fmt"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "_ALT_E"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "0"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "0"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "0"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "0"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ctloc",
          "args": [
            "d_t_fmt"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "_ALT_E"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "0"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_LEGAL_ALT",
          "args": [
            "0"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "*bp"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isspace",
          "args": [
            "c"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <string.h>\n#include <locale.h>\n#include <ctype.h>\n#include \"includes.h\"\n\n#define _ALT_O\t\t\t0x02\n#define _ALT_E\t\t\t0x01\n#define TM_YEAR_BASE 1900\t/* from tzfile.h */\n\nstatic char *\n_strptime(const char *buf, const char *fmt, struct tm *tm, int initialize)\n{\n\tunsigned char c;\n\tconst unsigned char *bp;\n\tsize_t len;\n\tint alt_format, i;\n\tstatic int century, relyear;\n\n\tif (initialize) {\n\t\tcentury = TM_YEAR_BASE;\n\t\trelyear = -1;\n\t}\n\n\tbp = (unsigned char *)buf;\n\twhile ((c = *fmt) != '\\0') {\n\t\t/* Clear `alternate' modifier prior to new conversion. */\n\t\talt_format = 0;\n\n\t\t/* Eat up white-space. */\n\t\tif (isspace(c)) {\n\t\t\twhile (isspace(*bp))\n\t\t\t\tbp++;\n\n\t\t\tfmt++;\n\t\t\tcontinue;\n\t\t}\n\t\t\t\t\n\t\tif ((c = *fmt++) != '%')\n\t\t\tgoto literal;\n\n\nagain:\t\tswitch (c = *fmt++) {\n\t\tcase '%':\t/* \"%%\" is converted to \"%\". */\nliteral:\n\t\tif (c != *bp++)\n\t\t\treturn (NULL);\n\n\t\tbreak;\n\n\t\t/*\n\t\t * \"Alternative\" modifiers. Just set the appropriate flag\n\t\t * and start over again.\n\t\t */\n\t\tcase 'E':\t/* \"%E?\" alternative conversion modifier. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\talt_format |= _ALT_E;\n\t\t\tgoto again;\n\n\t\tcase 'O':\t/* \"%O?\" alternative conversion modifier. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\talt_format |= _ALT_O;\n\t\t\tgoto again;\n\t\t\t\n\t\t/*\n\t\t * \"Complex\" conversion rules, implemented through recursion.\n\t\t */\n#if 0\n\t\tcase 'c':\t/* Date and time, using the locale's format. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(bp = _strptime(bp, _ctloc(d_t_fmt), tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n#endif\n\t\tcase 'D':\t/* The date as \"%m/%d/%y\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%m/%d/%y\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\t\n\t\tcase 'R':\t/* The time as \"%H:%M\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%H:%M\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'r':\t/* The time as \"%I:%M:%S %p\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%I:%M:%S %p\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'T':\t/* The time as \"%H:%M:%S\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%H:%M:%S\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n#if 0\n\t\tcase 'X':\t/* The time, using the locale's format. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(bp = _strptime(bp, _ctloc(t_fmt), tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'x':\t/* The date, using the locale's format. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(bp = _strptime(bp, _ctloc(d_fmt), tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n#endif\n\t\t/*\n\t\t * \"Elementary\" conversion rules.\n\t\t */\n#if 0\n\t\tcase 'A':\t/* The day of week, using the locale's form. */\n\t\tcase 'a':\n\t\t\t_LEGAL_ALT(0);\n\t\t\tfor (i = 0; i < 7; i++) {\n\t\t\t\t/* Full name. */\n\t\t\t\tlen = strlen(_ctloc(day[i]));\n\t\t\t\tif (strncasecmp(_ctloc(day[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\n\t\t\t\t/* Abbreviated name. */\n\t\t\t\tlen = strlen(_ctloc(abday[i]));\n\t\t\t\tif (strncasecmp(_ctloc(abday[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Nothing matched. */\n\t\t\tif (i == 7)\n\t\t\t\treturn (NULL);\n\n\t\t\ttm->tm_wday = i;\n\t\t\tbp += len;\n\t\t\tbreak;\n\n\t\tcase 'B':\t/* The month, using the locale's form. */\n\t\tcase 'b':\n\t\tcase 'h':\n\t\t\t_LEGAL_ALT(0);\n\t\t\tfor (i = 0; i < 12; i++) {\n\t\t\t\t/* Full name. */\n\t\t\t\tlen = strlen(_ctloc(mon[i]));\n\t\t\t\tif (strncasecmp(_ctloc(mon[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\n\t\t\t\t/* Abbreviated name. */\n\t\t\t\tlen = strlen(_ctloc(abmon[i]));\n\t\t\t\tif (strncasecmp(_ctloc(abmon[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Nothing matched. */\n\t\t\tif (i == 12)\n\t\t\t\treturn (NULL);\n\n\t\t\ttm->tm_mon = i;\n\t\t\tbp += len;\n\t\t\tbreak;\n#endif\n\n\t\tcase 'C':\t/* The century number. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(_conv_num(&bp, &i, 0, 99)))\n\t\t\t\treturn (NULL);\n\n\t\t\tcentury = i * 100;\n\t\t\tbreak;\n\n\t\tcase 'd':\t/* The day of month. */\n\t\tcase 'e':\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_mday, 1, 31)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'k':\t/* The hour (24-hour clock representation). */\n\t\t\t_LEGAL_ALT(0);\n\t\t\t/* FALLTHROUGH */\n\t\tcase 'H':\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_hour, 0, 23)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'l':\t/* The hour (12-hour clock representation). */\n\t\t\t_LEGAL_ALT(0);\n\t\t\t/* FALLTHROUGH */\n\t\tcase 'I':\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_hour, 1, 12)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'j':\t/* The day of year. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_yday, 1, 366)))\n\t\t\t\treturn (NULL);\n\t\t\ttm->tm_yday--;\n\t\t\tbreak;\n\n\t\tcase 'M':\t/* The minute. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_min, 0, 59)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'm':\t/* The month. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_mon, 1, 12)))\n\t\t\t\treturn (NULL);\n\t\t\ttm->tm_mon--;\n\t\t\tbreak;\n\n#if 0\n\t\tcase 'p':\t/* The locale's equivalent of AM/PM. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\t/* AM? */\n\t\t\tlen = strlen(_ctloc(am_pm[0]));\n\t\t\tif (strncasecmp(_ctloc(am_pm[0]), bp, len) == 0) {\n\t\t\t\tif (tm->tm_hour > 12)\t/* i.e., 13:00 AM ?! */\n\t\t\t\t\treturn (NULL);\n\t\t\t\telse if (tm->tm_hour == 12)\n\t\t\t\t\ttm->tm_hour = 0;\n\n\t\t\t\tbp += len;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* PM? */\n\t\t\tlen = strlen(_ctloc(am_pm[1]));\n\t\t\tif (strncasecmp(_ctloc(am_pm[1]), bp, len) == 0) {\n\t\t\t\tif (tm->tm_hour > 12)\t/* i.e., 13:00 PM ?! */\n\t\t\t\t\treturn (NULL);\n\t\t\t\telse if (tm->tm_hour < 12)\n\t\t\t\t\ttm->tm_hour += 12;\n\n\t\t\t\tbp += len;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Nothing matched. */\n\t\t\treturn (NULL);\n#endif\n\t\tcase 'S':\t/* The seconds. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_sec, 0, 61)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'U':\t/* The week of year, beginning on sunday. */\n\t\tcase 'W':\t/* The week of year, beginning on monday. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\t/*\n\t\t\t * XXX This is bogus, as we can not assume any valid\n\t\t\t * information present in the tm structure at this\n\t\t\t * point to calculate a real value, so just check the\n\t\t\t * range for now.\n\t\t\t */\n\t\t\t if (!(_conv_num(&bp, &i, 0, 53)))\n\t\t\t\treturn (NULL);\n\t\t\t break;\n\n\t\tcase 'w':\t/* The day of week, beginning on sunday. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_wday, 0, 6)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'Y':\t/* The year. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(_conv_num(&bp, &i, 0, 9999)))\n\t\t\t\treturn (NULL);\n\n\t\t\trelyear = -1;\n\t\t\ttm->tm_year = i - TM_YEAR_BASE;\n\t\t\tbreak;\n\n\t\tcase 'y':\t/* The year within the century (2 digits). */\n\t\t\t_LEGAL_ALT(_ALT_E | _ALT_O);\n\t\t\tif (!(_conv_num(&bp, &relyear, 0, 99)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\t/*\n\t\t * Miscellaneous conversions.\n\t\t */\n\t\tcase 'n':\t/* Any kind of white-space. */\n\t\tcase 't':\n\t\t\t_LEGAL_ALT(0);\n\t\t\twhile (isspace(*bp))\n\t\t\t\tbp++;\n\t\t\tbreak;\n\n\n\t\tdefault:\t/* Unknown/unsupported conversion. */\n\t\t\treturn (NULL);\n\t\t}\n\n\n\t}\n\n\t/*\n\t * We need to evaluate the two digit year spec (%y)\n\t * last as we can get a century spec (%C) at any time.\n\t */\n\tif (relyear != -1) {\n\t\tif (century == TM_YEAR_BASE) {\n\t\t\tif (relyear <= 68)\n\t\t\t\ttm->tm_year = relyear + 2000 - TM_YEAR_BASE;\n\t\t\telse\n\t\t\t\ttm->tm_year = relyear + 1900 - TM_YEAR_BASE;\n\t\t} else {\n\t\t\ttm->tm_year = relyear + century - TM_YEAR_BASE;\n\t\t}\n\t}\n\n\treturn ((char *)bp);\n}"
  },
  {
    "function_name": "strptime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strptime.c",
    "lines": "60-64",
    "snippet": "char *\nstrptime(const char *buf, const char *fmt, struct tm *tm)\n{\n\treturn(_strptime(buf, fmt, tm, 1));\n}",
    "includes": [
      "#include <time.h>",
      "#include <string.h>",
      "#include <locale.h>",
      "#include <ctype.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_strptime",
          "args": [
            "buf",
            "fmt",
            "tm",
            "1"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "_strptime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strptime.c",
          "lines": "66-374",
          "snippet": "static char *\n_strptime(const char *buf, const char *fmt, struct tm *tm, int initialize)\n{\n\tunsigned char c;\n\tconst unsigned char *bp;\n\tsize_t len;\n\tint alt_format, i;\n\tstatic int century, relyear;\n\n\tif (initialize) {\n\t\tcentury = TM_YEAR_BASE;\n\t\trelyear = -1;\n\t}\n\n\tbp = (unsigned char *)buf;\n\twhile ((c = *fmt) != '\\0') {\n\t\t/* Clear `alternate' modifier prior to new conversion. */\n\t\talt_format = 0;\n\n\t\t/* Eat up white-space. */\n\t\tif (isspace(c)) {\n\t\t\twhile (isspace(*bp))\n\t\t\t\tbp++;\n\n\t\t\tfmt++;\n\t\t\tcontinue;\n\t\t}\n\t\t\t\t\n\t\tif ((c = *fmt++) != '%')\n\t\t\tgoto literal;\n\n\nagain:\t\tswitch (c = *fmt++) {\n\t\tcase '%':\t/* \"%%\" is converted to \"%\". */\nliteral:\n\t\tif (c != *bp++)\n\t\t\treturn (NULL);\n\n\t\tbreak;\n\n\t\t/*\n\t\t * \"Alternative\" modifiers. Just set the appropriate flag\n\t\t * and start over again.\n\t\t */\n\t\tcase 'E':\t/* \"%E?\" alternative conversion modifier. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\talt_format |= _ALT_E;\n\t\t\tgoto again;\n\n\t\tcase 'O':\t/* \"%O?\" alternative conversion modifier. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\talt_format |= _ALT_O;\n\t\t\tgoto again;\n\t\t\t\n\t\t/*\n\t\t * \"Complex\" conversion rules, implemented through recursion.\n\t\t */\n#if 0\n\t\tcase 'c':\t/* Date and time, using the locale's format. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(bp = _strptime(bp, _ctloc(d_t_fmt), tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n#endif\n\t\tcase 'D':\t/* The date as \"%m/%d/%y\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%m/%d/%y\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\t\n\t\tcase 'R':\t/* The time as \"%H:%M\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%H:%M\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'r':\t/* The time as \"%I:%M:%S %p\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%I:%M:%S %p\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'T':\t/* The time as \"%H:%M:%S\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%H:%M:%S\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n#if 0\n\t\tcase 'X':\t/* The time, using the locale's format. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(bp = _strptime(bp, _ctloc(t_fmt), tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'x':\t/* The date, using the locale's format. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(bp = _strptime(bp, _ctloc(d_fmt), tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n#endif\n\t\t/*\n\t\t * \"Elementary\" conversion rules.\n\t\t */\n#if 0\n\t\tcase 'A':\t/* The day of week, using the locale's form. */\n\t\tcase 'a':\n\t\t\t_LEGAL_ALT(0);\n\t\t\tfor (i = 0; i < 7; i++) {\n\t\t\t\t/* Full name. */\n\t\t\t\tlen = strlen(_ctloc(day[i]));\n\t\t\t\tif (strncasecmp(_ctloc(day[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\n\t\t\t\t/* Abbreviated name. */\n\t\t\t\tlen = strlen(_ctloc(abday[i]));\n\t\t\t\tif (strncasecmp(_ctloc(abday[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Nothing matched. */\n\t\t\tif (i == 7)\n\t\t\t\treturn (NULL);\n\n\t\t\ttm->tm_wday = i;\n\t\t\tbp += len;\n\t\t\tbreak;\n\n\t\tcase 'B':\t/* The month, using the locale's form. */\n\t\tcase 'b':\n\t\tcase 'h':\n\t\t\t_LEGAL_ALT(0);\n\t\t\tfor (i = 0; i < 12; i++) {\n\t\t\t\t/* Full name. */\n\t\t\t\tlen = strlen(_ctloc(mon[i]));\n\t\t\t\tif (strncasecmp(_ctloc(mon[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\n\t\t\t\t/* Abbreviated name. */\n\t\t\t\tlen = strlen(_ctloc(abmon[i]));\n\t\t\t\tif (strncasecmp(_ctloc(abmon[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Nothing matched. */\n\t\t\tif (i == 12)\n\t\t\t\treturn (NULL);\n\n\t\t\ttm->tm_mon = i;\n\t\t\tbp += len;\n\t\t\tbreak;\n#endif\n\n\t\tcase 'C':\t/* The century number. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(_conv_num(&bp, &i, 0, 99)))\n\t\t\t\treturn (NULL);\n\n\t\t\tcentury = i * 100;\n\t\t\tbreak;\n\n\t\tcase 'd':\t/* The day of month. */\n\t\tcase 'e':\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_mday, 1, 31)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'k':\t/* The hour (24-hour clock representation). */\n\t\t\t_LEGAL_ALT(0);\n\t\t\t/* FALLTHROUGH */\n\t\tcase 'H':\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_hour, 0, 23)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'l':\t/* The hour (12-hour clock representation). */\n\t\t\t_LEGAL_ALT(0);\n\t\t\t/* FALLTHROUGH */\n\t\tcase 'I':\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_hour, 1, 12)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'j':\t/* The day of year. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_yday, 1, 366)))\n\t\t\t\treturn (NULL);\n\t\t\ttm->tm_yday--;\n\t\t\tbreak;\n\n\t\tcase 'M':\t/* The minute. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_min, 0, 59)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'm':\t/* The month. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_mon, 1, 12)))\n\t\t\t\treturn (NULL);\n\t\t\ttm->tm_mon--;\n\t\t\tbreak;\n\n#if 0\n\t\tcase 'p':\t/* The locale's equivalent of AM/PM. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\t/* AM? */\n\t\t\tlen = strlen(_ctloc(am_pm[0]));\n\t\t\tif (strncasecmp(_ctloc(am_pm[0]), bp, len) == 0) {\n\t\t\t\tif (tm->tm_hour > 12)\t/* i.e., 13:00 AM ?! */\n\t\t\t\t\treturn (NULL);\n\t\t\t\telse if (tm->tm_hour == 12)\n\t\t\t\t\ttm->tm_hour = 0;\n\n\t\t\t\tbp += len;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* PM? */\n\t\t\tlen = strlen(_ctloc(am_pm[1]));\n\t\t\tif (strncasecmp(_ctloc(am_pm[1]), bp, len) == 0) {\n\t\t\t\tif (tm->tm_hour > 12)\t/* i.e., 13:00 PM ?! */\n\t\t\t\t\treturn (NULL);\n\t\t\t\telse if (tm->tm_hour < 12)\n\t\t\t\t\ttm->tm_hour += 12;\n\n\t\t\t\tbp += len;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Nothing matched. */\n\t\t\treturn (NULL);\n#endif\n\t\tcase 'S':\t/* The seconds. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_sec, 0, 61)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'U':\t/* The week of year, beginning on sunday. */\n\t\tcase 'W':\t/* The week of year, beginning on monday. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\t/*\n\t\t\t * XXX This is bogus, as we can not assume any valid\n\t\t\t * information present in the tm structure at this\n\t\t\t * point to calculate a real value, so just check the\n\t\t\t * range for now.\n\t\t\t */\n\t\t\t if (!(_conv_num(&bp, &i, 0, 53)))\n\t\t\t\treturn (NULL);\n\t\t\t break;\n\n\t\tcase 'w':\t/* The day of week, beginning on sunday. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_wday, 0, 6)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'Y':\t/* The year. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(_conv_num(&bp, &i, 0, 9999)))\n\t\t\t\treturn (NULL);\n\n\t\t\trelyear = -1;\n\t\t\ttm->tm_year = i - TM_YEAR_BASE;\n\t\t\tbreak;\n\n\t\tcase 'y':\t/* The year within the century (2 digits). */\n\t\t\t_LEGAL_ALT(_ALT_E | _ALT_O);\n\t\t\tif (!(_conv_num(&bp, &relyear, 0, 99)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\t/*\n\t\t * Miscellaneous conversions.\n\t\t */\n\t\tcase 'n':\t/* Any kind of white-space. */\n\t\tcase 't':\n\t\t\t_LEGAL_ALT(0);\n\t\t\twhile (isspace(*bp))\n\t\t\t\tbp++;\n\t\t\tbreak;\n\n\n\t\tdefault:\t/* Unknown/unsupported conversion. */\n\t\t\treturn (NULL);\n\t\t}\n\n\n\t}\n\n\t/*\n\t * We need to evaluate the two digit year spec (%y)\n\t * last as we can get a century spec (%C) at any time.\n\t */\n\tif (relyear != -1) {\n\t\tif (century == TM_YEAR_BASE) {\n\t\t\tif (relyear <= 68)\n\t\t\t\ttm->tm_year = relyear + 2000 - TM_YEAR_BASE;\n\t\t\telse\n\t\t\t\ttm->tm_year = relyear + 1900 - TM_YEAR_BASE;\n\t\t} else {\n\t\t\ttm->tm_year = relyear + century - TM_YEAR_BASE;\n\t\t}\n\t}\n\n\treturn ((char *)bp);\n}",
          "includes": [
            "#include <time.h>",
            "#include <string.h>",
            "#include <locale.h>",
            "#include <ctype.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define _ALT_O\t\t\t0x02",
            "#define _ALT_E\t\t\t0x01",
            "#define TM_YEAR_BASE 1900\t/* from tzfile.h */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <string.h>\n#include <locale.h>\n#include <ctype.h>\n#include \"includes.h\"\n\n#define _ALT_O\t\t\t0x02\n#define _ALT_E\t\t\t0x01\n#define TM_YEAR_BASE 1900\t/* from tzfile.h */\n\nstatic char *\n_strptime(const char *buf, const char *fmt, struct tm *tm, int initialize)\n{\n\tunsigned char c;\n\tconst unsigned char *bp;\n\tsize_t len;\n\tint alt_format, i;\n\tstatic int century, relyear;\n\n\tif (initialize) {\n\t\tcentury = TM_YEAR_BASE;\n\t\trelyear = -1;\n\t}\n\n\tbp = (unsigned char *)buf;\n\twhile ((c = *fmt) != '\\0') {\n\t\t/* Clear `alternate' modifier prior to new conversion. */\n\t\talt_format = 0;\n\n\t\t/* Eat up white-space. */\n\t\tif (isspace(c)) {\n\t\t\twhile (isspace(*bp))\n\t\t\t\tbp++;\n\n\t\t\tfmt++;\n\t\t\tcontinue;\n\t\t}\n\t\t\t\t\n\t\tif ((c = *fmt++) != '%')\n\t\t\tgoto literal;\n\n\nagain:\t\tswitch (c = *fmt++) {\n\t\tcase '%':\t/* \"%%\" is converted to \"%\". */\nliteral:\n\t\tif (c != *bp++)\n\t\t\treturn (NULL);\n\n\t\tbreak;\n\n\t\t/*\n\t\t * \"Alternative\" modifiers. Just set the appropriate flag\n\t\t * and start over again.\n\t\t */\n\t\tcase 'E':\t/* \"%E?\" alternative conversion modifier. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\talt_format |= _ALT_E;\n\t\t\tgoto again;\n\n\t\tcase 'O':\t/* \"%O?\" alternative conversion modifier. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\talt_format |= _ALT_O;\n\t\t\tgoto again;\n\t\t\t\n\t\t/*\n\t\t * \"Complex\" conversion rules, implemented through recursion.\n\t\t */\n#if 0\n\t\tcase 'c':\t/* Date and time, using the locale's format. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(bp = _strptime(bp, _ctloc(d_t_fmt), tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n#endif\n\t\tcase 'D':\t/* The date as \"%m/%d/%y\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%m/%d/%y\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\t\n\t\tcase 'R':\t/* The time as \"%H:%M\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%H:%M\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'r':\t/* The time as \"%I:%M:%S %p\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%I:%M:%S %p\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'T':\t/* The time as \"%H:%M:%S\". */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(bp = _strptime(bp, \"%H:%M:%S\", tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n#if 0\n\t\tcase 'X':\t/* The time, using the locale's format. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(bp = _strptime(bp, _ctloc(t_fmt), tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'x':\t/* The date, using the locale's format. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(bp = _strptime(bp, _ctloc(d_fmt), tm, 0)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n#endif\n\t\t/*\n\t\t * \"Elementary\" conversion rules.\n\t\t */\n#if 0\n\t\tcase 'A':\t/* The day of week, using the locale's form. */\n\t\tcase 'a':\n\t\t\t_LEGAL_ALT(0);\n\t\t\tfor (i = 0; i < 7; i++) {\n\t\t\t\t/* Full name. */\n\t\t\t\tlen = strlen(_ctloc(day[i]));\n\t\t\t\tif (strncasecmp(_ctloc(day[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\n\t\t\t\t/* Abbreviated name. */\n\t\t\t\tlen = strlen(_ctloc(abday[i]));\n\t\t\t\tif (strncasecmp(_ctloc(abday[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Nothing matched. */\n\t\t\tif (i == 7)\n\t\t\t\treturn (NULL);\n\n\t\t\ttm->tm_wday = i;\n\t\t\tbp += len;\n\t\t\tbreak;\n\n\t\tcase 'B':\t/* The month, using the locale's form. */\n\t\tcase 'b':\n\t\tcase 'h':\n\t\t\t_LEGAL_ALT(0);\n\t\t\tfor (i = 0; i < 12; i++) {\n\t\t\t\t/* Full name. */\n\t\t\t\tlen = strlen(_ctloc(mon[i]));\n\t\t\t\tif (strncasecmp(_ctloc(mon[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\n\t\t\t\t/* Abbreviated name. */\n\t\t\t\tlen = strlen(_ctloc(abmon[i]));\n\t\t\t\tif (strncasecmp(_ctloc(abmon[i]), bp, len) == 0)\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Nothing matched. */\n\t\t\tif (i == 12)\n\t\t\t\treturn (NULL);\n\n\t\t\ttm->tm_mon = i;\n\t\t\tbp += len;\n\t\t\tbreak;\n#endif\n\n\t\tcase 'C':\t/* The century number. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(_conv_num(&bp, &i, 0, 99)))\n\t\t\t\treturn (NULL);\n\n\t\t\tcentury = i * 100;\n\t\t\tbreak;\n\n\t\tcase 'd':\t/* The day of month. */\n\t\tcase 'e':\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_mday, 1, 31)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'k':\t/* The hour (24-hour clock representation). */\n\t\t\t_LEGAL_ALT(0);\n\t\t\t/* FALLTHROUGH */\n\t\tcase 'H':\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_hour, 0, 23)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'l':\t/* The hour (12-hour clock representation). */\n\t\t\t_LEGAL_ALT(0);\n\t\t\t/* FALLTHROUGH */\n\t\tcase 'I':\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_hour, 1, 12)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'j':\t/* The day of year. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_yday, 1, 366)))\n\t\t\t\treturn (NULL);\n\t\t\ttm->tm_yday--;\n\t\t\tbreak;\n\n\t\tcase 'M':\t/* The minute. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_min, 0, 59)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'm':\t/* The month. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_mon, 1, 12)))\n\t\t\t\treturn (NULL);\n\t\t\ttm->tm_mon--;\n\t\t\tbreak;\n\n#if 0\n\t\tcase 'p':\t/* The locale's equivalent of AM/PM. */\n\t\t\t_LEGAL_ALT(0);\n\t\t\t/* AM? */\n\t\t\tlen = strlen(_ctloc(am_pm[0]));\n\t\t\tif (strncasecmp(_ctloc(am_pm[0]), bp, len) == 0) {\n\t\t\t\tif (tm->tm_hour > 12)\t/* i.e., 13:00 AM ?! */\n\t\t\t\t\treturn (NULL);\n\t\t\t\telse if (tm->tm_hour == 12)\n\t\t\t\t\ttm->tm_hour = 0;\n\n\t\t\t\tbp += len;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* PM? */\n\t\t\tlen = strlen(_ctloc(am_pm[1]));\n\t\t\tif (strncasecmp(_ctloc(am_pm[1]), bp, len) == 0) {\n\t\t\t\tif (tm->tm_hour > 12)\t/* i.e., 13:00 PM ?! */\n\t\t\t\t\treturn (NULL);\n\t\t\t\telse if (tm->tm_hour < 12)\n\t\t\t\t\ttm->tm_hour += 12;\n\n\t\t\t\tbp += len;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t/* Nothing matched. */\n\t\t\treturn (NULL);\n#endif\n\t\tcase 'S':\t/* The seconds. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_sec, 0, 61)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'U':\t/* The week of year, beginning on sunday. */\n\t\tcase 'W':\t/* The week of year, beginning on monday. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\t/*\n\t\t\t * XXX This is bogus, as we can not assume any valid\n\t\t\t * information present in the tm structure at this\n\t\t\t * point to calculate a real value, so just check the\n\t\t\t * range for now.\n\t\t\t */\n\t\t\t if (!(_conv_num(&bp, &i, 0, 53)))\n\t\t\t\treturn (NULL);\n\t\t\t break;\n\n\t\tcase 'w':\t/* The day of week, beginning on sunday. */\n\t\t\t_LEGAL_ALT(_ALT_O);\n\t\t\tif (!(_conv_num(&bp, &tm->tm_wday, 0, 6)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\tcase 'Y':\t/* The year. */\n\t\t\t_LEGAL_ALT(_ALT_E);\n\t\t\tif (!(_conv_num(&bp, &i, 0, 9999)))\n\t\t\t\treturn (NULL);\n\n\t\t\trelyear = -1;\n\t\t\ttm->tm_year = i - TM_YEAR_BASE;\n\t\t\tbreak;\n\n\t\tcase 'y':\t/* The year within the century (2 digits). */\n\t\t\t_LEGAL_ALT(_ALT_E | _ALT_O);\n\t\t\tif (!(_conv_num(&bp, &relyear, 0, 99)))\n\t\t\t\treturn (NULL);\n\t\t\tbreak;\n\n\t\t/*\n\t\t * Miscellaneous conversions.\n\t\t */\n\t\tcase 'n':\t/* Any kind of white-space. */\n\t\tcase 't':\n\t\t\t_LEGAL_ALT(0);\n\t\t\twhile (isspace(*bp))\n\t\t\t\tbp++;\n\t\t\tbreak;\n\n\n\t\tdefault:\t/* Unknown/unsupported conversion. */\n\t\t\treturn (NULL);\n\t\t}\n\n\n\t}\n\n\t/*\n\t * We need to evaluate the two digit year spec (%y)\n\t * last as we can get a century spec (%C) at any time.\n\t */\n\tif (relyear != -1) {\n\t\tif (century == TM_YEAR_BASE) {\n\t\t\tif (relyear <= 68)\n\t\t\t\ttm->tm_year = relyear + 2000 - TM_YEAR_BASE;\n\t\t\telse\n\t\t\t\ttm->tm_year = relyear + 1900 - TM_YEAR_BASE;\n\t\t} else {\n\t\t\ttm->tm_year = relyear + century - TM_YEAR_BASE;\n\t\t}\n\t}\n\n\treturn ((char *)bp);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <time.h>\n#include <string.h>\n#include <locale.h>\n#include <ctype.h>\n#include \"includes.h\"\n\nchar *\nstrptime(const char *buf, const char *fmt, struct tm *tm)\n{\n\treturn(_strptime(buf, fmt, tm, 1));\n}"
  }
]