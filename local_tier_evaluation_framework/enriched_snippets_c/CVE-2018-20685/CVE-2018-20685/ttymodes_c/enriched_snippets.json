[
  {
    "function_name": "ssh_tty_parse_modes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ttymodes.c",
    "lines": "342-456",
    "snippet": "void\nssh_tty_parse_modes(struct ssh *ssh, int fd)\n{\n\tstruct termios tio;\n\tstruct sshbuf *buf;\n\tconst u_char *data;\n\tu_char opcode;\n\tu_int baud, u;\n\tint r, failure = 0;\n\tsize_t len;\n\n\tif ((r = sshpkt_get_string_direct(ssh, &data, &len)) != 0)\n\t\tfatal(\"%s: packet error: %s\", __func__, ssh_err(r));\n\tif (len == 0)\n\t\treturn;\n\tif ((buf = sshbuf_from(data, len)) == NULL) {\n\t\terror(\"%s: sshbuf_from failed\", __func__);\n\t\treturn;\n\t}\n\n\t/*\n\t * Get old attributes for the terminal.  We will modify these\n\t * flags. I am hoping that if there are any machine-specific\n\t * modes, they will initially have reasonable values.\n\t */\n\tif (tcgetattr(fd, &tio) == -1) {\n\t\tlogit(\"tcgetattr: %.100s\", strerror(errno));\n\t\tfailure = -1;\n\t}\n\n\twhile (sshbuf_len(buf) > 0) {\n\t\tif ((r = sshbuf_get_u8(buf, &opcode)) != 0)\n\t\t\tfatal(\"%s: packet error: %s\", __func__, ssh_err(r));\n\t\tswitch (opcode) {\n\t\tcase TTY_OP_END:\n\t\t\tgoto set;\n\n\t\tcase TTY_OP_ISPEED:\n\t\t\tif ((r = sshbuf_get_u32(buf, &baud)) != 0)\n\t\t\t\tfatal(\"%s: packet error: %s\",\n\t\t\t\t    __func__, ssh_err(r));\n\t\t\tif (failure != -1 &&\n\t\t\t    cfsetispeed(&tio, baud_to_speed(baud)) == -1)\n\t\t\t\terror(\"cfsetispeed failed for %d\", baud);\n\t\t\tbreak;\n\n\t\tcase TTY_OP_OSPEED:\n\t\t\tif ((r = sshbuf_get_u32(buf, &baud)) != 0)\n\t\t\t\tfatal(\"%s: packet error: %s\",\n\t\t\t\t    __func__, ssh_err(r));\n\t\t\tif (failure != -1 &&\n\t\t\t    cfsetospeed(&tio, baud_to_speed(baud)) == -1)\n\t\t\t\terror(\"cfsetospeed failed for %d\", baud);\n\t\t\tbreak;\n\n#define TTYCHAR(NAME, OP) \\\n\t\tcase OP: \\\n\t\t\tif ((r = sshbuf_get_u32(buf, &u)) != 0) \\\n\t\t\t\tfatal(\"%s: packet error: %s\", __func__, \\\n\t\t\t\t    ssh_err(r)); \\\n\t\t\ttio.c_cc[NAME] = special_char_decode(u); \\\n\t\t\tbreak;\n#define TTYMODE(NAME, FIELD, OP) \\\n\t\tcase OP: \\\n\t\t\tif ((r = sshbuf_get_u32(buf, &u)) != 0) \\\n\t\t\t\tfatal(\"%s: packet error: %s\", __func__, \\\n\t\t\t\t    ssh_err(r)); \\\n\t\t\tif (u) \\\n\t\t\t\ttio.FIELD |= NAME; \\\n\t\t\telse \\\n\t\t\t\ttio.FIELD &= ~NAME; \\\n\t\t\tbreak;\n\n#include \"ttymodes.h\"\n\n#undef TTYCHAR\n#undef TTYMODE\n\n\t\tdefault:\n\t\t\tdebug(\"Ignoring unsupported tty mode opcode %d (0x%x)\",\n\t\t\t    opcode, opcode);\n\t\t\t/*\n\t\t\t * SSH2:\n\t\t\t * Opcodes 1 to 159 are defined to have a uint32\n\t\t\t * argument.\n\t\t\t * Opcodes 160 to 255 are undefined and cause parsing\n\t\t\t * to stop.\n\t\t\t */\n\t\t\tif (opcode > 0 && opcode < 160) {\n\t\t\t\tif ((r = sshbuf_get_u32(buf, NULL)) != 0)\n\t\t\t\t\tfatal(\"%s: packet error: %s\", __func__,\n\t\t\t\t\t    ssh_err(r));\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tlogit(\"%s: unknown opcode %d\", __func__,\n\t\t\t\t    opcode);\n\t\t\t\tgoto set;\n\t\t\t}\n\t\t}\n\t}\n\nset:\n\tlen = sshbuf_len(buf);\n\tsshbuf_free(buf);\n\tif (len > 0) {\n\t\tlogit(\"%s: %zu bytes left\", __func__, len);\n\t\treturn;\t\t/* Don't process bytes passed */\n\t}\n\tif (failure == -1)\n\t\treturn;\t\t/* Packet parsed ok but tcgetattr() failed */\n\n\t/* Set the new modes for the terminal. */\n\tif (tcsetattr(fd, TCSANOW, &tio) == -1)\n\t\tlogit(\"Setting tty modes failed: %.100s\", strerror(errno));\n}",
    "includes": [
      "#include \"ttymodes.h\"",
      "#include \"ttymodes.h\"",
      "#include \"ssherr.h\"",
      "#include \"sshbuf.h\"",
      "#include \"compat.h\"",
      "#include \"log.h\"",
      "#include \"packet.h\"",
      "#include <stdarg.h>",
      "#include <termios.h>",
      "#include <string.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define TTY_OP_OSPEED\t129",
      "#define TTY_OP_ISPEED\t128",
      "#define TTY_OP_END\t\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "logit",
          "args": [
            "\"Setting tty modes failed: %.100s\"",
            "strerror(errno)"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "logit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "198-206",
          "snippet": "void\nlogit(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_INFO, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nlogit(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_INFO, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "errno"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gai_strerror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "140-146",
          "snippet": "const char *\nssh_gai_strerror(int gaierr)\n{\n\tif (gaierr == EAI_SYSTEM && errno != 0)\n\t\treturn strerror(errno);\n\treturn gai_strerror(gaierr);\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst char *\nssh_gai_strerror(int gaierr)\n{\n\tif (gaierr == EAI_SYSTEM && errno != 0)\n\t\treturn strerror(errno);\n\treturn gai_strerror(gaierr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tcsetattr",
          "args": [
            "fd",
            "TCSANOW",
            "&tio"
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "tcsetattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-nextstep.c",
          "lines": "52-73",
          "snippet": "int\ntcsetattr(int fd, int opt, const struct termios *t)\n{\n\tstruct termios localterm;\n\n\tif (opt & TCSASOFT) {\n\t\tlocalterm = *t;\n\t\tlocalterm.c_cflag |= CIGNORE;\n\t\tt = &localterm;\n\t}\n\tswitch (opt & ~TCSASOFT) {\n\tcase TCSANOW:\n\t\treturn (ioctl(fd, TIOCSETA, t));\n\tcase TCSADRAIN:\n\t\treturn (ioctl(fd, TIOCSETAW, t));\n\tcase TCSAFLUSH:\n\t\treturn (ioctl(fd, TIOCSETAF, t));\n\tdefault:\n\t\terrno = EINVAL;\n\t\treturn (-1);\n\t}\n}",
          "includes": [
            "#include \"bsd-nextstep.h\"",
            "#include <sys/wait.h>",
            "#include <errno.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bsd-nextstep.h\"\n#include <sys/wait.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\ntcsetattr(int fd, int opt, const struct termios *t)\n{\n\tstruct termios localterm;\n\n\tif (opt & TCSASOFT) {\n\t\tlocalterm = *t;\n\t\tlocalterm.c_cflag |= CIGNORE;\n\t\tt = &localterm;\n\t}\n\tswitch (opt & ~TCSASOFT) {\n\tcase TCSANOW:\n\t\treturn (ioctl(fd, TIOCSETA, t));\n\tcase TCSADRAIN:\n\t\treturn (ioctl(fd, TIOCSETAW, t));\n\tcase TCSAFLUSH:\n\t\treturn (ioctl(fd, TIOCSETAF, t));\n\tdefault:\n\t\terrno = EINVAL;\n\t\treturn (-1);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_free",
          "args": [
            "buf"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "133-166",
          "snippet": "void\nsshbuf_free(struct sshbuf *buf)\n{\n\tif (buf == NULL)\n\t\treturn;\n\t/*\n\t * The following will leak on insane buffers, but this is the safest\n\t * course of action - an invalid pointer or already-freed pointer may\n\t * have been passed to us and continuing to scribble over memory would\n\t * be bad.\n\t */\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn;\n\t/*\n\t * If we are a child, the free our parent to decrement its reference\n\t * count and possibly free it.\n\t */\n\tsshbuf_free(buf->parent);\n\tbuf->parent = NULL;\n\t/*\n\t * If we are a parent with still-extant children, then don't free just\n\t * yet. The last child's call to sshbuf_free should decrement our\n\t * refcount to 0 and trigger the actual free.\n\t */\n\tbuf->refcount--;\n\tif (buf->refcount > 0)\n\t\treturn;\n\tif (!buf->readonly) {\n\t\texplicit_bzero(buf->d, buf->alloc);\n\t\tfree(buf->d);\n\t}\n\texplicit_bzero(buf, sizeof(*buf));\n\tfree(buf);\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nsshbuf_free(struct sshbuf *buf)\n{\n\tif (buf == NULL)\n\t\treturn;\n\t/*\n\t * The following will leak on insane buffers, but this is the safest\n\t * course of action - an invalid pointer or already-freed pointer may\n\t * have been passed to us and continuing to scribble over memory would\n\t * be bad.\n\t */\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn;\n\t/*\n\t * If we are a child, the free our parent to decrement its reference\n\t * count and possibly free it.\n\t */\n\tsshbuf_free(buf->parent);\n\tbuf->parent = NULL;\n\t/*\n\t * If we are a parent with still-extant children, then don't free just\n\t * yet. The last child's call to sshbuf_free should decrement our\n\t * refcount to 0 and trigger the actual free.\n\t */\n\tbuf->refcount--;\n\tif (buf->refcount > 0)\n\t\treturn;\n\tif (!buf->readonly) {\n\t\texplicit_bzero(buf->d, buf->alloc);\n\t\tfree(buf->d);\n\t}\n\texplicit_bzero(buf, sizeof(*buf));\n\tfree(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_len",
          "args": [
            "buf"
          ],
          "line": 444
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "252-258",
          "snippet": "size_t\nsshbuf_len(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn 0;\n\treturn buf->size - buf->off;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nsshbuf_len(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn 0;\n\treturn buf->size - buf->off;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"%s: packet error: %s\"",
            "__func__",
            "ssh_err(r)"
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fatal.c",
          "lines": "36-45",
          "snippet": "void\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\tcleanup_exit(255);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\tcleanup_exit(255);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_err",
          "args": [
            "r"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssherr.c",
          "lines": "22-147",
          "snippet": "const char *\nssh_err(int n)\n{\n\tswitch (n) {\n\tcase SSH_ERR_SUCCESS:\n\t\treturn \"success\";\n\tcase SSH_ERR_INTERNAL_ERROR:\n\t\treturn \"unexpected internal error\";\n\tcase SSH_ERR_ALLOC_FAIL:\n\t\treturn \"memory allocation failed\";\n\tcase SSH_ERR_MESSAGE_INCOMPLETE:\n\t\treturn \"incomplete message\";\n\tcase SSH_ERR_INVALID_FORMAT:\n\t\treturn \"invalid format\";\n\tcase SSH_ERR_BIGNUM_IS_NEGATIVE:\n\t\treturn \"bignum is negative\";\n\tcase SSH_ERR_STRING_TOO_LARGE:\n\t\treturn \"string is too large\";\n\tcase SSH_ERR_BIGNUM_TOO_LARGE:\n\t\treturn \"bignum is too large\";\n\tcase SSH_ERR_ECPOINT_TOO_LARGE:\n\t\treturn \"elliptic curve point is too large\";\n\tcase SSH_ERR_NO_BUFFER_SPACE:\n\t\treturn \"insufficient buffer space\";\n\tcase SSH_ERR_INVALID_ARGUMENT:\n\t\treturn \"invalid argument\";\n\tcase SSH_ERR_KEY_BITS_MISMATCH:\n\t\treturn \"key bits do not match\";\n\tcase SSH_ERR_EC_CURVE_INVALID:\n\t\treturn \"invalid elliptic curve\";\n\tcase SSH_ERR_KEY_TYPE_MISMATCH:\n\t\treturn \"key type does not match\";\n\tcase SSH_ERR_KEY_TYPE_UNKNOWN:\n\t\treturn \"unknown or unsupported key type\";\n\tcase SSH_ERR_EC_CURVE_MISMATCH:\n\t\treturn \"elliptic curve does not match\";\n\tcase SSH_ERR_EXPECTED_CERT:\n\t\treturn \"plain key provided where certificate required\";\n\tcase SSH_ERR_KEY_LACKS_CERTBLOB:\n\t\treturn \"key lacks certificate data\";\n\tcase SSH_ERR_KEY_CERT_UNKNOWN_TYPE:\n\t\treturn \"unknown/unsupported certificate type\";\n\tcase SSH_ERR_KEY_CERT_INVALID_SIGN_KEY:\n\t\treturn \"invalid certificate signing key\";\n\tcase SSH_ERR_KEY_INVALID_EC_VALUE:\n\t\treturn \"invalid elliptic curve value\";\n\tcase SSH_ERR_SIGNATURE_INVALID:\n\t\treturn \"incorrect signature\";\n\tcase SSH_ERR_LIBCRYPTO_ERROR:\n\t\treturn \"error in libcrypto\";  /* XXX fetch and return */\n\tcase SSH_ERR_UNEXPECTED_TRAILING_DATA:\n\t\treturn \"unexpected bytes remain after decoding\";\n\tcase SSH_ERR_SYSTEM_ERROR:\n\t\treturn strerror(errno);\n\tcase SSH_ERR_KEY_CERT_INVALID:\n\t\treturn \"invalid certificate\";\n\tcase SSH_ERR_AGENT_COMMUNICATION:\n\t\treturn \"communication with agent failed\";\n\tcase SSH_ERR_AGENT_FAILURE:\n\t\treturn \"agent refused operation\";\n\tcase SSH_ERR_DH_GEX_OUT_OF_RANGE:\n\t\treturn \"DH GEX group out of range\";\n\tcase SSH_ERR_DISCONNECTED:\n\t\treturn \"disconnected\";\n\tcase SSH_ERR_MAC_INVALID:\n\t\treturn \"message authentication code incorrect\";\n\tcase SSH_ERR_NO_CIPHER_ALG_MATCH:\n\t\treturn \"no matching cipher found\";\n\tcase SSH_ERR_NO_MAC_ALG_MATCH:\n\t\treturn \"no matching MAC found\";\n\tcase SSH_ERR_NO_COMPRESS_ALG_MATCH:\n\t\treturn \"no matching compression method found\";\n\tcase SSH_ERR_NO_KEX_ALG_MATCH:\n\t\treturn \"no matching key exchange method found\";\n\tcase SSH_ERR_NO_HOSTKEY_ALG_MATCH:\n\t\treturn \"no matching host key type found\";\n\tcase SSH_ERR_PROTOCOL_MISMATCH:\n\t\treturn \"protocol version mismatch\";\n\tcase SSH_ERR_NO_PROTOCOL_VERSION:\n\t\treturn \"could not read protocol version\";\n\tcase SSH_ERR_NO_HOSTKEY_LOADED:\n\t\treturn \"could not load host key\";\n\tcase SSH_ERR_NEED_REKEY:\n\t\treturn \"rekeying not supported by peer\";\n\tcase SSH_ERR_PASSPHRASE_TOO_SHORT:\n\t\treturn \"passphrase is too short (minimum five characters)\";\n\tcase SSH_ERR_FILE_CHANGED:\n\t\treturn \"file changed while reading\";\n\tcase SSH_ERR_KEY_UNKNOWN_CIPHER:\n\t\treturn \"key encrypted using unsupported cipher\";\n\tcase SSH_ERR_KEY_WRONG_PASSPHRASE:\n\t\treturn \"incorrect passphrase supplied to decrypt private key\";\n\tcase SSH_ERR_KEY_BAD_PERMISSIONS:\n\t\treturn \"bad permissions\";\n\tcase SSH_ERR_KEY_CERT_MISMATCH:\n\t\treturn \"certificate does not match key\";\n\tcase SSH_ERR_KEY_NOT_FOUND:\n\t\treturn \"key not found\";\n\tcase SSH_ERR_AGENT_NOT_PRESENT:\n\t\treturn \"agent not present\";\n\tcase SSH_ERR_AGENT_NO_IDENTITIES:\n\t\treturn \"agent contains no identities\";\n\tcase SSH_ERR_BUFFER_READ_ONLY:\n\t\treturn \"internal error: buffer is read-only\";\n\tcase SSH_ERR_KRL_BAD_MAGIC:\n\t\treturn \"KRL file has invalid magic number\";\n\tcase SSH_ERR_KEY_REVOKED:\n\t\treturn \"Key is revoked\";\n\tcase SSH_ERR_CONN_CLOSED:\n\t\treturn \"Connection closed\";\n\tcase SSH_ERR_CONN_TIMEOUT:\n\t\treturn \"Connection timed out\";\n\tcase SSH_ERR_CONN_CORRUPT:\n\t\treturn \"Connection corrupted\";\n\tcase SSH_ERR_PROTOCOL_ERROR:\n\t\treturn \"Protocol error\";\n\tcase SSH_ERR_KEY_LENGTH:\n\t\treturn \"Invalid key length\";\n\tcase SSH_ERR_NUMBER_TOO_LARGE:\n\t\treturn \"number is too large\";\n\tcase SSH_ERR_SIGN_ALG_UNSUPPORTED:\n\t\treturn \"signature algorithm not supported\";\n\tdefault:\n\t\treturn \"unknown error\";\n\t}\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include <string.h>\n#include <errno.h>\n\nconst char *\nssh_err(int n)\n{\n\tswitch (n) {\n\tcase SSH_ERR_SUCCESS:\n\t\treturn \"success\";\n\tcase SSH_ERR_INTERNAL_ERROR:\n\t\treturn \"unexpected internal error\";\n\tcase SSH_ERR_ALLOC_FAIL:\n\t\treturn \"memory allocation failed\";\n\tcase SSH_ERR_MESSAGE_INCOMPLETE:\n\t\treturn \"incomplete message\";\n\tcase SSH_ERR_INVALID_FORMAT:\n\t\treturn \"invalid format\";\n\tcase SSH_ERR_BIGNUM_IS_NEGATIVE:\n\t\treturn \"bignum is negative\";\n\tcase SSH_ERR_STRING_TOO_LARGE:\n\t\treturn \"string is too large\";\n\tcase SSH_ERR_BIGNUM_TOO_LARGE:\n\t\treturn \"bignum is too large\";\n\tcase SSH_ERR_ECPOINT_TOO_LARGE:\n\t\treturn \"elliptic curve point is too large\";\n\tcase SSH_ERR_NO_BUFFER_SPACE:\n\t\treturn \"insufficient buffer space\";\n\tcase SSH_ERR_INVALID_ARGUMENT:\n\t\treturn \"invalid argument\";\n\tcase SSH_ERR_KEY_BITS_MISMATCH:\n\t\treturn \"key bits do not match\";\n\tcase SSH_ERR_EC_CURVE_INVALID:\n\t\treturn \"invalid elliptic curve\";\n\tcase SSH_ERR_KEY_TYPE_MISMATCH:\n\t\treturn \"key type does not match\";\n\tcase SSH_ERR_KEY_TYPE_UNKNOWN:\n\t\treturn \"unknown or unsupported key type\";\n\tcase SSH_ERR_EC_CURVE_MISMATCH:\n\t\treturn \"elliptic curve does not match\";\n\tcase SSH_ERR_EXPECTED_CERT:\n\t\treturn \"plain key provided where certificate required\";\n\tcase SSH_ERR_KEY_LACKS_CERTBLOB:\n\t\treturn \"key lacks certificate data\";\n\tcase SSH_ERR_KEY_CERT_UNKNOWN_TYPE:\n\t\treturn \"unknown/unsupported certificate type\";\n\tcase SSH_ERR_KEY_CERT_INVALID_SIGN_KEY:\n\t\treturn \"invalid certificate signing key\";\n\tcase SSH_ERR_KEY_INVALID_EC_VALUE:\n\t\treturn \"invalid elliptic curve value\";\n\tcase SSH_ERR_SIGNATURE_INVALID:\n\t\treturn \"incorrect signature\";\n\tcase SSH_ERR_LIBCRYPTO_ERROR:\n\t\treturn \"error in libcrypto\";  /* XXX fetch and return */\n\tcase SSH_ERR_UNEXPECTED_TRAILING_DATA:\n\t\treturn \"unexpected bytes remain after decoding\";\n\tcase SSH_ERR_SYSTEM_ERROR:\n\t\treturn strerror(errno);\n\tcase SSH_ERR_KEY_CERT_INVALID:\n\t\treturn \"invalid certificate\";\n\tcase SSH_ERR_AGENT_COMMUNICATION:\n\t\treturn \"communication with agent failed\";\n\tcase SSH_ERR_AGENT_FAILURE:\n\t\treturn \"agent refused operation\";\n\tcase SSH_ERR_DH_GEX_OUT_OF_RANGE:\n\t\treturn \"DH GEX group out of range\";\n\tcase SSH_ERR_DISCONNECTED:\n\t\treturn \"disconnected\";\n\tcase SSH_ERR_MAC_INVALID:\n\t\treturn \"message authentication code incorrect\";\n\tcase SSH_ERR_NO_CIPHER_ALG_MATCH:\n\t\treturn \"no matching cipher found\";\n\tcase SSH_ERR_NO_MAC_ALG_MATCH:\n\t\treturn \"no matching MAC found\";\n\tcase SSH_ERR_NO_COMPRESS_ALG_MATCH:\n\t\treturn \"no matching compression method found\";\n\tcase SSH_ERR_NO_KEX_ALG_MATCH:\n\t\treturn \"no matching key exchange method found\";\n\tcase SSH_ERR_NO_HOSTKEY_ALG_MATCH:\n\t\treturn \"no matching host key type found\";\n\tcase SSH_ERR_PROTOCOL_MISMATCH:\n\t\treturn \"protocol version mismatch\";\n\tcase SSH_ERR_NO_PROTOCOL_VERSION:\n\t\treturn \"could not read protocol version\";\n\tcase SSH_ERR_NO_HOSTKEY_LOADED:\n\t\treturn \"could not load host key\";\n\tcase SSH_ERR_NEED_REKEY:\n\t\treturn \"rekeying not supported by peer\";\n\tcase SSH_ERR_PASSPHRASE_TOO_SHORT:\n\t\treturn \"passphrase is too short (minimum five characters)\";\n\tcase SSH_ERR_FILE_CHANGED:\n\t\treturn \"file changed while reading\";\n\tcase SSH_ERR_KEY_UNKNOWN_CIPHER:\n\t\treturn \"key encrypted using unsupported cipher\";\n\tcase SSH_ERR_KEY_WRONG_PASSPHRASE:\n\t\treturn \"incorrect passphrase supplied to decrypt private key\";\n\tcase SSH_ERR_KEY_BAD_PERMISSIONS:\n\t\treturn \"bad permissions\";\n\tcase SSH_ERR_KEY_CERT_MISMATCH:\n\t\treturn \"certificate does not match key\";\n\tcase SSH_ERR_KEY_NOT_FOUND:\n\t\treturn \"key not found\";\n\tcase SSH_ERR_AGENT_NOT_PRESENT:\n\t\treturn \"agent not present\";\n\tcase SSH_ERR_AGENT_NO_IDENTITIES:\n\t\treturn \"agent contains no identities\";\n\tcase SSH_ERR_BUFFER_READ_ONLY:\n\t\treturn \"internal error: buffer is read-only\";\n\tcase SSH_ERR_KRL_BAD_MAGIC:\n\t\treturn \"KRL file has invalid magic number\";\n\tcase SSH_ERR_KEY_REVOKED:\n\t\treturn \"Key is revoked\";\n\tcase SSH_ERR_CONN_CLOSED:\n\t\treturn \"Connection closed\";\n\tcase SSH_ERR_CONN_TIMEOUT:\n\t\treturn \"Connection timed out\";\n\tcase SSH_ERR_CONN_CORRUPT:\n\t\treturn \"Connection corrupted\";\n\tcase SSH_ERR_PROTOCOL_ERROR:\n\t\treturn \"Protocol error\";\n\tcase SSH_ERR_KEY_LENGTH:\n\t\treturn \"Invalid key length\";\n\tcase SSH_ERR_NUMBER_TOO_LARGE:\n\t\treturn \"number is too large\";\n\tcase SSH_ERR_SIGN_ALG_UNSUPPORTED:\n\t\treturn \"signature algorithm not supported\";\n\tdefault:\n\t\treturn \"unknown error\";\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_get_u32",
          "args": [
            "buf",
            "NULL"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_get_u32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "57-68",
          "snippet": "int\nsshbuf_get_u32(struct sshbuf *buf, u_int32_t *valp)\n{\n\tconst u_char *p = sshbuf_ptr(buf);\n\tint r;\n\n\tif ((r = sshbuf_consume(buf, 4)) < 0)\n\t\treturn r;\n\tif (valp != NULL)\n\t\t*valp = PEEK_U32(p);\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_get_u32(struct sshbuf *buf, u_int32_t *valp)\n{\n\tconst u_char *p = sshbuf_ptr(buf);\n\tint r;\n\n\tif ((r = sshbuf_consume(buf, 4)) < 0)\n\t\treturn r;\n\tif (valp != NULL)\n\t\t*valp = PEEK_U32(p);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"Ignoring unsupported tty mode opcode %d (0x%x)\"",
            "opcode",
            "opcode"
          ],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"cfsetospeed failed for %d\"",
            "baud"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "162-170",
          "snippet": "void\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cfsetospeed",
          "args": [
            "&tio",
            "baud_to_speed(baud)"
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "cfsetospeed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-nextstep.c",
          "lines": "90-95",
          "snippet": "int\ncfsetospeed(struct termios *t,int speed)\n{\n\tt->c_ospeed = speed;\n\treturn (0);\n}",
          "includes": [
            "#include \"bsd-nextstep.h\"",
            "#include <sys/wait.h>",
            "#include <errno.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bsd-nextstep.h\"\n#include <sys/wait.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\ncfsetospeed(struct termios *t,int speed)\n{\n\tt->c_ospeed = speed;\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "baud_to_speed",
          "args": [
            "baud"
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "baud_to_speed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ttymodes.c",
          "lines": "161-245",
          "snippet": "static speed_t\nbaud_to_speed(int baud)\n{\n\tswitch (baud) {\n\tcase 0:\n\t\treturn B0;\n\tcase 50:\n\t\treturn B50;\n\tcase 75:\n\t\treturn B75;\n\tcase 110:\n\t\treturn B110;\n\tcase 134:\n\t\treturn B134;\n\tcase 150:\n\t\treturn B150;\n\tcase 200:\n\t\treturn B200;\n\tcase 300:\n\t\treturn B300;\n\tcase 600:\n\t\treturn B600;\n\tcase 1200:\n\t\treturn B1200;\n\tcase 1800:\n\t\treturn B1800;\n\tcase 2400:\n\t\treturn B2400;\n\tcase 4800:\n\t\treturn B4800;\n\tcase 9600:\n\t\treturn B9600;\n\n#ifdef B19200\n\tcase 19200:\n\t\treturn B19200;\n#else /* B19200 */\n#ifdef EXTA\n\tcase 19200:\n\t\treturn EXTA;\n#endif /* EXTA */\n#endif /* B19200 */\n\n#ifdef B38400\n\tcase 38400:\n\t\treturn B38400;\n#else /* B38400 */\n#ifdef EXTB\n\tcase 38400:\n\t\treturn EXTB;\n#endif /* EXTB */\n#endif /* B38400 */\n\n#ifdef B7200\n\tcase 7200:\n\t\treturn B7200;\n#endif /* B7200 */\n#ifdef B14400\n\tcase 14400:\n\t\treturn B14400;\n#endif /* B14400 */\n#ifdef B28800\n\tcase 28800:\n\t\treturn B28800;\n#endif /* B28800 */\n#ifdef B57600\n\tcase 57600:\n\t\treturn B57600;\n#endif /* B57600 */\n#ifdef B76800\n\tcase 76800:\n\t\treturn B76800;\n#endif /* B76800 */\n#ifdef B115200\n\tcase 115200:\n\t\treturn B115200;\n#endif /* B115200 */\n#ifdef B230400\n\tcase 230400:\n\t\treturn B230400;\n#endif /* B230400 */\n\tdefault:\n\t\treturn B9600;\n\t}\n}",
          "includes": [
            "#include \"ttymodes.h\"",
            "#include \"ttymodes.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"compat.h\"",
            "#include \"log.h\"",
            "#include \"packet.h\"",
            "#include <stdarg.h>",
            "#include <termios.h>",
            "#include <string.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ttymodes.h\"\n#include \"ttymodes.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"compat.h\"\n#include \"log.h\"\n#include \"packet.h\"\n#include <stdarg.h>\n#include <termios.h>\n#include <string.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic speed_t\nbaud_to_speed(int baud)\n{\n\tswitch (baud) {\n\tcase 0:\n\t\treturn B0;\n\tcase 50:\n\t\treturn B50;\n\tcase 75:\n\t\treturn B75;\n\tcase 110:\n\t\treturn B110;\n\tcase 134:\n\t\treturn B134;\n\tcase 150:\n\t\treturn B150;\n\tcase 200:\n\t\treturn B200;\n\tcase 300:\n\t\treturn B300;\n\tcase 600:\n\t\treturn B600;\n\tcase 1200:\n\t\treturn B1200;\n\tcase 1800:\n\t\treturn B1800;\n\tcase 2400:\n\t\treturn B2400;\n\tcase 4800:\n\t\treturn B4800;\n\tcase 9600:\n\t\treturn B9600;\n\n#ifdef B19200\n\tcase 19200:\n\t\treturn B19200;\n#else /* B19200 */\n#ifdef EXTA\n\tcase 19200:\n\t\treturn EXTA;\n#endif /* EXTA */\n#endif /* B19200 */\n\n#ifdef B38400\n\tcase 38400:\n\t\treturn B38400;\n#else /* B38400 */\n#ifdef EXTB\n\tcase 38400:\n\t\treturn EXTB;\n#endif /* EXTB */\n#endif /* B38400 */\n\n#ifdef B7200\n\tcase 7200:\n\t\treturn B7200;\n#endif /* B7200 */\n#ifdef B14400\n\tcase 14400:\n\t\treturn B14400;\n#endif /* B14400 */\n#ifdef B28800\n\tcase 28800:\n\t\treturn B28800;\n#endif /* B28800 */\n#ifdef B57600\n\tcase 57600:\n\t\treturn B57600;\n#endif /* B57600 */\n#ifdef B76800\n\tcase 76800:\n\t\treturn B76800;\n#endif /* B76800 */\n#ifdef B115200\n\tcase 115200:\n\t\treturn B115200;\n#endif /* B115200 */\n#ifdef B230400\n\tcase 230400:\n\t\treturn B230400;\n#endif /* B230400 */\n\tdefault:\n\t\treturn B9600;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "cfsetispeed",
          "args": [
            "&tio",
            "baud_to_speed(baud)"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "cfsetispeed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-nextstep.c",
          "lines": "97-102",
          "snippet": "int\ncfsetispeed(struct termios *t, int speed)\n{\n\tt->c_ispeed = speed;\n\treturn (0);\n}",
          "includes": [
            "#include \"bsd-nextstep.h\"",
            "#include <sys/wait.h>",
            "#include <errno.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bsd-nextstep.h\"\n#include <sys/wait.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\ncfsetispeed(struct termios *t, int speed)\n{\n\tt->c_ispeed = speed;\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_get_u8",
          "args": [
            "buf",
            "&opcode"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_get_u8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "83-94",
          "snippet": "int\nsshbuf_get_u8(struct sshbuf *buf, u_char *valp)\n{\n\tconst u_char *p = sshbuf_ptr(buf);\n\tint r;\n\n\tif ((r = sshbuf_consume(buf, 1)) < 0)\n\t\treturn r;\n\tif (valp != NULL)\n\t\t*valp = (u_int8_t)*p;\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_get_u8(struct sshbuf *buf, u_char *valp)\n{\n\tconst u_char *p = sshbuf_ptr(buf);\n\tint r;\n\n\tif ((r = sshbuf_consume(buf, 1)) < 0)\n\t\treturn r;\n\tif (valp != NULL)\n\t\t*valp = (u_int8_t)*p;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "tcgetattr",
          "args": [
            "fd",
            "&tio"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "tcgetattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-nextstep.c",
          "lines": "46-50",
          "snippet": "int\ntcgetattr(int fd, struct termios *t)\n{\n\treturn (ioctl(fd, TIOCGETA, t));\n}",
          "includes": [
            "#include \"bsd-nextstep.h\"",
            "#include <sys/wait.h>",
            "#include <errno.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bsd-nextstep.h\"\n#include <sys/wait.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\ntcgetattr(int fd, struct termios *t)\n{\n\treturn (ioctl(fd, TIOCGETA, t));\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_from",
          "args": [
            "data",
            "len"
          ],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_from",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "87-102",
          "snippet": "struct sshbuf *\nsshbuf_from(const void *blob, size_t len)\n{\n\tstruct sshbuf *ret;\n\n\tif (blob == NULL || len > SSHBUF_SIZE_MAX ||\n\t    (ret = calloc(sizeof(*ret), 1)) == NULL)\n\t\treturn NULL;\n\tret->alloc = ret->size = ret->max_size = len;\n\tret->readonly = 1;\n\tret->refcount = 1;\n\tret->parent = NULL;\n\tret->cd = blob;\n\tret->d = NULL;\n\treturn ret;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct sshbuf *\nsshbuf_from(const void *blob, size_t len)\n{\n\tstruct sshbuf *ret;\n\n\tif (blob == NULL || len > SSHBUF_SIZE_MAX ||\n\t    (ret = calloc(sizeof(*ret), 1)) == NULL)\n\t\treturn NULL;\n\tret->alloc = ret->size = ret->max_size = len;\n\tret->readonly = 1;\n\tret->refcount = 1;\n\tret->parent = NULL;\n\tret->cd = blob;\n\tret->d = NULL;\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshpkt_get_string_direct",
          "args": [
            "ssh",
            "&data",
            "&len"
          ],
          "line": 353
        },
        "resolved": true,
        "details": {
          "function_name": "sshpkt_get_string_direct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "2520-2524",
          "snippet": "int\nsshpkt_get_string_direct(struct ssh *ssh, const u_char **valp, size_t *lenp)\n{\n\treturn sshbuf_get_string_direct(ssh->state->incoming_packet, valp, lenp);\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshpkt_get_string_direct(struct ssh *ssh, const u_char **valp, size_t *lenp)\n{\n\treturn sshbuf_get_string_direct(ssh->state->incoming_packet, valp, lenp);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ttymodes.h\"\n#include \"ttymodes.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"compat.h\"\n#include \"log.h\"\n#include \"packet.h\"\n#include <stdarg.h>\n#include <termios.h>\n#include <string.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define TTY_OP_OSPEED\t129\n#define TTY_OP_ISPEED\t128\n#define TTY_OP_END\t\t0\n\nvoid\nssh_tty_parse_modes(struct ssh *ssh, int fd)\n{\n\tstruct termios tio;\n\tstruct sshbuf *buf;\n\tconst u_char *data;\n\tu_char opcode;\n\tu_int baud, u;\n\tint r, failure = 0;\n\tsize_t len;\n\n\tif ((r = sshpkt_get_string_direct(ssh, &data, &len)) != 0)\n\t\tfatal(\"%s: packet error: %s\", __func__, ssh_err(r));\n\tif (len == 0)\n\t\treturn;\n\tif ((buf = sshbuf_from(data, len)) == NULL) {\n\t\terror(\"%s: sshbuf_from failed\", __func__);\n\t\treturn;\n\t}\n\n\t/*\n\t * Get old attributes for the terminal.  We will modify these\n\t * flags. I am hoping that if there are any machine-specific\n\t * modes, they will initially have reasonable values.\n\t */\n\tif (tcgetattr(fd, &tio) == -1) {\n\t\tlogit(\"tcgetattr: %.100s\", strerror(errno));\n\t\tfailure = -1;\n\t}\n\n\twhile (sshbuf_len(buf) > 0) {\n\t\tif ((r = sshbuf_get_u8(buf, &opcode)) != 0)\n\t\t\tfatal(\"%s: packet error: %s\", __func__, ssh_err(r));\n\t\tswitch (opcode) {\n\t\tcase TTY_OP_END:\n\t\t\tgoto set;\n\n\t\tcase TTY_OP_ISPEED:\n\t\t\tif ((r = sshbuf_get_u32(buf, &baud)) != 0)\n\t\t\t\tfatal(\"%s: packet error: %s\",\n\t\t\t\t    __func__, ssh_err(r));\n\t\t\tif (failure != -1 &&\n\t\t\t    cfsetispeed(&tio, baud_to_speed(baud)) == -1)\n\t\t\t\terror(\"cfsetispeed failed for %d\", baud);\n\t\t\tbreak;\n\n\t\tcase TTY_OP_OSPEED:\n\t\t\tif ((r = sshbuf_get_u32(buf, &baud)) != 0)\n\t\t\t\tfatal(\"%s: packet error: %s\",\n\t\t\t\t    __func__, ssh_err(r));\n\t\t\tif (failure != -1 &&\n\t\t\t    cfsetospeed(&tio, baud_to_speed(baud)) == -1)\n\t\t\t\terror(\"cfsetospeed failed for %d\", baud);\n\t\t\tbreak;\n\n#define TTYCHAR(NAME, OP) \\\n\t\tcase OP: \\\n\t\t\tif ((r = sshbuf_get_u32(buf, &u)) != 0) \\\n\t\t\t\tfatal(\"%s: packet error: %s\", __func__, \\\n\t\t\t\t    ssh_err(r)); \\\n\t\t\ttio.c_cc[NAME] = special_char_decode(u); \\\n\t\t\tbreak;\n#define TTYMODE(NAME, FIELD, OP) \\\n\t\tcase OP: \\\n\t\t\tif ((r = sshbuf_get_u32(buf, &u)) != 0) \\\n\t\t\t\tfatal(\"%s: packet error: %s\", __func__, \\\n\t\t\t\t    ssh_err(r)); \\\n\t\t\tif (u) \\\n\t\t\t\ttio.FIELD |= NAME; \\\n\t\t\telse \\\n\t\t\t\ttio.FIELD &= ~NAME; \\\n\t\t\tbreak;\n\n#include \"ttymodes.h\"\n\n#undef TTYCHAR\n#undef TTYMODE\n\n\t\tdefault:\n\t\t\tdebug(\"Ignoring unsupported tty mode opcode %d (0x%x)\",\n\t\t\t    opcode, opcode);\n\t\t\t/*\n\t\t\t * SSH2:\n\t\t\t * Opcodes 1 to 159 are defined to have a uint32\n\t\t\t * argument.\n\t\t\t * Opcodes 160 to 255 are undefined and cause parsing\n\t\t\t * to stop.\n\t\t\t */\n\t\t\tif (opcode > 0 && opcode < 160) {\n\t\t\t\tif ((r = sshbuf_get_u32(buf, NULL)) != 0)\n\t\t\t\t\tfatal(\"%s: packet error: %s\", __func__,\n\t\t\t\t\t    ssh_err(r));\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tlogit(\"%s: unknown opcode %d\", __func__,\n\t\t\t\t    opcode);\n\t\t\t\tgoto set;\n\t\t\t}\n\t\t}\n\t}\n\nset:\n\tlen = sshbuf_len(buf);\n\tsshbuf_free(buf);\n\tif (len > 0) {\n\t\tlogit(\"%s: %zu bytes left\", __func__, len);\n\t\treturn;\t\t/* Don't process bytes passed */\n\t}\n\tif (failure == -1)\n\t\treturn;\t\t/* Packet parsed ok but tcgetattr() failed */\n\n\t/* Set the new modes for the terminal. */\n\tif (tcsetattr(fd, TCSANOW, &tio) == -1)\n\t\tlogit(\"Setting tty modes failed: %.100s\", strerror(errno));\n}"
  },
  {
    "function_name": "ssh_tty_make_modes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ttymodes.c",
    "lines": "278-336",
    "snippet": "void\nssh_tty_make_modes(struct ssh *ssh, int fd, struct termios *tiop)\n{\n\tstruct termios tio;\n\tstruct sshbuf *buf;\n\tint r, ibaud, obaud;\n\n\tif ((buf = sshbuf_new()) == NULL)\n\t\tfatal(\"%s: sshbuf_new failed\", __func__);\n\n\tif (tiop == NULL) {\n\t\tif (fd == -1) {\n\t\t\tdebug(\"%s: no fd or tio\", __func__);\n\t\t\tgoto end;\n\t\t}\n\t\tif (tcgetattr(fd, &tio) == -1) {\n\t\t\tlogit(\"tcgetattr: %.100s\", strerror(errno));\n\t\t\tgoto end;\n\t\t}\n\t} else\n\t\ttio = *tiop;\n\n\t/* Store input and output baud rates. */\n\tobaud = speed_to_baud(cfgetospeed(&tio));\n\tibaud = speed_to_baud(cfgetispeed(&tio));\n\tif ((r = sshbuf_put_u8(buf, TTY_OP_OSPEED)) != 0 ||\n\t    (r = sshbuf_put_u32(buf, obaud)) != 0 ||\n\t    (r = sshbuf_put_u8(buf, TTY_OP_ISPEED)) != 0 ||\n\t    (r = sshbuf_put_u32(buf, ibaud)) != 0)\n\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r));\n\n\t/* Store values of mode flags. */\n#define TTYCHAR(NAME, OP) \\\n\tif ((r = sshbuf_put_u8(buf, OP)) != 0 || \\\n\t    (r = sshbuf_put_u32(buf, \\\n\t    special_char_encode(tio.c_cc[NAME]))) != 0) \\\n\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r)); \\\n\n#define SSH_TTYMODE_IUTF8 42  /* for SSH_BUG_UTF8TTYMODE */\n\n#define TTYMODE(NAME, FIELD, OP) \\\n\tif (OP == SSH_TTYMODE_IUTF8 && (datafellows & SSH_BUG_UTF8TTYMODE)) { \\\n\t\tdebug3(\"%s: SSH_BUG_UTF8TTYMODE\", __func__); \\\n\t} else if ((r = sshbuf_put_u8(buf, OP)) != 0 || \\\n\t    (r = sshbuf_put_u32(buf, ((tio.FIELD & NAME) != 0))) != 0) \\\n\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r)); \\\n\n#include \"ttymodes.h\"\n\n#undef TTYCHAR\n#undef TTYMODE\n\nend:\n\t/* Mark end of mode data. */\n\tif ((r = sshbuf_put_u8(buf, TTY_OP_END)) != 0 ||\n\t    (r = sshpkt_put_stringb(ssh, buf)) != 0)\n\t\tfatal(\"%s: packet error: %s\", __func__, ssh_err(r));\n\tsshbuf_free(buf);\n}",
    "includes": [
      "#include \"ttymodes.h\"",
      "#include \"ttymodes.h\"",
      "#include \"ssherr.h\"",
      "#include \"sshbuf.h\"",
      "#include \"compat.h\"",
      "#include \"log.h\"",
      "#include \"packet.h\"",
      "#include <stdarg.h>",
      "#include <termios.h>",
      "#include <string.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [
      "#define SSH_TTYMODE_IUTF8 42  /* for SSH_BUG_UTF8TTYMODE */",
      "#define TTY_OP_OSPEED\t129",
      "#define TTY_OP_ISPEED\t128",
      "#define TTY_OP_END\t\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sshbuf_free",
          "args": [
            "buf"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "133-166",
          "snippet": "void\nsshbuf_free(struct sshbuf *buf)\n{\n\tif (buf == NULL)\n\t\treturn;\n\t/*\n\t * The following will leak on insane buffers, but this is the safest\n\t * course of action - an invalid pointer or already-freed pointer may\n\t * have been passed to us and continuing to scribble over memory would\n\t * be bad.\n\t */\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn;\n\t/*\n\t * If we are a child, the free our parent to decrement its reference\n\t * count and possibly free it.\n\t */\n\tsshbuf_free(buf->parent);\n\tbuf->parent = NULL;\n\t/*\n\t * If we are a parent with still-extant children, then don't free just\n\t * yet. The last child's call to sshbuf_free should decrement our\n\t * refcount to 0 and trigger the actual free.\n\t */\n\tbuf->refcount--;\n\tif (buf->refcount > 0)\n\t\treturn;\n\tif (!buf->readonly) {\n\t\texplicit_bzero(buf->d, buf->alloc);\n\t\tfree(buf->d);\n\t}\n\texplicit_bzero(buf, sizeof(*buf));\n\tfree(buf);\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nsshbuf_free(struct sshbuf *buf)\n{\n\tif (buf == NULL)\n\t\treturn;\n\t/*\n\t * The following will leak on insane buffers, but this is the safest\n\t * course of action - an invalid pointer or already-freed pointer may\n\t * have been passed to us and continuing to scribble over memory would\n\t * be bad.\n\t */\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn;\n\t/*\n\t * If we are a child, the free our parent to decrement its reference\n\t * count and possibly free it.\n\t */\n\tsshbuf_free(buf->parent);\n\tbuf->parent = NULL;\n\t/*\n\t * If we are a parent with still-extant children, then don't free just\n\t * yet. The last child's call to sshbuf_free should decrement our\n\t * refcount to 0 and trigger the actual free.\n\t */\n\tbuf->refcount--;\n\tif (buf->refcount > 0)\n\t\treturn;\n\tif (!buf->readonly) {\n\t\texplicit_bzero(buf->d, buf->alloc);\n\t\tfree(buf->d);\n\t}\n\texplicit_bzero(buf, sizeof(*buf));\n\tfree(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"%s: packet error: %s\"",
            "__func__",
            "ssh_err(r)"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fatal.c",
          "lines": "36-45",
          "snippet": "void\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\tcleanup_exit(255);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\tcleanup_exit(255);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_err",
          "args": [
            "r"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssherr.c",
          "lines": "22-147",
          "snippet": "const char *\nssh_err(int n)\n{\n\tswitch (n) {\n\tcase SSH_ERR_SUCCESS:\n\t\treturn \"success\";\n\tcase SSH_ERR_INTERNAL_ERROR:\n\t\treturn \"unexpected internal error\";\n\tcase SSH_ERR_ALLOC_FAIL:\n\t\treturn \"memory allocation failed\";\n\tcase SSH_ERR_MESSAGE_INCOMPLETE:\n\t\treturn \"incomplete message\";\n\tcase SSH_ERR_INVALID_FORMAT:\n\t\treturn \"invalid format\";\n\tcase SSH_ERR_BIGNUM_IS_NEGATIVE:\n\t\treturn \"bignum is negative\";\n\tcase SSH_ERR_STRING_TOO_LARGE:\n\t\treturn \"string is too large\";\n\tcase SSH_ERR_BIGNUM_TOO_LARGE:\n\t\treturn \"bignum is too large\";\n\tcase SSH_ERR_ECPOINT_TOO_LARGE:\n\t\treturn \"elliptic curve point is too large\";\n\tcase SSH_ERR_NO_BUFFER_SPACE:\n\t\treturn \"insufficient buffer space\";\n\tcase SSH_ERR_INVALID_ARGUMENT:\n\t\treturn \"invalid argument\";\n\tcase SSH_ERR_KEY_BITS_MISMATCH:\n\t\treturn \"key bits do not match\";\n\tcase SSH_ERR_EC_CURVE_INVALID:\n\t\treturn \"invalid elliptic curve\";\n\tcase SSH_ERR_KEY_TYPE_MISMATCH:\n\t\treturn \"key type does not match\";\n\tcase SSH_ERR_KEY_TYPE_UNKNOWN:\n\t\treturn \"unknown or unsupported key type\";\n\tcase SSH_ERR_EC_CURVE_MISMATCH:\n\t\treturn \"elliptic curve does not match\";\n\tcase SSH_ERR_EXPECTED_CERT:\n\t\treturn \"plain key provided where certificate required\";\n\tcase SSH_ERR_KEY_LACKS_CERTBLOB:\n\t\treturn \"key lacks certificate data\";\n\tcase SSH_ERR_KEY_CERT_UNKNOWN_TYPE:\n\t\treturn \"unknown/unsupported certificate type\";\n\tcase SSH_ERR_KEY_CERT_INVALID_SIGN_KEY:\n\t\treturn \"invalid certificate signing key\";\n\tcase SSH_ERR_KEY_INVALID_EC_VALUE:\n\t\treturn \"invalid elliptic curve value\";\n\tcase SSH_ERR_SIGNATURE_INVALID:\n\t\treturn \"incorrect signature\";\n\tcase SSH_ERR_LIBCRYPTO_ERROR:\n\t\treturn \"error in libcrypto\";  /* XXX fetch and return */\n\tcase SSH_ERR_UNEXPECTED_TRAILING_DATA:\n\t\treturn \"unexpected bytes remain after decoding\";\n\tcase SSH_ERR_SYSTEM_ERROR:\n\t\treturn strerror(errno);\n\tcase SSH_ERR_KEY_CERT_INVALID:\n\t\treturn \"invalid certificate\";\n\tcase SSH_ERR_AGENT_COMMUNICATION:\n\t\treturn \"communication with agent failed\";\n\tcase SSH_ERR_AGENT_FAILURE:\n\t\treturn \"agent refused operation\";\n\tcase SSH_ERR_DH_GEX_OUT_OF_RANGE:\n\t\treturn \"DH GEX group out of range\";\n\tcase SSH_ERR_DISCONNECTED:\n\t\treturn \"disconnected\";\n\tcase SSH_ERR_MAC_INVALID:\n\t\treturn \"message authentication code incorrect\";\n\tcase SSH_ERR_NO_CIPHER_ALG_MATCH:\n\t\treturn \"no matching cipher found\";\n\tcase SSH_ERR_NO_MAC_ALG_MATCH:\n\t\treturn \"no matching MAC found\";\n\tcase SSH_ERR_NO_COMPRESS_ALG_MATCH:\n\t\treturn \"no matching compression method found\";\n\tcase SSH_ERR_NO_KEX_ALG_MATCH:\n\t\treturn \"no matching key exchange method found\";\n\tcase SSH_ERR_NO_HOSTKEY_ALG_MATCH:\n\t\treturn \"no matching host key type found\";\n\tcase SSH_ERR_PROTOCOL_MISMATCH:\n\t\treturn \"protocol version mismatch\";\n\tcase SSH_ERR_NO_PROTOCOL_VERSION:\n\t\treturn \"could not read protocol version\";\n\tcase SSH_ERR_NO_HOSTKEY_LOADED:\n\t\treturn \"could not load host key\";\n\tcase SSH_ERR_NEED_REKEY:\n\t\treturn \"rekeying not supported by peer\";\n\tcase SSH_ERR_PASSPHRASE_TOO_SHORT:\n\t\treturn \"passphrase is too short (minimum five characters)\";\n\tcase SSH_ERR_FILE_CHANGED:\n\t\treturn \"file changed while reading\";\n\tcase SSH_ERR_KEY_UNKNOWN_CIPHER:\n\t\treturn \"key encrypted using unsupported cipher\";\n\tcase SSH_ERR_KEY_WRONG_PASSPHRASE:\n\t\treturn \"incorrect passphrase supplied to decrypt private key\";\n\tcase SSH_ERR_KEY_BAD_PERMISSIONS:\n\t\treturn \"bad permissions\";\n\tcase SSH_ERR_KEY_CERT_MISMATCH:\n\t\treturn \"certificate does not match key\";\n\tcase SSH_ERR_KEY_NOT_FOUND:\n\t\treturn \"key not found\";\n\tcase SSH_ERR_AGENT_NOT_PRESENT:\n\t\treturn \"agent not present\";\n\tcase SSH_ERR_AGENT_NO_IDENTITIES:\n\t\treturn \"agent contains no identities\";\n\tcase SSH_ERR_BUFFER_READ_ONLY:\n\t\treturn \"internal error: buffer is read-only\";\n\tcase SSH_ERR_KRL_BAD_MAGIC:\n\t\treturn \"KRL file has invalid magic number\";\n\tcase SSH_ERR_KEY_REVOKED:\n\t\treturn \"Key is revoked\";\n\tcase SSH_ERR_CONN_CLOSED:\n\t\treturn \"Connection closed\";\n\tcase SSH_ERR_CONN_TIMEOUT:\n\t\treturn \"Connection timed out\";\n\tcase SSH_ERR_CONN_CORRUPT:\n\t\treturn \"Connection corrupted\";\n\tcase SSH_ERR_PROTOCOL_ERROR:\n\t\treturn \"Protocol error\";\n\tcase SSH_ERR_KEY_LENGTH:\n\t\treturn \"Invalid key length\";\n\tcase SSH_ERR_NUMBER_TOO_LARGE:\n\t\treturn \"number is too large\";\n\tcase SSH_ERR_SIGN_ALG_UNSUPPORTED:\n\t\treturn \"signature algorithm not supported\";\n\tdefault:\n\t\treturn \"unknown error\";\n\t}\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include <string.h>\n#include <errno.h>\n\nconst char *\nssh_err(int n)\n{\n\tswitch (n) {\n\tcase SSH_ERR_SUCCESS:\n\t\treturn \"success\";\n\tcase SSH_ERR_INTERNAL_ERROR:\n\t\treturn \"unexpected internal error\";\n\tcase SSH_ERR_ALLOC_FAIL:\n\t\treturn \"memory allocation failed\";\n\tcase SSH_ERR_MESSAGE_INCOMPLETE:\n\t\treturn \"incomplete message\";\n\tcase SSH_ERR_INVALID_FORMAT:\n\t\treturn \"invalid format\";\n\tcase SSH_ERR_BIGNUM_IS_NEGATIVE:\n\t\treturn \"bignum is negative\";\n\tcase SSH_ERR_STRING_TOO_LARGE:\n\t\treturn \"string is too large\";\n\tcase SSH_ERR_BIGNUM_TOO_LARGE:\n\t\treturn \"bignum is too large\";\n\tcase SSH_ERR_ECPOINT_TOO_LARGE:\n\t\treturn \"elliptic curve point is too large\";\n\tcase SSH_ERR_NO_BUFFER_SPACE:\n\t\treturn \"insufficient buffer space\";\n\tcase SSH_ERR_INVALID_ARGUMENT:\n\t\treturn \"invalid argument\";\n\tcase SSH_ERR_KEY_BITS_MISMATCH:\n\t\treturn \"key bits do not match\";\n\tcase SSH_ERR_EC_CURVE_INVALID:\n\t\treturn \"invalid elliptic curve\";\n\tcase SSH_ERR_KEY_TYPE_MISMATCH:\n\t\treturn \"key type does not match\";\n\tcase SSH_ERR_KEY_TYPE_UNKNOWN:\n\t\treturn \"unknown or unsupported key type\";\n\tcase SSH_ERR_EC_CURVE_MISMATCH:\n\t\treturn \"elliptic curve does not match\";\n\tcase SSH_ERR_EXPECTED_CERT:\n\t\treturn \"plain key provided where certificate required\";\n\tcase SSH_ERR_KEY_LACKS_CERTBLOB:\n\t\treturn \"key lacks certificate data\";\n\tcase SSH_ERR_KEY_CERT_UNKNOWN_TYPE:\n\t\treturn \"unknown/unsupported certificate type\";\n\tcase SSH_ERR_KEY_CERT_INVALID_SIGN_KEY:\n\t\treturn \"invalid certificate signing key\";\n\tcase SSH_ERR_KEY_INVALID_EC_VALUE:\n\t\treturn \"invalid elliptic curve value\";\n\tcase SSH_ERR_SIGNATURE_INVALID:\n\t\treturn \"incorrect signature\";\n\tcase SSH_ERR_LIBCRYPTO_ERROR:\n\t\treturn \"error in libcrypto\";  /* XXX fetch and return */\n\tcase SSH_ERR_UNEXPECTED_TRAILING_DATA:\n\t\treturn \"unexpected bytes remain after decoding\";\n\tcase SSH_ERR_SYSTEM_ERROR:\n\t\treturn strerror(errno);\n\tcase SSH_ERR_KEY_CERT_INVALID:\n\t\treturn \"invalid certificate\";\n\tcase SSH_ERR_AGENT_COMMUNICATION:\n\t\treturn \"communication with agent failed\";\n\tcase SSH_ERR_AGENT_FAILURE:\n\t\treturn \"agent refused operation\";\n\tcase SSH_ERR_DH_GEX_OUT_OF_RANGE:\n\t\treturn \"DH GEX group out of range\";\n\tcase SSH_ERR_DISCONNECTED:\n\t\treturn \"disconnected\";\n\tcase SSH_ERR_MAC_INVALID:\n\t\treturn \"message authentication code incorrect\";\n\tcase SSH_ERR_NO_CIPHER_ALG_MATCH:\n\t\treturn \"no matching cipher found\";\n\tcase SSH_ERR_NO_MAC_ALG_MATCH:\n\t\treturn \"no matching MAC found\";\n\tcase SSH_ERR_NO_COMPRESS_ALG_MATCH:\n\t\treturn \"no matching compression method found\";\n\tcase SSH_ERR_NO_KEX_ALG_MATCH:\n\t\treturn \"no matching key exchange method found\";\n\tcase SSH_ERR_NO_HOSTKEY_ALG_MATCH:\n\t\treturn \"no matching host key type found\";\n\tcase SSH_ERR_PROTOCOL_MISMATCH:\n\t\treturn \"protocol version mismatch\";\n\tcase SSH_ERR_NO_PROTOCOL_VERSION:\n\t\treturn \"could not read protocol version\";\n\tcase SSH_ERR_NO_HOSTKEY_LOADED:\n\t\treturn \"could not load host key\";\n\tcase SSH_ERR_NEED_REKEY:\n\t\treturn \"rekeying not supported by peer\";\n\tcase SSH_ERR_PASSPHRASE_TOO_SHORT:\n\t\treturn \"passphrase is too short (minimum five characters)\";\n\tcase SSH_ERR_FILE_CHANGED:\n\t\treturn \"file changed while reading\";\n\tcase SSH_ERR_KEY_UNKNOWN_CIPHER:\n\t\treturn \"key encrypted using unsupported cipher\";\n\tcase SSH_ERR_KEY_WRONG_PASSPHRASE:\n\t\treturn \"incorrect passphrase supplied to decrypt private key\";\n\tcase SSH_ERR_KEY_BAD_PERMISSIONS:\n\t\treturn \"bad permissions\";\n\tcase SSH_ERR_KEY_CERT_MISMATCH:\n\t\treturn \"certificate does not match key\";\n\tcase SSH_ERR_KEY_NOT_FOUND:\n\t\treturn \"key not found\";\n\tcase SSH_ERR_AGENT_NOT_PRESENT:\n\t\treturn \"agent not present\";\n\tcase SSH_ERR_AGENT_NO_IDENTITIES:\n\t\treturn \"agent contains no identities\";\n\tcase SSH_ERR_BUFFER_READ_ONLY:\n\t\treturn \"internal error: buffer is read-only\";\n\tcase SSH_ERR_KRL_BAD_MAGIC:\n\t\treturn \"KRL file has invalid magic number\";\n\tcase SSH_ERR_KEY_REVOKED:\n\t\treturn \"Key is revoked\";\n\tcase SSH_ERR_CONN_CLOSED:\n\t\treturn \"Connection closed\";\n\tcase SSH_ERR_CONN_TIMEOUT:\n\t\treturn \"Connection timed out\";\n\tcase SSH_ERR_CONN_CORRUPT:\n\t\treturn \"Connection corrupted\";\n\tcase SSH_ERR_PROTOCOL_ERROR:\n\t\treturn \"Protocol error\";\n\tcase SSH_ERR_KEY_LENGTH:\n\t\treturn \"Invalid key length\";\n\tcase SSH_ERR_NUMBER_TOO_LARGE:\n\t\treturn \"number is too large\";\n\tcase SSH_ERR_SIGN_ALG_UNSUPPORTED:\n\t\treturn \"signature algorithm not supported\";\n\tdefault:\n\t\treturn \"unknown error\";\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshpkt_put_stringb",
          "args": [
            "ssh",
            "buf"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "sshpkt_put_stringb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/packet.c",
          "lines": "2465-2469",
          "snippet": "int\nsshpkt_put_stringb(struct ssh *ssh, const struct sshbuf *v)\n{\n\treturn sshbuf_put_stringb(ssh->state->outgoing_packet, v);\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"ssh.h\"",
            "#include \"channels.h\"",
            "#include \"misc.h\"",
            "#include \"canohost.h\"",
            "#include \"log.h\"",
            "#include \"mac.h\"",
            "#include \"digest.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"ssh2.h\"",
            "#include \"compat.h\"",
            "#include \"crc32.h\"",
            "#include \"xmalloc.h\"",
            "#include <zlib.h>",
            "#  include <openssl/ec.h>",
            "# include <openssl/evp.h>",
            "# include <openssl/bn.h>",
            "#include <time.h>",
            "#include <signal.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/socket.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"ssh.h\"\n#include \"channels.h\"\n#include \"misc.h\"\n#include \"canohost.h\"\n#include \"log.h\"\n#include \"mac.h\"\n#include \"digest.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"ssh2.h\"\n#include \"compat.h\"\n#include \"crc32.h\"\n#include \"xmalloc.h\"\n#include <zlib.h>\n#  include <openssl/ec.h>\n# include <openssl/evp.h>\n# include <openssl/bn.h>\n#include <time.h>\n#include <signal.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <netdb.h>\n#include <errno.h>\n#include <arpa/inet.h>\n#include <netinet/ip.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/socket.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshpkt_put_stringb(struct ssh *ssh, const struct sshbuf *v)\n{\n\treturn sshbuf_put_stringb(ssh->state->outgoing_packet, v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_put_u8",
          "args": [
            "buf",
            "TTY_OP_END"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_u8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "335-345",
          "snippet": "int\nsshbuf_put_u8(struct sshbuf *buf, u_char val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 1, &p)) < 0)\n\t\treturn r;\n\tp[0] = val;\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_u8(struct sshbuf *buf, u_char val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 1, &p)) < 0)\n\t\treturn r;\n\tp[0] = val;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_put_u32",
          "args": [
            "buf",
            "ibaud"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_u32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "311-321",
          "snippet": "int\nsshbuf_put_u32(struct sshbuf *buf, u_int32_t val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 4, &p)) < 0)\n\t\treturn r;\n\tPOKE_U32(p, val);\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_u32(struct sshbuf *buf, u_int32_t val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 4, &p)) < 0)\n\t\treturn r;\n\tPOKE_U32(p, val);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "speed_to_baud",
          "args": [
            "cfgetispeed(&tio)"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "speed_to_baud",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ttymodes.c",
          "lines": "72-156",
          "snippet": "static int\nspeed_to_baud(speed_t speed)\n{\n\tswitch (speed) {\n\tcase B0:\n\t\treturn 0;\n\tcase B50:\n\t\treturn 50;\n\tcase B75:\n\t\treturn 75;\n\tcase B110:\n\t\treturn 110;\n\tcase B134:\n\t\treturn 134;\n\tcase B150:\n\t\treturn 150;\n\tcase B200:\n\t\treturn 200;\n\tcase B300:\n\t\treturn 300;\n\tcase B600:\n\t\treturn 600;\n\tcase B1200:\n\t\treturn 1200;\n\tcase B1800:\n\t\treturn 1800;\n\tcase B2400:\n\t\treturn 2400;\n\tcase B4800:\n\t\treturn 4800;\n\tcase B9600:\n\t\treturn 9600;\n\n#ifdef B19200\n\tcase B19200:\n\t\treturn 19200;\n#else /* B19200 */\n#ifdef EXTA\n\tcase EXTA:\n\t\treturn 19200;\n#endif /* EXTA */\n#endif /* B19200 */\n\n#ifdef B38400\n\tcase B38400:\n\t\treturn 38400;\n#else /* B38400 */\n#ifdef EXTB\n\tcase EXTB:\n\t\treturn 38400;\n#endif /* EXTB */\n#endif /* B38400 */\n\n#ifdef B7200\n\tcase B7200:\n\t\treturn 7200;\n#endif /* B7200 */\n#ifdef B14400\n\tcase B14400:\n\t\treturn 14400;\n#endif /* B14400 */\n#ifdef B28800\n\tcase B28800:\n\t\treturn 28800;\n#endif /* B28800 */\n#ifdef B57600\n\tcase B57600:\n\t\treturn 57600;\n#endif /* B57600 */\n#ifdef B76800\n\tcase B76800:\n\t\treturn 76800;\n#endif /* B76800 */\n#ifdef B115200\n\tcase B115200:\n\t\treturn 115200;\n#endif /* B115200 */\n#ifdef B230400\n\tcase B230400:\n\t\treturn 230400;\n#endif /* B230400 */\n\tdefault:\n\t\treturn 9600;\n\t}\n}",
          "includes": [
            "#include \"ttymodes.h\"",
            "#include \"ttymodes.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"compat.h\"",
            "#include \"log.h\"",
            "#include \"packet.h\"",
            "#include <stdarg.h>",
            "#include <termios.h>",
            "#include <string.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ttymodes.h\"\n#include \"ttymodes.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"compat.h\"\n#include \"log.h\"\n#include \"packet.h\"\n#include <stdarg.h>\n#include <termios.h>\n#include <string.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nspeed_to_baud(speed_t speed)\n{\n\tswitch (speed) {\n\tcase B0:\n\t\treturn 0;\n\tcase B50:\n\t\treturn 50;\n\tcase B75:\n\t\treturn 75;\n\tcase B110:\n\t\treturn 110;\n\tcase B134:\n\t\treturn 134;\n\tcase B150:\n\t\treturn 150;\n\tcase B200:\n\t\treturn 200;\n\tcase B300:\n\t\treturn 300;\n\tcase B600:\n\t\treturn 600;\n\tcase B1200:\n\t\treturn 1200;\n\tcase B1800:\n\t\treturn 1800;\n\tcase B2400:\n\t\treturn 2400;\n\tcase B4800:\n\t\treturn 4800;\n\tcase B9600:\n\t\treturn 9600;\n\n#ifdef B19200\n\tcase B19200:\n\t\treturn 19200;\n#else /* B19200 */\n#ifdef EXTA\n\tcase EXTA:\n\t\treturn 19200;\n#endif /* EXTA */\n#endif /* B19200 */\n\n#ifdef B38400\n\tcase B38400:\n\t\treturn 38400;\n#else /* B38400 */\n#ifdef EXTB\n\tcase EXTB:\n\t\treturn 38400;\n#endif /* EXTB */\n#endif /* B38400 */\n\n#ifdef B7200\n\tcase B7200:\n\t\treturn 7200;\n#endif /* B7200 */\n#ifdef B14400\n\tcase B14400:\n\t\treturn 14400;\n#endif /* B14400 */\n#ifdef B28800\n\tcase B28800:\n\t\treturn 28800;\n#endif /* B28800 */\n#ifdef B57600\n\tcase B57600:\n\t\treturn 57600;\n#endif /* B57600 */\n#ifdef B76800\n\tcase B76800:\n\t\treturn 76800;\n#endif /* B76800 */\n#ifdef B115200\n\tcase B115200:\n\t\treturn 115200;\n#endif /* B115200 */\n#ifdef B230400\n\tcase B230400:\n\t\treturn 230400;\n#endif /* B230400 */\n\tdefault:\n\t\treturn 9600;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "cfgetispeed",
          "args": [
            "&tio"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "cfgetispeed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-nextstep.c",
          "lines": "85-88",
          "snippet": "speed_t cfgetispeed(const struct termios *t)\n{\n\treturn (t->c_ispeed);\n}",
          "includes": [
            "#include \"bsd-nextstep.h\"",
            "#include <sys/wait.h>",
            "#include <errno.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bsd-nextstep.h\"\n#include <sys/wait.h>\n#include <errno.h>\n#include \"includes.h\"\n\nspeed_t cfgetispeed(const struct termios *t)\n{\n\treturn (t->c_ispeed);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cfgetospeed",
          "args": [
            "&tio"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "cfgetospeed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-nextstep.c",
          "lines": "80-83",
          "snippet": "speed_t cfgetospeed(const struct termios *t)\n{\n\treturn (t->c_ospeed);\n}",
          "includes": [
            "#include \"bsd-nextstep.h\"",
            "#include <sys/wait.h>",
            "#include <errno.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bsd-nextstep.h\"\n#include <sys/wait.h>\n#include <errno.h>\n#include \"includes.h\"\n\nspeed_t cfgetospeed(const struct termios *t)\n{\n\treturn (t->c_ospeed);\n}"
        }
      },
      {
        "call_info": {
          "callee": "logit",
          "args": [
            "\"tcgetattr: %.100s\"",
            "strerror(errno)"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "logit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "198-206",
          "snippet": "void\nlogit(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_INFO, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nlogit(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_INFO, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "errno"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gai_strerror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "140-146",
          "snippet": "const char *\nssh_gai_strerror(int gaierr)\n{\n\tif (gaierr == EAI_SYSTEM && errno != 0)\n\t\treturn strerror(errno);\n\treturn gai_strerror(gaierr);\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst char *\nssh_gai_strerror(int gaierr)\n{\n\tif (gaierr == EAI_SYSTEM && errno != 0)\n\t\treturn strerror(errno);\n\treturn gai_strerror(gaierr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tcgetattr",
          "args": [
            "fd",
            "&tio"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "tcgetattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-nextstep.c",
          "lines": "46-50",
          "snippet": "int\ntcgetattr(int fd, struct termios *t)\n{\n\treturn (ioctl(fd, TIOCGETA, t));\n}",
          "includes": [
            "#include \"bsd-nextstep.h\"",
            "#include <sys/wait.h>",
            "#include <errno.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bsd-nextstep.h\"\n#include <sys/wait.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\ntcgetattr(int fd, struct termios *t)\n{\n\treturn (ioctl(fd, TIOCGETA, t));\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"%s: no fd or tio\"",
            "__func__"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"%s: sshbuf_new failed\"",
            "__func__"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "match_test_missing_fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/servconf.c",
          "lines": "988-993",
          "snippet": "static void\nmatch_test_missing_fatal(const char *criteria, const char *attrib)\n{\n\tfatal(\"'Match %s' in configuration but '%s' not in connection \"\n\t    \"test specification.\", criteria, attrib);\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"myproposal.h\"",
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"canohost.h\"",
            "#include \"groupaccess.h\"",
            "#include \"channels.h\"",
            "#include \"match.h\"",
            "#include \"mac.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"pathnames.h\"",
            "#include \"compat.h\"",
            "#include \"servconf.h\"",
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"log.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <util.h>",
            "#include <errno.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <netdb.h>",
            "#include <ctype.h>",
            "#include <net/route.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <sys/sysctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"myproposal.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"canohost.h\"\n#include \"groupaccess.h\"\n#include \"channels.h\"\n#include \"match.h\"\n#include \"mac.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"pathnames.h\"\n#include \"compat.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"log.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <util.h>\n#include <errno.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <netdb.h>\n#include <ctype.h>\n#include <net/route.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <sys/sysctl.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic void\nmatch_test_missing_fatal(const char *criteria, const char *attrib)\n{\n\tfatal(\"'Match %s' in configuration but '%s' not in connection \"\n\t    \"test specification.\", criteria, attrib);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_new",
          "args": [],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "68-85",
          "snippet": "struct sshbuf *\nsshbuf_new(void)\n{\n\tstruct sshbuf *ret;\n\n\tif ((ret = calloc(sizeof(*ret), 1)) == NULL)\n\t\treturn NULL;\n\tret->alloc = SSHBUF_SIZE_INIT;\n\tret->max_size = SSHBUF_SIZE_MAX;\n\tret->readonly = 0;\n\tret->refcount = 1;\n\tret->parent = NULL;\n\tif ((ret->cd = ret->d = calloc(1, ret->alloc)) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct sshbuf *\nsshbuf_new(void)\n{\n\tstruct sshbuf *ret;\n\n\tif ((ret = calloc(sizeof(*ret), 1)) == NULL)\n\t\treturn NULL;\n\tret->alloc = SSHBUF_SIZE_INIT;\n\tret->max_size = SSHBUF_SIZE_MAX;\n\tret->readonly = 0;\n\tret->refcount = 1;\n\tret->parent = NULL;\n\tif ((ret->cd = ret->d = calloc(1, ret->alloc)) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ttymodes.h\"\n#include \"ttymodes.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"compat.h\"\n#include \"log.h\"\n#include \"packet.h\"\n#include <stdarg.h>\n#include <termios.h>\n#include <string.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define SSH_TTYMODE_IUTF8 42  /* for SSH_BUG_UTF8TTYMODE */\n#define TTY_OP_OSPEED\t129\n#define TTY_OP_ISPEED\t128\n#define TTY_OP_END\t\t0\n\nvoid\nssh_tty_make_modes(struct ssh *ssh, int fd, struct termios *tiop)\n{\n\tstruct termios tio;\n\tstruct sshbuf *buf;\n\tint r, ibaud, obaud;\n\n\tif ((buf = sshbuf_new()) == NULL)\n\t\tfatal(\"%s: sshbuf_new failed\", __func__);\n\n\tif (tiop == NULL) {\n\t\tif (fd == -1) {\n\t\t\tdebug(\"%s: no fd or tio\", __func__);\n\t\t\tgoto end;\n\t\t}\n\t\tif (tcgetattr(fd, &tio) == -1) {\n\t\t\tlogit(\"tcgetattr: %.100s\", strerror(errno));\n\t\t\tgoto end;\n\t\t}\n\t} else\n\t\ttio = *tiop;\n\n\t/* Store input and output baud rates. */\n\tobaud = speed_to_baud(cfgetospeed(&tio));\n\tibaud = speed_to_baud(cfgetispeed(&tio));\n\tif ((r = sshbuf_put_u8(buf, TTY_OP_OSPEED)) != 0 ||\n\t    (r = sshbuf_put_u32(buf, obaud)) != 0 ||\n\t    (r = sshbuf_put_u8(buf, TTY_OP_ISPEED)) != 0 ||\n\t    (r = sshbuf_put_u32(buf, ibaud)) != 0)\n\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r));\n\n\t/* Store values of mode flags. */\n#define TTYCHAR(NAME, OP) \\\n\tif ((r = sshbuf_put_u8(buf, OP)) != 0 || \\\n\t    (r = sshbuf_put_u32(buf, \\\n\t    special_char_encode(tio.c_cc[NAME]))) != 0) \\\n\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r)); \\\n\n#define SSH_TTYMODE_IUTF8 42  /* for SSH_BUG_UTF8TTYMODE */\n\n#define TTYMODE(NAME, FIELD, OP) \\\n\tif (OP == SSH_TTYMODE_IUTF8 && (datafellows & SSH_BUG_UTF8TTYMODE)) { \\\n\t\tdebug3(\"%s: SSH_BUG_UTF8TTYMODE\", __func__); \\\n\t} else if ((r = sshbuf_put_u8(buf, OP)) != 0 || \\\n\t    (r = sshbuf_put_u32(buf, ((tio.FIELD & NAME) != 0))) != 0) \\\n\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r)); \\\n\n#include \"ttymodes.h\"\n\n#undef TTYCHAR\n#undef TTYMODE\n\nend:\n\t/* Mark end of mode data. */\n\tif ((r = sshbuf_put_u8(buf, TTY_OP_END)) != 0 ||\n\t    (r = sshpkt_put_stringb(ssh, buf)) != 0)\n\t\tfatal(\"%s: packet error: %s\", __func__, ssh_err(r));\n\tsshbuf_free(buf);\n}"
  },
  {
    "function_name": "special_char_decode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ttymodes.c",
    "lines": "263-271",
    "snippet": "static cc_t\nspecial_char_decode(u_int c)\n{\n#ifdef _POSIX_VDISABLE\n\tif (c == 255)\n\t\treturn _POSIX_VDISABLE;\n#endif /* _POSIX_VDISABLE */\n\treturn c;\n}",
    "includes": [
      "#include \"ttymodes.h\"",
      "#include \"ttymodes.h\"",
      "#include \"ssherr.h\"",
      "#include \"sshbuf.h\"",
      "#include \"compat.h\"",
      "#include \"log.h\"",
      "#include \"packet.h\"",
      "#include <stdarg.h>",
      "#include <termios.h>",
      "#include <string.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ttymodes.h\"\n#include \"ttymodes.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"compat.h\"\n#include \"log.h\"\n#include \"packet.h\"\n#include <stdarg.h>\n#include <termios.h>\n#include <string.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic cc_t\nspecial_char_decode(u_int c)\n{\n#ifdef _POSIX_VDISABLE\n\tif (c == 255)\n\t\treturn _POSIX_VDISABLE;\n#endif /* _POSIX_VDISABLE */\n\treturn c;\n}"
  },
  {
    "function_name": "special_char_encode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ttymodes.c",
    "lines": "250-258",
    "snippet": "static u_int\nspecial_char_encode(cc_t c)\n{\n#ifdef _POSIX_VDISABLE\n\tif (c == _POSIX_VDISABLE)\n\t\treturn 255;\n#endif /* _POSIX_VDISABLE */\n\treturn c;\n}",
    "includes": [
      "#include \"ttymodes.h\"",
      "#include \"ttymodes.h\"",
      "#include \"ssherr.h\"",
      "#include \"sshbuf.h\"",
      "#include \"compat.h\"",
      "#include \"log.h\"",
      "#include \"packet.h\"",
      "#include <stdarg.h>",
      "#include <termios.h>",
      "#include <string.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ttymodes.h\"\n#include \"ttymodes.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"compat.h\"\n#include \"log.h\"\n#include \"packet.h\"\n#include <stdarg.h>\n#include <termios.h>\n#include <string.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic u_int\nspecial_char_encode(cc_t c)\n{\n#ifdef _POSIX_VDISABLE\n\tif (c == _POSIX_VDISABLE)\n\t\treturn 255;\n#endif /* _POSIX_VDISABLE */\n\treturn c;\n}"
  },
  {
    "function_name": "baud_to_speed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ttymodes.c",
    "lines": "161-245",
    "snippet": "static speed_t\nbaud_to_speed(int baud)\n{\n\tswitch (baud) {\n\tcase 0:\n\t\treturn B0;\n\tcase 50:\n\t\treturn B50;\n\tcase 75:\n\t\treturn B75;\n\tcase 110:\n\t\treturn B110;\n\tcase 134:\n\t\treturn B134;\n\tcase 150:\n\t\treturn B150;\n\tcase 200:\n\t\treturn B200;\n\tcase 300:\n\t\treturn B300;\n\tcase 600:\n\t\treturn B600;\n\tcase 1200:\n\t\treturn B1200;\n\tcase 1800:\n\t\treturn B1800;\n\tcase 2400:\n\t\treturn B2400;\n\tcase 4800:\n\t\treturn B4800;\n\tcase 9600:\n\t\treturn B9600;\n\n#ifdef B19200\n\tcase 19200:\n\t\treturn B19200;\n#else /* B19200 */\n#ifdef EXTA\n\tcase 19200:\n\t\treturn EXTA;\n#endif /* EXTA */\n#endif /* B19200 */\n\n#ifdef B38400\n\tcase 38400:\n\t\treturn B38400;\n#else /* B38400 */\n#ifdef EXTB\n\tcase 38400:\n\t\treturn EXTB;\n#endif /* EXTB */\n#endif /* B38400 */\n\n#ifdef B7200\n\tcase 7200:\n\t\treturn B7200;\n#endif /* B7200 */\n#ifdef B14400\n\tcase 14400:\n\t\treturn B14400;\n#endif /* B14400 */\n#ifdef B28800\n\tcase 28800:\n\t\treturn B28800;\n#endif /* B28800 */\n#ifdef B57600\n\tcase 57600:\n\t\treturn B57600;\n#endif /* B57600 */\n#ifdef B76800\n\tcase 76800:\n\t\treturn B76800;\n#endif /* B76800 */\n#ifdef B115200\n\tcase 115200:\n\t\treturn B115200;\n#endif /* B115200 */\n#ifdef B230400\n\tcase 230400:\n\t\treturn B230400;\n#endif /* B230400 */\n\tdefault:\n\t\treturn B9600;\n\t}\n}",
    "includes": [
      "#include \"ttymodes.h\"",
      "#include \"ttymodes.h\"",
      "#include \"ssherr.h\"",
      "#include \"sshbuf.h\"",
      "#include \"compat.h\"",
      "#include \"log.h\"",
      "#include \"packet.h\"",
      "#include <stdarg.h>",
      "#include <termios.h>",
      "#include <string.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ttymodes.h\"\n#include \"ttymodes.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"compat.h\"\n#include \"log.h\"\n#include \"packet.h\"\n#include <stdarg.h>\n#include <termios.h>\n#include <string.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic speed_t\nbaud_to_speed(int baud)\n{\n\tswitch (baud) {\n\tcase 0:\n\t\treturn B0;\n\tcase 50:\n\t\treturn B50;\n\tcase 75:\n\t\treturn B75;\n\tcase 110:\n\t\treturn B110;\n\tcase 134:\n\t\treturn B134;\n\tcase 150:\n\t\treturn B150;\n\tcase 200:\n\t\treturn B200;\n\tcase 300:\n\t\treturn B300;\n\tcase 600:\n\t\treturn B600;\n\tcase 1200:\n\t\treturn B1200;\n\tcase 1800:\n\t\treturn B1800;\n\tcase 2400:\n\t\treturn B2400;\n\tcase 4800:\n\t\treturn B4800;\n\tcase 9600:\n\t\treturn B9600;\n\n#ifdef B19200\n\tcase 19200:\n\t\treturn B19200;\n#else /* B19200 */\n#ifdef EXTA\n\tcase 19200:\n\t\treturn EXTA;\n#endif /* EXTA */\n#endif /* B19200 */\n\n#ifdef B38400\n\tcase 38400:\n\t\treturn B38400;\n#else /* B38400 */\n#ifdef EXTB\n\tcase 38400:\n\t\treturn EXTB;\n#endif /* EXTB */\n#endif /* B38400 */\n\n#ifdef B7200\n\tcase 7200:\n\t\treturn B7200;\n#endif /* B7200 */\n#ifdef B14400\n\tcase 14400:\n\t\treturn B14400;\n#endif /* B14400 */\n#ifdef B28800\n\tcase 28800:\n\t\treturn B28800;\n#endif /* B28800 */\n#ifdef B57600\n\tcase 57600:\n\t\treturn B57600;\n#endif /* B57600 */\n#ifdef B76800\n\tcase 76800:\n\t\treturn B76800;\n#endif /* B76800 */\n#ifdef B115200\n\tcase 115200:\n\t\treturn B115200;\n#endif /* B115200 */\n#ifdef B230400\n\tcase 230400:\n\t\treturn B230400;\n#endif /* B230400 */\n\tdefault:\n\t\treturn B9600;\n\t}\n}"
  },
  {
    "function_name": "speed_to_baud",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ttymodes.c",
    "lines": "72-156",
    "snippet": "static int\nspeed_to_baud(speed_t speed)\n{\n\tswitch (speed) {\n\tcase B0:\n\t\treturn 0;\n\tcase B50:\n\t\treturn 50;\n\tcase B75:\n\t\treturn 75;\n\tcase B110:\n\t\treturn 110;\n\tcase B134:\n\t\treturn 134;\n\tcase B150:\n\t\treturn 150;\n\tcase B200:\n\t\treturn 200;\n\tcase B300:\n\t\treturn 300;\n\tcase B600:\n\t\treturn 600;\n\tcase B1200:\n\t\treturn 1200;\n\tcase B1800:\n\t\treturn 1800;\n\tcase B2400:\n\t\treturn 2400;\n\tcase B4800:\n\t\treturn 4800;\n\tcase B9600:\n\t\treturn 9600;\n\n#ifdef B19200\n\tcase B19200:\n\t\treturn 19200;\n#else /* B19200 */\n#ifdef EXTA\n\tcase EXTA:\n\t\treturn 19200;\n#endif /* EXTA */\n#endif /* B19200 */\n\n#ifdef B38400\n\tcase B38400:\n\t\treturn 38400;\n#else /* B38400 */\n#ifdef EXTB\n\tcase EXTB:\n\t\treturn 38400;\n#endif /* EXTB */\n#endif /* B38400 */\n\n#ifdef B7200\n\tcase B7200:\n\t\treturn 7200;\n#endif /* B7200 */\n#ifdef B14400\n\tcase B14400:\n\t\treturn 14400;\n#endif /* B14400 */\n#ifdef B28800\n\tcase B28800:\n\t\treturn 28800;\n#endif /* B28800 */\n#ifdef B57600\n\tcase B57600:\n\t\treturn 57600;\n#endif /* B57600 */\n#ifdef B76800\n\tcase B76800:\n\t\treturn 76800;\n#endif /* B76800 */\n#ifdef B115200\n\tcase B115200:\n\t\treturn 115200;\n#endif /* B115200 */\n#ifdef B230400\n\tcase B230400:\n\t\treturn 230400;\n#endif /* B230400 */\n\tdefault:\n\t\treturn 9600;\n\t}\n}",
    "includes": [
      "#include \"ttymodes.h\"",
      "#include \"ttymodes.h\"",
      "#include \"ssherr.h\"",
      "#include \"sshbuf.h\"",
      "#include \"compat.h\"",
      "#include \"log.h\"",
      "#include \"packet.h\"",
      "#include <stdarg.h>",
      "#include <termios.h>",
      "#include <string.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ttymodes.h\"\n#include \"ttymodes.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"compat.h\"\n#include \"log.h\"\n#include \"packet.h\"\n#include <stdarg.h>\n#include <termios.h>\n#include <string.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nspeed_to_baud(speed_t speed)\n{\n\tswitch (speed) {\n\tcase B0:\n\t\treturn 0;\n\tcase B50:\n\t\treturn 50;\n\tcase B75:\n\t\treturn 75;\n\tcase B110:\n\t\treturn 110;\n\tcase B134:\n\t\treturn 134;\n\tcase B150:\n\t\treturn 150;\n\tcase B200:\n\t\treturn 200;\n\tcase B300:\n\t\treturn 300;\n\tcase B600:\n\t\treturn 600;\n\tcase B1200:\n\t\treturn 1200;\n\tcase B1800:\n\t\treturn 1800;\n\tcase B2400:\n\t\treturn 2400;\n\tcase B4800:\n\t\treturn 4800;\n\tcase B9600:\n\t\treturn 9600;\n\n#ifdef B19200\n\tcase B19200:\n\t\treturn 19200;\n#else /* B19200 */\n#ifdef EXTA\n\tcase EXTA:\n\t\treturn 19200;\n#endif /* EXTA */\n#endif /* B19200 */\n\n#ifdef B38400\n\tcase B38400:\n\t\treturn 38400;\n#else /* B38400 */\n#ifdef EXTB\n\tcase EXTB:\n\t\treturn 38400;\n#endif /* EXTB */\n#endif /* B38400 */\n\n#ifdef B7200\n\tcase B7200:\n\t\treturn 7200;\n#endif /* B7200 */\n#ifdef B14400\n\tcase B14400:\n\t\treturn 14400;\n#endif /* B14400 */\n#ifdef B28800\n\tcase B28800:\n\t\treturn 28800;\n#endif /* B28800 */\n#ifdef B57600\n\tcase B57600:\n\t\treturn 57600;\n#endif /* B57600 */\n#ifdef B76800\n\tcase B76800:\n\t\treturn 76800;\n#endif /* B76800 */\n#ifdef B115200\n\tcase B115200:\n\t\treturn 115200;\n#endif /* B115200 */\n#ifdef B230400\n\tcase B230400:\n\t\treturn 230400;\n#endif /* B230400 */\n\tdefault:\n\t\treturn 9600;\n\t}\n}"
  }
]