[
  {
    "function_name": "oom_adjust_restore",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/port-linux.c",
    "lines": "294-311",
    "snippet": "void\noom_adjust_restore(void)\n{\n\tFILE *fp;\n\n\tdebug3(\"%s\", __func__);\n\tif (oom_adj_save == INT_MIN || oom_adj_path == NULL ||\n\t    (fp = fopen(oom_adj_path, \"w\")) == NULL)\n\t\treturn;\n\n\tif (fprintf(fp, \"%d\\n\", oom_adj_save) <= 0)\n\t\tverbose(\"error writing %s: %s\", oom_adj_path, strerror(errno));\n\telse\n\t\tdebug(\"Set %s to %d\", oom_adj_path, oom_adj_save);\n\n\tfclose(fp);\n\treturn;\n}",
    "includes": [
      "#include <selinux/get_context_list.h>",
      "#include <selinux/selinux.h>",
      "#include \"port-linux.h\"",
      "#include \"xmalloc.h\"",
      "#include \"log.h\"",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "fp"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"Set %s to %d\"",
            "oom_adj_path",
            "oom_adj_save"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "verbose",
          "args": [
            "\"error writing %s: %s\"",
            "oom_adj_path",
            "strerror(errno)"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "verbose",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "210-218",
          "snippet": "void\nverbose(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_VERBOSE, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nverbose(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_VERBOSE, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "errno"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "gai_strerror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/fake-rfc2553.c",
          "lines": "87-105",
          "snippet": "const char *\n#else\nchar *\n#endif\ngai_strerror(int err)\n{\n\tswitch (err) {\n\tcase EAI_NODATA:\n\t\treturn (\"no address associated with name\");\n\tcase EAI_MEMORY:\n\t\treturn (\"memory allocation failure.\");\n\tcase EAI_NONAME:\n\t\treturn (\"nodename nor servname provided, or not known\");\n\tcase EAI_FAMILY:\n\t\treturn (\"ai_family not supported\");\n\tdefault:\n\t\treturn (\"unknown/invalid error.\");\n\t}\n}",
          "includes": [
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <string.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nconst char *\n#else\nchar *\n#endif\ngai_strerror(int err)\n{\n\tswitch (err) {\n\tcase EAI_NODATA:\n\t\treturn (\"no address associated with name\");\n\tcase EAI_MEMORY:\n\t\treturn (\"memory allocation failure.\");\n\tcase EAI_NONAME:\n\t\treturn (\"nodename nor servname provided, or not known\");\n\tcase EAI_FAMILY:\n\t\treturn (\"ai_family not supported\");\n\tdefault:\n\t\treturn (\"unknown/invalid error.\");\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "fp",
            "\"%d\\n\"",
            "oom_adj_save"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "oom_adj_path",
            "\"w\""
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <selinux/get_context_list.h>\n#include <selinux/selinux.h>\n#include \"port-linux.h\"\n#include \"xmalloc.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <string.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"includes.h\"\n\nvoid\noom_adjust_restore(void)\n{\n\tFILE *fp;\n\n\tdebug3(\"%s\", __func__);\n\tif (oom_adj_save == INT_MIN || oom_adj_path == NULL ||\n\t    (fp = fopen(oom_adj_path, \"w\")) == NULL)\n\t\treturn;\n\n\tif (fprintf(fp, \"%d\\n\", oom_adj_save) <= 0)\n\t\tverbose(\"error writing %s: %s\", oom_adj_path, strerror(errno));\n\telse\n\t\tdebug(\"Set %s to %d\", oom_adj_path, oom_adj_save);\n\n\tfclose(fp);\n\treturn;\n}"
  },
  {
    "function_name": "oom_adjust_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/port-linux.c",
    "lines": "263-291",
    "snippet": "void\noom_adjust_setup(void)\n{\n\tint i, value;\n\tFILE *fp;\n\n\tdebug3(\"%s\", __func__);\n\t for (i = 0; oom_adjust[i].path != NULL; i++) {\n\t\toom_adj_path = oom_adjust[i].path;\n\t\tvalue = oom_adjust[i].value;\n\t\tif ((fp = fopen(oom_adj_path, \"r+\")) != NULL) {\n\t\t\tif (fscanf(fp, \"%d\", &oom_adj_save) != 1)\n\t\t\t\tverbose(\"error reading %s: %s\", oom_adj_path,\n\t\t\t\t    strerror(errno));\n\t\t\telse {\n\t\t\t\trewind(fp);\n\t\t\t\tif (fprintf(fp, \"%d\\n\", value) <= 0)\n\t\t\t\t\tverbose(\"error writing %s: %s\",\n\t\t\t\t\t   oom_adj_path, strerror(errno));\n\t\t\t\telse\n\t\t\t\t\tdebug(\"Set %s from %d to %d\",\n\t\t\t\t\t   oom_adj_path, oom_adj_save, value);\n\t\t\t}\n\t\t\tfclose(fp);\n\t\t\treturn;\n\t\t}\n\t}\n\toom_adj_path = NULL;\n}",
    "includes": [
      "#include <selinux/get_context_list.h>",
      "#include <selinux/selinux.h>",
      "#include \"port-linux.h\"",
      "#include \"xmalloc.h\"",
      "#include \"log.h\"",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "fp"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"Set %s from %d to %d\"",
            "oom_adj_path",
            "oom_adj_save",
            "value"
          ],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "verbose",
          "args": [
            "\"error writing %s: %s\"",
            "oom_adj_path",
            "strerror(errno)"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "verbose",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "210-218",
          "snippet": "void\nverbose(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_VERBOSE, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nverbose(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_VERBOSE, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "errno"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "gai_strerror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/fake-rfc2553.c",
          "lines": "87-105",
          "snippet": "const char *\n#else\nchar *\n#endif\ngai_strerror(int err)\n{\n\tswitch (err) {\n\tcase EAI_NODATA:\n\t\treturn (\"no address associated with name\");\n\tcase EAI_MEMORY:\n\t\treturn (\"memory allocation failure.\");\n\tcase EAI_NONAME:\n\t\treturn (\"nodename nor servname provided, or not known\");\n\tcase EAI_FAMILY:\n\t\treturn (\"ai_family not supported\");\n\tdefault:\n\t\treturn (\"unknown/invalid error.\");\n\t}\n}",
          "includes": [
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <string.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nconst char *\n#else\nchar *\n#endif\ngai_strerror(int err)\n{\n\tswitch (err) {\n\tcase EAI_NODATA:\n\t\treturn (\"no address associated with name\");\n\tcase EAI_MEMORY:\n\t\treturn (\"memory allocation failure.\");\n\tcase EAI_NONAME:\n\t\treturn (\"nodename nor servname provided, or not known\");\n\tcase EAI_FAMILY:\n\t\treturn (\"ai_family not supported\");\n\tdefault:\n\t\treturn (\"unknown/invalid error.\");\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "fp",
            "\"%d\\n\"",
            "value"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rewind",
          "args": [
            "fp"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fscanf",
          "args": [
            "fp",
            "\"%d\"",
            "&oom_adj_save"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "oom_adj_path",
            "\"r+\""
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <selinux/get_context_list.h>\n#include <selinux/selinux.h>\n#include \"port-linux.h\"\n#include \"xmalloc.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <string.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"includes.h\"\n\nvoid\noom_adjust_setup(void)\n{\n\tint i, value;\n\tFILE *fp;\n\n\tdebug3(\"%s\", __func__);\n\t for (i = 0; oom_adjust[i].path != NULL; i++) {\n\t\toom_adj_path = oom_adjust[i].path;\n\t\tvalue = oom_adjust[i].value;\n\t\tif ((fp = fopen(oom_adj_path, \"r+\")) != NULL) {\n\t\t\tif (fscanf(fp, \"%d\", &oom_adj_save) != 1)\n\t\t\t\tverbose(\"error reading %s: %s\", oom_adj_path,\n\t\t\t\t    strerror(errno));\n\t\t\telse {\n\t\t\t\trewind(fp);\n\t\t\t\tif (fprintf(fp, \"%d\\n\", value) <= 0)\n\t\t\t\t\tverbose(\"error writing %s: %s\",\n\t\t\t\t\t   oom_adj_path, strerror(errno));\n\t\t\t\telse\n\t\t\t\t\tdebug(\"Set %s from %d to %d\",\n\t\t\t\t\t   oom_adj_path, oom_adj_save, value);\n\t\t\t}\n\t\t\tfclose(fp);\n\t\t\treturn;\n\t\t}\n\t}\n\toom_adj_path = NULL;\n}"
  },
  {
    "function_name": "ssh_selinux_setfscreatecon",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/port-linux.c",
    "lines": "224-237",
    "snippet": "void\nssh_selinux_setfscreatecon(const char *path)\n{\n\tsecurity_context_t context;\n\n\tif (!ssh_selinux_enabled())\n\t\treturn;\n\tif (path == NULL) {\n\t\tsetfscreatecon(NULL);\n\t\treturn;\n\t}\n\tif (matchpathcon(path, 0700, &context) == 0)\n\t\tsetfscreatecon(context);\n}",
    "includes": [
      "#include <selinux/get_context_list.h>",
      "#include <selinux/selinux.h>",
      "#include \"port-linux.h\"",
      "#include \"xmalloc.h\"",
      "#include \"log.h\"",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setfscreatecon",
          "args": [
            "context"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_selinux_setfscreatecon",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/port-linux.c",
          "lines": "224-237",
          "snippet": "void\nssh_selinux_setfscreatecon(const char *path)\n{\n\tsecurity_context_t context;\n\n\tif (!ssh_selinux_enabled())\n\t\treturn;\n\tif (path == NULL) {\n\t\tsetfscreatecon(NULL);\n\t\treturn;\n\t}\n\tif (matchpathcon(path, 0700, &context) == 0)\n\t\tsetfscreatecon(context);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "matchpathcon",
          "args": [
            "path",
            "0700",
            "&context"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssh_selinux_enabled",
          "args": [],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_selinux_enabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/port-linux.c",
          "lines": "44-55",
          "snippet": "int\nssh_selinux_enabled(void)\n{\n\tstatic int enabled = -1;\n\n\tif (enabled == -1) {\n\t\tenabled = (is_selinux_enabled() == 1);\n\t\tdebug(\"SELinux support %s\", enabled ? \"enabled\" : \"disabled\");\n\t}\n\n\treturn (enabled);\n}",
          "includes": [
            "#include <selinux/get_context_list.h>",
            "#include <selinux/selinux.h>",
            "#include \"port-linux.h\"",
            "#include \"xmalloc.h\"",
            "#include \"log.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <selinux/get_context_list.h>\n#include <selinux/selinux.h>\n#include \"port-linux.h\"\n#include \"xmalloc.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <string.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\nssh_selinux_enabled(void)\n{\n\tstatic int enabled = -1;\n\n\tif (enabled == -1) {\n\t\tenabled = (is_selinux_enabled() == 1);\n\t\tdebug(\"SELinux support %s\", enabled ? \"enabled\" : \"disabled\");\n\t}\n\n\treturn (enabled);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <selinux/get_context_list.h>\n#include <selinux/selinux.h>\n#include \"port-linux.h\"\n#include \"xmalloc.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <string.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"includes.h\"\n\nvoid\nssh_selinux_setfscreatecon(const char *path)\n{\n\tsecurity_context_t context;\n\n\tif (!ssh_selinux_enabled())\n\t\treturn;\n\tif (path == NULL) {\n\t\tsetfscreatecon(NULL);\n\t\treturn;\n\t}\n\tif (matchpathcon(path, 0700, &context) == 0)\n\t\tsetfscreatecon(context);\n}"
  },
  {
    "function_name": "ssh_selinux_change_context",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/port-linux.c",
    "lines": "180-222",
    "snippet": "void\nssh_selinux_change_context(const char *newname)\n{\n\tint len, newlen;\n\tchar *oldctx, *newctx, *cx;\n\tvoid (*switchlog) (const char *fmt,...) = logit;\n\n\tif (!ssh_selinux_enabled())\n\t\treturn;\n\n\tif (getcon((security_context_t *)&oldctx) < 0) {\n\t\tlogit(\"%s: getcon failed with %s\", __func__, strerror(errno));\n\t\treturn;\n\t}\n\tif ((cx = index(oldctx, ':')) == NULL || (cx = index(cx + 1, ':')) ==\n\t    NULL) {\n\t\tlogit (\"%s: unparseable context %s\", __func__, oldctx);\n\t\treturn;\n\t}\n\n\t/*\n\t * Check whether we are attempting to switch away from an unconfined\n\t * security context.\n\t */\n\tif (strncmp(cx, SSH_SELINUX_UNCONFINED_TYPE,\n\t    sizeof(SSH_SELINUX_UNCONFINED_TYPE) - 1) == 0)\n\t\tswitchlog = debug3;\n\n\tnewlen = strlen(oldctx) + strlen(newname) + 1;\n\tnewctx = xmalloc(newlen);\n\tlen = cx - oldctx + 1;\n\tmemcpy(newctx, oldctx, len);\n\tstrlcpy(newctx + len, newname, newlen - len);\n\tif ((cx = index(cx + 1, ':')))\n\t\tstrlcat(newctx, cx, newlen);\n\tdebug3(\"%s: setting context from '%s' to '%s'\", __func__,\n\t    oldctx, newctx);\n\tif (setcon(newctx) < 0)\n\t\tswitchlog(\"%s: setcon %s from %s failed with %s\", __func__,\n\t\t    newctx, oldctx, strerror(errno));\n\tfree(oldctx);\n\tfree(newctx);\n}",
    "includes": [
      "#include <selinux/get_context_list.h>",
      "#include <selinux/selinux.h>",
      "#include \"port-linux.h\"",
      "#include \"xmalloc.h\"",
      "#include \"log.h\"",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "newctx"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "freeaddrinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/fake-rfc2553.c",
          "lines": "109-119",
          "snippet": "void\nfreeaddrinfo(struct addrinfo *ai)\n{\n\tstruct addrinfo *next;\n\n\tfor(; ai != NULL;) {\n\t\tnext = ai->ai_next;\n\t\tfree(ai);\n\t\tai = next;\n\t}\n}",
          "includes": [
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <string.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nvoid\nfreeaddrinfo(struct addrinfo *ai)\n{\n\tstruct addrinfo *next;\n\n\tfor(; ai != NULL;) {\n\t\tnext = ai->ai_next;\n\t\tfree(ai);\n\t\tai = next;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "switchlog",
          "args": [
            "\"%s: setcon %s from %s failed with %s\"",
            "__func__",
            "newctx",
            "oldctx",
            "strerror(errno)"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "errno"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "gai_strerror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/fake-rfc2553.c",
          "lines": "87-105",
          "snippet": "const char *\n#else\nchar *\n#endif\ngai_strerror(int err)\n{\n\tswitch (err) {\n\tcase EAI_NODATA:\n\t\treturn (\"no address associated with name\");\n\tcase EAI_MEMORY:\n\t\treturn (\"memory allocation failure.\");\n\tcase EAI_NONAME:\n\t\treturn (\"nodename nor servname provided, or not known\");\n\tcase EAI_FAMILY:\n\t\treturn (\"ai_family not supported\");\n\tdefault:\n\t\treturn (\"unknown/invalid error.\");\n\t}\n}",
          "includes": [
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <string.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nconst char *\n#else\nchar *\n#endif\ngai_strerror(int err)\n{\n\tswitch (err) {\n\tcase EAI_NODATA:\n\t\treturn (\"no address associated with name\");\n\tcase EAI_MEMORY:\n\t\treturn (\"memory allocation failure.\");\n\tcase EAI_NONAME:\n\t\treturn (\"nodename nor servname provided, or not known\");\n\tcase EAI_FAMILY:\n\t\treturn (\"ai_family not supported\");\n\tdefault:\n\t\treturn (\"unknown/invalid error.\");\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "setcon",
          "args": [
            "newctx"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"%s: setting context from '%s' to '%s'\"",
            "__func__",
            "oldctx",
            "newctx"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlcat",
          "args": [
            "newctx",
            "cx",
            "newlen"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "strlcat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strlcat.c",
          "lines": "34-60",
          "snippet": "size_t\nstrlcat(char *dst, const char *src, size_t siz)\n{\n\tchar *d = dst;\n\tconst char *s = src;\n\tsize_t n = siz;\n\tsize_t dlen;\n\n\t/* Find the end of dst and adjust bytes left but don't go past end */\n\twhile (n-- != 0 && *d != '\\0')\n\t\td++;\n\tdlen = d - dst;\n\tn = siz - dlen;\n\n\tif (n == 0)\n\t\treturn(dlen + strlen(s));\n\twhile (*s != '\\0') {\n\t\tif (n != 1) {\n\t\t\t*d++ = *s;\n\t\t\tn--;\n\t\t}\n\t\ts++;\n\t}\n\t*d = '\\0';\n\n\treturn(dlen + (s - src));\t/* count does not include NUL */\n}",
          "includes": [
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nstrlcat(char *dst, const char *src, size_t siz)\n{\n\tchar *d = dst;\n\tconst char *s = src;\n\tsize_t n = siz;\n\tsize_t dlen;\n\n\t/* Find the end of dst and adjust bytes left but don't go past end */\n\twhile (n-- != 0 && *d != '\\0')\n\t\td++;\n\tdlen = d - dst;\n\tn = siz - dlen;\n\n\tif (n == 0)\n\t\treturn(dlen + strlen(s));\n\twhile (*s != '\\0') {\n\t\tif (n != 1) {\n\t\t\t*d++ = *s;\n\t\t\tn--;\n\t\t}\n\t\ts++;\n\t}\n\t*d = '\\0';\n\n\treturn(dlen + (s - src));\t/* count does not include NUL */\n}"
        }
      },
      {
        "call_info": {
          "callee": "index",
          "args": [
            "cx + 1",
            "':'"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "get_hostkey_public_by_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshd.c",
          "lines": "807-813",
          "snippet": "struct sshkey *\nget_hostkey_public_by_index(int ind, struct ssh *ssh)\n{\n\tif (ind < 0 || (u_int)ind >= options.num_host_key_files)\n\t\treturn (NULL);\n\treturn (sensitive_data.host_pubkeys[ind]);\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include \"version.h\"",
            "#include \"auth-options.h\"",
            "#include \"ssh-sandbox.h\"",
            "#include \"monitor_wrap.h\"",
            "#include \"ssh-gss.h\"",
            "#include \"monitor.h\"",
            "#include \"session.h\"",
            "#include \"channels.h\"",
            "#include \"dispatch.h\"",
            "#include \"msg.h\"",
            "#include \"authfd.h\"",
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"canohost.h\"",
            "#include \"atomicio.h\"",
            "#include \"pathnames.h\"",
            "#include \"authfile.h\"",
            "#include \"myproposal.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"digest.h\"",
            "#include \"cipher.h\"",
            "#include \"compat.h\"",
            "#include \"uidswap.h\"",
            "#include \"servconf.h\"",
            "#include \"match.h\"",
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"log.h\"",
            "#include \"packet.h\"",
            "#include \"sshpty.h\"",
            "#include \"ssh2.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <prot.h>",
            "#include <sys/security.h>",
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include <openssl/rand.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/dh.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/wait.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include \"openbsd-compat/sys-tree.h\"",
            "# include <sys/time.h>",
            "# include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "ServerOptions options;",
            "struct {\n\tstruct sshkey\t**host_keys;\t\t/* all private host keys */\n\tstruct sshkey\t**host_pubkeys;\t\t/* all public host keys */\n\tstruct sshkey\t**host_certificates;\t/* all public host certificates */\n\tint\t\thave_ssh2_key;\n} sensitive_data;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include \"version.h\"\n#include \"auth-options.h\"\n#include \"ssh-sandbox.h\"\n#include \"monitor_wrap.h\"\n#include \"ssh-gss.h\"\n#include \"monitor.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"dispatch.h\"\n#include \"msg.h\"\n#include \"authfd.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"canohost.h\"\n#include \"atomicio.h\"\n#include \"pathnames.h\"\n#include \"authfile.h\"\n#include \"myproposal.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"digest.h\"\n#include \"cipher.h\"\n#include \"compat.h\"\n#include \"uidswap.h\"\n#include \"servconf.h\"\n#include \"match.h\"\n#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"log.h\"\n#include \"packet.h\"\n#include \"sshpty.h\"\n#include \"ssh2.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <prot.h>\n#include <sys/security.h>\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/rand.h>\n#include <openssl/bn.h>\n#include <openssl/dh.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n#include <pwd.h>\n#include <grp.h>\n#include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/wait.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include \"openbsd-compat/sys-tree.h\"\n# include <sys/time.h>\n# include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nServerOptions options;\nstruct {\n\tstruct sshkey\t**host_keys;\t\t/* all private host keys */\n\tstruct sshkey\t**host_pubkeys;\t\t/* all public host keys */\n\tstruct sshkey\t**host_certificates;\t/* all public host certificates */\n\tint\t\thave_ssh2_key;\n} sensitive_data;\n\nstruct sshkey *\nget_hostkey_public_by_index(int ind, struct ssh *ssh)\n{\n\tif (ind < 0 || (u_int)ind >= options.num_host_key_files)\n\t\treturn (NULL);\n\treturn (sensitive_data.host_pubkeys[ind]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "newctx + len",
            "newname",
            "newlen - len"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "strlcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strlcpy.c",
          "lines": "32-56",
          "snippet": "size_t\nstrlcpy(char *dst, const char *src, size_t siz)\n{\n\tchar *d = dst;\n\tconst char *s = src;\n\tsize_t n = siz;\n\n\t/* Copy as many bytes as will fit */\n\tif (n != 0) {\n\t\twhile (--n != 0) {\n\t\t\tif ((*d++ = *s++) == '\\0')\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* Not enough room in dst, add NUL and traverse rest of src */\n\tif (n == 0) {\n\t\tif (siz != 0)\n\t\t\t*d = '\\0';\t\t/* NUL-terminate dst */\n\t\twhile (*s++)\n\t\t\t;\n\t}\n\n\treturn(s - src - 1);\t/* count does not include NUL */\n}",
          "includes": [
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nstrlcpy(char *dst, const char *src, size_t siz)\n{\n\tchar *d = dst;\n\tconst char *s = src;\n\tsize_t n = siz;\n\n\t/* Copy as many bytes as will fit */\n\tif (n != 0) {\n\t\twhile (--n != 0) {\n\t\t\tif ((*d++ = *s++) == '\\0')\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* Not enough room in dst, add NUL and traverse rest of src */\n\tif (n == 0) {\n\t\tif (siz != 0)\n\t\t\t*d = '\\0';\t\t/* NUL-terminate dst */\n\t\twhile (*s++)\n\t\t\t;\n\t}\n\n\treturn(s - src - 1);\t/* count does not include NUL */\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "newctx",
            "oldctx",
            "len"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "newlen"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "xmalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "39-50",
          "snippet": "void *\nxmalloc(size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0)\n\t\tfatal(\"xmalloc: zero size\");\n\tptr = malloc(size);\n\tif (ptr == NULL)\n\t\tfatal(\"xmalloc: out of memory (allocating %zu bytes)\", size);\n\treturn ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxmalloc(size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0)\n\t\tfatal(\"xmalloc: zero size\");\n\tptr = malloc(size);\n\tif (ptr == NULL)\n\t\tfatal(\"xmalloc: out of memory (allocating %zu bytes)\", size);\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "newname"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "oldctx"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "cx",
            "SSH_SELINUX_UNCONFINED_TYPE",
            "sizeof(SSH_SELINUX_UNCONFINED_TYPE) - 1"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "g_strncmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/glob.c",
          "lines": "422-435",
          "snippet": "static int\ng_strncmp(const Char *s1, const char *s2, size_t n)\n{\n\tint rv = 0;\n\n\twhile (n--) {\n\t\trv = *(Char *)s1 - *(const unsigned char *)s2++;\n\t\tif (rv)\n\t\t\tbreak;\n\t\tif (*s1++ == '\\0')\n\t\t\tbreak;\n\t}\n\treturn rv;\n}",
          "includes": [
            "#include \"charclass.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pwd.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <dirent.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"glob.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"charclass.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pwd.h>\n#include <limits.h>\n#include <errno.h>\n#include <ctype.h>\n#include <dirent.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"glob.h\"\n#include \"includes.h\"\n\nstatic int\ng_strncmp(const Char *s1, const char *s2, size_t n)\n{\n\tint rv = 0;\n\n\twhile (n--) {\n\t\trv = *(Char *)s1 - *(const unsigned char *)s2++;\n\t\tif (rv)\n\t\t\tbreak;\n\t\tif (*s1++ == '\\0')\n\t\t\tbreak;\n\t}\n\treturn rv;\n}"
        }
      },
      {
        "call_info": {
          "callee": "logit",
          "args": [
            "\"%s: unparseable context %s\"",
            "__func__",
            "oldctx"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "logit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "198-206",
          "snippet": "void\nlogit(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_INFO, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nlogit(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_INFO, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "getcon",
          "args": [
            "(security_context_t *)&oldctx"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssh_selinux_enabled",
          "args": [],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_selinux_enabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/port-linux.c",
          "lines": "44-55",
          "snippet": "int\nssh_selinux_enabled(void)\n{\n\tstatic int enabled = -1;\n\n\tif (enabled == -1) {\n\t\tenabled = (is_selinux_enabled() == 1);\n\t\tdebug(\"SELinux support %s\", enabled ? \"enabled\" : \"disabled\");\n\t}\n\n\treturn (enabled);\n}",
          "includes": [
            "#include <selinux/get_context_list.h>",
            "#include <selinux/selinux.h>",
            "#include \"port-linux.h\"",
            "#include \"xmalloc.h\"",
            "#include \"log.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <selinux/get_context_list.h>\n#include <selinux/selinux.h>\n#include \"port-linux.h\"\n#include \"xmalloc.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <string.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\nssh_selinux_enabled(void)\n{\n\tstatic int enabled = -1;\n\n\tif (enabled == -1) {\n\t\tenabled = (is_selinux_enabled() == 1);\n\t\tdebug(\"SELinux support %s\", enabled ? \"enabled\" : \"disabled\");\n\t}\n\n\treturn (enabled);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <selinux/get_context_list.h>\n#include <selinux/selinux.h>\n#include \"port-linux.h\"\n#include \"xmalloc.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <string.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"includes.h\"\n\nvoid\nssh_selinux_change_context(const char *newname)\n{\n\tint len, newlen;\n\tchar *oldctx, *newctx, *cx;\n\tvoid (*switchlog) (const char *fmt,...) = logit;\n\n\tif (!ssh_selinux_enabled())\n\t\treturn;\n\n\tif (getcon((security_context_t *)&oldctx) < 0) {\n\t\tlogit(\"%s: getcon failed with %s\", __func__, strerror(errno));\n\t\treturn;\n\t}\n\tif ((cx = index(oldctx, ':')) == NULL || (cx = index(cx + 1, ':')) ==\n\t    NULL) {\n\t\tlogit (\"%s: unparseable context %s\", __func__, oldctx);\n\t\treturn;\n\t}\n\n\t/*\n\t * Check whether we are attempting to switch away from an unconfined\n\t * security context.\n\t */\n\tif (strncmp(cx, SSH_SELINUX_UNCONFINED_TYPE,\n\t    sizeof(SSH_SELINUX_UNCONFINED_TYPE) - 1) == 0)\n\t\tswitchlog = debug3;\n\n\tnewlen = strlen(oldctx) + strlen(newname) + 1;\n\tnewctx = xmalloc(newlen);\n\tlen = cx - oldctx + 1;\n\tmemcpy(newctx, oldctx, len);\n\tstrlcpy(newctx + len, newname, newlen - len);\n\tif ((cx = index(cx + 1, ':')))\n\t\tstrlcat(newctx, cx, newlen);\n\tdebug3(\"%s: setting context from '%s' to '%s'\", __func__,\n\t    oldctx, newctx);\n\tif (setcon(newctx) < 0)\n\t\tswitchlog(\"%s: setcon %s from %s failed with %s\", __func__,\n\t\t    newctx, oldctx, strerror(errno));\n\tfree(oldctx);\n\tfree(newctx);\n}"
  },
  {
    "function_name": "ssh_selinux_setup_pty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/port-linux.c",
    "lines": "136-178",
    "snippet": "void\nssh_selinux_setup_pty(char *pwname, const char *tty)\n{\n\tsecurity_context_t new_tty_ctx = NULL;\n\tsecurity_context_t user_ctx = NULL;\n\tsecurity_context_t old_tty_ctx = NULL;\n\tsecurity_class_t chrclass;\n\n\tif (!ssh_selinux_enabled())\n\t\treturn;\n\n\tdebug3(\"%s: setting TTY context on %s\", __func__, tty);\n\n\tuser_ctx = ssh_selinux_getctxbyname(pwname);\n\n\t/* XXX: should these calls fatal() upon failure in enforcing mode? */\n\n\tif (getfilecon(tty, &old_tty_ctx) == -1) {\n\t\terror(\"%s: getfilecon: %s\", __func__, strerror(errno));\n\t\tgoto out;\n\t}\n\tif ((chrclass = string_to_security_class(\"chr_file\")) == 0) {\n\t\terror(\"%s: couldn't get security class for chr_file\", __func__);\n\t\tgoto out;\n\t}\n\tif (security_compute_relabel(user_ctx, old_tty_ctx,\n\t    chrclass, &new_tty_ctx) != 0) {\n\t\terror(\"%s: security_compute_relabel: %s\",\n\t\t    __func__, strerror(errno));\n\t\tgoto out;\n\t}\n\n\tif (setfilecon(tty, new_tty_ctx) != 0)\n\t\terror(\"%s: setfilecon: %s\", __func__, strerror(errno));\n out:\n\tif (new_tty_ctx != NULL)\n\t\tfreecon(new_tty_ctx);\n\tif (old_tty_ctx != NULL)\n\t\tfreecon(old_tty_ctx);\n\tif (user_ctx != NULL)\n\t\tfreecon(user_ctx);\n\tdebug3(\"%s: done\", __func__);\n}",
    "includes": [
      "#include <selinux/get_context_list.h>",
      "#include <selinux/selinux.h>",
      "#include \"port-linux.h\"",
      "#include \"xmalloc.h\"",
      "#include \"log.h\"",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"%s: done\"",
            "__func__"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "freecon",
          "args": [
            "user_ctx"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "freecon",
          "args": [
            "old_tty_ctx"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "freecon",
          "args": [
            "new_tty_ctx"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"%s: setfilecon: %s\"",
            "__func__",
            "strerror(errno)"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "162-170",
          "snippet": "void\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "errno"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "gai_strerror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/fake-rfc2553.c",
          "lines": "87-105",
          "snippet": "const char *\n#else\nchar *\n#endif\ngai_strerror(int err)\n{\n\tswitch (err) {\n\tcase EAI_NODATA:\n\t\treturn (\"no address associated with name\");\n\tcase EAI_MEMORY:\n\t\treturn (\"memory allocation failure.\");\n\tcase EAI_NONAME:\n\t\treturn (\"nodename nor servname provided, or not known\");\n\tcase EAI_FAMILY:\n\t\treturn (\"ai_family not supported\");\n\tdefault:\n\t\treturn (\"unknown/invalid error.\");\n\t}\n}",
          "includes": [
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <string.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nconst char *\n#else\nchar *\n#endif\ngai_strerror(int err)\n{\n\tswitch (err) {\n\tcase EAI_NODATA:\n\t\treturn (\"no address associated with name\");\n\tcase EAI_MEMORY:\n\t\treturn (\"memory allocation failure.\");\n\tcase EAI_NONAME:\n\t\treturn (\"nodename nor servname provided, or not known\");\n\tcase EAI_FAMILY:\n\t\treturn (\"ai_family not supported\");\n\tdefault:\n\t\treturn (\"unknown/invalid error.\");\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "setfilecon",
          "args": [
            "tty",
            "new_tty_ctx"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "security_compute_relabel",
          "args": [
            "user_ctx",
            "old_tty_ctx",
            "chrclass",
            "&new_tty_ctx"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "string_to_security_class",
          "args": [
            "\"chr_file\""
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getfilecon",
          "args": [
            "tty",
            "&old_tty_ctx"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssh_selinux_getctxbyname",
          "args": [
            "pwname"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_selinux_getctxbyname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/port-linux.c",
          "lines": "58-102",
          "snippet": "static security_context_t\nssh_selinux_getctxbyname(char *pwname)\n{\n\tsecurity_context_t sc = NULL;\n\tchar *sename = NULL, *lvl = NULL;\n\tint r;\n\n#ifdef HAVE_GETSEUSERBYNAME\n\tif (getseuserbyname(pwname, &sename, &lvl) != 0)\n\t\treturn NULL;\n#else\n\tsename = pwname;\n\tlvl = NULL;\n#endif\n\n#ifdef HAVE_GET_DEFAULT_CONTEXT_WITH_LEVEL\n\tr = get_default_context_with_level(sename, lvl, NULL, &sc);\n#else\n\tr = get_default_context(sename, NULL, &sc);\n#endif\n\n\tif (r != 0) {\n\t\tswitch (security_getenforce()) {\n\t\tcase -1:\n\t\t\tfatal(\"%s: ssh_selinux_getctxbyname: \"\n\t\t\t    \"security_getenforce() failed\", __func__);\n\t\tcase 0:\n\t\t\terror(\"%s: Failed to get default SELinux security \"\n\t\t\t    \"context for %s\", __func__, pwname);\n\t\t\tsc = NULL;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tfatal(\"%s: Failed to get default SELinux security \"\n\t\t\t    \"context for %s (in enforcing mode)\",\n\t\t\t    __func__, pwname);\n\t\t}\n\t}\n\n#ifdef HAVE_GETSEUSERBYNAME\n\tfree(sename);\n\tfree(lvl);\n#endif\n\n\treturn sc;\n}",
          "includes": [
            "#include <selinux/get_context_list.h>",
            "#include <selinux/selinux.h>",
            "#include \"port-linux.h\"",
            "#include \"xmalloc.h\"",
            "#include \"log.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <selinux/get_context_list.h>\n#include <selinux/selinux.h>\n#include \"port-linux.h\"\n#include \"xmalloc.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <string.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"includes.h\"\n\nstatic security_context_t\nssh_selinux_getctxbyname(char *pwname)\n{\n\tsecurity_context_t sc = NULL;\n\tchar *sename = NULL, *lvl = NULL;\n\tint r;\n\n#ifdef HAVE_GETSEUSERBYNAME\n\tif (getseuserbyname(pwname, &sename, &lvl) != 0)\n\t\treturn NULL;\n#else\n\tsename = pwname;\n\tlvl = NULL;\n#endif\n\n#ifdef HAVE_GET_DEFAULT_CONTEXT_WITH_LEVEL\n\tr = get_default_context_with_level(sename, lvl, NULL, &sc);\n#else\n\tr = get_default_context(sename, NULL, &sc);\n#endif\n\n\tif (r != 0) {\n\t\tswitch (security_getenforce()) {\n\t\tcase -1:\n\t\t\tfatal(\"%s: ssh_selinux_getctxbyname: \"\n\t\t\t    \"security_getenforce() failed\", __func__);\n\t\tcase 0:\n\t\t\terror(\"%s: Failed to get default SELinux security \"\n\t\t\t    \"context for %s\", __func__, pwname);\n\t\t\tsc = NULL;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tfatal(\"%s: Failed to get default SELinux security \"\n\t\t\t    \"context for %s (in enforcing mode)\",\n\t\t\t    __func__, pwname);\n\t\t}\n\t}\n\n#ifdef HAVE_GETSEUSERBYNAME\n\tfree(sename);\n\tfree(lvl);\n#endif\n\n\treturn sc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_selinux_enabled",
          "args": [],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_selinux_enabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/port-linux.c",
          "lines": "44-55",
          "snippet": "int\nssh_selinux_enabled(void)\n{\n\tstatic int enabled = -1;\n\n\tif (enabled == -1) {\n\t\tenabled = (is_selinux_enabled() == 1);\n\t\tdebug(\"SELinux support %s\", enabled ? \"enabled\" : \"disabled\");\n\t}\n\n\treturn (enabled);\n}",
          "includes": [
            "#include <selinux/get_context_list.h>",
            "#include <selinux/selinux.h>",
            "#include \"port-linux.h\"",
            "#include \"xmalloc.h\"",
            "#include \"log.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <selinux/get_context_list.h>\n#include <selinux/selinux.h>\n#include \"port-linux.h\"\n#include \"xmalloc.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <string.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\nssh_selinux_enabled(void)\n{\n\tstatic int enabled = -1;\n\n\tif (enabled == -1) {\n\t\tenabled = (is_selinux_enabled() == 1);\n\t\tdebug(\"SELinux support %s\", enabled ? \"enabled\" : \"disabled\");\n\t}\n\n\treturn (enabled);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <selinux/get_context_list.h>\n#include <selinux/selinux.h>\n#include \"port-linux.h\"\n#include \"xmalloc.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <string.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"includes.h\"\n\nvoid\nssh_selinux_setup_pty(char *pwname, const char *tty)\n{\n\tsecurity_context_t new_tty_ctx = NULL;\n\tsecurity_context_t user_ctx = NULL;\n\tsecurity_context_t old_tty_ctx = NULL;\n\tsecurity_class_t chrclass;\n\n\tif (!ssh_selinux_enabled())\n\t\treturn;\n\n\tdebug3(\"%s: setting TTY context on %s\", __func__, tty);\n\n\tuser_ctx = ssh_selinux_getctxbyname(pwname);\n\n\t/* XXX: should these calls fatal() upon failure in enforcing mode? */\n\n\tif (getfilecon(tty, &old_tty_ctx) == -1) {\n\t\terror(\"%s: getfilecon: %s\", __func__, strerror(errno));\n\t\tgoto out;\n\t}\n\tif ((chrclass = string_to_security_class(\"chr_file\")) == 0) {\n\t\terror(\"%s: couldn't get security class for chr_file\", __func__);\n\t\tgoto out;\n\t}\n\tif (security_compute_relabel(user_ctx, old_tty_ctx,\n\t    chrclass, &new_tty_ctx) != 0) {\n\t\terror(\"%s: security_compute_relabel: %s\",\n\t\t    __func__, strerror(errno));\n\t\tgoto out;\n\t}\n\n\tif (setfilecon(tty, new_tty_ctx) != 0)\n\t\terror(\"%s: setfilecon: %s\", __func__, strerror(errno));\n out:\n\tif (new_tty_ctx != NULL)\n\t\tfreecon(new_tty_ctx);\n\tif (old_tty_ctx != NULL)\n\t\tfreecon(old_tty_ctx);\n\tif (user_ctx != NULL)\n\t\tfreecon(user_ctx);\n\tdebug3(\"%s: done\", __func__);\n}"
  },
  {
    "function_name": "ssh_selinux_setup_exec_context",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/port-linux.c",
    "lines": "105-133",
    "snippet": "void\nssh_selinux_setup_exec_context(char *pwname)\n{\n\tsecurity_context_t user_ctx = NULL;\n\n\tif (!ssh_selinux_enabled())\n\t\treturn;\n\n\tdebug3(\"%s: setting execution context\", __func__);\n\n\tuser_ctx = ssh_selinux_getctxbyname(pwname);\n\tif (setexeccon(user_ctx) != 0) {\n\t\tswitch (security_getenforce()) {\n\t\tcase -1:\n\t\t\tfatal(\"%s: security_getenforce() failed\", __func__);\n\t\tcase 0:\n\t\t\terror(\"%s: Failed to set SELinux execution \"\n\t\t\t    \"context for %s\", __func__, pwname);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tfatal(\"%s: Failed to set SELinux execution context \"\n\t\t\t    \"for %s (in enforcing mode)\", __func__, pwname);\n\t\t}\n\t}\n\tif (user_ctx != NULL)\n\t\tfreecon(user_ctx);\n\n\tdebug3(\"%s: done\", __func__);\n}",
    "includes": [
      "#include <selinux/get_context_list.h>",
      "#include <selinux/selinux.h>",
      "#include \"port-linux.h\"",
      "#include \"xmalloc.h\"",
      "#include \"log.h\"",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"%s: done\"",
            "__func__"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "freecon",
          "args": [
            "user_ctx"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"%s: Failed to set SELinux execution context \"\n\t\t\t    \"for %s (in enforcing mode)\"",
            "__func__",
            "pwname"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fatal.c",
          "lines": "36-45",
          "snippet": "void\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\tcleanup_exit(255);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\tcleanup_exit(255);\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"%s: Failed to set SELinux execution \"\n\t\t\t    \"context for %s\"",
            "__func__",
            "pwname"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "162-170",
          "snippet": "void\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"%s: security_getenforce() failed\"",
            "__func__"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "match_test_missing_fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/servconf.c",
          "lines": "988-993",
          "snippet": "static void\nmatch_test_missing_fatal(const char *criteria, const char *attrib)\n{\n\tfatal(\"'Match %s' in configuration but '%s' not in connection \"\n\t    \"test specification.\", criteria, attrib);\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"myproposal.h\"",
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"canohost.h\"",
            "#include \"groupaccess.h\"",
            "#include \"channels.h\"",
            "#include \"match.h\"",
            "#include \"mac.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"pathnames.h\"",
            "#include \"compat.h\"",
            "#include \"servconf.h\"",
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"log.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <util.h>",
            "#include <errno.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <netdb.h>",
            "#include <ctype.h>",
            "#include <net/route.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <sys/sysctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"myproposal.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"canohost.h\"\n#include \"groupaccess.h\"\n#include \"channels.h\"\n#include \"match.h\"\n#include \"mac.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"pathnames.h\"\n#include \"compat.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"log.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <util.h>\n#include <errno.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <netdb.h>\n#include <ctype.h>\n#include <net/route.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <sys/sysctl.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic void\nmatch_test_missing_fatal(const char *criteria, const char *attrib)\n{\n\tfatal(\"'Match %s' in configuration but '%s' not in connection \"\n\t    \"test specification.\", criteria, attrib);\n}"
        }
      },
      {
        "call_info": {
          "callee": "security_getenforce",
          "args": [],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setexeccon",
          "args": [
            "user_ctx"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssh_selinux_getctxbyname",
          "args": [
            "pwname"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_selinux_getctxbyname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/port-linux.c",
          "lines": "58-102",
          "snippet": "static security_context_t\nssh_selinux_getctxbyname(char *pwname)\n{\n\tsecurity_context_t sc = NULL;\n\tchar *sename = NULL, *lvl = NULL;\n\tint r;\n\n#ifdef HAVE_GETSEUSERBYNAME\n\tif (getseuserbyname(pwname, &sename, &lvl) != 0)\n\t\treturn NULL;\n#else\n\tsename = pwname;\n\tlvl = NULL;\n#endif\n\n#ifdef HAVE_GET_DEFAULT_CONTEXT_WITH_LEVEL\n\tr = get_default_context_with_level(sename, lvl, NULL, &sc);\n#else\n\tr = get_default_context(sename, NULL, &sc);\n#endif\n\n\tif (r != 0) {\n\t\tswitch (security_getenforce()) {\n\t\tcase -1:\n\t\t\tfatal(\"%s: ssh_selinux_getctxbyname: \"\n\t\t\t    \"security_getenforce() failed\", __func__);\n\t\tcase 0:\n\t\t\terror(\"%s: Failed to get default SELinux security \"\n\t\t\t    \"context for %s\", __func__, pwname);\n\t\t\tsc = NULL;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tfatal(\"%s: Failed to get default SELinux security \"\n\t\t\t    \"context for %s (in enforcing mode)\",\n\t\t\t    __func__, pwname);\n\t\t}\n\t}\n\n#ifdef HAVE_GETSEUSERBYNAME\n\tfree(sename);\n\tfree(lvl);\n#endif\n\n\treturn sc;\n}",
          "includes": [
            "#include <selinux/get_context_list.h>",
            "#include <selinux/selinux.h>",
            "#include \"port-linux.h\"",
            "#include \"xmalloc.h\"",
            "#include \"log.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <selinux/get_context_list.h>\n#include <selinux/selinux.h>\n#include \"port-linux.h\"\n#include \"xmalloc.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <string.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"includes.h\"\n\nstatic security_context_t\nssh_selinux_getctxbyname(char *pwname)\n{\n\tsecurity_context_t sc = NULL;\n\tchar *sename = NULL, *lvl = NULL;\n\tint r;\n\n#ifdef HAVE_GETSEUSERBYNAME\n\tif (getseuserbyname(pwname, &sename, &lvl) != 0)\n\t\treturn NULL;\n#else\n\tsename = pwname;\n\tlvl = NULL;\n#endif\n\n#ifdef HAVE_GET_DEFAULT_CONTEXT_WITH_LEVEL\n\tr = get_default_context_with_level(sename, lvl, NULL, &sc);\n#else\n\tr = get_default_context(sename, NULL, &sc);\n#endif\n\n\tif (r != 0) {\n\t\tswitch (security_getenforce()) {\n\t\tcase -1:\n\t\t\tfatal(\"%s: ssh_selinux_getctxbyname: \"\n\t\t\t    \"security_getenforce() failed\", __func__);\n\t\tcase 0:\n\t\t\terror(\"%s: Failed to get default SELinux security \"\n\t\t\t    \"context for %s\", __func__, pwname);\n\t\t\tsc = NULL;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tfatal(\"%s: Failed to get default SELinux security \"\n\t\t\t    \"context for %s (in enforcing mode)\",\n\t\t\t    __func__, pwname);\n\t\t}\n\t}\n\n#ifdef HAVE_GETSEUSERBYNAME\n\tfree(sename);\n\tfree(lvl);\n#endif\n\n\treturn sc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_selinux_enabled",
          "args": [],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_selinux_enabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/port-linux.c",
          "lines": "44-55",
          "snippet": "int\nssh_selinux_enabled(void)\n{\n\tstatic int enabled = -1;\n\n\tif (enabled == -1) {\n\t\tenabled = (is_selinux_enabled() == 1);\n\t\tdebug(\"SELinux support %s\", enabled ? \"enabled\" : \"disabled\");\n\t}\n\n\treturn (enabled);\n}",
          "includes": [
            "#include <selinux/get_context_list.h>",
            "#include <selinux/selinux.h>",
            "#include \"port-linux.h\"",
            "#include \"xmalloc.h\"",
            "#include \"log.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <selinux/get_context_list.h>\n#include <selinux/selinux.h>\n#include \"port-linux.h\"\n#include \"xmalloc.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <string.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\nssh_selinux_enabled(void)\n{\n\tstatic int enabled = -1;\n\n\tif (enabled == -1) {\n\t\tenabled = (is_selinux_enabled() == 1);\n\t\tdebug(\"SELinux support %s\", enabled ? \"enabled\" : \"disabled\");\n\t}\n\n\treturn (enabled);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <selinux/get_context_list.h>\n#include <selinux/selinux.h>\n#include \"port-linux.h\"\n#include \"xmalloc.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <string.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"includes.h\"\n\nvoid\nssh_selinux_setup_exec_context(char *pwname)\n{\n\tsecurity_context_t user_ctx = NULL;\n\n\tif (!ssh_selinux_enabled())\n\t\treturn;\n\n\tdebug3(\"%s: setting execution context\", __func__);\n\n\tuser_ctx = ssh_selinux_getctxbyname(pwname);\n\tif (setexeccon(user_ctx) != 0) {\n\t\tswitch (security_getenforce()) {\n\t\tcase -1:\n\t\t\tfatal(\"%s: security_getenforce() failed\", __func__);\n\t\tcase 0:\n\t\t\terror(\"%s: Failed to set SELinux execution \"\n\t\t\t    \"context for %s\", __func__, pwname);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tfatal(\"%s: Failed to set SELinux execution context \"\n\t\t\t    \"for %s (in enforcing mode)\", __func__, pwname);\n\t\t}\n\t}\n\tif (user_ctx != NULL)\n\t\tfreecon(user_ctx);\n\n\tdebug3(\"%s: done\", __func__);\n}"
  },
  {
    "function_name": "ssh_selinux_getctxbyname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/port-linux.c",
    "lines": "58-102",
    "snippet": "static security_context_t\nssh_selinux_getctxbyname(char *pwname)\n{\n\tsecurity_context_t sc = NULL;\n\tchar *sename = NULL, *lvl = NULL;\n\tint r;\n\n#ifdef HAVE_GETSEUSERBYNAME\n\tif (getseuserbyname(pwname, &sename, &lvl) != 0)\n\t\treturn NULL;\n#else\n\tsename = pwname;\n\tlvl = NULL;\n#endif\n\n#ifdef HAVE_GET_DEFAULT_CONTEXT_WITH_LEVEL\n\tr = get_default_context_with_level(sename, lvl, NULL, &sc);\n#else\n\tr = get_default_context(sename, NULL, &sc);\n#endif\n\n\tif (r != 0) {\n\t\tswitch (security_getenforce()) {\n\t\tcase -1:\n\t\t\tfatal(\"%s: ssh_selinux_getctxbyname: \"\n\t\t\t    \"security_getenforce() failed\", __func__);\n\t\tcase 0:\n\t\t\terror(\"%s: Failed to get default SELinux security \"\n\t\t\t    \"context for %s\", __func__, pwname);\n\t\t\tsc = NULL;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tfatal(\"%s: Failed to get default SELinux security \"\n\t\t\t    \"context for %s (in enforcing mode)\",\n\t\t\t    __func__, pwname);\n\t\t}\n\t}\n\n#ifdef HAVE_GETSEUSERBYNAME\n\tfree(sename);\n\tfree(lvl);\n#endif\n\n\treturn sc;\n}",
    "includes": [
      "#include <selinux/get_context_list.h>",
      "#include <selinux/selinux.h>",
      "#include \"port-linux.h\"",
      "#include \"xmalloc.h\"",
      "#include \"log.h\"",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "lvl"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "freeaddrinfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/fake-rfc2553.c",
          "lines": "109-119",
          "snippet": "void\nfreeaddrinfo(struct addrinfo *ai)\n{\n\tstruct addrinfo *next;\n\n\tfor(; ai != NULL;) {\n\t\tnext = ai->ai_next;\n\t\tfree(ai);\n\t\tai = next;\n\t}\n}",
          "includes": [
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <string.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\nvoid\nfreeaddrinfo(struct addrinfo *ai)\n{\n\tstruct addrinfo *next;\n\n\tfor(; ai != NULL;) {\n\t\tnext = ai->ai_next;\n\t\tfree(ai);\n\t\tai = next;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"%s: Failed to get default SELinux security \"\n\t\t\t    \"context for %s (in enforcing mode)\"",
            "__func__",
            "pwname"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fatal.c",
          "lines": "36-45",
          "snippet": "void\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\tcleanup_exit(255);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\tcleanup_exit(255);\n}"
        }
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"%s: Failed to get default SELinux security \"\n\t\t\t    \"context for %s\"",
            "__func__",
            "pwname"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "162-170",
          "snippet": "void\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"%s: ssh_selinux_getctxbyname: \"\n\t\t\t    \"security_getenforce() failed\"",
            "__func__"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "match_test_missing_fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/servconf.c",
          "lines": "988-993",
          "snippet": "static void\nmatch_test_missing_fatal(const char *criteria, const char *attrib)\n{\n\tfatal(\"'Match %s' in configuration but '%s' not in connection \"\n\t    \"test specification.\", criteria, attrib);\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"myproposal.h\"",
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"canohost.h\"",
            "#include \"groupaccess.h\"",
            "#include \"channels.h\"",
            "#include \"match.h\"",
            "#include \"mac.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"pathnames.h\"",
            "#include \"compat.h\"",
            "#include \"servconf.h\"",
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"log.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <util.h>",
            "#include <errno.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <netdb.h>",
            "#include <ctype.h>",
            "#include <net/route.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <sys/sysctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"myproposal.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"canohost.h\"\n#include \"groupaccess.h\"\n#include \"channels.h\"\n#include \"match.h\"\n#include \"mac.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"pathnames.h\"\n#include \"compat.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"log.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <util.h>\n#include <errno.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <netdb.h>\n#include <ctype.h>\n#include <net/route.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <sys/sysctl.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic void\nmatch_test_missing_fatal(const char *criteria, const char *attrib)\n{\n\tfatal(\"'Match %s' in configuration but '%s' not in connection \"\n\t    \"test specification.\", criteria, attrib);\n}"
        }
      },
      {
        "call_info": {
          "callee": "security_getenforce",
          "args": [],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_default_context",
          "args": [
            "sename",
            "NULL",
            "&sc"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_default_context_with_level",
          "args": [
            "sename",
            "lvl",
            "NULL",
            "&sc"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getseuserbyname",
          "args": [
            "pwname",
            "&sename",
            "&lvl"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <selinux/get_context_list.h>\n#include <selinux/selinux.h>\n#include \"port-linux.h\"\n#include \"xmalloc.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <string.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"includes.h\"\n\nstatic security_context_t\nssh_selinux_getctxbyname(char *pwname)\n{\n\tsecurity_context_t sc = NULL;\n\tchar *sename = NULL, *lvl = NULL;\n\tint r;\n\n#ifdef HAVE_GETSEUSERBYNAME\n\tif (getseuserbyname(pwname, &sename, &lvl) != 0)\n\t\treturn NULL;\n#else\n\tsename = pwname;\n\tlvl = NULL;\n#endif\n\n#ifdef HAVE_GET_DEFAULT_CONTEXT_WITH_LEVEL\n\tr = get_default_context_with_level(sename, lvl, NULL, &sc);\n#else\n\tr = get_default_context(sename, NULL, &sc);\n#endif\n\n\tif (r != 0) {\n\t\tswitch (security_getenforce()) {\n\t\tcase -1:\n\t\t\tfatal(\"%s: ssh_selinux_getctxbyname: \"\n\t\t\t    \"security_getenforce() failed\", __func__);\n\t\tcase 0:\n\t\t\terror(\"%s: Failed to get default SELinux security \"\n\t\t\t    \"context for %s\", __func__, pwname);\n\t\t\tsc = NULL;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tfatal(\"%s: Failed to get default SELinux security \"\n\t\t\t    \"context for %s (in enforcing mode)\",\n\t\t\t    __func__, pwname);\n\t\t}\n\t}\n\n#ifdef HAVE_GETSEUSERBYNAME\n\tfree(sename);\n\tfree(lvl);\n#endif\n\n\treturn sc;\n}"
  },
  {
    "function_name": "ssh_selinux_enabled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/port-linux.c",
    "lines": "44-55",
    "snippet": "int\nssh_selinux_enabled(void)\n{\n\tstatic int enabled = -1;\n\n\tif (enabled == -1) {\n\t\tenabled = (is_selinux_enabled() == 1);\n\t\tdebug(\"SELinux support %s\", enabled ? \"enabled\" : \"disabled\");\n\t}\n\n\treturn (enabled);\n}",
    "includes": [
      "#include <selinux/get_context_list.h>",
      "#include <selinux/selinux.h>",
      "#include \"port-linux.h\"",
      "#include \"xmalloc.h\"",
      "#include \"log.h\"",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"SELinux support %s\"",
            "enabled ? \"enabled\" : \"disabled\""
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_selinux_enabled",
          "args": [],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <selinux/get_context_list.h>\n#include <selinux/selinux.h>\n#include \"port-linux.h\"\n#include \"xmalloc.h\"\n#include \"log.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <string.h>\n#include <stdarg.h>\n#include <errno.h>\n#include \"includes.h\"\n\nint\nssh_selinux_enabled(void)\n{\n\tstatic int enabled = -1;\n\n\tif (enabled == -1) {\n\t\tenabled = (is_selinux_enabled() == 1);\n\t\tdebug(\"SELinux support %s\", enabled ? \"enabled\" : \"disabled\");\n\t}\n\n\treturn (enabled);\n}"
  }
]