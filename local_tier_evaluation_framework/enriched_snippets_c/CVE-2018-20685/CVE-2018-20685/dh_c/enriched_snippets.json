[
  {
    "function_name": "dh_estimate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
    "lines": "480-490",
    "snippet": "u_int\ndh_estimate(int bits)\n{\n\tif (bits <= 112)\n\t\treturn 2048;\n\tif (bits <= 128)\n\t\treturn 3072;\n\tif (bits <= 192)\n\t\treturn 7680;\n\treturn 8192;\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"ssherr.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"pathnames.h\"",
      "#include \"dh.h\"",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <openssl/dh.h>",
      "#include <openssl/bn.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nu_int\ndh_estimate(int bits)\n{\n\tif (bits <= 112)\n\t\treturn 2048;\n\tif (bits <= 128)\n\t\treturn 3072;\n\tif (bits <= 192)\n\t\treturn 7680;\n\treturn 8192;\n}"
  },
  {
    "function_name": "dh_new_group_fallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
    "lines": "458-471",
    "snippet": "DH *\ndh_new_group_fallback(int max)\n{\n\tdebug3(\"%s: requested max size %d\", __func__, max);\n\tif (max < 3072) {\n\t\tdebug3(\"using 2k bit group 14\");\n\t\treturn dh_new_group14();\n\t} else if (max < 6144) {\n\t\tdebug3(\"using 4k bit group 16\");\n\t\treturn dh_new_group16();\n\t}\n\tdebug3(\"using 8k bit group 18\");\n\treturn dh_new_group18();\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"ssherr.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"pathnames.h\"",
      "#include \"dh.h\"",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <openssl/dh.h>",
      "#include <openssl/bn.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dh_new_group18",
          "args": [],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "dh_new_group18",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
          "lines": "406-455",
          "snippet": "DH *\ndh_new_group18(void)\n{\n\tstatic char *gen = \"2\", *group18 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AAAC42D\" \"AD33170D\" \"04507A33\" \"A85521AB\" \"DF1CBA64\"\n\t    \"ECFB8504\" \"58DBEF0A\" \"8AEA7157\" \"5D060C7D\" \"B3970F85\" \"A6E1E4C7\"\n\t    \"ABF5AE8C\" \"DB0933D7\" \"1E8C94E0\" \"4A25619D\" \"CEE3D226\" \"1AD2EE6B\"\n\t    \"F12FFA06\" \"D98A0864\" \"D8760273\" \"3EC86A64\" \"521F2B18\" \"177B200C\"\n\t    \"BBE11757\" \"7A615D6C\" \"770988C0\" \"BAD946E2\" \"08E24FA0\" \"74E5AB31\"\n\t    \"43DB5BFC\" \"E0FD108E\" \"4B82D120\" \"A9210801\" \"1A723C12\" \"A787E6D7\"\n\t    \"88719A10\" \"BDBA5B26\" \"99C32718\" \"6AF4E23C\" \"1A946834\" \"B6150BDA\"\n\t    \"2583E9CA\" \"2AD44CE8\" \"DBBBC2DB\" \"04DE8EF9\" \"2E8EFC14\" \"1FBECAA6\"\n\t    \"287C5947\" \"4E6BC05D\" \"99B2964F\" \"A090C3A2\" \"233BA186\" \"515BE7ED\"\n\t    \"1F612970\" \"CEE2D7AF\" \"B81BDD76\" \"2170481C\" \"D0069127\" \"D5B05AA9\"\n\t    \"93B4EA98\" \"8D8FDDC1\" \"86FFB7DC\" \"90A6C08F\" \"4DF435C9\" \"34028492\"\n\t    \"36C3FAB4\" \"D27C7026\" \"C1D4DCB2\" \"602646DE\" \"C9751E76\" \"3DBA37BD\"\n\t    \"F8FF9406\" \"AD9E530E\" \"E5DB382F\" \"413001AE\" \"B06A53ED\" \"9027D831\"\n\t    \"179727B0\" \"865A8918\" \"DA3EDBEB\" \"CF9B14ED\" \"44CE6CBA\" \"CED4BB1B\"\n\t    \"DB7F1447\" \"E6CC254B\" \"33205151\" \"2BD7AF42\" \"6FB8F401\" \"378CD2BF\"\n\t    \"5983CA01\" \"C64B92EC\" \"F032EA15\" \"D1721D03\" \"F482D7CE\" \"6E74FEF6\"\n\t    \"D55E702F\" \"46980C82\" \"B5A84031\" \"900B1C9E\" \"59E7C97F\" \"BEC7E8F3\"\n\t    \"23A97A7E\" \"36CC88BE\" \"0F1D45B7\" \"FF585AC5\" \"4BD407B2\" \"2B4154AA\"\n\t    \"CC8F6D7E\" \"BF48E1D8\" \"14CC5ED2\" \"0F8037E0\" \"A79715EE\" \"F29BE328\"\n\t    \"06A1D58B\" \"B7C5DA76\" \"F550AA3D\" \"8A1FBFF0\" \"EB19CCB1\" \"A313D55C\"\n\t    \"DA56C9EC\" \"2EF29632\" \"387FE8D7\" \"6E3C0468\" \"043E8F66\" \"3F4860EE\"\n\t    \"12BF2D5B\" \"0B7474D6\" \"E694F91E\" \"6DBE1159\" \"74A3926F\" \"12FEE5E4\"\n\t    \"38777CB6\" \"A932DF8C\" \"D8BEC4D0\" \"73B931BA\" \"3BC832B6\" \"8D9DD300\"\n\t    \"741FA7BF\" \"8AFC47ED\" \"2576F693\" \"6BA42466\" \"3AAB639C\" \"5AE4F568\"\n\t    \"3423B474\" \"2BF1C978\" \"238F16CB\" \"E39D652D\" \"E3FDB8BE\" \"FC848AD9\"\n\t    \"22222E04\" \"A4037C07\" \"13EB57A8\" \"1A23F0C7\" \"3473FC64\" \"6CEA306B\"\n\t    \"4BCBC886\" \"2F8385DD\" \"FA9D4B7F\" \"A2C087E8\" \"79683303\" \"ED5BDD3A\"\n\t    \"062B3CF5\" \"B3A278A6\" \"6D2A13F8\" \"3F44F82D\" \"DF310EE0\" \"74AB6A36\"\n\t    \"4597E899\" \"A0255DC1\" \"64F31CC5\" \"0846851D\" \"F9AB4819\" \"5DED7EA1\"\n\t    \"B1D510BD\" \"7EE74D73\" \"FAF36BC3\" \"1ECFA268\" \"359046F4\" \"EB879F92\"\n\t    \"4009438B\" \"481C6CD7\" \"889A002E\" \"D5EE382B\" \"C9190DA6\" \"FC026E47\"\n\t    \"9558E447\" \"5677E9AA\" \"9E3050E2\" \"765694DF\" \"C81F56E8\" \"80B96E71\"\n\t    \"60C980DD\" \"98EDD3DF\" \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group18));\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"dh.h\"",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <openssl/dh.h>",
            "#include <openssl/bn.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group18(void)\n{\n\tstatic char *gen = \"2\", *group18 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AAAC42D\" \"AD33170D\" \"04507A33\" \"A85521AB\" \"DF1CBA64\"\n\t    \"ECFB8504\" \"58DBEF0A\" \"8AEA7157\" \"5D060C7D\" \"B3970F85\" \"A6E1E4C7\"\n\t    \"ABF5AE8C\" \"DB0933D7\" \"1E8C94E0\" \"4A25619D\" \"CEE3D226\" \"1AD2EE6B\"\n\t    \"F12FFA06\" \"D98A0864\" \"D8760273\" \"3EC86A64\" \"521F2B18\" \"177B200C\"\n\t    \"BBE11757\" \"7A615D6C\" \"770988C0\" \"BAD946E2\" \"08E24FA0\" \"74E5AB31\"\n\t    \"43DB5BFC\" \"E0FD108E\" \"4B82D120\" \"A9210801\" \"1A723C12\" \"A787E6D7\"\n\t    \"88719A10\" \"BDBA5B26\" \"99C32718\" \"6AF4E23C\" \"1A946834\" \"B6150BDA\"\n\t    \"2583E9CA\" \"2AD44CE8\" \"DBBBC2DB\" \"04DE8EF9\" \"2E8EFC14\" \"1FBECAA6\"\n\t    \"287C5947\" \"4E6BC05D\" \"99B2964F\" \"A090C3A2\" \"233BA186\" \"515BE7ED\"\n\t    \"1F612970\" \"CEE2D7AF\" \"B81BDD76\" \"2170481C\" \"D0069127\" \"D5B05AA9\"\n\t    \"93B4EA98\" \"8D8FDDC1\" \"86FFB7DC\" \"90A6C08F\" \"4DF435C9\" \"34028492\"\n\t    \"36C3FAB4\" \"D27C7026\" \"C1D4DCB2\" \"602646DE\" \"C9751E76\" \"3DBA37BD\"\n\t    \"F8FF9406\" \"AD9E530E\" \"E5DB382F\" \"413001AE\" \"B06A53ED\" \"9027D831\"\n\t    \"179727B0\" \"865A8918\" \"DA3EDBEB\" \"CF9B14ED\" \"44CE6CBA\" \"CED4BB1B\"\n\t    \"DB7F1447\" \"E6CC254B\" \"33205151\" \"2BD7AF42\" \"6FB8F401\" \"378CD2BF\"\n\t    \"5983CA01\" \"C64B92EC\" \"F032EA15\" \"D1721D03\" \"F482D7CE\" \"6E74FEF6\"\n\t    \"D55E702F\" \"46980C82\" \"B5A84031\" \"900B1C9E\" \"59E7C97F\" \"BEC7E8F3\"\n\t    \"23A97A7E\" \"36CC88BE\" \"0F1D45B7\" \"FF585AC5\" \"4BD407B2\" \"2B4154AA\"\n\t    \"CC8F6D7E\" \"BF48E1D8\" \"14CC5ED2\" \"0F8037E0\" \"A79715EE\" \"F29BE328\"\n\t    \"06A1D58B\" \"B7C5DA76\" \"F550AA3D\" \"8A1FBFF0\" \"EB19CCB1\" \"A313D55C\"\n\t    \"DA56C9EC\" \"2EF29632\" \"387FE8D7\" \"6E3C0468\" \"043E8F66\" \"3F4860EE\"\n\t    \"12BF2D5B\" \"0B7474D6\" \"E694F91E\" \"6DBE1159\" \"74A3926F\" \"12FEE5E4\"\n\t    \"38777CB6\" \"A932DF8C\" \"D8BEC4D0\" \"73B931BA\" \"3BC832B6\" \"8D9DD300\"\n\t    \"741FA7BF\" \"8AFC47ED\" \"2576F693\" \"6BA42466\" \"3AAB639C\" \"5AE4F568\"\n\t    \"3423B474\" \"2BF1C978\" \"238F16CB\" \"E39D652D\" \"E3FDB8BE\" \"FC848AD9\"\n\t    \"22222E04\" \"A4037C07\" \"13EB57A8\" \"1A23F0C7\" \"3473FC64\" \"6CEA306B\"\n\t    \"4BCBC886\" \"2F8385DD\" \"FA9D4B7F\" \"A2C087E8\" \"79683303\" \"ED5BDD3A\"\n\t    \"062B3CF5\" \"B3A278A6\" \"6D2A13F8\" \"3F44F82D\" \"DF310EE0\" \"74AB6A36\"\n\t    \"4597E899\" \"A0255DC1\" \"64F31CC5\" \"0846851D\" \"F9AB4819\" \"5DED7EA1\"\n\t    \"B1D510BD\" \"7EE74D73\" \"FAF36BC3\" \"1ECFA268\" \"359046F4\" \"EB879F92\"\n\t    \"4009438B\" \"481C6CD7\" \"889A002E\" \"D5EE382B\" \"C9190DA6\" \"FC026E47\"\n\t    \"9558E447\" \"5677E9AA\" \"9E3050E2\" \"765694DF\" \"C81F56E8\" \"80B96E71\"\n\t    \"60C980DD\" \"98EDD3DF\" \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group18));\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"using 8k bit group 18\""
          ],
          "line": 469
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dh_new_group16",
          "args": [],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "dh_new_group16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
          "lines": "375-403",
          "snippet": "DH *\ndh_new_group16(void)\n{\n\tstatic char *gen = \"2\", *group16 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AAAC42D\" \"AD33170D\" \"04507A33\" \"A85521AB\" \"DF1CBA64\"\n\t    \"ECFB8504\" \"58DBEF0A\" \"8AEA7157\" \"5D060C7D\" \"B3970F85\" \"A6E1E4C7\"\n\t    \"ABF5AE8C\" \"DB0933D7\" \"1E8C94E0\" \"4A25619D\" \"CEE3D226\" \"1AD2EE6B\"\n\t    \"F12FFA06\" \"D98A0864\" \"D8760273\" \"3EC86A64\" \"521F2B18\" \"177B200C\"\n\t    \"BBE11757\" \"7A615D6C\" \"770988C0\" \"BAD946E2\" \"08E24FA0\" \"74E5AB31\"\n\t    \"43DB5BFC\" \"E0FD108E\" \"4B82D120\" \"A9210801\" \"1A723C12\" \"A787E6D7\"\n\t    \"88719A10\" \"BDBA5B26\" \"99C32718\" \"6AF4E23C\" \"1A946834\" \"B6150BDA\"\n\t    \"2583E9CA\" \"2AD44CE8\" \"DBBBC2DB\" \"04DE8EF9\" \"2E8EFC14\" \"1FBECAA6\"\n\t    \"287C5947\" \"4E6BC05D\" \"99B2964F\" \"A090C3A2\" \"233BA186\" \"515BE7ED\"\n\t    \"1F612970\" \"CEE2D7AF\" \"B81BDD76\" \"2170481C\" \"D0069127\" \"D5B05AA9\"\n\t    \"93B4EA98\" \"8D8FDDC1\" \"86FFB7DC\" \"90A6C08F\" \"4DF435C9\" \"34063199\"\n\t    \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group16));\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"dh.h\"",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <openssl/dh.h>",
            "#include <openssl/bn.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group16(void)\n{\n\tstatic char *gen = \"2\", *group16 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AAAC42D\" \"AD33170D\" \"04507A33\" \"A85521AB\" \"DF1CBA64\"\n\t    \"ECFB8504\" \"58DBEF0A\" \"8AEA7157\" \"5D060C7D\" \"B3970F85\" \"A6E1E4C7\"\n\t    \"ABF5AE8C\" \"DB0933D7\" \"1E8C94E0\" \"4A25619D\" \"CEE3D226\" \"1AD2EE6B\"\n\t    \"F12FFA06\" \"D98A0864\" \"D8760273\" \"3EC86A64\" \"521F2B18\" \"177B200C\"\n\t    \"BBE11757\" \"7A615D6C\" \"770988C0\" \"BAD946E2\" \"08E24FA0\" \"74E5AB31\"\n\t    \"43DB5BFC\" \"E0FD108E\" \"4B82D120\" \"A9210801\" \"1A723C12\" \"A787E6D7\"\n\t    \"88719A10\" \"BDBA5B26\" \"99C32718\" \"6AF4E23C\" \"1A946834\" \"B6150BDA\"\n\t    \"2583E9CA\" \"2AD44CE8\" \"DBBBC2DB\" \"04DE8EF9\" \"2E8EFC14\" \"1FBECAA6\"\n\t    \"287C5947\" \"4E6BC05D\" \"99B2964F\" \"A090C3A2\" \"233BA186\" \"515BE7ED\"\n\t    \"1F612970\" \"CEE2D7AF\" \"B81BDD76\" \"2170481C\" \"D0069127\" \"D5B05AA9\"\n\t    \"93B4EA98\" \"8D8FDDC1\" \"86FFB7DC\" \"90A6C08F\" \"4DF435C9\" \"34063199\"\n\t    \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group16));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dh_new_group14",
          "args": [],
          "line": 464
        },
        "resolved": true,
        "details": {
          "function_name": "dh_new_group14",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
          "lines": "355-372",
          "snippet": "DH *\ndh_new_group14(void)\n{\n\tstatic char *gen = \"2\", *group14 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AACAA68\" \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group14));\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"dh.h\"",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <openssl/dh.h>",
            "#include <openssl/bn.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group14(void)\n{\n\tstatic char *gen = \"2\", *group14 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AACAA68\" \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group14));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group_fallback(int max)\n{\n\tdebug3(\"%s: requested max size %d\", __func__, max);\n\tif (max < 3072) {\n\t\tdebug3(\"using 2k bit group 14\");\n\t\treturn dh_new_group14();\n\t} else if (max < 6144) {\n\t\tdebug3(\"using 4k bit group 16\");\n\t\treturn dh_new_group16();\n\t}\n\tdebug3(\"using 8k bit group 18\");\n\treturn dh_new_group18();\n}"
  },
  {
    "function_name": "dh_new_group18",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
    "lines": "406-455",
    "snippet": "DH *\ndh_new_group18(void)\n{\n\tstatic char *gen = \"2\", *group18 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AAAC42D\" \"AD33170D\" \"04507A33\" \"A85521AB\" \"DF1CBA64\"\n\t    \"ECFB8504\" \"58DBEF0A\" \"8AEA7157\" \"5D060C7D\" \"B3970F85\" \"A6E1E4C7\"\n\t    \"ABF5AE8C\" \"DB0933D7\" \"1E8C94E0\" \"4A25619D\" \"CEE3D226\" \"1AD2EE6B\"\n\t    \"F12FFA06\" \"D98A0864\" \"D8760273\" \"3EC86A64\" \"521F2B18\" \"177B200C\"\n\t    \"BBE11757\" \"7A615D6C\" \"770988C0\" \"BAD946E2\" \"08E24FA0\" \"74E5AB31\"\n\t    \"43DB5BFC\" \"E0FD108E\" \"4B82D120\" \"A9210801\" \"1A723C12\" \"A787E6D7\"\n\t    \"88719A10\" \"BDBA5B26\" \"99C32718\" \"6AF4E23C\" \"1A946834\" \"B6150BDA\"\n\t    \"2583E9CA\" \"2AD44CE8\" \"DBBBC2DB\" \"04DE8EF9\" \"2E8EFC14\" \"1FBECAA6\"\n\t    \"287C5947\" \"4E6BC05D\" \"99B2964F\" \"A090C3A2\" \"233BA186\" \"515BE7ED\"\n\t    \"1F612970\" \"CEE2D7AF\" \"B81BDD76\" \"2170481C\" \"D0069127\" \"D5B05AA9\"\n\t    \"93B4EA98\" \"8D8FDDC1\" \"86FFB7DC\" \"90A6C08F\" \"4DF435C9\" \"34028492\"\n\t    \"36C3FAB4\" \"D27C7026\" \"C1D4DCB2\" \"602646DE\" \"C9751E76\" \"3DBA37BD\"\n\t    \"F8FF9406\" \"AD9E530E\" \"E5DB382F\" \"413001AE\" \"B06A53ED\" \"9027D831\"\n\t    \"179727B0\" \"865A8918\" \"DA3EDBEB\" \"CF9B14ED\" \"44CE6CBA\" \"CED4BB1B\"\n\t    \"DB7F1447\" \"E6CC254B\" \"33205151\" \"2BD7AF42\" \"6FB8F401\" \"378CD2BF\"\n\t    \"5983CA01\" \"C64B92EC\" \"F032EA15\" \"D1721D03\" \"F482D7CE\" \"6E74FEF6\"\n\t    \"D55E702F\" \"46980C82\" \"B5A84031\" \"900B1C9E\" \"59E7C97F\" \"BEC7E8F3\"\n\t    \"23A97A7E\" \"36CC88BE\" \"0F1D45B7\" \"FF585AC5\" \"4BD407B2\" \"2B4154AA\"\n\t    \"CC8F6D7E\" \"BF48E1D8\" \"14CC5ED2\" \"0F8037E0\" \"A79715EE\" \"F29BE328\"\n\t    \"06A1D58B\" \"B7C5DA76\" \"F550AA3D\" \"8A1FBFF0\" \"EB19CCB1\" \"A313D55C\"\n\t    \"DA56C9EC\" \"2EF29632\" \"387FE8D7\" \"6E3C0468\" \"043E8F66\" \"3F4860EE\"\n\t    \"12BF2D5B\" \"0B7474D6\" \"E694F91E\" \"6DBE1159\" \"74A3926F\" \"12FEE5E4\"\n\t    \"38777CB6\" \"A932DF8C\" \"D8BEC4D0\" \"73B931BA\" \"3BC832B6\" \"8D9DD300\"\n\t    \"741FA7BF\" \"8AFC47ED\" \"2576F693\" \"6BA42466\" \"3AAB639C\" \"5AE4F568\"\n\t    \"3423B474\" \"2BF1C978\" \"238F16CB\" \"E39D652D\" \"E3FDB8BE\" \"FC848AD9\"\n\t    \"22222E04\" \"A4037C07\" \"13EB57A8\" \"1A23F0C7\" \"3473FC64\" \"6CEA306B\"\n\t    \"4BCBC886\" \"2F8385DD\" \"FA9D4B7F\" \"A2C087E8\" \"79683303\" \"ED5BDD3A\"\n\t    \"062B3CF5\" \"B3A278A6\" \"6D2A13F8\" \"3F44F82D\" \"DF310EE0\" \"74AB6A36\"\n\t    \"4597E899\" \"A0255DC1\" \"64F31CC5\" \"0846851D\" \"F9AB4819\" \"5DED7EA1\"\n\t    \"B1D510BD\" \"7EE74D73\" \"FAF36BC3\" \"1ECFA268\" \"359046F4\" \"EB879F92\"\n\t    \"4009438B\" \"481C6CD7\" \"889A002E\" \"D5EE382B\" \"C9190DA6\" \"FC026E47\"\n\t    \"9558E447\" \"5677E9AA\" \"9E3050E2\" \"765694DF\" \"C81F56E8\" \"80B96E71\"\n\t    \"60C980DD\" \"98EDD3DF\" \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group18));\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"ssherr.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"pathnames.h\"",
      "#include \"dh.h\"",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <openssl/dh.h>",
      "#include <openssl/bn.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dh_new_group_asc",
          "args": [
            "gen",
            "group18"
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "dh_new_group_asc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
          "lines": "299-318",
          "snippet": "DH *\ndh_new_group_asc(const char *gen, const char *modulus)\n{\n\tDH *dh;\n\tBIGNUM *dh_p = NULL, *dh_g = NULL;\n\n\tif ((dh = DH_new()) == NULL)\n\t\treturn NULL;\n\tif (BN_hex2bn(&dh_p, modulus) == 0 ||\n\t    BN_hex2bn(&dh_g, gen) == 0)\n\t\tgoto fail;\n\tif (!DH_set0_pqg(dh, dh_p, NULL, dh_g))\n\t\tgoto fail;\n\treturn dh;\n fail:\n\tDH_free(dh);\n\tBN_clear_free(dh_p);\n\tBN_clear_free(dh_g);\n\treturn NULL;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"dh.h\"",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <openssl/dh.h>",
            "#include <openssl/bn.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group_asc(const char *gen, const char *modulus)\n{\n\tDH *dh;\n\tBIGNUM *dh_p = NULL, *dh_g = NULL;\n\n\tif ((dh = DH_new()) == NULL)\n\t\treturn NULL;\n\tif (BN_hex2bn(&dh_p, modulus) == 0 ||\n\t    BN_hex2bn(&dh_g, gen) == 0)\n\t\tgoto fail;\n\tif (!DH_set0_pqg(dh, dh_p, NULL, dh_g))\n\t\tgoto fail;\n\treturn dh;\n fail:\n\tDH_free(dh);\n\tBN_clear_free(dh_p);\n\tBN_clear_free(dh_g);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group18(void)\n{\n\tstatic char *gen = \"2\", *group18 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AAAC42D\" \"AD33170D\" \"04507A33\" \"A85521AB\" \"DF1CBA64\"\n\t    \"ECFB8504\" \"58DBEF0A\" \"8AEA7157\" \"5D060C7D\" \"B3970F85\" \"A6E1E4C7\"\n\t    \"ABF5AE8C\" \"DB0933D7\" \"1E8C94E0\" \"4A25619D\" \"CEE3D226\" \"1AD2EE6B\"\n\t    \"F12FFA06\" \"D98A0864\" \"D8760273\" \"3EC86A64\" \"521F2B18\" \"177B200C\"\n\t    \"BBE11757\" \"7A615D6C\" \"770988C0\" \"BAD946E2\" \"08E24FA0\" \"74E5AB31\"\n\t    \"43DB5BFC\" \"E0FD108E\" \"4B82D120\" \"A9210801\" \"1A723C12\" \"A787E6D7\"\n\t    \"88719A10\" \"BDBA5B26\" \"99C32718\" \"6AF4E23C\" \"1A946834\" \"B6150BDA\"\n\t    \"2583E9CA\" \"2AD44CE8\" \"DBBBC2DB\" \"04DE8EF9\" \"2E8EFC14\" \"1FBECAA6\"\n\t    \"287C5947\" \"4E6BC05D\" \"99B2964F\" \"A090C3A2\" \"233BA186\" \"515BE7ED\"\n\t    \"1F612970\" \"CEE2D7AF\" \"B81BDD76\" \"2170481C\" \"D0069127\" \"D5B05AA9\"\n\t    \"93B4EA98\" \"8D8FDDC1\" \"86FFB7DC\" \"90A6C08F\" \"4DF435C9\" \"34028492\"\n\t    \"36C3FAB4\" \"D27C7026\" \"C1D4DCB2\" \"602646DE\" \"C9751E76\" \"3DBA37BD\"\n\t    \"F8FF9406\" \"AD9E530E\" \"E5DB382F\" \"413001AE\" \"B06A53ED\" \"9027D831\"\n\t    \"179727B0\" \"865A8918\" \"DA3EDBEB\" \"CF9B14ED\" \"44CE6CBA\" \"CED4BB1B\"\n\t    \"DB7F1447\" \"E6CC254B\" \"33205151\" \"2BD7AF42\" \"6FB8F401\" \"378CD2BF\"\n\t    \"5983CA01\" \"C64B92EC\" \"F032EA15\" \"D1721D03\" \"F482D7CE\" \"6E74FEF6\"\n\t    \"D55E702F\" \"46980C82\" \"B5A84031\" \"900B1C9E\" \"59E7C97F\" \"BEC7E8F3\"\n\t    \"23A97A7E\" \"36CC88BE\" \"0F1D45B7\" \"FF585AC5\" \"4BD407B2\" \"2B4154AA\"\n\t    \"CC8F6D7E\" \"BF48E1D8\" \"14CC5ED2\" \"0F8037E0\" \"A79715EE\" \"F29BE328\"\n\t    \"06A1D58B\" \"B7C5DA76\" \"F550AA3D\" \"8A1FBFF0\" \"EB19CCB1\" \"A313D55C\"\n\t    \"DA56C9EC\" \"2EF29632\" \"387FE8D7\" \"6E3C0468\" \"043E8F66\" \"3F4860EE\"\n\t    \"12BF2D5B\" \"0B7474D6\" \"E694F91E\" \"6DBE1159\" \"74A3926F\" \"12FEE5E4\"\n\t    \"38777CB6\" \"A932DF8C\" \"D8BEC4D0\" \"73B931BA\" \"3BC832B6\" \"8D9DD300\"\n\t    \"741FA7BF\" \"8AFC47ED\" \"2576F693\" \"6BA42466\" \"3AAB639C\" \"5AE4F568\"\n\t    \"3423B474\" \"2BF1C978\" \"238F16CB\" \"E39D652D\" \"E3FDB8BE\" \"FC848AD9\"\n\t    \"22222E04\" \"A4037C07\" \"13EB57A8\" \"1A23F0C7\" \"3473FC64\" \"6CEA306B\"\n\t    \"4BCBC886\" \"2F8385DD\" \"FA9D4B7F\" \"A2C087E8\" \"79683303\" \"ED5BDD3A\"\n\t    \"062B3CF5\" \"B3A278A6\" \"6D2A13F8\" \"3F44F82D\" \"DF310EE0\" \"74AB6A36\"\n\t    \"4597E899\" \"A0255DC1\" \"64F31CC5\" \"0846851D\" \"F9AB4819\" \"5DED7EA1\"\n\t    \"B1D510BD\" \"7EE74D73\" \"FAF36BC3\" \"1ECFA268\" \"359046F4\" \"EB879F92\"\n\t    \"4009438B\" \"481C6CD7\" \"889A002E\" \"D5EE382B\" \"C9190DA6\" \"FC026E47\"\n\t    \"9558E447\" \"5677E9AA\" \"9E3050E2\" \"765694DF\" \"C81F56E8\" \"80B96E71\"\n\t    \"60C980DD\" \"98EDD3DF\" \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group18));\n}"
  },
  {
    "function_name": "dh_new_group16",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
    "lines": "375-403",
    "snippet": "DH *\ndh_new_group16(void)\n{\n\tstatic char *gen = \"2\", *group16 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AAAC42D\" \"AD33170D\" \"04507A33\" \"A85521AB\" \"DF1CBA64\"\n\t    \"ECFB8504\" \"58DBEF0A\" \"8AEA7157\" \"5D060C7D\" \"B3970F85\" \"A6E1E4C7\"\n\t    \"ABF5AE8C\" \"DB0933D7\" \"1E8C94E0\" \"4A25619D\" \"CEE3D226\" \"1AD2EE6B\"\n\t    \"F12FFA06\" \"D98A0864\" \"D8760273\" \"3EC86A64\" \"521F2B18\" \"177B200C\"\n\t    \"BBE11757\" \"7A615D6C\" \"770988C0\" \"BAD946E2\" \"08E24FA0\" \"74E5AB31\"\n\t    \"43DB5BFC\" \"E0FD108E\" \"4B82D120\" \"A9210801\" \"1A723C12\" \"A787E6D7\"\n\t    \"88719A10\" \"BDBA5B26\" \"99C32718\" \"6AF4E23C\" \"1A946834\" \"B6150BDA\"\n\t    \"2583E9CA\" \"2AD44CE8\" \"DBBBC2DB\" \"04DE8EF9\" \"2E8EFC14\" \"1FBECAA6\"\n\t    \"287C5947\" \"4E6BC05D\" \"99B2964F\" \"A090C3A2\" \"233BA186\" \"515BE7ED\"\n\t    \"1F612970\" \"CEE2D7AF\" \"B81BDD76\" \"2170481C\" \"D0069127\" \"D5B05AA9\"\n\t    \"93B4EA98\" \"8D8FDDC1\" \"86FFB7DC\" \"90A6C08F\" \"4DF435C9\" \"34063199\"\n\t    \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group16));\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"ssherr.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"pathnames.h\"",
      "#include \"dh.h\"",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <openssl/dh.h>",
      "#include <openssl/bn.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dh_new_group_asc",
          "args": [
            "gen",
            "group16"
          ],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "dh_new_group_asc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
          "lines": "299-318",
          "snippet": "DH *\ndh_new_group_asc(const char *gen, const char *modulus)\n{\n\tDH *dh;\n\tBIGNUM *dh_p = NULL, *dh_g = NULL;\n\n\tif ((dh = DH_new()) == NULL)\n\t\treturn NULL;\n\tif (BN_hex2bn(&dh_p, modulus) == 0 ||\n\t    BN_hex2bn(&dh_g, gen) == 0)\n\t\tgoto fail;\n\tif (!DH_set0_pqg(dh, dh_p, NULL, dh_g))\n\t\tgoto fail;\n\treturn dh;\n fail:\n\tDH_free(dh);\n\tBN_clear_free(dh_p);\n\tBN_clear_free(dh_g);\n\treturn NULL;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"dh.h\"",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <openssl/dh.h>",
            "#include <openssl/bn.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group_asc(const char *gen, const char *modulus)\n{\n\tDH *dh;\n\tBIGNUM *dh_p = NULL, *dh_g = NULL;\n\n\tif ((dh = DH_new()) == NULL)\n\t\treturn NULL;\n\tif (BN_hex2bn(&dh_p, modulus) == 0 ||\n\t    BN_hex2bn(&dh_g, gen) == 0)\n\t\tgoto fail;\n\tif (!DH_set0_pqg(dh, dh_p, NULL, dh_g))\n\t\tgoto fail;\n\treturn dh;\n fail:\n\tDH_free(dh);\n\tBN_clear_free(dh_p);\n\tBN_clear_free(dh_g);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group16(void)\n{\n\tstatic char *gen = \"2\", *group16 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AAAC42D\" \"AD33170D\" \"04507A33\" \"A85521AB\" \"DF1CBA64\"\n\t    \"ECFB8504\" \"58DBEF0A\" \"8AEA7157\" \"5D060C7D\" \"B3970F85\" \"A6E1E4C7\"\n\t    \"ABF5AE8C\" \"DB0933D7\" \"1E8C94E0\" \"4A25619D\" \"CEE3D226\" \"1AD2EE6B\"\n\t    \"F12FFA06\" \"D98A0864\" \"D8760273\" \"3EC86A64\" \"521F2B18\" \"177B200C\"\n\t    \"BBE11757\" \"7A615D6C\" \"770988C0\" \"BAD946E2\" \"08E24FA0\" \"74E5AB31\"\n\t    \"43DB5BFC\" \"E0FD108E\" \"4B82D120\" \"A9210801\" \"1A723C12\" \"A787E6D7\"\n\t    \"88719A10\" \"BDBA5B26\" \"99C32718\" \"6AF4E23C\" \"1A946834\" \"B6150BDA\"\n\t    \"2583E9CA\" \"2AD44CE8\" \"DBBBC2DB\" \"04DE8EF9\" \"2E8EFC14\" \"1FBECAA6\"\n\t    \"287C5947\" \"4E6BC05D\" \"99B2964F\" \"A090C3A2\" \"233BA186\" \"515BE7ED\"\n\t    \"1F612970\" \"CEE2D7AF\" \"B81BDD76\" \"2170481C\" \"D0069127\" \"D5B05AA9\"\n\t    \"93B4EA98\" \"8D8FDDC1\" \"86FFB7DC\" \"90A6C08F\" \"4DF435C9\" \"34063199\"\n\t    \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group16));\n}"
  },
  {
    "function_name": "dh_new_group14",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
    "lines": "355-372",
    "snippet": "DH *\ndh_new_group14(void)\n{\n\tstatic char *gen = \"2\", *group14 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AACAA68\" \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group14));\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"ssherr.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"pathnames.h\"",
      "#include \"dh.h\"",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <openssl/dh.h>",
      "#include <openssl/bn.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dh_new_group_asc",
          "args": [
            "gen",
            "group14"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "dh_new_group_asc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
          "lines": "299-318",
          "snippet": "DH *\ndh_new_group_asc(const char *gen, const char *modulus)\n{\n\tDH *dh;\n\tBIGNUM *dh_p = NULL, *dh_g = NULL;\n\n\tif ((dh = DH_new()) == NULL)\n\t\treturn NULL;\n\tif (BN_hex2bn(&dh_p, modulus) == 0 ||\n\t    BN_hex2bn(&dh_g, gen) == 0)\n\t\tgoto fail;\n\tif (!DH_set0_pqg(dh, dh_p, NULL, dh_g))\n\t\tgoto fail;\n\treturn dh;\n fail:\n\tDH_free(dh);\n\tBN_clear_free(dh_p);\n\tBN_clear_free(dh_g);\n\treturn NULL;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"dh.h\"",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <openssl/dh.h>",
            "#include <openssl/bn.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group_asc(const char *gen, const char *modulus)\n{\n\tDH *dh;\n\tBIGNUM *dh_p = NULL, *dh_g = NULL;\n\n\tif ((dh = DH_new()) == NULL)\n\t\treturn NULL;\n\tif (BN_hex2bn(&dh_p, modulus) == 0 ||\n\t    BN_hex2bn(&dh_g, gen) == 0)\n\t\tgoto fail;\n\tif (!DH_set0_pqg(dh, dh_p, NULL, dh_g))\n\t\tgoto fail;\n\treturn dh;\n fail:\n\tDH_free(dh);\n\tBN_clear_free(dh_p);\n\tBN_clear_free(dh_g);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group14(void)\n{\n\tstatic char *gen = \"2\", *group14 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE45B3D\"\n\t    \"C2007CB8\" \"A163BF05\" \"98DA4836\" \"1C55D39A\" \"69163FA8\" \"FD24CF5F\"\n\t    \"83655D23\" \"DCA3AD96\" \"1C62F356\" \"208552BB\" \"9ED52907\" \"7096966D\"\n\t    \"670C354E\" \"4ABC9804\" \"F1746C08\" \"CA18217C\" \"32905E46\" \"2E36CE3B\"\n\t    \"E39E772C\" \"180E8603\" \"9B2783A2\" \"EC07A28F\" \"B5C55DF0\" \"6F4C52C9\"\n\t    \"DE2BCBF6\" \"95581718\" \"3995497C\" \"EA956AE5\" \"15D22618\" \"98FA0510\"\n\t    \"15728E5A\" \"8AACAA68\" \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group14));\n}"
  },
  {
    "function_name": "dh_new_group1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
    "lines": "340-352",
    "snippet": "DH *\ndh_new_group1(void)\n{\n\tstatic char *gen = \"2\", *group1 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE65381\"\n\t    \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group1));\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"ssherr.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"pathnames.h\"",
      "#include \"dh.h\"",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <openssl/dh.h>",
      "#include <openssl/bn.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dh_new_group_asc",
          "args": [
            "gen",
            "group1"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "dh_new_group_asc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
          "lines": "299-318",
          "snippet": "DH *\ndh_new_group_asc(const char *gen, const char *modulus)\n{\n\tDH *dh;\n\tBIGNUM *dh_p = NULL, *dh_g = NULL;\n\n\tif ((dh = DH_new()) == NULL)\n\t\treturn NULL;\n\tif (BN_hex2bn(&dh_p, modulus) == 0 ||\n\t    BN_hex2bn(&dh_g, gen) == 0)\n\t\tgoto fail;\n\tif (!DH_set0_pqg(dh, dh_p, NULL, dh_g))\n\t\tgoto fail;\n\treturn dh;\n fail:\n\tDH_free(dh);\n\tBN_clear_free(dh_p);\n\tBN_clear_free(dh_g);\n\treturn NULL;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"dh.h\"",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <openssl/dh.h>",
            "#include <openssl/bn.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group_asc(const char *gen, const char *modulus)\n{\n\tDH *dh;\n\tBIGNUM *dh_p = NULL, *dh_g = NULL;\n\n\tif ((dh = DH_new()) == NULL)\n\t\treturn NULL;\n\tif (BN_hex2bn(&dh_p, modulus) == 0 ||\n\t    BN_hex2bn(&dh_g, gen) == 0)\n\t\tgoto fail;\n\tif (!DH_set0_pqg(dh, dh_p, NULL, dh_g))\n\t\tgoto fail;\n\treturn dh;\n fail:\n\tDH_free(dh);\n\tBN_clear_free(dh_p);\n\tBN_clear_free(dh_g);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group1(void)\n{\n\tstatic char *gen = \"2\", *group1 =\n\t    \"FFFFFFFF\" \"FFFFFFFF\" \"C90FDAA2\" \"2168C234\" \"C4C6628B\" \"80DC1CD1\"\n\t    \"29024E08\" \"8A67CC74\" \"020BBEA6\" \"3B139B22\" \"514A0879\" \"8E3404DD\"\n\t    \"EF9519B3\" \"CD3A431B\" \"302B0A6D\" \"F25F1437\" \"4FE1356D\" \"6D51C245\"\n\t    \"E485B576\" \"625E7EC6\" \"F44C42E9\" \"A637ED6B\" \"0BFF5CB6\" \"F406B7ED\"\n\t    \"EE386BFB\" \"5A899FA5\" \"AE9F2411\" \"7C4B1FE6\" \"49286651\" \"ECE65381\"\n\t    \"FFFFFFFF\" \"FFFFFFFF\";\n\n\treturn (dh_new_group_asc(gen, group1));\n}"
  },
  {
    "function_name": "dh_new_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
    "lines": "324-337",
    "snippet": "DH *\ndh_new_group(BIGNUM *gen, BIGNUM *modulus)\n{\n\tDH *dh;\n\n\tif ((dh = DH_new()) == NULL)\n\t\treturn NULL;\n\tif (!DH_set0_pqg(dh, modulus, NULL, gen)) {\n\t\tDH_free(dh);\n\t\treturn NULL;\n\t}\n\n\treturn dh;\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"ssherr.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"pathnames.h\"",
      "#include \"dh.h\"",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <openssl/dh.h>",
      "#include <openssl/bn.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DH_free",
          "args": [
            "dh"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DH_set0_pqg",
          "args": [
            "dh",
            "modulus",
            "NULL",
            "gen"
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "DH_set0_pqg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "464-484",
          "snippet": "int\nDH_set0_pqg(DH *dh, BIGNUM *p, BIGNUM *q, BIGNUM *g)\n{\n\tif ((dh->p == NULL && p == NULL) || (dh->g == NULL && g == NULL))\n\t\treturn 0;\n\n\tif (p != NULL) {\n\t\tBN_free(dh->p);\n\t\tdh->p = p;\n\t}\n\tif (q != NULL) {\n\t\tBN_free(dh->q);\n\t\tdh->q = q;\n\t}\n\tif (g != NULL) {\n\t\tBN_free(dh->g);\n\t\tdh->g = g;\n\t}\n\n\treturn 1;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nDH_set0_pqg(DH *dh, BIGNUM *p, BIGNUM *q, BIGNUM *g)\n{\n\tif ((dh->p == NULL && p == NULL) || (dh->g == NULL && g == NULL))\n\t\treturn 0;\n\n\tif (p != NULL) {\n\t\tBN_free(dh->p);\n\t\tdh->p = p;\n\t}\n\tif (q != NULL) {\n\t\tBN_free(dh->q);\n\t\tdh->q = q;\n\t}\n\tif (g != NULL) {\n\t\tBN_free(dh->g);\n\t\tdh->g = g;\n\t}\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DH_new",
          "args": [],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group(BIGNUM *gen, BIGNUM *modulus)\n{\n\tDH *dh;\n\n\tif ((dh = DH_new()) == NULL)\n\t\treturn NULL;\n\tif (!DH_set0_pqg(dh, modulus, NULL, gen)) {\n\t\tDH_free(dh);\n\t\treturn NULL;\n\t}\n\n\treturn dh;\n}"
  },
  {
    "function_name": "dh_new_group_asc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
    "lines": "299-318",
    "snippet": "DH *\ndh_new_group_asc(const char *gen, const char *modulus)\n{\n\tDH *dh;\n\tBIGNUM *dh_p = NULL, *dh_g = NULL;\n\n\tif ((dh = DH_new()) == NULL)\n\t\treturn NULL;\n\tif (BN_hex2bn(&dh_p, modulus) == 0 ||\n\t    BN_hex2bn(&dh_g, gen) == 0)\n\t\tgoto fail;\n\tif (!DH_set0_pqg(dh, dh_p, NULL, dh_g))\n\t\tgoto fail;\n\treturn dh;\n fail:\n\tDH_free(dh);\n\tBN_clear_free(dh_p);\n\tBN_clear_free(dh_g);\n\treturn NULL;\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"ssherr.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"pathnames.h\"",
      "#include \"dh.h\"",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <openssl/dh.h>",
      "#include <openssl/bn.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "dh_g"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "dh_p"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DH_free",
          "args": [
            "dh"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DH_set0_pqg",
          "args": [
            "dh",
            "dh_p",
            "NULL",
            "dh_g"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "DH_set0_pqg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "464-484",
          "snippet": "int\nDH_set0_pqg(DH *dh, BIGNUM *p, BIGNUM *q, BIGNUM *g)\n{\n\tif ((dh->p == NULL && p == NULL) || (dh->g == NULL && g == NULL))\n\t\treturn 0;\n\n\tif (p != NULL) {\n\t\tBN_free(dh->p);\n\t\tdh->p = p;\n\t}\n\tif (q != NULL) {\n\t\tBN_free(dh->q);\n\t\tdh->q = q;\n\t}\n\tif (g != NULL) {\n\t\tBN_free(dh->g);\n\t\tdh->g = g;\n\t}\n\n\treturn 1;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nDH_set0_pqg(DH *dh, BIGNUM *p, BIGNUM *q, BIGNUM *g)\n{\n\tif ((dh->p == NULL && p == NULL) || (dh->g == NULL && g == NULL))\n\t\treturn 0;\n\n\tif (p != NULL) {\n\t\tBN_free(dh->p);\n\t\tdh->p = p;\n\t}\n\tif (q != NULL) {\n\t\tBN_free(dh->q);\n\t\tdh->q = q;\n\t}\n\tif (g != NULL) {\n\t\tBN_free(dh->g);\n\t\tdh->g = g;\n\t}\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_hex2bn",
          "args": [
            "&dh_g",
            "gen"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_hex2bn",
          "args": [
            "&dh_p",
            "modulus"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DH_new",
          "args": [],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group_asc(const char *gen, const char *modulus)\n{\n\tDH *dh;\n\tBIGNUM *dh_p = NULL, *dh_g = NULL;\n\n\tif ((dh = DH_new()) == NULL)\n\t\treturn NULL;\n\tif (BN_hex2bn(&dh_p, modulus) == 0 ||\n\t    BN_hex2bn(&dh_g, gen) == 0)\n\t\tgoto fail;\n\tif (!DH_set0_pqg(dh, dh_p, NULL, dh_g))\n\t\tgoto fail;\n\treturn dh;\n fail:\n\tDH_free(dh);\n\tBN_clear_free(dh_p);\n\tBN_clear_free(dh_g);\n\treturn NULL;\n}"
  },
  {
    "function_name": "dh_gen_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
    "lines": "270-297",
    "snippet": "int\ndh_gen_key(DH *dh, int need)\n{\n\tint pbits;\n\tconst BIGNUM *dh_p, *pub_key;\n\n\tDH_get0_pqg(dh, &dh_p, NULL, NULL);\n\n\tif (need < 0 || dh_p == NULL ||\n\t    (pbits = BN_num_bits(dh_p)) <= 0 ||\n\t    need > INT_MAX / 2 || 2 * need > pbits)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (need < 256)\n\t\tneed = 256;\n\t/*\n\t * Pollard Rho, Big step/Little Step attacks are O(sqrt(n)),\n\t * so double requested need here.\n\t */\n\tif (!DH_set_length(dh, MINIMUM(need * 2, pbits - 1)))\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\n\tif (DH_generate_key(dh) == 0)\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\tDH_get0_key(dh, &pub_key, NULL);\n\tif (!dh_pub_is_valid(dh, pub_key))\n\t\treturn SSH_ERR_INVALID_FORMAT;\n\treturn 0;\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"ssherr.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"pathnames.h\"",
      "#include \"dh.h\"",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <openssl/dh.h>",
      "#include <openssl/bn.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dh_pub_is_valid",
          "args": [
            "dh",
            "pub_key"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "dh_pub_is_valid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
          "lines": "222-268",
          "snippet": "int\ndh_pub_is_valid(const DH *dh, const BIGNUM *dh_pub)\n{\n\tint i;\n\tint n = BN_num_bits(dh_pub);\n\tint bits_set = 0;\n\tBIGNUM *tmp;\n\tconst BIGNUM *dh_p;\n\n\tDH_get0_pqg(dh, &dh_p, NULL, NULL);\n\n\tif (BN_is_negative(dh_pub)) {\n\t\tlogit(\"invalid public DH value: negative\");\n\t\treturn 0;\n\t}\n\tif (BN_cmp(dh_pub, BN_value_one()) != 1) {\t/* pub_exp <= 1 */\n\t\tlogit(\"invalid public DH value: <= 1\");\n\t\treturn 0;\n\t}\n\n\tif ((tmp = BN_new()) == NULL) {\n\t\terror(\"%s: BN_new failed\", __func__);\n\t\treturn 0;\n\t}\n\tif (!BN_sub(tmp, dh_p, BN_value_one()) ||\n\t    BN_cmp(dh_pub, tmp) != -1) {\t\t/* pub_exp > p-2 */\n\t\tBN_clear_free(tmp);\n\t\tlogit(\"invalid public DH value: >= p-1\");\n\t\treturn 0;\n\t}\n\tBN_clear_free(tmp);\n\n\tfor (i = 0; i <= n; i++)\n\t\tif (BN_is_bit_set(dh_pub, i))\n\t\t\tbits_set++;\n\tdebug2(\"bits set: %d/%d\", bits_set, BN_num_bits(dh_p));\n\n\t/*\n\t * if g==2 and bits_set==1 then computing log_g(dh_pub) is trivial\n\t */\n\tif (bits_set < 4) {\n\t\tlogit(\"invalid public DH value (%d/%d)\",\n\t\t   bits_set, BN_num_bits(dh_p));\n\t\treturn 0;\n\t}\n\treturn 1;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"dh.h\"",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <openssl/dh.h>",
            "#include <openssl/bn.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nint\ndh_pub_is_valid(const DH *dh, const BIGNUM *dh_pub)\n{\n\tint i;\n\tint n = BN_num_bits(dh_pub);\n\tint bits_set = 0;\n\tBIGNUM *tmp;\n\tconst BIGNUM *dh_p;\n\n\tDH_get0_pqg(dh, &dh_p, NULL, NULL);\n\n\tif (BN_is_negative(dh_pub)) {\n\t\tlogit(\"invalid public DH value: negative\");\n\t\treturn 0;\n\t}\n\tif (BN_cmp(dh_pub, BN_value_one()) != 1) {\t/* pub_exp <= 1 */\n\t\tlogit(\"invalid public DH value: <= 1\");\n\t\treturn 0;\n\t}\n\n\tif ((tmp = BN_new()) == NULL) {\n\t\terror(\"%s: BN_new failed\", __func__);\n\t\treturn 0;\n\t}\n\tif (!BN_sub(tmp, dh_p, BN_value_one()) ||\n\t    BN_cmp(dh_pub, tmp) != -1) {\t\t/* pub_exp > p-2 */\n\t\tBN_clear_free(tmp);\n\t\tlogit(\"invalid public DH value: >= p-1\");\n\t\treturn 0;\n\t}\n\tBN_clear_free(tmp);\n\n\tfor (i = 0; i <= n; i++)\n\t\tif (BN_is_bit_set(dh_pub, i))\n\t\t\tbits_set++;\n\tdebug2(\"bits set: %d/%d\", bits_set, BN_num_bits(dh_p));\n\n\t/*\n\t * if g==2 and bits_set==1 then computing log_g(dh_pub) is trivial\n\t */\n\tif (bits_set < 4) {\n\t\tlogit(\"invalid public DH value (%d/%d)\",\n\t\t   bits_set, BN_num_bits(dh_p));\n\t\treturn 0;\n\t}\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DH_get0_key",
          "args": [
            "dh",
            "&pub_key",
            "NULL"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "DH_get0_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "488-495",
          "snippet": "void\nDH_get0_key(const DH *dh, const BIGNUM **pub_key, const BIGNUM **priv_key)\n{\n\tif (pub_key != NULL)\n\t\t*pub_key = dh->pub_key;\n\tif (priv_key != NULL)\n\t\t*priv_key = dh->priv_key;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nDH_get0_key(const DH *dh, const BIGNUM **pub_key, const BIGNUM **priv_key)\n{\n\tif (pub_key != NULL)\n\t\t*pub_key = dh->pub_key;\n\tif (priv_key != NULL)\n\t\t*priv_key = dh->priv_key;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DH_generate_key",
          "args": [
            "dh"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DH_set_length",
          "args": [
            "dh",
            "MINIMUM(need * 2, pbits - 1)"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "DH_set_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "516-524",
          "snippet": "int\nDH_set_length(DH *dh, long length)\n{\n\tif (length < 0 || length > INT_MAX)\n\t\treturn 0;\n\n\tdh->length = length;\n\treturn 1;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nDH_set_length(DH *dh, long length)\n{\n\tif (length < 0 || length > INT_MAX)\n\t\treturn 0;\n\n\tdh->length = length;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MINIMUM",
          "args": [
            "need * 2",
            "pbits - 1"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_num_bits",
          "args": [
            "dh_p"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DH_get0_pqg",
          "args": [
            "dh",
            "&dh_p",
            "NULL",
            "NULL"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "DH_get0_pqg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "451-460",
          "snippet": "void\nDH_get0_pqg(const DH *dh, const BIGNUM **p, const BIGNUM **q, const BIGNUM **g)\n{\n\tif (p != NULL)\n\t\t*p = dh->p;\n\tif (q != NULL)\n\t\t*q = dh->q;\n\tif (g != NULL)\n\t\t*g = dh->g;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nDH_get0_pqg(const DH *dh, const BIGNUM **p, const BIGNUM **q, const BIGNUM **g)\n{\n\tif (p != NULL)\n\t\t*p = dh->p;\n\tif (q != NULL)\n\t\t*q = dh->q;\n\tif (g != NULL)\n\t\t*g = dh->g;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nint\ndh_gen_key(DH *dh, int need)\n{\n\tint pbits;\n\tconst BIGNUM *dh_p, *pub_key;\n\n\tDH_get0_pqg(dh, &dh_p, NULL, NULL);\n\n\tif (need < 0 || dh_p == NULL ||\n\t    (pbits = BN_num_bits(dh_p)) <= 0 ||\n\t    need > INT_MAX / 2 || 2 * need > pbits)\n\t\treturn SSH_ERR_INVALID_ARGUMENT;\n\tif (need < 256)\n\t\tneed = 256;\n\t/*\n\t * Pollard Rho, Big step/Little Step attacks are O(sqrt(n)),\n\t * so double requested need here.\n\t */\n\tif (!DH_set_length(dh, MINIMUM(need * 2, pbits - 1)))\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\n\tif (DH_generate_key(dh) == 0)\n\t\treturn SSH_ERR_LIBCRYPTO_ERROR;\n\tDH_get0_key(dh, &pub_key, NULL);\n\tif (!dh_pub_is_valid(dh, pub_key))\n\t\treturn SSH_ERR_INVALID_FORMAT;\n\treturn 0;\n}"
  },
  {
    "function_name": "dh_pub_is_valid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
    "lines": "222-268",
    "snippet": "int\ndh_pub_is_valid(const DH *dh, const BIGNUM *dh_pub)\n{\n\tint i;\n\tint n = BN_num_bits(dh_pub);\n\tint bits_set = 0;\n\tBIGNUM *tmp;\n\tconst BIGNUM *dh_p;\n\n\tDH_get0_pqg(dh, &dh_p, NULL, NULL);\n\n\tif (BN_is_negative(dh_pub)) {\n\t\tlogit(\"invalid public DH value: negative\");\n\t\treturn 0;\n\t}\n\tif (BN_cmp(dh_pub, BN_value_one()) != 1) {\t/* pub_exp <= 1 */\n\t\tlogit(\"invalid public DH value: <= 1\");\n\t\treturn 0;\n\t}\n\n\tif ((tmp = BN_new()) == NULL) {\n\t\terror(\"%s: BN_new failed\", __func__);\n\t\treturn 0;\n\t}\n\tif (!BN_sub(tmp, dh_p, BN_value_one()) ||\n\t    BN_cmp(dh_pub, tmp) != -1) {\t\t/* pub_exp > p-2 */\n\t\tBN_clear_free(tmp);\n\t\tlogit(\"invalid public DH value: >= p-1\");\n\t\treturn 0;\n\t}\n\tBN_clear_free(tmp);\n\n\tfor (i = 0; i <= n; i++)\n\t\tif (BN_is_bit_set(dh_pub, i))\n\t\t\tbits_set++;\n\tdebug2(\"bits set: %d/%d\", bits_set, BN_num_bits(dh_p));\n\n\t/*\n\t * if g==2 and bits_set==1 then computing log_g(dh_pub) is trivial\n\t */\n\tif (bits_set < 4) {\n\t\tlogit(\"invalid public DH value (%d/%d)\",\n\t\t   bits_set, BN_num_bits(dh_p));\n\t\treturn 0;\n\t}\n\treturn 1;\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"ssherr.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"pathnames.h\"",
      "#include \"dh.h\"",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <openssl/dh.h>",
      "#include <openssl/bn.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "logit",
          "args": [
            "\"invalid public DH value (%d/%d)\"",
            "bits_set",
            "BN_num_bits(dh_p)"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "logit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "198-206",
          "snippet": "void\nlogit(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_INFO, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nlogit(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_INFO, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_num_bits",
          "args": [
            "dh_p"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug2",
          "args": [
            "\"bits set: %d/%d\"",
            "bits_set",
            "BN_num_bits(dh_p)"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "debug2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "232-240",
          "snippet": "void\ndebug2(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG2, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug2(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG2, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_num_bits",
          "args": [
            "dh_p"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_is_bit_set",
          "args": [
            "dh_pub",
            "i"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "tmp"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "tmp"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_cmp",
          "args": [
            "dh_pub",
            "tmp"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_sub",
          "args": [
            "tmp",
            "dh_p",
            "BN_value_one()"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_value_one",
          "args": [],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"%s: BN_new failed\"",
            "__func__"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "162-170",
          "snippet": "void\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_cmp",
          "args": [
            "dh_pub",
            "BN_value_one()"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_value_one",
          "args": [],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_is_negative",
          "args": [
            "dh_pub"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DH_get0_pqg",
          "args": [
            "dh",
            "&dh_p",
            "NULL",
            "NULL"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "DH_get0_pqg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "451-460",
          "snippet": "void\nDH_get0_pqg(const DH *dh, const BIGNUM **p, const BIGNUM **q, const BIGNUM **g)\n{\n\tif (p != NULL)\n\t\t*p = dh->p;\n\tif (q != NULL)\n\t\t*q = dh->q;\n\tif (g != NULL)\n\t\t*g = dh->g;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nDH_get0_pqg(const DH *dh, const BIGNUM **p, const BIGNUM **q, const BIGNUM **g)\n{\n\tif (p != NULL)\n\t\t*p = dh->p;\n\tif (q != NULL)\n\t\t*q = dh->q;\n\tif (g != NULL)\n\t\t*g = dh->g;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_num_bits",
          "args": [
            "dh_pub"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nint\ndh_pub_is_valid(const DH *dh, const BIGNUM *dh_pub)\n{\n\tint i;\n\tint n = BN_num_bits(dh_pub);\n\tint bits_set = 0;\n\tBIGNUM *tmp;\n\tconst BIGNUM *dh_p;\n\n\tDH_get0_pqg(dh, &dh_p, NULL, NULL);\n\n\tif (BN_is_negative(dh_pub)) {\n\t\tlogit(\"invalid public DH value: negative\");\n\t\treturn 0;\n\t}\n\tif (BN_cmp(dh_pub, BN_value_one()) != 1) {\t/* pub_exp <= 1 */\n\t\tlogit(\"invalid public DH value: <= 1\");\n\t\treturn 0;\n\t}\n\n\tif ((tmp = BN_new()) == NULL) {\n\t\terror(\"%s: BN_new failed\", __func__);\n\t\treturn 0;\n\t}\n\tif (!BN_sub(tmp, dh_p, BN_value_one()) ||\n\t    BN_cmp(dh_pub, tmp) != -1) {\t\t/* pub_exp > p-2 */\n\t\tBN_clear_free(tmp);\n\t\tlogit(\"invalid public DH value: >= p-1\");\n\t\treturn 0;\n\t}\n\tBN_clear_free(tmp);\n\n\tfor (i = 0; i <= n; i++)\n\t\tif (BN_is_bit_set(dh_pub, i))\n\t\t\tbits_set++;\n\tdebug2(\"bits set: %d/%d\", bits_set, BN_num_bits(dh_p));\n\n\t/*\n\t * if g==2 and bits_set==1 then computing log_g(dh_pub) is trivial\n\t */\n\tif (bits_set < 4) {\n\t\tlogit(\"invalid public DH value (%d/%d)\",\n\t\t   bits_set, BN_num_bits(dh_p));\n\t\treturn 0;\n\t}\n\treturn 1;\n}"
  },
  {
    "function_name": "choose_dh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
    "lines": "146-218",
    "snippet": "DH *\nchoose_dh(int min, int wantbits, int max)\n{\n\tFILE *f;\n\tchar *line = NULL;\n\tsize_t linesize = 0;\n\tint best, bestcount, which, linenum;\n\tstruct dhgroup dhg;\n\n\tif ((f = fopen(_PATH_DH_MODULI, \"r\")) == NULL) {\n\t\tlogit(\"WARNING: could not open %s (%s), using fixed modulus\",\n\t\t    _PATH_DH_MODULI, strerror(errno));\n\t\treturn (dh_new_group_fallback(max));\n\t}\n\n\tlinenum = 0;\n\tbest = bestcount = 0;\n\twhile (getline(&line, &linesize, f) != -1) {\n\t\tlinenum++;\n\t\tif (!parse_prime(linenum, line, &dhg))\n\t\t\tcontinue;\n\t\tBN_clear_free(dhg.g);\n\t\tBN_clear_free(dhg.p);\n\n\t\tif (dhg.size > max || dhg.size < min)\n\t\t\tcontinue;\n\n\t\tif ((dhg.size > wantbits && dhg.size < best) ||\n\t\t    (dhg.size > best && best < wantbits)) {\n\t\t\tbest = dhg.size;\n\t\t\tbestcount = 0;\n\t\t}\n\t\tif (dhg.size == best)\n\t\t\tbestcount++;\n\t}\n\tfree(line);\n\tline = NULL;\n\tlinesize = 0;\n\trewind(f);\n\n\tif (bestcount == 0) {\n\t\tfclose(f);\n\t\tlogit(\"WARNING: no suitable primes in %s\", _PATH_DH_MODULI);\n\t\treturn (dh_new_group_fallback(max));\n\t}\n\twhich = arc4random_uniform(bestcount);\n\n\tlinenum = 0;\n\tbestcount = 0;\n\twhile (getline(&line, &linesize, f) != -1) {\n\t\tlinenum++;\n\t\tif (!parse_prime(linenum, line, &dhg))\n\t\t\tcontinue;\n\t\tif ((dhg.size > max || dhg.size < min) ||\n\t\t    dhg.size != best ||\n\t\t    bestcount++ != which) {\n\t\t\tBN_clear_free(dhg.g);\n\t\t\tBN_clear_free(dhg.p);\n\t\t\tcontinue;\n\t\t}\n\t\tbreak;\n\t}\n\tfree(line);\n\tline = NULL;\n\tfclose(f);\n\tif (bestcount != which + 1) {\n\t\tlogit(\"WARNING: selected prime disappeared in %s, giving up\",\n\t\t    _PATH_DH_MODULI);\n\t\treturn (dh_new_group_fallback(max));\n\t}\n\n\treturn (dh_new_group(dhg.g, dhg.p));\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"ssherr.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"pathnames.h\"",
      "#include \"dh.h\"",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <openssl/dh.h>",
      "#include <openssl/bn.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dh_new_group",
          "args": [
            "dhg.g",
            "dhg.p"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "dh_new_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
          "lines": "324-337",
          "snippet": "DH *\ndh_new_group(BIGNUM *gen, BIGNUM *modulus)\n{\n\tDH *dh;\n\n\tif ((dh = DH_new()) == NULL)\n\t\treturn NULL;\n\tif (!DH_set0_pqg(dh, modulus, NULL, gen)) {\n\t\tDH_free(dh);\n\t\treturn NULL;\n\t}\n\n\treturn dh;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"dh.h\"",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <openssl/dh.h>",
            "#include <openssl/bn.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group(BIGNUM *gen, BIGNUM *modulus)\n{\n\tDH *dh;\n\n\tif ((dh = DH_new()) == NULL)\n\t\treturn NULL;\n\tif (!DH_set0_pqg(dh, modulus, NULL, gen)) {\n\t\tDH_free(dh);\n\t\treturn NULL;\n\t}\n\n\treturn dh;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dh_new_group_fallback",
          "args": [
            "max"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "dh_new_group_fallback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
          "lines": "458-471",
          "snippet": "DH *\ndh_new_group_fallback(int max)\n{\n\tdebug3(\"%s: requested max size %d\", __func__, max);\n\tif (max < 3072) {\n\t\tdebug3(\"using 2k bit group 14\");\n\t\treturn dh_new_group14();\n\t} else if (max < 6144) {\n\t\tdebug3(\"using 4k bit group 16\");\n\t\treturn dh_new_group16();\n\t}\n\tdebug3(\"using 8k bit group 18\");\n\treturn dh_new_group18();\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"dh.h\"",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <openssl/dh.h>",
            "#include <openssl/bn.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\ndh_new_group_fallback(int max)\n{\n\tdebug3(\"%s: requested max size %d\", __func__, max);\n\tif (max < 3072) {\n\t\tdebug3(\"using 2k bit group 14\");\n\t\treturn dh_new_group14();\n\t} else if (max < 6144) {\n\t\tdebug3(\"using 4k bit group 16\");\n\t\treturn dh_new_group16();\n\t}\n\tdebug3(\"using 8k bit group 18\");\n\treturn dh_new_group18();\n}"
        }
      },
      {
        "call_info": {
          "callee": "logit",
          "args": [
            "\"WARNING: selected prime disappeared in %s, giving up\"",
            "_PATH_DH_MODULI"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "logit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "198-206",
          "snippet": "void\nlogit(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_INFO, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nlogit(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_INFO, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "f"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "line"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "freeze",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/smult_curve25519_ref.c",
          "lines": "50-60",
          "snippet": "static void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [
            "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;"
          ],
          "called_functions": [],
          "contextual_snippet": "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;\n\nstatic void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "dhg.p"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "dhg.g"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parse_prime",
          "args": [
            "linenum",
            "line",
            "&dhg"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "parse_prime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
          "lines": "48-144",
          "snippet": "static int\nparse_prime(int linenum, char *line, struct dhgroup *dhg)\n{\n\tchar *cp, *arg;\n\tchar *strsize, *gen, *prime;\n\tconst char *errstr = NULL;\n\tlong long n;\n\n\tdhg->p = dhg->g = NULL;\n\tcp = line;\n\tif ((arg = strdelim(&cp)) == NULL)\n\t\treturn 0;\n\t/* Ignore leading whitespace */\n\tif (*arg == '\\0')\n\t\targ = strdelim(&cp);\n\tif (!arg || !*arg || *arg == '#')\n\t\treturn 0;\n\n\t/* time */\n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\targ = strsep(&cp, \" \"); /* type */\n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\t/* Ensure this is a safe prime */\n\tn = strtonum(arg, 0, 5, &errstr);\n\tif (errstr != NULL || n != MODULI_TYPE_SAFE) {\n\t\terror(\"moduli:%d: type is not %d\", linenum, MODULI_TYPE_SAFE);\n\t\tgoto fail;\n\t}\n\targ = strsep(&cp, \" \"); /* tests */\n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\t/* Ensure prime has been tested and is not composite */\n\tn = strtonum(arg, 0, 0x1f, &errstr);\n\tif (errstr != NULL ||\n\t    (n & MODULI_TESTS_COMPOSITE) || !(n & ~MODULI_TESTS_COMPOSITE)) {\n\t\terror(\"moduli:%d: invalid moduli tests flag\", linenum);\n\t\tgoto fail;\n\t}\n\targ = strsep(&cp, \" \"); /* tries */\n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\tn = strtonum(arg, 0, 1<<30, &errstr);\n\tif (errstr != NULL || n == 0) {\n\t\terror(\"moduli:%d: invalid primality trial count\", linenum);\n\t\tgoto fail;\n\t}\n\tstrsize = strsep(&cp, \" \"); /* size */\n\tif (cp == NULL || *strsize == '\\0' ||\n\t    (dhg->size = (int)strtonum(strsize, 0, 64*1024, &errstr)) == 0 ||\n\t    errstr) {\n\t\terror(\"moduli:%d: invalid prime length\", linenum);\n\t\tgoto fail;\n\t}\n\t/* The whole group is one bit larger */\n\tdhg->size++;\n\tgen = strsep(&cp, \" \"); /* gen */\n\tif (cp == NULL || *gen == '\\0')\n\t\tgoto truncated;\n\tprime = strsep(&cp, \" \"); /* prime */\n\tif (cp != NULL || *prime == '\\0') {\n truncated:\n\t\terror(\"moduli:%d: truncated\", linenum);\n\t\tgoto fail;\n\t}\n\n\tif ((dhg->g = BN_new()) == NULL ||\n\t    (dhg->p = BN_new()) == NULL) {\n\t\terror(\"parse_prime: BN_new failed\");\n\t\tgoto fail;\n\t}\n\tif (BN_hex2bn(&dhg->g, gen) == 0) {\n\t\terror(\"moduli:%d: could not parse generator value\", linenum);\n\t\tgoto fail;\n\t}\n\tif (BN_hex2bn(&dhg->p, prime) == 0) {\n\t\terror(\"moduli:%d: could not parse prime value\", linenum);\n\t\tgoto fail;\n\t}\n\tif (BN_num_bits(dhg->p) != dhg->size) {\n\t\terror(\"moduli:%d: prime has wrong size: actual %d listed %d\",\n\t\t    linenum, BN_num_bits(dhg->p), dhg->size - 1);\n\t\tgoto fail;\n\t}\n\tif (BN_cmp(dhg->g, BN_value_one()) <= 0) {\n\t\terror(\"moduli:%d: generator is invalid\", linenum);\n\t\tgoto fail;\n\t}\n\treturn 1;\n\n fail:\n\tBN_clear_free(dhg->g);\n\tBN_clear_free(dhg->p);\n\tdhg->g = dhg->p = NULL;\n\treturn 0;\n}",
          "includes": [
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"dh.h\"",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <openssl/dh.h>",
            "#include <openssl/bn.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nstatic int\nparse_prime(int linenum, char *line, struct dhgroup *dhg)\n{\n\tchar *cp, *arg;\n\tchar *strsize, *gen, *prime;\n\tconst char *errstr = NULL;\n\tlong long n;\n\n\tdhg->p = dhg->g = NULL;\n\tcp = line;\n\tif ((arg = strdelim(&cp)) == NULL)\n\t\treturn 0;\n\t/* Ignore leading whitespace */\n\tif (*arg == '\\0')\n\t\targ = strdelim(&cp);\n\tif (!arg || !*arg || *arg == '#')\n\t\treturn 0;\n\n\t/* time */\n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\targ = strsep(&cp, \" \"); /* type */\n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\t/* Ensure this is a safe prime */\n\tn = strtonum(arg, 0, 5, &errstr);\n\tif (errstr != NULL || n != MODULI_TYPE_SAFE) {\n\t\terror(\"moduli:%d: type is not %d\", linenum, MODULI_TYPE_SAFE);\n\t\tgoto fail;\n\t}\n\targ = strsep(&cp, \" \"); /* tests */\n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\t/* Ensure prime has been tested and is not composite */\n\tn = strtonum(arg, 0, 0x1f, &errstr);\n\tif (errstr != NULL ||\n\t    (n & MODULI_TESTS_COMPOSITE) || !(n & ~MODULI_TESTS_COMPOSITE)) {\n\t\terror(\"moduli:%d: invalid moduli tests flag\", linenum);\n\t\tgoto fail;\n\t}\n\targ = strsep(&cp, \" \"); /* tries */\n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\tn = strtonum(arg, 0, 1<<30, &errstr);\n\tif (errstr != NULL || n == 0) {\n\t\terror(\"moduli:%d: invalid primality trial count\", linenum);\n\t\tgoto fail;\n\t}\n\tstrsize = strsep(&cp, \" \"); /* size */\n\tif (cp == NULL || *strsize == '\\0' ||\n\t    (dhg->size = (int)strtonum(strsize, 0, 64*1024, &errstr)) == 0 ||\n\t    errstr) {\n\t\terror(\"moduli:%d: invalid prime length\", linenum);\n\t\tgoto fail;\n\t}\n\t/* The whole group is one bit larger */\n\tdhg->size++;\n\tgen = strsep(&cp, \" \"); /* gen */\n\tif (cp == NULL || *gen == '\\0')\n\t\tgoto truncated;\n\tprime = strsep(&cp, \" \"); /* prime */\n\tif (cp != NULL || *prime == '\\0') {\n truncated:\n\t\terror(\"moduli:%d: truncated\", linenum);\n\t\tgoto fail;\n\t}\n\n\tif ((dhg->g = BN_new()) == NULL ||\n\t    (dhg->p = BN_new()) == NULL) {\n\t\terror(\"parse_prime: BN_new failed\");\n\t\tgoto fail;\n\t}\n\tif (BN_hex2bn(&dhg->g, gen) == 0) {\n\t\terror(\"moduli:%d: could not parse generator value\", linenum);\n\t\tgoto fail;\n\t}\n\tif (BN_hex2bn(&dhg->p, prime) == 0) {\n\t\terror(\"moduli:%d: could not parse prime value\", linenum);\n\t\tgoto fail;\n\t}\n\tif (BN_num_bits(dhg->p) != dhg->size) {\n\t\terror(\"moduli:%d: prime has wrong size: actual %d listed %d\",\n\t\t    linenum, BN_num_bits(dhg->p), dhg->size - 1);\n\t\tgoto fail;\n\t}\n\tif (BN_cmp(dhg->g, BN_value_one()) <= 0) {\n\t\terror(\"moduli:%d: generator is invalid\", linenum);\n\t\tgoto fail;\n\t}\n\treturn 1;\n\n fail:\n\tBN_clear_free(dhg->g);\n\tBN_clear_free(dhg->p);\n\tdhg->g = dhg->p = NULL;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getline",
          "args": [
            "&line",
            "&linesize",
            "f"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "getline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-getline.c",
          "lines": "92-96",
          "snippet": "ssize_t\ngetline(char **buf, size_t *bufsiz, FILE *fp)\n{\n\treturn getdelim(buf, bufsiz, '\\n', fp);\n}",
          "includes": [
            "#include <string.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include \"file.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include \"file.h\"\n#include \"includes.h\"\n\nssize_t\ngetline(char **buf, size_t *bufsiz, FILE *fp)\n{\n\treturn getdelim(buf, bufsiz, '\\n', fp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "arc4random_uniform",
          "args": [
            "bestcount"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "arc4random_uniform",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/arc4random.c",
          "lines": "291-315",
          "snippet": "u_int32_t\narc4random_uniform(u_int32_t upper_bound)\n{\n\tu_int32_t r, min;\n\n\tif (upper_bound < 2)\n\t\treturn 0;\n\n\t/* 2**32 % x == (2**32 - x) % x */\n\tmin = -upper_bound % upper_bound;\n\n\t/*\n\t * This could theoretically loop forever but each retry has\n\t * p > 0.5 (worst case, usually far better) of selecting a\n\t * number inside the range we need, so it should rarely need\n\t * to re-roll.\n\t */\n\tfor (;;) {\n\t\tr = arc4random();\n\t\tif (r >= min)\n\t\t\tbreak;\n\t}\n\n\treturn r % upper_bound;\n}",
          "includes": [
            "#include <machine/pctr.h>",
            "#include <stdio.h>",
            "#include \"chacha_private.h\"",
            "#include \"log.h\"",
            "#include <openssl/err.h>",
            "#include <openssl/rand.h>",
            "# include <sys/random.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <machine/pctr.h>\n#include <stdio.h>\n#include \"chacha_private.h\"\n#include \"log.h\"\n#include <openssl/err.h>\n#include <openssl/rand.h>\n# include <sys/random.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nu_int32_t\narc4random_uniform(u_int32_t upper_bound)\n{\n\tu_int32_t r, min;\n\n\tif (upper_bound < 2)\n\t\treturn 0;\n\n\t/* 2**32 % x == (2**32 - x) % x */\n\tmin = -upper_bound % upper_bound;\n\n\t/*\n\t * This could theoretically loop forever but each retry has\n\t * p > 0.5 (worst case, usually far better) of selecting a\n\t * number inside the range we need, so it should rarely need\n\t * to re-roll.\n\t */\n\tfor (;;) {\n\t\tr = arc4random();\n\t\tif (r >= min)\n\t\t\tbreak;\n\t}\n\n\treturn r % upper_bound;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "f"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rewind",
          "args": [
            "f"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "dhg.p"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "dhg.g"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "errno"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gai_strerror",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "140-146",
          "snippet": "const char *\nssh_gai_strerror(int gaierr)\n{\n\tif (gaierr == EAI_SYSTEM && errno != 0)\n\t\treturn strerror(errno);\n\treturn gai_strerror(gaierr);\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst char *\nssh_gai_strerror(int gaierr)\n{\n\tif (gaierr == EAI_SYSTEM && errno != 0)\n\t\treturn strerror(errno);\n\treturn gai_strerror(gaierr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "_PATH_DH_MODULI",
            "\"r\""
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nDH *\nchoose_dh(int min, int wantbits, int max)\n{\n\tFILE *f;\n\tchar *line = NULL;\n\tsize_t linesize = 0;\n\tint best, bestcount, which, linenum;\n\tstruct dhgroup dhg;\n\n\tif ((f = fopen(_PATH_DH_MODULI, \"r\")) == NULL) {\n\t\tlogit(\"WARNING: could not open %s (%s), using fixed modulus\",\n\t\t    _PATH_DH_MODULI, strerror(errno));\n\t\treturn (dh_new_group_fallback(max));\n\t}\n\n\tlinenum = 0;\n\tbest = bestcount = 0;\n\twhile (getline(&line, &linesize, f) != -1) {\n\t\tlinenum++;\n\t\tif (!parse_prime(linenum, line, &dhg))\n\t\t\tcontinue;\n\t\tBN_clear_free(dhg.g);\n\t\tBN_clear_free(dhg.p);\n\n\t\tif (dhg.size > max || dhg.size < min)\n\t\t\tcontinue;\n\n\t\tif ((dhg.size > wantbits && dhg.size < best) ||\n\t\t    (dhg.size > best && best < wantbits)) {\n\t\t\tbest = dhg.size;\n\t\t\tbestcount = 0;\n\t\t}\n\t\tif (dhg.size == best)\n\t\t\tbestcount++;\n\t}\n\tfree(line);\n\tline = NULL;\n\tlinesize = 0;\n\trewind(f);\n\n\tif (bestcount == 0) {\n\t\tfclose(f);\n\t\tlogit(\"WARNING: no suitable primes in %s\", _PATH_DH_MODULI);\n\t\treturn (dh_new_group_fallback(max));\n\t}\n\twhich = arc4random_uniform(bestcount);\n\n\tlinenum = 0;\n\tbestcount = 0;\n\twhile (getline(&line, &linesize, f) != -1) {\n\t\tlinenum++;\n\t\tif (!parse_prime(linenum, line, &dhg))\n\t\t\tcontinue;\n\t\tif ((dhg.size > max || dhg.size < min) ||\n\t\t    dhg.size != best ||\n\t\t    bestcount++ != which) {\n\t\t\tBN_clear_free(dhg.g);\n\t\t\tBN_clear_free(dhg.p);\n\t\t\tcontinue;\n\t\t}\n\t\tbreak;\n\t}\n\tfree(line);\n\tline = NULL;\n\tfclose(f);\n\tif (bestcount != which + 1) {\n\t\tlogit(\"WARNING: selected prime disappeared in %s, giving up\",\n\t\t    _PATH_DH_MODULI);\n\t\treturn (dh_new_group_fallback(max));\n\t}\n\n\treturn (dh_new_group(dhg.g, dhg.p));\n}"
  },
  {
    "function_name": "parse_prime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/dh.c",
    "lines": "48-144",
    "snippet": "static int\nparse_prime(int linenum, char *line, struct dhgroup *dhg)\n{\n\tchar *cp, *arg;\n\tchar *strsize, *gen, *prime;\n\tconst char *errstr = NULL;\n\tlong long n;\n\n\tdhg->p = dhg->g = NULL;\n\tcp = line;\n\tif ((arg = strdelim(&cp)) == NULL)\n\t\treturn 0;\n\t/* Ignore leading whitespace */\n\tif (*arg == '\\0')\n\t\targ = strdelim(&cp);\n\tif (!arg || !*arg || *arg == '#')\n\t\treturn 0;\n\n\t/* time */\n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\targ = strsep(&cp, \" \"); /* type */\n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\t/* Ensure this is a safe prime */\n\tn = strtonum(arg, 0, 5, &errstr);\n\tif (errstr != NULL || n != MODULI_TYPE_SAFE) {\n\t\terror(\"moduli:%d: type is not %d\", linenum, MODULI_TYPE_SAFE);\n\t\tgoto fail;\n\t}\n\targ = strsep(&cp, \" \"); /* tests */\n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\t/* Ensure prime has been tested and is not composite */\n\tn = strtonum(arg, 0, 0x1f, &errstr);\n\tif (errstr != NULL ||\n\t    (n & MODULI_TESTS_COMPOSITE) || !(n & ~MODULI_TESTS_COMPOSITE)) {\n\t\terror(\"moduli:%d: invalid moduli tests flag\", linenum);\n\t\tgoto fail;\n\t}\n\targ = strsep(&cp, \" \"); /* tries */\n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\tn = strtonum(arg, 0, 1<<30, &errstr);\n\tif (errstr != NULL || n == 0) {\n\t\terror(\"moduli:%d: invalid primality trial count\", linenum);\n\t\tgoto fail;\n\t}\n\tstrsize = strsep(&cp, \" \"); /* size */\n\tif (cp == NULL || *strsize == '\\0' ||\n\t    (dhg->size = (int)strtonum(strsize, 0, 64*1024, &errstr)) == 0 ||\n\t    errstr) {\n\t\terror(\"moduli:%d: invalid prime length\", linenum);\n\t\tgoto fail;\n\t}\n\t/* The whole group is one bit larger */\n\tdhg->size++;\n\tgen = strsep(&cp, \" \"); /* gen */\n\tif (cp == NULL || *gen == '\\0')\n\t\tgoto truncated;\n\tprime = strsep(&cp, \" \"); /* prime */\n\tif (cp != NULL || *prime == '\\0') {\n truncated:\n\t\terror(\"moduli:%d: truncated\", linenum);\n\t\tgoto fail;\n\t}\n\n\tif ((dhg->g = BN_new()) == NULL ||\n\t    (dhg->p = BN_new()) == NULL) {\n\t\terror(\"parse_prime: BN_new failed\");\n\t\tgoto fail;\n\t}\n\tif (BN_hex2bn(&dhg->g, gen) == 0) {\n\t\terror(\"moduli:%d: could not parse generator value\", linenum);\n\t\tgoto fail;\n\t}\n\tif (BN_hex2bn(&dhg->p, prime) == 0) {\n\t\terror(\"moduli:%d: could not parse prime value\", linenum);\n\t\tgoto fail;\n\t}\n\tif (BN_num_bits(dhg->p) != dhg->size) {\n\t\terror(\"moduli:%d: prime has wrong size: actual %d listed %d\",\n\t\t    linenum, BN_num_bits(dhg->p), dhg->size - 1);\n\t\tgoto fail;\n\t}\n\tif (BN_cmp(dhg->g, BN_value_one()) <= 0) {\n\t\terror(\"moduli:%d: generator is invalid\", linenum);\n\t\tgoto fail;\n\t}\n\treturn 1;\n\n fail:\n\tBN_clear_free(dhg->g);\n\tBN_clear_free(dhg->p);\n\tdhg->g = dhg->p = NULL;\n\treturn 0;\n}",
    "includes": [
      "#include \"openbsd-compat/openssl-compat.h\"",
      "#include \"ssherr.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"pathnames.h\"",
      "#include \"dh.h\"",
      "#include <limits.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <stdarg.h>",
      "#include <errno.h>",
      "#include <openssl/dh.h>",
      "#include <openssl/bn.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "dhg->p"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_clear_free",
          "args": [
            "dhg->g"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "\"moduli:%d: generator is invalid\"",
            "linenum"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "162-170",
          "snippet": "void\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nerror(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_ERROR, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BN_cmp",
          "args": [
            "dhg->g",
            "BN_value_one()"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_value_one",
          "args": [],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_num_bits",
          "args": [
            "dhg->p"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_num_bits",
          "args": [
            "dhg->p"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_hex2bn",
          "args": [
            "&dhg->p",
            "prime"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_hex2bn",
          "args": [
            "&dhg->g",
            "gen"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_new",
          "args": [],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strsep",
          "args": [
            "&cp",
            "\" \""
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "xstrsep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keyscan.c",
          "lines": "162-178",
          "snippet": "static char *\nxstrsep(char **str, const char *delim)\n{\n\tchar *s, *e;\n\n\tif (!**str)\n\t\treturn (NULL);\n\n\ts = *str;\n\te = s + strcspn(s, delim);\n\n\tif (*e != '\\0')\n\t\t*e++ = '\\0';\n\t*str = e;\n\n\treturn (s);\n}",
          "includes": [
            "#include \"dns.h\"",
            "#include \"ssh_api.h\"",
            "#include \"ssherr.h\"",
            "#include \"hostfile.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"dispatch.h\"",
            "#include \"packet.h\"",
            "#include \"myproposal.h\"",
            "#include \"compat.h\"",
            "#include \"kex.h\"",
            "#include \"cipher.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <errno.h>",
            "#include <netdb.h>",
            "#include <openssl/bn.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "# include <sys/time.h>",
            "#include <sys/resource.h>",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"dns.h\"\n#include \"ssh_api.h\"\n#include \"ssherr.h\"\n#include \"hostfile.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"dispatch.h\"\n#include \"packet.h\"\n#include \"myproposal.h\"\n#include \"compat.h\"\n#include \"kex.h\"\n#include \"cipher.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <string.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <netdb.h>\n#include <openssl/bn.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n# include <sys/time.h>\n#include <sys/resource.h>\n#include \"openbsd-compat/sys-queue.h\"\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic char *\nxstrsep(char **str, const char *delim)\n{\n\tchar *s, *e;\n\n\tif (!**str)\n\t\treturn (NULL);\n\n\ts = *str;\n\te = s + strcspn(s, delim);\n\n\tif (*e != '\\0')\n\t\t*e++ = '\\0';\n\t*str = e;\n\n\treturn (s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtonum",
          "args": [
            "strsize",
            "0",
            "64*1024",
            "&errstr"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "strtonum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strtonum.c",
          "lines": "33-70",
          "snippet": "long long\nstrtonum(const char *numstr, long long minval, long long maxval,\n    const char **errstrp)\n{\n\tlong long ll = 0;\n\tchar *ep;\n\tint error = 0;\n\tstruct errval {\n\t\tconst char *errstr;\n\t\tint err;\n\t} ev[4] = {\n\t\t{ NULL,\t\t0 },\n\t\t{ \"invalid\",\tEINVAL },\n\t\t{ \"too small\",\tERANGE },\n\t\t{ \"too large\",\tERANGE },\n\t};\n\n\tev[0].err = errno;\n\terrno = 0;\n\tif (minval > maxval)\n\t\terror = INVALID;\n\telse {\n\t\tll = strtoll(numstr, &ep, 10);\n\t\tif (numstr == ep || *ep != '\\0')\n\t\t\terror = INVALID;\n\t\telse if ((ll == LLONG_MIN && errno == ERANGE) || ll < minval)\n\t\t\terror = TOOSMALL;\n\t\telse if ((ll == LLONG_MAX && errno == ERANGE) || ll > maxval)\n\t\t\terror = TOOLARGE;\n\t}\n\tif (errstrp != NULL)\n\t\t*errstrp = ev[error].errstr;\n\terrno = ev[error].err;\n\tif (error)\n\t\tll = 0;\n\n\treturn (ll);\n}",
          "includes": [
            "#include <errno.h>",
            "#include <limits.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define TOOLARGE \t3",
            "#define TOOSMALL \t2",
            "#define INVALID \t1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <limits.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\n#define TOOLARGE \t3\n#define TOOSMALL \t2\n#define INVALID \t1\n\nlong long\nstrtonum(const char *numstr, long long minval, long long maxval,\n    const char **errstrp)\n{\n\tlong long ll = 0;\n\tchar *ep;\n\tint error = 0;\n\tstruct errval {\n\t\tconst char *errstr;\n\t\tint err;\n\t} ev[4] = {\n\t\t{ NULL,\t\t0 },\n\t\t{ \"invalid\",\tEINVAL },\n\t\t{ \"too small\",\tERANGE },\n\t\t{ \"too large\",\tERANGE },\n\t};\n\n\tev[0].err = errno;\n\terrno = 0;\n\tif (minval > maxval)\n\t\terror = INVALID;\n\telse {\n\t\tll = strtoll(numstr, &ep, 10);\n\t\tif (numstr == ep || *ep != '\\0')\n\t\t\terror = INVALID;\n\t\telse if ((ll == LLONG_MIN && errno == ERANGE) || ll < minval)\n\t\t\terror = TOOSMALL;\n\t\telse if ((ll == LLONG_MAX && errno == ERANGE) || ll > maxval)\n\t\t\terror = TOOLARGE;\n\t}\n\tif (errstrp != NULL)\n\t\t*errstrp = ev[error].errstr;\n\terrno = ev[error].err;\n\tif (error)\n\t\tll = 0;\n\n\treturn (ll);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strdelim",
          "args": [
            "&cp"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "strdelimw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "296-300",
          "snippet": "char *\nstrdelimw(char **s)\n{\n\treturn strdelim_internal(s, 0);\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *\nstrdelimw(char **s)\n{\n\treturn strdelim_internal(s, 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"openbsd-compat/openssl-compat.h\"\n#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"dh.h\"\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <errno.h>\n#include <openssl/dh.h>\n#include <openssl/bn.h>\n#include \"includes.h\"\n\nstatic int\nparse_prime(int linenum, char *line, struct dhgroup *dhg)\n{\n\tchar *cp, *arg;\n\tchar *strsize, *gen, *prime;\n\tconst char *errstr = NULL;\n\tlong long n;\n\n\tdhg->p = dhg->g = NULL;\n\tcp = line;\n\tif ((arg = strdelim(&cp)) == NULL)\n\t\treturn 0;\n\t/* Ignore leading whitespace */\n\tif (*arg == '\\0')\n\t\targ = strdelim(&cp);\n\tif (!arg || !*arg || *arg == '#')\n\t\treturn 0;\n\n\t/* time */\n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\targ = strsep(&cp, \" \"); /* type */\n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\t/* Ensure this is a safe prime */\n\tn = strtonum(arg, 0, 5, &errstr);\n\tif (errstr != NULL || n != MODULI_TYPE_SAFE) {\n\t\terror(\"moduli:%d: type is not %d\", linenum, MODULI_TYPE_SAFE);\n\t\tgoto fail;\n\t}\n\targ = strsep(&cp, \" \"); /* tests */\n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\t/* Ensure prime has been tested and is not composite */\n\tn = strtonum(arg, 0, 0x1f, &errstr);\n\tif (errstr != NULL ||\n\t    (n & MODULI_TESTS_COMPOSITE) || !(n & ~MODULI_TESTS_COMPOSITE)) {\n\t\terror(\"moduli:%d: invalid moduli tests flag\", linenum);\n\t\tgoto fail;\n\t}\n\targ = strsep(&cp, \" \"); /* tries */\n\tif (cp == NULL || *arg == '\\0')\n\t\tgoto truncated;\n\tn = strtonum(arg, 0, 1<<30, &errstr);\n\tif (errstr != NULL || n == 0) {\n\t\terror(\"moduli:%d: invalid primality trial count\", linenum);\n\t\tgoto fail;\n\t}\n\tstrsize = strsep(&cp, \" \"); /* size */\n\tif (cp == NULL || *strsize == '\\0' ||\n\t    (dhg->size = (int)strtonum(strsize, 0, 64*1024, &errstr)) == 0 ||\n\t    errstr) {\n\t\terror(\"moduli:%d: invalid prime length\", linenum);\n\t\tgoto fail;\n\t}\n\t/* The whole group is one bit larger */\n\tdhg->size++;\n\tgen = strsep(&cp, \" \"); /* gen */\n\tif (cp == NULL || *gen == '\\0')\n\t\tgoto truncated;\n\tprime = strsep(&cp, \" \"); /* prime */\n\tif (cp != NULL || *prime == '\\0') {\n truncated:\n\t\terror(\"moduli:%d: truncated\", linenum);\n\t\tgoto fail;\n\t}\n\n\tif ((dhg->g = BN_new()) == NULL ||\n\t    (dhg->p = BN_new()) == NULL) {\n\t\terror(\"parse_prime: BN_new failed\");\n\t\tgoto fail;\n\t}\n\tif (BN_hex2bn(&dhg->g, gen) == 0) {\n\t\terror(\"moduli:%d: could not parse generator value\", linenum);\n\t\tgoto fail;\n\t}\n\tif (BN_hex2bn(&dhg->p, prime) == 0) {\n\t\terror(\"moduli:%d: could not parse prime value\", linenum);\n\t\tgoto fail;\n\t}\n\tif (BN_num_bits(dhg->p) != dhg->size) {\n\t\terror(\"moduli:%d: prime has wrong size: actual %d listed %d\",\n\t\t    linenum, BN_num_bits(dhg->p), dhg->size - 1);\n\t\tgoto fail;\n\t}\n\tif (BN_cmp(dhg->g, BN_value_one()) <= 0) {\n\t\terror(\"moduli:%d: generator is invalid\", linenum);\n\t\tgoto fail;\n\t}\n\treturn 1;\n\n fail:\n\tBN_clear_free(dhg->g);\n\tBN_clear_free(dhg->p);\n\tdhg->g = dhg->p = NULL;\n\treturn 0;\n}"
  }
]