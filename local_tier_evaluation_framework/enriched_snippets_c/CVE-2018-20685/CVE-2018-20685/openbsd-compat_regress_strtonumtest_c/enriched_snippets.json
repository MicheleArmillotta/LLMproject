[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/regress/strtonumtest.c",
    "lines": "58-79",
    "snippet": "int main(int argc, char *argv[])\n{\n\ttest(\"1\", 0, 10, 1);\n\ttest(\"0\", -2, 5, 1);\n\ttest(\"0\", 2, 5, 0);\n\ttest(\"0\", 2, LLONG_MAX, 0);\n\ttest(\"-2\", 0, LLONG_MAX, 0);\n\ttest(\"0\", -5, LLONG_MAX, 1);\n\ttest(\"-3\", -3, LLONG_MAX, 1);\n\ttest(\"-9223372036854775808\", LLONG_MIN, LLONG_MAX, 1);\n\ttest(\"9223372036854775807\", LLONG_MIN, LLONG_MAX, 1);\n\ttest(\"-9223372036854775809\", LLONG_MIN, LLONG_MAX, 0);\n\ttest(\"9223372036854775808\", LLONG_MIN, LLONG_MAX, 0);\n\ttest(\"1000000000000000000000000\", LLONG_MIN, LLONG_MAX, 0);\n\ttest(\"-1000000000000000000000000\", LLONG_MIN, LLONG_MAX, 0);\n\ttest(\"-2\", 10, -1, 0);\n\ttest(\"-2\", -10, -1, 1);\n\ttest(\"-20\", -10, -1, 0);\n\ttest(\"20\", -10, -1, 0);\n\n\treturn (fail);\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <limits.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int fail;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "test",
          "args": [
            "\"20\"",
            "-10",
            "-1",
            "0"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "test",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/regress/strtonumtest.c",
          "lines": "40-56",
          "snippet": "void\ntest(const char *p, long long lb, long long ub, int ok)\n{\n\tlong long val;\n\tconst char *q;\n\n\tval = strtonum(p, lb, ub, &q);\n\tif (ok && q != NULL) {\n\t\tfprintf(stderr, \"%s [%lld-%lld] \", p, lb, ub);\n\t\tfprintf(stderr, \"NUMBER NOT ACCEPTED %s\\n\", q);\n\t\tfail = 1;\n\t} else if (!ok && q == NULL) {\n\t\tfprintf(stderr, \"%s [%lld-%lld] %lld \", p, lb, ub, val);\n\t\tfprintf(stderr, \"NUMBER ACCEPTED\\n\");\n\t\tfail = 1;\n\t}\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <limits.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long long strtonum(const char *, long long, long long, const char **);",
            "int fail;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <stdio.h>\n#include <limits.h>\n\nlong long strtonum(const char *, long long, long long, const char **);\nint fail;\n\nvoid\ntest(const char *p, long long lb, long long ub, int ok)\n{\n\tlong long val;\n\tconst char *q;\n\n\tval = strtonum(p, lb, ub, &q);\n\tif (ok && q != NULL) {\n\t\tfprintf(stderr, \"%s [%lld-%lld] \", p, lb, ub);\n\t\tfprintf(stderr, \"NUMBER NOT ACCEPTED %s\\n\", q);\n\t\tfail = 1;\n\t} else if (!ok && q == NULL) {\n\t\tfprintf(stderr, \"%s [%lld-%lld] %lld \", p, lb, ub, val);\n\t\tfprintf(stderr, \"NUMBER ACCEPTED\\n\");\n\t\tfail = 1;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <stdio.h>\n#include <limits.h>\n\nint fail;\n\nint main(int argc, char *argv[])\n{\n\ttest(\"1\", 0, 10, 1);\n\ttest(\"0\", -2, 5, 1);\n\ttest(\"0\", 2, 5, 0);\n\ttest(\"0\", 2, LLONG_MAX, 0);\n\ttest(\"-2\", 0, LLONG_MAX, 0);\n\ttest(\"0\", -5, LLONG_MAX, 1);\n\ttest(\"-3\", -3, LLONG_MAX, 1);\n\ttest(\"-9223372036854775808\", LLONG_MIN, LLONG_MAX, 1);\n\ttest(\"9223372036854775807\", LLONG_MIN, LLONG_MAX, 1);\n\ttest(\"-9223372036854775809\", LLONG_MIN, LLONG_MAX, 0);\n\ttest(\"9223372036854775808\", LLONG_MIN, LLONG_MAX, 0);\n\ttest(\"1000000000000000000000000\", LLONG_MIN, LLONG_MAX, 0);\n\ttest(\"-1000000000000000000000000\", LLONG_MIN, LLONG_MAX, 0);\n\ttest(\"-2\", 10, -1, 0);\n\ttest(\"-2\", -10, -1, 1);\n\ttest(\"-20\", -10, -1, 0);\n\ttest(\"20\", -10, -1, 0);\n\n\treturn (fail);\n}"
  },
  {
    "function_name": "test",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/regress/strtonumtest.c",
    "lines": "40-56",
    "snippet": "void\ntest(const char *p, long long lb, long long ub, int ok)\n{\n\tlong long val;\n\tconst char *q;\n\n\tval = strtonum(p, lb, ub, &q);\n\tif (ok && q != NULL) {\n\t\tfprintf(stderr, \"%s [%lld-%lld] \", p, lb, ub);\n\t\tfprintf(stderr, \"NUMBER NOT ACCEPTED %s\\n\", q);\n\t\tfail = 1;\n\t} else if (!ok && q == NULL) {\n\t\tfprintf(stderr, \"%s [%lld-%lld] %lld \", p, lb, ub, val);\n\t\tfprintf(stderr, \"NUMBER ACCEPTED\\n\");\n\t\tfail = 1;\n\t}\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <limits.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "long long strtonum(const char *, long long, long long, const char **);",
      "int fail;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"NUMBER ACCEPTED\\n\""
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%s [%lld-%lld] %lld \"",
            "p",
            "lb",
            "ub",
            "val"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"NUMBER NOT ACCEPTED %s\\n\"",
            "q"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"%s [%lld-%lld] \"",
            "p",
            "lb",
            "ub"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtonum",
          "args": [
            "p",
            "lb",
            "ub",
            "&q"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "strtonum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strtonum.c",
          "lines": "33-70",
          "snippet": "long long\nstrtonum(const char *numstr, long long minval, long long maxval,\n    const char **errstrp)\n{\n\tlong long ll = 0;\n\tchar *ep;\n\tint error = 0;\n\tstruct errval {\n\t\tconst char *errstr;\n\t\tint err;\n\t} ev[4] = {\n\t\t{ NULL,\t\t0 },\n\t\t{ \"invalid\",\tEINVAL },\n\t\t{ \"too small\",\tERANGE },\n\t\t{ \"too large\",\tERANGE },\n\t};\n\n\tev[0].err = errno;\n\terrno = 0;\n\tif (minval > maxval)\n\t\terror = INVALID;\n\telse {\n\t\tll = strtoll(numstr, &ep, 10);\n\t\tif (numstr == ep || *ep != '\\0')\n\t\t\terror = INVALID;\n\t\telse if ((ll == LLONG_MIN && errno == ERANGE) || ll < minval)\n\t\t\terror = TOOSMALL;\n\t\telse if ((ll == LLONG_MAX && errno == ERANGE) || ll > maxval)\n\t\t\terror = TOOLARGE;\n\t}\n\tif (errstrp != NULL)\n\t\t*errstrp = ev[error].errstr;\n\terrno = ev[error].err;\n\tif (error)\n\t\tll = 0;\n\n\treturn (ll);\n}",
          "includes": [
            "#include <errno.h>",
            "#include <limits.h>",
            "#include <stdlib.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define TOOLARGE \t3",
            "#define TOOSMALL \t2",
            "#define INVALID \t1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <limits.h>\n#include <stdlib.h>\n#include \"includes.h\"\n\n#define TOOLARGE \t3\n#define TOOSMALL \t2\n#define INVALID \t1\n\nlong long\nstrtonum(const char *numstr, long long minval, long long maxval,\n    const char **errstrp)\n{\n\tlong long ll = 0;\n\tchar *ep;\n\tint error = 0;\n\tstruct errval {\n\t\tconst char *errstr;\n\t\tint err;\n\t} ev[4] = {\n\t\t{ NULL,\t\t0 },\n\t\t{ \"invalid\",\tEINVAL },\n\t\t{ \"too small\",\tERANGE },\n\t\t{ \"too large\",\tERANGE },\n\t};\n\n\tev[0].err = errno;\n\terrno = 0;\n\tif (minval > maxval)\n\t\terror = INVALID;\n\telse {\n\t\tll = strtoll(numstr, &ep, 10);\n\t\tif (numstr == ep || *ep != '\\0')\n\t\t\terror = INVALID;\n\t\telse if ((ll == LLONG_MIN && errno == ERANGE) || ll < minval)\n\t\t\terror = TOOSMALL;\n\t\telse if ((ll == LLONG_MAX && errno == ERANGE) || ll > maxval)\n\t\t\terror = TOOLARGE;\n\t}\n\tif (errstrp != NULL)\n\t\t*errstrp = ev[error].errstr;\n\terrno = ev[error].err;\n\tif (error)\n\t\tll = 0;\n\n\treturn (ll);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <stdio.h>\n#include <limits.h>\n\nlong long strtonum(const char *, long long, long long, const char **);\nint fail;\n\nvoid\ntest(const char *p, long long lb, long long ub, int ok)\n{\n\tlong long val;\n\tconst char *q;\n\n\tval = strtonum(p, lb, ub, &q);\n\tif (ok && q != NULL) {\n\t\tfprintf(stderr, \"%s [%lld-%lld] \", p, lb, ub);\n\t\tfprintf(stderr, \"NUMBER NOT ACCEPTED %s\\n\", q);\n\t\tfail = 1;\n\t} else if (!ok && q == NULL) {\n\t\tfprintf(stderr, \"%s [%lld-%lld] %lld \", p, lb, ub, val);\n\t\tfprintf(stderr, \"NUMBER ACCEPTED\\n\");\n\t\tfail = 1;\n\t}\n}"
  }
]