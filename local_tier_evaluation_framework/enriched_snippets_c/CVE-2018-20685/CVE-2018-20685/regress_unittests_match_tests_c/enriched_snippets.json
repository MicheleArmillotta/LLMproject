[
  {
    "function_name": "tests",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/match/tests.c",
    "lines": "23-132",
    "snippet": "void\ntests(void)\n{\n\tTEST_START(\"match_pattern\");\n\tASSERT_INT_EQ(match_pattern(\"\", \"\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"\", \"aaa\"), 0);\n\tASSERT_INT_EQ(match_pattern(\"aaa\", \"\"), 0);\n\tASSERT_INT_EQ(match_pattern(\"aaa\", \"aaaa\"), 0);\n\tASSERT_INT_EQ(match_pattern(\"aaaa\", \"aaa\"), 0);\n\tTEST_DONE();\n\n\tTEST_START(\"match_pattern wildcard\");\n\tASSERT_INT_EQ(match_pattern(\"\", \"*\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"a\", \"?\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"aa\", \"a?\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"a\", \"*\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"aa\", \"a*\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"aa\", \"?*\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"aa\", \"**\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"aa\", \"?a\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"aa\", \"*a\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"ba\", \"a?\"), 0);\n\tASSERT_INT_EQ(match_pattern(\"ba\", \"a*\"), 0);\n\tASSERT_INT_EQ(match_pattern(\"ab\", \"?a\"), 0);\n\tASSERT_INT_EQ(match_pattern(\"ab\", \"*a\"), 0);\n\tTEST_DONE();\n\n\tTEST_START(\"match_pattern_list\");\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"\", 0), 0); /* no patterns */\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"*\", 0), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"!*\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"!a,*\", 0), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"*,!a\", 0), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"a,!*\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"!*,a\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"\", 0), 0);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"*\", 0), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"!*\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"!a\", 0), -1);\n\t/* XXX negated ASSERT_INT_EQ(match_pattern_list(\"a\", \"!b\", 0), 1); */\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"!a,*\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"b\", \"!a,*\", 0), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"*,!a\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"b\", \"*,!a\", 0), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"a,!*\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"b\", \"a,!*\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"a,!a\", 0), -1);\n\t/* XXX negated ASSERT_INT_EQ(match_pattern_list(\"b\", \"a,!a\", 0), 1); */\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"!*,a\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"b\", \"!*,a\", 0), -1);\n\tTEST_DONE();\n\n\tTEST_START(\"match_pattern_list lowercase\");\n\tASSERT_INT_EQ(match_pattern_list(\"abc\", \"ABC\", 0), 0);\n\tASSERT_INT_EQ(match_pattern_list(\"ABC\", \"abc\", 0), 0);\n\tASSERT_INT_EQ(match_pattern_list(\"abc\", \"ABC\", 1), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"ABC\", \"abc\", 1), 0);\n\tTEST_DONE();\n\n\tTEST_START(\"addr_match_list\");\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"127.0.0.1/44\"), -2);\n\tASSERT_INT_EQ(addr_match_list(NULL, \"127.0.0.1/44\"), -2);\n\tASSERT_INT_EQ(addr_match_list(\"a\", \"*\"), 0);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"*\"), 1);\n\tASSERT_INT_EQ(addr_match_list(NULL, \"*\"), 0);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"127.0.0.1\"), 1);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"127.0.0.2\"), 0);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"!127.0.0.1\"), -1);\n\t/* XXX negated ASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"!127.0.0.2\"), 1); */\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.255\", \"127.0.0.0/24\"), 1);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.1.1\", \"127.0.0.0/24\"), 0);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"127.0.0.0/24\"), 1);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"127.0.1.0/24\"), 0);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"!127.0.0.0/24\"), -1);\n\t/* XXX negated ASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"!127.0.1.0/24\"), 1); */\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"10.0.0.1,!127.0.0.1\"), -1);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"!127.0.0.1,10.0.0.1\"), -1);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"10.0.0.1,127.0.0.2\"), 0);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"127.0.0.2,10.0.0.1\"), 0);\n\t/* XXX negated ASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"10.0.0.1,!127.0.0.2\"), 1); */\n\t/* XXX negated ASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"!127.0.0.2,10.0.0.1\"), 1); */\n\tTEST_DONE();\n\n#define CHECK_FILTER(string,filter,expected) \\\n\tdo { \\\n\t\tchar *result = match_filter_blacklist((string), (filter)); \\\n\t\tASSERT_STRING_EQ(result, expected); \\\n\t\tfree(result); \\\n\t} while (0)\n\n\tTEST_START(\"match_filter_list\");\n\tCHECK_FILTER(\"a,b,c\", \"\", \"a,b,c\");\n\tCHECK_FILTER(\"a,b,c\", \"a\", \"b,c\");\n\tCHECK_FILTER(\"a,b,c\", \"b\", \"a,c\");\n\tCHECK_FILTER(\"a,b,c\", \"c\", \"a,b\");\n\tCHECK_FILTER(\"a,b,c\", \"a,b\", \"c\");\n\tCHECK_FILTER(\"a,b,c\", \"a,c\", \"b\");\n\tCHECK_FILTER(\"a,b,c\", \"b,c\", \"a\");\n\tCHECK_FILTER(\"a,b,c\", \"a,b,c\", \"\");\n\tCHECK_FILTER(\"a,b,c\", \"b,c\", \"a\");\n\tCHECK_FILTER(\"\", \"a,b,c\", \"\");\n\tTEST_DONE();\n/*\n * XXX TODO\n * int      match_host_and_ip(const char *, const char *, const char *);\n * int      match_user(const char *, const char *, const char *, const char *);\n * char    *match_list(const char *, const char *, u_int *);\n * int      addr_match_cidr_list(const char *, const char *);\n */\n}",
    "includes": [
      "#include \"match.h\"",
      "#include \"../test_helper/test_helper.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FILTER",
          "args": [
            "\"\"",
            "\"a,b,c\"",
            "\"\""
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FILTER",
          "args": [
            "\"a,b,c\"",
            "\"b,c\"",
            "\"a\""
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FILTER",
          "args": [
            "\"a,b,c\"",
            "\"a,b,c\"",
            "\"\""
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FILTER",
          "args": [
            "\"a,b,c\"",
            "\"b,c\"",
            "\"a\""
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FILTER",
          "args": [
            "\"a,b,c\"",
            "\"a,c\"",
            "\"b\""
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FILTER",
          "args": [
            "\"a,b,c\"",
            "\"a,b\"",
            "\"c\""
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FILTER",
          "args": [
            "\"a,b,c\"",
            "\"c\"",
            "\"a,b\""
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FILTER",
          "args": [
            "\"a,b,c\"",
            "\"b\"",
            "\"a,c\""
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FILTER",
          "args": [
            "\"a,b,c\"",
            "\"a\"",
            "\"b,c\""
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_FILTER",
          "args": [
            "\"a,b,c\"",
            "\"\"",
            "\"a,b,c\""
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"match_filter_list\""
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "addr_match_list(\"127.0.0.1\", \"127.0.0.2,10.0.0.1\")",
            "0"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addr_match_list",
          "args": [
            "\"127.0.0.1\"",
            "\"127.0.0.2,10.0.0.1\""
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "addr_match_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/addrmatch.c",
          "lines": "375-424",
          "snippet": "int\naddr_match_list(const char *addr, const char *_list)\n{\n\tchar *list, *cp, *o;\n\tstruct xaddr try_addr, match_addr;\n\tu_int masklen, neg;\n\tint ret = 0, r;\n\n\tif (addr != NULL && addr_pton(addr, &try_addr) != 0) {\n\t\tdebug2(\"%s: couldn't parse address %.100s\", __func__, addr);\n\t\treturn 0;\n\t}\n\tif ((o = list = strdup(_list)) == NULL)\n\t\treturn -1;\n\twhile ((cp = strsep(&list, \",\")) != NULL) {\n\t\tneg = *cp == '!';\n\t\tif (neg)\n\t\t\tcp++;\n\t\tif (*cp == '\\0') {\n\t\t\tret = -2;\n\t\t\tbreak;\n\t\t}\n\t\t/* Prefer CIDR address matching */\n\t\tr = addr_pton_cidr(cp, &match_addr, &masklen);\n\t\tif (r == -2) {\n\t\t\tdebug2(\"%s: inconsistent mask length for \"\n\t\t\t    \"match network \\\"%.100s\\\"\", __func__, cp);\n\t\t\tret = -2;\n\t\t\tbreak;\n\t\t} else if (r == 0) {\n\t\t\tif (addr != NULL && addr_netmatch(&try_addr,\n                           &match_addr, masklen) == 0) {\n foundit:\n\t\t\t\tif (neg) {\n\t\t\t\t\tret = -1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tret = 1;\n\t\t\t}\n\t\t\tcontinue;\n\t\t} else {\n\t\t\t/* If CIDR parse failed, try wildcard string match */\n\t\t\tif (addr != NULL && match_pattern(addr, cp) == 1)\n\t\t\t\tgoto foundit;\n\t\t}\n\t}\n\tfree(o);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"match.h\"",
            "#include <stdarg.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"match.h\"\n#include <stdarg.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\naddr_match_list(const char *addr, const char *_list)\n{\n\tchar *list, *cp, *o;\n\tstruct xaddr try_addr, match_addr;\n\tu_int masklen, neg;\n\tint ret = 0, r;\n\n\tif (addr != NULL && addr_pton(addr, &try_addr) != 0) {\n\t\tdebug2(\"%s: couldn't parse address %.100s\", __func__, addr);\n\t\treturn 0;\n\t}\n\tif ((o = list = strdup(_list)) == NULL)\n\t\treturn -1;\n\twhile ((cp = strsep(&list, \",\")) != NULL) {\n\t\tneg = *cp == '!';\n\t\tif (neg)\n\t\t\tcp++;\n\t\tif (*cp == '\\0') {\n\t\t\tret = -2;\n\t\t\tbreak;\n\t\t}\n\t\t/* Prefer CIDR address matching */\n\t\tr = addr_pton_cidr(cp, &match_addr, &masklen);\n\t\tif (r == -2) {\n\t\t\tdebug2(\"%s: inconsistent mask length for \"\n\t\t\t    \"match network \\\"%.100s\\\"\", __func__, cp);\n\t\t\tret = -2;\n\t\t\tbreak;\n\t\t} else if (r == 0) {\n\t\t\tif (addr != NULL && addr_netmatch(&try_addr,\n                           &match_addr, masklen) == 0) {\n foundit:\n\t\t\t\tif (neg) {\n\t\t\t\t\tret = -1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tret = 1;\n\t\t\t}\n\t\t\tcontinue;\n\t\t} else {\n\t\t\t/* If CIDR parse failed, try wildcard string match */\n\t\t\tif (addr != NULL && match_pattern(addr, cp) == 1)\n\t\t\t\tgoto foundit;\n\t\t}\n\t}\n\tfree(o);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "addr_match_list(\"127.0.0.1\", \"10.0.0.1,127.0.0.2\")",
            "0"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "addr_match_list(\"127.0.0.1\", \"!127.0.0.1,10.0.0.1\")",
            "-1"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "addr_match_list(\"127.0.0.1\", \"10.0.0.1,!127.0.0.1\")",
            "-1"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "addr_match_list(\"127.0.0.1\", \"!127.0.0.0/24\")",
            "-1"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "addr_match_list(\"127.0.0.1\", \"127.0.1.0/24\")",
            "0"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "addr_match_list(\"127.0.0.1\", \"127.0.0.0/24\")",
            "1"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "addr_match_list(\"127.0.1.1\", \"127.0.0.0/24\")",
            "0"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "addr_match_list(\"127.0.0.255\", \"127.0.0.0/24\")",
            "1"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "addr_match_list(\"127.0.0.1\", \"!127.0.0.1\")",
            "-1"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "addr_match_list(\"127.0.0.1\", \"127.0.0.2\")",
            "0"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "addr_match_list(\"127.0.0.1\", \"127.0.0.1\")",
            "1"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "addr_match_list(NULL, \"*\")",
            "0"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "addr_match_list(\"127.0.0.1\", \"*\")",
            "1"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "addr_match_list(\"a\", \"*\")",
            "0"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "addr_match_list(NULL, \"127.0.0.1/44\")",
            "-2"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "addr_match_list(\"127.0.0.1\", \"127.0.0.1/44\")",
            "-2"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"addr_match_list\""
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"ABC\", \"abc\", 1)",
            "0"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_pattern_list",
          "args": [
            "\"ABC\"",
            "\"abc\"",
            "1"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "match_pattern_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/match.c",
          "lines": "120-171",
          "snippet": "int\nmatch_pattern_list(const char *string, const char *pattern, int dolower)\n{\n\tchar sub[1024];\n\tint negated;\n\tint got_positive;\n\tu_int i, subi, len = strlen(pattern);\n\n\tgot_positive = 0;\n\tfor (i = 0; i < len;) {\n\t\t/* Check if the subpattern is negated. */\n\t\tif (pattern[i] == '!') {\n\t\t\tnegated = 1;\n\t\t\ti++;\n\t\t} else\n\t\t\tnegated = 0;\n\n\t\t/*\n\t\t * Extract the subpattern up to a comma or end.  Convert the\n\t\t * subpattern to lowercase.\n\t\t */\n\t\tfor (subi = 0;\n\t\t    i < len && subi < sizeof(sub) - 1 && pattern[i] != ',';\n\t\t    subi++, i++)\n\t\t\tsub[subi] = dolower && isupper((u_char)pattern[i]) ?\n\t\t\t    tolower((u_char)pattern[i]) : pattern[i];\n\t\t/* If subpattern too long, return failure (no match). */\n\t\tif (subi >= sizeof(sub) - 1)\n\t\t\treturn 0;\n\n\t\t/* If the subpattern was terminated by a comma, then skip it. */\n\t\tif (i < len && pattern[i] == ',')\n\t\t\ti++;\n\n\t\t/* Null-terminate the subpattern. */\n\t\tsub[subi] = '\\0';\n\n\t\t/* Try to match the subpattern against the string. */\n\t\tif (match_pattern(string, sub)) {\n\t\t\tif (negated)\n\t\t\t\treturn -1;\t\t/* Negative */\n\t\t\telse\n\t\t\t\tgot_positive = 1;\t/* Positive */\n\t\t}\n\t}\n\n\t/*\n\t * Return success if got a positive match.  If there was a negative\n\t * match, we have already returned -1 and never get here.\n\t */\n\treturn got_positive;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"match.h\"",
            "#include \"xmalloc.h\"",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <ctype.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"match.h\"\n#include \"xmalloc.h\"\n#include <stdio.h>\n#include <string.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nmatch_pattern_list(const char *string, const char *pattern, int dolower)\n{\n\tchar sub[1024];\n\tint negated;\n\tint got_positive;\n\tu_int i, subi, len = strlen(pattern);\n\n\tgot_positive = 0;\n\tfor (i = 0; i < len;) {\n\t\t/* Check if the subpattern is negated. */\n\t\tif (pattern[i] == '!') {\n\t\t\tnegated = 1;\n\t\t\ti++;\n\t\t} else\n\t\t\tnegated = 0;\n\n\t\t/*\n\t\t * Extract the subpattern up to a comma or end.  Convert the\n\t\t * subpattern to lowercase.\n\t\t */\n\t\tfor (subi = 0;\n\t\t    i < len && subi < sizeof(sub) - 1 && pattern[i] != ',';\n\t\t    subi++, i++)\n\t\t\tsub[subi] = dolower && isupper((u_char)pattern[i]) ?\n\t\t\t    tolower((u_char)pattern[i]) : pattern[i];\n\t\t/* If subpattern too long, return failure (no match). */\n\t\tif (subi >= sizeof(sub) - 1)\n\t\t\treturn 0;\n\n\t\t/* If the subpattern was terminated by a comma, then skip it. */\n\t\tif (i < len && pattern[i] == ',')\n\t\t\ti++;\n\n\t\t/* Null-terminate the subpattern. */\n\t\tsub[subi] = '\\0';\n\n\t\t/* Try to match the subpattern against the string. */\n\t\tif (match_pattern(string, sub)) {\n\t\t\tif (negated)\n\t\t\t\treturn -1;\t\t/* Negative */\n\t\t\telse\n\t\t\t\tgot_positive = 1;\t/* Positive */\n\t\t}\n\t}\n\n\t/*\n\t * Return success if got a positive match.  If there was a negative\n\t * match, we have already returned -1 and never get here.\n\t */\n\treturn got_positive;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"abc\", \"ABC\", 1)",
            "1"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"ABC\", \"abc\", 0)",
            "0"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"abc\", \"ABC\", 0)",
            "0"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"match_pattern_list lowercase\""
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"b\", \"!*,a\", 0)",
            "-1"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"a\", \"!*,a\", 0)",
            "-1"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"a\", \"a,!a\", 0)",
            "-1"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"b\", \"a,!*\", 0)",
            "-1"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"a\", \"a,!*\", 0)",
            "-1"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"b\", \"*,!a\", 0)",
            "1"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"a\", \"*,!a\", 0)",
            "-1"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"b\", \"!a,*\", 0)",
            "1"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"a\", \"!a,*\", 0)",
            "-1"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"a\", \"!a\", 0)",
            "-1"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"a\", \"!*\", 0)",
            "-1"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"a\", \"*\", 0)",
            "1"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"a\", \"\", 0)",
            "0"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"\", \"!*,a\", 0)",
            "-1"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"\", \"a,!*\", 0)",
            "-1"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"\", \"*,!a\", 0)",
            "1"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"\", \"!a,*\", 0)",
            "1"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"\", \"!*\", 0)",
            "-1"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"\", \"*\", 0)",
            "1"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern_list(\"\", \"\", 0)",
            "0"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"match_pattern_list\""
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern(\"ab\", \"*a\")",
            "0"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "match_pattern",
          "args": [
            "\"ab\"",
            "\"*a\""
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "match_pattern",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/match.c",
          "lines": "56-112",
          "snippet": "int\nmatch_pattern(const char *s, const char *pattern)\n{\n\tfor (;;) {\n\t\t/* If at end of pattern, accept if also at end of string. */\n\t\tif (!*pattern)\n\t\t\treturn !*s;\n\n\t\tif (*pattern == '*') {\n\t\t\t/* Skip the asterisk. */\n\t\t\tpattern++;\n\n\t\t\t/* If at end of pattern, accept immediately. */\n\t\t\tif (!*pattern)\n\t\t\t\treturn 1;\n\n\t\t\t/* If next character in pattern is known, optimize. */\n\t\t\tif (*pattern != '?' && *pattern != '*') {\n\t\t\t\t/*\n\t\t\t\t * Look instances of the next character in\n\t\t\t\t * pattern, and try to match starting from\n\t\t\t\t * those.\n\t\t\t\t */\n\t\t\t\tfor (; *s; s++)\n\t\t\t\t\tif (*s == *pattern &&\n\t\t\t\t\t    match_pattern(s + 1, pattern + 1))\n\t\t\t\t\t\treturn 1;\n\t\t\t\t/* Failed. */\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\t/*\n\t\t\t * Move ahead one character at a time and try to\n\t\t\t * match at each position.\n\t\t\t */\n\t\t\tfor (; *s; s++)\n\t\t\t\tif (match_pattern(s, pattern))\n\t\t\t\t\treturn 1;\n\t\t\t/* Failed. */\n\t\t\treturn 0;\n\t\t}\n\t\t/*\n\t\t * There must be at least one more character in the string.\n\t\t * If we are at the end, fail.\n\t\t */\n\t\tif (!*s)\n\t\t\treturn 0;\n\n\t\t/* Check if the next character of the string is acceptable. */\n\t\tif (*pattern != '?' && *pattern != *s)\n\t\t\treturn 0;\n\n\t\t/* Move to the next character, both in string and in pattern. */\n\t\ts++;\n\t\tpattern++;\n\t}\n\t/* NOTREACHED */\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"match.h\"",
            "#include \"xmalloc.h\"",
            "#include <stdio.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <ctype.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"match.h\"\n#include \"xmalloc.h\"\n#include <stdio.h>\n#include <string.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nmatch_pattern(const char *s, const char *pattern)\n{\n\tfor (;;) {\n\t\t/* If at end of pattern, accept if also at end of string. */\n\t\tif (!*pattern)\n\t\t\treturn !*s;\n\n\t\tif (*pattern == '*') {\n\t\t\t/* Skip the asterisk. */\n\t\t\tpattern++;\n\n\t\t\t/* If at end of pattern, accept immediately. */\n\t\t\tif (!*pattern)\n\t\t\t\treturn 1;\n\n\t\t\t/* If next character in pattern is known, optimize. */\n\t\t\tif (*pattern != '?' && *pattern != '*') {\n\t\t\t\t/*\n\t\t\t\t * Look instances of the next character in\n\t\t\t\t * pattern, and try to match starting from\n\t\t\t\t * those.\n\t\t\t\t */\n\t\t\t\tfor (; *s; s++)\n\t\t\t\t\tif (*s == *pattern &&\n\t\t\t\t\t    match_pattern(s + 1, pattern + 1))\n\t\t\t\t\t\treturn 1;\n\t\t\t\t/* Failed. */\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\t/*\n\t\t\t * Move ahead one character at a time and try to\n\t\t\t * match at each position.\n\t\t\t */\n\t\t\tfor (; *s; s++)\n\t\t\t\tif (match_pattern(s, pattern))\n\t\t\t\t\treturn 1;\n\t\t\t/* Failed. */\n\t\t\treturn 0;\n\t\t}\n\t\t/*\n\t\t * There must be at least one more character in the string.\n\t\t * If we are at the end, fail.\n\t\t */\n\t\tif (!*s)\n\t\t\treturn 0;\n\n\t\t/* Check if the next character of the string is acceptable. */\n\t\tif (*pattern != '?' && *pattern != *s)\n\t\t\treturn 0;\n\n\t\t/* Move to the next character, both in string and in pattern. */\n\t\ts++;\n\t\tpattern++;\n\t}\n\t/* NOTREACHED */\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern(\"ab\", \"?a\")",
            "0"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern(\"ba\", \"a*\")",
            "0"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern(\"ba\", \"a?\")",
            "0"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern(\"aa\", \"*a\")",
            "1"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern(\"aa\", \"?a\")",
            "1"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern(\"aa\", \"**\")",
            "1"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern(\"aa\", \"?*\")",
            "1"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern(\"aa\", \"a*\")",
            "1"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern(\"a\", \"*\")",
            "1"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern(\"aa\", \"a?\")",
            "1"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern(\"a\", \"?\")",
            "1"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern(\"\", \"*\")",
            "1"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"match_pattern wildcard\""
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_DONE",
          "args": [],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern(\"aaaa\", \"aaa\")",
            "0"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern(\"aaa\", \"aaaa\")",
            "0"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern(\"aaa\", \"\")",
            "0"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern(\"\", \"aaa\")",
            "0"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "match_pattern(\"\", \"\")",
            "1"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TEST_START",
          "args": [
            "\"match_pattern\""
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"match.h\"\n#include \"../test_helper/test_helper.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ntests(void)\n{\n\tTEST_START(\"match_pattern\");\n\tASSERT_INT_EQ(match_pattern(\"\", \"\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"\", \"aaa\"), 0);\n\tASSERT_INT_EQ(match_pattern(\"aaa\", \"\"), 0);\n\tASSERT_INT_EQ(match_pattern(\"aaa\", \"aaaa\"), 0);\n\tASSERT_INT_EQ(match_pattern(\"aaaa\", \"aaa\"), 0);\n\tTEST_DONE();\n\n\tTEST_START(\"match_pattern wildcard\");\n\tASSERT_INT_EQ(match_pattern(\"\", \"*\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"a\", \"?\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"aa\", \"a?\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"a\", \"*\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"aa\", \"a*\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"aa\", \"?*\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"aa\", \"**\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"aa\", \"?a\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"aa\", \"*a\"), 1);\n\tASSERT_INT_EQ(match_pattern(\"ba\", \"a?\"), 0);\n\tASSERT_INT_EQ(match_pattern(\"ba\", \"a*\"), 0);\n\tASSERT_INT_EQ(match_pattern(\"ab\", \"?a\"), 0);\n\tASSERT_INT_EQ(match_pattern(\"ab\", \"*a\"), 0);\n\tTEST_DONE();\n\n\tTEST_START(\"match_pattern_list\");\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"\", 0), 0); /* no patterns */\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"*\", 0), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"!*\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"!a,*\", 0), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"*,!a\", 0), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"a,!*\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"\", \"!*,a\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"\", 0), 0);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"*\", 0), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"!*\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"!a\", 0), -1);\n\t/* XXX negated ASSERT_INT_EQ(match_pattern_list(\"a\", \"!b\", 0), 1); */\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"!a,*\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"b\", \"!a,*\", 0), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"*,!a\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"b\", \"*,!a\", 0), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"a,!*\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"b\", \"a,!*\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"a,!a\", 0), -1);\n\t/* XXX negated ASSERT_INT_EQ(match_pattern_list(\"b\", \"a,!a\", 0), 1); */\n\tASSERT_INT_EQ(match_pattern_list(\"a\", \"!*,a\", 0), -1);\n\tASSERT_INT_EQ(match_pattern_list(\"b\", \"!*,a\", 0), -1);\n\tTEST_DONE();\n\n\tTEST_START(\"match_pattern_list lowercase\");\n\tASSERT_INT_EQ(match_pattern_list(\"abc\", \"ABC\", 0), 0);\n\tASSERT_INT_EQ(match_pattern_list(\"ABC\", \"abc\", 0), 0);\n\tASSERT_INT_EQ(match_pattern_list(\"abc\", \"ABC\", 1), 1);\n\tASSERT_INT_EQ(match_pattern_list(\"ABC\", \"abc\", 1), 0);\n\tTEST_DONE();\n\n\tTEST_START(\"addr_match_list\");\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"127.0.0.1/44\"), -2);\n\tASSERT_INT_EQ(addr_match_list(NULL, \"127.0.0.1/44\"), -2);\n\tASSERT_INT_EQ(addr_match_list(\"a\", \"*\"), 0);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"*\"), 1);\n\tASSERT_INT_EQ(addr_match_list(NULL, \"*\"), 0);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"127.0.0.1\"), 1);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"127.0.0.2\"), 0);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"!127.0.0.1\"), -1);\n\t/* XXX negated ASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"!127.0.0.2\"), 1); */\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.255\", \"127.0.0.0/24\"), 1);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.1.1\", \"127.0.0.0/24\"), 0);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"127.0.0.0/24\"), 1);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"127.0.1.0/24\"), 0);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"!127.0.0.0/24\"), -1);\n\t/* XXX negated ASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"!127.0.1.0/24\"), 1); */\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"10.0.0.1,!127.0.0.1\"), -1);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"!127.0.0.1,10.0.0.1\"), -1);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"10.0.0.1,127.0.0.2\"), 0);\n\tASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"127.0.0.2,10.0.0.1\"), 0);\n\t/* XXX negated ASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"10.0.0.1,!127.0.0.2\"), 1); */\n\t/* XXX negated ASSERT_INT_EQ(addr_match_list(\"127.0.0.1\", \"!127.0.0.2,10.0.0.1\"), 1); */\n\tTEST_DONE();\n\n#define CHECK_FILTER(string,filter,expected) \\\n\tdo { \\\n\t\tchar *result = match_filter_blacklist((string), (filter)); \\\n\t\tASSERT_STRING_EQ(result, expected); \\\n\t\tfree(result); \\\n\t} while (0)\n\n\tTEST_START(\"match_filter_list\");\n\tCHECK_FILTER(\"a,b,c\", \"\", \"a,b,c\");\n\tCHECK_FILTER(\"a,b,c\", \"a\", \"b,c\");\n\tCHECK_FILTER(\"a,b,c\", \"b\", \"a,c\");\n\tCHECK_FILTER(\"a,b,c\", \"c\", \"a,b\");\n\tCHECK_FILTER(\"a,b,c\", \"a,b\", \"c\");\n\tCHECK_FILTER(\"a,b,c\", \"a,c\", \"b\");\n\tCHECK_FILTER(\"a,b,c\", \"b,c\", \"a\");\n\tCHECK_FILTER(\"a,b,c\", \"a,b,c\", \"\");\n\tCHECK_FILTER(\"a,b,c\", \"b,c\", \"a\");\n\tCHECK_FILTER(\"\", \"a,b,c\", \"\");\n\tTEST_DONE();\n/*\n * XXX TODO\n * int      match_host_and_ip(const char *, const char *, const char *);\n * int      match_user(const char *, const char *, const char *, const char *);\n * char    *match_list(const char *, const char *, u_int *);\n * int      addr_match_cidr_list(const char *, const char *);\n */\n}"
  }
]