[
  {
    "function_name": "ls_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-common.c",
    "lines": "213-258",
    "snippet": "char *\nls_file(const char *name, const struct stat *st, int remote, int si_units)\n{\n\tint ulen, glen, sz = 0;\n\tstruct tm *ltime = localtime(&st->st_mtime);\n\tconst char *user, *group;\n\tchar buf[1024], lc[8], mode[11+1], tbuf[12+1], ubuf[11+1], gbuf[11+1];\n\tchar sbuf[FMT_SCALED_STRSIZE];\n\ttime_t now;\n\n\tstrmode(st->st_mode, mode);\n\tif (remote) {\n\t\tsnprintf(ubuf, sizeof ubuf, \"%u\", (u_int)st->st_uid);\n\t\tuser = ubuf;\n\t\tsnprintf(gbuf, sizeof gbuf, \"%u\", (u_int)st->st_gid);\n\t\tgroup = gbuf;\n\t\tstrlcpy(lc, \"?\", sizeof(lc));\n\t} else {\n\t\tuser = user_from_uid(st->st_uid, 0);\n\t\tgroup = group_from_gid(st->st_gid, 0);\n\t\tsnprintf(lc, sizeof(lc), \"%u\", (u_int)st->st_nlink);\n\t}\n\tif (ltime != NULL) {\n\t\tnow = time(NULL);\n\t\tif (now - (365*24*60*60)/2 < st->st_mtime &&\n\t\t    now >= st->st_mtime)\n\t\t\tsz = strftime(tbuf, sizeof tbuf, \"%b %e %H:%M\", ltime);\n\t\telse\n\t\t\tsz = strftime(tbuf, sizeof tbuf, \"%b %e  %Y\", ltime);\n\t}\n\tif (sz == 0)\n\t\ttbuf[0] = '\\0';\n\tulen = MAXIMUM(strlen(user), 8);\n\tglen = MAXIMUM(strlen(group), 8);\n\tif (si_units) {\n\t\tfmt_scaled((long long)st->st_size, sbuf);\n\t\tsnprintf(buf, sizeof buf, \"%s %3s %-*s %-*s %8s %s %s\",\n\t\t    mode, lc, ulen, user, glen, group,\n\t\t    sbuf, tbuf, name);\n\t} else {\n\t\tsnprintf(buf, sizeof buf, \"%s %3s %-*s %-*s %8llu %s %s\",\n\t\t    mode, lc, ulen, user, glen, group,\n\t\t    (unsigned long long)st->st_size, tbuf, name);\n\t}\n\treturn xstrdup(buf);\n}",
    "includes": [
      "#include \"sftp-common.h\"",
      "#include \"sftp.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <util.h>",
      "#include <stdarg.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pwd.h>",
      "#include <grp.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "buf"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "xstrdup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "92-102",
          "snippet": "char *\nxstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = xmalloc(len);\n\tstrlcpy(cp, str, len);\n\treturn cp;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nchar *\nxstrdup(const char *str)\n{\n\tsize_t len;\n\tchar *cp;\n\n\tlen = strlen(str) + 1;\n\tcp = xmalloc(len);\n\tstrlcpy(cp, str, len);\n\treturn cp;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof buf",
            "\"%s %3s %-*s %-*s %8llu %s %s\"",
            "mode",
            "lc",
            "ulen",
            "user",
            "glen",
            "group",
            "(unsigned long long)st->st_size",
            "tbuf",
            "name"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "snprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-snprintf.c",
          "lines": "869-879",
          "snippet": "int\nsnprintf(char *str, size_t count, SNPRINTF_CONST char *fmt, ...)\n{\n\tsize_t ret;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tret = vsnprintf(str, count, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}",
          "includes": [
            "#include <errno.h>",
            "#include <limits.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <ctype.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <limits.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <ctype.h>\n#include \"includes.h\"\n\nint\nsnprintf(char *str, size_t count, SNPRINTF_CONST char *fmt, ...)\n{\n\tsize_t ret;\n\tva_list ap;\n\n\tva_start(ap, fmt);\n\tret = vsnprintf(str, count, fmt, ap);\n\tva_end(ap);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fmt_scaled",
          "args": [
            "(long long)st->st_size",
            "sbuf"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "fmt_scaled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/fmt_scaled.c",
          "lines": "218-276",
          "snippet": "int\nfmt_scaled(long long number, char *result)\n{\n\tlong long abval, fract = 0;\n\tunsigned int i;\n\tunit_type unit = NONE;\n\n\tabval = llabs(number);\n\n\t/* Not every negative long long has a positive representation.\n\t * Also check for numbers that are just too darned big to format\n\t */\n\tif (abval < 0 || abval / 1024 >= scale_factors[SCALE_LENGTH-1]) {\n\t\terrno = ERANGE;\n\t\treturn -1;\n\t}\n\n\t/* scale whole part; get unscaled fraction */\n\tfor (i = 0; i < SCALE_LENGTH; i++) {\n\t\tif (abval/1024 < scale_factors[i]) {\n\t\t\tunit = units[i];\n\t\t\tfract = (i == 0) ? 0 : abval % scale_factors[i];\n\t\t\tnumber /= scale_factors[i];\n\t\t\tif (i > 0)\n\t\t\t\tfract /= scale_factors[i - 1];\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tfract = (10 * fract + 512) / 1024;\n\t/* if the result would be >= 10, round main number */\n\tif (fract >= 10) {\n\t\tif (number >= 0)\n\t\t\tnumber++;\n\t\telse\n\t\t\tnumber--;\n\t\tfract = 0;\n\t} else if (fract < 0) {\n\t\t/* shouldn't happen */\n\t\tfract = 0;\n\t}\n\n\tif (number == 0)\n\t\tstrlcpy(result, \"0B\", FMT_SCALED_STRSIZE);\n\telse if (unit == NONE || number >= 100 || number <= -100) {\n\t\tif (fract >= 5) {\n\t\t\tif (number >= 0)\n\t\t\t\tnumber++;\n\t\t\telse\n\t\t\t\tnumber--;\n\t\t}\n\t\t(void)snprintf(result, FMT_SCALED_STRSIZE, \"%lld%c\",\n\t\t\tnumber, scale_chars[unit]);\n\t} else\n\t\t(void)snprintf(result, FMT_SCALED_STRSIZE, \"%lld.%1lld%c\",\n\t\t\tnumber, fract, scale_chars[unit]);\n\n\treturn 0;\n}",
          "includes": [
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include <string.h>",
            "#include <errno.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define\tSCALE_LENGTH (sizeof(units)/sizeof(units[0]))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <ctype.h>\n#include <string.h>\n#include <errno.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"includes.h\"\n\n#define\tSCALE_LENGTH (sizeof(units)/sizeof(units[0]))\n\nint\nfmt_scaled(long long number, char *result)\n{\n\tlong long abval, fract = 0;\n\tunsigned int i;\n\tunit_type unit = NONE;\n\n\tabval = llabs(number);\n\n\t/* Not every negative long long has a positive representation.\n\t * Also check for numbers that are just too darned big to format\n\t */\n\tif (abval < 0 || abval / 1024 >= scale_factors[SCALE_LENGTH-1]) {\n\t\terrno = ERANGE;\n\t\treturn -1;\n\t}\n\n\t/* scale whole part; get unscaled fraction */\n\tfor (i = 0; i < SCALE_LENGTH; i++) {\n\t\tif (abval/1024 < scale_factors[i]) {\n\t\t\tunit = units[i];\n\t\t\tfract = (i == 0) ? 0 : abval % scale_factors[i];\n\t\t\tnumber /= scale_factors[i];\n\t\t\tif (i > 0)\n\t\t\t\tfract /= scale_factors[i - 1];\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tfract = (10 * fract + 512) / 1024;\n\t/* if the result would be >= 10, round main number */\n\tif (fract >= 10) {\n\t\tif (number >= 0)\n\t\t\tnumber++;\n\t\telse\n\t\t\tnumber--;\n\t\tfract = 0;\n\t} else if (fract < 0) {\n\t\t/* shouldn't happen */\n\t\tfract = 0;\n\t}\n\n\tif (number == 0)\n\t\tstrlcpy(result, \"0B\", FMT_SCALED_STRSIZE);\n\telse if (unit == NONE || number >= 100 || number <= -100) {\n\t\tif (fract >= 5) {\n\t\t\tif (number >= 0)\n\t\t\t\tnumber++;\n\t\t\telse\n\t\t\t\tnumber--;\n\t\t}\n\t\t(void)snprintf(result, FMT_SCALED_STRSIZE, \"%lld%c\",\n\t\t\tnumber, scale_chars[unit]);\n\t} else\n\t\t(void)snprintf(result, FMT_SCALED_STRSIZE, \"%lld.%1lld%c\",\n\t\t\tnumber, fract, scale_chars[unit]);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MAXIMUM",
          "args": [
            "strlen(group)",
            "8"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "group"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAXIMUM",
          "args": [
            "strlen(user)",
            "8"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "user"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strftime",
          "args": [
            "tbuf",
            "sizeof tbuf",
            "\"%b %e  %Y\"",
            "ltime"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strftime",
          "args": [
            "tbuf",
            "sizeof tbuf",
            "\"%b %e %H:%M\"",
            "ltime"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "NULL"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "parse_cert_times",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssh-keygen.c",
          "lines": "1840-1888",
          "snippet": "static void\nparse_cert_times(char *timespec)\n{\n\tchar *from, *to;\n\ttime_t now = time(NULL);\n\tint64_t secs;\n\n\t/* +timespec relative to now */\n\tif (*timespec == '+' && strchr(timespec, ':') == NULL) {\n\t\tif ((secs = convtime(timespec + 1)) == -1)\n\t\t\tfatal(\"Invalid relative certificate life %s\", timespec);\n\t\tcert_valid_to = now + secs;\n\t\t/*\n\t\t * Backdate certificate one minute to avoid problems on hosts\n\t\t * with poorly-synchronised clocks.\n\t\t */\n\t\tcert_valid_from = ((now - 59)/ 60) * 60;\n\t\treturn;\n\t}\n\n\t/*\n\t * from:to, where\n\t * from := [+-]timespec | YYYYMMDD | YYYYMMDDHHMMSS | \"always\"\n\t *   to := [+-]timespec | YYYYMMDD | YYYYMMDDHHMMSS | \"forever\"\n\t */\n\tfrom = xstrdup(timespec);\n\tto = strchr(from, ':');\n\tif (to == NULL || from == to || *(to + 1) == '\\0')\n\t\tfatal(\"Invalid certificate life specification %s\", timespec);\n\t*to++ = '\\0';\n\n\tif (*from == '-' || *from == '+')\n\t\tcert_valid_from = parse_relative_time(from, now);\n\telse if (strcmp(from, \"always\") == 0)\n\t\tcert_valid_from = 0;\n\telse if (parse_absolute_time(from, &cert_valid_from) != 0)\n\t\tfatal(\"Invalid from time \\\"%s\\\"\", from);\n\n\tif (*to == '-' || *to == '+')\n\t\tcert_valid_to = parse_relative_time(to, now);\n\telse if (strcmp(to, \"forever\") == 0)\n\t\tcert_valid_to = ~(u_int64_t)0;\n\telse if (parse_absolute_time(to, &cert_valid_to) != 0)\n\t\tfatal(\"Invalid to time \\\"%s\\\"\", to);\n\n\tif (cert_valid_to <= cert_valid_from)\n\t\tfatal(\"Empty certificate validity interval\");\n\tfree(from);\n}",
          "includes": [
            "#include \"authfd.h\"",
            "#include \"utf8.h\"",
            "#include \"digest.h\"",
            "#include \"krl.h\"",
            "#include \"atomicio.h\"",
            "#include \"ssh-pkcs11.h\"",
            "#include \"ssherr.h\"",
            "#include \"ssh2.h\"",
            "#include \"ssh.h\"",
            "#include \"dns.h\"",
            "#include \"hostfile.h\"",
            "#include \"match.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"pathnames.h\"",
            "#include \"sshbuf.h\"",
            "#include \"uuencode.h\"",
            "#include \"authfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include <time.h>",
            "#include <locale.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include \"openbsd-compat/openssl-compat.h\"",
            "#include <openssl/pem.h>",
            "#include <openssl/evp.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "u_int64_t cert_valid_from = 0;",
            "u_int64_t cert_valid_to = ~0ULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"authfd.h\"\n#include \"utf8.h\"\n#include \"digest.h\"\n#include \"krl.h\"\n#include \"atomicio.h\"\n#include \"ssh-pkcs11.h\"\n#include \"ssherr.h\"\n#include \"ssh2.h\"\n#include \"ssh.h\"\n#include \"dns.h\"\n#include \"hostfile.h\"\n#include \"match.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"pathnames.h\"\n#include \"sshbuf.h\"\n#include \"uuencode.h\"\n#include \"authfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include <time.h>\n#include <locale.h>\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include \"openbsd-compat/openssl-compat.h\"\n#include <openssl/pem.h>\n#include <openssl/evp.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nu_int64_t cert_valid_from = 0;\nu_int64_t cert_valid_to = ~0ULL;\n\nstatic void\nparse_cert_times(char *timespec)\n{\n\tchar *from, *to;\n\ttime_t now = time(NULL);\n\tint64_t secs;\n\n\t/* +timespec relative to now */\n\tif (*timespec == '+' && strchr(timespec, ':') == NULL) {\n\t\tif ((secs = convtime(timespec + 1)) == -1)\n\t\t\tfatal(\"Invalid relative certificate life %s\", timespec);\n\t\tcert_valid_to = now + secs;\n\t\t/*\n\t\t * Backdate certificate one minute to avoid problems on hosts\n\t\t * with poorly-synchronised clocks.\n\t\t */\n\t\tcert_valid_from = ((now - 59)/ 60) * 60;\n\t\treturn;\n\t}\n\n\t/*\n\t * from:to, where\n\t * from := [+-]timespec | YYYYMMDD | YYYYMMDDHHMMSS | \"always\"\n\t *   to := [+-]timespec | YYYYMMDD | YYYYMMDDHHMMSS | \"forever\"\n\t */\n\tfrom = xstrdup(timespec);\n\tto = strchr(from, ':');\n\tif (to == NULL || from == to || *(to + 1) == '\\0')\n\t\tfatal(\"Invalid certificate life specification %s\", timespec);\n\t*to++ = '\\0';\n\n\tif (*from == '-' || *from == '+')\n\t\tcert_valid_from = parse_relative_time(from, now);\n\telse if (strcmp(from, \"always\") == 0)\n\t\tcert_valid_from = 0;\n\telse if (parse_absolute_time(from, &cert_valid_from) != 0)\n\t\tfatal(\"Invalid from time \\\"%s\\\"\", from);\n\n\tif (*to == '-' || *to == '+')\n\t\tcert_valid_to = parse_relative_time(to, now);\n\telse if (strcmp(to, \"forever\") == 0)\n\t\tcert_valid_to = ~(u_int64_t)0;\n\telse if (parse_absolute_time(to, &cert_valid_to) != 0)\n\t\tfatal(\"Invalid to time \\\"%s\\\"\", to);\n\n\tif (cert_valid_to <= cert_valid_from)\n\t\tfatal(\"Empty certificate validity interval\");\n\tfree(from);\n}"
        }
      },
      {
        "call_info": {
          "callee": "group_from_gid",
          "args": [
            "st->st_gid",
            "0"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "group_from_gid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/pwcache.c",
          "lines": "82-113",
          "snippet": "char *\ngroup_from_gid(gid_t gid, int nogroup)\n{\n\tstatic struct ncache {\n\t\tgid_t\tgid;\n\t\tchar\t*name;\n\t} c_gid[NCACHE];\n\tstatic int gropen;\n\tstatic char nbuf[15];\t\t/* 32 bits == 10 digits */\n\tstruct group *gr;\n\tstruct ncache *cp;\n\n\tcp = c_gid + (gid & MASK);\n\tif (cp->gid != gid || cp->name == NULL) {\n\t\tif (gropen == 0) {\n#ifdef HAVE_SETGROUPENT\n\t\t\tsetgroupent(1);\n#endif\n\t\t\tgropen = 1;\n\t\t}\n\t\tif ((gr = getgrgid(gid)) == NULL) {\n\t\t\tif (nogroup)\n\t\t\t\treturn (NULL);\n\t\t\t(void)snprintf(nbuf, sizeof(nbuf), \"%u\", gid);\n\t\t}\n\t\tcp->gid = gid;\n\t\tif (cp->name != NULL)\n\t\t\tfree(cp->name);\n\t\tcp->name = strdup(gr ? gr->gr_name : nbuf);\n\t}\n\treturn (cp->name);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define\tMASK\t(NCACHE - 1)\t\t/* bits to store with */",
            "#define\tNCACHE\t64\t\t\t/* power of 2 */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <grp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define\tMASK\t(NCACHE - 1)\t\t/* bits to store with */\n#define\tNCACHE\t64\t\t\t/* power of 2 */\n\nchar *\ngroup_from_gid(gid_t gid, int nogroup)\n{\n\tstatic struct ncache {\n\t\tgid_t\tgid;\n\t\tchar\t*name;\n\t} c_gid[NCACHE];\n\tstatic int gropen;\n\tstatic char nbuf[15];\t\t/* 32 bits == 10 digits */\n\tstruct group *gr;\n\tstruct ncache *cp;\n\n\tcp = c_gid + (gid & MASK);\n\tif (cp->gid != gid || cp->name == NULL) {\n\t\tif (gropen == 0) {\n#ifdef HAVE_SETGROUPENT\n\t\t\tsetgroupent(1);\n#endif\n\t\t\tgropen = 1;\n\t\t}\n\t\tif ((gr = getgrgid(gid)) == NULL) {\n\t\t\tif (nogroup)\n\t\t\t\treturn (NULL);\n\t\t\t(void)snprintf(nbuf, sizeof(nbuf), \"%u\", gid);\n\t\t}\n\t\tcp->gid = gid;\n\t\tif (cp->name != NULL)\n\t\t\tfree(cp->name);\n\t\tcp->name = strdup(gr ? gr->gr_name : nbuf);\n\t}\n\treturn (cp->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "user_from_uid",
          "args": [
            "st->st_uid",
            "0"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "user_from_uid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/pwcache.c",
          "lines": "47-78",
          "snippet": "char *\nuser_from_uid(uid_t uid, int nouser)\n{\n\tstatic struct ncache {\n\t\tuid_t\tuid;\n\t\tchar\t*name;\n\t} c_uid[NCACHE];\n\tstatic int pwopen;\n\tstatic char nbuf[15];\t\t/* 32 bits == 10 digits */\n\tstruct passwd *pw;\n\tstruct ncache *cp;\n\n\tcp = c_uid + (uid & MASK);\n\tif (cp->uid != uid || cp->name == NULL) {\n\t\tif (pwopen == 0) {\n#ifdef HAVE_SETPASSENT\n\t\t\tsetpassent(1);\n#endif\n\t\t\tpwopen = 1;\n\t\t}\n\t\tif ((pw = getpwuid(uid)) == NULL) {\n\t\t\tif (nouser)\n\t\t\t\treturn (NULL);\n\t\t\t(void)snprintf(nbuf, sizeof(nbuf), \"%u\", uid);\n\t\t}\n\t\tcp->uid = uid;\n\t\tif (cp->name != NULL)\n\t\t\tfree(cp->name);\n\t\tcp->name = strdup(pw ? pw->pw_name : nbuf);\n\t}\n\treturn (cp->name);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define\tMASK\t(NCACHE - 1)\t\t/* bits to store with */",
            "#define\tNCACHE\t64\t\t\t/* power of 2 */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <grp.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define\tMASK\t(NCACHE - 1)\t\t/* bits to store with */\n#define\tNCACHE\t64\t\t\t/* power of 2 */\n\nchar *\nuser_from_uid(uid_t uid, int nouser)\n{\n\tstatic struct ncache {\n\t\tuid_t\tuid;\n\t\tchar\t*name;\n\t} c_uid[NCACHE];\n\tstatic int pwopen;\n\tstatic char nbuf[15];\t\t/* 32 bits == 10 digits */\n\tstruct passwd *pw;\n\tstruct ncache *cp;\n\n\tcp = c_uid + (uid & MASK);\n\tif (cp->uid != uid || cp->name == NULL) {\n\t\tif (pwopen == 0) {\n#ifdef HAVE_SETPASSENT\n\t\t\tsetpassent(1);\n#endif\n\t\t\tpwopen = 1;\n\t\t}\n\t\tif ((pw = getpwuid(uid)) == NULL) {\n\t\t\tif (nouser)\n\t\t\t\treturn (NULL);\n\t\t\t(void)snprintf(nbuf, sizeof(nbuf), \"%u\", uid);\n\t\t}\n\t\tcp->uid = uid;\n\t\tif (cp->name != NULL)\n\t\t\tfree(cp->name);\n\t\tcp->name = strdup(pw ? pw->pw_name : nbuf);\n\t}\n\treturn (cp->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "lc",
            "\"?\"",
            "sizeof(lc)"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "strlcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strlcpy.c",
          "lines": "32-56",
          "snippet": "size_t\nstrlcpy(char *dst, const char *src, size_t siz)\n{\n\tchar *d = dst;\n\tconst char *s = src;\n\tsize_t n = siz;\n\n\t/* Copy as many bytes as will fit */\n\tif (n != 0) {\n\t\twhile (--n != 0) {\n\t\t\tif ((*d++ = *s++) == '\\0')\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* Not enough room in dst, add NUL and traverse rest of src */\n\tif (n == 0) {\n\t\tif (siz != 0)\n\t\t\t*d = '\\0';\t\t/* NUL-terminate dst */\n\t\twhile (*s++)\n\t\t\t;\n\t}\n\n\treturn(s - src - 1);\t/* count does not include NUL */\n}",
          "includes": [
            "#include <string.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nstrlcpy(char *dst, const char *src, size_t siz)\n{\n\tchar *d = dst;\n\tconst char *s = src;\n\tsize_t n = siz;\n\n\t/* Copy as many bytes as will fit */\n\tif (n != 0) {\n\t\twhile (--n != 0) {\n\t\t\tif ((*d++ = *s++) == '\\0')\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* Not enough room in dst, add NUL and traverse rest of src */\n\tif (n == 0) {\n\t\tif (siz != 0)\n\t\t\t*d = '\\0';\t\t/* NUL-terminate dst */\n\t\twhile (*s++)\n\t\t\t;\n\t}\n\n\treturn(s - src - 1);\t/* count does not include NUL */\n}"
        }
      },
      {
        "call_info": {
          "callee": "strmode",
          "args": [
            "st->st_mode",
            "mode"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "strmode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/strmode.c",
          "lines": "42-147",
          "snippet": "void\nstrmode(int mode, char *p)\n{\n\t /* print type */\n\tswitch (mode & S_IFMT) {\n\tcase S_IFDIR:\t\t\t/* directory */\n\t\t*p++ = 'd';\n\t\tbreak;\n\tcase S_IFCHR:\t\t\t/* character special */\n\t\t*p++ = 'c';\n\t\tbreak;\n\tcase S_IFBLK:\t\t\t/* block special */\n\t\t*p++ = 'b';\n\t\tbreak;\n\tcase S_IFREG:\t\t\t/* regular */\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IFLNK:\t\t\t/* symbolic link */\n\t\t*p++ = 'l';\n\t\tbreak;\n#ifdef S_IFSOCK\n\tcase S_IFSOCK:\t\t\t/* socket */\n\t\t*p++ = 's';\n\t\tbreak;\n#endif\n#ifdef S_IFIFO\n\tcase S_IFIFO:\t\t\t/* fifo */\n\t\t*p++ = 'p';\n\t\tbreak;\n#endif\n\tdefault:\t\t\t/* unknown */\n\t\t*p++ = '?';\n\t\tbreak;\n\t}\n\t/* usr */\n\tif (mode & S_IRUSR)\n\t\t*p++ = 'r';\n\telse\n\t\t*p++ = '-';\n\tif (mode & S_IWUSR)\n\t\t*p++ = 'w';\n\telse\n\t\t*p++ = '-';\n\tswitch (mode & (S_IXUSR | S_ISUID)) {\n\tcase 0:\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IXUSR:\n\t\t*p++ = 'x';\n\t\tbreak;\n\tcase S_ISUID:\n\t\t*p++ = 'S';\n\t\tbreak;\n\tcase S_IXUSR | S_ISUID:\n\t\t*p++ = 's';\n\t\tbreak;\n\t}\n\t/* group */\n\tif (mode & S_IRGRP)\n\t\t*p++ = 'r';\n\telse\n\t\t*p++ = '-';\n\tif (mode & S_IWGRP)\n\t\t*p++ = 'w';\n\telse\n\t\t*p++ = '-';\n\tswitch (mode & (S_IXGRP | S_ISGID)) {\n\tcase 0:\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IXGRP:\n\t\t*p++ = 'x';\n\t\tbreak;\n\tcase S_ISGID:\n\t\t*p++ = 'S';\n\t\tbreak;\n\tcase S_IXGRP | S_ISGID:\n\t\t*p++ = 's';\n\t\tbreak;\n\t}\n\t/* other */\n\tif (mode & S_IROTH)\n\t\t*p++ = 'r';\n\telse\n\t\t*p++ = '-';\n\tif (mode & S_IWOTH)\n\t\t*p++ = 'w';\n\telse\n\t\t*p++ = '-';\n\tswitch (mode & (S_IXOTH | S_ISVTX)) {\n\tcase 0:\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IXOTH:\n\t\t*p++ = 'x';\n\t\tbreak;\n\tcase S_ISVTX:\n\t\t*p++ = 'T';\n\t\tbreak;\n\tcase S_IXOTH | S_ISVTX:\n\t\t*p++ = 't';\n\t\tbreak;\n\t}\n\t*p++ = ' ';\t\t/* will be a '+' if ACL's implemented */\n\t*p = '\\0';\n}",
          "includes": [
            "#include <string.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nstrmode(int mode, char *p)\n{\n\t /* print type */\n\tswitch (mode & S_IFMT) {\n\tcase S_IFDIR:\t\t\t/* directory */\n\t\t*p++ = 'd';\n\t\tbreak;\n\tcase S_IFCHR:\t\t\t/* character special */\n\t\t*p++ = 'c';\n\t\tbreak;\n\tcase S_IFBLK:\t\t\t/* block special */\n\t\t*p++ = 'b';\n\t\tbreak;\n\tcase S_IFREG:\t\t\t/* regular */\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IFLNK:\t\t\t/* symbolic link */\n\t\t*p++ = 'l';\n\t\tbreak;\n#ifdef S_IFSOCK\n\tcase S_IFSOCK:\t\t\t/* socket */\n\t\t*p++ = 's';\n\t\tbreak;\n#endif\n#ifdef S_IFIFO\n\tcase S_IFIFO:\t\t\t/* fifo */\n\t\t*p++ = 'p';\n\t\tbreak;\n#endif\n\tdefault:\t\t\t/* unknown */\n\t\t*p++ = '?';\n\t\tbreak;\n\t}\n\t/* usr */\n\tif (mode & S_IRUSR)\n\t\t*p++ = 'r';\n\telse\n\t\t*p++ = '-';\n\tif (mode & S_IWUSR)\n\t\t*p++ = 'w';\n\telse\n\t\t*p++ = '-';\n\tswitch (mode & (S_IXUSR | S_ISUID)) {\n\tcase 0:\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IXUSR:\n\t\t*p++ = 'x';\n\t\tbreak;\n\tcase S_ISUID:\n\t\t*p++ = 'S';\n\t\tbreak;\n\tcase S_IXUSR | S_ISUID:\n\t\t*p++ = 's';\n\t\tbreak;\n\t}\n\t/* group */\n\tif (mode & S_IRGRP)\n\t\t*p++ = 'r';\n\telse\n\t\t*p++ = '-';\n\tif (mode & S_IWGRP)\n\t\t*p++ = 'w';\n\telse\n\t\t*p++ = '-';\n\tswitch (mode & (S_IXGRP | S_ISGID)) {\n\tcase 0:\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IXGRP:\n\t\t*p++ = 'x';\n\t\tbreak;\n\tcase S_ISGID:\n\t\t*p++ = 'S';\n\t\tbreak;\n\tcase S_IXGRP | S_ISGID:\n\t\t*p++ = 's';\n\t\tbreak;\n\t}\n\t/* other */\n\tif (mode & S_IROTH)\n\t\t*p++ = 'r';\n\telse\n\t\t*p++ = '-';\n\tif (mode & S_IWOTH)\n\t\t*p++ = 'w';\n\telse\n\t\t*p++ = '-';\n\tswitch (mode & (S_IXOTH | S_ISVTX)) {\n\tcase 0:\n\t\t*p++ = '-';\n\t\tbreak;\n\tcase S_IXOTH:\n\t\t*p++ = 'x';\n\t\tbreak;\n\tcase S_ISVTX:\n\t\t*p++ = 'T';\n\t\tbreak;\n\tcase S_IXOTH | S_ISVTX:\n\t\t*p++ = 't';\n\t\tbreak;\n\t}\n\t*p++ = ' ';\t\t/* will be a '+' if ACL's implemented */\n\t*p = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "localtime",
          "args": [
            "&st->st_mtime"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <util.h>\n#include <stdarg.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <grp.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *\nls_file(const char *name, const struct stat *st, int remote, int si_units)\n{\n\tint ulen, glen, sz = 0;\n\tstruct tm *ltime = localtime(&st->st_mtime);\n\tconst char *user, *group;\n\tchar buf[1024], lc[8], mode[11+1], tbuf[12+1], ubuf[11+1], gbuf[11+1];\n\tchar sbuf[FMT_SCALED_STRSIZE];\n\ttime_t now;\n\n\tstrmode(st->st_mode, mode);\n\tif (remote) {\n\t\tsnprintf(ubuf, sizeof ubuf, \"%u\", (u_int)st->st_uid);\n\t\tuser = ubuf;\n\t\tsnprintf(gbuf, sizeof gbuf, \"%u\", (u_int)st->st_gid);\n\t\tgroup = gbuf;\n\t\tstrlcpy(lc, \"?\", sizeof(lc));\n\t} else {\n\t\tuser = user_from_uid(st->st_uid, 0);\n\t\tgroup = group_from_gid(st->st_gid, 0);\n\t\tsnprintf(lc, sizeof(lc), \"%u\", (u_int)st->st_nlink);\n\t}\n\tif (ltime != NULL) {\n\t\tnow = time(NULL);\n\t\tif (now - (365*24*60*60)/2 < st->st_mtime &&\n\t\t    now >= st->st_mtime)\n\t\t\tsz = strftime(tbuf, sizeof tbuf, \"%b %e %H:%M\", ltime);\n\t\telse\n\t\t\tsz = strftime(tbuf, sizeof tbuf, \"%b %e  %Y\", ltime);\n\t}\n\tif (sz == 0)\n\t\ttbuf[0] = '\\0';\n\tulen = MAXIMUM(strlen(user), 8);\n\tglen = MAXIMUM(strlen(group), 8);\n\tif (si_units) {\n\t\tfmt_scaled((long long)st->st_size, sbuf);\n\t\tsnprintf(buf, sizeof buf, \"%s %3s %-*s %-*s %8s %s %s\",\n\t\t    mode, lc, ulen, user, glen, group,\n\t\t    sbuf, tbuf, name);\n\t} else {\n\t\tsnprintf(buf, sizeof buf, \"%s %3s %-*s %-*s %8llu %s %s\",\n\t\t    mode, lc, ulen, user, glen, group,\n\t\t    (unsigned long long)st->st_size, tbuf, name);\n\t}\n\treturn xstrdup(buf);\n}"
  },
  {
    "function_name": "fx2txt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-common.c",
    "lines": "182-208",
    "snippet": "const char *\nfx2txt(int status)\n{\n\tswitch (status) {\n\tcase SSH2_FX_OK:\n\t\treturn(\"No error\");\n\tcase SSH2_FX_EOF:\n\t\treturn(\"End of file\");\n\tcase SSH2_FX_NO_SUCH_FILE:\n\t\treturn(\"No such file or directory\");\n\tcase SSH2_FX_PERMISSION_DENIED:\n\t\treturn(\"Permission denied\");\n\tcase SSH2_FX_FAILURE:\n\t\treturn(\"Failure\");\n\tcase SSH2_FX_BAD_MESSAGE:\n\t\treturn(\"Bad message\");\n\tcase SSH2_FX_NO_CONNECTION:\n\t\treturn(\"No connection\");\n\tcase SSH2_FX_CONNECTION_LOST:\n\t\treturn(\"Connection lost\");\n\tcase SSH2_FX_OP_UNSUPPORTED:\n\t\treturn(\"Operation unsupported\");\n\tdefault:\n\t\treturn(\"Unknown status\");\n\t}\n\t/* NOTREACHED */\n}",
    "includes": [
      "#include \"sftp-common.h\"",
      "#include \"sftp.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <util.h>",
      "#include <stdarg.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pwd.h>",
      "#include <grp.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <util.h>\n#include <stdarg.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <grp.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst char *\nfx2txt(int status)\n{\n\tswitch (status) {\n\tcase SSH2_FX_OK:\n\t\treturn(\"No error\");\n\tcase SSH2_FX_EOF:\n\t\treturn(\"End of file\");\n\tcase SSH2_FX_NO_SUCH_FILE:\n\t\treturn(\"No such file or directory\");\n\tcase SSH2_FX_PERMISSION_DENIED:\n\t\treturn(\"Permission denied\");\n\tcase SSH2_FX_FAILURE:\n\t\treturn(\"Failure\");\n\tcase SSH2_FX_BAD_MESSAGE:\n\t\treturn(\"Bad message\");\n\tcase SSH2_FX_NO_CONNECTION:\n\t\treturn(\"No connection\");\n\tcase SSH2_FX_CONNECTION_LOST:\n\t\treturn(\"Connection lost\");\n\tcase SSH2_FX_OP_UNSUPPORTED:\n\t\treturn(\"Operation unsupported\");\n\tdefault:\n\t\treturn(\"Unknown status\");\n\t}\n\t/* NOTREACHED */\n}"
  },
  {
    "function_name": "encode_attrib",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-common.c",
    "lines": "153-179",
    "snippet": "int\nencode_attrib(struct sshbuf *b, const Attrib *a)\n{\n\tint r;\n\n\tif ((r = sshbuf_put_u32(b, a->flags)) != 0)\n\t\treturn r;\n\tif (a->flags & SSH2_FILEXFER_ATTR_SIZE) {\n\t\tif ((r = sshbuf_put_u64(b, a->size)) != 0)\n\t\t\treturn r;\n\t}\n\tif (a->flags & SSH2_FILEXFER_ATTR_UIDGID) {\n\t\tif ((r = sshbuf_put_u32(b, a->uid)) != 0 ||\n\t\t    (r = sshbuf_put_u32(b, a->gid)) != 0)\n\t\t\treturn r;\n\t}\n\tif (a->flags & SSH2_FILEXFER_ATTR_PERMISSIONS) {\n\t\tif ((r = sshbuf_put_u32(b, a->perm)) != 0)\n\t\t\treturn r;\n\t}\n\tif (a->flags & SSH2_FILEXFER_ATTR_ACMODTIME) {\n\t\tif ((r = sshbuf_put_u32(b, a->atime)) != 0 ||\n\t\t    (r = sshbuf_put_u32(b, a->mtime)) != 0)\n\t\t\treturn r;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"sftp-common.h\"",
      "#include \"sftp.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <util.h>",
      "#include <stdarg.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pwd.h>",
      "#include <grp.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sshbuf_put_u32",
          "args": [
            "b",
            "a->mtime"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_u32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "311-321",
          "snippet": "int\nsshbuf_put_u32(struct sshbuf *buf, u_int32_t val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 4, &p)) < 0)\n\t\treturn r;\n\tPOKE_U32(p, val);\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_u32(struct sshbuf *buf, u_int32_t val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 4, &p)) < 0)\n\t\treturn r;\n\tPOKE_U32(p, val);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_put_u64",
          "args": [
            "b",
            "a->size"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_u64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "299-309",
          "snippet": "int\nsshbuf_put_u64(struct sshbuf *buf, u_int64_t val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 8, &p)) < 0)\n\t\treturn r;\n\tPOKE_U64(p, val);\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_u64(struct sshbuf *buf, u_int64_t val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 8, &p)) < 0)\n\t\treturn r;\n\tPOKE_U64(p, val);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <util.h>\n#include <stdarg.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <grp.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nencode_attrib(struct sshbuf *b, const Attrib *a)\n{\n\tint r;\n\n\tif ((r = sshbuf_put_u32(b, a->flags)) != 0)\n\t\treturn r;\n\tif (a->flags & SSH2_FILEXFER_ATTR_SIZE) {\n\t\tif ((r = sshbuf_put_u64(b, a->size)) != 0)\n\t\t\treturn r;\n\t}\n\tif (a->flags & SSH2_FILEXFER_ATTR_UIDGID) {\n\t\tif ((r = sshbuf_put_u32(b, a->uid)) != 0 ||\n\t\t    (r = sshbuf_put_u32(b, a->gid)) != 0)\n\t\t\treturn r;\n\t}\n\tif (a->flags & SSH2_FILEXFER_ATTR_PERMISSIONS) {\n\t\tif ((r = sshbuf_put_u32(b, a->perm)) != 0)\n\t\t\treturn r;\n\t}\n\tif (a->flags & SSH2_FILEXFER_ATTR_ACMODTIME) {\n\t\tif ((r = sshbuf_put_u32(b, a->atime)) != 0 ||\n\t\t    (r = sshbuf_put_u32(b, a->mtime)) != 0)\n\t\t\treturn r;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "decode_attrib",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-common.c",
    "lines": "104-150",
    "snippet": "int\ndecode_attrib(struct sshbuf *b, Attrib *a)\n{\n\tint r;\n\n\tattrib_clear(a);\n\tif ((r = sshbuf_get_u32(b, &a->flags)) != 0)\n\t\treturn r;\n\tif (a->flags & SSH2_FILEXFER_ATTR_SIZE) {\n\t\tif ((r = sshbuf_get_u64(b, &a->size)) != 0)\n\t\t\treturn r;\n\t}\n\tif (a->flags & SSH2_FILEXFER_ATTR_UIDGID) {\n\t\tif ((r = sshbuf_get_u32(b, &a->uid)) != 0 ||\n\t\t    (r = sshbuf_get_u32(b, &a->gid)) != 0)\n\t\t\treturn r;\n\t}\n\tif (a->flags & SSH2_FILEXFER_ATTR_PERMISSIONS) {\n\t\tif ((r = sshbuf_get_u32(b, &a->perm)) != 0)\n\t\t\treturn r;\n\t}\n\tif (a->flags & SSH2_FILEXFER_ATTR_ACMODTIME) {\n\t\tif ((r = sshbuf_get_u32(b, &a->atime)) != 0 ||\n\t\t    (r = sshbuf_get_u32(b, &a->mtime)) != 0)\n\t\t\treturn r;\n\t}\n\t/* vendor-specific extensions */\n\tif (a->flags & SSH2_FILEXFER_ATTR_EXTENDED) {\n\t\tchar *type;\n\t\tu_char *data;\n\t\tsize_t dlen;\n\t\tu_int i, count;\n\n\t\tif ((r = sshbuf_get_u32(b, &count)) != 0)\n\t\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r));\n\t\tfor (i = 0; i < count; i++) {\n\t\t\tif ((r = sshbuf_get_cstring(b, &type, NULL)) != 0 ||\n\t\t\t    (r = sshbuf_get_string(b, &data, &dlen)) != 0)\n\t\t\t\treturn r;\n\t\t\tdebug3(\"Got file attribute \\\"%.100s\\\" len %zu\",\n\t\t\t    type, dlen);\n\t\t\tfree(type);\n\t\t\tfree(data);\n\t\t}\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"sftp-common.h\"",
      "#include \"sftp.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <util.h>",
      "#include <stdarg.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pwd.h>",
      "#include <grp.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "data"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "freeze",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/smult_curve25519_ref.c",
          "lines": "50-60",
          "snippet": "static void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [
            "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;"
          ],
          "called_functions": [],
          "contextual_snippet": "static const unsigned int minusp[32] = {\n 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128\n} ;\n\nstatic void freeze(unsigned int a[32])\n{\n  unsigned int aorig[32];\n  unsigned int j;\n  unsigned int negative;\n\n  for (j = 0;j < 32;++j) aorig[j] = a[j];\n  add(a,a,minusp);\n  negative = -((a[31] >> 7) & 1);\n  for (j = 0;j < 32;++j) a[j] ^= negative & (aorig[j] ^ a[j]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug3",
          "args": [
            "\"Got file attribute \\\"%.100s\\\" len %zu\"",
            "type",
            "dlen"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_get_string",
          "args": [
            "b",
            "&data",
            "&dlen"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_get_string_direct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "123-147",
          "snippet": "int\nsshbuf_get_string_direct(struct sshbuf *buf, const u_char **valp, size_t *lenp)\n{\n\tsize_t len;\n\tconst u_char *p;\n\tint r;\n\n\tif (valp != NULL)\n\t\t*valp = NULL;\n\tif (lenp != NULL)\n\t\t*lenp = 0;\n\tif ((r = sshbuf_peek_string_direct(buf, &p, &len)) < 0)\n\t\treturn r;\n\tif (valp != NULL)\n\t\t*valp = p;\n\tif (lenp != NULL)\n\t\t*lenp = len;\n\tif (sshbuf_consume(buf, len + 4) != 0) {\n\t\t/* Shouldn't happen */\n\t\tSSHBUF_DBG((\"SSH_ERR_INTERNAL_ERROR\"));\n\t\tSSHBUF_ABORT();\n\t\treturn SSH_ERR_INTERNAL_ERROR;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_get_string_direct(struct sshbuf *buf, const u_char **valp, size_t *lenp)\n{\n\tsize_t len;\n\tconst u_char *p;\n\tint r;\n\n\tif (valp != NULL)\n\t\t*valp = NULL;\n\tif (lenp != NULL)\n\t\t*lenp = 0;\n\tif ((r = sshbuf_peek_string_direct(buf, &p, &len)) < 0)\n\t\treturn r;\n\tif (valp != NULL)\n\t\t*valp = p;\n\tif (lenp != NULL)\n\t\t*lenp = len;\n\tif (sshbuf_consume(buf, len + 4) != 0) {\n\t\t/* Shouldn't happen */\n\t\tSSHBUF_DBG((\"SSH_ERR_INTERNAL_ERROR\"));\n\t\tSSHBUF_ABORT();\n\t\treturn SSH_ERR_INTERNAL_ERROR;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_get_cstring",
          "args": [
            "b",
            "&type",
            "NULL"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_get_cstring",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "180-213",
          "snippet": "int\nsshbuf_get_cstring(struct sshbuf *buf, char **valp, size_t *lenp)\n{\n\tsize_t len;\n\tconst u_char *p, *z;\n\tint r;\n\n\tif (valp != NULL)\n\t\t*valp = NULL;\n\tif (lenp != NULL)\n\t\t*lenp = 0;\n\tif ((r = sshbuf_peek_string_direct(buf, &p, &len)) != 0)\n\t\treturn r;\n\t/* Allow a \\0 only at the end of the string */\n\tif (len > 0 &&\n\t    (z = memchr(p , '\\0', len)) != NULL && z < p + len - 1) {\n\t\tSSHBUF_DBG((\"SSH_ERR_INVALID_FORMAT\"));\n\t\treturn SSH_ERR_INVALID_FORMAT;\n\t}\n\tif ((r = sshbuf_skip_string(buf)) != 0)\n\t\treturn -1;\n\tif (valp != NULL) {\n\t\tif ((*valp = malloc(len + 1)) == NULL) {\n\t\t\tSSHBUF_DBG((\"SSH_ERR_ALLOC_FAIL\"));\n\t\t\treturn SSH_ERR_ALLOC_FAIL;\n\t\t}\n\t\tif (len != 0)\n\t\t\tmemcpy(*valp, p, len);\n\t\t(*valp)[len] = '\\0';\n\t}\n\tif (lenp != NULL)\n\t\t*lenp = (size_t)len;\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_get_cstring(struct sshbuf *buf, char **valp, size_t *lenp)\n{\n\tsize_t len;\n\tconst u_char *p, *z;\n\tint r;\n\n\tif (valp != NULL)\n\t\t*valp = NULL;\n\tif (lenp != NULL)\n\t\t*lenp = 0;\n\tif ((r = sshbuf_peek_string_direct(buf, &p, &len)) != 0)\n\t\treturn r;\n\t/* Allow a \\0 only at the end of the string */\n\tif (len > 0 &&\n\t    (z = memchr(p , '\\0', len)) != NULL && z < p + len - 1) {\n\t\tSSHBUF_DBG((\"SSH_ERR_INVALID_FORMAT\"));\n\t\treturn SSH_ERR_INVALID_FORMAT;\n\t}\n\tif ((r = sshbuf_skip_string(buf)) != 0)\n\t\treturn -1;\n\tif (valp != NULL) {\n\t\tif ((*valp = malloc(len + 1)) == NULL) {\n\t\t\tSSHBUF_DBG((\"SSH_ERR_ALLOC_FAIL\"));\n\t\t\treturn SSH_ERR_ALLOC_FAIL;\n\t\t}\n\t\tif (len != 0)\n\t\t\tmemcpy(*valp, p, len);\n\t\t(*valp)[len] = '\\0';\n\t}\n\tif (lenp != NULL)\n\t\t*lenp = (size_t)len;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"%s: buffer error: %s\"",
            "__func__",
            "ssh_err(r)"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fatal.c",
          "lines": "36-45",
          "snippet": "void\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\tcleanup_exit(255);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\tcleanup_exit(255);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_err",
          "args": [
            "r"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_err",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/ssherr.c",
          "lines": "22-147",
          "snippet": "const char *\nssh_err(int n)\n{\n\tswitch (n) {\n\tcase SSH_ERR_SUCCESS:\n\t\treturn \"success\";\n\tcase SSH_ERR_INTERNAL_ERROR:\n\t\treturn \"unexpected internal error\";\n\tcase SSH_ERR_ALLOC_FAIL:\n\t\treturn \"memory allocation failed\";\n\tcase SSH_ERR_MESSAGE_INCOMPLETE:\n\t\treturn \"incomplete message\";\n\tcase SSH_ERR_INVALID_FORMAT:\n\t\treturn \"invalid format\";\n\tcase SSH_ERR_BIGNUM_IS_NEGATIVE:\n\t\treturn \"bignum is negative\";\n\tcase SSH_ERR_STRING_TOO_LARGE:\n\t\treturn \"string is too large\";\n\tcase SSH_ERR_BIGNUM_TOO_LARGE:\n\t\treturn \"bignum is too large\";\n\tcase SSH_ERR_ECPOINT_TOO_LARGE:\n\t\treturn \"elliptic curve point is too large\";\n\tcase SSH_ERR_NO_BUFFER_SPACE:\n\t\treturn \"insufficient buffer space\";\n\tcase SSH_ERR_INVALID_ARGUMENT:\n\t\treturn \"invalid argument\";\n\tcase SSH_ERR_KEY_BITS_MISMATCH:\n\t\treturn \"key bits do not match\";\n\tcase SSH_ERR_EC_CURVE_INVALID:\n\t\treturn \"invalid elliptic curve\";\n\tcase SSH_ERR_KEY_TYPE_MISMATCH:\n\t\treturn \"key type does not match\";\n\tcase SSH_ERR_KEY_TYPE_UNKNOWN:\n\t\treturn \"unknown or unsupported key type\";\n\tcase SSH_ERR_EC_CURVE_MISMATCH:\n\t\treturn \"elliptic curve does not match\";\n\tcase SSH_ERR_EXPECTED_CERT:\n\t\treturn \"plain key provided where certificate required\";\n\tcase SSH_ERR_KEY_LACKS_CERTBLOB:\n\t\treturn \"key lacks certificate data\";\n\tcase SSH_ERR_KEY_CERT_UNKNOWN_TYPE:\n\t\treturn \"unknown/unsupported certificate type\";\n\tcase SSH_ERR_KEY_CERT_INVALID_SIGN_KEY:\n\t\treturn \"invalid certificate signing key\";\n\tcase SSH_ERR_KEY_INVALID_EC_VALUE:\n\t\treturn \"invalid elliptic curve value\";\n\tcase SSH_ERR_SIGNATURE_INVALID:\n\t\treturn \"incorrect signature\";\n\tcase SSH_ERR_LIBCRYPTO_ERROR:\n\t\treturn \"error in libcrypto\";  /* XXX fetch and return */\n\tcase SSH_ERR_UNEXPECTED_TRAILING_DATA:\n\t\treturn \"unexpected bytes remain after decoding\";\n\tcase SSH_ERR_SYSTEM_ERROR:\n\t\treturn strerror(errno);\n\tcase SSH_ERR_KEY_CERT_INVALID:\n\t\treturn \"invalid certificate\";\n\tcase SSH_ERR_AGENT_COMMUNICATION:\n\t\treturn \"communication with agent failed\";\n\tcase SSH_ERR_AGENT_FAILURE:\n\t\treturn \"agent refused operation\";\n\tcase SSH_ERR_DH_GEX_OUT_OF_RANGE:\n\t\treturn \"DH GEX group out of range\";\n\tcase SSH_ERR_DISCONNECTED:\n\t\treturn \"disconnected\";\n\tcase SSH_ERR_MAC_INVALID:\n\t\treturn \"message authentication code incorrect\";\n\tcase SSH_ERR_NO_CIPHER_ALG_MATCH:\n\t\treturn \"no matching cipher found\";\n\tcase SSH_ERR_NO_MAC_ALG_MATCH:\n\t\treturn \"no matching MAC found\";\n\tcase SSH_ERR_NO_COMPRESS_ALG_MATCH:\n\t\treturn \"no matching compression method found\";\n\tcase SSH_ERR_NO_KEX_ALG_MATCH:\n\t\treturn \"no matching key exchange method found\";\n\tcase SSH_ERR_NO_HOSTKEY_ALG_MATCH:\n\t\treturn \"no matching host key type found\";\n\tcase SSH_ERR_PROTOCOL_MISMATCH:\n\t\treturn \"protocol version mismatch\";\n\tcase SSH_ERR_NO_PROTOCOL_VERSION:\n\t\treturn \"could not read protocol version\";\n\tcase SSH_ERR_NO_HOSTKEY_LOADED:\n\t\treturn \"could not load host key\";\n\tcase SSH_ERR_NEED_REKEY:\n\t\treturn \"rekeying not supported by peer\";\n\tcase SSH_ERR_PASSPHRASE_TOO_SHORT:\n\t\treturn \"passphrase is too short (minimum five characters)\";\n\tcase SSH_ERR_FILE_CHANGED:\n\t\treturn \"file changed while reading\";\n\tcase SSH_ERR_KEY_UNKNOWN_CIPHER:\n\t\treturn \"key encrypted using unsupported cipher\";\n\tcase SSH_ERR_KEY_WRONG_PASSPHRASE:\n\t\treturn \"incorrect passphrase supplied to decrypt private key\";\n\tcase SSH_ERR_KEY_BAD_PERMISSIONS:\n\t\treturn \"bad permissions\";\n\tcase SSH_ERR_KEY_CERT_MISMATCH:\n\t\treturn \"certificate does not match key\";\n\tcase SSH_ERR_KEY_NOT_FOUND:\n\t\treturn \"key not found\";\n\tcase SSH_ERR_AGENT_NOT_PRESENT:\n\t\treturn \"agent not present\";\n\tcase SSH_ERR_AGENT_NO_IDENTITIES:\n\t\treturn \"agent contains no identities\";\n\tcase SSH_ERR_BUFFER_READ_ONLY:\n\t\treturn \"internal error: buffer is read-only\";\n\tcase SSH_ERR_KRL_BAD_MAGIC:\n\t\treturn \"KRL file has invalid magic number\";\n\tcase SSH_ERR_KEY_REVOKED:\n\t\treturn \"Key is revoked\";\n\tcase SSH_ERR_CONN_CLOSED:\n\t\treturn \"Connection closed\";\n\tcase SSH_ERR_CONN_TIMEOUT:\n\t\treturn \"Connection timed out\";\n\tcase SSH_ERR_CONN_CORRUPT:\n\t\treturn \"Connection corrupted\";\n\tcase SSH_ERR_PROTOCOL_ERROR:\n\t\treturn \"Protocol error\";\n\tcase SSH_ERR_KEY_LENGTH:\n\t\treturn \"Invalid key length\";\n\tcase SSH_ERR_NUMBER_TOO_LARGE:\n\t\treturn \"number is too large\";\n\tcase SSH_ERR_SIGN_ALG_UNSUPPORTED:\n\t\treturn \"signature algorithm not supported\";\n\tdefault:\n\t\treturn \"unknown error\";\n\t}\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <errno.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include <string.h>\n#include <errno.h>\n\nconst char *\nssh_err(int n)\n{\n\tswitch (n) {\n\tcase SSH_ERR_SUCCESS:\n\t\treturn \"success\";\n\tcase SSH_ERR_INTERNAL_ERROR:\n\t\treturn \"unexpected internal error\";\n\tcase SSH_ERR_ALLOC_FAIL:\n\t\treturn \"memory allocation failed\";\n\tcase SSH_ERR_MESSAGE_INCOMPLETE:\n\t\treturn \"incomplete message\";\n\tcase SSH_ERR_INVALID_FORMAT:\n\t\treturn \"invalid format\";\n\tcase SSH_ERR_BIGNUM_IS_NEGATIVE:\n\t\treturn \"bignum is negative\";\n\tcase SSH_ERR_STRING_TOO_LARGE:\n\t\treturn \"string is too large\";\n\tcase SSH_ERR_BIGNUM_TOO_LARGE:\n\t\treturn \"bignum is too large\";\n\tcase SSH_ERR_ECPOINT_TOO_LARGE:\n\t\treturn \"elliptic curve point is too large\";\n\tcase SSH_ERR_NO_BUFFER_SPACE:\n\t\treturn \"insufficient buffer space\";\n\tcase SSH_ERR_INVALID_ARGUMENT:\n\t\treturn \"invalid argument\";\n\tcase SSH_ERR_KEY_BITS_MISMATCH:\n\t\treturn \"key bits do not match\";\n\tcase SSH_ERR_EC_CURVE_INVALID:\n\t\treturn \"invalid elliptic curve\";\n\tcase SSH_ERR_KEY_TYPE_MISMATCH:\n\t\treturn \"key type does not match\";\n\tcase SSH_ERR_KEY_TYPE_UNKNOWN:\n\t\treturn \"unknown or unsupported key type\";\n\tcase SSH_ERR_EC_CURVE_MISMATCH:\n\t\treturn \"elliptic curve does not match\";\n\tcase SSH_ERR_EXPECTED_CERT:\n\t\treturn \"plain key provided where certificate required\";\n\tcase SSH_ERR_KEY_LACKS_CERTBLOB:\n\t\treturn \"key lacks certificate data\";\n\tcase SSH_ERR_KEY_CERT_UNKNOWN_TYPE:\n\t\treturn \"unknown/unsupported certificate type\";\n\tcase SSH_ERR_KEY_CERT_INVALID_SIGN_KEY:\n\t\treturn \"invalid certificate signing key\";\n\tcase SSH_ERR_KEY_INVALID_EC_VALUE:\n\t\treturn \"invalid elliptic curve value\";\n\tcase SSH_ERR_SIGNATURE_INVALID:\n\t\treturn \"incorrect signature\";\n\tcase SSH_ERR_LIBCRYPTO_ERROR:\n\t\treturn \"error in libcrypto\";  /* XXX fetch and return */\n\tcase SSH_ERR_UNEXPECTED_TRAILING_DATA:\n\t\treturn \"unexpected bytes remain after decoding\";\n\tcase SSH_ERR_SYSTEM_ERROR:\n\t\treturn strerror(errno);\n\tcase SSH_ERR_KEY_CERT_INVALID:\n\t\treturn \"invalid certificate\";\n\tcase SSH_ERR_AGENT_COMMUNICATION:\n\t\treturn \"communication with agent failed\";\n\tcase SSH_ERR_AGENT_FAILURE:\n\t\treturn \"agent refused operation\";\n\tcase SSH_ERR_DH_GEX_OUT_OF_RANGE:\n\t\treturn \"DH GEX group out of range\";\n\tcase SSH_ERR_DISCONNECTED:\n\t\treturn \"disconnected\";\n\tcase SSH_ERR_MAC_INVALID:\n\t\treturn \"message authentication code incorrect\";\n\tcase SSH_ERR_NO_CIPHER_ALG_MATCH:\n\t\treturn \"no matching cipher found\";\n\tcase SSH_ERR_NO_MAC_ALG_MATCH:\n\t\treturn \"no matching MAC found\";\n\tcase SSH_ERR_NO_COMPRESS_ALG_MATCH:\n\t\treturn \"no matching compression method found\";\n\tcase SSH_ERR_NO_KEX_ALG_MATCH:\n\t\treturn \"no matching key exchange method found\";\n\tcase SSH_ERR_NO_HOSTKEY_ALG_MATCH:\n\t\treturn \"no matching host key type found\";\n\tcase SSH_ERR_PROTOCOL_MISMATCH:\n\t\treturn \"protocol version mismatch\";\n\tcase SSH_ERR_NO_PROTOCOL_VERSION:\n\t\treturn \"could not read protocol version\";\n\tcase SSH_ERR_NO_HOSTKEY_LOADED:\n\t\treturn \"could not load host key\";\n\tcase SSH_ERR_NEED_REKEY:\n\t\treturn \"rekeying not supported by peer\";\n\tcase SSH_ERR_PASSPHRASE_TOO_SHORT:\n\t\treturn \"passphrase is too short (minimum five characters)\";\n\tcase SSH_ERR_FILE_CHANGED:\n\t\treturn \"file changed while reading\";\n\tcase SSH_ERR_KEY_UNKNOWN_CIPHER:\n\t\treturn \"key encrypted using unsupported cipher\";\n\tcase SSH_ERR_KEY_WRONG_PASSPHRASE:\n\t\treturn \"incorrect passphrase supplied to decrypt private key\";\n\tcase SSH_ERR_KEY_BAD_PERMISSIONS:\n\t\treturn \"bad permissions\";\n\tcase SSH_ERR_KEY_CERT_MISMATCH:\n\t\treturn \"certificate does not match key\";\n\tcase SSH_ERR_KEY_NOT_FOUND:\n\t\treturn \"key not found\";\n\tcase SSH_ERR_AGENT_NOT_PRESENT:\n\t\treturn \"agent not present\";\n\tcase SSH_ERR_AGENT_NO_IDENTITIES:\n\t\treturn \"agent contains no identities\";\n\tcase SSH_ERR_BUFFER_READ_ONLY:\n\t\treturn \"internal error: buffer is read-only\";\n\tcase SSH_ERR_KRL_BAD_MAGIC:\n\t\treturn \"KRL file has invalid magic number\";\n\tcase SSH_ERR_KEY_REVOKED:\n\t\treturn \"Key is revoked\";\n\tcase SSH_ERR_CONN_CLOSED:\n\t\treturn \"Connection closed\";\n\tcase SSH_ERR_CONN_TIMEOUT:\n\t\treturn \"Connection timed out\";\n\tcase SSH_ERR_CONN_CORRUPT:\n\t\treturn \"Connection corrupted\";\n\tcase SSH_ERR_PROTOCOL_ERROR:\n\t\treturn \"Protocol error\";\n\tcase SSH_ERR_KEY_LENGTH:\n\t\treturn \"Invalid key length\";\n\tcase SSH_ERR_NUMBER_TOO_LARGE:\n\t\treturn \"number is too large\";\n\tcase SSH_ERR_SIGN_ALG_UNSUPPORTED:\n\t\treturn \"signature algorithm not supported\";\n\tdefault:\n\t\treturn \"unknown error\";\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_get_u32",
          "args": [
            "b",
            "&count"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_get_u32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "57-68",
          "snippet": "int\nsshbuf_get_u32(struct sshbuf *buf, u_int32_t *valp)\n{\n\tconst u_char *p = sshbuf_ptr(buf);\n\tint r;\n\n\tif ((r = sshbuf_consume(buf, 4)) < 0)\n\t\treturn r;\n\tif (valp != NULL)\n\t\t*valp = PEEK_U32(p);\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_get_u32(struct sshbuf *buf, u_int32_t *valp)\n{\n\tconst u_char *p = sshbuf_ptr(buf);\n\tint r;\n\n\tif ((r = sshbuf_consume(buf, 4)) < 0)\n\t\treturn r;\n\tif (valp != NULL)\n\t\t*valp = PEEK_U32(p);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_get_u64",
          "args": [
            "b",
            "&a->size"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_get_u64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "44-55",
          "snippet": "int\nsshbuf_get_u64(struct sshbuf *buf, u_int64_t *valp)\n{\n\tconst u_char *p = sshbuf_ptr(buf);\n\tint r;\n\n\tif ((r = sshbuf_consume(buf, 8)) < 0)\n\t\treturn r;\n\tif (valp != NULL)\n\t\t*valp = PEEK_U64(p);\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_get_u64(struct sshbuf *buf, u_int64_t *valp)\n{\n\tconst u_char *p = sshbuf_ptr(buf);\n\tint r;\n\n\tif ((r = sshbuf_consume(buf, 8)) < 0)\n\t\treturn r;\n\tif (valp != NULL)\n\t\t*valp = PEEK_U64(p);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "attrib_clear",
          "args": [
            "a"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "attrib_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-common.c",
          "lines": "53-63",
          "snippet": "void\nattrib_clear(Attrib *a)\n{\n\ta->flags = 0;\n\ta->size = 0;\n\ta->uid = 0;\n\ta->gid = 0;\n\ta->perm = 0;\n\ta->atime = 0;\n\ta->mtime = 0;\n}",
          "includes": [
            "#include \"sftp-common.h\"",
            "#include \"sftp.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <util.h>",
            "#include <stdarg.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <util.h>\n#include <stdarg.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <grp.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nattrib_clear(Attrib *a)\n{\n\ta->flags = 0;\n\ta->size = 0;\n\ta->uid = 0;\n\ta->gid = 0;\n\ta->perm = 0;\n\ta->atime = 0;\n\ta->mtime = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <util.h>\n#include <stdarg.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <grp.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\ndecode_attrib(struct sshbuf *b, Attrib *a)\n{\n\tint r;\n\n\tattrib_clear(a);\n\tif ((r = sshbuf_get_u32(b, &a->flags)) != 0)\n\t\treturn r;\n\tif (a->flags & SSH2_FILEXFER_ATTR_SIZE) {\n\t\tif ((r = sshbuf_get_u64(b, &a->size)) != 0)\n\t\t\treturn r;\n\t}\n\tif (a->flags & SSH2_FILEXFER_ATTR_UIDGID) {\n\t\tif ((r = sshbuf_get_u32(b, &a->uid)) != 0 ||\n\t\t    (r = sshbuf_get_u32(b, &a->gid)) != 0)\n\t\t\treturn r;\n\t}\n\tif (a->flags & SSH2_FILEXFER_ATTR_PERMISSIONS) {\n\t\tif ((r = sshbuf_get_u32(b, &a->perm)) != 0)\n\t\t\treturn r;\n\t}\n\tif (a->flags & SSH2_FILEXFER_ATTR_ACMODTIME) {\n\t\tif ((r = sshbuf_get_u32(b, &a->atime)) != 0 ||\n\t\t    (r = sshbuf_get_u32(b, &a->mtime)) != 0)\n\t\t\treturn r;\n\t}\n\t/* vendor-specific extensions */\n\tif (a->flags & SSH2_FILEXFER_ATTR_EXTENDED) {\n\t\tchar *type;\n\t\tu_char *data;\n\t\tsize_t dlen;\n\t\tu_int i, count;\n\n\t\tif ((r = sshbuf_get_u32(b, &count)) != 0)\n\t\t\tfatal(\"%s: buffer error: %s\", __func__, ssh_err(r));\n\t\tfor (i = 0; i < count; i++) {\n\t\t\tif ((r = sshbuf_get_cstring(b, &type, NULL)) != 0 ||\n\t\t\t    (r = sshbuf_get_string(b, &data, &dlen)) != 0)\n\t\t\t\treturn r;\n\t\t\tdebug3(\"Got file attribute \\\"%.100s\\\" len %zu\",\n\t\t\t    type, dlen);\n\t\t\tfree(type);\n\t\t\tfree(data);\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "attrib_to_stat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-common.c",
    "lines": "84-101",
    "snippet": "void\nattrib_to_stat(const Attrib *a, struct stat *st)\n{\n\tmemset(st, 0, sizeof(*st));\n\n\tif (a->flags & SSH2_FILEXFER_ATTR_SIZE)\n\t\tst->st_size = a->size;\n\tif (a->flags & SSH2_FILEXFER_ATTR_UIDGID) {\n\t\tst->st_uid = a->uid;\n\t\tst->st_gid = a->gid;\n\t}\n\tif (a->flags & SSH2_FILEXFER_ATTR_PERMISSIONS)\n\t\tst->st_mode = a->perm;\n\tif (a->flags & SSH2_FILEXFER_ATTR_ACMODTIME) {\n\t\tst->st_atime = a->atime;\n\t\tst->st_mtime = a->mtime;\n\t}\n}",
    "includes": [
      "#include \"sftp-common.h\"",
      "#include \"sftp.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <util.h>",
      "#include <stdarg.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pwd.h>",
      "#include <grp.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "st",
            "0",
            "sizeof(*st)"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <util.h>\n#include <stdarg.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <grp.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nattrib_to_stat(const Attrib *a, struct stat *st)\n{\n\tmemset(st, 0, sizeof(*st));\n\n\tif (a->flags & SSH2_FILEXFER_ATTR_SIZE)\n\t\tst->st_size = a->size;\n\tif (a->flags & SSH2_FILEXFER_ATTR_UIDGID) {\n\t\tst->st_uid = a->uid;\n\t\tst->st_gid = a->gid;\n\t}\n\tif (a->flags & SSH2_FILEXFER_ATTR_PERMISSIONS)\n\t\tst->st_mode = a->perm;\n\tif (a->flags & SSH2_FILEXFER_ATTR_ACMODTIME) {\n\t\tst->st_atime = a->atime;\n\t\tst->st_mtime = a->mtime;\n\t}\n}"
  },
  {
    "function_name": "stat_to_attrib",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-common.c",
    "lines": "66-81",
    "snippet": "void\nstat_to_attrib(const struct stat *st, Attrib *a)\n{\n\tattrib_clear(a);\n\ta->flags = 0;\n\ta->flags |= SSH2_FILEXFER_ATTR_SIZE;\n\ta->size = st->st_size;\n\ta->flags |= SSH2_FILEXFER_ATTR_UIDGID;\n\ta->uid = st->st_uid;\n\ta->gid = st->st_gid;\n\ta->flags |= SSH2_FILEXFER_ATTR_PERMISSIONS;\n\ta->perm = st->st_mode;\n\ta->flags |= SSH2_FILEXFER_ATTR_ACMODTIME;\n\ta->atime = st->st_atime;\n\ta->mtime = st->st_mtime;\n}",
    "includes": [
      "#include \"sftp-common.h\"",
      "#include \"sftp.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <util.h>",
      "#include <stdarg.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pwd.h>",
      "#include <grp.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "attrib_clear",
          "args": [
            "a"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "attrib_clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-common.c",
          "lines": "53-63",
          "snippet": "void\nattrib_clear(Attrib *a)\n{\n\ta->flags = 0;\n\ta->size = 0;\n\ta->uid = 0;\n\ta->gid = 0;\n\ta->perm = 0;\n\ta->atime = 0;\n\ta->mtime = 0;\n}",
          "includes": [
            "#include \"sftp-common.h\"",
            "#include \"sftp.h\"",
            "#include \"misc.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <util.h>",
            "#include <stdarg.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <grp.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <util.h>\n#include <stdarg.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <grp.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nattrib_clear(Attrib *a)\n{\n\ta->flags = 0;\n\ta->size = 0;\n\ta->uid = 0;\n\ta->gid = 0;\n\ta->perm = 0;\n\ta->atime = 0;\n\ta->mtime = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <util.h>\n#include <stdarg.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <grp.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nstat_to_attrib(const struct stat *st, Attrib *a)\n{\n\tattrib_clear(a);\n\ta->flags = 0;\n\ta->flags |= SSH2_FILEXFER_ATTR_SIZE;\n\ta->size = st->st_size;\n\ta->flags |= SSH2_FILEXFER_ATTR_UIDGID;\n\ta->uid = st->st_uid;\n\ta->gid = st->st_gid;\n\ta->flags |= SSH2_FILEXFER_ATTR_PERMISSIONS;\n\ta->perm = st->st_mode;\n\ta->flags |= SSH2_FILEXFER_ATTR_ACMODTIME;\n\ta->atime = st->st_atime;\n\ta->mtime = st->st_mtime;\n}"
  },
  {
    "function_name": "attrib_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sftp-common.c",
    "lines": "53-63",
    "snippet": "void\nattrib_clear(Attrib *a)\n{\n\ta->flags = 0;\n\ta->size = 0;\n\ta->uid = 0;\n\ta->gid = 0;\n\ta->perm = 0;\n\ta->atime = 0;\n\ta->mtime = 0;\n}",
    "includes": [
      "#include \"sftp-common.h\"",
      "#include \"sftp.h\"",
      "#include \"misc.h\"",
      "#include \"log.h\"",
      "#include \"sshbuf.h\"",
      "#include \"ssherr.h\"",
      "#include \"xmalloc.h\"",
      "#include <util.h>",
      "#include <stdarg.h>",
      "#include <time.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pwd.h>",
      "#include <grp.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sftp-common.h\"\n#include \"sftp.h\"\n#include \"misc.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <util.h>\n#include <stdarg.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <grp.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nattrib_clear(Attrib *a)\n{\n\ta->flags = 0;\n\ta->size = 0;\n\ta->uid = 0;\n\ta->gid = 0;\n\ta->perm = 0;\n\ta->atime = 0;\n\ta->mtime = 0;\n}"
  }
]