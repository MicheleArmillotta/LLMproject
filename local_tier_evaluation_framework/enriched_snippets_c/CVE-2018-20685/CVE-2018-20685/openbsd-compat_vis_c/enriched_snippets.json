[
  {
    "function_name": "strvisx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/vis.c",
    "lines": "235-249",
    "snippet": "int\nstrvisx(char *dst, const char *src, size_t len, int flag)\n{\n\tchar c;\n\tchar *start;\n\n\tfor (start = dst; len > 1; len--) {\n\t\tc = *src;\n\t\tdst = vis(dst, c, flag, *++src);\n\t}\n\tif (len)\n\t\tdst = vis(dst, *src, flag, '\\0');\n\t*dst = '\\0';\n\treturn (dst - start);\n}",
    "includes": [
      "#include \"vis.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <limits.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vis",
          "args": [
            "dst",
            "*src",
            "flag",
            "'\\0'"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "strvisx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/vis.c",
          "lines": "235-249",
          "snippet": "int\nstrvisx(char *dst, const char *src, size_t len, int flag)\n{\n\tchar c;\n\tchar *start;\n\n\tfor (start = dst; len > 1; len--) {\n\t\tc = *src;\n\t\tdst = vis(dst, c, flag, *++src);\n\t}\n\tif (len)\n\t\tdst = vis(dst, *src, flag, '\\0');\n\t*dst = '\\0';\n\treturn (dst - start);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"vis.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <limits.h>\n#include <ctype.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nstrvisx(char *dst, const char *src, size_t len, int flag)\n{\n\tchar c;\n\tchar *start;\n\n\tfor (start = dst; len > 1; len--) {\n\t\tc = *src;\n\t\tdst = vis(dst, c, flag, *++src);\n\t}\n\tif (len)\n\t\tdst = vis(dst, *src, flag, '\\0');\n\t*dst = '\\0';\n\treturn (dst - start);\n}"
  },
  {
    "function_name": "stravis",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/vis.c",
    "lines": "216-233",
    "snippet": "int\nstravis(char **outp, const char *src, int flag)\n{\n\tchar *buf;\n\tint len, serrno;\n\n\tbuf = reallocarray(NULL, 4, strlen(src) + 1);\n\tif (buf == NULL)\n\t\treturn -1;\n\tlen = strvis(buf, src, flag);\n\tserrno = errno;\n\t*outp = realloc(buf, len + 1);\n\tif (*outp == NULL) {\n\t\t*outp = buf;\n\t\terrno = serrno;\n\t}\n\treturn (len);\n}",
    "includes": [
      "#include \"vis.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <limits.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "realloc",
          "args": [
            "buf",
            "len + 1"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "rpl_realloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/bsd-malloc.c",
          "lines": "48-56",
          "snippet": "void *\nrpl_realloc(void *ptr, size_t size)\n{\n\tif (size == 0)\n\t\tsize = 1;\n\tif (ptr == 0)\n\t\treturn malloc(size);\n\treturn realloc(ptr, size);\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <sys/types.h>\n#include \"config.h\"\n\nvoid *\nrpl_realloc(void *ptr, size_t size)\n{\n\tif (size == 0)\n\t\tsize = 1;\n\tif (ptr == 0)\n\t\treturn malloc(size);\n\treturn realloc(ptr, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strvis",
          "args": [
            "buf",
            "src",
            "flag"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "strvis",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/vis.c",
          "lines": "160-170",
          "snippet": "int\nstrvis(char *dst, const char *src, int flag)\n{\n\tchar c;\n\tchar *start;\n\n\tfor (start = dst; (c = *src);)\n\t\tdst = vis(dst, c, flag, *++src);\n\t*dst = '\\0';\n\treturn (dst - start);\n}",
          "includes": [
            "#include \"vis.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vis.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <limits.h>\n#include <ctype.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nstrvis(char *dst, const char *src, int flag)\n{\n\tchar c;\n\tchar *start;\n\n\tfor (start = dst; (c = *src);)\n\t\tdst = vis(dst, c, flag, *++src);\n\t*dst = '\\0';\n\treturn (dst - start);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reallocarray",
          "args": [
            "NULL",
            "4",
            "strlen(src) + 1"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "reallocarray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/reallocarray.c",
          "lines": "36-45",
          "snippet": "void *\nreallocarray(void *optr, size_t nmemb, size_t size)\n{\n\tif ((nmemb >= MUL_NO_OVERFLOW || size >= MUL_NO_OVERFLOW) &&\n\t    nmemb > 0 && SIZE_MAX / nmemb < size) {\n\t\terrno = ENOMEM;\n\t\treturn NULL;\n\t}\n\treturn realloc(optr, size * nmemb);\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define MUL_NO_OVERFLOW\t((size_t)1 << (sizeof(size_t) * 4))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <stdint.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define MUL_NO_OVERFLOW\t((size_t)1 << (sizeof(size_t) * 4))\n\nvoid *\nreallocarray(void *optr, size_t nmemb, size_t size)\n{\n\tif ((nmemb >= MUL_NO_OVERFLOW || size >= MUL_NO_OVERFLOW) &&\n\t    nmemb > 0 && SIZE_MAX / nmemb < size) {\n\t\terrno = ENOMEM;\n\t\treturn NULL;\n\t}\n\treturn realloc(optr, size * nmemb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "src"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vis.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <limits.h>\n#include <ctype.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nstravis(char **outp, const char *src, int flag)\n{\n\tchar *buf;\n\tint len, serrno;\n\n\tbuf = reallocarray(NULL, 4, strlen(src) + 1);\n\tif (buf == NULL)\n\t\treturn -1;\n\tlen = strvis(buf, src, flag);\n\tserrno = errno;\n\t*outp = realloc(buf, len + 1);\n\tif (*outp == NULL) {\n\t\t*outp = buf;\n\t\terrno = serrno;\n\t}\n\treturn (len);\n}"
  },
  {
    "function_name": "strnvis",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/vis.c",
    "lines": "173-214",
    "snippet": "int\nstrnvis(char *dst, const char *src, size_t siz, int flag)\n{\n\tchar *start, *end;\n\tchar tbuf[5];\n\tint c, i;\n\n\ti = 0;\n\tfor (start = dst, end = start + siz - 1; (c = *src) && dst < end; ) {\n\t\tif (isvisible(c, flag)) {\n\t\t\tif ((c == '\"' && (flag & VIS_DQ) != 0) ||\n\t\t\t    (c == '\\\\' && (flag & VIS_NOSLASH) == 0)) {\n\t\t\t\t/* need space for the extra '\\\\' */\n\t\t\t\tif (dst + 1 >= end) {\n\t\t\t\t\ti = 2;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t*dst++ = '\\\\';\n\t\t\t}\n\t\t\ti = 1;\n\t\t\t*dst++ = c;\n\t\t\tsrc++;\n\t\t} else {\n\t\t\ti = vis(tbuf, c, flag, *++src) - tbuf;\n\t\t\tif (dst + i <= end) {\n\t\t\t\tmemcpy(dst, tbuf, i);\n\t\t\t\tdst += i;\n\t\t\t} else {\n\t\t\t\tsrc--;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tif (siz > 0)\n\t\t*dst = '\\0';\n\tif (dst + i > end) {\n\t\t/* adjust return value for truncation */\n\t\twhile ((c = *src))\n\t\t\tdst += vis(tbuf, c, flag, *++src) - tbuf;\n\t}\n\treturn (dst - start);\n}",
    "includes": [
      "#include \"vis.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <limits.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vis",
          "args": [
            "tbuf",
            "c",
            "flag",
            "*++src"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "strvisx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/vis.c",
          "lines": "235-249",
          "snippet": "int\nstrvisx(char *dst, const char *src, size_t len, int flag)\n{\n\tchar c;\n\tchar *start;\n\n\tfor (start = dst; len > 1; len--) {\n\t\tc = *src;\n\t\tdst = vis(dst, c, flag, *++src);\n\t}\n\tif (len)\n\t\tdst = vis(dst, *src, flag, '\\0');\n\t*dst = '\\0';\n\treturn (dst - start);\n}",
          "includes": [
            "#include \"vis.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vis.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <limits.h>\n#include <ctype.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nstrvisx(char *dst, const char *src, size_t len, int flag)\n{\n\tchar c;\n\tchar *start;\n\n\tfor (start = dst; len > 1; len--) {\n\t\tc = *src;\n\t\tdst = vis(dst, c, flag, *++src);\n\t}\n\tif (len)\n\t\tdst = vis(dst, *src, flag, '\\0');\n\t*dst = '\\0';\n\treturn (dst - start);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dst",
            "tbuf",
            "i"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isvisible",
          "args": [
            "c",
            "flag"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vis.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <limits.h>\n#include <ctype.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nstrnvis(char *dst, const char *src, size_t siz, int flag)\n{\n\tchar *start, *end;\n\tchar tbuf[5];\n\tint c, i;\n\n\ti = 0;\n\tfor (start = dst, end = start + siz - 1; (c = *src) && dst < end; ) {\n\t\tif (isvisible(c, flag)) {\n\t\t\tif ((c == '\"' && (flag & VIS_DQ) != 0) ||\n\t\t\t    (c == '\\\\' && (flag & VIS_NOSLASH) == 0)) {\n\t\t\t\t/* need space for the extra '\\\\' */\n\t\t\t\tif (dst + 1 >= end) {\n\t\t\t\t\ti = 2;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t*dst++ = '\\\\';\n\t\t\t}\n\t\t\ti = 1;\n\t\t\t*dst++ = c;\n\t\t\tsrc++;\n\t\t} else {\n\t\t\ti = vis(tbuf, c, flag, *++src) - tbuf;\n\t\t\tif (dst + i <= end) {\n\t\t\t\tmemcpy(dst, tbuf, i);\n\t\t\t\tdst += i;\n\t\t\t} else {\n\t\t\t\tsrc--;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tif (siz > 0)\n\t\t*dst = '\\0';\n\tif (dst + i > end) {\n\t\t/* adjust return value for truncation */\n\t\twhile ((c = *src))\n\t\t\tdst += vis(tbuf, c, flag, *++src) - tbuf;\n\t}\n\treturn (dst - start);\n}"
  },
  {
    "function_name": "strvis",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/vis.c",
    "lines": "160-170",
    "snippet": "int\nstrvis(char *dst, const char *src, int flag)\n{\n\tchar c;\n\tchar *start;\n\n\tfor (start = dst; (c = *src);)\n\t\tdst = vis(dst, c, flag, *++src);\n\t*dst = '\\0';\n\treturn (dst - start);\n}",
    "includes": [
      "#include \"vis.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <limits.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vis",
          "args": [
            "dst",
            "c",
            "flag",
            "*++src"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "strvisx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/vis.c",
          "lines": "235-249",
          "snippet": "int\nstrvisx(char *dst, const char *src, size_t len, int flag)\n{\n\tchar c;\n\tchar *start;\n\n\tfor (start = dst; len > 1; len--) {\n\t\tc = *src;\n\t\tdst = vis(dst, c, flag, *++src);\n\t}\n\tif (len)\n\t\tdst = vis(dst, *src, flag, '\\0');\n\t*dst = '\\0';\n\treturn (dst - start);\n}",
          "includes": [
            "#include \"vis.h\"",
            "#include <stdlib.h>",
            "#include <string.h>",
            "#include <limits.h>",
            "#include <ctype.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vis.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <limits.h>\n#include <ctype.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nstrvisx(char *dst, const char *src, size_t len, int flag)\n{\n\tchar c;\n\tchar *start;\n\n\tfor (start = dst; len > 1; len--) {\n\t\tc = *src;\n\t\tdst = vis(dst, c, flag, *++src);\n\t}\n\tif (len)\n\t\tdst = vis(dst, *src, flag, '\\0');\n\t*dst = '\\0';\n\treturn (dst - start);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vis.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <limits.h>\n#include <ctype.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nstrvis(char *dst, const char *src, int flag)\n{\n\tchar c;\n\tchar *start;\n\n\tfor (start = dst; (c = *src);)\n\t\tdst = vis(dst, c, flag, *++src);\n\t*dst = '\\0';\n\treturn (dst - start);\n}"
  },
  {
    "function_name": "vis",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/vis.c",
    "lines": "61-144",
    "snippet": "char *\nvis(char *dst, int c, int flag, int nextc)\n{\n\tif (isvisible(c, flag)) {\n\t\tif ((c == '\"' && (flag & VIS_DQ) != 0) ||\n\t\t    (c == '\\\\' && (flag & VIS_NOSLASH) == 0))\n\t\t\t*dst++ = '\\\\';\n\t\t*dst++ = c;\n\t\t*dst = '\\0';\n\t\treturn (dst);\n\t}\n\n\tif (flag & VIS_CSTYLE) {\n\t\tswitch(c) {\n\t\tcase '\\n':\n\t\t\t*dst++ = '\\\\';\n\t\t\t*dst++ = 'n';\n\t\t\tgoto done;\n\t\tcase '\\r':\n\t\t\t*dst++ = '\\\\';\n\t\t\t*dst++ = 'r';\n\t\t\tgoto done;\n\t\tcase '\\b':\n\t\t\t*dst++ = '\\\\';\n\t\t\t*dst++ = 'b';\n\t\t\tgoto done;\n\t\tcase '\\a':\n\t\t\t*dst++ = '\\\\';\n\t\t\t*dst++ = 'a';\n\t\t\tgoto done;\n\t\tcase '\\v':\n\t\t\t*dst++ = '\\\\';\n\t\t\t*dst++ = 'v';\n\t\t\tgoto done;\n\t\tcase '\\t':\n\t\t\t*dst++ = '\\\\';\n\t\t\t*dst++ = 't';\n\t\t\tgoto done;\n\t\tcase '\\f':\n\t\t\t*dst++ = '\\\\';\n\t\t\t*dst++ = 'f';\n\t\t\tgoto done;\n\t\tcase ' ':\n\t\t\t*dst++ = '\\\\';\n\t\t\t*dst++ = 's';\n\t\t\tgoto done;\n\t\tcase '\\0':\n\t\t\t*dst++ = '\\\\';\n\t\t\t*dst++ = '0';\n\t\t\tif (isoctal(nextc)) {\n\t\t\t\t*dst++ = '0';\n\t\t\t\t*dst++ = '0';\n\t\t\t}\n\t\t\tgoto done;\n\t\t}\n\t}\n\tif (((c & 0177) == ' ') || (flag & VIS_OCTAL) ||\n\t    ((flag & VIS_GLOB) && (c == '*' || c == '?' || c == '[' || c == '#'))) {\n\t\t*dst++ = '\\\\';\n\t\t*dst++ = ((u_char)c >> 6 & 07) + '0';\n\t\t*dst++ = ((u_char)c >> 3 & 07) + '0';\n\t\t*dst++ = ((u_char)c & 07) + '0';\n\t\tgoto done;\n\t}\n\tif ((flag & VIS_NOSLASH) == 0)\n\t\t*dst++ = '\\\\';\n\tif (c & 0200) {\n\t\tc &= 0177;\n\t\t*dst++ = 'M';\n\t}\n\tif (iscntrl((u_char)c)) {\n\t\t*dst++ = '^';\n\t\tif (c == 0177)\n\t\t\t*dst++ = '?';\n\t\telse\n\t\t\t*dst++ = c + '@';\n\t} else {\n\t\t*dst++ = '-';\n\t\t*dst++ = c;\n\t}\ndone:\n\t*dst = '\\0';\n\treturn (dst);\n}",
    "includes": [
      "#include \"vis.h\"",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include <limits.h>",
      "#include <ctype.h>",
      "#include <errno.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iscntrl",
          "args": [
            "(u_char)c"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isoctal",
          "args": [
            "nextc"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isvisible",
          "args": [
            "c",
            "flag"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vis.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <limits.h>\n#include <ctype.h>\n#include <errno.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nchar *\nvis(char *dst, int c, int flag, int nextc)\n{\n\tif (isvisible(c, flag)) {\n\t\tif ((c == '\"' && (flag & VIS_DQ) != 0) ||\n\t\t    (c == '\\\\' && (flag & VIS_NOSLASH) == 0))\n\t\t\t*dst++ = '\\\\';\n\t\t*dst++ = c;\n\t\t*dst = '\\0';\n\t\treturn (dst);\n\t}\n\n\tif (flag & VIS_CSTYLE) {\n\t\tswitch(c) {\n\t\tcase '\\n':\n\t\t\t*dst++ = '\\\\';\n\t\t\t*dst++ = 'n';\n\t\t\tgoto done;\n\t\tcase '\\r':\n\t\t\t*dst++ = '\\\\';\n\t\t\t*dst++ = 'r';\n\t\t\tgoto done;\n\t\tcase '\\b':\n\t\t\t*dst++ = '\\\\';\n\t\t\t*dst++ = 'b';\n\t\t\tgoto done;\n\t\tcase '\\a':\n\t\t\t*dst++ = '\\\\';\n\t\t\t*dst++ = 'a';\n\t\t\tgoto done;\n\t\tcase '\\v':\n\t\t\t*dst++ = '\\\\';\n\t\t\t*dst++ = 'v';\n\t\t\tgoto done;\n\t\tcase '\\t':\n\t\t\t*dst++ = '\\\\';\n\t\t\t*dst++ = 't';\n\t\t\tgoto done;\n\t\tcase '\\f':\n\t\t\t*dst++ = '\\\\';\n\t\t\t*dst++ = 'f';\n\t\t\tgoto done;\n\t\tcase ' ':\n\t\t\t*dst++ = '\\\\';\n\t\t\t*dst++ = 's';\n\t\t\tgoto done;\n\t\tcase '\\0':\n\t\t\t*dst++ = '\\\\';\n\t\t\t*dst++ = '0';\n\t\t\tif (isoctal(nextc)) {\n\t\t\t\t*dst++ = '0';\n\t\t\t\t*dst++ = '0';\n\t\t\t}\n\t\t\tgoto done;\n\t\t}\n\t}\n\tif (((c & 0177) == ' ') || (flag & VIS_OCTAL) ||\n\t    ((flag & VIS_GLOB) && (c == '*' || c == '?' || c == '[' || c == '#'))) {\n\t\t*dst++ = '\\\\';\n\t\t*dst++ = ((u_char)c >> 6 & 07) + '0';\n\t\t*dst++ = ((u_char)c >> 3 & 07) + '0';\n\t\t*dst++ = ((u_char)c & 07) + '0';\n\t\tgoto done;\n\t}\n\tif ((flag & VIS_NOSLASH) == 0)\n\t\t*dst++ = '\\\\';\n\tif (c & 0200) {\n\t\tc &= 0177;\n\t\t*dst++ = 'M';\n\t}\n\tif (iscntrl((u_char)c)) {\n\t\t*dst++ = '^';\n\t\tif (c == 0177)\n\t\t\t*dst++ = '?';\n\t\telse\n\t\t\t*dst++ = c + '@';\n\t} else {\n\t\t*dst++ = '-';\n\t\t*dst++ = c;\n\t}\ndone:\n\t*dst = '\\0';\n\treturn (dst);\n}"
  }
]