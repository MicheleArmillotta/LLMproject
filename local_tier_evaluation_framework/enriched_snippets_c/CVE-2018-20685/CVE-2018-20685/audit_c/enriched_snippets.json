[
  {
    "function_name": "audit_run_command",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/audit.c",
    "lines": "177-182",
    "snippet": "void\naudit_run_command(const char *command)\n{\n\tdebug(\"audit run command euid %d user %s command '%.200s'\", geteuid(),\n\t    audit_username(), command);\n}",
    "includes": [
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"log.h\"",
      "#include \"audit.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"audit run command euid %d user %s command '%.200s'\"",
            "geteuid()",
            "audit_username()",
            "command"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "audit_username",
          "args": [],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "audit_username",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/audit.c",
          "lines": "69-80",
          "snippet": "const char *\naudit_username(void)\n{\n\tstatic const char unknownuser[] = \"(unknown user)\";\n\tstatic const char invaliduser[] = \"(invalid user)\";\n\n\tif (the_authctxt == NULL || the_authctxt->user == NULL)\n\t\treturn (unknownuser);\n\tif (!the_authctxt->valid)\n\t\treturn (invaliduser);\n\treturn (the_authctxt->user);\n}",
          "includes": [
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"log.h\"",
            "#include \"audit.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"log.h\"\n#include \"audit.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nconst char *\naudit_username(void)\n{\n\tstatic const char unknownuser[] = \"(unknown user)\";\n\tstatic const char invaliduser[] = \"(invalid user)\";\n\n\tif (the_authctxt == NULL || the_authctxt->user == NULL)\n\t\treturn (unknownuser);\n\tif (!the_authctxt->valid)\n\t\treturn (invaliduser);\n\treturn (the_authctxt->user);\n}"
        }
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"log.h\"\n#include \"audit.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid\naudit_run_command(const char *command)\n{\n\tdebug(\"audit run command euid %d user %s command '%.200s'\", geteuid(),\n\t    audit_username(), command);\n}"
  },
  {
    "function_name": "audit_session_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/audit.c",
    "lines": "163-170",
    "snippet": "void\naudit_session_close(struct logininfo *li)\n{\n\tconst char *t = li->line ? li->line : \"(no tty)\";\n\n\tdebug(\"audit session close euid %d user %s tty name %s\", geteuid(),\n\t    audit_username(), t);\n}",
    "includes": [
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"log.h\"",
      "#include \"audit.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"audit session close euid %d user %s tty name %s\"",
            "geteuid()",
            "audit_username()",
            "t"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "audit_username",
          "args": [],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "audit_username",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/audit.c",
          "lines": "69-80",
          "snippet": "const char *\naudit_username(void)\n{\n\tstatic const char unknownuser[] = \"(unknown user)\";\n\tstatic const char invaliduser[] = \"(invalid user)\";\n\n\tif (the_authctxt == NULL || the_authctxt->user == NULL)\n\t\treturn (unknownuser);\n\tif (!the_authctxt->valid)\n\t\treturn (invaliduser);\n\treturn (the_authctxt->user);\n}",
          "includes": [
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"log.h\"",
            "#include \"audit.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"log.h\"\n#include \"audit.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nconst char *\naudit_username(void)\n{\n\tstatic const char unknownuser[] = \"(unknown user)\";\n\tstatic const char invaliduser[] = \"(invalid user)\";\n\n\tif (the_authctxt == NULL || the_authctxt->user == NULL)\n\t\treturn (unknownuser);\n\tif (!the_authctxt->valid)\n\t\treturn (invaliduser);\n\treturn (the_authctxt->user);\n}"
        }
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"log.h\"\n#include \"audit.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid\naudit_session_close(struct logininfo *li)\n{\n\tconst char *t = li->line ? li->line : \"(no tty)\";\n\n\tdebug(\"audit session close euid %d user %s tty name %s\", geteuid(),\n\t    audit_username(), t);\n}"
  },
  {
    "function_name": "audit_session_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/audit.c",
    "lines": "147-154",
    "snippet": "void\naudit_session_open(struct logininfo *li)\n{\n\tconst char *t = li->line ? li->line : \"(no tty)\";\n\n\tdebug(\"audit session open euid %d user %s tty name %s\", geteuid(),\n\t    audit_username(), t);\n}",
    "includes": [
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"log.h\"",
      "#include \"audit.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"audit session open euid %d user %s tty name %s\"",
            "geteuid()",
            "audit_username()",
            "t"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "audit_username",
          "args": [],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "audit_username",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/audit.c",
          "lines": "69-80",
          "snippet": "const char *\naudit_username(void)\n{\n\tstatic const char unknownuser[] = \"(unknown user)\";\n\tstatic const char invaliduser[] = \"(invalid user)\";\n\n\tif (the_authctxt == NULL || the_authctxt->user == NULL)\n\t\treturn (unknownuser);\n\tif (!the_authctxt->valid)\n\t\treturn (invaliduser);\n\treturn (the_authctxt->user);\n}",
          "includes": [
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"log.h\"",
            "#include \"audit.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"log.h\"\n#include \"audit.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nconst char *\naudit_username(void)\n{\n\tstatic const char unknownuser[] = \"(unknown user)\";\n\tstatic const char invaliduser[] = \"(invalid user)\";\n\n\tif (the_authctxt == NULL || the_authctxt->user == NULL)\n\t\treturn (unknownuser);\n\tif (!the_authctxt->valid)\n\t\treturn (invaliduser);\n\treturn (the_authctxt->user);\n}"
        }
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"log.h\"\n#include \"audit.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid\naudit_session_open(struct logininfo *li)\n{\n\tconst char *t = li->line ? li->line : \"(no tty)\";\n\n\tdebug(\"audit session open euid %d user %s tty name %s\", geteuid(),\n\t    audit_username(), t);\n}"
  },
  {
    "function_name": "audit_event",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/audit.c",
    "lines": "133-138",
    "snippet": "void\naudit_event(ssh_audit_event_t event)\n{\n\tdebug(\"audit event euid %d user %s event %d (%s)\", geteuid(),\n\t    audit_username(), event, audit_event_lookup(event));\n}",
    "includes": [
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"log.h\"",
      "#include \"audit.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"audit event euid %d user %s event %d (%s)\"",
            "geteuid()",
            "audit_username()",
            "event",
            "audit_event_lookup(event)"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "audit_event_lookup",
          "args": [
            "event"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "audit_event_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/audit.c",
          "lines": "82-110",
          "snippet": "const char *\naudit_event_lookup(ssh_audit_event_t ev)\n{\n\tint i;\n\tstatic struct event_lookup_struct {\n\t\tssh_audit_event_t event;\n\t\tconst char *name;\n\t} event_lookup[] = {\n\t\t{SSH_LOGIN_EXCEED_MAXTRIES,\t\"LOGIN_EXCEED_MAXTRIES\"},\n\t\t{SSH_LOGIN_ROOT_DENIED,\t\t\"LOGIN_ROOT_DENIED\"},\n\t\t{SSH_AUTH_SUCCESS,\t\t\"AUTH_SUCCESS\"},\n\t\t{SSH_AUTH_FAIL_NONE,\t\t\"AUTH_FAIL_NONE\"},\n\t\t{SSH_AUTH_FAIL_PASSWD,\t\t\"AUTH_FAIL_PASSWD\"},\n\t\t{SSH_AUTH_FAIL_KBDINT,\t\t\"AUTH_FAIL_KBDINT\"},\n\t\t{SSH_AUTH_FAIL_PUBKEY,\t\t\"AUTH_FAIL_PUBKEY\"},\n\t\t{SSH_AUTH_FAIL_HOSTBASED,\t\"AUTH_FAIL_HOSTBASED\"},\n\t\t{SSH_AUTH_FAIL_GSSAPI,\t\t\"AUTH_FAIL_GSSAPI\"},\n\t\t{SSH_INVALID_USER,\t\t\"INVALID_USER\"},\n\t\t{SSH_NOLOGIN,\t\t\t\"NOLOGIN\"},\n\t\t{SSH_CONNECTION_CLOSE,\t\t\"CONNECTION_CLOSE\"},\n\t\t{SSH_CONNECTION_ABANDON,\t\"CONNECTION_ABANDON\"},\n\t\t{SSH_AUDIT_UNKNOWN,\t\t\"AUDIT_UNKNOWN\"}\n\t};\n\n\tfor (i = 0; event_lookup[i].event != SSH_AUDIT_UNKNOWN; i++)\n\t\tif (event_lookup[i].event == ev)\n\t\t\tbreak;\n\treturn(event_lookup[i].name);\n}",
          "includes": [
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"log.h\"",
            "#include \"audit.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"log.h\"\n#include \"audit.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nconst char *\naudit_event_lookup(ssh_audit_event_t ev)\n{\n\tint i;\n\tstatic struct event_lookup_struct {\n\t\tssh_audit_event_t event;\n\t\tconst char *name;\n\t} event_lookup[] = {\n\t\t{SSH_LOGIN_EXCEED_MAXTRIES,\t\"LOGIN_EXCEED_MAXTRIES\"},\n\t\t{SSH_LOGIN_ROOT_DENIED,\t\t\"LOGIN_ROOT_DENIED\"},\n\t\t{SSH_AUTH_SUCCESS,\t\t\"AUTH_SUCCESS\"},\n\t\t{SSH_AUTH_FAIL_NONE,\t\t\"AUTH_FAIL_NONE\"},\n\t\t{SSH_AUTH_FAIL_PASSWD,\t\t\"AUTH_FAIL_PASSWD\"},\n\t\t{SSH_AUTH_FAIL_KBDINT,\t\t\"AUTH_FAIL_KBDINT\"},\n\t\t{SSH_AUTH_FAIL_PUBKEY,\t\t\"AUTH_FAIL_PUBKEY\"},\n\t\t{SSH_AUTH_FAIL_HOSTBASED,\t\"AUTH_FAIL_HOSTBASED\"},\n\t\t{SSH_AUTH_FAIL_GSSAPI,\t\t\"AUTH_FAIL_GSSAPI\"},\n\t\t{SSH_INVALID_USER,\t\t\"INVALID_USER\"},\n\t\t{SSH_NOLOGIN,\t\t\t\"NOLOGIN\"},\n\t\t{SSH_CONNECTION_CLOSE,\t\t\"CONNECTION_CLOSE\"},\n\t\t{SSH_CONNECTION_ABANDON,\t\"CONNECTION_ABANDON\"},\n\t\t{SSH_AUDIT_UNKNOWN,\t\t\"AUDIT_UNKNOWN\"}\n\t};\n\n\tfor (i = 0; event_lookup[i].event != SSH_AUDIT_UNKNOWN; i++)\n\t\tif (event_lookup[i].event == ev)\n\t\t\tbreak;\n\treturn(event_lookup[i].name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "audit_username",
          "args": [],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "audit_username",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/audit.c",
          "lines": "69-80",
          "snippet": "const char *\naudit_username(void)\n{\n\tstatic const char unknownuser[] = \"(unknown user)\";\n\tstatic const char invaliduser[] = \"(invalid user)\";\n\n\tif (the_authctxt == NULL || the_authctxt->user == NULL)\n\t\treturn (unknownuser);\n\tif (!the_authctxt->valid)\n\t\treturn (invaliduser);\n\treturn (the_authctxt->user);\n}",
          "includes": [
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"log.h\"",
            "#include \"audit.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"log.h\"\n#include \"audit.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nconst char *\naudit_username(void)\n{\n\tstatic const char unknownuser[] = \"(unknown user)\";\n\tstatic const char invaliduser[] = \"(invalid user)\";\n\n\tif (the_authctxt == NULL || the_authctxt->user == NULL)\n\t\treturn (unknownuser);\n\tif (!the_authctxt->valid)\n\t\treturn (invaliduser);\n\treturn (the_authctxt->user);\n}"
        }
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"log.h\"\n#include \"audit.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid\naudit_event(ssh_audit_event_t event)\n{\n\tdebug(\"audit event euid %d user %s event %d (%s)\", geteuid(),\n\t    audit_username(), event, audit_event_lookup(event));\n}"
  },
  {
    "function_name": "audit_connection_from",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/audit.c",
    "lines": "122-127",
    "snippet": "void\naudit_connection_from(const char *host, int port)\n{\n\tdebug(\"audit connection from %s port %d euid %d\", host, port,\n\t    (int)geteuid());\n}",
    "includes": [
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"log.h\"",
      "#include \"audit.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"audit connection from %s port %d euid %d\"",
            "host",
            "port",
            "(int)geteuid()"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"log.h\"\n#include \"audit.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid\naudit_connection_from(const char *host, int port)\n{\n\tdebug(\"audit connection from %s port %d euid %d\", host, port,\n\t    (int)geteuid());\n}"
  },
  {
    "function_name": "audit_event_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/audit.c",
    "lines": "82-110",
    "snippet": "const char *\naudit_event_lookup(ssh_audit_event_t ev)\n{\n\tint i;\n\tstatic struct event_lookup_struct {\n\t\tssh_audit_event_t event;\n\t\tconst char *name;\n\t} event_lookup[] = {\n\t\t{SSH_LOGIN_EXCEED_MAXTRIES,\t\"LOGIN_EXCEED_MAXTRIES\"},\n\t\t{SSH_LOGIN_ROOT_DENIED,\t\t\"LOGIN_ROOT_DENIED\"},\n\t\t{SSH_AUTH_SUCCESS,\t\t\"AUTH_SUCCESS\"},\n\t\t{SSH_AUTH_FAIL_NONE,\t\t\"AUTH_FAIL_NONE\"},\n\t\t{SSH_AUTH_FAIL_PASSWD,\t\t\"AUTH_FAIL_PASSWD\"},\n\t\t{SSH_AUTH_FAIL_KBDINT,\t\t\"AUTH_FAIL_KBDINT\"},\n\t\t{SSH_AUTH_FAIL_PUBKEY,\t\t\"AUTH_FAIL_PUBKEY\"},\n\t\t{SSH_AUTH_FAIL_HOSTBASED,\t\"AUTH_FAIL_HOSTBASED\"},\n\t\t{SSH_AUTH_FAIL_GSSAPI,\t\t\"AUTH_FAIL_GSSAPI\"},\n\t\t{SSH_INVALID_USER,\t\t\"INVALID_USER\"},\n\t\t{SSH_NOLOGIN,\t\t\t\"NOLOGIN\"},\n\t\t{SSH_CONNECTION_CLOSE,\t\t\"CONNECTION_CLOSE\"},\n\t\t{SSH_CONNECTION_ABANDON,\t\"CONNECTION_ABANDON\"},\n\t\t{SSH_AUDIT_UNKNOWN,\t\t\"AUDIT_UNKNOWN\"}\n\t};\n\n\tfor (i = 0; event_lookup[i].event != SSH_AUDIT_UNKNOWN; i++)\n\t\tif (event_lookup[i].event == ev)\n\t\t\tbreak;\n\treturn(event_lookup[i].name);\n}",
    "includes": [
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"log.h\"",
      "#include \"audit.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"log.h\"\n#include \"audit.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nconst char *\naudit_event_lookup(ssh_audit_event_t ev)\n{\n\tint i;\n\tstatic struct event_lookup_struct {\n\t\tssh_audit_event_t event;\n\t\tconst char *name;\n\t} event_lookup[] = {\n\t\t{SSH_LOGIN_EXCEED_MAXTRIES,\t\"LOGIN_EXCEED_MAXTRIES\"},\n\t\t{SSH_LOGIN_ROOT_DENIED,\t\t\"LOGIN_ROOT_DENIED\"},\n\t\t{SSH_AUTH_SUCCESS,\t\t\"AUTH_SUCCESS\"},\n\t\t{SSH_AUTH_FAIL_NONE,\t\t\"AUTH_FAIL_NONE\"},\n\t\t{SSH_AUTH_FAIL_PASSWD,\t\t\"AUTH_FAIL_PASSWD\"},\n\t\t{SSH_AUTH_FAIL_KBDINT,\t\t\"AUTH_FAIL_KBDINT\"},\n\t\t{SSH_AUTH_FAIL_PUBKEY,\t\t\"AUTH_FAIL_PUBKEY\"},\n\t\t{SSH_AUTH_FAIL_HOSTBASED,\t\"AUTH_FAIL_HOSTBASED\"},\n\t\t{SSH_AUTH_FAIL_GSSAPI,\t\t\"AUTH_FAIL_GSSAPI\"},\n\t\t{SSH_INVALID_USER,\t\t\"INVALID_USER\"},\n\t\t{SSH_NOLOGIN,\t\t\t\"NOLOGIN\"},\n\t\t{SSH_CONNECTION_CLOSE,\t\t\"CONNECTION_CLOSE\"},\n\t\t{SSH_CONNECTION_ABANDON,\t\"CONNECTION_ABANDON\"},\n\t\t{SSH_AUDIT_UNKNOWN,\t\t\"AUDIT_UNKNOWN\"}\n\t};\n\n\tfor (i = 0; event_lookup[i].event != SSH_AUDIT_UNKNOWN; i++)\n\t\tif (event_lookup[i].event == ev)\n\t\t\tbreak;\n\treturn(event_lookup[i].name);\n}"
  },
  {
    "function_name": "audit_username",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/audit.c",
    "lines": "69-80",
    "snippet": "const char *\naudit_username(void)\n{\n\tstatic const char unknownuser[] = \"(unknown user)\";\n\tstatic const char invaliduser[] = \"(invalid user)\";\n\n\tif (the_authctxt == NULL || the_authctxt->user == NULL)\n\t\treturn (unknownuser);\n\tif (!the_authctxt->valid)\n\t\treturn (invaliduser);\n\treturn (the_authctxt->user);\n}",
    "includes": [
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"log.h\"",
      "#include \"audit.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"log.h\"\n#include \"audit.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nconst char *\naudit_username(void)\n{\n\tstatic const char unknownuser[] = \"(unknown user)\";\n\tstatic const char invaliduser[] = \"(invalid user)\";\n\n\tif (the_authctxt == NULL || the_authctxt->user == NULL)\n\t\treturn (unknownuser);\n\tif (!the_authctxt->valid)\n\t\treturn (invaliduser);\n\treturn (the_authctxt->user);\n}"
  },
  {
    "function_name": "audit_classify_auth",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/audit.c",
    "lines": "46-66",
    "snippet": "ssh_audit_event_t\naudit_classify_auth(const char *method)\n{\n\tif (strcmp(method, \"none\") == 0)\n\t\treturn SSH_AUTH_FAIL_NONE;\n\telse if (strcmp(method, \"password\") == 0)\n\t\treturn SSH_AUTH_FAIL_PASSWD;\n\telse if (strcmp(method, \"publickey\") == 0 ||\n\t    strcmp(method, \"rsa\") == 0)\n\t\treturn SSH_AUTH_FAIL_PUBKEY;\n\telse if (strncmp(method, \"keyboard-interactive\", 20) == 0 ||\n\t    strcmp(method, \"challenge-response\") == 0)\n\t\treturn SSH_AUTH_FAIL_KBDINT;\n\telse if (strcmp(method, \"hostbased\") == 0 ||\n\t    strcmp(method, \"rhosts-rsa\") == 0)\n\t\treturn SSH_AUTH_FAIL_HOSTBASED;\n\telse if (strcmp(method, \"gssapi-with-mic\") == 0)\n\t\treturn SSH_AUTH_FAIL_GSSAPI;\n\telse\n\t\treturn SSH_AUDIT_UNKNOWN;\n}",
    "includes": [
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"log.h\"",
      "#include \"audit.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "method",
            "\"gssapi-with-mic\""
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_maybe_null",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "1550-1558",
          "snippet": "static int\nstrcmp_maybe_null(const char *a, const char *b)\n{\n\tif ((a == NULL && b != NULL) || (a != NULL && b == NULL))\n\t\treturn 0;\n\tif (a != NULL && strcmp(a, b) != 0)\n\t\treturn 0;\n\treturn 1;\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic int\nstrcmp_maybe_null(const char *a, const char *b)\n{\n\tif ((a == NULL && b != NULL) || (a != NULL && b == NULL))\n\t\treturn 0;\n\tif (a != NULL && strcmp(a, b) != 0)\n\t\treturn 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "method",
            "\"keyboard-interactive\"",
            "20"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "g_strncmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/glob.c",
          "lines": "422-435",
          "snippet": "static int\ng_strncmp(const Char *s1, const char *s2, size_t n)\n{\n\tint rv = 0;\n\n\twhile (n--) {\n\t\trv = *(Char *)s1 - *(const unsigned char *)s2++;\n\t\tif (rv)\n\t\t\tbreak;\n\t\tif (*s1++ == '\\0')\n\t\t\tbreak;\n\t}\n\treturn rv;\n}",
          "includes": [
            "#include \"charclass.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <pwd.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <dirent.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"glob.h\"",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"charclass.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <pwd.h>\n#include <limits.h>\n#include <errno.h>\n#include <ctype.h>\n#include <dirent.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"glob.h\"\n#include \"includes.h\"\n\nstatic int\ng_strncmp(const Char *s1, const char *s2, size_t n)\n{\n\tint rv = 0;\n\n\twhile (n--) {\n\t\trv = *(Char *)s1 - *(const unsigned char *)s2++;\n\t\tif (rv)\n\t\t\tbreak;\n\t\tif (*s1++ == '\\0')\n\t\t\tbreak;\n\t}\n\treturn rv;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"log.h\"\n#include \"audit.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nssh_audit_event_t\naudit_classify_auth(const char *method)\n{\n\tif (strcmp(method, \"none\") == 0)\n\t\treturn SSH_AUTH_FAIL_NONE;\n\telse if (strcmp(method, \"password\") == 0)\n\t\treturn SSH_AUTH_FAIL_PASSWD;\n\telse if (strcmp(method, \"publickey\") == 0 ||\n\t    strcmp(method, \"rsa\") == 0)\n\t\treturn SSH_AUTH_FAIL_PUBKEY;\n\telse if (strncmp(method, \"keyboard-interactive\", 20) == 0 ||\n\t    strcmp(method, \"challenge-response\") == 0)\n\t\treturn SSH_AUTH_FAIL_KBDINT;\n\telse if (strcmp(method, \"hostbased\") == 0 ||\n\t    strcmp(method, \"rhosts-rsa\") == 0)\n\t\treturn SSH_AUTH_FAIL_HOSTBASED;\n\telse if (strcmp(method, \"gssapi-with-mic\") == 0)\n\t\treturn SSH_AUTH_FAIL_GSSAPI;\n\telse\n\t\treturn SSH_AUDIT_UNKNOWN;\n}"
  }
]