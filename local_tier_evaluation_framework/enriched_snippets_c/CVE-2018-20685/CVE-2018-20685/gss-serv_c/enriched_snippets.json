[
  {
    "function_name": "ssh_gssapi_displayname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
    "lines": "396-402",
    "snippet": "const char *ssh_gssapi_displayname(void)\n{\n\tif (gssapi_client.displayname.length == 0 ||\n\t    gssapi_client.displayname.value == NULL)\n\t\treturn NULL;\n\treturn (char *)gssapi_client.displayname.value;\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"servconf.h\"",
      "#include \"misc.h\"",
      "#include \"session.h\"",
      "#include \"channels.h\"",
      "#include \"log.h\"",
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"sshkey.h\"",
      "#include \"xmalloc.h\"",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst char *ssh_gssapi_displayname(void)\n{\n\tif (gssapi_client.displayname.length == 0 ||\n\t    gssapi_client.displayname.value == NULL)\n\t\treturn NULL;\n\treturn (char *)gssapi_client.displayname.value;\n}"
  },
  {
    "function_name": "ssh_gssapi_checkmic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
    "lines": "386-393",
    "snippet": "OM_uint32\nssh_gssapi_checkmic(Gssctxt *ctx, gss_buffer_t gssbuf, gss_buffer_t gssmic)\n{\n\tctx->major = gss_verify_mic(&ctx->minor, ctx->context,\n\t    gssbuf, gssmic, NULL);\n\n\treturn (ctx->major);\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"servconf.h\"",
      "#include \"misc.h\"",
      "#include \"session.h\"",
      "#include \"channels.h\"",
      "#include \"log.h\"",
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"sshkey.h\"",
      "#include \"xmalloc.h\"",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gss_verify_mic",
          "args": [
            "&ctx->minor",
            "ctx->context",
            "gssbuf",
            "gssmic",
            "NULL"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nOM_uint32\nssh_gssapi_checkmic(Gssctxt *ctx, gss_buffer_t gssbuf, gss_buffer_t gssmic)\n{\n\tctx->major = gss_verify_mic(&ctx->minor, ctx->context,\n\t    gssbuf, gssmic, NULL);\n\n\treturn (ctx->major);\n}"
  },
  {
    "function_name": "ssh_gssapi_userok",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
    "lines": "358-383",
    "snippet": "int\nssh_gssapi_userok(char *user)\n{\n\tOM_uint32 lmin;\n\n\tif (gssapi_client.exportedname.length == 0 ||\n\t    gssapi_client.exportedname.value == NULL) {\n\t\tdebug(\"No suitable client data\");\n\t\treturn 0;\n\t}\n\tif (gssapi_client.mech && gssapi_client.mech->userok)\n\t\tif ((*gssapi_client.mech->userok)(&gssapi_client, user))\n\t\t\treturn 1;\n\t\telse {\n\t\t\t/* Destroy delegated credentials if userok fails */\n\t\t\tgss_release_buffer(&lmin, &gssapi_client.displayname);\n\t\t\tgss_release_buffer(&lmin, &gssapi_client.exportedname);\n\t\t\tgss_release_cred(&lmin, &gssapi_client.creds);\n\t\t\texplicit_bzero(&gssapi_client,\n\t\t\t    sizeof(ssh_gssapi_client));\n\t\t\treturn 0;\n\t\t}\n\telse\n\t\tdebug(\"ssh_gssapi_userok: Unknown GSSAPI mechanism\");\n\treturn (0);\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"servconf.h\"",
      "#include \"misc.h\"",
      "#include \"session.h\"",
      "#include \"channels.h\"",
      "#include \"log.h\"",
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"sshkey.h\"",
      "#include \"xmalloc.h\"",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"ssh_gssapi_userok: Unknown GSSAPI mechanism\""
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "explicit_bzero",
          "args": [
            "&gssapi_client",
            "sizeof(ssh_gssapi_client)"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "explicit_bzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/explicit_bzero.c",
          "lines": "36-53",
          "snippet": "void\nexplicit_bzero(void *p, size_t n)\n{\n\tif (n == 0)\n\t\treturn;\n\t/*\n\t * clang -fsanitize=memory needs to intercept memset-like functions\n\t * to correctly detect memory initialisation. Make sure one is called\n\t * directly since our indirection trick above successfully confuses it.\n\t */\n#if defined(__has_feature)\n# if __has_feature(memory_sanitizer)\n\tmemset(p, 0, n);\n# endif\n#endif\n\n\tssh_bzero(p, n);\n}",
          "includes": [
            "#include <string.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"includes.h\"\n\nvoid\nexplicit_bzero(void *p, size_t n)\n{\n\tif (n == 0)\n\t\treturn;\n\t/*\n\t * clang -fsanitize=memory needs to intercept memset-like functions\n\t * to correctly detect memory initialisation. Make sure one is called\n\t * directly since our indirection trick above successfully confuses it.\n\t */\n#if defined(__has_feature)\n# if __has_feature(memory_sanitizer)\n\tmemset(p, 0, n);\n# endif\n#endif\n\n\tssh_bzero(p, n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gss_release_cred",
          "args": [
            "&lmin",
            "&gssapi_client.creds"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_release_buffer",
          "args": [
            "&lmin",
            "&gssapi_client.exportedname"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_release_buffer",
          "args": [
            "&lmin",
            "&gssapi_client.displayname"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "&gssapi_client",
            "user"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_gssapi_userok(char *user)\n{\n\tOM_uint32 lmin;\n\n\tif (gssapi_client.exportedname.length == 0 ||\n\t    gssapi_client.exportedname.value == NULL) {\n\t\tdebug(\"No suitable client data\");\n\t\treturn 0;\n\t}\n\tif (gssapi_client.mech && gssapi_client.mech->userok)\n\t\tif ((*gssapi_client.mech->userok)(&gssapi_client, user))\n\t\t\treturn 1;\n\t\telse {\n\t\t\t/* Destroy delegated credentials if userok fails */\n\t\t\tgss_release_buffer(&lmin, &gssapi_client.displayname);\n\t\t\tgss_release_buffer(&lmin, &gssapi_client.exportedname);\n\t\t\tgss_release_cred(&lmin, &gssapi_client.creds);\n\t\t\texplicit_bzero(&gssapi_client,\n\t\t\t    sizeof(ssh_gssapi_client));\n\t\t\treturn 0;\n\t\t}\n\telse\n\t\tdebug(\"ssh_gssapi_userok: Unknown GSSAPI mechanism\");\n\treturn (0);\n}"
  },
  {
    "function_name": "ssh_gssapi_do_child",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
    "lines": "344-355",
    "snippet": "void\nssh_gssapi_do_child(char ***envp, u_int *envsizep)\n{\n\n\tif (gssapi_client.store.envvar != NULL &&\n\t    gssapi_client.store.envval != NULL) {\n\t\tdebug(\"Setting %s to %s\", gssapi_client.store.envvar,\n\t\t    gssapi_client.store.envval);\n\t\tchild_set_env(envp, envsizep, gssapi_client.store.envvar,\n\t\t    gssapi_client.store.envval);\n\t}\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"servconf.h\"",
      "#include \"misc.h\"",
      "#include \"session.h\"",
      "#include \"channels.h\"",
      "#include \"log.h\"",
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"sshkey.h\"",
      "#include \"xmalloc.h\"",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "child_set_env",
          "args": [
            "envp",
            "envsizep",
            "gssapi_client.store.envvar",
            "gssapi_client.store.envval"
          ],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "child_set_env",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "1851-1905",
          "snippet": "void\nchild_set_env(char ***envp, u_int *envsizep, const char *name,\n\tconst char *value)\n{\n\tchar **env;\n\tu_int envsize;\n\tu_int i, namelen;\n\n\tif (strchr(name, '=') != NULL) {\n\t\terror(\"Invalid environment variable \\\"%.100s\\\"\", name);\n\t\treturn;\n\t}\n\n\t/*\n\t * If we're passed an uninitialized list, allocate a single null\n\t * entry before continuing.\n\t */\n\tif (*envp == NULL && *envsizep == 0) {\n\t\t*envp = xmalloc(sizeof(char *));\n\t\t*envp[0] = NULL;\n\t\t*envsizep = 1;\n\t}\n\n\t/*\n\t * Find the slot where the value should be stored.  If the variable\n\t * already exists, we reuse the slot; otherwise we append a new slot\n\t * at the end of the array, expanding if necessary.\n\t */\n\tenv = *envp;\n\tnamelen = strlen(name);\n\tfor (i = 0; env[i]; i++)\n\t\tif (strncmp(env[i], name, namelen) == 0 && env[i][namelen] == '=')\n\t\t\tbreak;\n\tif (env[i]) {\n\t\t/* Reuse the slot. */\n\t\tfree(env[i]);\n\t} else {\n\t\t/* New variable.  Expand if necessary. */\n\t\tenvsize = *envsizep;\n\t\tif (i >= envsize - 1) {\n\t\t\tif (envsize >= 1000)\n\t\t\t\tfatal(\"child_set_env: too many env vars\");\n\t\t\tenvsize += 50;\n\t\t\tenv = (*envp) = xreallocarray(env, envsize, sizeof(char *));\n\t\t\t*envsizep = envsize;\n\t\t}\n\t\t/* Need to set the NULL pointer at end of array beyond the new slot. */\n\t\tenv[i + 1] = NULL;\n\t}\n\n\t/* Allocate space and format the variable in the appropriate slot. */\n\t/* XXX xasprintf */\n\tenv[i] = xmalloc(strlen(name) + 1 + strlen(value) + 1);\n\tsnprintf(env[i], strlen(name) + 1 + strlen(value) + 1, \"%s=%s\", name, value);\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nchild_set_env(char ***envp, u_int *envsizep, const char *name,\n\tconst char *value)\n{\n\tchar **env;\n\tu_int envsize;\n\tu_int i, namelen;\n\n\tif (strchr(name, '=') != NULL) {\n\t\terror(\"Invalid environment variable \\\"%.100s\\\"\", name);\n\t\treturn;\n\t}\n\n\t/*\n\t * If we're passed an uninitialized list, allocate a single null\n\t * entry before continuing.\n\t */\n\tif (*envp == NULL && *envsizep == 0) {\n\t\t*envp = xmalloc(sizeof(char *));\n\t\t*envp[0] = NULL;\n\t\t*envsizep = 1;\n\t}\n\n\t/*\n\t * Find the slot where the value should be stored.  If the variable\n\t * already exists, we reuse the slot; otherwise we append a new slot\n\t * at the end of the array, expanding if necessary.\n\t */\n\tenv = *envp;\n\tnamelen = strlen(name);\n\tfor (i = 0; env[i]; i++)\n\t\tif (strncmp(env[i], name, namelen) == 0 && env[i][namelen] == '=')\n\t\t\tbreak;\n\tif (env[i]) {\n\t\t/* Reuse the slot. */\n\t\tfree(env[i]);\n\t} else {\n\t\t/* New variable.  Expand if necessary. */\n\t\tenvsize = *envsizep;\n\t\tif (i >= envsize - 1) {\n\t\t\tif (envsize >= 1000)\n\t\t\t\tfatal(\"child_set_env: too many env vars\");\n\t\t\tenvsize += 50;\n\t\t\tenv = (*envp) = xreallocarray(env, envsize, sizeof(char *));\n\t\t\t*envsizep = envsize;\n\t\t}\n\t\t/* Need to set the NULL pointer at end of array beyond the new slot. */\n\t\tenv[i + 1] = NULL;\n\t}\n\n\t/* Allocate space and format the variable in the appropriate slot. */\n\t/* XXX xasprintf */\n\tenv[i] = xmalloc(strlen(name) + 1 + strlen(value) + 1);\n\tsnprintf(env[i], strlen(name) + 1 + strlen(value) + 1, \"%s=%s\", name, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"Setting %s to %s\"",
            "gssapi_client.store.envvar",
            "gssapi_client.store.envval"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_do_child(char ***envp, u_int *envsizep)\n{\n\n\tif (gssapi_client.store.envvar != NULL &&\n\t    gssapi_client.store.envval != NULL) {\n\t\tdebug(\"Setting %s to %s\", gssapi_client.store.envvar,\n\t\t    gssapi_client.store.envval);\n\t\tchild_set_env(envp, envsizep, gssapi_client.store.envvar,\n\t\t    gssapi_client.store.envval);\n\t}\n}"
  },
  {
    "function_name": "ssh_gssapi_storecreds",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
    "lines": "331-338",
    "snippet": "void\nssh_gssapi_storecreds(void)\n{\n\tif (gssapi_client.mech && gssapi_client.mech->storecreds) {\n\t\t(*gssapi_client.mech->storecreds)(&gssapi_client);\n\t} else\n\t\tdebug(\"ssh_gssapi_storecreds: Not a GSSAPI mechanism\");\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"servconf.h\"",
      "#include \"misc.h\"",
      "#include \"session.h\"",
      "#include \"channels.h\"",
      "#include \"log.h\"",
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"sshkey.h\"",
      "#include \"xmalloc.h\"",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"ssh_gssapi_storecreds: Not a GSSAPI mechanism\""
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "&gssapi_client"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_storecreds(void)\n{\n\tif (gssapi_client.mech && gssapi_client.mech->storecreds) {\n\t\t(*gssapi_client.mech->storecreds)(&gssapi_client);\n\t} else\n\t\tdebug(\"ssh_gssapi_storecreds: Not a GSSAPI mechanism\");\n}"
  },
  {
    "function_name": "ssh_gssapi_cleanup_creds",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
    "lines": "319-328",
    "snippet": "void\nssh_gssapi_cleanup_creds(void)\n{\n\tif (gssapi_client.store.filename != NULL) {\n\t\t/* Unlink probably isn't sufficient */\n\t\tdebug(\"removing gssapi cred file\\\"%s\\\"\",\n\t\t    gssapi_client.store.filename);\n\t\tunlink(gssapi_client.store.filename);\n\t}\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"servconf.h\"",
      "#include \"misc.h\"",
      "#include \"session.h\"",
      "#include \"channels.h\"",
      "#include \"log.h\"",
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"sshkey.h\"",
      "#include \"xmalloc.h\"",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "gssapi_client.store.filename"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"removing gssapi cred file\\\"%s\\\"\"",
            "gssapi_client.store.filename"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_cleanup_creds(void)\n{\n\tif (gssapi_client.store.filename != NULL) {\n\t\t/* Unlink probably isn't sufficient */\n\t\tdebug(\"removing gssapi cred file\\\"%s\\\"\",\n\t\t    gssapi_client.store.filename);\n\t\tunlink(gssapi_client.store.filename);\n\t}\n}"
  },
  {
    "function_name": "ssh_gssapi_getclient",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
    "lines": "275-316",
    "snippet": "OM_uint32\nssh_gssapi_getclient(Gssctxt *ctx, ssh_gssapi_client *client)\n{\n\tint i = 0;\n\n\tgss_buffer_desc ename;\n\n\tclient->mech = NULL;\n\n\twhile (supported_mechs[i]->name != NULL) {\n\t\tif (supported_mechs[i]->oid.length == ctx->oid->length &&\n\t\t    (memcmp(supported_mechs[i]->oid.elements,\n\t\t    ctx->oid->elements, ctx->oid->length) == 0))\n\t\t\tclient->mech = supported_mechs[i];\n\t\ti++;\n\t}\n\n\tif (client->mech == NULL)\n\t\treturn GSS_S_FAILURE;\n\n\tif ((ctx->major = gss_display_name(&ctx->minor, ctx->client,\n\t    &client->displayname, NULL))) {\n\t\tssh_gssapi_error(ctx);\n\t\treturn (ctx->major);\n\t}\n\n\tif ((ctx->major = gss_export_name(&ctx->minor, ctx->client,\n\t    &ename))) {\n\t\tssh_gssapi_error(ctx);\n\t\treturn (ctx->major);\n\t}\n\n\tif ((ctx->major = ssh_gssapi_parse_ename(ctx,&ename,\n\t    &client->exportedname))) {\n\t\treturn (ctx->major);\n\t}\n\n\t/* We can't copy this structure, so we just move the pointer to it */\n\tclient->creds = ctx->client_creds;\n\tctx->client_creds = GSS_C_NO_CREDENTIAL;\n\treturn (ctx->major);\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"servconf.h\"",
      "#include \"misc.h\"",
      "#include \"session.h\"",
      "#include \"channels.h\"",
      "#include \"log.h\"",
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"sshkey.h\"",
      "#include \"xmalloc.h\"",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_gssapi_parse_ename",
          "args": [
            "ctx",
            "&ename",
            "&client->exportedname"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_parse_ename",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
          "lines": "215-269",
          "snippet": "static OM_uint32\nssh_gssapi_parse_ename(Gssctxt *ctx, gss_buffer_t ename, gss_buffer_t name)\n{\n\tu_char *tok;\n\tOM_uint32 offset;\n\tOM_uint32 oidl;\n\n\ttok = ename->value;\n\n\t/*\n\t * Check that ename is long enough for all of the fixed length\n\t * header, and that the initial ID bytes are correct\n\t */\n\n\tif (ename->length < 6 || memcmp(tok, \"\\x04\\x01\", 2) != 0)\n\t\treturn GSS_S_FAILURE;\n\n\t/*\n\t * Extract the OID, and check it. Here GSSAPI breaks with tradition\n\t * and does use the OID type and length bytes. To confuse things\n\t * there are two lengths - the first including these, and the\n\t * second without.\n\t */\n\n\toidl = get_u16(tok+2); /* length including next two bytes */\n\toidl = oidl-2; /* turn it into the _real_ length of the variable OID */\n\n\t/*\n\t * Check the BER encoding for correct type and length, that the\n\t * string is long enough and that the OID matches that in our context\n\t */\n\tif (tok[4] != 0x06 || tok[5] != oidl ||\n\t    ename->length < oidl+6 ||\n\t    !ssh_gssapi_check_oid(ctx, tok+6, oidl))\n\t\treturn GSS_S_FAILURE;\n\n\toffset = oidl+6;\n\n\tif (ename->length < offset+4)\n\t\treturn GSS_S_FAILURE;\n\n\tname->length = get_u32(tok+offset);\n\toffset += 4;\n\n\tif (UINT_MAX - offset < name->length)\n\t\treturn GSS_S_FAILURE;\n\tif (ename->length < offset+name->length)\n\t\treturn GSS_S_FAILURE;\n\n\tname->value = xmalloc(name->length+1);\n\tmemcpy(name->value, tok+offset, name->length);\n\t((char *)name->value)[name->length] = 0;\n\n\treturn GSS_S_COMPLETE;\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"servconf.h\"",
            "#include \"misc.h\"",
            "#include \"session.h\"",
            "#include \"channels.h\"",
            "#include \"log.h\"",
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic OM_uint32\nssh_gssapi_parse_ename(Gssctxt *ctx, gss_buffer_t ename, gss_buffer_t name)\n{\n\tu_char *tok;\n\tOM_uint32 offset;\n\tOM_uint32 oidl;\n\n\ttok = ename->value;\n\n\t/*\n\t * Check that ename is long enough for all of the fixed length\n\t * header, and that the initial ID bytes are correct\n\t */\n\n\tif (ename->length < 6 || memcmp(tok, \"\\x04\\x01\", 2) != 0)\n\t\treturn GSS_S_FAILURE;\n\n\t/*\n\t * Extract the OID, and check it. Here GSSAPI breaks with tradition\n\t * and does use the OID type and length bytes. To confuse things\n\t * there are two lengths - the first including these, and the\n\t * second without.\n\t */\n\n\toidl = get_u16(tok+2); /* length including next two bytes */\n\toidl = oidl-2; /* turn it into the _real_ length of the variable OID */\n\n\t/*\n\t * Check the BER encoding for correct type and length, that the\n\t * string is long enough and that the OID matches that in our context\n\t */\n\tif (tok[4] != 0x06 || tok[5] != oidl ||\n\t    ename->length < oidl+6 ||\n\t    !ssh_gssapi_check_oid(ctx, tok+6, oidl))\n\t\treturn GSS_S_FAILURE;\n\n\toffset = oidl+6;\n\n\tif (ename->length < offset+4)\n\t\treturn GSS_S_FAILURE;\n\n\tname->length = get_u32(tok+offset);\n\toffset += 4;\n\n\tif (UINT_MAX - offset < name->length)\n\t\treturn GSS_S_FAILURE;\n\tif (ename->length < offset+name->length)\n\t\treturn GSS_S_FAILURE;\n\n\tname->value = xmalloc(name->length+1);\n\tmemcpy(name->value, tok+offset, name->length);\n\t((char *)name->value)[name->length] = 0;\n\n\treturn GSS_S_COMPLETE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_gssapi_error",
          "args": [
            "ctx"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
          "lines": "96-104",
          "snippet": "void\nssh_gssapi_error(Gssctxt *ctxt)\n{\n\tchar *s;\n\n\ts = ssh_gssapi_last_error(ctxt, NULL, NULL);\n\tdebug(\"%s\", s);\n\tfree(s);\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"ssh2.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_error(Gssctxt *ctxt)\n{\n\tchar *s;\n\n\ts = ssh_gssapi_last_error(ctxt, NULL, NULL);\n\tdebug(\"%s\", s);\n\tfree(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gss_export_name",
          "args": [
            "&ctx->minor",
            "ctx->client",
            "&ename"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_display_name",
          "args": [
            "&ctx->minor",
            "ctx->client",
            "&client->displayname",
            "NULL"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "supported_mechs[i]->oid.elements",
            "ctx->oid->elements",
            "ctx->oid->length"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nOM_uint32\nssh_gssapi_getclient(Gssctxt *ctx, ssh_gssapi_client *client)\n{\n\tint i = 0;\n\n\tgss_buffer_desc ename;\n\n\tclient->mech = NULL;\n\n\twhile (supported_mechs[i]->name != NULL) {\n\t\tif (supported_mechs[i]->oid.length == ctx->oid->length &&\n\t\t    (memcmp(supported_mechs[i]->oid.elements,\n\t\t    ctx->oid->elements, ctx->oid->length) == 0))\n\t\t\tclient->mech = supported_mechs[i];\n\t\ti++;\n\t}\n\n\tif (client->mech == NULL)\n\t\treturn GSS_S_FAILURE;\n\n\tif ((ctx->major = gss_display_name(&ctx->minor, ctx->client,\n\t    &client->displayname, NULL))) {\n\t\tssh_gssapi_error(ctx);\n\t\treturn (ctx->major);\n\t}\n\n\tif ((ctx->major = gss_export_name(&ctx->minor, ctx->client,\n\t    &ename))) {\n\t\tssh_gssapi_error(ctx);\n\t\treturn (ctx->major);\n\t}\n\n\tif ((ctx->major = ssh_gssapi_parse_ename(ctx,&ename,\n\t    &client->exportedname))) {\n\t\treturn (ctx->major);\n\t}\n\n\t/* We can't copy this structure, so we just move the pointer to it */\n\tclient->creds = ctx->client_creds;\n\tctx->client_creds = GSS_C_NO_CREDENTIAL;\n\treturn (ctx->major);\n}"
  },
  {
    "function_name": "ssh_gssapi_parse_ename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
    "lines": "215-269",
    "snippet": "static OM_uint32\nssh_gssapi_parse_ename(Gssctxt *ctx, gss_buffer_t ename, gss_buffer_t name)\n{\n\tu_char *tok;\n\tOM_uint32 offset;\n\tOM_uint32 oidl;\n\n\ttok = ename->value;\n\n\t/*\n\t * Check that ename is long enough for all of the fixed length\n\t * header, and that the initial ID bytes are correct\n\t */\n\n\tif (ename->length < 6 || memcmp(tok, \"\\x04\\x01\", 2) != 0)\n\t\treturn GSS_S_FAILURE;\n\n\t/*\n\t * Extract the OID, and check it. Here GSSAPI breaks with tradition\n\t * and does use the OID type and length bytes. To confuse things\n\t * there are two lengths - the first including these, and the\n\t * second without.\n\t */\n\n\toidl = get_u16(tok+2); /* length including next two bytes */\n\toidl = oidl-2; /* turn it into the _real_ length of the variable OID */\n\n\t/*\n\t * Check the BER encoding for correct type and length, that the\n\t * string is long enough and that the OID matches that in our context\n\t */\n\tif (tok[4] != 0x06 || tok[5] != oidl ||\n\t    ename->length < oidl+6 ||\n\t    !ssh_gssapi_check_oid(ctx, tok+6, oidl))\n\t\treturn GSS_S_FAILURE;\n\n\toffset = oidl+6;\n\n\tif (ename->length < offset+4)\n\t\treturn GSS_S_FAILURE;\n\n\tname->length = get_u32(tok+offset);\n\toffset += 4;\n\n\tif (UINT_MAX - offset < name->length)\n\t\treturn GSS_S_FAILURE;\n\tif (ename->length < offset+name->length)\n\t\treturn GSS_S_FAILURE;\n\n\tname->value = xmalloc(name->length+1);\n\tmemcpy(name->value, tok+offset, name->length);\n\t((char *)name->value)[name->length] = 0;\n\n\treturn GSS_S_COMPLETE;\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"servconf.h\"",
      "#include \"misc.h\"",
      "#include \"session.h\"",
      "#include \"channels.h\"",
      "#include \"log.h\"",
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"sshkey.h\"",
      "#include \"xmalloc.h\"",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "name->value",
            "tok+offset",
            "name->length"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmalloc",
          "args": [
            "name->length+1"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "xmalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/xmalloc.c",
          "lines": "39-50",
          "snippet": "void *\nxmalloc(size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0)\n\t\tfatal(\"xmalloc: zero size\");\n\tptr = malloc(size);\n\tif (ptr == NULL)\n\t\tfatal(\"xmalloc: out of memory (allocating %zu bytes)\", size);\n\treturn ptr;\n}",
          "includes": [
            "#include \"log.h\"",
            "#include \"xmalloc.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <stdarg.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include \"xmalloc.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <stdarg.h>\n#include \"includes.h\"\n\nvoid *\nxmalloc(size_t size)\n{\n\tvoid *ptr;\n\n\tif (size == 0)\n\t\tfatal(\"xmalloc: zero size\");\n\tptr = malloc(size);\n\tif (ptr == NULL)\n\t\tfatal(\"xmalloc: out of memory (allocating %zu bytes)\", size);\n\treturn ptr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_u32",
          "args": [
            "tok+offset"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "get_u32_le",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "1183-1195",
          "snippet": "u_int32_t\nget_u32_le(const void *vp)\n{\n\tconst u_char *p = (const u_char *)vp;\n\tu_int32_t v;\n\n\tv  = (u_int32_t)p[0];\n\tv |= (u_int32_t)p[1] << 8;\n\tv |= (u_int32_t)p[2] << 16;\n\tv |= (u_int32_t)p[3] << 24;\n\n\treturn (v);\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nu_int32_t\nget_u32_le(const void *vp)\n{\n\tconst u_char *p = (const u_char *)vp;\n\tu_int32_t v;\n\n\tv  = (u_int32_t)p[0];\n\tv |= (u_int32_t)p[1] << 8;\n\tv |= (u_int32_t)p[2] << 16;\n\tv |= (u_int32_t)p[3] << 24;\n\n\treturn (v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_gssapi_check_oid",
          "args": [
            "ctx",
            "tok+6",
            "oidl"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_check_oid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
          "lines": "66-72",
          "snippet": "int\nssh_gssapi_check_oid(Gssctxt *ctx, void *data, size_t len)\n{\n\treturn (ctx != NULL && ctx->oid != GSS_C_NO_OID &&\n\t    ctx->oid->length == len &&\n\t    memcmp(ctx->oid->elements, data, len) == 0);\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"ssh2.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nssh_gssapi_check_oid(Gssctxt *ctx, void *data, size_t len)\n{\n\treturn (ctx != NULL && ctx->oid != GSS_C_NO_OID &&\n\t    ctx->oid->length == len &&\n\t    memcmp(ctx->oid->elements, data, len) == 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_u16",
          "args": [
            "tok+2"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "get_u16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/misc.c",
          "lines": "1197-1207",
          "snippet": "u_int16_t\nget_u16(const void *vp)\n{\n\tconst u_char *p = (const u_char *)vp;\n\tu_int16_t v;\n\n\tv  = (u_int16_t)p[0] << 8;\n\tv |= (u_int16_t)p[1];\n\n\treturn (v);\n}",
          "includes": [
            "#include \"platform.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"log.h\"",
            "#include \"misc.h\"",
            "#include \"xmalloc.h\"",
            "#include <net/if.h>",
            "#include <pwd.h>",
            "# include <paths.h>",
            "#include <netdb.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <ctype.h>",
            "#include <arpa/inet.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <libgen.h>",
            "#include <limits.h>",
            "#include <sys/un.h>",
            "#include <sys/wait.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/socket.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"platform.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"log.h\"\n#include \"misc.h\"\n#include \"xmalloc.h\"\n#include <net/if.h>\n#include <pwd.h>\n# include <paths.h>\n#include <netdb.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <ctype.h>\n#include <arpa/inet.h>\n#include <netinet/tcp.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <unistd.h>\n#include <time.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <libgen.h>\n#include <limits.h>\n#include <sys/un.h>\n#include <sys/wait.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/socket.h>\n#include <sys/ioctl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nu_int16_t\nget_u16(const void *vp)\n{\n\tconst u_char *p = (const u_char *)vp;\n\tu_int16_t v;\n\n\tv  = (u_int16_t)p[0] << 8;\n\tv |= (u_int16_t)p[1];\n\n\treturn (v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "tok",
            "\"\\x04\\x01\"",
            "2"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic OM_uint32\nssh_gssapi_parse_ename(Gssctxt *ctx, gss_buffer_t ename, gss_buffer_t name)\n{\n\tu_char *tok;\n\tOM_uint32 offset;\n\tOM_uint32 oidl;\n\n\ttok = ename->value;\n\n\t/*\n\t * Check that ename is long enough for all of the fixed length\n\t * header, and that the initial ID bytes are correct\n\t */\n\n\tif (ename->length < 6 || memcmp(tok, \"\\x04\\x01\", 2) != 0)\n\t\treturn GSS_S_FAILURE;\n\n\t/*\n\t * Extract the OID, and check it. Here GSSAPI breaks with tradition\n\t * and does use the OID type and length bytes. To confuse things\n\t * there are two lengths - the first including these, and the\n\t * second without.\n\t */\n\n\toidl = get_u16(tok+2); /* length including next two bytes */\n\toidl = oidl-2; /* turn it into the _real_ length of the variable OID */\n\n\t/*\n\t * Check the BER encoding for correct type and length, that the\n\t * string is long enough and that the OID matches that in our context\n\t */\n\tif (tok[4] != 0x06 || tok[5] != oidl ||\n\t    ename->length < oidl+6 ||\n\t    !ssh_gssapi_check_oid(ctx, tok+6, oidl))\n\t\treturn GSS_S_FAILURE;\n\n\toffset = oidl+6;\n\n\tif (ename->length < offset+4)\n\t\treturn GSS_S_FAILURE;\n\n\tname->length = get_u32(tok+offset);\n\toffset += 4;\n\n\tif (UINT_MAX - offset < name->length)\n\t\treturn GSS_S_FAILURE;\n\tif (ename->length < offset+name->length)\n\t\treturn GSS_S_FAILURE;\n\n\tname->value = xmalloc(name->length+1);\n\tmemcpy(name->value, tok+offset, name->length);\n\t((char *)name->value)[name->length] = 0;\n\n\treturn GSS_S_COMPLETE;\n}"
  },
  {
    "function_name": "ssh_gssapi_accept_ctx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
    "lines": "175-208",
    "snippet": "OM_uint32\nssh_gssapi_accept_ctx(Gssctxt *ctx, gss_buffer_desc *recv_tok,\n    gss_buffer_desc *send_tok, OM_uint32 *flags)\n{\n\tOM_uint32 status;\n\tgss_OID mech;\n\n\tctx->major = gss_accept_sec_context(&ctx->minor,\n\t    &ctx->context, ctx->creds, recv_tok,\n\t    GSS_C_NO_CHANNEL_BINDINGS, &ctx->client, &mech,\n\t    send_tok, flags, NULL, &ctx->client_creds);\n\n\tif (GSS_ERROR(ctx->major))\n\t\tssh_gssapi_error(ctx);\n\n\tif (ctx->client_creds)\n\t\tdebug(\"Received some client credentials\");\n\telse\n\t\tdebug(\"Got no client credentials\");\n\n\tstatus = ctx->major;\n\n\t/* Now, if we're complete and we have the right flags, then\n\t * we flag the user as also having been authenticated\n\t */\n\n\tif (((flags == NULL) || ((*flags & GSS_C_MUTUAL_FLAG) &&\n\t    (*flags & GSS_C_INTEG_FLAG))) && (ctx->major == GSS_S_COMPLETE)) {\n\t\tif (ssh_gssapi_getclient(ctx, &gssapi_client))\n\t\t\tfatal(\"Couldn't convert client name\");\n\t}\n\n\treturn (status);\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"servconf.h\"",
      "#include \"misc.h\"",
      "#include \"session.h\"",
      "#include \"channels.h\"",
      "#include \"log.h\"",
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"sshkey.h\"",
      "#include \"xmalloc.h\"",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fatal",
          "args": [
            "\"Couldn't convert client name\""
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "fatal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/fatal.c",
          "lines": "36-45",
          "snippet": "void\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\tcleanup_exit(255);\n}",
          "includes": [
            "#include \"log.h\"",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nfatal(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_FATAL, fmt, args);\n\tva_end(args);\n\tcleanup_exit(255);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_gssapi_getclient",
          "args": [
            "ctx",
            "&gssapi_client"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_getclient",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
          "lines": "275-316",
          "snippet": "OM_uint32\nssh_gssapi_getclient(Gssctxt *ctx, ssh_gssapi_client *client)\n{\n\tint i = 0;\n\n\tgss_buffer_desc ename;\n\n\tclient->mech = NULL;\n\n\twhile (supported_mechs[i]->name != NULL) {\n\t\tif (supported_mechs[i]->oid.length == ctx->oid->length &&\n\t\t    (memcmp(supported_mechs[i]->oid.elements,\n\t\t    ctx->oid->elements, ctx->oid->length) == 0))\n\t\t\tclient->mech = supported_mechs[i];\n\t\ti++;\n\t}\n\n\tif (client->mech == NULL)\n\t\treturn GSS_S_FAILURE;\n\n\tif ((ctx->major = gss_display_name(&ctx->minor, ctx->client,\n\t    &client->displayname, NULL))) {\n\t\tssh_gssapi_error(ctx);\n\t\treturn (ctx->major);\n\t}\n\n\tif ((ctx->major = gss_export_name(&ctx->minor, ctx->client,\n\t    &ename))) {\n\t\tssh_gssapi_error(ctx);\n\t\treturn (ctx->major);\n\t}\n\n\tif ((ctx->major = ssh_gssapi_parse_ename(ctx,&ename,\n\t    &client->exportedname))) {\n\t\treturn (ctx->major);\n\t}\n\n\t/* We can't copy this structure, so we just move the pointer to it */\n\tclient->creds = ctx->client_creds;\n\tctx->client_creds = GSS_C_NO_CREDENTIAL;\n\treturn (ctx->major);\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"servconf.h\"",
            "#include \"misc.h\"",
            "#include \"session.h\"",
            "#include \"channels.h\"",
            "#include \"log.h\"",
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nOM_uint32\nssh_gssapi_getclient(Gssctxt *ctx, ssh_gssapi_client *client)\n{\n\tint i = 0;\n\n\tgss_buffer_desc ename;\n\n\tclient->mech = NULL;\n\n\twhile (supported_mechs[i]->name != NULL) {\n\t\tif (supported_mechs[i]->oid.length == ctx->oid->length &&\n\t\t    (memcmp(supported_mechs[i]->oid.elements,\n\t\t    ctx->oid->elements, ctx->oid->length) == 0))\n\t\t\tclient->mech = supported_mechs[i];\n\t\ti++;\n\t}\n\n\tif (client->mech == NULL)\n\t\treturn GSS_S_FAILURE;\n\n\tif ((ctx->major = gss_display_name(&ctx->minor, ctx->client,\n\t    &client->displayname, NULL))) {\n\t\tssh_gssapi_error(ctx);\n\t\treturn (ctx->major);\n\t}\n\n\tif ((ctx->major = gss_export_name(&ctx->minor, ctx->client,\n\t    &ename))) {\n\t\tssh_gssapi_error(ctx);\n\t\treturn (ctx->major);\n\t}\n\n\tif ((ctx->major = ssh_gssapi_parse_ename(ctx,&ename,\n\t    &client->exportedname))) {\n\t\treturn (ctx->major);\n\t}\n\n\t/* We can't copy this structure, so we just move the pointer to it */\n\tclient->creds = ctx->client_creds;\n\tctx->client_creds = GSS_C_NO_CREDENTIAL;\n\treturn (ctx->major);\n}"
        }
      },
      {
        "call_info": {
          "callee": "debug",
          "args": [
            "\"Got no client credentials\""
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "debug3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/log.c",
          "lines": "242-250",
          "snippet": "void\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include \"log.h\"",
            "# include <vis.h>",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <syslog.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <stdarg.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"log.h\"\n# include <vis.h>\n#include <errno.h>\n#include <unistd.h>\n#include <syslog.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdarg.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\ndebug3(const char *fmt,...)\n{\n\tva_list args;\n\n\tva_start(args, fmt);\n\tdo_log(SYSLOG_LEVEL_DEBUG3, fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_gssapi_error",
          "args": [
            "ctx"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
          "lines": "96-104",
          "snippet": "void\nssh_gssapi_error(Gssctxt *ctxt)\n{\n\tchar *s;\n\n\ts = ssh_gssapi_last_error(ctxt, NULL, NULL);\n\tdebug(\"%s\", s);\n\tfree(s);\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"ssh2.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_error(Gssctxt *ctxt)\n{\n\tchar *s;\n\n\ts = ssh_gssapi_last_error(ctxt, NULL, NULL);\n\tdebug(\"%s\", s);\n\tfree(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GSS_ERROR",
          "args": [
            "ctx->major"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_accept_sec_context",
          "args": [
            "&ctx->minor",
            "&ctx->context",
            "ctx->creds",
            "recv_tok",
            "GSS_C_NO_CHANNEL_BINDINGS",
            "&ctx->client",
            "&mech",
            "send_tok",
            "flags",
            "NULL",
            "&ctx->client_creds"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nOM_uint32\nssh_gssapi_accept_ctx(Gssctxt *ctx, gss_buffer_desc *recv_tok,\n    gss_buffer_desc *send_tok, OM_uint32 *flags)\n{\n\tOM_uint32 status;\n\tgss_OID mech;\n\n\tctx->major = gss_accept_sec_context(&ctx->minor,\n\t    &ctx->context, ctx->creds, recv_tok,\n\t    GSS_C_NO_CHANNEL_BINDINGS, &ctx->client, &mech,\n\t    send_tok, flags, NULL, &ctx->client_creds);\n\n\tif (GSS_ERROR(ctx->major))\n\t\tssh_gssapi_error(ctx);\n\n\tif (ctx->client_creds)\n\t\tdebug(\"Received some client credentials\");\n\telse\n\t\tdebug(\"Got no client credentials\");\n\n\tstatus = ctx->major;\n\n\t/* Now, if we're complete and we have the right flags, then\n\t * we flag the user as also having been authenticated\n\t */\n\n\tif (((flags == NULL) || ((*flags & GSS_C_MUTUAL_FLAG) &&\n\t    (*flags & GSS_C_INTEG_FLAG))) && (ctx->major == GSS_S_COMPLETE)) {\n\t\tif (ssh_gssapi_getclient(ctx, &gssapi_client))\n\t\t\tfatal(\"Couldn't convert client name\");\n\t}\n\n\treturn (status);\n}"
  },
  {
    "function_name": "ssh_gssapi_supported_oids",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
    "lines": "144-166",
    "snippet": "void\nssh_gssapi_supported_oids(gss_OID_set *oidset)\n{\n\tint i = 0;\n\tOM_uint32 min_status;\n\tint present;\n\tgss_OID_set supported;\n\n\tgss_create_empty_oid_set(&min_status, oidset);\n\tgss_indicate_mechs(&min_status, &supported);\n\n\twhile (supported_mechs[i]->name != NULL) {\n\t\tif (GSS_ERROR(gss_test_oid_set_member(&min_status,\n\t\t    &supported_mechs[i]->oid, supported, &present)))\n\t\t\tpresent = 0;\n\t\tif (present)\n\t\t\tgss_add_oid_set_member(&min_status,\n\t\t\t    &supported_mechs[i]->oid, oidset);\n\t\ti++;\n\t}\n\n\tgss_release_oid_set(&min_status, &supported);\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"servconf.h\"",
      "#include \"misc.h\"",
      "#include \"session.h\"",
      "#include \"channels.h\"",
      "#include \"log.h\"",
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"sshkey.h\"",
      "#include \"xmalloc.h\"",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gss_release_oid_set",
          "args": [
            "&min_status",
            "&supported"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_add_oid_set_member",
          "args": [
            "&min_status",
            "&supported_mechs[i]->oid",
            "oidset"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GSS_ERROR",
          "args": [
            "gss_test_oid_set_member(&min_status,\n\t\t    &supported_mechs[i]->oid, supported, &present)"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_test_oid_set_member",
          "args": [
            "&min_status",
            "&supported_mechs[i]->oid",
            "supported",
            "&present"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_indicate_mechs",
          "args": [
            "&min_status",
            "&supported"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_create_empty_oid_set",
          "args": [
            "&min_status",
            "oidset"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_supported_oids(gss_OID_set *oidset)\n{\n\tint i = 0;\n\tOM_uint32 min_status;\n\tint present;\n\tgss_OID_set supported;\n\n\tgss_create_empty_oid_set(&min_status, oidset);\n\tgss_indicate_mechs(&min_status, &supported);\n\n\twhile (supported_mechs[i]->name != NULL) {\n\t\tif (GSS_ERROR(gss_test_oid_set_member(&min_status,\n\t\t    &supported_mechs[i]->oid, supported, &present)))\n\t\t\tpresent = 0;\n\t\tif (present)\n\t\t\tgss_add_oid_set_member(&min_status,\n\t\t\t    &supported_mechs[i]->oid, oidset);\n\t\ti++;\n\t}\n\n\tgss_release_oid_set(&min_status, &supported);\n}"
  },
  {
    "function_name": "ssh_gssapi_server_ctx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
    "lines": "133-141",
    "snippet": "OM_uint32\nssh_gssapi_server_ctx(Gssctxt **ctx, gss_OID oid)\n{\n\tif (*ctx)\n\t\tssh_gssapi_delete_ctx(ctx);\n\tssh_gssapi_build_ctx(ctx);\n\tssh_gssapi_set_oid(*ctx, oid);\n\treturn (ssh_gssapi_acquire_cred(*ctx));\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"servconf.h\"",
      "#include \"misc.h\"",
      "#include \"session.h\"",
      "#include \"channels.h\"",
      "#include \"log.h\"",
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"sshkey.h\"",
      "#include \"xmalloc.h\"",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_gssapi_acquire_cred",
          "args": [
            "*ctx"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_acquire_cred",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
          "lines": "97-130",
          "snippet": "static OM_uint32\nssh_gssapi_acquire_cred(Gssctxt *ctx)\n{\n\tOM_uint32 status;\n\tchar lname[NI_MAXHOST];\n\tgss_OID_set oidset;\n\n\tif (options.gss_strict_acceptor) {\n\t\tgss_create_empty_oid_set(&status, &oidset);\n\t\tgss_add_oid_set_member(&status, ctx->oid, &oidset);\n\n\t\tif (gethostname(lname, MAXHOSTNAMELEN)) {\n\t\t\tgss_release_oid_set(&status, &oidset);\n\t\t\treturn (-1);\n\t\t}\n\n\t\tif (GSS_ERROR(ssh_gssapi_import_name(ctx, lname))) {\n\t\t\tgss_release_oid_set(&status, &oidset);\n\t\t\treturn (ctx->major);\n\t\t}\n\n\t\tif ((ctx->major = gss_acquire_cred(&ctx->minor,\n\t\t    ctx->name, 0, oidset, GSS_C_ACCEPT, &ctx->creds,\n\t\t    NULL, NULL)))\n\t\t\tssh_gssapi_error(ctx);\n\n\t\tgss_release_oid_set(&status, &oidset);\n\t\treturn (ctx->major);\n\t} else {\n\t\tctx->name = GSS_C_NO_NAME;\n\t\tctx->creds = GSS_C_NO_CREDENTIAL;\n\t}\n\treturn GSS_S_COMPLETE;\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"servconf.h\"",
            "#include \"misc.h\"",
            "#include \"session.h\"",
            "#include \"channels.h\"",
            "#include \"log.h\"",
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic OM_uint32\nssh_gssapi_acquire_cred(Gssctxt *ctx)\n{\n\tOM_uint32 status;\n\tchar lname[NI_MAXHOST];\n\tgss_OID_set oidset;\n\n\tif (options.gss_strict_acceptor) {\n\t\tgss_create_empty_oid_set(&status, &oidset);\n\t\tgss_add_oid_set_member(&status, ctx->oid, &oidset);\n\n\t\tif (gethostname(lname, MAXHOSTNAMELEN)) {\n\t\t\tgss_release_oid_set(&status, &oidset);\n\t\t\treturn (-1);\n\t\t}\n\n\t\tif (GSS_ERROR(ssh_gssapi_import_name(ctx, lname))) {\n\t\t\tgss_release_oid_set(&status, &oidset);\n\t\t\treturn (ctx->major);\n\t\t}\n\n\t\tif ((ctx->major = gss_acquire_cred(&ctx->minor,\n\t\t    ctx->name, 0, oidset, GSS_C_ACCEPT, &ctx->creds,\n\t\t    NULL, NULL)))\n\t\t\tssh_gssapi_error(ctx);\n\n\t\tgss_release_oid_set(&status, &oidset);\n\t\treturn (ctx->major);\n\t} else {\n\t\tctx->name = GSS_C_NO_NAME;\n\t\tctx->creds = GSS_C_NO_CREDENTIAL;\n\t}\n\treturn GSS_S_COMPLETE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_gssapi_set_oid",
          "args": [
            "*ctx",
            "oid"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_set_oid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
          "lines": "89-93",
          "snippet": "void\nssh_gssapi_set_oid(Gssctxt *ctx, gss_OID oid)\n{\n\tssh_gssapi_set_oid_data(ctx, oid->elements, oid->length);\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"ssh2.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_set_oid(Gssctxt *ctx, gss_OID oid)\n{\n\tssh_gssapi_set_oid_data(ctx, oid->elements, oid->length);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_gssapi_build_ctx",
          "args": [
            "ctx"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_build_ctx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
          "lines": "163-173",
          "snippet": "void\nssh_gssapi_build_ctx(Gssctxt **ctx)\n{\n\t*ctx = xcalloc(1, sizeof (Gssctxt));\n\t(*ctx)->context = GSS_C_NO_CONTEXT;\n\t(*ctx)->name = GSS_C_NO_NAME;\n\t(*ctx)->oid = GSS_C_NO_OID;\n\t(*ctx)->creds = GSS_C_NO_CREDENTIAL;\n\t(*ctx)->client = GSS_C_NO_NAME;\n\t(*ctx)->client_creds = GSS_C_NO_CREDENTIAL;\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"ssh2.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_build_ctx(Gssctxt **ctx)\n{\n\t*ctx = xcalloc(1, sizeof (Gssctxt));\n\t(*ctx)->context = GSS_C_NO_CONTEXT;\n\t(*ctx)->name = GSS_C_NO_NAME;\n\t(*ctx)->oid = GSS_C_NO_OID;\n\t(*ctx)->creds = GSS_C_NO_CREDENTIAL;\n\t(*ctx)->client = GSS_C_NO_NAME;\n\t(*ctx)->client_creds = GSS_C_NO_CREDENTIAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssh_gssapi_delete_ctx",
          "args": [
            "ctx"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_delete_ctx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
          "lines": "176-201",
          "snippet": "void\nssh_gssapi_delete_ctx(Gssctxt **ctx)\n{\n\tOM_uint32 ms;\n\n\tif ((*ctx) == NULL)\n\t\treturn;\n\tif ((*ctx)->context != GSS_C_NO_CONTEXT)\n\t\tgss_delete_sec_context(&ms, &(*ctx)->context, GSS_C_NO_BUFFER);\n\tif ((*ctx)->name != GSS_C_NO_NAME)\n\t\tgss_release_name(&ms, &(*ctx)->name);\n\tif ((*ctx)->oid != GSS_C_NO_OID) {\n\t\tfree((*ctx)->oid->elements);\n\t\tfree((*ctx)->oid);\n\t\t(*ctx)->oid = GSS_C_NO_OID;\n\t}\n\tif ((*ctx)->creds != GSS_C_NO_CREDENTIAL)\n\t\tgss_release_cred(&ms, &(*ctx)->creds);\n\tif ((*ctx)->client != GSS_C_NO_NAME)\n\t\tgss_release_name(&ms, &(*ctx)->client);\n\tif ((*ctx)->client_creds != GSS_C_NO_CREDENTIAL)\n\t\tgss_release_cred(&ms, &(*ctx)->client_creds);\n\n\tfree(*ctx);\n\t*ctx = NULL;\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"ssh2.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_delete_ctx(Gssctxt **ctx)\n{\n\tOM_uint32 ms;\n\n\tif ((*ctx) == NULL)\n\t\treturn;\n\tif ((*ctx)->context != GSS_C_NO_CONTEXT)\n\t\tgss_delete_sec_context(&ms, &(*ctx)->context, GSS_C_NO_BUFFER);\n\tif ((*ctx)->name != GSS_C_NO_NAME)\n\t\tgss_release_name(&ms, &(*ctx)->name);\n\tif ((*ctx)->oid != GSS_C_NO_OID) {\n\t\tfree((*ctx)->oid->elements);\n\t\tfree((*ctx)->oid);\n\t\t(*ctx)->oid = GSS_C_NO_OID;\n\t}\n\tif ((*ctx)->creds != GSS_C_NO_CREDENTIAL)\n\t\tgss_release_cred(&ms, &(*ctx)->creds);\n\tif ((*ctx)->client != GSS_C_NO_NAME)\n\t\tgss_release_name(&ms, &(*ctx)->client);\n\tif ((*ctx)->client_creds != GSS_C_NO_CREDENTIAL)\n\t\tgss_release_cred(&ms, &(*ctx)->client_creds);\n\n\tfree(*ctx);\n\t*ctx = NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nOM_uint32\nssh_gssapi_server_ctx(Gssctxt **ctx, gss_OID oid)\n{\n\tif (*ctx)\n\t\tssh_gssapi_delete_ctx(ctx);\n\tssh_gssapi_build_ctx(ctx);\n\tssh_gssapi_set_oid(*ctx, oid);\n\treturn (ssh_gssapi_acquire_cred(*ctx));\n}"
  },
  {
    "function_name": "ssh_gssapi_acquire_cred",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
    "lines": "97-130",
    "snippet": "static OM_uint32\nssh_gssapi_acquire_cred(Gssctxt *ctx)\n{\n\tOM_uint32 status;\n\tchar lname[NI_MAXHOST];\n\tgss_OID_set oidset;\n\n\tif (options.gss_strict_acceptor) {\n\t\tgss_create_empty_oid_set(&status, &oidset);\n\t\tgss_add_oid_set_member(&status, ctx->oid, &oidset);\n\n\t\tif (gethostname(lname, MAXHOSTNAMELEN)) {\n\t\t\tgss_release_oid_set(&status, &oidset);\n\t\t\treturn (-1);\n\t\t}\n\n\t\tif (GSS_ERROR(ssh_gssapi_import_name(ctx, lname))) {\n\t\t\tgss_release_oid_set(&status, &oidset);\n\t\t\treturn (ctx->major);\n\t\t}\n\n\t\tif ((ctx->major = gss_acquire_cred(&ctx->minor,\n\t\t    ctx->name, 0, oidset, GSS_C_ACCEPT, &ctx->creds,\n\t\t    NULL, NULL)))\n\t\t\tssh_gssapi_error(ctx);\n\n\t\tgss_release_oid_set(&status, &oidset);\n\t\treturn (ctx->major);\n\t} else {\n\t\tctx->name = GSS_C_NO_NAME;\n\t\tctx->creds = GSS_C_NO_CREDENTIAL;\n\t}\n\treturn GSS_S_COMPLETE;\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"servconf.h\"",
      "#include \"misc.h\"",
      "#include \"session.h\"",
      "#include \"channels.h\"",
      "#include \"log.h\"",
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"sshkey.h\"",
      "#include \"xmalloc.h\"",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gss_release_oid_set",
          "args": [
            "&status",
            "&oidset"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssh_gssapi_error",
          "args": [
            "ctx"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
          "lines": "96-104",
          "snippet": "void\nssh_gssapi_error(Gssctxt *ctxt)\n{\n\tchar *s;\n\n\ts = ssh_gssapi_last_error(ctxt, NULL, NULL);\n\tdebug(\"%s\", s);\n\tfree(s);\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"ssh2.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_error(Gssctxt *ctxt)\n{\n\tchar *s;\n\n\ts = ssh_gssapi_last_error(ctxt, NULL, NULL);\n\tdebug(\"%s\", s);\n\tfree(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gss_acquire_cred",
          "args": [
            "&ctx->minor",
            "ctx->name",
            "0",
            "oidset",
            "GSS_C_ACCEPT",
            "&ctx->creds",
            "NULL",
            "NULL"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_release_oid_set",
          "args": [
            "&status",
            "&oidset"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GSS_ERROR",
          "args": [
            "ssh_gssapi_import_name(ctx, lname)"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssh_gssapi_import_name",
          "args": [
            "ctx",
            "lname"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_import_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-genr.c",
          "lines": "232-248",
          "snippet": "OM_uint32\nssh_gssapi_import_name(Gssctxt *ctx, const char *host)\n{\n\tgss_buffer_desc gssbuf;\n\tchar *val;\n\n\txasprintf(&val, \"host@%s\", host);\n\tgssbuf.value = val;\n\tgssbuf.length = strlen(gssbuf.value);\n\n\tif ((ctx->major = gss_import_name(&ctx->minor,\n\t    &gssbuf, GSS_C_NT_HOSTBASED_SERVICE, &ctx->name)))\n\t\tssh_gssapi_error(ctx);\n\n\tfree(gssbuf.value);\n\treturn (ctx->major);\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"ssh2.h\"",
            "#include \"log.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include \"xmalloc.h\"",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"ssh2.h\"\n#include \"log.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include \"xmalloc.h\"\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nOM_uint32\nssh_gssapi_import_name(Gssctxt *ctx, const char *host)\n{\n\tgss_buffer_desc gssbuf;\n\tchar *val;\n\n\txasprintf(&val, \"host@%s\", host);\n\tgssbuf.value = val;\n\tgssbuf.length = strlen(gssbuf.value);\n\n\tif ((ctx->major = gss_import_name(&ctx->minor,\n\t    &gssbuf, GSS_C_NT_HOSTBASED_SERVICE, &ctx->name)))\n\t\tssh_gssapi_error(ctx);\n\n\tfree(gssbuf.value);\n\treturn (ctx->major);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gss_release_oid_set",
          "args": [
            "&status",
            "&oidset"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gethostname",
          "args": [
            "lname",
            "MAXHOSTNAMELEN"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_add_oid_set_member",
          "args": [
            "&status",
            "ctx->oid",
            "&oidset"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gss_create_empty_oid_set",
          "args": [
            "&status",
            "&oidset"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic OM_uint32\nssh_gssapi_acquire_cred(Gssctxt *ctx)\n{\n\tOM_uint32 status;\n\tchar lname[NI_MAXHOST];\n\tgss_OID_set oidset;\n\n\tif (options.gss_strict_acceptor) {\n\t\tgss_create_empty_oid_set(&status, &oidset);\n\t\tgss_add_oid_set_member(&status, ctx->oid, &oidset);\n\n\t\tif (gethostname(lname, MAXHOSTNAMELEN)) {\n\t\t\tgss_release_oid_set(&status, &oidset);\n\t\t\treturn (-1);\n\t\t}\n\n\t\tif (GSS_ERROR(ssh_gssapi_import_name(ctx, lname))) {\n\t\t\tgss_release_oid_set(&status, &oidset);\n\t\t\treturn (ctx->major);\n\t\t}\n\n\t\tif ((ctx->major = gss_acquire_cred(&ctx->minor,\n\t\t    ctx->name, 0, oidset, GSS_C_ACCEPT, &ctx->creds,\n\t\t    NULL, NULL)))\n\t\t\tssh_gssapi_error(ctx);\n\n\t\tgss_release_oid_set(&status, &oidset);\n\t\treturn (ctx->major);\n\t} else {\n\t\tctx->name = GSS_C_NO_NAME;\n\t\tctx->creds = GSS_C_NO_CREDENTIAL;\n\t}\n\treturn GSS_S_COMPLETE;\n}"
  },
  {
    "function_name": "ssh_gssapi_test_oid_supported",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
    "lines": "82-88",
    "snippet": "OM_uint32\nssh_gssapi_test_oid_supported(OM_uint32 *ms, gss_OID member, int *present)\n{\n\tif (supported_oids == NULL)\n\t\tssh_gssapi_prepare_supported_oids();\n\treturn gss_test_oid_set_member(ms, member, supported_oids, present);\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"servconf.h\"",
      "#include \"misc.h\"",
      "#include \"session.h\"",
      "#include \"channels.h\"",
      "#include \"log.h\"",
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"sshkey.h\"",
      "#include \"xmalloc.h\"",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gss_test_oid_set_member",
          "args": [
            "ms",
            "member",
            "supported_oids",
            "present"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssh_gssapi_prepare_supported_oids",
          "args": [],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_prepare_supported_oids",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
          "lines": "76-80",
          "snippet": "void\nssh_gssapi_prepare_supported_oids(void)\n{\n\tssh_gssapi_supported_oids(&supported_oids);\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"servconf.h\"",
            "#include \"misc.h\"",
            "#include \"session.h\"",
            "#include \"channels.h\"",
            "#include \"log.h\"",
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_prepare_supported_oids(void)\n{\n\tssh_gssapi_supported_oids(&supported_oids);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nOM_uint32\nssh_gssapi_test_oid_supported(OM_uint32 *ms, gss_OID member, int *present)\n{\n\tif (supported_oids == NULL)\n\t\tssh_gssapi_prepare_supported_oids();\n\treturn gss_test_oid_set_member(ms, member, supported_oids, present);\n}"
  },
  {
    "function_name": "ssh_gssapi_prepare_supported_oids",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
    "lines": "76-80",
    "snippet": "void\nssh_gssapi_prepare_supported_oids(void)\n{\n\tssh_gssapi_supported_oids(&supported_oids);\n}",
    "includes": [
      "#include \"ssh-gss.h\"",
      "#include \"servconf.h\"",
      "#include \"misc.h\"",
      "#include \"session.h\"",
      "#include \"channels.h\"",
      "#include \"log.h\"",
      "#include \"auth.h\"",
      "#include \"hostfile.h\"",
      "#include \"sshkey.h\"",
      "#include \"xmalloc.h\"",
      "#include \"openbsd-compat/sys-queue.h\"",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdarg.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ssh_gssapi_supported_oids",
          "args": [
            "&supported_oids"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_gssapi_supported_oids",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/gss-serv.c",
          "lines": "144-166",
          "snippet": "void\nssh_gssapi_supported_oids(gss_OID_set *oidset)\n{\n\tint i = 0;\n\tOM_uint32 min_status;\n\tint present;\n\tgss_OID_set supported;\n\n\tgss_create_empty_oid_set(&min_status, oidset);\n\tgss_indicate_mechs(&min_status, &supported);\n\n\twhile (supported_mechs[i]->name != NULL) {\n\t\tif (GSS_ERROR(gss_test_oid_set_member(&min_status,\n\t\t    &supported_mechs[i]->oid, supported, &present)))\n\t\t\tpresent = 0;\n\t\tif (present)\n\t\t\tgss_add_oid_set_member(&min_status,\n\t\t\t    &supported_mechs[i]->oid, oidset);\n\t\ti++;\n\t}\n\n\tgss_release_oid_set(&min_status, &supported);\n}",
          "includes": [
            "#include \"ssh-gss.h\"",
            "#include \"servconf.h\"",
            "#include \"misc.h\"",
            "#include \"session.h\"",
            "#include \"channels.h\"",
            "#include \"log.h\"",
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"sshkey.h\"",
            "#include \"xmalloc.h\"",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_supported_oids(gss_OID_set *oidset)\n{\n\tint i = 0;\n\tOM_uint32 min_status;\n\tint present;\n\tgss_OID_set supported;\n\n\tgss_create_empty_oid_set(&min_status, oidset);\n\tgss_indicate_mechs(&min_status, &supported);\n\n\twhile (supported_mechs[i]->name != NULL) {\n\t\tif (GSS_ERROR(gss_test_oid_set_member(&min_status,\n\t\t    &supported_mechs[i]->oid, supported, &present)))\n\t\t\tpresent = 0;\n\t\tif (present)\n\t\t\tgss_add_oid_set_member(&min_status,\n\t\t\t    &supported_mechs[i]->oid, oidset);\n\t\ti++;\n\t}\n\n\tgss_release_oid_set(&min_status, &supported);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ssh-gss.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"session.h\"\n#include \"channels.h\"\n#include \"log.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"sshkey.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_gssapi_prepare_supported_oids(void)\n{\n\tssh_gssapi_supported_oids(&supported_oids);\n}"
  }
]