[
  {
    "function_name": "dsa_priv_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/sshkey/common.c",
    "lines": "153-162",
    "snippet": "const BIGNUM *\ndsa_priv_key(struct sshkey *k)\n{\n\tconst BIGNUM *priv_key = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->dsa, NULL);\n\tDSA_get0_key(k->dsa, NULL, &priv_key);\n\treturn priv_key;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include \"sshbuf.h\"",
      "#include \"sshkey.h\"",
      "#include \"authfile.h\"",
      "#include \"ssherr.h\"",
      "#include \"../test_helper/test_helper.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "# include <openssl/ec.h>",
      "#include <openssl/objects.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/bn.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DSA_get0_key",
          "args": [
            "k->dsa",
            "NULL",
            "&priv_key"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "DSA_get0_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "199-206",
          "snippet": "void\nDSA_get0_key(const DSA *d, const BIGNUM **pub_key, const BIGNUM **priv_key)\n{\n\tif (pub_key != NULL)\n\t\t*pub_key = d->pub_key;\n\tif (priv_key != NULL)\n\t\t*priv_key = d->priv_key;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nDSA_get0_key(const DSA *d, const BIGNUM **pub_key, const BIGNUM **priv_key)\n{\n\tif (pub_key != NULL)\n\t\t*pub_key = d->pub_key;\n\tif (priv_key != NULL)\n\t\t*priv_key = d->priv_key;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "k->dsa",
            "NULL"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "k",
            "NULL"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include \"sshbuf.h\"\n#include \"sshkey.h\"\n#include \"authfile.h\"\n#include \"ssherr.h\"\n#include \"../test_helper/test_helper.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n# include <openssl/ec.h>\n#include <openssl/objects.h>\n#include <openssl/dsa.h>\n#include <openssl/rsa.h>\n#include <openssl/bn.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst BIGNUM *\ndsa_priv_key(struct sshkey *k)\n{\n\tconst BIGNUM *priv_key = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->dsa, NULL);\n\tDSA_get0_key(k->dsa, NULL, &priv_key);\n\treturn priv_key;\n}"
  },
  {
    "function_name": "dsa_pub_key",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/sshkey/common.c",
    "lines": "142-151",
    "snippet": "const BIGNUM *\ndsa_pub_key(struct sshkey *k)\n{\n\tconst BIGNUM *pub_key = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->dsa, NULL);\n\tDSA_get0_key(k->dsa, &pub_key, NULL);\n\treturn pub_key;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include \"sshbuf.h\"",
      "#include \"sshkey.h\"",
      "#include \"authfile.h\"",
      "#include \"ssherr.h\"",
      "#include \"../test_helper/test_helper.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "# include <openssl/ec.h>",
      "#include <openssl/objects.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/bn.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DSA_get0_key",
          "args": [
            "k->dsa",
            "&pub_key",
            "NULL"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "DSA_get0_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "199-206",
          "snippet": "void\nDSA_get0_key(const DSA *d, const BIGNUM **pub_key, const BIGNUM **priv_key)\n{\n\tif (pub_key != NULL)\n\t\t*pub_key = d->pub_key;\n\tif (priv_key != NULL)\n\t\t*priv_key = d->priv_key;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nDSA_get0_key(const DSA *d, const BIGNUM **pub_key, const BIGNUM **priv_key)\n{\n\tif (pub_key != NULL)\n\t\t*pub_key = d->pub_key;\n\tif (priv_key != NULL)\n\t\t*priv_key = d->priv_key;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "k->dsa",
            "NULL"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "k",
            "NULL"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include \"sshbuf.h\"\n#include \"sshkey.h\"\n#include \"authfile.h\"\n#include \"ssherr.h\"\n#include \"../test_helper/test_helper.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n# include <openssl/ec.h>\n#include <openssl/objects.h>\n#include <openssl/dsa.h>\n#include <openssl/rsa.h>\n#include <openssl/bn.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst BIGNUM *\ndsa_pub_key(struct sshkey *k)\n{\n\tconst BIGNUM *pub_key = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->dsa, NULL);\n\tDSA_get0_key(k->dsa, &pub_key, NULL);\n\treturn pub_key;\n}"
  },
  {
    "function_name": "dsa_g",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/sshkey/common.c",
    "lines": "131-140",
    "snippet": "const BIGNUM *\ndsa_g(struct sshkey *k)\n{\n\tconst BIGNUM *g = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->dsa, NULL);\n\tDSA_get0_pqg(k->dsa, NULL, NULL, &g);\n\treturn g;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include \"sshbuf.h\"",
      "#include \"sshkey.h\"",
      "#include \"authfile.h\"",
      "#include \"ssherr.h\"",
      "#include \"../test_helper/test_helper.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "# include <openssl/ec.h>",
      "#include <openssl/objects.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/bn.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DSA_get0_pqg",
          "args": [
            "k->dsa",
            "NULL",
            "NULL",
            "&g"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "DSA_get0_pqg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "161-170",
          "snippet": "void\nDSA_get0_pqg(const DSA *d, const BIGNUM **p, const BIGNUM **q, const BIGNUM **g)\n{\n\tif (p != NULL)\n\t\t*p = d->p;\n\tif (q != NULL)\n\t\t*q = d->q;\n\tif (g != NULL)\n\t\t*g = d->g;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nDSA_get0_pqg(const DSA *d, const BIGNUM **p, const BIGNUM **q, const BIGNUM **g)\n{\n\tif (p != NULL)\n\t\t*p = d->p;\n\tif (q != NULL)\n\t\t*q = d->q;\n\tif (g != NULL)\n\t\t*g = d->g;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "k->dsa",
            "NULL"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "k",
            "NULL"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include \"sshbuf.h\"\n#include \"sshkey.h\"\n#include \"authfile.h\"\n#include \"ssherr.h\"\n#include \"../test_helper/test_helper.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n# include <openssl/ec.h>\n#include <openssl/objects.h>\n#include <openssl/dsa.h>\n#include <openssl/rsa.h>\n#include <openssl/bn.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst BIGNUM *\ndsa_g(struct sshkey *k)\n{\n\tconst BIGNUM *g = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->dsa, NULL);\n\tDSA_get0_pqg(k->dsa, NULL, NULL, &g);\n\treturn g;\n}"
  },
  {
    "function_name": "rsa_q",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/sshkey/common.c",
    "lines": "120-129",
    "snippet": "const BIGNUM *\nrsa_q(struct sshkey *k)\n{\n\tconst BIGNUM *q = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->rsa, NULL);\n\tRSA_get0_factors(k->rsa, NULL, &q);\n\treturn q;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include \"sshbuf.h\"",
      "#include \"sshkey.h\"",
      "#include \"authfile.h\"",
      "#include \"ssherr.h\"",
      "#include \"../test_helper/test_helper.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "# include <openssl/ec.h>",
      "#include <openssl/objects.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/bn.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RSA_get0_factors",
          "args": [
            "k->rsa",
            "NULL",
            "&q"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "RSA_get0_factors",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "307-314",
          "snippet": "void\nRSA_get0_factors(const RSA *r, const BIGNUM **p, const BIGNUM **q)\n{\n\tif (p != NULL)\n\t\t*p = r->p;\n\tif (q != NULL)\n\t\t*q = r->q;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nRSA_get0_factors(const RSA *r, const BIGNUM **p, const BIGNUM **q)\n{\n\tif (p != NULL)\n\t\t*p = r->p;\n\tif (q != NULL)\n\t\t*q = r->q;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "k->rsa",
            "NULL"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "k",
            "NULL"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include \"sshbuf.h\"\n#include \"sshkey.h\"\n#include \"authfile.h\"\n#include \"ssherr.h\"\n#include \"../test_helper/test_helper.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n# include <openssl/ec.h>\n#include <openssl/objects.h>\n#include <openssl/dsa.h>\n#include <openssl/rsa.h>\n#include <openssl/bn.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst BIGNUM *\nrsa_q(struct sshkey *k)\n{\n\tconst BIGNUM *q = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->rsa, NULL);\n\tRSA_get0_factors(k->rsa, NULL, &q);\n\treturn q;\n}"
  },
  {
    "function_name": "rsa_p",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/sshkey/common.c",
    "lines": "109-118",
    "snippet": "const BIGNUM *\nrsa_p(struct sshkey *k)\n{\n\tconst BIGNUM *p = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->rsa, NULL);\n\tRSA_get0_factors(k->rsa, &p, NULL);\n\treturn p;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include \"sshbuf.h\"",
      "#include \"sshkey.h\"",
      "#include \"authfile.h\"",
      "#include \"ssherr.h\"",
      "#include \"../test_helper/test_helper.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "# include <openssl/ec.h>",
      "#include <openssl/objects.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/bn.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RSA_get0_factors",
          "args": [
            "k->rsa",
            "&p",
            "NULL"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "RSA_get0_factors",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "307-314",
          "snippet": "void\nRSA_get0_factors(const RSA *r, const BIGNUM **p, const BIGNUM **q)\n{\n\tif (p != NULL)\n\t\t*p = r->p;\n\tif (q != NULL)\n\t\t*q = r->q;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nRSA_get0_factors(const RSA *r, const BIGNUM **p, const BIGNUM **q)\n{\n\tif (p != NULL)\n\t\t*p = r->p;\n\tif (q != NULL)\n\t\t*q = r->q;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "k->rsa",
            "NULL"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "k",
            "NULL"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include \"sshbuf.h\"\n#include \"sshkey.h\"\n#include \"authfile.h\"\n#include \"ssherr.h\"\n#include \"../test_helper/test_helper.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n# include <openssl/ec.h>\n#include <openssl/objects.h>\n#include <openssl/dsa.h>\n#include <openssl/rsa.h>\n#include <openssl/bn.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst BIGNUM *\nrsa_p(struct sshkey *k)\n{\n\tconst BIGNUM *p = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->rsa, NULL);\n\tRSA_get0_factors(k->rsa, &p, NULL);\n\treturn p;\n}"
  },
  {
    "function_name": "rsa_e",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/sshkey/common.c",
    "lines": "98-107",
    "snippet": "const BIGNUM *\nrsa_e(struct sshkey *k)\n{\n\tconst BIGNUM *e = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->rsa, NULL);\n\tRSA_get0_key(k->rsa, NULL, &e, NULL);\n\treturn e;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include \"sshbuf.h\"",
      "#include \"sshkey.h\"",
      "#include \"authfile.h\"",
      "#include \"ssherr.h\"",
      "#include \"../test_helper/test_helper.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "# include <openssl/ec.h>",
      "#include <openssl/objects.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/bn.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RSA_get0_key",
          "args": [
            "k->rsa",
            "NULL",
            "&e",
            "NULL"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "RSA_get0_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "230-239",
          "snippet": "void\nRSA_get0_key(const RSA *r, const BIGNUM **n, const BIGNUM **e, const BIGNUM **d)\n{\n\tif (n != NULL)\n\t\t*n = r->n;\n\tif (e != NULL)\n\t\t*e = r->e;\n\tif (d != NULL)\n\t\t*d = r->d;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nRSA_get0_key(const RSA *r, const BIGNUM **n, const BIGNUM **e, const BIGNUM **d)\n{\n\tif (n != NULL)\n\t\t*n = r->n;\n\tif (e != NULL)\n\t\t*e = r->e;\n\tif (d != NULL)\n\t\t*d = r->d;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "k->rsa",
            "NULL"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "k",
            "NULL"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include \"sshbuf.h\"\n#include \"sshkey.h\"\n#include \"authfile.h\"\n#include \"ssherr.h\"\n#include \"../test_helper/test_helper.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n# include <openssl/ec.h>\n#include <openssl/objects.h>\n#include <openssl/dsa.h>\n#include <openssl/rsa.h>\n#include <openssl/bn.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst BIGNUM *\nrsa_e(struct sshkey *k)\n{\n\tconst BIGNUM *e = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->rsa, NULL);\n\tRSA_get0_key(k->rsa, NULL, &e, NULL);\n\treturn e;\n}"
  },
  {
    "function_name": "rsa_n",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/sshkey/common.c",
    "lines": "87-96",
    "snippet": "const BIGNUM *\nrsa_n(struct sshkey *k)\n{\n\tconst BIGNUM *n = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->rsa, NULL);\n\tRSA_get0_key(k->rsa, &n, NULL, NULL);\n\treturn n;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include \"sshbuf.h\"",
      "#include \"sshkey.h\"",
      "#include \"authfile.h\"",
      "#include \"ssherr.h\"",
      "#include \"../test_helper/test_helper.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "# include <openssl/ec.h>",
      "#include <openssl/objects.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/bn.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RSA_get0_key",
          "args": [
            "k->rsa",
            "&n",
            "NULL",
            "NULL"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "RSA_get0_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/openbsd-compat/libressl-api-compat.c",
          "lines": "230-239",
          "snippet": "void\nRSA_get0_key(const RSA *r, const BIGNUM **n, const BIGNUM **e, const BIGNUM **d)\n{\n\tif (n != NULL)\n\t\t*n = r->n;\n\tif (e != NULL)\n\t\t*e = r->e;\n\tif (d != NULL)\n\t\t*d = r->d;\n}",
          "includes": [
            "#include <openssl/dh.h>",
            "#include <openssl/ecdsa.h>",
            "#include <openssl/evp.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/bn.h>",
            "#include <openssl/err.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/dh.h>\n#include <openssl/ecdsa.h>\n#include <openssl/evp.h>\n#include <openssl/rsa.h>\n#include <openssl/dsa.h>\n#include <openssl/bn.h>\n#include <openssl/err.h>\n#include <string.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nRSA_get0_key(const RSA *r, const BIGNUM **n, const BIGNUM **e, const BIGNUM **d)\n{\n\tif (n != NULL)\n\t\t*n = r->n;\n\tif (e != NULL)\n\t\t*e = r->e;\n\tif (d != NULL)\n\t\t*d = r->d;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "k->rsa",
            "NULL"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "k",
            "NULL"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include \"sshbuf.h\"\n#include \"sshkey.h\"\n#include \"authfile.h\"\n#include \"ssherr.h\"\n#include \"../test_helper/test_helper.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n# include <openssl/ec.h>\n#include <openssl/objects.h>\n#include <openssl/dsa.h>\n#include <openssl/rsa.h>\n#include <openssl/bn.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst BIGNUM *\nrsa_n(struct sshkey *k)\n{\n\tconst BIGNUM *n = NULL;\n\n\tASSERT_PTR_NE(k, NULL);\n\tASSERT_PTR_NE(k->rsa, NULL);\n\tRSA_get0_key(k->rsa, &n, NULL, NULL);\n\treturn n;\n}"
  },
  {
    "function_name": "load_bignum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/sshkey/common.c",
    "lines": "75-85",
    "snippet": "BIGNUM *\nload_bignum(const char *name)\n{\n\tBIGNUM *ret = NULL;\n\tstruct sshbuf *buf;\n\n\tbuf = load_text_file(name);\n\tASSERT_INT_NE(BN_hex2bn(&ret, (const char *)sshbuf_ptr(buf)), 0);\n\tsshbuf_free(buf);\n\treturn ret;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include \"sshbuf.h\"",
      "#include \"sshkey.h\"",
      "#include \"authfile.h\"",
      "#include \"ssherr.h\"",
      "#include \"../test_helper/test_helper.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "# include <openssl/ec.h>",
      "#include <openssl/objects.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/bn.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sshbuf_free",
          "args": [
            "buf"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "133-166",
          "snippet": "void\nsshbuf_free(struct sshbuf *buf)\n{\n\tif (buf == NULL)\n\t\treturn;\n\t/*\n\t * The following will leak on insane buffers, but this is the safest\n\t * course of action - an invalid pointer or already-freed pointer may\n\t * have been passed to us and continuing to scribble over memory would\n\t * be bad.\n\t */\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn;\n\t/*\n\t * If we are a child, the free our parent to decrement its reference\n\t * count and possibly free it.\n\t */\n\tsshbuf_free(buf->parent);\n\tbuf->parent = NULL;\n\t/*\n\t * If we are a parent with still-extant children, then don't free just\n\t * yet. The last child's call to sshbuf_free should decrement our\n\t * refcount to 0 and trigger the actual free.\n\t */\n\tbuf->refcount--;\n\tif (buf->refcount > 0)\n\t\treturn;\n\tif (!buf->readonly) {\n\t\texplicit_bzero(buf->d, buf->alloc);\n\t\tfree(buf->d);\n\t}\n\texplicit_bzero(buf, sizeof(*buf));\n\tfree(buf);\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nsshbuf_free(struct sshbuf *buf)\n{\n\tif (buf == NULL)\n\t\treturn;\n\t/*\n\t * The following will leak on insane buffers, but this is the safest\n\t * course of action - an invalid pointer or already-freed pointer may\n\t * have been passed to us and continuing to scribble over memory would\n\t * be bad.\n\t */\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn;\n\t/*\n\t * If we are a child, the free our parent to decrement its reference\n\t * count and possibly free it.\n\t */\n\tsshbuf_free(buf->parent);\n\tbuf->parent = NULL;\n\t/*\n\t * If we are a parent with still-extant children, then don't free just\n\t * yet. The last child's call to sshbuf_free should decrement our\n\t * refcount to 0 and trigger the actual free.\n\t */\n\tbuf->refcount--;\n\tif (buf->refcount > 0)\n\t\treturn;\n\tif (!buf->readonly) {\n\t\texplicit_bzero(buf->d, buf->alloc);\n\t\tfree(buf->d);\n\t}\n\texplicit_bzero(buf, sizeof(*buf));\n\tfree(buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_NE",
          "args": [
            "BN_hex2bn(&ret, (const char *)sshbuf_ptr(buf))",
            "0"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BN_hex2bn",
          "args": [
            "&ret",
            "(const char *)sshbuf_ptr(buf)"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_ptr",
          "args": [
            "buf"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "268-274",
          "snippet": "const u_char *\nsshbuf_ptr(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn NULL;\n\treturn buf->cd + buf->off;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst u_char *\nsshbuf_ptr(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn NULL;\n\treturn buf->cd + buf->off;\n}"
        }
      },
      {
        "call_info": {
          "callee": "load_text_file",
          "args": [
            "name"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "load_text_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/sshkey/common.c",
          "lines": "54-73",
          "snippet": "struct sshbuf *\nload_text_file(const char *name)\n{\n\tstruct sshbuf *ret = load_file(name);\n\tconst u_char *p;\n\n\t/* Trim whitespace at EOL */\n\tfor (p = sshbuf_ptr(ret); sshbuf_len(ret) > 0;) {\n\t\tif (p[sshbuf_len(ret) - 1] == '\\r' ||\n\t\t    p[sshbuf_len(ret) - 1] == '\\t' ||\n\t\t    p[sshbuf_len(ret) - 1] == ' ' ||\n\t\t    p[sshbuf_len(ret) - 1] == '\\n')\n\t\t\tASSERT_INT_EQ(sshbuf_consume_end(ret, 1), 0);\n\t\telse\n\t\t\tbreak;\n\t}\n\t/* \\0 terminate */\n\tASSERT_INT_EQ(sshbuf_put_u8(ret, 0), 0);\n\treturn ret;\n}",
          "includes": [
            "#include \"common.h\"",
            "#include \"sshbuf.h\"",
            "#include \"sshkey.h\"",
            "#include \"authfile.h\"",
            "#include \"ssherr.h\"",
            "#include \"../test_helper/test_helper.h\"",
            "#include \"openbsd-compat/openssl-compat.h\"",
            "# include <openssl/ec.h>",
            "#include <openssl/objects.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/bn.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include \"sshbuf.h\"\n#include \"sshkey.h\"\n#include \"authfile.h\"\n#include \"ssherr.h\"\n#include \"../test_helper/test_helper.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n# include <openssl/ec.h>\n#include <openssl/objects.h>\n#include <openssl/dsa.h>\n#include <openssl/rsa.h>\n#include <openssl/bn.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct sshbuf *\nload_text_file(const char *name)\n{\n\tstruct sshbuf *ret = load_file(name);\n\tconst u_char *p;\n\n\t/* Trim whitespace at EOL */\n\tfor (p = sshbuf_ptr(ret); sshbuf_len(ret) > 0;) {\n\t\tif (p[sshbuf_len(ret) - 1] == '\\r' ||\n\t\t    p[sshbuf_len(ret) - 1] == '\\t' ||\n\t\t    p[sshbuf_len(ret) - 1] == ' ' ||\n\t\t    p[sshbuf_len(ret) - 1] == '\\n')\n\t\t\tASSERT_INT_EQ(sshbuf_consume_end(ret, 1), 0);\n\t\telse\n\t\t\tbreak;\n\t}\n\t/* \\0 terminate */\n\tASSERT_INT_EQ(sshbuf_put_u8(ret, 0), 0);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include \"sshbuf.h\"\n#include \"sshkey.h\"\n#include \"authfile.h\"\n#include \"ssherr.h\"\n#include \"../test_helper/test_helper.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n# include <openssl/ec.h>\n#include <openssl/objects.h>\n#include <openssl/dsa.h>\n#include <openssl/rsa.h>\n#include <openssl/bn.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nBIGNUM *\nload_bignum(const char *name)\n{\n\tBIGNUM *ret = NULL;\n\tstruct sshbuf *buf;\n\n\tbuf = load_text_file(name);\n\tASSERT_INT_NE(BN_hex2bn(&ret, (const char *)sshbuf_ptr(buf)), 0);\n\tsshbuf_free(buf);\n\treturn ret;\n}"
  },
  {
    "function_name": "load_text_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/sshkey/common.c",
    "lines": "54-73",
    "snippet": "struct sshbuf *\nload_text_file(const char *name)\n{\n\tstruct sshbuf *ret = load_file(name);\n\tconst u_char *p;\n\n\t/* Trim whitespace at EOL */\n\tfor (p = sshbuf_ptr(ret); sshbuf_len(ret) > 0;) {\n\t\tif (p[sshbuf_len(ret) - 1] == '\\r' ||\n\t\t    p[sshbuf_len(ret) - 1] == '\\t' ||\n\t\t    p[sshbuf_len(ret) - 1] == ' ' ||\n\t\t    p[sshbuf_len(ret) - 1] == '\\n')\n\t\t\tASSERT_INT_EQ(sshbuf_consume_end(ret, 1), 0);\n\t\telse\n\t\t\tbreak;\n\t}\n\t/* \\0 terminate */\n\tASSERT_INT_EQ(sshbuf_put_u8(ret, 0), 0);\n\treturn ret;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include \"sshbuf.h\"",
      "#include \"sshkey.h\"",
      "#include \"authfile.h\"",
      "#include \"ssherr.h\"",
      "#include \"../test_helper/test_helper.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "# include <openssl/ec.h>",
      "#include <openssl/objects.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/bn.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_put_u8(ret, 0)",
            "0"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_put_u8",
          "args": [
            "ret",
            "0"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_put_u8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf-getput-basic.c",
          "lines": "335-345",
          "snippet": "int\nsshbuf_put_u8(struct sshbuf *buf, u_char val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 1, &p)) < 0)\n\t\treturn r;\n\tp[0] = val;\n\treturn 0;\n}",
          "includes": [
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_put_u8(struct sshbuf *buf, u_char val)\n{\n\tu_char *p;\n\tint r;\n\n\tif ((r = sshbuf_reserve(buf, 1, &p)) < 0)\n\t\treturn r;\n\tp[0] = val;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshbuf_consume_end(ret, 1)",
            "0"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_consume_end",
          "args": [
            "ret",
            "1"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_consume_end",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "383-398",
          "snippet": "int\nsshbuf_consume_end(struct sshbuf *buf, size_t len)\n{\n\tint r;\n\n\tSSHBUF_DBG((\"len = %zu\", len));\n\tif ((r = sshbuf_check_sanity(buf)) != 0)\n\t\treturn r;\n\tif (len == 0)\n\t\treturn 0;\n\tif (len > sshbuf_len(buf))\n\t\treturn SSH_ERR_MESSAGE_INCOMPLETE;\n\tbuf->size -= len;\n\tSSHBUF_TELL(\"done\");\n\treturn 0;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nint\nsshbuf_consume_end(struct sshbuf *buf, size_t len)\n{\n\tint r;\n\n\tSSHBUF_DBG((\"len = %zu\", len));\n\tif ((r = sshbuf_check_sanity(buf)) != 0)\n\t\treturn r;\n\tif (len == 0)\n\t\treturn 0;\n\tif (len > sshbuf_len(buf))\n\t\treturn SSH_ERR_MESSAGE_INCOMPLETE;\n\tbuf->size -= len;\n\tSSHBUF_TELL(\"done\");\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_len",
          "args": [
            "ret"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "252-258",
          "snippet": "size_t\nsshbuf_len(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn 0;\n\treturn buf->size - buf->off;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nsize_t\nsshbuf_len(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn 0;\n\treturn buf->size - buf->off;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sshbuf_ptr",
          "args": [
            "ret"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "268-274",
          "snippet": "const u_char *\nsshbuf_ptr(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn NULL;\n\treturn buf->cd + buf->off;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nconst u_char *\nsshbuf_ptr(const struct sshbuf *buf)\n{\n\tif (sshbuf_check_sanity(buf) != 0)\n\t\treturn NULL;\n\treturn buf->cd + buf->off;\n}"
        }
      },
      {
        "call_info": {
          "callee": "load_file",
          "args": [
            "name"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "load_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/sshkey/common.c",
          "lines": "41-52",
          "snippet": "struct sshbuf *\nload_file(const char *name)\n{\n\tint fd;\n\tstruct sshbuf *ret;\n\n\tASSERT_PTR_NE(ret = sshbuf_new(), NULL);\n\tASSERT_INT_NE(fd = open(test_data_file(name), O_RDONLY), -1);\n\tASSERT_INT_EQ(sshkey_load_file(fd, ret), 0);\n\tclose(fd);\n\treturn ret;\n}",
          "includes": [
            "#include \"common.h\"",
            "#include \"sshbuf.h\"",
            "#include \"sshkey.h\"",
            "#include \"authfile.h\"",
            "#include \"ssherr.h\"",
            "#include \"../test_helper/test_helper.h\"",
            "#include \"openbsd-compat/openssl-compat.h\"",
            "# include <openssl/ec.h>",
            "#include <openssl/objects.h>",
            "#include <openssl/dsa.h>",
            "#include <openssl/rsa.h>",
            "#include <openssl/bn.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n#include \"sshbuf.h\"\n#include \"sshkey.h\"\n#include \"authfile.h\"\n#include \"ssherr.h\"\n#include \"../test_helper/test_helper.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n# include <openssl/ec.h>\n#include <openssl/objects.h>\n#include <openssl/dsa.h>\n#include <openssl/rsa.h>\n#include <openssl/bn.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct sshbuf *\nload_file(const char *name)\n{\n\tint fd;\n\tstruct sshbuf *ret;\n\n\tASSERT_PTR_NE(ret = sshbuf_new(), NULL);\n\tASSERT_INT_NE(fd = open(test_data_file(name), O_RDONLY), -1);\n\tASSERT_INT_EQ(sshkey_load_file(fd, ret), 0);\n\tclose(fd);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include \"sshbuf.h\"\n#include \"sshkey.h\"\n#include \"authfile.h\"\n#include \"ssherr.h\"\n#include \"../test_helper/test_helper.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n# include <openssl/ec.h>\n#include <openssl/objects.h>\n#include <openssl/dsa.h>\n#include <openssl/rsa.h>\n#include <openssl/bn.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct sshbuf *\nload_text_file(const char *name)\n{\n\tstruct sshbuf *ret = load_file(name);\n\tconst u_char *p;\n\n\t/* Trim whitespace at EOL */\n\tfor (p = sshbuf_ptr(ret); sshbuf_len(ret) > 0;) {\n\t\tif (p[sshbuf_len(ret) - 1] == '\\r' ||\n\t\t    p[sshbuf_len(ret) - 1] == '\\t' ||\n\t\t    p[sshbuf_len(ret) - 1] == ' ' ||\n\t\t    p[sshbuf_len(ret) - 1] == '\\n')\n\t\t\tASSERT_INT_EQ(sshbuf_consume_end(ret, 1), 0);\n\t\telse\n\t\t\tbreak;\n\t}\n\t/* \\0 terminate */\n\tASSERT_INT_EQ(sshbuf_put_u8(ret, 0), 0);\n\treturn ret;\n}"
  },
  {
    "function_name": "load_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/sshkey/common.c",
    "lines": "41-52",
    "snippet": "struct sshbuf *\nload_file(const char *name)\n{\n\tint fd;\n\tstruct sshbuf *ret;\n\n\tASSERT_PTR_NE(ret = sshbuf_new(), NULL);\n\tASSERT_INT_NE(fd = open(test_data_file(name), O_RDONLY), -1);\n\tASSERT_INT_EQ(sshkey_load_file(fd, ret), 0);\n\tclose(fd);\n\treturn ret;\n}",
    "includes": [
      "#include \"common.h\"",
      "#include \"sshbuf.h\"",
      "#include \"sshkey.h\"",
      "#include \"authfile.h\"",
      "#include \"ssherr.h\"",
      "#include \"../test_helper/test_helper.h\"",
      "#include \"openbsd-compat/openssl-compat.h\"",
      "# include <openssl/ec.h>",
      "#include <openssl/objects.h>",
      "#include <openssl/dsa.h>",
      "#include <openssl/rsa.h>",
      "#include <openssl/bn.h>",
      "#include <unistd.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <stdio.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/param.h>",
      "#include <sys/types.h>",
      "#include \"includes.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "fd"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "ssh_close_authentication_socket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/authfd.c",
          "lines": "171-176",
          "snippet": "void\nssh_close_authentication_socket(int sock)\n{\n\tif (getenv(SSH_AUTHSOCKET_ENV_NAME))\n\t\tclose(sock);\n}",
          "includes": [
            "#include \"ssherr.h\"",
            "#include \"misc.h\"",
            "#include \"atomicio.h\"",
            "#include \"log.h\"",
            "#include \"compat.h\"",
            "#include \"cipher.h\"",
            "#include \"authfd.h\"",
            "#include \"sshkey.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include <errno.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <sys/socket.h>",
            "#include <sys/un.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ssherr.h\"\n#include \"misc.h\"\n#include \"atomicio.h\"\n#include \"log.h\"\n#include \"compat.h\"\n#include \"cipher.h\"\n#include \"authfd.h\"\n#include \"sshkey.h\"\n#include \"sshbuf.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include <errno.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdarg.h>\n#include <signal.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <sys/socket.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nvoid\nssh_close_authentication_socket(int sock)\n{\n\tif (getenv(SSH_AUTHSOCKET_ENV_NAME))\n\t\tclose(sock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_EQ",
          "args": [
            "sshkey_load_file(fd, ret)",
            "0"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshkey_load_file",
          "args": [
            "fd",
            "ret"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "sshkey_load_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/authfile.c",
          "lines": "96-135",
          "snippet": "int\nsshkey_load_file(int fd, struct sshbuf *blob)\n{\n\tu_char buf[1024];\n\tsize_t len;\n\tstruct stat st;\n\tint r;\n\n\tif (fstat(fd, &st) < 0)\n\t\treturn SSH_ERR_SYSTEM_ERROR;\n\tif ((st.st_mode & (S_IFSOCK|S_IFCHR|S_IFIFO)) == 0 &&\n\t    st.st_size > MAX_KEY_FILE_SIZE)\n\t\treturn SSH_ERR_INVALID_FORMAT;\n\tfor (;;) {\n\t\tif ((len = atomicio(read, fd, buf, sizeof(buf))) == 0) {\n\t\t\tif (errno == EPIPE)\n\t\t\t\tbreak;\n\t\t\tr = SSH_ERR_SYSTEM_ERROR;\n\t\t\tgoto out;\n\t\t}\n\t\tif ((r = sshbuf_put(blob, buf, len)) != 0)\n\t\t\tgoto out;\n\t\tif (sshbuf_len(blob) > MAX_KEY_FILE_SIZE) {\n\t\t\tr = SSH_ERR_INVALID_FORMAT;\n\t\t\tgoto out;\n\t\t}\n\t}\n\tif ((st.st_mode & (S_IFSOCK|S_IFCHR|S_IFIFO)) == 0 &&\n\t    st.st_size != (off_t)sshbuf_len(blob)) {\n\t\tr = SSH_ERR_FILE_CHANGED;\n\t\tgoto out;\n\t}\n\tr = 0;\n\n out:\n\texplicit_bzero(buf, sizeof(buf));\n\tif (r != 0)\n\t\tsshbuf_reset(blob);\n\treturn r;\n}",
          "includes": [
            "#include \"krl.h\"",
            "#include \"ssherr.h\"",
            "#include \"sshbuf.h\"",
            "#include \"sshkey.h\"",
            "#include \"atomicio.h\"",
            "#include \"misc.h\"",
            "#include \"authfile.h\"",
            "#include \"log.h\"",
            "#include \"ssh.h\"",
            "#include \"cipher.h\"",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/uio.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [
            "#define MAX_KEY_FILE_SIZE\t(1024 * 1024)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"krl.h\"\n#include \"ssherr.h\"\n#include \"sshbuf.h\"\n#include \"sshkey.h\"\n#include \"atomicio.h\"\n#include \"misc.h\"\n#include \"authfile.h\"\n#include \"log.h\"\n#include \"ssh.h\"\n#include \"cipher.h\"\n#include <limits.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/uio.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\n#define MAX_KEY_FILE_SIZE\t(1024 * 1024)\n\nint\nsshkey_load_file(int fd, struct sshbuf *blob)\n{\n\tu_char buf[1024];\n\tsize_t len;\n\tstruct stat st;\n\tint r;\n\n\tif (fstat(fd, &st) < 0)\n\t\treturn SSH_ERR_SYSTEM_ERROR;\n\tif ((st.st_mode & (S_IFSOCK|S_IFCHR|S_IFIFO)) == 0 &&\n\t    st.st_size > MAX_KEY_FILE_SIZE)\n\t\treturn SSH_ERR_INVALID_FORMAT;\n\tfor (;;) {\n\t\tif ((len = atomicio(read, fd, buf, sizeof(buf))) == 0) {\n\t\t\tif (errno == EPIPE)\n\t\t\t\tbreak;\n\t\t\tr = SSH_ERR_SYSTEM_ERROR;\n\t\t\tgoto out;\n\t\t}\n\t\tif ((r = sshbuf_put(blob, buf, len)) != 0)\n\t\t\tgoto out;\n\t\tif (sshbuf_len(blob) > MAX_KEY_FILE_SIZE) {\n\t\t\tr = SSH_ERR_INVALID_FORMAT;\n\t\t\tgoto out;\n\t\t}\n\t}\n\tif ((st.st_mode & (S_IFSOCK|S_IFCHR|S_IFIFO)) == 0 &&\n\t    st.st_size != (off_t)sshbuf_len(blob)) {\n\t\tr = SSH_ERR_FILE_CHANGED;\n\t\tgoto out;\n\t}\n\tr = 0;\n\n out:\n\texplicit_bzero(buf, sizeof(buf));\n\tif (r != 0)\n\t\tsshbuf_reset(blob);\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_INT_NE",
          "args": [
            "fd = open(test_data_file(name), O_RDONLY)",
            "-1"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "test_data_file(name)",
            "O_RDONLY"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "process_permitopen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/servconf.c",
          "lines": "901-909",
          "snippet": "void\nprocess_permitopen(struct ssh *ssh, ServerOptions *options)\n{\n\tprocess_permitopen_list(ssh, sPermitOpen,\n\t    options->permitted_opens, options->num_permitted_opens);\n\tprocess_permitopen_list(ssh, sPermitListen,\n\t    options->permitted_listens,\n\t    options->num_permitted_listens);\n}",
          "includes": [
            "#include \"digest.h\"",
            "#include \"myproposal.h\"",
            "#include \"auth.h\"",
            "#include \"hostfile.h\"",
            "#include \"ssherr.h\"",
            "#include \"packet.h\"",
            "#include \"canohost.h\"",
            "#include \"groupaccess.h\"",
            "#include \"channels.h\"",
            "#include \"match.h\"",
            "#include \"mac.h\"",
            "#include \"kex.h\"",
            "#include \"sshkey.h\"",
            "#include \"cipher.h\"",
            "#include \"pathnames.h\"",
            "#include \"compat.h\"",
            "#include \"servconf.h\"",
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"log.h\"",
            "#include \"ssh.h\"",
            "#include \"xmalloc.h\"",
            "#include \"openbsd-compat/sys-queue.h\"",
            "#include <util.h>",
            "#include <errno.h>",
            "#include <stdarg.h>",
            "#include <limits.h>",
            "#include <unistd.h>",
            "#include <signal.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pwd.h>",
            "#include <netdb.h>",
            "#include <ctype.h>",
            "#include <net/route.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <sys/sysctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void add_listen_addr(ServerOptions *, const char *,\n    const char *, int);",
            "static void add_one_listen_addr(ServerOptions *, const char *,\n    const char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"digest.h\"\n#include \"myproposal.h\"\n#include \"auth.h\"\n#include \"hostfile.h\"\n#include \"ssherr.h\"\n#include \"packet.h\"\n#include \"canohost.h\"\n#include \"groupaccess.h\"\n#include \"channels.h\"\n#include \"match.h\"\n#include \"mac.h\"\n#include \"kex.h\"\n#include \"sshkey.h\"\n#include \"cipher.h\"\n#include \"pathnames.h\"\n#include \"compat.h\"\n#include \"servconf.h\"\n#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"log.h\"\n#include \"ssh.h\"\n#include \"xmalloc.h\"\n#include \"openbsd-compat/sys-queue.h\"\n#include <util.h>\n#include <errno.h>\n#include <stdarg.h>\n#include <limits.h>\n#include <unistd.h>\n#include <signal.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pwd.h>\n#include <netdb.h>\n#include <ctype.h>\n#include <net/route.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <sys/sysctl.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic void add_listen_addr(ServerOptions *, const char *,\n    const char *, int);\nstatic void add_one_listen_addr(ServerOptions *, const char *,\n    const char *, int);\n\nvoid\nprocess_permitopen(struct ssh *ssh, ServerOptions *options)\n{\n\tprocess_permitopen_list(ssh, sPermitOpen,\n\t    options->permitted_opens, options->num_permitted_opens);\n\tprocess_permitopen_list(ssh, sPermitListen,\n\t    options->permitted_listens,\n\t    options->num_permitted_listens);\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_data_file",
          "args": [
            "name"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "test_data_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/regress/unittests/test_helper/test_helper.c",
          "lines": "181-196",
          "snippet": "const char *\ntest_data_file(const char *name)\n{\n\tstatic char ret[PATH_MAX];\n\n\tif (data_dir != NULL)\n\t\tsnprintf(ret, sizeof(ret), \"%s/%s\", data_dir, name);\n\telse\n\t\tstrlcpy(ret, name, sizeof(ret));\n\tif (access(ret, F_OK) != 0) {\n\t\tfprintf(stderr, \"Cannot access data file %s: %s\\n\",\n\t\t    ret, strerror(errno));\n\t\texit(1);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"atomicio.h\"",
            "#include \"test_helper.h\"",
            "# include <vis.h>",
            "#include <openssl/bn.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "# include <stdint.h>",
            "#include <stdio.h>",
            "#include <fcntl.h>",
            "#include <sys/uio.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const char *data_dir = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"atomicio.h\"\n#include \"test_helper.h\"\n# include <vis.h>\n#include <openssl/bn.h>\n#include <signal.h>\n#include <unistd.h>\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n# include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/uio.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstatic const char *data_dir = NULL;\n\nconst char *\ntest_data_file(const char *name)\n{\n\tstatic char ret[PATH_MAX];\n\n\tif (data_dir != NULL)\n\t\tsnprintf(ret, sizeof(ret), \"%s/%s\", data_dir, name);\n\telse\n\t\tstrlcpy(ret, name, sizeof(ret));\n\tif (access(ret, F_OK) != 0) {\n\t\tfprintf(stderr, \"Cannot access data file %s: %s\\n\",\n\t\t    ret, strerror(errno));\n\t\texit(1);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_PTR_NE",
          "args": [
            "ret = sshbuf_new()",
            "NULL"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sshbuf_new",
          "args": [],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "sshbuf_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-20685/repo/sshbuf.c",
          "lines": "68-85",
          "snippet": "struct sshbuf *\nsshbuf_new(void)\n{\n\tstruct sshbuf *ret;\n\n\tif ((ret = calloc(sizeof(*ret), 1)) == NULL)\n\t\treturn NULL;\n\tret->alloc = SSHBUF_SIZE_INIT;\n\tret->max_size = SSHBUF_SIZE_MAX;\n\tret->readonly = 0;\n\tret->refcount = 1;\n\tret->parent = NULL;\n\tif ((ret->cd = ret->d = calloc(1, ret->alloc)) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"sshbuf.h\"",
            "#include \"ssherr.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <signal.h>",
            "#include <sys/types.h>",
            "#include \"includes.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"sshbuf.h\"\n#include \"ssherr.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <signal.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct sshbuf *\nsshbuf_new(void)\n{\n\tstruct sshbuf *ret;\n\n\tif ((ret = calloc(sizeof(*ret), 1)) == NULL)\n\t\treturn NULL;\n\tret->alloc = SSHBUF_SIZE_INIT;\n\tret->max_size = SSHBUF_SIZE_MAX;\n\tret->readonly = 0;\n\tret->refcount = 1;\n\tret->parent = NULL;\n\tif ((ret->cd = ret->d = calloc(1, ret->alloc)) == NULL) {\n\t\tfree(ret);\n\t\treturn NULL;\n\t}\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"common.h\"\n#include \"sshbuf.h\"\n#include \"sshkey.h\"\n#include \"authfile.h\"\n#include \"ssherr.h\"\n#include \"../test_helper/test_helper.h\"\n#include \"openbsd-compat/openssl-compat.h\"\n# include <openssl/ec.h>\n#include <openssl/objects.h>\n#include <openssl/dsa.h>\n#include <openssl/rsa.h>\n#include <openssl/bn.h>\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <stdio.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/param.h>\n#include <sys/types.h>\n#include \"includes.h\"\n\nstruct sshbuf *\nload_file(const char *name)\n{\n\tint fd;\n\tstruct sshbuf *ret;\n\n\tASSERT_PTR_NE(ret = sshbuf_new(), NULL);\n\tASSERT_INT_NE(fd = open(test_data_file(name), O_RDONLY), -1);\n\tASSERT_INT_EQ(sshkey_load_file(fd, ret), 0);\n\tclose(fd);\n\treturn ret;\n}"
  }
]